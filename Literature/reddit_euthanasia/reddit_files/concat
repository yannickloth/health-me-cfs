SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("0hqgxSo9Jy",["Dw4vb8Yfbm"],(async c=>{const{svg:s}=c.a();return{f:c.m(s`<path d="M3 6.9h7.11A4 4 0 0014 10c2.21 0 4-1.79 4-4s-1.79-4-4-4a4 4 0 00-3.89 3.1H3c-.5 0-.9.4-.9.9s.4.9.9.9zm11-3.1c1.21 0 2.2.99 2.2 2.2 0 1.21-.99 2.2-2.2 2.2-1.21 0-2.2-.99-2.2-2.2 0-1.21.99-2.2 2.2-2.2zm3 9.3H9.89A4 4 0 006 10c-2.21 0-4 1.79-4 4s1.79 4 4 4a4 4 0 003.89-3.1H17c.5 0 .9-.4.9-.9s-.4-.9-.9-.9zM6 16.2c-1.21 0-2.2-.99-2.2-2.2 0-1.21.99-2.2 2.2-2.2 1.21 0 2.2.99 2.2 2.2 0 1.21-.99 2.2-2.2 2.2z"></path>`,"0 0 20 20","filter")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("2Aiv5oCm8E",["Dw4vb8Yfbm","5r73EsgItq"],(async(t,e)=>{let r=class extends e.s{constructor(){super(...arguments),this.source="nav"}static get styles(){return[t.t]}createRenderRoot(){return this}render(){return e.x`<slot></slot> <ac-track trigger="view" san="${this.source}|view|advertise"></ac-track>`}};t._([t.n({type:String,attribute:"source"})],r.prototype,"source",void 0),r=t._([t.e("advertise-button")],r)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("2dYGY2J66F",["Dw4vb8Yfbm"],(async a=>{const{svg:m}=a.a();return{a:a.m(m`<path d="M10 1a9 9 0 100 18 9 9 0 000-18zm0 16.2a7.2 7.2 0 117.2-7.2 7.208 7.208 0 01-7.2 7.2zm.9-8.1H14v1.8h-3.1V14H9.1v-3.1H6V9.1h3.1V6h1.8v3.1z"></path>`,"0 0 20 20","add-circle")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("5KlNO8qI18",["Dw4vb8Yfbm"],(async a=>{const{svg:s}=a.a();return{s:a.m(s`<path d="M12.8 17.524l6.89-6.887a.9.9 0 000-1.273L12.8 2.477a1.64 1.64 0 00-1.782-.349 1.64 1.64 0 00-1.014 1.518v2.593C4.054 6.728 1.192 12.075 1 17.376a1.353 1.353 0 00.862 1.32 1.35 1.35 0 001.531-.364l.334-.381c1.705-1.944 3.323-3.791 6.277-4.103v2.509c0 .667.398 1.262 1.014 1.518a1.638 1.638 0 001.783-.349v-.002zm-.994-1.548V12h-.9c-3.969 0-6.162 2.1-8.001 4.161.514-4.011 2.823-8.16 8-8.16h.9V4.024L17.784 10l-5.977 5.976z"></path>`,"0 0 20 20","share",!0)}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./KHcvarc_gp.js",import.meta.url,"KHcvarc_gp");SML.di("./B7VtDPc4tA.js",import.meta.url,"B7VtDPc4tA");SML.di("./CNdFOsbHrs.js",import.meta.url,"CNdFOsbHrs");SML.di("./B6sa1lzoK7.js",import.meta.url,"B6sa1lzoK7");SML.di("./BIvvQbZj9p.js",import.meta.url,"BIvvQbZj9p");SML.di("./DgW4ULLwQ1.js",import.meta.url,"DgW4ULLwQ1");SML.di("./Bb_6_71M-3.js",import.meta.url,"Bb_6_71M-3");SML.di("./CPSOeCrm6v.js",import.meta.url,"CPSOeCrm6v");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./Cn5JTNK6V3.js",import.meta.url,"Cn5JTNK6V3");SML.di("./5KlNO8qI18.js",import.meta.url,"5KlNO8qI18");SML.di("./h_DcZt4ZIT.js",import.meta.url,"h_DcZt4ZIT");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./BlPAB0-vrn.js",import.meta.url,"BlPAB0-vrn");SML.di("./Cxi0lHfX5y.js",import.meta.url,"Cxi0lHfX5y");SML.di("./CQLIbJ-5V6.js",import.meta.url,"CQLIbJ-5V6");SML.di("./Z0tk4vmzIQ.js",import.meta.url,"Z0tk4vmzIQ");SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");SML.di("./Cl1pMDH2OX.js",import.meta.url,"Cl1pMDH2OX");SML.di("./CEs3hLX56z.js",import.meta.url,"CEs3hLX56z");SML.di("./B6Ai7g9fbR.js",import.meta.url,"B6Ai7g9fbR");SML.di("./pA9dwrnd0r.js",import.meta.url,"pA9dwrnd0r");SML.di("./BXUgRcxEAi.js",import.meta.url,"BXUgRcxEAi");SML.di("./w2XkRJ2mzc.js",import.meta.url,"w2XkRJ2mzc");SML.di("./h4Pa0OJr_5.js",import.meta.url,"h4Pa0OJr_5");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./DFh5Z0Dv0L.js",import.meta.url,"DFh5Z0Dv0L");SML.di("./C0cxgUZlQL.js",import.meta.url,"C0cxgUZlQL");SML.di("./BWv2j8jrjX.js",import.meta.url,"BWv2j8jrjX");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");SML.di("./D1DY-avSiT.js",import.meta.url,"D1DY-avSiT");SML.di("./BSYfFtBeKH.js",import.meta.url,"BSYfFtBeKH");SML.di("./2oAMtcRlsC.js",import.meta.url,"2oAMtcRlsC");SML.di("./DyRz1vAoTm.js",import.meta.url,"DyRz1vAoTm");SML.di("./E3QE3c4_Ye.js",import.meta.url,"E3QE3c4_Ye");SML.di("./DasPtA-dN5.js",import.meta.url,"DasPtA-dN5");SML.di("./Dc4r6aHTbv.js",import.meta.url,"Dc4r6aHTbv");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./CzwD205thW.js",import.meta.url,"CzwD205thW");SML.di("./D-ibjVaztZ.js",import.meta.url,"D-ibjVaztZ");SML.di("./Dm3xIDznQh.js",import.meta.url,"Dm3xIDznQh");SML.di("./Hw1PFKH8z9.js",import.meta.url,"Hw1PFKH8z9");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./CG8L8PJoXS.js",import.meta.url,"CG8L8PJoXS");SML.di("./YAFaZPh0hw.js",import.meta.url,"YAFaZPh0hw");SML.di("./CUIVPWsUpf.js",import.meta.url,"CUIVPWsUpf");SML.di("./CzmIuH4u_q.js",import.meta.url,"CzmIuH4u_q");SML.di("./D14t1nj-sI.js",import.meta.url,"D14t1nj-sI");SML.di("./DQQjPN-OEj.js",import.meta.url,"DQQjPN-OEj");SML.di("./Bv2UEnJP_M.js",import.meta.url,"Bv2UEnJP_M");SML.di("./CqGTWb5M_i.js",import.meta.url,"CqGTWb5M_i");SML.di("./CJv9OgeyPR.js",import.meta.url,"CJv9OgeyPR");SML.di("./CQrDBXK-hm.js",import.meta.url,"CQrDBXK-hm");SML.di("./Df8NHW2nh0.js",import.meta.url,"Df8NHW2nh0");SML.di("./CZLMnmUH44.js",import.meta.url,"CZLMnmUH44");SML.di("./D_6DXw1u0k.js",import.meta.url,"D_6DXw1u0k");SML.di("./Bk8sRXhdir.js",import.meta.url,"Bk8sRXhdir");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");SML.di("./BFJyoIhMKv.js",import.meta.url,"BFJyoIhMKv");SML.di("./C5bRok1J9n.js",import.meta.url,"C5bRok1J9n");SML.di("./KkXqW5RUm3.js",import.meta.url,"KkXqW5RUm3");SML.di("./C2hekzTn1k.js",import.meta.url,"C2hekzTn1k");SML.di("./DLXAqLxSut.js",import.meta.url,"DLXAqLxSut");SML.di("./Ctcf-FPPNG.js",import.meta.url,"Ctcf-FPPNG");SML.di("./BLrhRle6xP.js",import.meta.url,"BLrhRle6xP");SML.di("./C3-eAP6Oln.js",import.meta.url,"C3-eAP6Oln");SML.di("./DMGDObG7XA.js",import.meta.url,"DMGDObG7XA");
SML.dm("6BMXm3PfDi",["Dw4vb8Yfbm","5r73EsgItq","KHcvarc_gp","B7VtDPc4tA","Bb_6_71M-3","CPSOeCrm6v","B-zFJtiar6","Cn5JTNK6V3","5KlNO8qI18","h_DcZt4ZIT","xrDbp1ee_h","BlPAB0-vrn","Cxi0lHfX5y","CNdFOsbHrs","B6sa1lzoK7","BIvvQbZj9p","DgW4ULLwQ1","CQLIbJ-5V6","Z0tk4vmzIQ","C8QDHFSIkY","Cl1pMDH2OX","CEs3hLX56z","B6Ai7g9fbR","pA9dwrnd0r","BXUgRcxEAi","w2XkRJ2mzc","h4Pa0OJr_5","BIzQFHISzm","DFh5Z0Dv0L","C0cxgUZlQL","BWv2j8jrjX","tO6bKRQro7","Bu440t6XLo","BeFppRYbzE","D1DY-avSiT","BSYfFtBeKH","2oAMtcRlsC","DyRz1vAoTm","E3QE3c4_Ye","DasPtA-dN5","Dc4r6aHTbv","D_g7f2Ewyi","CzwD205thW","D-ibjVaztZ","Dm3xIDznQh","Hw1PFKH8z9","BYzqEZ3uv3","Cv4mWnWE30","CG8L8PJoXS","YAFaZPh0hw","CUIVPWsUpf","CzmIuH4u_q","D14t1nj-sI","DQQjPN-OEj","Bv2UEnJP_M","CqGTWb5M_i","CJv9OgeyPR","CQrDBXK-hm","Df8NHW2nh0","CZLMnmUH44","D_6DXw1u0k","Bk8sRXhdir","BtqmVQuPYp","BFJyoIhMKv","C5bRok1J9n","KkXqW5RUm3","C2hekzTn1k","DLXAqLxSut","Ctcf-FPPNG","BLrhRle6xP","C3-eAP6Oln","DMGDObG7XA"],(async(t,e,i,a,s,r,o,n,E,l,d,T,m)=>{const D=[t.D.BACKGROUND,t.D.PROMOTED_LABEL,t.D.CREDIT_BAR_WHITESPACE,t.D.TITLE,t.D.TEXT_BODY,t.D.ACTION_BAR_WHITESPACE];class p{constructor(t){this._currGalleryIndex=0,this.handleGalleryNavEvent=t=>{const{noun:e,action:i,source:a,post:s}=t.detail;s?.id===this.host.postId&&"gallery"===a&&"click"===i&&("forward"===e&&this._currGalleryIndex+1<this.host.galleryItems.length&&this._currGalleryIndex++,"backward"===e&&this._currGalleryIndex-1>=0&&this._currGalleryIndex--,this.host.querySelectorAll("call-to-action-gallery-links").forEach((t=>t.handleGalleryNavEvent(this._currGalleryIndex))),this.host.querySelectorAll("shreddit-dynamic-ad-link").forEach((t=>{D.includes(t.clickLocation)&&(t.galleryIndex=this._currGalleryIndex)})))},(this.host=t).addController(this)}hostConnected(){this.host.galleryItems?.length&&this.host.addEventListener("faceplate-track",this.handleGalleryNavEvent)}hostDisconnected(){this.host.removeEventListener("faceplate-track",this.handleGalleryNavEvent)}}class _{constructor(t){(this.host=t).addController(this)}hostConnected(){this.host.impressionId||this.host.hasAdEvents||(this.hydrateAdEventsFromStorage(),this.hydrateAdUserTargetingFromStorage(),this.host.hasAdEvents&&(this.updateDynamicLinkUrls(),this.host.setupAdObserver()))}updateDynamicLinkUrls(){this.host.querySelectorAll("shreddit-dynamic-ad-link").forEach((e=>{const i="/"===e.outboundLinkOverride?.charAt(0),a=!!this.host.galleryItems,s=!!this.host.isReminderAd;i||s||!a&&e.outboundLinkOverride===t.fB||(e.outboundLinkOverride=this.host.galleryItems?this.host.galleryItems[e.galleryIndex??0]?.outboundUrl:this.host.outboundLinkUrl)}))}hydrateAdEventsFromStorage(){const e=new URL(t.ep.href).searchParams.get(t.fC);this.host.impressionId=e||"";const i=o.bs(this.host.impressionId);i&&(this.host.adEvents=i.adEvents,this.host.outboundLinkUrl=i.clickRedirectUrl,this.host.galleryItems&&i.galleryAdData&&(this.host.galleryItems=i.galleryAdData?.map(((t,e)=>({...(this.host.galleryItems||[])[e],adEvents:t.adEvents,outboundUrl:t.clickRedirectUrl})))),this.host.encryptedTrackingPayload=i.encryptedTrackingPayload,this.host.additionalEventMetadata=i.additionalEventMetadata)}hydrateAdUserTargetingFromStorage(){const t=o.bt();t&&(this.host.adUserTargeting=t)}}const u=s.W(l.S);let h=class extends u{constructor(){super(...arguments),this.adEvents=[],this.impressionId="0",this.isBlank=!1,this.isCommentingDisabled=!1,this.isSharingDisabled=!1,this.isSurveyAd=!1,this.isPromotedCommunityPost=!1,this.isReminderAd=!1,this.placement=t.aj.FEED,this.AdPostHydrationController=new _(this),this.AdPostGalleryLinksController=new p(this),this.pubSub=new t.u(this),this._trackAdClick=this._events.define("observe-ad-click",(async e=>{const i=this.postType===t.eH.Image,a=this.postType===t.eH.Video,s=a&&this.viewType!==t.ag.CompactView&&e.detail.clickLocation!==t.D.MEDIA,o=a&&this.viewType===t.ag.CompactView;(i||o||s)&&(await this._activateLeadGenDialog(),r.s({leadGenInfo:this.leadGenInfo,postId:this.id,impressionId:this.impressionId,onSuccess:()=>this.dispatchEvent(t.c(t.f8))}))})),this.handleReminderAdClick=e=>{const i=this.querySelector("ad-reminder-button");if(i?.isReminderSet||!1)return void super.handleClickPost(e);m.s(e,{includeFeedChecks:!0})?super.handleClickPost(e):(e.preventDefault(),this.pubSub.publish(t.T.TriggerAdReminderModal,{postId:this.id}))},this.onAdUpdateAction=({action:t,impressionId:e})=>{"hide"===t&&e===this.impressionId&&(this.hidden=!0)}}static get styles(){return[...super.styles,t.a0(":host {\n  position: relative;\n}\n.ad-link-bar {\n  grid-column: 1 / 13;\n  height: 40px;\n  border-top: transparent;\n}\n.meta-row {\n  grid-column: 1 / 4;\n}\n.grid-template-col-inherit {\n  grid-template-columns: inherit;\n}\n")]}_activateLeadGenDialog(){return r.a({leadGenInfo:this.leadGenInfo})}get hasAdEvents(){return this.adEvents?.length>0}handleCarouselArrowClick(t){t.preventDefault();const e=t;T.h(this,e,this.impressionId)}handleClickPost(t){this.isReminderAd&&this.isUserLoggedIn?this.handleReminderAdClick(t):super.handleClickPost(t)}async handleUpvote(e){if(super.handleUpvote(e),this.isUserLoggedIn&&this.isReminderAd){super.getCurrentVoteType()===i.V.Upvote&&this.pubsub.publish(t.T.TriggerAdReminderModal,{postId:this.id})}}async connectedCallback(){super.connectedCallback(),this.pubSub.subscribe(t.T.AdUpdated,this.onAdUpdateAction),this.setupAdObserver(),await this.resolveCarouselDependencies()}setupAdObserver(){!this.isAdObserved&&this.hasAdEvents&&this.enableAdObserver({postElement:this,events:s.e(this.adEvents),postId:this.id,impressionId:this.impressionId,adType:this.adType,dimensions:this.dimensions,galleryItems:this.galleryItems?.map((t=>({...t,adEvents:s.e(t.adEvents||[])})))})}async resolveCarouselDependencies(){const t=this.querySelector("shreddit-gallery-carousel");t&&(await SML.di("./BKX6RFGIsQ.js",import.meta.url,"BKX6RFGIsQ"),t.classList.remove("flex"))}handleView(t,e){super.handleView(t,e,this.galleryItems?.length)}handleShareClick(){if(this.isSharingDisabled){const e=t.c("faceplate-alert",{level:t.a5.notice,message:"Sharing has been disabled for this post"});this.dispatchEvent(e)}else this.handleShareButtonInteraction()}handleClickCommentsButton(e){if(this.isSurveyAd)super.handleClickCommentsButton(e);else if(this.isCommentingDisabled){const e=t.c("faceplate-alert",{level:t.a5.notice,message:"Comments have been disabled for this post"});this.dispatchEvent(e)}else this.isFeed?(this.isPromotedCommunityPost&&!this.outboundLinkUrl.includes("alb.reddit.com")&&this.dispatchEvent(t.c("observe-ad-click",{postId:this.postId,impressionId:this.impressionId,outboundUrl:this.outboundLinkUrl,clickLocation:t.D.COMMENTS_BUTTON})),o.ai({impressionId:this.impressionId,adEvents:this.adEvents,clickRedirectUrl:this.outboundLinkUrl,galleryAdData:this.galleryItems?.map((t=>({adEvents:t.adEvents,clickRedirectUrl:t.outboundUrl}))),encryptedTrackingPayload:this.encryptedTrackingPayload,additionalEventMetadata:this.additionalEventMetadata}),o.aj(this.adUserTargeting),t.i(this,d.y(this))):super.handleClickCommentsButton(e)}renderCommentsButton(){if(this.isCommentingDisabled)return e.x`${a.c({size:l.D,appearance:o.ak()?"bordered":"secondary",attributes:{type:"button",className:l.a,onclick:this.handleClickCommentsButton,name:"comments-action-button","data-post-click-location":t.ck.COMMENTS_BUTTON},leadingIcon:n.c({attributes:{className:"icon-comment","aria-hidden":"true"},size:a.I[l.D]}),screenReaderContent:"comments",children:e.x`<faceplate-number number="${this.commentCount}" pretty></faceplate-number>`})}`;{const e=new URL(this.permalink,window.location.origin);return e.searchParams.set(t.cf,"1"),e.searchParams.set(t.fC,this.impressionId),this.leadGenInfo?.campaignId&&e.searchParams.set(t.fD,this.leadGenInfo.campaignId),this.isPromotedCommunityPost&&e.searchParams.set(t.fE,this.postId),this.permalink=e.pathname+e.search,super.renderCommentsButton()}}renderShareButton(){if(this.isSharingDisabled){const t="Share";return e.x`${a.c({size:l.D,appearance:o.ak()?"bordered":"secondary",attributes:{type:"button",onclick:this.handleShareClick,onkeydown:this.handleShareClick,className:l.a},leadingIcon:E.s({attributes:{className:"icon-share","aria-hidden":"true"},size:a.I[l.D]}),screenReaderContent:t,children:t})}`}return this.shareButtonSSR=!1,super.renderShareButton()}renderHiddenPost(){return e.x` <div class="hidden-post h-3xl flex items-center justify-between px-md"> <div> <p class="m-0 font-semibold text-neutral-content-strong text-14"> ${"Ad hidden"} </p> </div> </div> `;}renderActionRow(){return this.isSurveyAd?e.x``:super.renderActionRow()}render(){return this.hidden?this.renderHiddenPost():e.x`${this.isBlank?null:super.render()}`}};t._([t.n({type:String,attribute:"post-id"})],h.prototype,"postId",void 0),t._([t.n({type:Array,attribute:"ad-events",reflect:!0})],h.prototype,"adEvents",void 0),t._([t.n({type:Array,attribute:"gallery-items",reflect:!0})],h.prototype,"galleryItems",void 0),t._([t.n({type:Object,attribute:!0})],h.prototype,"dimensions",void 0),t._([t.n({type:String,attribute:"ad-type"})],h.prototype,"adType",void 0),t._([t.n({type:String,attribute:"outbound-link-url",reflect:!0})],h.prototype,"outboundLinkUrl",void 0),t._([t.n({type:String,attribute:"impression-id",reflect:!0})],h.prototype,"impressionId",void 0),t._([t.n({type:Object,attribute:"ad-user-targeting",reflect:!0})],h.prototype,"adUserTargeting",void 0),t._([t.n({type:Boolean,attribute:"is-blank"})],h.prototype,"isBlank",void 0),t._([t.n({type:Boolean,attribute:"is-commenting-disabled"})],h.prototype,"isCommentingDisabled",void 0),t._([t.n({type:Boolean,attribute:"is-sharing-disabled"})],h.prototype,"isSharingDisabled",void 0),t._([t.n({type:Boolean,attribute:"is-survey-ad"})],h.prototype,"isSurveyAd",void 0),t._([t.n({type:Boolean,attribute:"is-promoted-community-post"})],h.prototype,"isPromotedCommunityPost",void 0),t._([t.n({type:Boolean,attribute:"is-reminder-ad"})],h.prototype,"isReminderAd",void 0),t._([t.n({type:String,attribute:"country-code"})],h.prototype,"countryCode",void 0),t._([t.n({type:String,attribute:"placement"})],h.prototype,"placement",void 0),t._([t.n({type:Object,attribute:"lead-gen-info"})],h.prototype,"leadGenInfo",void 0),t._([t.n({type:String,attribute:"campaign-id"})],h.prototype,"campaignId",void 0),t._([t.n({type:String,attribute:"encrypted-tracking-payload"})],h.prototype,"encryptedTrackingPayload",void 0),t._([t.n({type:Array,attribute:"additional-event-metadata"})],h.prototype,"additionalEventMetadata",void 0),t._([t.n({type:String,attribute:"ad-transparency-encoded-data"})],h.prototype,"adTransparencyEncodedData",void 0),t._([t.n({type:String,attribute:"ads-correlation-id"})],h.prototype,"adsCorrelationId",void 0),t._([t.n({type:String,attribute:"overlay-text"})],h.prototype,"overlayText",void 0),t._([t.n({type:String,attribute:"overlay-type"})],h.prototype,"overlayType",void 0),h=t._([t.e("shreddit-ad-post")],h)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BAPJODHRV4.js",import.meta.url,"BAPJODHRV4");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./h4Pa0OJr_5.js",import.meta.url,"h4Pa0OJr_5");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./CfalWt2tl8.js",import.meta.url,"CfalWt2tl8");SML.di("./ygbiiDqLof.js",import.meta.url,"ygbiiDqLof");SML.di("./D1at8fJtPv.js",import.meta.url,"D1at8fJtPv");SML.di("./BLbwpJ0bjx.js",import.meta.url,"BLbwpJ0bjx");SML.di("./_Hk1tm1ODt.js",import.meta.url,"_Hk1tm1ODt");SML.di("./kS-PCwPq_X.js",import.meta.url,"kS-PCwPq_X");SML.di("./Chd9fEZKZ6.js",import.meta.url,"Chd9fEZKZ6");SML.di("./HzkRsiDxC9.js",import.meta.url,"HzkRsiDxC9");SML.di("./BDs3iC2vQ1.js",import.meta.url,"BDs3iC2vQ1");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("7c7cPPCf-9",["Dw4vb8Yfbm","5r73EsgItq","BAPJODHRV4","D_g7f2Ewyi","h4Pa0OJr_5","BIzQFHISzm","CfalWt2tl8","ygbiiDqLof","D1at8fJtPv","BLbwpJ0bjx","_Hk1tm1ODt","kS-PCwPq_X","Chd9fEZKZ6","HzkRsiDxC9","B-zFJtiar6","BDs3iC2vQ1","BYzqEZ3uv3","eY7T41bKac"],(async(e,i,t,a,s,n,r,o,d,l,u,p,N,h,c)=>{var m,f,b;!function(e){e.Everywhere="GLOBAL",e.UnitedStates="US",e.Argentina="AR",e.Australia="AU",e.Bulgaria="BG",e.Canada="CA",e.Chile="CL",e.Colombia="CO",e.Croatia="HR",e.CzechRepublic="CZ",e.Finland="FI",e.France="FR",e.Germany="DE",e.Greece="GR",e.Hungary="HU",e.Iceland="IS",e.India="IN",e.Ireland="IE",e.Italy="IT",e.Japan="JP",e.Malaysia="MY",e.Mexico="MX",e.NewZealand="NZ",e.Philippines="PH",e.Poland="PL",e.Portugal="PT",e.PuertoRico="PR",e.Romania="RO",e.Serbia="RS",e.Singapore="SG",e.Spain="ES",e.Sweden="SE",e.Taiwan="TW",e.Thailand="TH",e.Turkey="TR",e.UnitedKingdom="GB"}(m||(m={})),function(e){e.AllStates="",e.Alaska="AK",e.Alabama="AL",e.Arkansas="AR",e.Arizona="AZ",e.California="CA",e.Colorado="CO",e.Connecticut="CT",e.DistrictOfColumbia="DC",e.Delaware="DE",e.Florida="FL",e.Georgia="GA",e.Hawaii="HI",e.Iowa="IA",e.Idaho="ID",e.Illinois="IL",e.Indiana="IN",e.Kansas="KS",e.Kentucky="KY",e.Louisiana="LA",e.Massachusetts="MA",e.Maryland="MD",e.Maine="ME",e.Michigan="MI",e.Minnesota="MN",e.Missouri="MO",e.Mississippi="MS",e.Montana="MT",e.NorthCarolina="NC",e.NorthDakota="ND",e.Nebraska="NE",e.NewHampshire="NH",e.NewJersey="NJ",e.NewMexico="NM",e.Nevada="NV",e.NewYork="NY",e.Ohio="OH",e.Oklahoma="OK",e.Oregon="OR",e.Pennsylvania="PA",e.RhodeIsland="RI",e.SouthCarolina="SC",e.SouthDakota="SD",e.Tennessee="TN",e.Texas="TX",e.Utah="UT",e.Virginia="VA",e.Vermont="VT",e.Washington="WA",e.Wisconsin="WI",e.WestVirginia="WV",e.Wyoming="WY"}(f||(f={})),function(e){e.Show="show",e.Close="close"}(b||(b={}));const I=({notificationLevel:i,hfnUxUpdatesVariant:t,isUpdatesAllEnabled:a})=>{switch(i){case e.iw.All:return "All new posts";case e.iw.Frequent:return ((e,i)=>{if(i)return "Popular posts";switch(e){case r.b:return "Frequent notifications";case r.H:return "All notifications";default:return "Frequent";}})(t,a);case e.iw.Low:return (e=>{switch(e){case r.b:return "Allow notifications";case r.H:return "Personalized notifications";default:return "Low";}})(t);case e.iw.Off:return ((e,i)=>{const t="Off";return i?t:e===r.b||e===r.H?"None":t;})(t,a);default:return""}},k=(i,t,a)=>{switch(i){case e.iw.All:return t?.filled?r.n(t?.iconProps):r.a(t?.iconProps);case e.iw.Frequent:return a?t?.filled?o.n(t?.iconProps):u.n(t?.iconProps):t?.filled?r.n(t?.iconProps):r.a(t?.iconProps);case e.iw.Low:return t?.filled?o.n(t?.iconProps):u.n(t?.iconProps);case e.iw.Off:return t?.filled?d.n(t?.iconProps):l.n(t?.iconProps);default:return u.n(t?.iconProps)}},T=({notificationLevel:i,hfnUxUpdatesVariant:t,isUpdatesAllEnabled:a})=>{switch(i){case e.iw.All:return "Notifications set to All new posts";case e.iw.Frequent:return ((e,i)=>{if(i)return "Notifications set to Popular posts";switch(e){case r.b:case r.H:return "All notifications are turned on";default:return "Notifications set to frequent";}})(t,a);case e.iw.Low:return (e=>{switch(e){case r.b:return "Notifications are now allowed";case r.H:return "Personalized notifications are on";default:return "Notifications set to low";}})(t);case e.iw.Off:return ((e,i)=>{const t="Notifications turned off";return i?t:e===r.b||e===r.H?"No notifications":t;})(t,a);default:return""}},R=(i,t)=>t?i===e.iw.Low?e.iw.Off:i:i===e.iw.All?e.iw.Frequent:i,g=async i=>{const t=await e.Y({operation:e.O.UpdateSubredditSubscriptions,variables:{input:{inputs:[i]}}});if(!t?.data?.updateSubredditSubscriptions?.ok)throw new Error("Failed to update subreddit subscription")};let v=class extends i.s{constructor(){super(...arguments),this.name="",this.prefixedName="",this.subredditId="",this.isMuted=!1,this.isFavorite=!1,this.subscribed=!1,this.showJoinButton=!1,this.isUserLoggedIn=!1,this.buttonSize=e.q.Small,this.iconSize=i.I.Small,this.isCustomFeedEnabled=!1,this.isDropdownOpen=!1,this.isDisabled=!1,this.pubsub=new e.u(this),this.onFavoriteButtonClick=this.disableButtonDuringExecution((async()=>{try{this.subscribed||(await g({subredditId:this.subredditId,subscribeState:e.cG.Subscribed}),this.handleSubscriptionChange(e.cG.Subscribed));const i=this.isFavorite?e.aZ.None:e.aZ.Favorited;await(async i=>{const t=await e.Y({operation:e.O.UpdateSubredditFavoriteState,variables:{input:i}});if(!t?.data?.updateSubredditFavoriteState?.ok)throw new Error("Failed to update subreddit favorite state")})({subredditId:this.subredditId,favoriteState:i}),this.handleFavoriteStateChange(i)}catch(i){this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.error,message:"Something went wrong",cause:e.bM(i)}))}})),this.onUnmuteButtonClick=this.disableButtonDuringExecution((async()=>{try{await(async i=>{const t=await e.Y({operation:e.O.DeleteSubredditMuteSettings,variables:{input:i}});if(!t?.data?.deleteSubredditMuteSettings?.ok)throw new Error("Failed to unmute subreddit")})({subredditId:this.subredditId}),this.handleUnmuteChange()}catch(i){this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.error,message:"Something went wrong",cause:e.bM(i)}))}})),this.onJoinButtonClick=this.disableButtonDuringExecution((async i=>{try{i===e.cG.Subscribed&&e.ix(this.name).catch((()=>{})),await g({subredditId:this.subredditId,subscribeState:i}),this.handleSubscriptionChange(i)}catch(i){this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.error,message:"Something went wrong",cause:e.bM(i)}))}})),this.activateFeature=e.r}static get styles(){return[e.t]}firstUpdated(){this.pubsub.subscribe(e.T.SubredditSubscriptionChange,(e=>{this.name===e.name&&(this.subscribed=e.subscribed)})),this.pubsub.subscribe(e.T.SubredditMuteStatusChange,(e=>{this.subredditId===e.subredditId&&(this.isMuted=e.isMuted)})),this.addToCustomFeedButton?.addEventListener("custom-feed-edit-button:dialog-loaded",this.setupAddToCustomFeedButtonListeners)}disconnectedCallback(){super.disconnectedCallback()}disableButton(){this.isDisabled=!0}enableButton(){this.isDisabled=!1}disableButtonDuringExecution(e){return async(...i)=>{this.disableButton(),await e(...i),this.enableButton()}}setupAddToCustomFeedButtonListeners(){const e=document.querySelector("rpl-dialog#custom-feed-add-modal");if(!e)return;const i=()=>{e.portalContainer.querySelector("custom-feed-edit-button")?.addEventListener("custom-feed-edit-button:dialog-loaded",(()=>{e.hide()}))};e.open?i():e.addEventListener("rpl-dialog:after-show",i)}handleFavoriteStateChange(t){this.isFavorite=t===e.aZ.Favorited,e.p(e.T.SubredditFavoriteStatusChange,{id:this.subredditId,isFavorite:this.isFavorite});const a=this.isFavorite?`Added ${this.prefixedName} to favorites`:`Removed ${this.prefixedName} from favorites`;this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.info,message:a,namedContent:{action:i.x``}}))}handleUnmuteChange(){this.isMuted=!1,e.p(e.T.SubredditMuteStatusChange,{subredditId:this.subredditId,isMuted:!1}),this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.info,message:`Unmuted ${this.prefixedName}`,namedContent:{action:i.x``}}))}handleSubscriptionChange(i){this.subscribed=i===e.cG.Subscribed,e.p(e.T.SubredditSubscriptionChange,{name:this.name,subscribed:this.subscribed})}async openMuteConfirmationModal(){await this.activateFeature({name:e.iy});const i=document.getElementById(h.a);i?.openModal({subredditId:this.subredditId,prefixedName:this.prefixedName,onMuteRequestStart:this.disableButton.bind(this),onMuteRequestEnd:this.enableButton.bind(this)})}onDropdownOpen(){this.isDropdownOpen=!0}onDropdownClose(){this.isDropdownOpen=!1}renderAddToCustomFeedButton(){return this.isCustomFeedEnabled?i.x` <custom-feed-edit-button class="nd:visible" feature="${e.iz}" dialog-id="custom-feed-add-modal" query-params="${JSON.stringify({subredditId:this.subredditId})}"> ${a.l({label:"Add to custom feed",attributes:{tabindex:"0"}})} </custom-feed-edit-button> `:i.A;}renderFavoriteButton(){const e=this.isFavorite?"Remove from favorites":"Add to favorites";return a.l({label:e,onClick:this.onFavoriteButtonClick})}renderMuteButton(){if(!this.prefixedName)return"";const e=this.isMuted?`Unmute ${this.prefixedName}`:`Mute ${this.prefixedName}`,t=this.isMuted?"unmute":"mute",s=this.isMuted?this.onUnmuteButtonClick:this.openMuteConfirmationModal;return i.x` <faceplate-tracker source="subreddit_muting" action="${t}" noun="subreddit"> ${a.l({label:e,onClick:s})} </faceplate-tracker>`}renderJoinButton(){const t=this.subscribed?"Leave":"Join",s=this.subscribed?"unsubscribe":"subscribe",n=this.subscribed?e.cG.None:e.cG.Subscribed;return i.x`<faceplate-tracker source="community" action="click" noun="${s}"> ${a.l({label:t,onClick:()=>this.onJoinButtonClick(n)})} </faceplate-tracker>`}render(){return i.x`<faceplate-dropdown-menu class="nd:hidden" position="bottom-end" .onopen="${this.onDropdownOpen}" .onclose="${this.onDropdownClose}"> ${e.o({appearance:"bordered",attributes:{"aria-label":"Open overflow menu",disabled:this.isDisabled},size:this.buttonSize,leadingIcon:N.o({size:this.iconSize}),selected:this.isDropdownOpen})} <faceplate-menu slot="menu" class="max-h-[18rem] overflow-auto nd:hidden" hidden> ${this.isUserLoggedIn?i.x` ${[this.renderAddToCustomFeedButton(),this.renderFavoriteButton(),this.renderMuteButton()]} ${this.showJoinButton?this.renderJoinButton():""} `:""} <slot name="devvit-context-actions"></slot> </faceplate-menu> </faceplate-dropdown-menu>`;}};e._([e.n({type:String})],v.prototype,"name",void 0),e._([e.n({type:String,attribute:"prefixed-name"})],v.prototype,"prefixedName",void 0),e._([e.n({type:String,attribute:"subreddit-id"})],v.prototype,"subredditId",void 0),e._([e.n({type:Boolean,attribute:"is-muted"})],v.prototype,"isMuted",void 0),e._([e.n({type:Boolean,attribute:"is-favorite"})],v.prototype,"isFavorite",void 0),e._([e.n({type:Boolean,attribute:"subscribed"})],v.prototype,"subscribed",void 0),e._([e.n({type:Boolean,attribute:"show-join-button"})],v.prototype,"showJoinButton",void 0),e._([e.n({type:Boolean,attribute:"is-user-logged-in"})],v.prototype,"isUserLoggedIn",void 0),e._([e.n({type:String,attribute:"button-size"})],v.prototype,"buttonSize",void 0),e._([e.n({type:String,attribute:"icon-size"})],v.prototype,"iconSize",void 0),e._([e.n({type:Boolean,attribute:"allow-custom-feed"})],v.prototype,"isCustomFeedEnabled",void 0),e._([e.h()],v.prototype,"isDropdownOpen",void 0),e._([e.h()],v.prototype,"isDisabled",void 0),e._([e.a2(`custom-feed-edit-button[feature="${e.iz}"]`)],v.prototype,"addToCustomFeedButton",void 0),v=e._([e.e("shreddit-subreddit-overflow-control")],v);let S=class extends v{render(){if(!this.prefixedName)return i.x``;const e=this.isMuted?s.v({size:this.iconSize}):p.v({size:this.iconSize}),t=this.isMuted?"Unmute":"Mute",r=this.isMuted?"Show everything from this community":"Hide everything from this community",o=i.x` <div> <div>${t}</div> <div class="mt-0.5 text-12 text-secondary-weak">${r}</div> </div> `,d=this.isMuted?n.c({size:this.iconSize}):"",l=this.isMuted,u=this.isMuted?"unmute":"mute",N=this.isMuted?this.onUnmuteButtonClick:this.openMuteConfirmationModal;return i.x` <faceplate-tracker source="subreddit_muting" action="${u}" noun="subreddit"> ${a.l({label:o,leadingIcon:e,trailingSlot:d,selected:l,onClick:N,attributes:{role:"menuitem","aria-label":t}})} </faceplate-tracker> `}};S=e._([e.e("shreddit-notification-mute-control")],S);class E{constructor(i){this.host=i,this.emitNotificationFrequencyControlEvent=(...[i,t])=>e.i(this.host,e.b(i,{...t,action_info:{...t?.action_info,page_type:e.au.Community}})),this.emitToggleCommunityAlertFromTelemetry=(e,i,t,a)=>{const s=t.toLowerCase();this.emitNotificationFrequencyControlEvent({source:"community",action:"set_frequency",noun:s},{subreddit:{id:e,name:i},action_info:{reason:a?.toLowerCase()}})}}}let A=e.b5;const P=[e.iw.Frequent,e.iw.Low,e.iw.Off],L=[e.iw.All,e.iw.Frequent,e.iw.Off];let O=class extends i.s{constructor(){super(...arguments),this.subredditId="",this.notificationLevel=e.iw.Low,this.buttonSize=e.q.Small,this.iconSize=i.I.Small,this.hfnUxUpdatesVariant="",this.isUpdatesAllEnabled=!1,this.subredditUpdatesAllClientsVariant="",this.shredditSubredditUpdatesAllVariant="",this.subredditUpdatesAllClientsVersion="",this.shredditSubredditUpdatesAllVersion="",this.prefixedName="",this.isMuted=!1,this.isDropdownOpen=!1,this.isDisabled=!1,this.pubsub=new e.u(this),this.telemetryEmitter=new E(this)}static get styles(){return[e.t]}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.SubredditMuteStatusChange,(e=>{this.subredditId===e.subredditId&&(this.isMuted=e.isMuted)})),this.notificationLevel=R(this.notificationLevel,this.isUpdatesAllEnabled)}async onItemSelect(i){if(this.notificationLevel!==i){this.telemetryEmitter.emitToggleCommunityAlertFromTelemetry(this.subredditId,this.prefixedName,i,this.notificationLevel),this.isDisabled=!0;try{const t=(i=>{switch(i){case e.iw.Frequent:return{isSubredditUpdatesInterestingPostEnabled:!0,isUpdateFromSubredditEnabled:!0};case e.iw.Low:return{isSubredditUpdatesInterestingPostEnabled:!1,isUpdateFromSubredditEnabled:!0};case e.iw.Off:default:return{isSubredditUpdatesInterestingPostEnabled:!1,isUpdateFromSubredditEnabled:!1}}})(i),a=await this.updateSubredditNotificationLevel(t,i);a?.data?.updateSubredditMuteAndNotificationLevelSettings?.ok?(this.notificationLevel=R(i,this.isUpdatesAllEnabled),this.handleUpdateSuccess(i)):this.handleUpdateError(i)}catch(e){this.handleUpdateError(i)}this.isDisabled=!1}}async updateSubredditNotificationLevel(i,t=e.iw.Off){return e.Y({operation:e.O.UpdateSubredditMuteAndNotificationLevelSettings,variables:{input:{subredditId:this.subredditId,...i,subredditNotificationLevel:t}}})}handleUpdateSuccess(t){this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.success,message:T({notificationLevel:t,hfnUxUpdatesVariant:this.hfnUxUpdatesVariant,isUpdatesAllEnabled:this.isUpdatesAllEnabled}),namedContent:{icon:k(t,{iconProps:{size:i.I.Medium}},this.isUpdatesAllEnabled)??i.x``,action:i.x``}}))}handleUpdateError(a){const s=()=>this.pubsub.publish(e.T.TriggerFeedErrorBanner,{type:b.Close}),n=i.x`<div slot="leadingIcon">${t.w()}</div>`,r=i.x`<span slot="closeButton"> ${c.bM("plainInverted",{"aria-label":"close button",onclick:s})} </span>`,o=i.x` <div slot="actionButtons"> ${c.bf([{children:"Retry",attributes:{onclick:()=>{s(),this.onItemSelect(a)}}}],"plainInverted")} </div>`,d={msg:"Error updating notifications",className:"my-lg",appearance:"plainInverted",shape:"rounded",children:i.x` ${n} ${o} ${r} `};this.pubsub.publish(e.T.TriggerFeedErrorBanner,{type:b.Show,data:d})}onDropdownOpen(){this.isDropdownOpen=!0,this.subredditUpdatesAllClientsVariant&&A({experimentName:"subreddit_updates_all_clients",variant:this.subredditUpdatesAllClientsVariant,experimentVersion:this.subredditUpdatesAllClientsVersion}),this.shredditSubredditUpdatesAllVariant&&A({experimentName:"shreddit_subreddit_updates_all",variant:this.shredditSubredditUpdatesAllVariant,experimentVersion:this.shredditSubredditUpdatesAllVersion})}onDropdownClose(){this.isDropdownOpen=!1}render(){const t=this.isUpdatesAllEnabled?L:P,o=this.hfnUxUpdatesVariant===r.b||this.hfnUxUpdatesVariant===r.H,d=o&&this.isMuted?s.v({size:this.iconSize}):k(this.notificationLevel||e.iw.Low,{filled:!0,iconProps:{size:this.iconSize}},this.isUpdatesAllEnabled);return i.x`<faceplate-dropdown-menu class="nd:hidden" position="bottom-end" .onopen="${this.onDropdownOpen.bind(this)}" .onclose="${this.onDropdownClose.bind(this)}"> ${e.o({appearance:"bordered",size:this.buttonSize,attributes:{disabled:this.isDisabled,role:"button","aria-label":"Notification frequency menu"},leadingIcon:d,selected:this.isDropdownOpen})} <faceplate-menu slot="menu" hidden> ${t.map((e=>{let t=!1,s=this.notificationLevel===e,r="";o&&(t=this.isMuted,s&&(s=!t),s&&(r=n.c({size:this.iconSize})));const d=I({notificationLevel:e,hfnUxUpdatesVariant:this.hfnUxUpdatesVariant,isUpdatesAllEnabled:this.isUpdatesAllEnabled});return i.x` ${a.l({label:d,leadingIcon:k(e,{filled:s},this.isUpdatesAllEnabled),trailingSlot:r,selected:s,disabled:t,attributes:{role:"menuitem","aria-label":`Notifications ${d}`},onClick:()=>this.onItemSelect(e)})}`;}))} ${o?i.x` <div class="rpl-divider my-1 h-px bg-neutral-border" role="separator"></div> <shreddit-notification-mute-control prefixed-name="${this.prefixedName}" subreddit-id="${this.subredditId}" ?is-muted="${this.isMuted}" icon-size="${this.iconSize}"></shreddit-notification-mute-control>`:i.x``} </faceplate-menu> </faceplate-dropdown-menu>`;}};return e._([e.n({type:String,attribute:"subreddit-id"})],O.prototype,"subredditId",void 0),e._([e.n({type:String,attribute:"notification-level"})],O.prototype,"notificationLevel",void 0),e._([e.n({type:String,attribute:"button-size"})],O.prototype,"buttonSize",void 0),e._([e.n({type:String,attribute:"icon-size"})],O.prototype,"iconSize",void 0),e._([e.n({type:String,attribute:"hfn-ux-updates-variant"})],O.prototype,"hfnUxUpdatesVariant",void 0),e._([e.n({type:Boolean,attribute:"is-updates-all-enabled"})],O.prototype,"isUpdatesAllEnabled",void 0),e._([e.n({type:String,attribute:"subreddit-updates-all-clients-variant"})],O.prototype,"subredditUpdatesAllClientsVariant",void 0),e._([e.n({type:String,attribute:"shreddit-subreddit-updates-all-variant"})],O.prototype,"shredditSubredditUpdatesAllVariant",void 0),e._([e.n({type:String,attribute:"subreddit-updates-all-clients-version"})],O.prototype,"subredditUpdatesAllClientsVersion",void 0),e._([e.n({type:String,attribute:"shreddit-subreddit-updates-all-version"})],O.prototype,"shredditSubredditUpdatesAllVersion",void 0),e._([e.n({type:String,attribute:"prefixed-name"})],O.prototype,"prefixedName",void 0),e._([e.n({type:Boolean,attribute:"is-muted"})],O.prototype,"isMuted",void 0),e._([e.h()],O.prototype,"isDropdownOpen",void 0),e._([e.h()],O.prototype,"isDisabled",void 0),O=e._([e.e("shreddit-notification-frequency-control")],O),{get F(){return b}}}));
SML.dm("7mROGt_umO",[],(async()=>{var e,n,t,a;!function(e){e.AllChats="all_chats",e.AllChatsSpoke="all_chats_spoke",e.Chat="chat",e.Community="community",e.FeedElementOverflowMenu="chat_channel_overflow",e.ChannelInfo="channel_info",e.ChannelInfoEdit="channel_info_edit",e.ChannelInfoModeration="channel_info_moderation",e.HomefeedElement="chat_module_home",e.HomefeedMultiChatElement="multi_chat_module_home",e.MultiChatOverflowMenu="multi_chat_channel_overflow",e.Post="post",e.RelatedChatChannels="chat_related_cc",e.RightRail="chat_right_rail",e.RightRailUpsell="chat_right_rail_upsell"}(e||(e={})),function(e){e.AllChannel="all_channel",e.Channel="channel",e.ChannelCreate="channel_create",e.Chat="chat",e.ChatChannel="chat_channel",e.ChatChannelsChannelsTab="chat_channels_channels_tab",e.ChatChannelsSettingsTab="chat_channels_settings_tab",e.Chats="chats",e.ContentControls="content_controls",e.CrowdControl="crowd_control",e.Delete="delete",e.DeleteConfirm="delete_confirm",e.DiscoverItem="discover_item",e.EditInfo="edit_info",e.FeedOverflowMenu="chat_channel_overflow",e.Hide="hide",e.ImageMessageLoading="image_message_loading",e.InAppToast="in_app_toast",e.InAppToastActionSheet="in_app_toast_action_sheet",e.OpenChannel="open_channel",e.OverflowMenu="overflow",e.RelatedChatChannel="related_cc",e.RightRailUpsell="chat_right_rail_upsell",e.Save="save",e.Screen="screen",e.SetUpButton="set_up_button",e.TopNav="top_nav",e.ViewModChat="view_mod_chat"}(n||(n={})),function(e){e.SubredditChannel="channel",e.UserChannel="reddit_ucc"}(t||(t={})),function(e){e.Subscribed="subscribed",e.RecommendedSingle="recommended_single",e.RecommendedMultiple="recommended_multiple",e.Empty=""}(a||(a={}));return{get C(){return e},get a(){return n},b:{Chat:"chat"},c:{Resize:"resize"},d:{Screen:"screen"}}}));

SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./DdOxCDp7Tq.js",import.meta.url,"DdOxCDp7Tq");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./Hy4GfUHxlh.js",import.meta.url,"Hy4GfUHxlh");
SML.dm("8JyL8BkyKU",["Dw4vb8Yfbm","DdOxCDp7Tq","5r73EsgItq","B-zFJtiar6","Hy4GfUHxlh"],(async(e,t,i,n,a)=>{const s="inbox_banner_seen_count_store";function o({currentStorageData:e,userId:t,inboxBannerName:i}){return e?.[t]?.find((e=>e.inboxBannerName===i))?.seenCount??0}function r({userId:e,inboxBannerName:t,seenCount:i,currentStorageData:a={}}){const o={...(a || {}),[e]:[{inboxBannerName:t,seenCount:i}]};n.r(s,o)}let l=class extends i.s{constructor(){super(...arguments),this.isHidden=!1,this.colorMap={},this.hide=e=>{e.preventDefault(),this.isHidden=!0,this.userId&&this.name&&this.maxViews&&function({userId:e,inboxBannerName:t,seenCount:i}){r({userId:e,currentStorageData:n.u(s),inboxBannerName:t,seenCount:i})}({userId:this.userId,inboxBannerName:this.name,seenCount:this.maxViews})},this.onClick=e=>{t.i(e)&&e.preventDefault()}}firstUpdated(){if(this.querySelectorAll(`[data-id="${t.n}"`).forEach((e=>e.addEventListener("click",this.hide))),this.querySelectorAll("a").forEach((e=>e.addEventListener("click",this.onClick))),Object.entries(this.colorMap).forEach((([e,t])=>{this.style.setProperty(`--${e}`,t)})),this.userId&&this.name){const e=function({userId:e,inboxBannerName:t}){return o({userId:e,inboxBannerName:t,currentStorageData:n.u(s)})}({userId:this.userId,inboxBannerName:this.name});void 0!==this.maxViews&&e>=this.maxViews?this.isHidden=!0:function({userId:e,inboxBannerName:t}){const i=n.u(s);r({userId:e,currentStorageData:i,inboxBannerName:t,seenCount:o({userId:e,inboxBannerName:t,currentStorageData:i})+1})}({userId:this.userId,inboxBannerName:this.name})}}render(){return this.isHidden?i.A:i.x`<slot></slot>`}};l.styles=[e.t],e._([e.h()],l.prototype,"isHidden",void 0),e._([e.n({type:Object})],l.prototype,"colorMap",void 0),e._([e.n({type:String,attribute:"user-id"})],l.prototype,"userId",void 0),e._([e.n({type:String})],l.prototype,"name",void 0),e._([e.n({type:Number,attribute:"max-views"})],l.prototype,"maxViews",void 0),l=e._([e.e("notification-inbox-banner")],l);let c=class extends e.cM{constructor(){super(...arguments),this.trackExitEvent=()=>{this.trackEvent()}}get miniInboxTooltip(){return document.querySelector(`#${t.m}`)}connectedCallback(){super.connectedCallback(),this.source=t.a,this.action="exit",this.noun="mini_inbox",this.miniInboxTooltip?.addEventListener(this.closeEventName,this.trackExitEvent)}disconnectedCallback(){super.disconnectedCallback(),this.miniInboxTooltip?.removeEventListener(this.closeEventName,this.trackExitEvent)}get closeEventName(){return`${this.miniInboxTooltip?.tagName.toLowerCase()}:close`}};c=e._([e.e("notification-inbox-exit-tracker")],c);let d=class extends i.s{constructor(){super(...arguments),this.fireReadAll=async()=>{try{e.i(this,t.b({badgeCount:this.getUnreadCount()})),e.p(e.T.InboxReadAllEvent),e.p(e.T.InboxCountChanged,{messageCount:0});const i=await e.Y({operation:e.O.MarkPrivateMessageAsRead,variables:{input:{}}});i.data.markPrivateMessageAsRead?.ok||this.dispatchErrorMessage()}catch(e){this.dispatchErrorMessage()}},this.getUnreadCount=()=>document.querySelector(`[data-id="${t.c}"]`)?.getCount()??0,this.dispatchErrorMessage=()=>{this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.error,cause:"uncategorized",message:"Something went wrong while marking all notifications as read"}))}}firstUpdated(){this.querySelector("*")?.addEventListener("click",this.fireReadAll)}render(){return i.x` <slot></slot> `}};d=e._([e.e("mark-all-messages-read")],d);let u=class extends i.s{constructor(){super(...arguments),this.initialMessagesCount=0}async firstUpdated(){e.p(e.T.InboxCountChanged,{messageCount:this.initialMessagesCount}),this.initialMessagesCount?navigator.setAppBadge?.(this.initialMessagesCount):navigator.clearAppBadge?.(),await e.Y({operation:e.O.UpdateInboxActivitySeenState,variables:{input:{lastSentAt:this.lastSentAt?this.lastSentAt:(new Date).toISOString()}}})}render(){return i.A}};e._([e.n({type:Number,attribute:"initial-messages-count"})],u.prototype,"initialMessagesCount",void 0),e._([e.n({type:String,attribute:"last-sent-at"})],u.prototype,"lastSentAt",void 0),u=e._([e.e("mark-all-notifications-seen")],u);let h=class extends i.s{constructor(){super(...arguments),this.announcementId="",this.isM2InboxExperiment=!1,this.isHidden=!1,this.observer=null,this.pubsub=new e.u(this),this.onClick=e=>{t.i(e)?e.preventDefault():this.removeUnreadState()},this.onHide=({notificationId:e})=>{e===this.announcementId&&(this.isHidden=!0)},this.handleVisibilityChange=([{isIntersecting:i}])=>{if(i){if(this.hasBeenViewed)return void this.observer?.disconnect();const{title:i="",body:n=""}=this.notificationTelemetryData??{};e.i(this,t.d({notificationType:a.N,notificationId:this.announcementId,isViewed:!1,isClicked:!this.unreadChildElement,title:i,body:n})),this.observer?.disconnect()}},this.removeUnreadState=()=>{this.isM2InboxExperiment?this.unreadChildElement?.removeAttribute("selected"):this.unreadChildElement?.classList.remove(t.u)}}get hasBeenViewed(){return!!this.notificationTelemetryData?.viewedAt}connectedCallback(){super.connectedCallback(),this.addEventListener("click",this.onClick),this.pubsub.subscribe(e.T.NotificationInboxNotificationHideEvent,this.onHide),this.pubsub.subscribe(e.T.InboxReadAllEvent,this.removeUnreadState),this.observer=new IntersectionObserver(this.handleVisibilityChange,{root:document.querySelector(`[data-id="${t.e}"]`),threshold:.25}),this.observer.observe(this)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("click",this.onClick),this.observer?.disconnect()}firstUpdated(){if(!this.hasBeenViewed){const{title:i="",body:n=""}=this.notificationTelemetryData??{};e.i(this,t.f({notificationType:a.N,notificationId:this.announcementId,isViewed:!1,isClicked:!this.unreadChildElement,title:i,body:n}))}}get unreadChildElement(){return this.isM2InboxExperiment?this.querySelector("rpl-inbox-row[selected]"):this.querySelector(`.${t.u}`)}render(){return this.isHidden?i.A:i.x`<slot></slot>`}};h.styles=[e.t],e._([e.n({type:String,attribute:"announcement-id"})],h.prototype,"announcementId",void 0),e._([e.n({type:Object,attribute:"notification-telemetry-data"})],h.prototype,"notificationTelemetryData",void 0),e._([e.n({type:Boolean,attribute:"is-m2-inbox-experiment"})],h.prototype,"isM2InboxExperiment",void 0),e._([e.h()],h.prototype,"isHidden",void 0),h=e._([e.e("notification-announcement")],h)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("B-zFJtiar6",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,t)=>{function a(t){const a={};for(const n of t){const[t,r]=n;if(r instanceof File)throw e.lR(t);Object.prototype.hasOwnProperty.call(a,t)?Array.isArray(a[t])?a[t].push(r):a[t]=[a[t],r]:a[t]=r}return a}const n=(e,t)=>{if(!e||!t)return!1;if(e===t)return!0;if(0===e.childElementCount&&!(e instanceof HTMLSlotElement))return!1;if(e.contains(t))return!0;if(e instanceof HTMLSlotElement&&e.assignedElements().some((e=>n(e,t))))return!0;if(e instanceof Element&&e.shadowRoot&&n(e.shadowRoot,t))return!0;for(const a of e.querySelectorAll("slot"))if(a.assignedElements().some((e=>n(e,t))))return!0;return!1};const r=new WeakMap;function i(e,t=document){let a=r.get(t);a||(a=new Map,r.set(t,a));let n=a.get(e);return n||(n={key:e},a.set(e,n)),n}const o=Symbol("mixins/pagination"),s=function(t){const a=new WeakMap,n=e.h0();return{getContextKey:(e,t)=>i(e,t),appointLeader(e,r){if(a.has(r)){if(a.get(r).isConnected)throw new Error(`Cannot appoint leader for key "${r.key}" in the same context twice.`)}a.set(r,e);const i=n.getRegisteredElements(r);if(i)for(const a of i)t(e,a)},dismissLeader(e,t){const n=a.get(t);n&&n===e&&a.delete(t)},getLeader:e=>a.get(e),registerFollower(e,r){n.register(r,e);const i=a.get(r);i&&t(i,e)},unregisterFollower(e,t){n.unregister(t,e)},getFollowers:e=>n.getRegisteredElements(e)}}(((e,t)=>{t.syncPagination(e)}));const l="https://www.google.com/recaptcha/enterprise.js",c=1e3,p=3,d=new Map,h=new Map;function u(e=c){return new Promise(((t,a)=>{const n=Math.ceil(e/50);let r=0;const i=()=>{m()?t():r>=n?a(new Error("reCAPTCHA SDK load timeout")):(r++,setTimeout(i,50))};i()}))}function m(){return"function"==typeof window.grecaptcha?.enterprise?.execute}class g{constructor(e){this.checkInteraction=e,this.startingState=null,this.mouseIsDown=!1}create(){this.startingState=this.checkInteraction(),this.mouseIsDown=!0}reset(){this.mouseIsDown=!1,this.startingState=null}get hasStateChanged(){return null!==this.startingState&&this.checkInteraction()!==this.startingState}}const f=e=>!e.hasAttribute("disabled"),y=e=>e.tabIndex=0,b=e=>e.tabIndex=-1,v=e=>0===e.tabIndex&&f(e),N=e=>(y(e),e.focus(),e),I=e=>(b(e),e),k=e=>{for(let t=0;t<e.length;t++){const a=e[t];if(v(a))return[a,t]}return null},_=e=>{for(const t of e)if(f(t))return t;return null},T=e=>{const t=_(e);return t?N(t):null},R=e=>{const t=(e=>{for(let t=0;t<e.length;t++){const a=e[e.length-1-t];if(f(a))return a}return null})(e);return t?N(t):null},S=Symbol.for("rpl-menu-item");function w(e){return e.assignedNodes({flatten:!0}).filter((e=>!!(e.nodeType===Node.ELEMENT_NODE||e.nodeType===Node.TEXT_NODE&&e.textContent?.match(/\S/)))).length>0;}function E(e){const t={};return(a,n)=>{const r=((e,t)=>t?e+JSON.stringify(t):e)(a,n);return Object.prototype.hasOwnProperty.call(t,r)?t[r]:t[r]=new e(a,n)}}const C=E(Intl.NumberFormat),$=E(Intl.RelativeTimeFormat),x=E(Intl.DateTimeFormat),P=Symbol.for("lit-nothing");let A="RelativeTimeFormat"in Intl;const L=6e4;function D(e){const t=Math.abs(e.diff);switch(e.unit){case"minutes":return`${t} min. ago`;case"hours":return`${t} hr. ago`;case"days":return t>1?`${t} days ago`:`${t} day ago`;case"months":return`${t} mo. ago`;case"years":return`${t} yr. ago`;default:!function(e){throw new Error("Unexpected object: "+e)}(e.unit)}}const M=()=>e.K.get(e.lS),O=()=>e.K.get(e.lU),F=t=>t.placement===e.aj.FEED,U=t=>t.placement===e.aj.COMMENTS_PAGE||t.placement===e.aj.COMMENT_TREES,H=({post:t,placement:a})=>t&&U(t)?e.aj.COMMENTS_PAGE:a||t?.placement,z=t=>{const a=t.closest("shreddit-ad-post")||t.closest("shreddit-comments-page-ad")||t.closest("ad-event-tracker")||t.closest("shreddit-sidebar-ad");if(a)return a;{const a=t.getRootNode(),n=a instanceof ShadowRoot?a.host:null;return n?.tagName===e.lW||n?.tagName===e.lX?n:null}};function j(t){t&&e.a8.setItem(e.a9.AdEvents,JSON.stringify(t))}function K(t){t&&e.a8.setItem(e.a9.AdUserTargeting,JSON.stringify(t))}const G="combined";const B=function(e){return e};const V=new Map([["image/png",e.lZ.Png],["image/x-png",e.lZ.Png],["image/gif",e.lZ.Gif],["image/jpeg",e.lZ.Jpeg],["image/webp",e.lZ.Webp],["video/mp4",e.lZ.Mp4],["video/quicktime",e.lZ.Quicktime]]);let Z={uploadErrorMessage:()=>"There was an error uploading the file.",uploadToS3ErrorMessage:()=>"Failed to upload file to S3.",genericErrorMessage:()=>"Something went wrong",unsupportedMimetype:e=>`${e} files are not supported.`};function W(e,t){const a=new FormData;return t?.forEach((({header:e,value:t})=>{t&&a.append(e,t)})),a.append("file",e),a}function q(e){return(new DOMParser).parseFromString(e,"text/xml")}function J(e){window.Sentry?.captureMessage?.(e)}function Y(e,t){void 0===t&&(t={});for(var a=function(e){for(var t=[],a=0;a<e.length;){var n=e[a];if("*"!==n&&"+"!==n&&"?"!==n)if("\\"!==n)if("{"!==n)if("}"!==n)if(":"!==n)if("("!==n)t.push({type:"CHAR",index:a,value:e[a++]});else{var r=1,i="";if("?"===e[s=a+1])throw new TypeError('Pattern cannot start with "?" at '.concat(s));for(;s<e.length;)if("\\"!==e[s]){if(")"===e[s]){if(0==--r){s++;break}}else if("("===e[s]&&(r++,"?"!==e[s+1]))throw new TypeError("Capturing groups are not allowed at ".concat(s));i+=e[s++]}else i+=e[s++]+e[s++];if(r)throw new TypeError("Unbalanced pattern at ".concat(a));if(!i)throw new TypeError("Missing pattern at ".concat(a));t.push({type:"PATTERN",index:a,value:i}),a=s}else{for(var o="",s=a+1;s<e.length;){var l=e.charCodeAt(s);if(!(l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||95===l))break;o+=e[s++]}if(!o)throw new TypeError("Missing parameter name at ".concat(a));t.push({type:"NAME",index:a,value:o}),a=s}else t.push({type:"CLOSE",index:a,value:e[a++]});else t.push({type:"OPEN",index:a,value:e[a++]});else t.push({type:"ESCAPED_CHAR",index:a++,value:e[a++]});else t.push({type:"MODIFIER",index:a,value:e[a++]})}return t.push({type:"END",index:a,value:""}),t}(e),n=t.prefixes,r=void 0===n?"./":n,i=t.delimiter,o=void 0===i?"/#?":i,s=[],l=0,c=0,p="",d=function(e){if(c<a.length&&a[c].type===e)return a[c++].value},h=function(e){var t=d(e);if(void 0!==t)return t;var n=a[c],r=n.type,i=n.index;throw new TypeError("Unexpected ".concat(r," at ").concat(i,", expected ").concat(e))},u=function(){for(var e,t="";e=d("CHAR")||d("ESCAPED_CHAR");)t+=e;return t},m=function(e){var t=s[s.length-1],a=e||(t&&"string"==typeof t?t:"");if(t&&!a)throw new TypeError('Must have text between two parameters, missing text after "'.concat(t.name,'"'));return!a||function(e){for(var t=0,a=o;t<a.length;t++){var n=a[t];if(e.indexOf(n)>-1)return!0}return!1}(a)?"[^".concat(X(o),"]+?"):"(?:(?!".concat(X(a),")[^").concat(X(o),"])+?")};c<a.length;){var g=d("CHAR"),f=d("NAME"),y=d("PATTERN");if(f||y){var b=g||"";-1===r.indexOf(b)&&(p+=b,b=""),p&&(s.push(p),p=""),s.push({name:f||l++,prefix:b,suffix:"",pattern:y||m(b),modifier:d("MODIFIER")||""})}else{var v=g||d("ESCAPED_CHAR");if(v)p+=v;else if(p&&(s.push(p),p=""),d("OPEN")){b=u();var N=d("NAME")||"",I=d("PATTERN")||"",k=u();h("CLOSE"),s.push({name:N||(I?l++:""),pattern:N&&!I?m(b):I,prefix:b,suffix:k,modifier:d("MODIFIER")||""})}else h("END")}}return s}function X(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1");}const Q="moderator";function ee(t){return t===e.e8.Post}const te=(e,t,a)=>{const n={id:t,title:a};return ee(e)?{post_flair:n}:{user_flair:n}};function ae(){return "Something went wrong";}let ne=e.Y;const re=e=>e.startsWith("t1_"),ie=e.dI(class extends e.dJ{constructor(){super(...arguments),this.key=t.A}render(e,t){return this.key=e,t}update(t,[a,n]){return a!==this.key&&(e.dM(t),this.key=a),n}});const oe={"3xs":"w-[1rem] h-[1rem]","2xs":"w-[1rem] h-[1rem]",xs:"w-[1.5rem] h-[1.5rem]",sm:"w-[2rem] h-[2rem]",md:"w-[2.5rem] h-[2.5rem]",lg:"w-[3rem] h-[3rem]",xl:"w-[3.5rem] h-[3.5rem]","2xl":"w-[4rem] h-[4rem]","3xl":"w-[5.5rem] h-[5.5rem]"},se={"3xs":"w-[1rem] h-[1rem] min-w-[1rem] min-h-[1rem]","2xs":"w-[1rem] h-[1rem] min-w-[1rem] min-h-[1rem]",xs:"w-[1.5rem] h-[1.5rem] min-w-[1.5rem] min-h-[1.5rem]",sm:"w-[2rem] h-[2rem] min-w-[2rem] min-h-[2rem]",md:"w-[2.5rem] h-[2.5rem] min-w-[2.5rem] min-h-[2.5rem]",lg:"w-[3rem] h-[3rem] min-w-[3rem] min-h-[3rem]",xl:"w-[2.875rem] h-[2.875rem] min-w-[2.875rem] min-h-[2.875rem]","2xl":"w-[3.25rem] h-[3.25rem] min-w-[3.25rem] min-h-[3.25rem]","3xl":"w-[4.5rem] h-[4.5rem] min-w-[4.5rem] min-h-[4.5rem]"},le={"3xs":"outline-offset-[0.125rem]","2xs":"outline-offset-[0.125rem]",xs:"outline-offset-[0.125rem]",sm:"outline-offset-[0.125rem]",md:"outline-offset-[0.125rem]",lg:"outline-offset-[0.1875rem]",xl:"outline-offset-[0.1875rem]","2xl":"outline-offset-[0.1875rem]","3xl":"outline-offset-[.25rem]"},ce={"3xs":"border","2xs":"border",xs:"border",sm:"border",md:"border-md",lg:"border-md",xl:"border-md","2xl":"border-lg","3xl":"border-lg"},pe={"3xs":"outline-1","2xs":"outline-1",xs:"outline-1",sm:"outline-1",md:"outline-2",lg:"outline-2",xl:"outline-2","2xl":"outline-4","3xl":"outline-4"},de={"3xs":2,"2xs":2,xs:2,sm:4,md:4,lg:4,xl:6,"2xl":6,"3xl":6},he={"3xs":-5.4,"2xs":-5.4,xs:-5.4,sm:-7,md:-7,lg:-7,xl:-8.3,"2xl":-8.3,"3xl":-8.3},ue={"3xs":"-right-[0.0625rem]","2xs":"right-0",xs:"right-[0.05rem]",sm:"right-[0.10rem]",md:"-right-[0.0825rem]",lg:"-right-[0.125rem]",xl:"-right-[0.125rem]","2xl":"-right-[.65rem]","3xl":"-right-[.75rem]"},me={"3xs":"w-[.25rem] h-[.25rem] border","2xs":"w-[.25rem] h-[.25rem] border",xs:"w-[.25rem] h-[.25rem] border",sm:"w-[.375rem] h-[.375rem] border-2",md:"w-[.375rem] h-[.375rem] border-2",lg:"w-[.625rem] h-[.625rem] border-2",xl:"w-[.625rem] h-[.625rem] border-2","2xl":"w-[1rem] h-[1rem] border-2","3xl":"w-[1.25rem] h-[1.25rem] border-2"},ge={"3xs":"rounded-1","2xs":"rounded-1",xs:"rounded-1",sm:"rounded-2",md:"rounded-2",lg:"rounded-2",xl:"rounded-[.75rem]","2xl":"rounded-[.75rem]","3xl":"rounded-4"},fe=({ringColorClassName:e,size:t})=>e?`${e} outline ${pe[t]} ${le[t]}`:"",ye=({...t})=>{const{html:a,ifDefined:n}=e.a(),{attributes:r,children:i,position:o="relative",size:s,status:l}=t;return a`<span class="inline-flex snoovatar ${o} ${n(r?.className)}">${i}${Ne({status:l,size:s})} </span>`},be=({children:a,snoovatarSrc:n,avatarBgClassName:r,appearance:i})=>{const{html:o}=e.a();return o` <span style="${r||!n?"":`background: ${"media"===i?"var(--color-avatar-media-gradient)":"var(--color-avatar-gradient)"}`}" class="rounded-full absolute h-full w-full inline-flex justify-center ${r||""}"> ${a??t.A} </span>`},ve=a=>{const{appearance:n}=a;return"collectible"===n?(({snoovatarSrc:t,snoovatarAlt:a,size:n,attributes:r,status:i,flip:o,lazy:s})=>{const{html:l}=e.a();return ye({flip:o,size:n,status:i,children:l`${_e()} ${ke({size:n})}${Ie({snoovatarSrc:t,snoovatarAlt:a,size:n,lazy:s})}`,attributes:{...r,className:`${se[n]}`}})})(a):(({attributes:a,ringLayer:n,children:r,snoovatarAlt:i,snoovatarSrc:o,avatarBgClassName:s,size:l,ringColorClassName:c,status:p,appearance:d,flip:h,lazy:u})=>{const{html:m}=e.a(),g="default"===d?"box-border [&>:first-child]:rounded-[inherit] overflow-hidden":"",f=m`<span class="absolute rounded-full inset-0 border border-solid border-neutral-border-weak bg-transparent"></span>`;return ye({flip:h,size:l,status:p,position:n?"absolute":"relative",attributes:{...a,className:`${fe({ringColorClassName:c,size:l})} fp-avatar-container rounded-full ${se[l]} isolate box-content`},children:m` ${o?t.A:be({snoovatarSrc:o,appearance:d,avatarBgClassName:s,children:m`<span class="relative rounded-full overflow-hidden ${n?"border border-solid border-neutral-background":""} inline-flex w-full h-full ${g}">${r} ${"default"===d&&n?f:t.A} </span>`})} ${o?Te({snoovatarSrc:o,snoovatarAlt:i,size:l,ringColorClassName:c,avatarBgClassName:s,appearance:d,lazy:u}):t.A}`})})(a)},Ne=({status:t,size:a})=>{const{html:n}=e.a();return t?n` <span class="${"online"===t?"bg-online":""} flex absolute bottom-0 rounded-full border-solid border-neutral-background bg-neutral-background ${ue[a]} ${ce[a]} ${me[a]}"> ${"online"===t?"":t} </span> `:""},Ie=({size:t,snoovatarAlt:a,snoovatarSrc:n,lazy:r})=>{const{html:i,svg:o}=e.a(),s=Math.random().toString(16).slice(2);return i`<div class="absolute h-full w-full" style="transform:translateY(${he[t]}%)"> <svg width="100%" height="100%" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg" class="overflow-hidden"> <defs> <clipPath id="${s}"> <path d="M120 0H0V96H22.0602C22.5169 98.2109 23.896 100.155 25.8949 101.309L56          118.691C58.4752 120.12 61.5248 120.12 64 118.691L94.1051 101.309C96.104 100.155 97.4831          98.2109 97.9398 96H120V0Z"/> </clipPath> </defs> ${r?o`<foreignObject clip-path="url(#${s})" width="100%" height="100%"> <img src="${n}" alt="${a}" loading="lazy"> </foreignObject>`:o`<image href="${n}" alt="${a}" clip-path="url(#${s})" height="100%" width="100%">`} </svg> </div>`},ke=({size:t})=>{const{html:a}=e.a();return a`<span class="absolute h-full w-full start-0"> <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 72 72" fill="none"> <path d="M34 3.4641C35.2376 2.74957 36.7624 2.74957 38 3.4641L63.1769 18C64.4145 18.7145 65.1769 20.035 65.1769 21.4641V50.5359C65.1769 51.965 64.4145 53.2855 63.1769 54L38 68.5359C36.7624 69.2504 35.2376 69.2504 34 68.5359L8.82309 54C7.58548 53.2855 6.82309 51.965 6.82309 50.5359V21.4641C6.82309 20.035 7.58548 18.7145 8.82309 18L34 3.4641Z" stroke="url(#paint0_diamond_26526_186798)" stroke-width="${de[t]}" stroke-linejoin="round"/> <defs> <radialGradient id="paint0_diamond_26526_186798" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(-7.4247 26.0998) rotate(15.9097) scale(50.0682 24082.5)"> <stop stop-color="#1185B5"/> <stop offset="0.29452" stop-color="#D7F7FF"/> <stop offset="0.526042" stop-color="#5EF6D8"/> <stop offset="0.838434" stop-color="#5EF6D8"/> <stop offset="0.867246" stop-color="#1990B9"/> <stop offset="1" stop-color="#3F9FC6"/> </radialGradient> </defs> </svg> </span>`},_e=()=>{const{html:t}=e.a();return t`<div class="absolute h-full w-full" style="transform:scale(${.95})"> <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 64 64" fill="none"> <path d="M29 1.73205C30.8564 0.660254 33.1436 0.660254 35 1.73205L56.7128 14.2679C58.5692 15.3397 59.7128 17.3205 59.7128 19.4641V44.5359C59.7128 46.6795 58.5692 48.6603 56.7128 49.7321L35 62.2679C33.1436 63.3397 30.8564 63.3397 29 62.2679L7.28719 49.7321C5.43078 48.6603 4.28719 46.6795 4.28719 44.5359V19.4641C4.28719 17.3205 5.43078 15.3397 7.28719 14.2679L29 1.73205Z" fill="url(#paint0_diamond_26026_173944)"/> <path d="M29 1.73205C30.8564 0.660254 33.1436 0.660254 35 1.73205L56.7128 14.2679C58.5692 15.3397 59.7128 17.3205 59.7128 19.4641V44.5359C59.7128 46.6795 58.5692 48.6603 56.7128 49.7321L35 62.2679C33.1436 63.3397 30.8564 63.3397 29 62.2679L7.28719 49.7321C5.43078 48.6603 4.28719 46.6795 4.28719 44.5359V19.4641C4.28719 17.3205 5.43078 15.3397 7.28719 14.2679L29 1.73205Z" fill="url(#paint1_linear_26026_173944)"/> <defs> <radialGradient id="paint0_diamond_26026_173944" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(-6.59974 23.1999) rotate(15.9097) scale(44.5051 21406.7)"> <stop stop-color="#1185B5"/> <stop offset="0.29452" stop-color="#D7F7FF"/> <stop offset="0.526042" stop-color="#5EF6D8"/> <stop offset="0.838434" stop-color="#5EF6D8"/> <stop offset="0.867246" stop-color="#1990B9"/> <stop offset="1" stop-color="#3F9FC6"/> </radialGradient> <linearGradient id="paint1_linear_26026_173944" x1="23.5687" y1="22.7061" x2="44.1183" y2="53.4817" gradientUnits="userSpaceOnUse"> <stop stop-color="#004E5F"/> <stop offset="1" stop-color="#727CD8" stop-opacity="0.81"/> </linearGradient> </defs> </svg> </div>`},Te=({size:t,snoovatarAlt:a,snoovatarSrc:n,attributes:r,avatarBgClassName:i,appearance:o,lazy:s})=>{const{html:l,svg:c,createElement:p}=e.a(),d=Math.random().toString(16).slice(2);return p("span",{...r,className:"absolute start-0 end-0 bottom-0 mx-auto inline-flex shrink-0 justify-center box-border h-full w-full"},l`${be({snoovatarSrc:n,avatarBgClassName:i,appearance:o})} <svg viewBox="0 0 121 122" xmlns="http://www.w3.org/2000/svg" class="overflow-hidden absolute bottom-0 ${oe[t]}"> <defs> <clipPath id="${d}"> <path d="M0 0V79L28.1628 105.5C35.013 115.465 46.4934 122 59.5 122C72.5066 122 83.987 115.465 90.8372 105.5L120.5 79V0H0Z"/> </clipPath> </defs> ${s?c`<foreignObject clip-path="url(#${d})" width="100%" height="100%"> <img src="${n}" alt="${a}" loading="lazy"> </foreignObject>`:c`<image href="${n}" alt="${a}" clip-path="url(#${d})" height="100%" width="100%">`} </svg>`)},Re=e.dI(class extends e.dJ{constructor(e){super(e),this.tt=new WeakMap}render(e){return[e]}update(a,[n]){if(e.l_(this.et)&&(!e.l_(n)||this.et.strings!==n.strings)){const n=e.l$(a).pop();let r=this.tt.get(this.et.strings);if(void 0===r){const e=document.createDocumentFragment();r=t.B(t.A,e),r.setConnected(!1),this.tt.set(this.et.strings,r)}e.dM(r,[n]),e.m0(r,void 0,n)}if(e.l_(n)){if(!e.l_(this.et)||this.et.strings!==n.strings){const t=this.tt.get(n.strings);if(void 0!==t){const n=e.l$(t).pop();e.m1(a),e.m0(a,void 0,n),e.dM(a,[n])}}this.et=n}else this.et=void 0;return this.render(n)}});const Se={plain:"plain",plainInverted:"plainInverted",error:"destructive",brand:"brand",caution:"plain",success:"success"};function we(e){return e>>16&255}function Ee(e){return e>>8&255}function Ce(e){return 255&e}function $e(e){return e<0?0:e>255?255:e}function xe(e){return parseInt(e,16)}const Pe="highlight_card_";const Ae={rootMargin:"0px",threshold:[1]};class Le extends e.bf{constructor(t,a){super(t),this._isInViewport=!1,this._hasBeenImpressed=!1,this._hasBeenConsumed=!1,this._hasPageUnloaded=!1,this.onVisible=e=>{this._isInViewport&&e&&(this._hasPageUnloaded=!1,this._becameVisibleOnScreenTimestamp=Date.now())},this.onHidden=e=>{this._isInViewport&&(e||this._hasPageUnloaded||this.handlePotentialConsume())},this.onBeforeUnloadCallback=()=>{this._hasPageUnloaded=!0,this._isInViewport&&this.handlePotentialConsume()},this.onEnter=()=>{this._isInViewport||(this._isInViewport=!0,this._becameVisibleOnScreenTimestamp=Date.now(),this.handlePotentialImpression())},this.onLeave=()=>{this._isInViewport&&(this.handlePotentialConsume(),this._isInViewport=!1)},t.addController(this),this._config={...a,observerConfig:a.observerConfig??Ae},this._observerController=new e.ay(this,t,this._config.observerConfig);const n=new e.E(this,(()=>t));n.define("faceplate-enter",this.onEnter),n.define("faceplate-leave",this.onLeave)}hostConnected(){super.hostConnected(),e.aF(this.onVisible,{immediate:!0}),e.aF(this.onHidden,{immediate:!0,shouldBeCalledFirst:!0}),e.aE.subscribe(this.onBeforeUnloadCallback,{shouldBeCalledFirst:!0})}hostDisconnected(){super.hostDisconnected(),e.aG(this.onHidden),e.aG(this.onVisible),e.aE.unsubscribe(this.onBeforeUnloadCallback)}handlePotentialImpression(){this._hasBeenImpressed||(this._hasBeenImpressed=!0,this._config.onView?.())}handlePotentialConsume(){!this._hasBeenConsumed&&this._becameVisibleOnScreenTimestamp&&Date.now()-this._becameVisibleOnScreenTimestamp>this._config.consumeThreshold&&(this._hasBeenConsumed=!0,this._observerController.hostDisconnected(),this._config.onConsume?.())}}const De="component-reload";const Me=(t,a,n)=>e.b({source:"custom_feeds",...t},{customFeed:{id:a},...(n ? {subreddit:{id:n}} : {})}),Oe="add_keyword_cta_complete_ms",Fe="keyword_list_complete_ms",Ue="chart_complete_ms",He="conversations_feed_complete_ms",ze=["trends_complete_ms",Oe,Fe,Ue,He],je=new Set,Ke=new Set(["reddit","config","special"]),Ge=new Set(["edit","revisions","settings","discussions","pages","create"]),Be=new Set(["config/description","config/sidebar","config/stylesheet","config/submit_text"]);const Ve=Object.entries({16:"icon32",24:"icon48",32:"icon64",40:"icon96",48:"icon96",56:"icon96",88:"icon96"});const Ze=1e3,We=1e6,qe=1e9,Je=({num:e,divider:t,defaultFixed:a=0,maxDigits:n,removeZeroDecimal:r})=>{const i=e/t;if(!n){const e=i.toFixed(a);return r&&Number(e)%1==0?Math.floor(i).toString():i.toFixed(Math.floor(a))}return i.toString().slice(0,n+1)};const Ye=(e,t,a=1)=>{const n=Math.pow(10,a);return(Math.floor(e/(t/n))/n).toFixed(a)},Xe=/(?:\/|-)nftv2_([a-z0-9%]+)_([a-z]+)_([a-z0-9-]{36})(?:-headshot)?\.(?:png|svg)/i;const Qe=(e,t)=>{"complete"!==document.readyState?window.addEventListener("load",e,t):e()},et=/^\//,tt=/\/$/,at=(e="")=>e.replace(et,"").replace(tt,""),nt=/^\/user\/([\w+-]+)\/m\//,rt=/\/$/,it=(e="")=>e.replace(nt,"").replace(rt,""),ot=/^\/u(?:ser)?\//,st=/\/$/,lt=(e="")=>e.replace(ot,"u/").replace(st,""),ct=({type:t,path:a})=>({[e.aa.GLOBAL]:e=>e,[e.aa.COMMUNITY]:at,[e.aa.CUSTOM_FEED]:it,[e.aa.PROFILE]:lt}[t](a)),pt="preview";var dt=Object.freeze({__proto__:null,AdStorageController:class{constructor(e){this.host=e}getParentAdPost(){const e=this.host.closest("ad-event-tracker");return e||null}storeAdDataInStorage(){const e=this.getParentAdPost();e&&(j({impressionId:e.impressionId,adEvents:e.adEvents,clickRedirectUrl:e.outboundLinkUrl,encryptedTrackingPayload:e.encryptedTrackingPayload,additionalEventMetadata:e.additionalEventMetadata}),e.adUserTargeting&&K(e.adUserTargeting))}}});return {$:b,A:class{constructor(t,a){this._batchTimer=0,this._batchDisplay=()=>{if(this._batchTimer=0,!this._batchQueue||!this._batchQueue.length)return;const t=e.m2(this._batchQueue);for(const e of t)this.options.onAlert(e);this._batchQueue.length=0},t.addController(this),this.host=t,this.options=a,a.batchWindow&&a.batchWindow>0&&(this._batchQueue=[])}hostConnected(){e.m3(this.host).then((t=>{t&&(this._reporter=t,e.m4.register(t,this))}))}hostDisconnected(){this._reporter&&(e.m4.unregister(this._reporter,this),this._reporter=void 0),this._batchTimer&&window.clearTimeout(this._batchTimer),this._batchQueue&&(this._batchQueue.length=0)}shouldDisplayAlert(e){if(!this.options.isOnline()&&!e.showWhenOffline)return!1;const t=this.options;if("number"==typeof e.level){if(t.max&&e.level>t.max)return!1;if(t.min&&e.level<t.min)return!1}else if(void 0!==t.min||void 0!==t.max)return!1;return!t.name||t.name===e.name}displayAlert(e){if(this._batchQueue){if(this._batchQueue.push(e),this._batchTimer)return;this._batchTimer=window.setTimeout(this._batchDisplay,this.options.batchWindow)}else this.options.onAlert(e)}},B:function(e){return e.replace(Pe,"")},C:"comment-post",D:function(e,t=0,a=!1){let n=!1,r=null;const i=function(...o){n?a&&(r=[this,o]):(e.apply(this,o),n=!0,setTimeout((()=>{n=!1,r&&(i.apply(r[0],r[1]),r=null)}),t))};return i},E:"flair-settings__flair-copy",F:"flair-form-can-submit-change",G:"flair-settings__flair-delete",H:"flair-form-success",I:class{constructor(e,t){this.observedElements=[],this.handleSlotChange=e=>{this.observer.disconnect();const t=e.target;t instanceof HTMLSlotElement&&(this.observedElements=t.assignedElements(),this.observedElements.forEach((e=>this.observer.observe(e))))},this.observer=new IntersectionObserver(this.handleIntersection.bind(this),t),(this.host=e).addController(this)}hostConnected(){this.observedElements.forEach((e=>this.observer.observe(e)))}hostDisconnected(){this.observer.disconnect()}isLoadableFaceplatePartial(t){return t instanceof e.bO&&t.loading===e.y.Programmatic&&!t.isLoading}async handleIntersection(e){e.forEach((e=>{e.isIntersecting&&this.isLoadableFaceplatePartial(e.target)&&e.target.load()}))}},J:"flair-settings__table-feature-id",K:"flair-settings__flair-delete-modal",L:"flair-settings__flair-form",M:t=>e.b({source:Q,action:"click",noun:ee(t)?"remove_post_flair_confirm":"remove_flair_confirm"}),N:()=>{const e=O(),t=M();return"true"===e||void 0===e&&void 0===t?window.matchMedia("(prefers-reduced-motion: reduce)")?.matches:"false"!==t},O:"observe-gallery-item-impression",P:"clear-search-input",Q:"reddit-search:close",R:V,S:"subreddit-posting-eligibility-modal",T:async function(e,t){const a=await window.fetch(t.uploadLeaseUrl,{method:"POST",body:W(e,t.uploadLeaseHeaders)});if(a.ok){const e=function(e){const t=q(e);return t.querySelector("Location")?.textContent?.trim()}(await a.text());return e||J("Unable to retrieve S3 url for uploaded resource."),e}throw (J(`Failed to upload file to S3 with error code: ${function(e){const t=q(e);return t.querySelector("Code")?.textContent?.trim()}(await a.text())}`), new Error(Z.uploadToS3ErrorMessage()))},U:function(e,t){if(!e)return{color:"",icon:"",backgroundColor:""};const a=function(e){const t=e?.primaryColor,a=e?.mobileKeyColor,n=e?.legacyPrimaryColor;return t||a||n||null}(e)||"",n=function(e,t){if(!t)return e?.icon??null;for(const[a,n]of Ve){const r=e?.[n];if(r&&t<=parseInt(a,10))return r}return e?.icon??null}(e,t),r=e?.legacyIcon?.url;return{color:a,icon:n||r||"",backgroundColor:e?.backgroundColor||""}},V:Le,W:function(e){if(o in e)return e;class t extends e{constructor(){super(...arguments),this.pages=1,this._pageIndex=1,this._pageNames=void 0}get pageIndex(){return this._pageIndex}set pageIndex(e){if(e===this._pageIndex)return;const t=this._pageIndex;this._pageIndex=e,this.pageIndexChangedCallback(t)}get pageNames(){return this._pageNames}set pageNames(e){e&&(this.pages=e.length),this._pageNames=e}syncLinkedPageables(){if(this._paginationLeaderContext){const e=s.getFollowers(this._paginationLeaderContext);if(!e||!e.size)return;for(const t of e)t.syncPagination(this)}if(this._paginationFollowerContext){const e=s.getLeader(this._paginationFollowerContext);e&&(e.pageIndex=this._pageIndex)}}syncPagination(e){this.pageIndex=e.pageIndex,this.pages=e.pages,this.pageNames=e.pageNames}getPaginationContext(){const e=this.getRootNode();if(e!==this&&(e instanceof Document||e instanceof ShadowRoot))return e}connectedCallback(){super.connectedCallback&&super.connectedCallback();const e=this.getPaginationContext();if(!e)return;const t=this.getAttribute("for");t&&(this._paginationFollowerContext=s.getContextKey(t,e),s.registerFollower(this,this._paginationFollowerContext)),this.id&&!t&&(this._paginationLeaderContext=s.getContextKey(this.id,e),s.appointLeader(this,this._paginationLeaderContext))}disconnectedCallback(){super.connectedCallback&&super.connectedCallback(),this._paginationLeaderContext&&(s.dismissLeader(this,this._paginationLeaderContext),this._paginationLeaderContext=void 0),this._paginationFollowerContext&&(s.unregisterFollower(this,this._paginationFollowerContext),this._paginationFollowerContext=void 0)}nextPage(){this.pageIndex=Math.min(this.pages,this.pageIndex+1)}previousPage(){this.pageIndex=Math.max(1,this.pageIndex-1)}pageIndexChangedCallback(e){this.syncLinkedPageables()}}return t[o]=!0,t},X:class{hostConnected(){}constructor(e,t){this.host=e,this.config=t,this._interactionTrigger=null,this.mouseFrame=new g((()=>this.config.isInteractedWith(this.host))),this.eventUsedMap=new WeakMap,this.handleBlur=e=>{if(this.hasTrigger("focus")||this.hasTrigger("focus-visible")){const t=()=>this.host.finishInteraction(e,"focus");this.config.delayOpenOnFocus?this.delayInteraction(t,this.config.hoverDelayEnd(this.host)):t()}},this.handleClick=e=>{if(this.eventUsedMap.has(e))return this.mouseFrame.reset();this.eventUsedMap.set(e,!0),this.hasTrigger("click")&&!this.mouseFrame.hasStateChanged&&(this.config.isInteractedWith(this.host)?this.host.finishInteraction(e,"click"):this.host.startInteraction(e,"click")),this.mouseFrame.reset()},this.handleFocus=e=>{const t=this.hasTrigger("focus"),a=this.hasTrigger("focus-visible");if((!(!t&&a&&e.target instanceof HTMLElement)||e.target.matches(":focus-visible"))&&(t||a)&&!this.mouseFrame.mouseIsDown){const t=()=>this.host.startInteraction(e,"focus");this.config.delayOpenOnFocus?this.delayInteraction(t,this.config.hoverDelayStart(this.host)):t()}},this.handleMouseEnter=e=>{this.hasTrigger("hover")&&this.delayInteraction((()=>this.host.startInteraction(e,"hover")),this.config.hoverDelayStart(this.host))},this.handleMouseLeave=e=>{this.hasTrigger("hover")&&this.delayInteraction((()=>this.host.finishInteraction(e,"hover")),this.config.hoverDelayEnd(this.host))},this.handleMouseDown=()=>{this.hasTrigger("click")&&this.mouseFrame.create()},this.handleMouseUp=()=>{this.hasTrigger("click")&&(this.mouseFrame.mouseIsDown=!1)},this.host.addController(this)}set interactionTrigger(e){this._interactionTrigger=e,this.host.requestUpdate()}get interactionTrigger(){return this._interactionTrigger}delayInteraction(e,t){clearTimeout(this.delayTimeout),this.delayTimeout=window.setTimeout(e,t)}hasTrigger(e){return this.host.trigger.split(" ").includes(e)}},Y:n,Z:v,_:y,a:class{constructor(t,a){this.isLoading=!1,this.hasReloadError=!1,this.handleReload=async e=>{if(!this.reloadUrl)return;this._currentAbortController&&this._currentAbortController.abort(),this._currentAbortController=new AbortController;const t=this._currentAbortController;this.isLoading=!0,this.hasReloadError=!1,this.host.requestUpdate();try{await this.getAndReplacePartial(e.detail?.queryParameters,t.signal)}catch(e){t.signal.aborted||(this.hasReloadError=!0)}this._currentAbortController===t&&(this.isLoading=!1,this._currentAbortController=void 0,this.host.requestUpdate())};const{reloadUrl:n,containerSelector:r,mode:i=e.P.Contents}=a||{};(this.host=t).addController(this),this._partialRequest=new e.aS(this.host),this._reloadUrl=n,this.containerSelector=r||this.host.tagName.toLowerCase(),this._mode=i}get reloadUrl(){return this._reloadUrl}set reloadUrl(e){this._reloadUrl=e}get mode(){return this._mode}set mode(e){this._mode=e}hostConnected(){this.host.addEventListener(De,this.handleReload)}hostDisconnected(){this.host.removeEventListener(De,this.handleReload)}async getAndReplacePartial(t={},a){const n=this.reloadUrl&&Array.from(Object.entries(t)).reduce(((t,[a,n])=>e.cb(t,a,n)),this.reloadUrl),r=await this._partialRequest.request(n);if(a?.aborted)return;const i=await(r?.text());if(a?.aborted)return;if(!i)throw new Error("Unable to reload content");const o=(new DOMParser).parseFromString(i,"text/html").querySelector(this.containerSelector);if(!o)throw new Error(`Element ${this.containerSelector} not found in reload response`);if(!a?.aborted)if(this.mode!==e.P.Contents)e.aT(o.outerHTML,this.host,this.mode);else{if(!o?.innerHTML)throw new Error("No content to reload");e.aT(o.innerHTML,this.host,this.mode)}}},a$:"list-reply-comment",a0:_,a1:t=>Object.values(e.cc).includes(t),a2:k,a3:I,a4:f,a5:N,a6:T,a7:e=>{const t=k(e);return t?(I(t[0]),t):null},a8:R,a9:(e,t,a)=>{if(!t)return R(e);const n=((e,t,a)=>{for(let n=1;n<e.length;n++){const r=(t-n+e.length)%e.length,i=e[r];if(r>t&&!a)return null;if(f(i))return i}return f(e[t])?e[t]:null})(e,t[1],a);return n?N(n):null},aA:we,aB:Ee,aC:Ce,aD:function(e){return e>>24&255},aE:function(e){const t=we(e),a=Ee(e),n=Ce(e),r=[t.toString(16),a.toString(16),n.toString(16)];for(const[e,t]of r.entries())1===t.length&&(r[e]="0"+t);return"#"+r.join("")},aF:function({r:e,g:t,b:a,a:n}){const r=$e(e),i=$e(t),o=$e(a);return $e(n)<<24|r<<16|i<<8|o},aG:"https://chat.reddit.com/",aH:(e,t)=>new CustomEvent("rpl:menu-clicked-item",{bubbles:!0,composed:!0,cancelable:!0,detail:{type:e,item:t}}),aI:t=>Object.values(e.d7).includes(t),aJ:({item:e,reason:t})=>new CustomEvent("rpl:menu-close",{bubbles:!0,composed:!0,detail:{item:e,reason:t,itemPath:[e]}}),aK:t=>Object.values(e.d8).includes(t),aL:S,aM:Xe,aN:Ge,aO:Ke,aP:"config/automoderator",aQ:"config/post_removal_message",aR:Be,aS:50,aT:100,aU:"templateSelector",aV:(t,a)=>e.b({source:"moderator",action:"unhighlight",noun:"post"},{post:{id:t},...(a ? {action_info:{page_type:a}} : {})}),aW:async function(t){const a={input:t},{data:n,errors:r}=await ne({operation:e.O.RemoveHighlightedPost,variables:a});if(r?.length)throw new Error(ae());const{removeHighlightedPost:i}=n;if(!i?.ok)throw new Error(ae())},aX:()=>e.b({source:"post",action:"click",noun:"ignore_reports"}),aY:()=>e.b({source:"post",action:"click",noun:"restore_reports"}),aZ:()=>e.b({source:"comment",action:"click",noun:"ignore_reports"}),a_:()=>e.b({source:"comment",action:"click",noun:"restore_reports"}),aa:(e,t,a)=>{if(!t)return T(e);const n=((e,t,a)=>{for(let n=1;n<e.length;n++){const r=(t+n)%e.length,i=e[r];if(r<t&&!a)return null;if(f(i))return i}return f(e[t])?e[t]:null})(e,t[1],a);return n?N(n):null},ab:e=>S in e,ac:{MenuItem:"menuitem",Button:"button",Link:"link",Checkbox:"menuitemcheckbox",Radio:"menuitemradio"},ad:w,ae:e=>{try{return new URL(e).hostname.endsWith("reddit.com")}catch(e){return!1}},af:z,ag:e=>e.startsWith("https://alb.reddit.com/cr"),ah:function({el:t,outboundUrl:a,clickLocation:n,galleryIndex:r}){const i=z(t),o=i?.placement||("placement"in t?t.placement:void 0),s=i?.id||t?.id||("postId"in t?t?.postId:""),l=i?.impressionId||("impressionId"in t?t?.impressionId:""),c=e.c("observe-ad-click",{postId:s,impressionId:l,outboundUrl:a,galleryIndex:r,clickLocation:n});t.dispatchEvent(c),e.a8.isAvailable()&&(e.a8.setItem(e.a9.LastClickedAdId,s),e.a8.setItem(e.a9.ImpressionId,l),e.a8.setItem(e.a9.AdPlacement,o||""))},ai:j,aj:K,ak:function(){return"button_appearance"===e.b4(e.lY)||e.b4(e.lY)===G},al:P,am:2e3,an:"reddit-search:open",ao:"onboarding",ap:"dismiss",aq:function(e){return!!e},ar:"pdp-ama-comment-tab-wrapper",as:(e,t)=>{const a=e.getBoundingClientRect(),n=t.getBoundingClientRect();return Math.floor(a.top)>=Math.floor(n.top)&&Math.ceil(a.bottom)<=Math.ceil(n.bottom)&&Math.ceil(a.right)<=Math.ceil(n.right)&&Math.floor(a.left)>=Math.floor(n.left)},at:(e,t)=>Me({action:"add",noun:"subreddit"},e,t),au:(e,t)=>Me({action:"remove",noun:"subreddit"},e,t),av:ie,aw:5,ax:e=>!!e&&(e.indexOf("profileIcon_snoo")>-1||e.indexOf("snoovatar/avatars")>-1||e.endsWith("snoovatar_anonymous.svg")),ay:function(e){return!!e&&Xe.test(e)},az:function(e){const t=3===(e=e.replace("#","")).length,a=6===e.length,n=8===e.length;if(!t&&!a&&!n)throw new Error("unexpected hex "+e);let r=0,i=0,o=0;return t?(r=xe(e.slice(0,1).repeat(2)),i=xe(e.slice(1,2).repeat(2)),o=xe(e.slice(2,3).repeat(2))):a?(r=xe(e.slice(0,2)),i=xe(e.slice(2,4)),o=xe(e.slice(4,6))):n&&(r=xe(e.slice(2,4)),i=xe(e.slice(4,6)),o=xe(e.slice(6,8))),(255<<24|(255&r)<<16|(255&i)<<8|255&o)>>>0},b:De,b$:ze,b0:"comment-composer-cancel-draft",b1:(t="post_detail",a)=>e.b({source:t,action:"click",noun:"downvote_comment"},{action_info:{trigger_type:a}}),b2:(t="post_detail",a)=>e.b({source:t,action:"click",noun:"upvote_comment"},{action_info:{trigger_type:a}}),b3:(t="post_detail",a)=>e.b({source:t,action:"click",noun:"clearvote_comment"},{action_info:{trigger_type:a}}),b4:function(){return"vote_component"===e.b4(e.lY)||e.b4(e.lY)===G},b5:class{constructor(e){this.isRegistered=!1,this.config=e}async loadScript(){const{siteKey:e,nonce:t,timeout:a=c}=this.config,n=`${l}?render=${e}`;if(this.isRegistered)return await d.get(e),void (await u(a));if(d.has(e)){const t=d.get(e);this.isRegistered=!0;const n=h.get(e)||0;return h.set(e,n+1),await t,void (await u(a));}const r=document.querySelector(`script[src*="${n}"]`);if(r){const t=Promise.resolve(r);d.set(e,t),this.isRegistered=!0;const n=h.get(e)||0;return h.set(e,n+1),void (await u(a));}const i=new Promise(((a,r)=>{const i=document.createElement("script");i.src=n,i.async=!0,t&&(i.nonce=t),i.onload=()=>a(i),i.onerror=()=>r(new Error(`Failed to load reCAPTCHA script for site key: ${e}`)),document.body.appendChild(i)}));d.set(e,i),this.isRegistered=!0;const o=h.get(e)||0;h.set(e,o+1),await i,await u(a)}async generateToken(e){const t=e||this.config.action;if(!t)throw new Error("Action is required for token generation");return this.generateRecaptchaToken({siteKey:this.config.siteKey,action:t,maxRetries:this.config.maxRetries,retryDelay:this.config.retryDelay})}async generateTokenSafe(e){try{return await this.generateToken(e)}catch(e){return window.Sentry?.captureException(e),null}}async loadAndGenerateTokenSafe(e){return await this.loadScript(),this.generateTokenSafe(e)}destroy(){if(!this.isRegistered)return;const{siteKey:e}=this.config,t=h.get(e)||0,a=Math.max(0,t-1);if(0===a){const t=`${l}?render=${e}`,a=document.querySelector(`script[src*="${t}"]`);a&&a.remove(),d.delete(e),h.delete(e)}else h.set(e,a);this.isRegistered=!1}async generateRecaptchaToken(t){const{siteKey:a,action:n,maxRetries:r=p,retryDelay:i=c}=t;let o=0;for(;o<r;)try{if(!m())throw new Error("reCAPTCHA not ready");const e=await(window.grecaptcha?.enterprise?.execute?.(a,{action:n}));if("string"!=typeof e||!e)throw new Error("Failed to retrieve a valid reCAPTCHA token.");return e}catch(t){if(t instanceof Error&&t.message.includes("Invalid site key or not loaded in api.js")&&(o++,o<r)){await e.e2(i);continue}throw t}throw new Error("Failed to generate reCAPTCHA token after maximum retries")}},b6:function(e){return`${Pe}${e}`},b7:function(e){return JSON.stringify(a(e))},b8:t=>e.b({source:"achievements",action:"click",noun:"card_icon"},{action_info:{page_type:t}}),b9:t=>e.b({source:"achievements",action:"click",noun:"profile_showcase"},{action_info:{page_type:t}}),bA:"/svc/shreddit/edit-comment",bB:(t,{communityId:a,communityName:n})=>e.i(t,e.b({source:"community_page",action:"click",noun:"communities_menu",subreddit:{name:n,id:a}})),bC:ae,bD:(t,a)=>e.b({source:"moderator",action:"highlight",noun:"post"},{post:{id:t},...(a ? {action_info:{page_type:a}} : {})}),bE:function(e){return{source:"feed_experience",action:e?"unsubscribe":"subscribe",noun:"subreddit"}},bF:function(){return{source:"feed_experience_overflow",noun:"hide",action:"click"}},bG:function(){return{source:"feed_experience",action:"impression",noun:"feed_experience"}},bH:"login",bI:t=>e.b({source:Q,action:"click",noun:ee(t)?"reorder_post_flair_confirm":"reorder_flair_confirm"}),bJ:function(){return document&&document.documentElement.lang?document.documentElement.lang:navigator&&navigator.language?navigator.language:"en-US"},bK:function(e,t,a){return!0===(null==a?void 0:a.short)?e.toLocaleDateString(t,{month:"short",day:"numeric"}):e.toLocaleString(t,null==a?void 0:a.options)},bL:function(e){return new Date(e.replace("+0000","+00:00"))},bM:function(t,a){return e.o({attributes:a,appearance:Se[t],leadingIcon:e.al()})},bN:function(t){return t===e.ag.ModQueueCompactView},bO:1,bP:25,bQ:"table-pagination__page-size-updated",bR:function(e){return e?"Settings saved.":"Failed to save settings. Please try again.";},bS:function(e=!1){return e?"Saved":"Save changes";},bT:function(e,{displayFull:t,roundDown:a,maxDigits:n,removeZeroDecimal:r}={}){return t?(e=>{const t=e.split(".");return [t[0].replace(/\B(?=(\d{3})+(?!\d))/g,",")].concat(t.slice(1)).join(".");})(e.toString()):e>=99999999949?`${Je({num:e,divider:qe,maxDigits:n,removeZeroDecimal:r})}b`:e>=999999949&&e<99999999949?`${Je({num:e,divider:qe,defaultFixed:1,maxDigits:n,removeZeroDecimal:r})}b`:e>=99999949&&e<999999949?`${Je({num:e,divider:We,maxDigits:n,removeZeroDecimal:r})}m`:e>=999949&&e<99999949?`${Je({num:e,divider:We,defaultFixed:1,maxDigits:n,removeZeroDecimal:r})}m`:e>=99949&&e<999949?`${Je({num:e,divider:Ze,maxDigits:n,removeZeroDecimal:r})}k`:e>=Ze&&e<99949?a?`${Ye(e,Ze)}k`:`${Je({num:e,divider:Ze,defaultFixed:1,maxDigits:n,removeZeroDecimal:r})}k`:String(e);},bU:"wiki-banned-users__unban",bV:"wiki-banned-users__ban",bW:"wiki-banned-users__edit",bX:"wiki-banned-contributors-confirmation-modal",bY:"wiki-banned-contributors-ban-modal",bZ:"ama-comment-tabs-ready",b_:"ama-status-bar-ready",ba:t=>e.b({source:Q,action:"click",noun:ee(t)?"clear_post_flair_name":"clear_flair_name"}),bb:(t,a)=>e.b({source:Q,action:"click",noun:ee(t)?"enable_post_flair":"enable_user_flair"},{action_info:{setting_value:a?"toggle on":"toggle off"}}),bc:(t,a)=>e.b({source:Q,action:"click",noun:ee(t)?"let_users_assign_post_flair":"let_users_assign_flair"},{action_info:{setting_value:a?"toggle on":"toggle off"}}),bd:t=>e.b({source:Q,action:"click",noun:ee(t)?"reorder_post_flair_dialog":"reorder_flair_dialog"}),be:()=>e.b({source:"post_detail",action:"click",noun:"load_more_comments"}),bf:function(t,a){if(!t)return;const{html:n}=e.a();return n` <span class="flex items-center justify-center">${Array.isArray(t)?n`${t.map((t=>e.o({...t,appearance:Se[a]})))}`:e.o(t)}</span>`},bg:e=>Me({action:"delete",noun:"custom_feed"},e),bh:"table-pagination__paginate-previous",bi:"table-pagination__paginate-next",bj:H,bk:F,bl:U,bm:t=>e.b({source:Q,action:"click",noun:ee(t)?"change_post_flair_color":"change_flair_color"}),bn:(t,a,n)=>e.b({source:Q,action:"click",noun:ee(t)?"post_flair_edit_save":"flair_edit_save"},te(t,a,n)),bo:(t,a,n)=>e.b({source:Q,action:"click",noun:ee(t)?"create_post_flair_confirm":"create_flair_confirm"},te(t,a,n)),bp:class{get active(){return this.duration>0}get timeRemaining(){return`${Math.floor(this.duration/6e4)}:${Math.ceil(this.duration%6e4/1e3).toString().padStart(2,"0")}`}get secondsRemaining(){return Math.ceil(this.duration/1e3).toString()}constructor(e){this.duration=0,this.interval=0,this.update=()=>{this.duration=this.duration-this.interval,this.duration<=0&&this.reset(),this.host.requestUpdate()},this.host=e,this.host.addController(this)}hostDisconnected(){this.reset()}reset(){clearInterval(this.timeout),this.duration=0,this.interval=0}start(e,t=1e3){this.reset(),this.duration=e,this.interval=t,this.timeout=setInterval(this.update,this.interval),this.host.requestUpdate()}},bq:"click",br:"back",bs:function(t){const a=e.a8.getItem(e.a9.AdEvents);if(null===a)return null;let n;try{n=JSON.parse(a)}catch{return null}return n.impressionId!==t?null:(e.a8.removeItem(e.a9.AdEvents),n)},bt:function(){const t=e.a8.getItem(e.a9.AdUserTargeting);if(null===t)return null;let a;try{a=JSON.parse(t)}catch{return null}return e.a8.removeItem(e.a9.AdUserTargeting),a},bu:()=>e.b({source:"comment",action:"click",noun:"load_more_comments"}),bv:()=>e.b({source:"post_detail",action:"click",noun:"comment_image"}),bw:"comment-edit-success",bx:"reloadPollingDurationMs",by:()=>e.b({source:"post_detail",action:"click",noun:"collapse_comment"}),bz:()=>e.b({source:"post_detail",action:"click",noun:"expand_comment"}),c:function(e){return Array.from(function*(e){for(let t=1;t<=e;t++)yield t}(e))},c$:(t,a,n)=>{e.aN({name:e.lU}),e.N({name:e.lU,country:a,value:`${t}`,options:{...e.Q,domain:n}})},c0:Fe,c1:"keyword_list_ready_mark",c2:Oe,c3:"add_keyword_cta_ready_mark",c4:Ue,c5:"trends_chart_ready_mark",c6:He,c7:"conversations_feed_ready_mark",c8:function(t){return t===e.ag.CompactView},c9:()=>"[deleted]",cA:t=>e.i(t,e.b({source:"community_page",action:"click",noun:"favorites"})),cB:t=>e.i(t,e.b({source:"community_search",action:"view",noun:"search_bar"})),cC:t=>e.i(t,e.b({source:"community_search",action:"view",noun:"query_prompt"})),cD:t=>e.i(t,e.b({source:"community_search",action:"click",noun:"search_bar"})),cE:"saved-responses__create",cF:"saved-responses__exit-create-view",cG:"saved-responses__delete",cH:"saved-responses__update-item",cI:"saved-responses__submit",cJ:"saved-responses__open-reorder-modal",cK:"saved_responses__cancel_update",cL:"saved-responses-table__partial_id",cM:"saved_responses__response_delete_modal_id",cN:function(e){return`add-ama-collaborators-modal-${e}`},cO:"wiki-page-setting-modal-dialog",cP:"skip",cQ:"https://www.reddit.com/redditchat/",cR:"chat-mobile-xpromo",cS:e=>e.startsWith("a2_")?e.replace("a2_",""):e.startsWith("t2_")?e.replace("t2_",""):e,cT:e=>/^award_.+\|t\d_.+$/.test(e),cU:class{get matches(){return this.mediaQuery.matches}constructor(e,t){this.host=e,this.query=t,this.rafId=null,this.handleMediaChange=()=>{this.rafId&&cancelAnimationFrame(this.rafId),this.rafId=requestAnimationFrame((()=>{this.rafId=null,this.host.requestUpdate("matches",!this.matches)}))},e.addController(this),this.mediaQuery=window.matchMedia(t),this.mediaQuery.addEventListener("change",this.handleMediaChange)}async hostConnected(){}async hostDisconnected(){}},cV:C,cW:ct,cX:(t,a=!1,n,r)=>{if((r||n)&&t?.type===e.aa.GLOBAL)return "Find anything";switch(t?.type){case e.aa.COMMUNITY:case e.aa.CUSTOM_FEED:return a?`${ct({type:t?.type,path:t.path})}`:`Search in ${ct({type:t?.type,path:t.path})}`;case e.aa.PROFILE:return a?`${ct({type:t?.type,path:t.path})}`:`Search in ${ct({type:t?.type,path:t.path})}`;default:return "Search Reddit";}},cY:M,cZ:(t,a,n)=>{e.aN({name:e.lS}),e.N({name:e.lS,country:a,value:`${t}`,options:{...e.Q,domain:n}})},c_:O,ca:B,cb:"request",cc:"view",cd:"auth_modal",ce:"send",cf:x,cg:function(e,t,a){var n;const r=function(e,t){const a=t.getTime()-e.getTime(),n=Math.round(a/31104e6),r=Math.round(a/2592e6),i=Math.round(a/864e5),o=Math.round(a/36e5),s=a/L;let l="minutes",c=0;return Math.abs(Math.round(s))<60?c=s>-1&&s<1?Math.sign(s)*Math.ceil(Math.abs(s)):Math.round(s):Math.abs(o)<24?(l="hours",c=o):Math.abs(i)<29?(l="days",c=i):Math.abs(r)<11?(l="months",c=r):(l="years",c=n),{unit:l,diff:c}}(new Date,e);try{if(A){return function(e,t,a){return $(t,{localeMatcher:"lookup",numeric:"always",style:a}).format(e.diff,e.unit)}(r,t,null!==(n=null==a?void 0:a.format)&&void 0!==n?n:(null==a?void 0:a.short)?"short":"long")}}catch(e){}return ((null==a?void 0:a.short)||"short"===(null==a?void 0:a.format))&&r.diff<0&&t.match(/en.*/)?D(r):x(t,{dateStyle:"short",timeStyle:"short"}).format(e);},ch:function(e=!1){return e?"Saved":"Save";},ci:"search-media-post-unit",get cj(){return Z},ck:()=>e.b({source:"moderator",action:"click",noun:"reset_rule_defaults_confirmation"}),cl:function*(e,t){if(void 0!==e){let a=0;for(const n of e)yield t(n,a++)}},cm:{STREAK_EXTENDED:"streak_progressed",TROPHY_UNLOCKED:"achievement_unlocked",TROPHY_PROGRESSED:"achievement_progress"},cn:{Total:"#D2DADD",Posts:"#0E8A00",Negative:"#372F8C",Positive:"#008675",Neutral:"#629FFF",Score:"#D93A00",Performance:"#6A5CFF",Comments:"#D93900",Upvotes:"#6A5CFF","Post Upvotes":"#DE019F","Comment Upvotes":"#5BA200","Total Upvotes":"#97AFBC","Total Mentions":"#6A5CFF"},co:"saved-responses__reorder",cp:(e,t,a)=>{for(const a of t)if(a[0]===e)return(0,a[1])();return null==a?void 0:a()},cq:"achievement-progress-toast",cr:({attributes:t,title:a,titleDataTestId:n,description:r,buttonProps:i,creative:o,creativeSafe:s=!0})=>{const{html:l,createElement:c}=e.a();return c("div",{...t,className:"flex flex-col items-center w-full",rpl:!0,"rpl-empty-state":!0},l`<div class="w-full flex flex-col items-center overflow-hidden box-border ${!s&&"p-md"}"> ${o} </div> <div class="flex flex-col w-full items-center box-border px-md gap-md ${a||r?"pb-md":""}"> ${a||r?l` <div class="max-w-[480px] flex flex-col items-center text-center"> <div class="text-title-2 font-bold text-neutral-content-strong" data-testid="${e.ad(n)}"> ${a} </div> <div class="text-body-1 text-neutral-content-weak">${r}</div> </div> `:""} ${i?l`<div>${e.o(i)}</div>`:""} </div>`)},cs:"saved-responses__saved",ct:Re,cu:t=>{const{authorId:a,subredditId:n,postId:r,commentId:i,subredditName:o,thingId:s,action:l,noun:c="removal_reasons_flow",type:p,reason:d,isLocked:h,sendAs:u,notificationMethod:m}=t;return e.b({source:"moderator",action:l,noun:c},{user:{id:a},subreddit:{id:n,name:o},post:{id:r??""},comment:{id:i},action_info:{source_name:"removal_reasons",type:p,reason:d},mod_action:{removalreason:{is_locked:h,send_as:u,notify:m}},...(s&&(g=s,g.startsWith("t3_")) && {post:{id:s}}),...(s&&re(s) && {comment:{id:s}})});var g},cv:(t,a,n)=>e.b({source:"removal_reasons",action:"click",noun:"submit"},{mod_action:{removalreason:t},action_info:{reason:a},subreddit:{id:n?.subredditId},post:{id:n?.postId??""},comment:{id:n?.commentId}}),cw:()=>e.b({source:"removal_reasons",action:"click",noun:"cancel"}),cx:e=>Me({action:"duplicate",noun:"custom_feed"},e),cy:e=>Me({action:"create",noun:"custom_feed"},e),cz:t=>e.i(t,e.b({source:"community_page",action:"click",noun:"all_communities"})),d:class{constructor(e){this.host=e,this.slotsCache=new Map,this.hasContentsCache=new Map,this.slotTextCache=new Map,this.handleSlotChange=e=>{if(!(e.target instanceof HTMLSlotElement))return;const t=e.target,a=t.hasAttribute("name")?t.name:"default",n=this.hasContentsCache.get(a),r=w(t);this.slotsCache.set(a,t),this.hasContentsCache.set(a,w(t)),this.slotTextCache.delete(a),n!==r&&this.host.requestUpdate()},e.addController(this)}hostConnected(){}getSlot(e){const t=this.slotsCache.get(e);if(void 0!==t)return t;const a=this.host.shadowRoot?.querySelector("default"===e?"slot:not([name])":`slot[name="${e}"]`);return a instanceof HTMLSlotElement?(this.slotsCache.set(e,a),a):null}hasSlotContent(e){return this.hasContentsCache.get(e)??!1}getSlotText(e){const t=this.slotTextCache.get(e);if(void 0!==t)return t;if(!(this.hasContentsCache.get(e)??!1))return this.slotTextCache.set(e,null),null;const a=this.getSlot(e);if(!a)return null;const n=(e=>{const t=e.assignedNodes({flatten:!0}),a=[];for(const e of t)e.nodeType===Node.TEXT_NODE&&e.textContent?.match(/\S/)&&a.push(e.textContent.trim()),e.nodeType===Node.ELEMENT_NODE&&e.textContent?.match(/\S/)&&a.push(e.textContent.trim());return a.length>0?a.join(" "):null})(a);return this.slotTextCache.set(e,n),n}},d0:()=>e.K.get(e.lT),d1:(t,a,n)=>{e.aN({name:e.lT}),e.N({name:e.lT,country:a,value:`${t}`,options:{...e.Q,domain:n}})},d2:function(t){return t===e.ag.CardView},d3:"emote|",d4:"giphy|",d5:a,d6:function({fieldErrors:e,defaultMessage:t}){return e?.[0]?.message??t},d7:"wiki-revision-note-modal-dialog",d8:"wiki-page-tabs",d9:"hidePostSubmitLink",da:"isTranslatable",db:"targetLanguage",dc:({adjacentElement:t})=>{if(!e.l2(e.l3()))return()=>{};const a=document.createElement("input");return a.setAttribute("type","text"),a.style.position="absolute",a.style.opacity="0",a.style.height="0",a.style.fontSize="16px",t.insertAdjacentElement("afterend",a),a.focus(),()=>a.remove()},dd:"comment-deletion-modal",de:t=>e.b({source:t,action:"click",noun:"follow"}),df:t=>e.b({source:t,action:"undo",noun:"follow"}),dg:"list-reply-comment-button",dh:t=>e.b({source:t,action:"click",noun:"save"}),di:t=>e.b({source:t,action:"click",noun:"unsave"}),dj:e=>!e||e.includes("avatar_default_"),dk:function(t){const a={[e.is.Female]:"Woman",[e.is.Male]:"Man",[e.is.NonBinary]:"Non-binary",[e.is.OptOut]:"I prefer not to say",[e.is.UserDefined]:"I refer to myself as..."};return t?a[t]:a},get dl(){return dt},e:function(e,t){return function(e,t){void 0===t&&(t={});var a=function(e){return e&&e.sensitive?"":"i"}(t),n=t.encode,r=void 0===n?function(e){return e}:n,i=t.validate,o=void 0===i||i,s=e.map((function(e){if("object"==typeof e)return new RegExp("^(?:".concat(e.pattern,")$"),a)}));return function(t){for(var a="",n=0;n<e.length;n++){var i=e[n];if("string"!=typeof i){var l=t?t[i.name]:void 0,c="?"===i.modifier||"*"===i.modifier,p="*"===i.modifier||"+"===i.modifier;if(Array.isArray(l)){if(!p)throw new TypeError('Expected "'.concat(i.name,'" to not repeat, but got an array'));if(0===l.length){if(c)continue;throw new TypeError('Expected "'.concat(i.name,'" to not be empty'))}for(var d=0;d<l.length;d++){var h=r(l[d],i);if(o&&!s[n].test(h))throw new TypeError('Expected all "'.concat(i.name,'" to match "').concat(i.pattern,'", but got "').concat(h,'"'));a+=i.prefix+h+i.suffix}}else if("string"!=typeof l&&"number"!=typeof l){if(!c){var u=p?"an array":"a string";throw new TypeError('Expected "'.concat(i.name,'" to be ').concat(u))}}else{h=r(String(l),i);if(o&&!s[n].test(h))throw new TypeError('Expected "'.concat(i.name,'" to match "').concat(i.pattern,'", but got "').concat(h,'"'));a+=i.prefix+h+i.suffix}}else a+=i}return a}}(Y(e,t),t)},f:({size:t="sm",appearance:a="default",snoovatarAlt:n="User Avatar",ringLayer:r,attributes:i,...o})=>{const{html:s,ifDefined:l}=e.a(),c="icon"===a||"subreddit"===a;return s`<span class="inline-flex items-center justify-center ${oe[t]} ${i?.className}" rpl avatar ?flip="${o.flip}" id="${l(i?.id)}" slot="${l(i?.slot)}"> ${r&&!c?r:""} ${c?(({attributes:t,children:a,size:n,appearance:r,status:i,ringColorClassName:o})=>{const s="icon"===r?"rounded-full":ge[n],{html:l,ifDefined:c}=e.a();return l`<span rpl id="${c(t?.id)}" slot="${c(t?.slot)}" class="inline-block ${s} ${fe({ringColorClassName:o,size:n})} relative [&>:first-child]:h-full [&>:first-child]:w-full [&>:first-child]:mb-0 [&>:first-child]:rounded-[inherit] h-full w-full [&>:first-child]:overflow-hidden [&>:first-child]:max-h-full"> ${a}${Ne({status:i,size:n})} </span>`})({size:t,attributes:i,appearance:a,...o}):ve({attributes:i,snoovatarAlt:n,appearance:a,ringLayer:r,size:t,...o})}</span>`},g:i,h:function(){return{source:"feed_experience",action:"impression",noun:"subreddit"}},i:({listId:e,seeButtonId:t})=>{const a=document.querySelector(`#${e}`),n=a?.querySelectorAll(".hidden"),r=a?.querySelector(`#${t}`),i=r?.getAttribute("data-see-less-label"),o=r?.getAttribute("data-see-more-label");if((!r||!je.has(r))&&a&&r&&n&&i&&o){let e=!0;r.addEventListener("click",(()=>{Array.from(n).forEach((t=>{e?t.classList.remove("hidden"):t.classList.add("hidden")})),r.textContent=e?i:o,e=!e})),je.add(r)}},j:(...e)=>e.filter(Boolean).join(" "),k:function(){return{source:"feed_experience",action:"consume",noun:"subreddit"}},l:t=>e.b({source:"global",action:"view",noun:"screen"},{action_info:{page_type:e.au.AchievementDetail,...(t ? {type:t} : {})}}),m:function(e="#preview"){Qe((function(){const t=document.querySelector(e);t?.classList.contains(pt)||t?.classList.add(pt)}))},n:(e,t=e.tagName.toLowerCase())=>{const a=e=>(""===e&&(e="generic"),t+":"+e);return{dispatch:(t,n={bubbles:!0,cancelable:!0,composed:!0})=>e.dispatchEvent(new CustomEvent(a(t),n)),eventId:a}},o:function(e,t){return null!==e.querySelector(`:scope > [slot="${t}"]`)},p:()=>e.b({source:"comment",action:"click",noun:"share"}),q:()=>e.b({source:"comment",action:"click",noun:"share_copy"}),r:(t,a)=>{e.a8.isAvailable()&&e.a8.setItem(t,JSON.stringify(a))},s:Qe,t:function({el:t,clickLocation:a,galleryIndex:n}){try{const r=z(t),i=r?.placement||("placement"in t?t?.placement:void 0),o=r?.postId||("postId"in t?t?.postId:""),s=r?.impressionId||("impressionId"in t?t?.impressionId:""),l=r?r.querySelector(`[click-location=${e.D.MEDIA}]`):t.querySelector(`[click-location=${e.D.MEDIA}]`);let c;l&&(c=l.getBoundingClientRect());const p=e.cr();e.i(t,(({postId:t,adMedia:a,impressionId:n,post:r,clickLocation:i=e.D.UNKNOWN,galleryIndex:o,page_request_id:s,placement:l})=>{const c={post:{id:t,subreddit_id:r?.subredditId,author_id:r?.authorId,promoted:!0},ad_click:{location:i},ad_metadata:{impression_id:n,placement:H({post:r,placement:l})},feed:e.f3(),action_info:{page_request_id:s}};return r&&F(r)&&(c.action_info||(c.action_info={}),c.action_info.position=r.feedIndex,c.screen||(c.screen={}),c.screen={},c.screen.view_type=e.f4(r.viewType)),r?.galleryItems&&(c.gallery={position:o,num_items:r.galleryItems.length}),r?.countryCode&&(c.geo={country_code:r.countryCode}),a&&(c.media={height:Math.round(a?.height),width:Math.round(a?.width)}),e.b(e.lV,c)})({postId:o,impressionId:s,post:r,adMedia:c,clickLocation:a,galleryIndex:n||0,page_request_id:p,placement:i}))}catch(e){const t="Sentry"in window?window.Sentry:void 0;t?.captureException&&(e.message&&(e.message=`post/click/ad exception: ${e.message}`),t.captureException(e))}},u:t=>{if(!e.a8.isAvailable())return;const a=e.a8.getItem(t);if(a)try{return JSON.parse(a)}catch{return}},v:e=>{window.location.href=e||window.location.href},w:function(){return window.matchMedia("(pointer: coarse)").matches},x:()=>"Comment deleted by user",y:(e,t)=>{const a=e.composedPath(),n=Array.isArray(t)?t.map((e=>e.toUpperCase())):[t.toUpperCase()];for(const e of a)if(n.includes(e.tagName))return!0;return!1},z:function(e,t){const a=e.composedPath();for(const e of a){const a=e.dataset,n=a&&a[t];if(null!=n)return n}return null}};}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BwcUp7XlaC.js",import.meta.url,"BwcUp7XlaC");
SML.dm("B0p6XlbwHt",["Dw4vb8Yfbm","5r73EsgItq","BwcUp7XlaC"],(async(e,t,r)=>{var a,i;!function(e){e.BORDERED="bordered",e.SECONDARY="secondary",e.PLAIN="plain"}(a||(a={})),function(e){e.COLLAPSED="collapsed",e.EXPANDED="expanded"}(i||(i={}));let n=class extends r.T{constructor(){super(...arguments),this.appearance=a.SECONDARY,this.size=i.COLLAPSED,this._textAreaContainerRef=e.a3()}static get styles(){return[super.styles,t.a`:host(){--trailing-icons-container:var(--rem32)}:host([resize]) .label-container{overflow:auto}.label-container:not(.without-label){padding-top:var(--spacer-xs);padding-bottom:var(--spacer-xs)}:host([resize]) textarea{height:100%;width:100%}:host([resize=both]) .label-container{resize:both}:host([resize=horizontal]) .label-container{resize:horizontal}:host([resize=vertical]) .label-container{resize:vertical}textarea{background:0 0;border:none;outline:0;overflow-y:auto;resize:none}:host([size=expanded]:not([rows])) .label-container{height:fit-content;min-height:var(--rem90)}:host(:not([rows])) textarea{min-height:var(--rem20,1.25rem);height:var(--rem20,1.25rem)}:host(:not([cols])) textarea{width:100%}.label-text{top:0}:host([appearance=bordered]) .label-container{border:1px solid var(--color-neutral-border)}:host([appearance=bordered]) .label-container:hover{border-color:var(--color-neutral-border-medium)}:host([appearance=bordered]) .label-container:hover,:host([appearance=plain]) .label-container:hover{background:var(--color-neutral-background-hover);border-radius:none}:host([appearance=plain]) .label-container{border-radius:0}.input-boundary-box,.input-container,:host .label-container,label{height:100%;width:100%;box-sizing:border-box}:host([size=expanded]) .input-container{height:calc(100% - var(--trailing-icon-container,0px))}.input-container{align-items:flex-start}:host .label-container{border-radius:var(--radius-md)}.input-boundary-box{flex-direction:column}:host(:not([size])) .input-boundary-box,:host([size=collapsed]) .input-boundary-box{flex-direction:row;min-height:var(--rem40);padding:var(--spacer-2xs) 0}:host([size=expanded]) #trailing-icons-container{width:100%;justify-content:flex-end}#trailing-icons-container{height:(--trailing-icons-container)}.text-area-wrapper{height:inherit;width:100%;min-height:var(--textarea-minheight,var(--rem20));display:flex}`]}updated(e){e.has("value")&&this.handleDynamicResize(),super.updated(e)}async handleDynamicResize(){if(!this.rows&&!this.cols){const{width:e}=this.innerTextArea.getBoundingClientRect();this.innerTextArea.style.overflow="hidden",this.innerTextArea.style.height="0",this.innerTextArea.style.width=`${e}px`;const t=`${this.innerTextArea?.scrollHeight}px`;this.innerTextArea.style.height=t,this.innerTextArea.style.removeProperty("overflow"),this.innerTextArea.style.removeProperty("width"),this._textAreaContainerRef?.value&&this._textAreaContainerRef.value.style.setProperty("--textarea-minheight",t)}}onInput(e){this.handleDynamicResize(),super.onInput(e)}render(){return super.renderInput(t.x` <div class="text-area-wrapper" ${e.a4(this._textAreaContainerRef)}> <textarea aria-labelledby="fp-input-label" style="${e.ad(this.fontFamily?`font-family: ${this.fontFamily}`:void 0)}" class="${e.Z({"no-label":!this.hasLabel})}" ?readonly="${this.readonly}" id="innerTextArea" rows="${e.ad(this.rows)}" cols="${e.ad(this.cols)}" @input="${this.onInput}" @change="${this.onChange}" .value="${r.l(this.value)}" name="${e.ad(this.name)}" minlength="${e.ad(this.minLength)}" maxlength="${e.ad(this.allowMaxLengthOverflow?void 0:this.maxLength)}" placeholder="${e.ad(0===this.placeholder.length?void 0:this.placeholder)}" ?disabled="${this.disabled}" ?required="${this.required}" autocomplete="${e.ad(this.autocomplete)}" inputmode="${e.ad(this.inputmode)}"></textarea> </div>`)}};return e._([e.n({type:Number})],n.prototype,"rows",void 0),e._([e.n({type:Number})],n.prototype,"cols",void 0),e._([e.n({type:String})],n.prototype,"resize",void 0),e._([e.a2("#innerTextArea")],n.prototype,"innerTextArea",void 0),e._([e.n({type:String,reflect:!0})],n.prototype,"appearance",void 0),e._([e.n({type:String})],n.prototype,"size",void 0),e._([e.n({type:String,attribute:"font-family"})],n.prototype,"fontFamily",void 0),n=e._([e.e("faceplate-textarea-input")],n),{get F(){return n},get T(){return i},get a(){return a}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("B0pL5bhFHV",["Dw4vb8Yfbm","5r73EsgItq","BtqmVQuPYp","B-zFJtiar6"],(async(e,t,i,o)=>{const s=(e,t,{parentBoundary:i=document.documentElement,root:a=document,cache:n=new Set})=>{const r=a.elementsFromPoint(e,t),h=[];for(const e of r)if(!n.has(e)){if(!o.Y(i,e))break;h.push(e),n.add(e)}const d=[];for(const i of h)i.shadowRoot&&d.push(...s(e,t,{parentBoundary:i,root:i.shadowRoot,cache:n}));return[...h,...d]};class a{get inSwipe(){return this._inSwipe}set inSwipe(e){this._inSwipe!==e&&(this._inSwipe=e,this.host.requestUpdate("inSwipe",!this._inSwipe))}constructor(e,{recognitionThreshold:t=10,mouseSupport:i=!1}={recognitionThreshold:10,mouseSupport:!1}){this.host=e,this.mouseSupport=!1,this.rafId=null,this._inSwipe=!1,this.protectScrollInterference=!0,this.recognitionThreshold=t,this.mouseSupport=i}clearRaf(){this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null)}addListeners(e){this.gesture=new i.T(e,{mouseSupport:this.mouseSupport}),this.gesture.on("panstart",this.handleTouchStart.bind(this)),this.gesture.on("panmove",this.handleTouchMove.bind(this)),this.gesture.on("panend",this.handleTouchEnd.bind(this))}removeListeners(){this.gesture?.destroy()}reset(){const e=this.gesture?.element;e&&(this.removeListeners(),this.addListeners(e))}handleTouchStart(e){this.clearRaf(),this.gesture&&this.host.handleSwipeMayStart?.(this.gesture)}handleTouchMove(t){if(this.clearRaf(),!this.gesture)return;const i=(this.gesture.touchMoveY??0)<=0;if(!this.inSwipe&&Math.abs((this.gesture.touchStartY??0)-(this.gesture.touchEndY??0))>this.recognitionThreshold){if(this.protectScrollInterference){const[o,a]=n(t),r=s(o,a,{parentBoundary:this.gesture.element}).filter((t=>t instanceof HTMLElement&&e.ik(t)));if(i&&r.some((t=>!e.il(t)))||!i&&r.some((t=>!e.im(t))))return this.reset()}!1!==this.host.handleSwipeWillStart?.({...this.gesture,swipeDirection:i?"up":"down"})?(this.inSwipe=!0,this.host.handleSwipeProgress?.({...this.gesture,swipeDirection:i?"up":"down"})):this.reset()}this.inSwipe&&this.gesture&&(this.rafId=requestAnimationFrame((()=>{this.host.handleSwipeProgress?.({...this.gesture,swipeDirection:i?"up":"down"})})))}handleTouchEnd(e){this.gesture&&(this.clearRaf(),this.inSwipe=!1,this.host.handleSwipeEnd?.(this.gesture))}disableScrollInterferenceProtection(){this.protectScrollInterference=!1}enableScrollInterferenceProtection(){this.protectScrollInterference=!0}}const n=e=>e instanceof MouseEvent?[e.clientX,e.clientY]:[e.touches[0].clientX,e.touches[0].clientY],r="expanded",h="normal",d="docked";var l,c=t.a`${e.a7}:host{--transition-duration:250ms;display:contents}.dialog{--bottom-sheet-docked-height:'auto';--bottom-sheet-normal-height:'auto';--bottom-sheet-height:var(--bottom-sheet-normal-height)}.dialog{--bottom-sheet-expanded-height:85vh}@supports (height:95dvh){.dialog{--bottom-sheet-expanded-height:95dvh}}.dialog.state-normal{--bottom-sheet-height:1fr}.dialog.state-docked{--bottom-sheet-height:var(--bottom-sheet-docked-height)}.dialog.state-expanded{--bottom-sheet-height:var(--bottom-sheet-expanded-height)}.dialog{display:flex;align-items:center;justify-content:center;position:fixed;inset:0;z-index:var(--z-index-dialog,1000);user-select:none;pointer-events:none;width:100vw}.dialog-panel{display:grid;grid-template-rows:auto var(--bottom-sheet-height);grid-auto-flow:column;position:fixed;z-index:2;bottom:0;right:0;touch-action:none;transform:translateY(100%);max-height:var(--bottom-sheet-expanded-height);width:100%;background-color:var(--color-ui-modalbackground);border-start-start-radius:var(--radius-md);border-start-end-radius:var(--radius-md);box-shadow:var(--boxshadow-modal);transition:--bottom-sheet-height var(--transition-duration) ease,grid-template-rows var(--transition-duration) ease,transform var(--transition-duration) ease}.dialog.reflect-gesture .dialog-panel{grid-template-rows:auto var(--bottom-sheet-forced-height);transition:none}.dialog-variant-plain .dialog-panel{max-width:100%;max-height:100%;background-color:transparent;border-radius:initial;box-shadow:initial}.dialog-panel:focus{outline:0}.dialog-open{user-select:auto}.dialog-open .dialog-overlay,.dialog-open .dialog-panel{pointer-events:auto}.dialog-open .dialog-panel{opacity:1;transform:translateY(0)}.dialog-overlay{position:fixed;inset:0;background-color:rgba(0,0,0,.5)}.dialog-overlay-blur{backdrop-filter:blur(var(--dialog-backdrop-blur, 4px))}.dialog-overlay-no-modal{display:none}.handle-container{display:flex;justify-content:center;align-items:flex-end;width:100%}.handle-container-inside{--handle-color:var(--color-neutral-border);padding-top:var(--rem8);padding-bottom:var(--rem4)}.handle-container-outside{--handle-color:var(--color-global-white);padding-bottom:var(--rem8);padding-top:var(--rem4);position:relative;top:-16px}.handle-container-hidden{--handle-color:transparent;padding-top:var(--rem12)}.handle{display:block;background:var(--handle-color);width:var(--rem48);height:var(--rem4);border-radius:10000rem}`;!function(e){e.Inside="inside",e.Outside="outside",e.Hidden="hidden"}(l||(l={}));let p=class extends e.io{constructor(){super(...arguments),this.resizeController=new e.ip(this,{callback:()=>this.updateDimensions,elements:{slottedElement:()=>this.slottedElement,styledDialogChildWithHeader:()=>this.styledDialogChildWithHeader,panel:()=>this.panelRef.value}}),this.gestureController=new a(this,{recognitionThreshold:10}),this.slottedElement=null,this.styledDialogChildWithHeader=null,this.handleContainer=e.a3(),this.animationNames={show:"bottomSheet.show",hide:"bottomSheet.hide",denyClose:"bottomSheet.denyClose",denyExpand:"bottomSheet.denyExpand",overlayShow:"bottomSheet.overlay.show",overlayHide:"bottomSheet.overlay.hide"},this.openState=h,this.dockable=!1,this.expandable=!1,this.handlePosition=l.Outside,this.handleDockButtonClicked=e=>{e.stopPropagation(),this.open&&(this.isDocked?this.undock():this.dock())},this.updateDimensions=async e=>{const t=this.slottedElement;t&&e.some((e=>e.target===t))&&this.slottedElement&&this.styledDialogChildWithHeader&&this.updateDockedHeight(),this.requestUpdate(),this.emitter.dispatch("resize")}}get isDocked(){return this.openState===d}get isExpanded(){return this.openState===r}get isNormal(){return this.openState===h}addOpenListeners(){super.addOpenListeners(),this.resizeController.observeAllElements(),this.portalContainer.addEventListener("rpl-modal-card:dock-button-clicked",this.handleDockButtonClicked),this.panelRef.value&&this.gestureController.addListeners(this.panelRef.value)}removeOpenListeners(){super.removeOpenListeners(),this.resizeController.unobserveAllElements(),this.gestureController.removeListeners(),this.portalContainer.removeEventListener("rpl-modal-card:dock-button-clicked",this.handleDockButtonClicked)}willUpdate(e){return e.has("dockable")&&!this.dockable&&this.isDocked&&(this.dockable=!0),e.has("expandable")&&!this.expandable&&this.isExpanded&&(this.expandable=!0),e.has("openState")&&this.isExpanded&&!this.expandable&&(this.openState=e.get("openState")??h),e.has("openState")&&this.isDocked&&!this.dockable&&(this.openState=e.get("openState")??h),(e.get("openState")||e.get("dockable"))&&this.styledDialogChildren.size>0&&this.styledDialogChildren.forEach((e=>{e.dockable=this.dockable,e.docked=this.isDocked})),e.has("openState")&&(this.isDocked?this.gestureController.disableScrollInterferenceProtection():this.gestureController.enableScrollInterferenceProtection()),super.willUpdate(e)}getCachedHeightContainer(e){return["forced","forcedInitial"].includes(e)?this.panelRef.value:this.dialogRef.value}setCachedHeight(e,t){this.getCachedHeightContainer(e)?.style.setProperty(u[e],t)}getCachedHeight(e){const t=this.getCachedHeightContainer(e);return t?getComputedStyle(t).getPropertyValue(u[e])??"auto":"auto"}async updateDockedHeight(){if(!this.styledDialogChildWithHeader)return;if(await e.iq(this.styledDialogChildWithHeader),!this.styledDialogChildWithHeader)return;const t=this.styledDialogChildWithHeader.headerHeight,i=this.handleContainer.value?.clientHeight??16;t&&this.setCachedHeight("docked",`${t+i}px`)}async expand(){if(!this.open||!this.expandable||this.isExpanded||!this.panelRef.value)return;!this.emitter.dispatch("open-state-changed",{cancelable:!0,detail:{openState:r}})||(this.openState=r)}async collapse(){if(!this.open||!this.isExpanded||!this.panelRef.value)return;!this.emitter.dispatch("open-state-changed",{cancelable:!0,detail:{openState:h}})||(this.openState=h)}async dock(){if(!this.open||!this.dockable||this.isDocked||!this.panelRef.value)return;!this.emitter.dispatch("open-state-changed",{cancelable:!0,detail:{openState:d}})||(this.openState=d)}async undock(){if(!this.open||!this.isDocked||!this.panelRef.value)return;!this.emitter.dispatch("open-state-changed",{cancelable:!0,detail:{openState:h}})||(this.openState=h)}handleSwipeMayStart(){this.setCachedHeight("forcedInitial",`${this.panelRef?.value?.clientHeight}px`),this.setCachedHeight("forced",`var(${u.forcedInitial})`)}handleSwipeWillStart({swipeDirection:e}){return!("down"===e&&this.blocking&&!this.isExpanded||"up"===e&&!this.expandable)}handleSwipeProgress({swipeDirection:e,touchMoveY:t}){null===t||this.isExpanded&&"up"===e||this.setCachedHeight("forced",`calc(var(${u.forcedInitial}) - ${t??0}px)`)}handleSwipeEnd({touchMoveY:t,thresholdY:i}){if(!this.open||null==t)return;const o=t>=i,s=t<=-i;if(o&&this.isExpanded)this.collapse();else if(o&&this.isNormal)this.requestClose("gesture");else if(s&&this.isDocked)this.undock();else if(s&&this.isNormal&&this.expandable)this.expand();else if(s&&!this.isExpanded&&!this.expandable&&this.panelRef.value){const{keyframes:t,options:i}=e.c6(this,this.animationNames.denyExpand);e.c7(this.panelRef.value,t,i)}}handleSlotChange(e){this.styledDialogChildWithHeader=null,this.slottedElement=this.portalContainer.firstElementChild,this.slottedElement&&this.resizeController.replaceObservedElement("slottedElement")}handleDialogChildConnected(t){t.appearance="bottom-sheet",t.dockable=this.dockable,t.docked="docked"===this.openState,e.ir(t)&&"headerHeight"in t&&(this.styledDialogChildWithHeader=t,this.resizeController.replaceObservedElement("styledDialogChildWithHeader"),this.updateDockedHeight())}handleDialogChildDisconnected(e){}renderDialogBaseClasses(){return{"reflect-gesture":this.gestureController.inSwipe,[`state-${this.openState}`]:!0}}renderTopOfDialog(){return t.x`<div class="${e.Z({"handle-container":!0,[`handle-container-${this.handlePosition}`]:!0})}" part="handle-container" ${e.a4(this.handleContainer)}> <div class="handle"></div> </div>`}};p.styles=c,e._([e.n({type:String,reflect:!0,attribute:"open-state"})],p.prototype,"openState",void 0),e._([e.n({type:Boolean,reflect:!0})],p.prototype,"dockable",void 0),e._([e.n({type:Boolean,reflect:!0})],p.prototype,"expandable",void 0),e._([e.n({type:String,reflect:!0,attribute:"handle-position"})],p.prototype,"handlePosition",void 0),p=e._([e.e("rpl-bottom-sheet")],p);const u={forced:"--bottom-sheet-forced-height",forcedInitial:"--bottom-sheet-forced-initial-height",currentHeight:"--bottom-sheet-current-height",[d]:"--bottom-sheet-docked-height"},g=250;return e.c3("bottomSheet.show",{keyframes:[{opacity:0,transform:"translateY(100%)"},{opacity:1,transform:"translateY(0%)"}],options:{duration:g,easing:"ease"}}),e.c3("bottomSheet.hide",{keyframes:[{opacity:1,transform:"translateY(0%)",maxHeight:"var(--bottom-sheet-forced-height)"},{opacity:0,transform:"translateY(100%)",maxHeight:"var(--bottom-sheet-forced-height)"}],options:{duration:g,easing:"ease"}}),e.c3("bottomSheet.denyClose",{keyframes:[{transform:"translateY(0%)"},{transform:"translateY(4%)"},{transform:"translateY(0%)"}],options:{duration:g,easing:"ease-in"}}),e.c3("bottomSheet.denyExpand",{keyframes:[{height:"var(--bottom-sheet-forced-height)"},{height:"var(--bottom-sheet-height)",transform:"translateY(0%)",offset:.2},{height:"var(--bottom-sheet-height)",transform:"translateY(4%)",offset:.5},{height:"var(--bottom-sheet-height)",transform:"translateY(0%)"}],options:{duration:375,easing:"ease-in"}}),e.c3("bottomSheet.overlay.show",{keyframes:[{opacity:0},{opacity:1}],options:{duration:g}}),e.c3("bottomSheet.overlay.hide",{keyframes:[{opacity:1},{opacity:0}],options:{duration:g}}),{get R(){return p}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./7mROGt_umO.js",import.meta.url,"7mROGt_umO");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("B0yh4uRZhO",["Dw4vb8Yfbm","tO6bKRQro7","7mROGt_umO","5r73EsgItq"],(async(e,t,n,o)=>{let s=class extends t.R{constructor(){super(...arguments),this.country=""}connectedCallback(){super.connectedCallback(),e.K.get(e.am)||(this.timeoutHandle=setTimeout((()=>{this.show(),e.N({country:this.country,name:e.am,value:"true"})}),1e3))}disconnectedCallback(){super.disconnectedCallback(),this.timeoutHandle&&clearTimeout(this.timeoutHandle)}async show(){const t=e.b({source:n.C.RightRailUpsell,action:e.an.View,noun:n.a.RightRailUpsell});return e.i(this,t),super.show()}async hide(){const t=e.b({source:n.C.RightRailUpsell,action:"dismiss",noun:n.a.RightRailUpsell});return e.i(this,t),super.hide()}};e._([e.n({type:String})],s.prototype,"country",void 0),s=e._([e.e("create-channel-coachmark")],s);let i=class extends o.s{constructor(){super(...arguments),this.container=null,this.dropdowns=null,this.containerSelector="html",this.hideDropdowns=()=>{this.dropdowns?.length&&[...this.dropdowns].forEach((e=>e.close()))},this.hideDropdownsDebounced=e.ao(this.hideDropdowns,200,{leading:!0,trailing:!0})}connectedCallback(){super.connectedCallback(),this.container=document.querySelector(this.containerSelector),this.container&&(this.container.addEventListener("scroll",this.hideDropdownsDebounced,{passive:!0}),this.dropdowns=this.container.getElementsByTagName("faceplate-dropdown-menu"))}disconnectedCallback(){super.disconnectedCallback(),this.container&&this.container.removeEventListener("scroll",this.hideDropdownsDebounced)}render(){return o.A}};e._([e.n({type:String,attribute:"container-selector"})],i.prototype,"containerSelector",void 0),i=e._([e.e("dropdown-close-on-scroll")],i)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./g8Ezfsb_Vs.js",import.meta.url,"g8Ezfsb_Vs");SML.di("./DfmRUMqhhU.js",import.meta.url,"DfmRUMqhhU");
SML.dm("B2YOiYwFck",["Dw4vb8Yfbm","5r73EsgItq","g8Ezfsb_Vs","DfmRUMqhhU"],(async(e,t,i,a)=>{let r=class extends t.s{constructor(){super(...arguments),this._windowEvents=new e.E(this,(()=>window)),this.enableEscapeKey=!1,this.handleBackClick=()=>{if(void 0===window.navigation)return void history.back();if(!this.subredditPrefixedName&&!this.postId)return void history.back();const e=window.navigation.currentEntry;if(e&&e.url){const t=e.index,i=new URL(e.url);for(let e=t-1;e>=0;e--){const t=window.navigation.entries()[e];if(t.url){const e=new URL(t.url);if(e.host===i.host&&e.pathname!==i.pathname)return void window.navigation.traverseTo(t.key)}}}window.navigation.navigate(this.destinationUrl)},this.handleEscKey=this._windowEvents.define("keydown",(e=>{if(this.enableEscapeKey&&"Escape"===e.key){if(e.target instanceof Element){const t=null!==e.target.closest('[contenteditable="true"]'),i=null!==e.target.closest("faceplate-hovercard"),a=i&&"dialog"===e.target.getAttribute("aria-haspopup");if(t||i&&!a)return}this.handleBackClick()}}))}get destinationUrl(){return this.mtSeoSubredditLink||a.b(this.subredditPrefixedName)}render(){const a="Back";return t.x` ${e.o({appearance:"secondary",attributes:{type:"button","aria-label":a,onclick:this.handleBackClick},size:e.q.Small,screenReaderContent:a,leadingIcon:i.a({size:t.I.Small})})} `}};r.styles=[e.t],e._([e.n({attribute:"subreddit-prefixed-name"})],r.prototype,"subredditPrefixedName",void 0),e._([e.n({type:String,attribute:"mt-seo-subreddit-link"})],r.prototype,"mtSeoSubredditLink",void 0),e._([e.n({attribute:"post-id"})],r.prototype,"postId",void 0),e._([e.n({type:Boolean,attribute:"enable-escape-key"})],r.prototype,"enableEscapeKey",void 0),r=e._([e.e("pdp-back-button")],r)}));
SML.dm("B2_gjouej4",[],(async()=>{var t;!function(t){t.ALL="all",t.AWARD="award",t.POST="posts",t.COMMENT="comments",t.POST_COMMENT="postsandcomments"}(t||(t={}));var e,s;return function(t){t[t.SelectAll=1]="SelectAll",t[t.DeselectAll=2]="DeselectAll",t[t.SpamFiltered=3]="SpamFiltered",t[t.HasReports=4]="HasReports",t[t.SelfPosts=5]="SelfPosts",t[t.PostsWithFlair=6]="PostsWithFlair",t[t.Posts=7]="Posts",t[t.Comments=8]="Comments"}(e||(e={})),function(t){t.translated="translated",t.untranslated="untranslated",t.none="none"}(s||(s={})),{get D(){return e},M:3,get T(){return s},get a(){return t}}}));

SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("B6Ai7g9fbR",["Dw4vb8Yfbm"],(async t=>{const{svg:e}=t.a(),i=t.m(e`<path d="M9.8 3.908V8.9a.9.9 0 01-.9.9H3.908a.9.9 0 010-1.8h2.82L2.406 3.678a.898.898 0 010-1.272.898.898 0 011.272 0L8 6.728v-2.82a.9.9 0 011.8 0zm7.794 12.414L13.272 12h2.82a.9.9 0 000-1.8H11.1a.9.9 0 00-.9.9v4.992a.9.9 0 001.8 0v-2.82l4.322 4.322a.898.898 0 001.272 0 .898.898 0 000-1.272z"></path>`,"0 0 20 20","collapse-left"),s={LoadFail:0,BadSignature:1,BadTimestamp:2,BadSettingValue:3,BadFormat:4,UnknownSetting:5};class n extends Error{code;line;constructor(t){super(t.reason),this.code=t.code,this.line=t.line}}const r=/\r?\n|\r/gm;class a{writable;readable;constructor(t){const e=new o(t);this.writable=new WritableStream({write(t){e.transform(t)},close(){e.close()}}),this.readable=new ReadableStream({start(t){e.onLine=e=>t.enqueue(e),e.onClose=()=>t.close()}})}}class o{x="";y;onLine;onClose;constructor(t){this.y=new TextDecoder(t)}transform(t){this.x+=this.y.decode(t,{stream:!0});const e=this.x.split(r);this.x=e.pop()||"";for(let t=0;t<e.length;t++)this.onLine(e[t].trim())}close(){this.x&&this.onLine(this.x.trim()),this.x="",this.onClose()}}async function l(t,e){const i=e?.type??"vtt";let s,n;if("string"==typeof i)switch(i){case"srt":s=(await Promise.resolve().then((function(){return dt}))).default;break;case"ssa":case"ass":s=(await Promise.resolve().then((function(){return $t}))).default;break;default:s=(await Promise.resolve().then((function(){return C}))).default}else s=i;const r=t.getReader(),a=s(),o=!!e?.strict||!!e?.errors;await a.init({strict:!1,...e,errors:o,type:i,cancel(){r.cancel(),n=a.done(!0)}});let l=1;for(;;){const{value:t,done:e}=await r.read();if(e){a.parse("",l),n=a.done(!1);break}a.parse(t,l),l++}return n}async function c(t,{encoding:e="utf-8",...i}={}){return l(t.pipeThrough(new a(e)),i)}class h extends EventTarget{id="";startTime;endTime;text;pauseOnExit=!1;constructor(t,e,i){super(),this.startTime=t,this.endTime=e,this.text=i}addEventListener(t,e,i){super.addEventListener(t,e,i)}removeEventListener(t,e,i){super.removeEventListener(t,e,i)}}const u="undefined"==typeof document,d=u?h:window.VTTCue;class p extends d{region=null;vertical="";snapToLines=!0;line="auto";lineAlign="start";position="auto";positionAlign="auto";size=100;align="center";style}class f{id="";width=100;lines=3;regionAnchorX=0;regionAnchorY=100;viewportAnchorX=0;viewportAnchorY=100;scroll=""}function g(t){const e=parseInt(t,10);return Number.isNaN(e)?null:e}function m(t){const e=parseInt(t.replace("%",""),10);return!Number.isNaN(e)&&e>=0&&e<=100?e:null}function b(t){if(!t.includes(","))return null;const[e,i]=t.split(",").map(m);return null!==e&&null!==i?[e,i]:null}function w(t){const e=parseFloat(t);return Number.isNaN(e)?null:e}const v=/[:=]/,y=/^[\s\t]*(region|vertical|line|position|size|align)[:=]/,k=/^REGION:?[\s\t]+/,T=/[\s\t]+/,x=/[\s\t]*-->[\s\t]+/,$=/start|center|end|left|right/,A=/start|center|end/,S=/line-(?:left|right)|center|auto/,j=/^(?:(\d{1,2}):)?(\d{2}):(\d{2})(?:\.(\d{1,3}))?$/;var E=(t=>(t[t.None=0]="None",t[t.Header=1]="Header",t[t.Cue=2]="Cue",t[t.Region=3]="Region",t[t.Note=4]="Note",t))(E||{});class M{f;c=0;g={};h={};j=[];a=null;b=null;k=[];d;l="";async init(t){this.f=t,t.strict&&(this.c=1),t.errors&&(this.d=(await Promise.resolve().then((function(){return St}))).ParseErrorBuilder)}parse(t,e){if(""===t)this.a?(this.j.push(this.a),this.f.onCue?.(this.a),this.a=null):this.b?(this.h[this.b.id]=this.b,this.f.onRegion?.(this.b),this.b=null):1===this.c&&(this.i(t,e),this.f.onHeaderMetadata?.(this.g)),this.c=0;else if(this.c)switch(this.c){case 1:this.i(t,e);break;case 2:if(this.a){const i=this.a.text.length>0;!i&&y.test(t)?this.m(t.split(T),e):this.a.text+=(i?"\n":"")+t}break;case 3:this.n(t.split(T),e)}else if(t.startsWith("NOTE"))this.c=4;else if(t.startsWith("REGION"))this.c=3,this.b=new f,this.n(t.replace(k,"").split(T),e);else if(t.includes("--\x3e")){const i=this.o(t,e);i&&(this.a=new p(i[0],i[1],""),this.a.id=this.l,this.m(i[2],e)),this.c=2}else 1===e&&this.i(t,e);this.l=t}done(){return{metadata:this.g,cues:this.j,regions:Object.values(this.h),errors:this.k}}i(t,e){if(e>1){if(v.test(t)){const[e,i]=t.split(v);e&&(this.g[e]=(i||"").replace(T,""))}}else t.startsWith("WEBVTT")?this.c=1:this.e(this.d?.p())}o(t,e){const[i,s=""]=t.split(x),[n,...r]=s.split(T),a=O(i),o=O(n);if(null!==a&&null!==o&&o>a)return[a,o,r];null===a&&this.e(this.d?.q(i,e)),null===o&&this.e(this.d?.r(n,e)),null!=a&&null!==o&&o>a&&this.e(this.d?.s(a,o,e))}n(t,e){let i;for(let s=0;s<t.length;s++)if(v.test(t[s])){i=!1;const[n,r]=t[s].split(v);switch(n){case"id":this.b.id=r;break;case"width":const t=m(r);null!==t?this.b.width=t:i=!0;break;case"lines":const s=g(r);null!==s?this.b.lines=s:i=!0;break;case"regionanchor":const a=b(r);null!==a?(this.b.regionAnchorX=a[0],this.b.regionAnchorY=a[1]):i=!0;break;case"viewportanchor":const o=b(r);null!==o?(this.b.viewportAnchorX=o[0],this.b.viewportAnchorY=o[1]):i=!0;break;case"scroll":"up"===r?this.b.scroll="up":i=!0;break;default:this.e(this.d?.t(n,r,e))}i&&this.e(this.d?.u(n,r,e))}}m(t,e){let i;for(let s=0;s<t.length;s++)if(i=!1,v.test(t[s])){const[n,r]=t[s].split(v);switch(n){case"region":const t=this.h[r];t&&(this.a.region=t);break;case"vertical":"lr"===r||"rl"===r?(this.a.vertical=r,this.a.region=null):i=!0;break;case"line":const[s,a]=r.split(",");if(s.includes("%")){const t=m(s);null!==t?(this.a.line=t,this.a.snapToLines=!1):i=!0}else{const t=w(s);null!==t?this.a.line=t:i=!0}A.test(a)?this.a.lineAlign=a:a&&(i=!0),"auto"!==this.a.line&&(this.a.region=null);break;case"position":const[o,l]=r.split(","),c=m(o);null!==c?this.a.position=c:i=!0,l&&S.test(l)?this.a.positionAlign=l:l&&(i=!0);break;case"size":const h=m(r);null!==h?(this.a.size=h,h<100&&(this.a.region=null)):i=!0;break;case"align":$.test(r)?this.a.align=r:i=!0;break;default:this.e(this.d?.v(n,r,e))}i&&this.e(this.d?.w(n,r,e))}}e(t){if(t){if(this.k.push(t),this.f.strict)throw this.f.cancel(),t;this.f.onError?.(t)}}}function O(t){const e=t.match(j);if(!e)return null;const i=e[1]?parseInt(e[1],10):0,s=parseInt(e[2],10),n=parseInt(e[3],10),r=e[4]?parseInt(e[4].padEnd(3,"0"),10):0;return i<0||s<0||n<0||r<0||s>59||n>59?null:3600*i+60*s+n+r/1e3}var C=Object.freeze({__proto__:null,VTTBlock:E,VTTParser:M,default:function(){return new M},parseVTTTimestamp:O});const N=/[0-9]/,L=/[\s\t]+/,P={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span",timestamp:"span"},B={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&nbsp;":"","&lrm;":"","&rlm;":""},z=/&(?:amp|lt|gt|quot|#(0+)?39|nbsp|lrm|rlm);/g,_=new Set(["white","lime","cyan","red","yellow","magenta","blue","black"]),I=new Set(Object.keys(P));function F(t){let e,i="",s=1,n=[],r=[];for(let n=0;n<t.text.length;n++){const c=t.text[n];switch(s){case 1:"<"===c?(l(),s=2):i+=c;break;case 2:switch(c){case"\n":case"\t":case" ":a(),s=4;break;case".":a(),s=3;break;case"/":s=5;break;case">":a(),s=1;break;default:!i&&N.test(c)&&(s=6),i+=c}break;case 3:switch(c){case"\t":case" ":case"\n":o(),e&&e.class?.trim(),s=4;break;case".":o();break;case">":o(),e&&e.class?.trim(),s=1;break;default:i+=c}break;case 4:">"===c?(i=i.replace(L," "),"v"===e?.type?e.voice=V(i):"lang"===e?.type&&(e.lang=V(i)),i="",s=1):i+=c;break;case 5:">"===c&&(i="",e=r.pop(),s=1);break;case 6:if(">"===c){const n=O(i);null!==n&&n>=t.startTime&&n<=t.endTime&&(i="timestamp",a(),e.time=n),i="",s=1}else i+=c}}function a(){if(I.has(i)){const s=e;e={tagName:P[t=i],type:t,children:[]},s?(r[r.length-1]!==s&&r.push(s),s.children.push(e)):n.push(e)}var t;i="",s=1}function o(){if(e&&i){const t=i.replace("bg_","");_.has(t)?e[i.startsWith("bg_")?"bgColor":"color"]=t:e.class=e.class?e.class+" "+i:i}i=""}function l(){if(!i)return;const t={type:"text",data:V(i)};e?e.children.push(t):n.push(t),i=""}return 1===s&&l(),n}function V(t){return t.replace(z,(t=>B[t]||"'"))}function R(t,e,i){t.style.setProperty(`--${e}`,i+"")}function H(t,e,i=!0){t.setAttribute(`data-${e}`,!0===i?"":i+"")}function D(t,e){t.setAttribute("data-part",e)}function W(t,e=0){return q(F(t),e)}function q(t,e=0){let i,s="";for(const n of t)if("text"===n.type)s+=n.data;else{const t="timestamp"===n.type;i={},i.class=n.class,i.title="v"===n.type&&n.voice,i.lang="lang"===n.type&&n.lang,i["data-part"]="v"===n.type&&"voice",t&&(i["data-part"]="timed",i["data-time"]=n.time,i["data-future"]=n.time>e,i["data-past"]=n.time<e),i.style=`${n.color?`color: ${n.color};`:""}${n.bgColor?`background-color: ${n.bgColor};`:""}`;const r=Object.entries(i).filter((t=>t[1])).map((t=>`${t[0]}="${!0===t[1]?"":t[1]}"`)).join(" ");s+=`<${n.tagName}${r?" "+r:""}>${q(n.children)}</${n.tagName}>`}return s}function Y(t,e){if(!u)for(const i of t.querySelectorAll('[data-part="timed"]')){const t=Number(i.getAttribute("data-time"));Number.isNaN(t)||(t>e?H(i,"future"):i.removeAttribute("data-future"),t<e?H(i,"past"):i.removeAttribute("data-past"))}}const X=Symbol(0);function U(t){return t instanceof HTMLElement?{top:t.offsetTop,width:t.clientWidth,height:t.clientHeight,left:t.offsetLeft,right:t.offsetLeft+t.clientWidth,bottom:t.offsetTop+t.clientHeight}:{...t}}function G(t,e,i){switch(e){case"+x":t.left+=i,t.right+=i;break;case"-x":t.left-=i,t.right-=i;break;case"+y":t.top+=i,t.bottom+=i;break;case"-y":t.top-=i,t.bottom-=i}}function Q(t,e){for(let n=0;n<e.length;n++)if(i=t,s=e[n],i.left<=s.right&&i.right>=s.left&&i.top<=s.bottom&&i.bottom>=s.top)return e[n];var i,s;return null}function J(t,e){return e.top>=0&&e.bottom<=t.height&&e.left>=0&&e.right<=t.width}function K(t,e,i){switch(i){case"+x":return e.left<0;case"-x":return e.right>t.width;case"+y":return e.top<0;case"-y":return e.bottom>t.height}}function Z(t,e){return Math.max(0,Math.min(t.width,e.right)-Math.max(0,e.left))*Math.max(0,Math.min(t.height,e.bottom)-Math.max(0,e.top))/(t.height*t.width)}function tt(t,e){return{top:e.top/t.height,left:e.left/t.width,right:(t.width-e.right)/t.width,bottom:(t.height-e.bottom)/t.height}}function et(t,e){return e.top=e.top*t.height,e.left=e.left*t.width,e.right=t.width-e.right*t.width,e.bottom=t.height-e.bottom*t.height,e}const it=["top","left","right","bottom"];function st(t,e,i,s){const n=tt(e,i);for(const e of it)R(t,`${s}-${e}`,100*n[e]+"%")}function nt(t,e,i,s){let n,r=1,a={...e};for(let o=0;o<s.length;o++){for(;K(t,e,s[o])||J(t,e)&&Q(e,i);)G(e,s[o],1);if(J(t,e))return e;const l=Z(t,e);r>l&&(n={...e},r=l),e={...a}}return n||a}const rt=Symbol(0);function at(t,e,i,s){let n,r=i.firstElementChild,a=function(t){if("auto"===t.line)return t.snapToLines?-1:100;return t.line}(e),o=[];if(i[X]||(i[X]=function(t,e){const i=U(e),s=function(t){const e={};for(const i of it)e[i]=parseFloat(t.style.getPropertyValue(`--cue-${i}`));return e}(e);e[rt]=!1,s.top&&(i.top=s.top,i.bottom=s.top+i.height,e[rt]="top");if(s.bottom){const n=t.height-s.bottom;i.top=n-i.height,i.bottom=n,e[rt]="bottom"}s.left&&(i.left=s.left);s.right&&(i.right=t.width-s.right);return tt(t,i)}(t,i)),n=et(t,{...i[X]}),i[rt])o=["top"===i[rt]?"+y":"-y","+x","-x"];else if(e.snapToLines){let i;switch(e.vertical){case"":o=["+y","-y"],i="height";break;case"rl":o=["+x","-x"],i="width";break;case"lr":o=["-x","+x"],i="width"}let s=parseFloat(getComputedStyle(r).lineHeight)||0,l=s*Math.round(a),c=t[i]+s,h=o[0];Math.abs(l)>c&&(l=l<0?-1:1,l*=Math.ceil(c/s)*s),a<0&&(l+=""===e.vertical?t.height:t.width,o=o.reverse()),G(n,h,l)}else{const i=""===e.vertical,s=i?"+y":"+x",r=i?n.height:n.width;G(n,s,(i?t.height:t.width)*a/100),G(n,s,"center"===e.lineAlign?r/2:"end"===e.lineAlign?r:0),o=i?["-y","+y","-x","+x"]:["-x","+x","-y","+y"]}return n=nt(t,n,s,o),st(i,t,n,"cue"),n}const ot=["-y","+y","-x","+x"];function lt(t,e,i,s){let n=Array.from(i.querySelectorAll('[data-part="cue-display"]')),r=0,a=Math.max(0,n.length-e.lines);for(let t=n.length-1;t>=a;t--)r+=n[t].offsetHeight;R(i,"region-height",r+"px"),i[X]||(i[X]=tt(t,U(i)));let o={...i[X]};return o=et(t,o),o.width=i.clientWidth,o.height=r,o.right=o.left+o.width,o.bottom=o.top+r,o=nt(t,o,s,ot),st(i,t,o,"region"),o}var ct=Object.freeze({__proto__:null,CaptionsRenderer:class{overlay;z;A=0;C="ltr";B=[];D=!1;E;h=new Map;j=new Map;get dir(){return this.C}set dir(t){this.C=t,H(this.overlay,"dir",t)}get currentTime(){return this.A}set currentTime(t){this.A=t,this.update()}constructor(t,e){this.overlay=t,this.dir=e?.dir??"ltr",t.setAttribute("translate","yes"),t.setAttribute("aria-live","off"),t.setAttribute("aria-atomic","true"),D(t,"captions"),this.G(),this.E=new ResizeObserver(this.I.bind(this)),this.E.observe(t)}changeTrack({regions:t,cues:e}){this.reset(),this.J(t);for(const t of e)this.j.set(t,null);this.update()}addCue(t){this.j.set(t,null),this.update()}removeCue(t){this.j.delete(t),this.update()}update(t=!1){this.H(t)}reset(){this.j.clear(),this.h.clear(),this.B=[],this.overlay.textContent=""}destroy(){this.reset(),this.E.disconnect()}I(){this.D=!0,this.K()}K=function(t,e){let i,s=null;function n(){r(),t(...i),i=void 0}function r(){clearTimeout(s),s=null}return function(){i=[].slice.call(arguments),r(),s=setTimeout(n,e)}}((()=>{this.D=!1,this.G();for(const t of this.h.values())t[X]=null;for(const t of this.j.values())t&&(t[X]=null);this.H(!0)}),50);G(){this.z=U(this.overlay),R(this.overlay,"overlay-width",this.z.width+"px"),R(this.overlay,"overlay-height",this.z.height+"px")}H(t=!1){if(!this.j.size||this.D)return;let e,i=[...this.j.keys()].filter((t=>this.A>=t.startTime&&this.A<=t.endTime)).sort(((t,e)=>t.startTime!==e.startTime?t.startTime-e.startTime:t.endTime-e.endTime)),s=i.map((t=>t.region));for(let n=0;n<this.B.length;n++){if(e=this.B[n],i[n]===e)continue;if(e.region&&!s.includes(e.region)){const i=this.h.get(e.region.id);i&&(i.removeAttribute("data-active"),t=!0)}const r=this.j.get(e);r&&(r.remove(),t=!0)}for(let s=0;s<i.length;s++){e=i[s];let n=this.j.get(e);n||this.j.set(e,n=this.L(e));const r=this.F(e)&&this.h.get(e.region.id);r&&!r.hasAttribute("data-active")&&(requestAnimationFrame((()=>H(r,"active"))),t=!0),n.isConnected||((r||this.overlay).append(n),t=!0)}if(t){const t=[],s=new Set;for(let n=i.length-1;n>=0;n--){if(e=i[n],s.has(e.region||e))continue;const r=this.F(e),a=r?this.h.get(e.region.id):this.j.get(e);r?t.push(lt(this.z,e.region,a,t)):t.push(at(this.z,e,a,t)),s.add(r?e.region:e)}}Y(this.overlay,this.A),this.B=i}J(t){if(t)for(const e of t){const t=this.M(e);this.h.set(e.id,t),this.overlay.append(t)}}M(t){const e=document.createElement("div");return D(e,"region"),H(e,"id",t.id),H(e,"scroll",t.scroll),R(e,"region-width",t.width+"%"),R(e,"region-anchor-x",t.regionAnchorX),R(e,"region-anchor-y",t.regionAnchorY),R(e,"region-viewport-anchor-x",t.viewportAnchorX),R(e,"region-viewport-anchor-y",t.viewportAnchorY),R(e,"region-lines",t.lines),e}L(t){const e=document.createElement("div"),i=function(t){if("auto"===t.position)switch(t.align){case"start":case"left":return 0;case"right":case"end":return 100;default:return 50}return t.position}(t),s=function(t,e){if("auto"===t.positionAlign)switch(t.align){case"start":return"ltr"===e?"line-left":"line-right";case"end":return"ltr"===e?"line-right":"line-left";case"center":return"center";default:return`line-${t.align}`}return t.positionAlign}(t,this.C);if(D(e,"cue-display"),""!==t.vertical&&H(e,"vertical"),R(e,"cue-text-align",t.align),t.style)for(const i of Object.keys(t.style))e.style.setProperty(i,t.style[i]);if(this.F(t))R(e,"cue-offset",i-("line-right"===s?100:"center"===s?50:0)+"%");else if(R(e,"cue-writing-mode",""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl"),!t.style?.["--cue-width"]){let n=i;"line-left"===s?n=100-i:"center"===s&&i<=50?n=2*i:"center"===s&&i>50&&(n=2*(100-i));const r=t.size<n?t.size:n;""===t.vertical?R(e,"cue-width",r+"%"):R(e,"cue-height",r+"%")}const n=document.createElement("div");return D(n,"cue"),t.id&&H(n,"id",t.id),n.innerHTML=W(t),e.append(n),e}F(t){return t.region&&100===t.size&&""===t.vertical&&"auto"===t.line}},ParseError:n,ParseErrorCode:s,TextCue:h,VTTCue:p,VTTRegion:f,parseByteStream:c,parseResponse:async function(t,e){const i=await t;if(!i.ok||!i.body){let t;return{metadata:{},cues:[],regions:[],errors:[t]}}const s=i.headers.get("content-type")||"",n=s.match(/text\/(.*?)(?:;|$)/)?.[1],r=s.match(/charset=(.*?)(?:;|$)/)?.[1];return c(i.body,{type:n,encoding:r,...e})},parseTextStream:l,parseVTTTimestamp:O,renderVTTCueString:W,renderVTTTokensString:q,tokenizeVTTCue:F,updateTimedVTTCueNodes:Y});const ht=/,/g;class ut extends M{parse(t,e){if(""===t)this.a&&(this.j.push(this.a),this.f.onCue?.(this.a),this.a=null),this.c=E.None;else if(this.c===E.Cue)this.a.text+=(this.a.text?"\n":"")+t;else if(t.includes("--\x3e")){const i=this.o(t,e);i&&(this.a=new p(i[0],i[1],i[2].join(" ")),this.a.id=this.l,this.c=E.Cue)}this.l=t}o(t,e){return super.o(t.replace(ht,"."),e)}}var dt=Object.freeze({__proto__:null,SRTParser:ut,default:function(){return new ut}});const pt=/^Format:[\s\t]*/,ft=/^Style:[\s\t]*/,gt=/^Dialogue:[\s\t]*/,mt=/[\s\t]*,[\s\t]*/,bt=/\{[^}]+\}/g,wt=/\\N/g,vt=/^\[(.*)[\s\t]?Styles\]$/,yt=/^\[(.*)[\s\t]?Events\]$/;class kt{f;P=0;a=null;j=[];k=[];O=null;d;Q={};async init(t){this.f=t,t.errors&&(this.d=(await Promise.resolve().then((function(){return St}))).ParseErrorBuilder)}parse(t,e){if(this.P)switch(this.P){case 1:if(""===t)this.P=0;else if(ft.test(t))if(this.O){const e=t.replace(ft,"").split(mt);this.T(e)}else this.e(this.d?.N("Style",e));else pt.test(t)?this.O=t.replace(pt,"").split(mt):yt.test(t)&&(this.O=null,this.P=2);break;case 2:if(""===t)this.R();else if(gt.test(t))if(this.R(),this.O){const i=t.replace(gt,"").split(mt),s=this.U(i,e);s&&(this.a=s)}else this.e(this.d?.N("Dialogue",e));else this.a?this.a.text+="\n"+t.replace(bt,"").replace(wt,"\n"):pt.test(t)?this.O=t.replace(pt,"").split(mt):vt.test(t)?(this.O=null,this.P=1):yt.test(t)&&(this.O=null)}else""===t||(vt.test(t)?(this.O=null,this.P=1):yt.test(t)&&(this.O=null,this.P=2))}done(){return{metadata:{},cues:this.j,regions:[],errors:this.k}}R(){this.a&&(this.j.push(this.a),this.f.onCue?.(this.a),this.a=null)}T(t){let e,i,s,n,r="Default",a={},o="center",l="bottom",c=1.2,h=3,u=[];for(let d=0;d<this.O.length;d++){const p=this.O[d],f=t[d];switch(p){case"Name":r=f;break;case"Fontname":a["font-family"]=f;break;case"Fontsize":a["font-size"]=`calc(${f} / var(--overlay-height))`;break;case"PrimaryColour":const t=Tt(f);t&&(a["--cue-color"]=t);break;case"BorderStyle":h=parseInt(f,10);break;case"BackColour":n=Tt(f);break;case"OutlineColour":const d=Tt(f);d&&(s=d);break;case"Bold":parseInt(f)&&(a["font-weight"]="bold");break;case"Italic":parseInt(f)&&(a["font-style"]="italic");break;case"Underline":parseInt(f)&&(a["text-decoration"]="underline");break;case"StrikeOut":parseInt(f)&&(a["text-decoration"]="line-through");break;case"Spacing":a["letter-spacing"]=f+"px";break;case"AlphaLevel":a.opacity=parseFloat(f);break;case"ScaleX":u.push(`scaleX(${parseFloat(f)/100})`);break;case"ScaleY":u.push(`scaleY(${parseFloat(f)/100})`);break;case"Angle":u.push(`rotate(${f}deg)`);break;case"Shadow":c=1.2*parseInt(f,10);break;case"MarginL":a["--cue-width"]="auto",a["--cue-left"]=parseFloat(f)+"px";break;case"MarginR":a["--cue-width"]="auto",a["--cue-right"]=parseFloat(f)+"px";break;case"MarginV":i=parseFloat(f);break;case"Outline":e=parseInt(f,10);break;case"Alignment":const p=parseInt(f,10);switch(p>=4&&(l=p>=7?"top":"center"),p%3){case 1:o="start";break;case 2:o="center";break;case 3:o="end"}}}if(a.S=l,a["--cue-white-space"]="normal",a["--cue-line-height"]="normal",a["--cue-text-align"]=o,"center"===l?(a["--cue-top"]="50%",u.push("translateY(-50%)")):a[`--cue-${l}`]=(i||0)+"px",1===h&&(a["--cue-padding-y"]="0"),(1===h||n)&&(a["--cue-bg-color"]=1===h?"none":n),3===h&&s&&(a["--cue-outline"]=`${e}px solid ${s}`),1===h&&"number"==typeof e){const t=n??"#000";a["--cue-text-shadow"]=[s&&xt(1.2*e,1.2*c,s),s?xt(e*(e/2),c*(e/2),t):xt(e,c,t)].filter(Boolean).join(", ")}u.length&&(a["--cue-transform"]=u.join(" ")),this.Q[r]=a}U(t,e){const i=this.V(t),s=this.o(i.Start,i.End,e);if(!s)return;const n=new p(s[0],s[1],""),r={...this.Q[i.Style]||{}},a=i.Name?`<v ${i.Name}>`:"",o=r.S,l=i.MarginL&&parseFloat(i.MarginL),c=i.MarginR&&parseFloat(i.MarginR),h=i.MarginV&&parseFloat(i.MarginV);return l&&(r["--cue-width"]="auto",r["--cue-left"]=l+"px"),c&&(r["--cue-width"]="auto",r["--cue-right"]=c+"px"),h&&"center"!==o&&(r[`--cue-${o}`]=h+"px"),n.text=a+t.slice(this.O.length-1).join(", ").replace(bt,"").replace(wt,"\n"),delete r.S,Object.keys(r).length&&(n.style=r),n}V(t){const e={};for(let i=0;i<this.O.length;i++)e[this.O[i]]=t[i];return e}o(t,e,i){const s=O(t),n=O(e);if(null!==s&&null!==n&&n>s)return[s,n];null===s&&this.e(this.d?.q(t,i)),null===n&&this.e(this.d?.r(e,i)),null!=s&&null!==n&&n>s&&this.e(this.d?.s(s,n,i))}e(t){if(t){if(this.k.push(t),this.f.strict)throw this.f.cancel(),t;this.f.onError?.(t)}}}function Tt(t){const e=parseInt(t.replace("&H",""),16);if(e>=0){return"rgba("+[255&e,e>>8&255,e>>16&255,(e>>24&255^255)/255].join(",")+")"}return null}function xt(t,e,i){const s=Math.ceil(2*Math.PI*t);let n="";for(let r=0;r<s;r++){const a=2*Math.PI*r/s;n+=t*Math.cos(a)+"px "+e*Math.sin(a)+"px 0 "+i+(r==s-1?"":",")}return n}var $t=Object.freeze({__proto__:null,SSAParser:kt,default:function(){return new kt}});const At={p:()=>new n({code:s.BadSignature,reason:"missing WEBVTT file header",line:1}),q:(t,e)=>new n({code:s.BadTimestamp,reason:`cue start timestamp \`${t}\` is invalid on line ${e}`,line:e}),r:(t,e)=>new n({code:s.BadTimestamp,reason:`cue end timestamp \`${t}\` is invalid on line ${e}`,line:e}),s:(t,e,i)=>new n({code:s.BadTimestamp,reason:`cue end timestamp \`${e}\` is greater than start \`${t}\` on line ${i}`,line:i}),w:(t,e,i)=>new n({code:s.BadSettingValue,reason:`invalid value for cue setting \`${t}\` on line ${i} (value: ${e})`,line:i}),v:(t,e,i)=>new n({code:s.UnknownSetting,reason:`unknown cue setting \`${t}\` on line ${i} (value: ${e})`,line:i}),u:(t,e,i)=>new n({code:s.BadSettingValue,reason:`invalid value for region setting \`${t}\` on line ${i} (value: ${e})`,line:i}),t:(t,e,i)=>new n({code:s.UnknownSetting,reason:`unknown region setting \`${t}\` on line ${i} (value: ${e})`,line:i}),N:(t,e)=>new n({code:s.BadFormat,reason:`format missing for \`${t}\` block on line ${e}`,line:e})};var St=Object.freeze({__proto__:null,ParseErrorBuilder:At});return{c:i,get p(){return ct}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("B7VtDPc4tA",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,t)=>{const a="plain",n="plain-weak",s="secondary",r="bordered",o="media",l="plain",m={[e.q.ExtraSmall]:t.I.ExtraSmall,[e.q.Small]:t.I.Small,[e.q.Medium]:t.I.Medium,[e.q.Large]:t.I.Medium},i={xs:"px-sm",sm:"px-sm",md:"px-sm",lg:"px-xs"},d={xs:"text-caption-1",sm:"text-caption-1",md:"text-caption-1",lg:"text-body-2"},c={xs:"var(--size-button-sm-h)",sm:"var(--size-button-sm-h)",md:"var(--size-button-md-h)",lg:"var(--size-button-md-h)"},p={xs:"var(--font-button-sm)",sm:"var(--font-button-sm)",md:"var(--font-button-sm)",lg:"var(--font-button-md)"},u={[a]:"button-plain",[n]:"button-plain-weak",[s]:"button-secondary",[r]:"button-bordered-cab",[o]:"button-media-cab"},b=e=>{const{attributes:t,size:a,appearance:n,selected:s}=e;return[t?.className||"",a?`${d[a]}`:"",u[n??l],s?"button-activated":"","inline-flex items-center"].join(" ")};return{A:u,B:c,I:m,c:({attributes:t,children:a,size:n=e.q.Medium,selected:s,appearance:r=l,leadingIcon:o,screenReaderContent:m,role:d})=>{let u=`flex ${e.ap[n]}`;a&&o&&(u+=" me-[var(--rem6)]");const{html:x,createElement:E}=e.a(),$=x`<span class="flex items-center"> ${o?x`<span class="${u}">${o}</span>`:void 0} ${a?x`<span> ${a} </span>`:void 0} </span> ${m?x`<faceplate-screen-reader-content> ${m} </faceplate-screen-reader-content>`:""}`,v=t?.href,h="bordered"===r?"border-sm":"border-md";return E(null!=v?"a":"button",{...t,role:d??t?.role,style:`height: ${c[n]}; font: ${p[n]}`,className:`button ${h} ${b({appearance:r,size:n,attributes:t,selected:s})}\n       ${i[n]}\n      `,rpl:!0},$)},g:b}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./CZLMnmUH44.js",import.meta.url,"CZLMnmUH44");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./DfOK659qrU.js",import.meta.url,"DfOK659qrU");
SML.dm("B9FNmoZbPR",["Dw4vb8Yfbm","CZLMnmUH44","5r73EsgItq","DfOK659qrU"],(async(e,t,n)=>{const a=n.s;let i=class extends a{constructor(){super(...arguments),this.translationContextValue=e.aQ,this.checked=!0,this.isViewEventSent=!1,this.renderTitleText=()=>n.x` ${this.isCommentToggle()?"Translate comment":"Translate post"} `,this.renderbodyText=()=>n.x` ${this.isCommentToggle()?"You are commenting in a community speaking a language different from yours.":"You are posting in a community speaking a language different from yours."} `}getCommentIdForEditMode(){const e=this.closest("comment-composer-host");if(e&&e.isInEditMode)return this.closest("shreddit-comment")?.getAttribute("thingId")??void 0}updated(){if(this.translationContextValue.isTranslationActive&&!this.isViewEventSent){if(this.isCommentToggle()){const n=this.getCommentIdForEditMode();e.i(this,t.t(n))}else this.isPostToggle()&&e.i(this,t.a(this.thingId));this.isViewEventSent=!0}}handleToggleClick(n){if(n.preventDefault(),n.stopPropagation(),this.checked=!this.checked,this.isCommentToggle()){const n=this.getCommentIdForEditMode();e.i(this,t.c(this.checked,n))}this.isPostToggle()&&e.i(this,t.d(this.checked,this.thingId))}isCommentToggle(){return"comment"===this.toggleType}isPostToggle(){return"post"===this.toggleType}render(){if(!this.translationContextValue.isTranslationActive)return n.x``;const e=this.isCommentToggle()?"flex ml-sm mb-2xs justify-between":"flex justify-between py-md";return n.x` <div class="${e}"> <div> <div class="font-normal text-14 leading-5 text-secondary-plain"> ${this.renderTitleText()} </div> <div class="font-normal text-12 leading-4 text-secondary-plain-weak"> ${this.renderbodyText()} </div> </div> <faceplate-switch-input ?checked="${this.checked}" @click="${this.handleToggleClick}"></faceplate-switch-input> </div> `}};i.styles=[e.t],e._([e.aP({context:e.aR,subscribe:!0}),e.h()],i.prototype,"translationContextValue",void 0),e._([e.n({type:String,attribute:"toggle-type"})],i.prototype,"toggleType",void 0),e._([e.n({type:String,attribute:"thing-id"})],i.prototype,"thingId",void 0),e._([e.h()],i.prototype,"checked",void 0),e._([e.h()],i.prototype,"isViewEventSent",void 0),i=e._([e.e("translation-contribution-toggle")],i)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("BA2UEzZJB8",["Dw4vb8Yfbm"],(async a=>{const{svg:m}=a.a();return{i:a.m(m`<path d="M10 1a9 9 0 10.001 18.001A9 9 0 0010 1zm.93 13.84H9.07v-6.3h1.86v6.3zm.05-8.09c-.1.17-.24.31-.41.41-.17.1-.36.15-.57.15-.21 0-.4-.05-.57-.15-.17-.1-.31-.24-.41-.41-.1-.17-.15-.36-.15-.57 0-.21.05-.4.15-.57.1-.17.24-.31.41-.41.17-.1.36-.15.57-.15.21 0 .4.05.57.15.17.1.31.24.41.41.1.17.15.36.15.57 0 .21-.05.4-.15.57z"></path>`,"0 0 20 20","info-fill")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./lxqt5OPiQh.js",import.meta.url,"lxqt5OPiQh");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("BAGS8uwlNZ",["Dw4vb8Yfbm","5r73EsgItq","lxqt5OPiQh","B-zFJtiar6"],(async(e,t,s,a)=>{let n=class extends t.s{constructor(){super(...arguments),this.id="",this.searchBase=null,this.isExpanded=!1,this.pubsub=new e.u(this),this.handleFlairExpansionStateChanged=e=>{this.isExpanded=e.isExpanded,this.updateExpandedState()},this.handleExpandClick=()=>{this.isExpanded=!this.isExpanded,this.updateExpandedState(),this.searchBase&&this.searchBase.updateFlairExpansionState(this.isExpanded)}}connectedCallback(){super.connectedCallback(),this.isExpanded=!1,this.pubsub.subscribe(e.T.SearchFlairExpansionStateChanged,this.handleFlairExpansionStateChanged),this.searchBase=document.querySelector("reddit-search-large")||document.querySelector("reddit-search-small")}disconnectedCallback(){super.disconnectedCallback();const e=this.shadowRoot?.querySelector('slot[name="expand-button"]');e&&e.removeEventListener("click",this.handleExpandClick)}updateExpandedState(){const e=this.shadowRoot?.querySelector('slot[name="content"]'),t=this.shadowRoot?.querySelector('slot[name="expand-button"]');if(e){e.assignedElements().forEach((e=>{this.isExpanded?(e.classList.add("!max-h-none","!overflow-visible"),e.classList.remove("max-h-[2em]","overflow-hidden")):(e.classList.add("max-h-[2em]","overflow-hidden"),e.classList.remove("!max-h-none","!overflow-visible"))}))}if(t){t.assignedElements().forEach((e=>{this.isExpanded?e.classList.add("hidden"):e.classList.remove("hidden");const t=e.querySelector("button");t&&t.setAttribute("aria-expanded",this.isExpanded.toString())}))}}setupEventListeners(){const e=this.shadowRoot?.querySelector('slot[name="expand-button"]');e&&e.addEventListener("click",this.handleExpandClick)}firstUpdated(){this.setupEventListeners(),this.updateExpandedState()}render(){return t.x` <slot></slot> <slot name="content"></slot> <slot name="expand-button"></slot> `}};e._([e.n({type:String})],n.prototype,"id",void 0),e._([e.h()],n.prototype,"searchBase",void 0),e._([e.h()],n.prototype,"isExpanded",void 0),n=e._([e.e("search-flair-expandable-list")],n);let d=class extends t.s{constructor(){super(...arguments),this.open=!1,this.id="",this.handleClick=()=>{const e=!this.open;this.updateLocalStorage(e),this.open=e,this.toggleHeaderTrackers()}}toggleHeaderTrackers(){this.trackers?.forEach((e=>{e.disabled=!e.disabled}))}updateLocalStorage(t){const s=a.u(e.a9.SearchTypeaheadExpanded)??{};s[this.id]=!!t,a.r(e.a9.SearchTypeaheadExpanded,s)}connectedCallback(){super.connectedCallback(),this.closest("summary")?.addEventListener("click",this.handleClick)}disconnectedCallback(){super.disconnectedCallback(),this.closest("summary")?.removeEventListener("click",this.handleClick)}createRenderRoot(){return this}};e._([e.b9(s.S)],d.prototype,"trackers",void 0),e._([e.n({reflect:!0,type:Boolean,attribute:"open"})],d.prototype,"open",void 0),e._([e.n({type:String})],d.prototype,"id",void 0),d=e._([e.e("search-typeahead-expandable-section")],d)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("BAPJODHRV4",["Dw4vb8Yfbm"],(async a=>{const{svg:c}=a.a();return{w:a.m(c`<g clip-path="url(#a)"><path d="M18.857 13.69l-6.47-11.21a2.732 2.732 0 00-2.39-1.38c-.93 0-1.86.46-2.39 1.38l-6.47 11.21c-1.06 1.84.27 4.13 2.39 4.13h12.94c2.12 0 3.45-2.3 2.39-4.13zm-7.86-7.65l-.24 5.56h-1.52l-.24-5.56h2zm.04 8.36c-.11.18-.25.33-.44.43-.19.1-.39.16-.61.16-.22 0-.42-.05-.6-.16-.18-.1-.33-.25-.43-.43a1.16 1.16 0 01-.16-.61c0-.22.05-.42.16-.61.11-.18.25-.33.43-.44.18-.11.38-.16.6-.16.22 0 .43.05.61.16s.33.25.44.44c.11.18.16.38.16.61 0 .23-.05.42-.16.61z"></path></g><defs><clipPath id="a"><path d="M0 0h20v20H0z"></path></clipPath></defs>`,"0 0 20 20","warning-fill")}}));
SML.di("./BWv2j8jrjX.js",import.meta.url,"BWv2j8jrjX");SML.di("./DG4aPYnXvr.js",import.meta.url,"DG4aPYnXvr");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./DMVINMWPkT.js",import.meta.url,"DMVINMWPkT");SML.di("./DZO4dWmzHb.js",import.meta.url,"DZO4dWmzHb");SML.di("./nn12FiJf-M.js",import.meta.url,"nn12FiJf-M");SML.di("./C_DxBjcqSi.js",import.meta.url,"C_DxBjcqSi");SML.di("./D80UqjFrqa.js",import.meta.url,"D80UqjFrqa");SML.di("./BHQvZGlXFT.js",import.meta.url,"BHQvZGlXFT");SML.di("./DfmRUMqhhU.js",import.meta.url,"DfmRUMqhhU");SML.di("./7c7cPPCf-9.js",import.meta.url,"7c7cPPCf-9");SML.di("./DKYHmsTM9-.js",import.meta.url,"DKYHmsTM9-");SML.di("./DgW4ULLwQ1.js",import.meta.url,"DgW4ULLwQ1");SML.di("./BgnwQeogVz.js",import.meta.url,"BgnwQeogVz");SML.di("./BLIiwX-G4B.js",import.meta.url,"BLIiwX-G4B");SML.di("./BPE-aUEF5w.js",import.meta.url,"BPE-aUEF5w");SML.di("./iewwAXEto0.js",import.meta.url,"iewwAXEto0");SML.di("./BM4eKBOTt3.js",import.meta.url,"BM4eKBOTt3");SML.di("./DI4O_MlG8-.js",import.meta.url,"DI4O_MlG8-");SML.di("./CNVxoLjPZD.js",import.meta.url,"CNVxoLjPZD");SML.di("./BAPJODHRV4.js",import.meta.url,"BAPJODHRV4");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./h4Pa0OJr_5.js",import.meta.url,"h4Pa0OJr_5");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./CfalWt2tl8.js",import.meta.url,"CfalWt2tl8");SML.di("./ygbiiDqLof.js",import.meta.url,"ygbiiDqLof");SML.di("./D1at8fJtPv.js",import.meta.url,"D1at8fJtPv");SML.di("./BLbwpJ0bjx.js",import.meta.url,"BLbwpJ0bjx");SML.di("./_Hk1tm1ODt.js",import.meta.url,"_Hk1tm1ODt");SML.di("./kS-PCwPq_X.js",import.meta.url,"kS-PCwPq_X");SML.di("./Chd9fEZKZ6.js",import.meta.url,"Chd9fEZKZ6");SML.di("./HzkRsiDxC9.js",import.meta.url,"HzkRsiDxC9");SML.di("./BDs3iC2vQ1.js",import.meta.url,"BDs3iC2vQ1");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");
SML.dm("BD-GSnPdCo",["Dw4vb8Yfbm","5r73EsgItq","DMVINMWPkT","DZO4dWmzHb","nn12FiJf-M","C_DxBjcqSi","D80UqjFrqa","BHQvZGlXFT","DfmRUMqhhU","7c7cPPCf-9","DKYHmsTM9-","DgW4ULLwQ1","BgnwQeogVz","BLIiwX-G4B","BPE-aUEF5w","iewwAXEto0","BM4eKBOTt3","DI4O_MlG8-","CNVxoLjPZD","BAPJODHRV4","D_g7f2Ewyi","h4Pa0OJr_5","BIzQFHISzm","CfalWt2tl8","ygbiiDqLof","D1at8fJtPv","BLbwpJ0bjx","_Hk1tm1ODt","kS-PCwPq_X","Chd9fEZKZ6","HzkRsiDxC9","BDs3iC2vQ1","BYzqEZ3uv3","Cv4mWnWE30","B-zFJtiar6","eY7T41bKac"],(async(t,e,n,s,a,i,r,o,c)=>{const l="line-clamp-3",u="hidden",p="description",x="show-more-btn";let d=class extends e.s{constructor(){super(...arguments),this.name="",this.subredditId="",this.prefixedName="",this.displayName="",this.description="",this.subscribers=0,this.bannerUrl="",this.routerName="",this.bannerFallbackBackgroundColor="",this.notificationLevel="",this.idCardWidgetId="",this.subscribersText="",this.currentlyViewingText="",this.weeklyActiveUsersCount=0,this.weeklyContributionsCount=0,this.isActivityIndicatorsEnabled=!1,this.isModerator=!1,this.hasModqueueAccess=!1,this.isSubscribed=!1,this.isMuted=!1,this.isFavorite=!1,this.isUserLoggedIn=!1,this.isPdpRoute=!1,this.newBannerExperimentEnabled=!1,this.allowIdCardEdit=!1,this.isCustomFeedEnabled=!1,this.active=0,this.hasCommunityGuide=!1,this.isCommunityGuideExperimentEnabled=!1,this.isModInsightsWidgetExperimentEnabled=!1,this.isModOnboardingGuidesExperimentEnabled=!1,this.isRedesign=!1,this.hfnUxUpdatesVariant="",this.isUpdatesAllEnabled=!1,this.subredditUpdatesAllClientsVariant="",this.shredditSubredditUpdatesAllVariant="",this.subredditUpdatesAllClientsVersion="",this.shredditSubredditUpdatesAllVersion="",this.pubsub=new t.u(this),this._activateFeature=async e=>t.r(e),this._getPageType=t.H,this.onSubscriptionChange=async e=>{let n;this.name===e.name&&(n=e.subscribed&&this.isSubscribed!==e.subscribed,this.isSubscribed=e.subscribed),n&&this.isPdpRoute&&this.isUserLoggedIn&&this.subredditId&&(await this._activateFeature({name:t.gV,queryParams:{subredditId:this.subredditId,pageType:String(this._getPageType())}}))},this.renderJoinOrModButton=()=>{if(!this.newBannerExperimentEnabled||this.isPdpRoute)return this.isModerator?t.o({appearance:"primary",size:t.q.Small,attributes:{href:this.hasModqueueAccess?`/mod/${this.name}/queue`:`/mod/${this.name}/insights`,className:"modtools-btn"},children:"Mod Tools"}):e.x`<faceplate-tracker source="community" action="click" noun="${this.isSubscribed?"unsubscribe":"subscribe"}" data-faceplate-tracking-context="${JSON.stringify({subreddit:{id:this.subredditId,name:this.name}})}"> <shreddit-join-button name="${this.name}" prefixed-name="${this.prefixedName}" subreddit-id="${this.subredditId}" button-classes="min-w-[70px]" subscribe-label="${"Join"}" unsubscribe-label="${"Joined"}" unsubscribe-button-type-override="bordered" ?subscribed="${this.isSubscribed}"></shreddit-join-button></faceplate-tracker>`;},this.renderNotificationControl=()=>this.isSubscribed?e.x` <shreddit-notification-frequency-control subreddit-id="${this.subredditId}" notification-level="${this.notificationLevel}" hfn-ux-updates-variant="${t.ad(this.hfnUxUpdatesVariant)}" ?is-updates-all-enabled="${this.isUpdatesAllEnabled}" subreddit-updates-all-clients-variant="${this.subredditUpdatesAllClientsVariant}" shreddit-subreddit-updates-all-variant="${this.shredditSubredditUpdatesAllVariant}" subreddit-updates-all-clients-version="${this.subredditUpdatesAllClientsVersion}" shreddit-subreddit-updates-all-version="${this.shredditSubredditUpdatesAllVersion}" prefixed-name="${this.prefixedName}" ?is-muted="${this.isMuted}"></shreddit-notification-frequency-control>`:"",this.renderOverflowControl=()=>this.isUserLoggedIn?e.x`<shreddit-subreddit-overflow-control name="${this.name}" prefixed-name="${this.prefixedName}" subreddit-id="${this.subredditId}" ?is-muted="${this.isMuted}" ?is-favorite="${this.isFavorite}" ?subscribed="${this.isSubscribed}" ?show-join-button="${this.isModerator}" ?is-user-logged-in="${this.isUserLoggedIn}" ?allow-custom-feed="${this.isCustomFeedEnabled}"></shreddit-subreddit-overflow-control>`:"",this.checkDescriptionForClamping=()=>{if(!this.isPdpRoute)return;const t=this.getDescriptionContainer();if(!t)return;this.isTextClamped(t)&&this.unhideShowMoreButton()},this.showMoreText=()=>{this.hideShowMoreButton(),this.removeLineClampFromDescription()},this.removeLineClampFromDescription=()=>{const t=this.getDescriptionContainer();t?.classList.remove(l)},this.hideShowMoreButton=()=>{const t=this.getShowMoreButton();t?.classList.add(u)},this.unhideShowMoreButton=()=>{const t=this.getShowMoreButton();t?.classList.remove(u)},this.onShowCommunityGuide=async()=>{try{await this._activateFeature({name:t.gW,routeParams:{subredditName:this.name},renderMode:t.P.Contents})}catch{this.showErrorToast("Failed to load community guide")}},this.onShowModOnboardingGuidePreview=async()=>{try{await this._activateFeature({name:t.gX,routeParams:{subredditName:this.name},queryParams:{"show-mod-guide":"true"},renderMode:t.P.Contents})}catch{this.showErrorToast("Failed to load mod onboarding guide preview")}},this.isTextClamped=t=>t.scrollHeight>t.clientHeight,this.getDescriptionContainer=()=>this.shadowRoot?.getElementById(p),this.getShowMoreButton=()=>this.shadowRoot?.getElementById(x),this.renderShowMoreButton=()=>t.o({appearance:this.isRedesign?"secondary":"plain",attributes:{id:x,className:`${u} ${this.isRedesign?"":"text-[color:var(--color-a-default)]"} no-underline mb-xs`,onclick:this.showMoreText},children:"Show more",size:t.q.Small}),this.renderDescription=()=>this.description?e.x`<div id="${p}" class="i18n-subreddit-description description text-start text-neutral-content-weak overflow-hidden ${this.isPdpRoute?l:""}"> ${this.description} </div> ${this.renderShowMoreButton()}`:e.x``}static get styles(){return[t.t,t.a0(":host {\n  text-align: center;\n}\n.r-slash-icon {\n  border: 2px solid var(--color-tone-1);\n  border-radius: 50%;\n  overflow: hidden;\n}\nh2 {\n  font: var(--font-title-h2);\n  font-weight: bold;\n  margin: 0.5rem 0 0;\n}\n.description,\n.subscribers {\n  margin-bottom: 0.5rem;\n}\n.prefixedName {\n  font-size: 18px;\n}\na {\n  color: inherit;\n  text-decoration: none;\n}\n.header {\n  background-position: top center;\n  background-repeat: no-repeat;\n  background-size: auto 6.8em;\n  position: relative;\n}\n.banner {\n  background-color: var(--color-tone-6);\n  background-position: center center;\n  background-size: cover;\n  margin-top: -1rem;\n  margin-left: -1rem;\n  margin-right: -1rem;\n}\n")]}firstUpdated(){const e=this.parentElement;e&&e.classList.add("xs:block"),this.pubsub.subscribe(t.T.SubredditSubscriptionChange,this.onSubscriptionChange),requestAnimationFrame((()=>{this.checkDescriptionForClamping()}));const n=new CustomEvent(t.dn,{bubbles:!0,composed:!0,detail:{name:"shreddit-subreddit-header"}});this.isModOnboardingGuidesExperimentEnabled&&window.location.search.includes("show-mod-guide=true")&&this.onShowModOnboardingGuidePreview(),this.dispatchEvent(n)}renderPdpRouteHeader(){const t=this.mtSeoSubredditLink?this.mtSeoSubredditLink:`/${this.prefixedName}/`;return e.x` <div class="${"flex justify-between"}"> ${this.prefixedName?e.x` <span class="flex items-center truncate"> <a href="${t}" class="flex justify-between truncate focus-visible:-outline-offset-1"> <div class="prefixedName font-bold truncate me-xs">${this.prefixedName}</div> </a> <slot name="community-status"></slot> </span> `:""} <div class="flex items-center gap-sm">${this.renderJoinOrModButton()}</div> </div>`}renderHeader(){return this.routerName===c.s?e.x`<h2 class="uppercase text-start font-semibold text-neutral-content-weak text-12 mb-sm"> ${"About community"} </h2>`:!this.newBannerExperimentEnabled||this.isPdpRoute?e.x` <div class="${"flex flex-col gap-sm pt-md"}"> <div class="flex justify-between gap-sm"> ${this.prefixedName?e.x` <a class="prefixedName font-bold truncate me-xs no-underline" href="${`/${this.prefixedName}`}">${this.prefixedName}</a> `:""} ${this.renderOverflowControl()} </div> <div class="flex items-center gap-sm"> ${this.renderJoinOrModButton()} ${this.renderNotificationControl()} </div> </div>`:void 0;}renderBanner(){return this.routerName===c.s||this.isPdpRoute?"":e.x`<div class="banner rounded-t-[8px]" style="${t.a6({backgroundImage:this.bannerUrl?`url('${this.bannerUrl}')`:"",backgroundColor:this.bannerFallbackBackgroundColor?this.bannerFallbackBackgroundColor:"",height:this.bannerUrl?"128px":""})}"></div>`}renderWeeklyActivityIndicators(){if(!this.isActivityIndicatorsEnabled||this.isModInsightsWidgetExperimentEnabled&&this.isModerator||this.routerName===c.s||!this.weeklyActiveUsersCount)return e.A;const n=e.x` <span class="text-neutral-content-strong"> <strong><slot name="weekly-active-users-count"></slot></strong></span> `,s=this.subscribersText?e.x` ${n} <span class="text-[12px] text-neutral-content-weak">${this.subscribersText}</span> `:t.cB({one:e.x` ${n} <span class="text-[12px] text-neutral-content-weak">Weekly visitor</span> `,other:e.x` ${n} <span class="text-[12px] text-neutral-content-weak">Weekly visitors</span> `,count:this.weeklyActiveUsersCount}),a=e.x` <span class="text-neutral-content-strong"> <strong><slot name="weekly-contributions-count"></slot></strong></span> `,i=this.currentlyViewingText?e.x` ${a} <span class="text-[12px] text-neutral-content-weak">${this.currentlyViewingText}</span> `:t.cB({one:e.x` ${a} <span class="text-[12px] text-neutral-content-weak">Weekly contribution</span> `,other:e.x` ${a} <span class="text-[12px] text-neutral-content-weak">Weekly contributions</span> `,count:this.weeklyContributionsCount});return e.x` <div class="flex flex-wrap text-start mt-xs gap-2xs" data-testid="activity-indicators"> <div class="flex flex-col items-start flex-grow">${s}</div> ${this.weeklyContributionsCount?e.x`<div class="flex flex-col items-start flex-grow">${i}</div>`:e.A} </div> `}renderSubscribers(){if(this.isModInsightsWidgetExperimentEnabled&&this.isModerator||this.routerName===c.s||!this.subscribers)return e.A;const n=e.x` <span class="text-neutral-content-strong"> <strong id="subscribers"> <faceplate-number number="${this.subscribers}" pretty> </faceplate-number> </strong></span> `,s=this.subscribersText?e.x` ${n} <span class="text-[12px] text-neutral-content-weak subscribers-text"> ${this.subscribersText} </span> `:t.cB({one:e.x` ${n} <span class="text-[12px] text-neutral-content-weak subscribers-text"> Member </span> `,other:e.x` ${n} <span class="text-[12px] text-neutral-content-weak subscribers-text"> Members </span> `,count:this.subscribers}),a=e.x` <strong id="online"><faceplate-number number="${this.active}" pretty></faceplate-number></strong> `,i="Online",r=this.currentlyViewingText||i;return e.x` <div class="flex flex-wrap text-start subscribers mt-xs gap-2xs"> <div class="flex flex-col items-start flex-grow">${s}</div> ${this.active?e.x` <div class="active flex flex-col items-start flex-grow"> <span class="text-neutral-content-strong"> ${a} </span> <span class="text-[12px] text-neutral-content-weak"> <span class="inline-flex bg-kiwigreen-400 rounded-full w-xs h-xs"></span> <span class="currently-viewing-text">${r}</span> </span> </div> `:""} <div class="flex flex-grow flex-col items-start"> <slot name="directoryLink"></slot> </div> </div> `}showErrorToast(e){const n=t.c("faceplate-alert",{message:e,level:t.a5.error,cause:"uncategorized"});this.dispatchEvent(n)}renderCommunityGuideBtn(){if(!this.isCommunityGuideExperimentEnabled)return"";if(this.hasCommunityGuide){const n=r.g(this.subredditId,this.name);return e.x` <faceplate-tracker class="mt-sm mb-md" source="${r.S.COMMUNITY_GUIDE}" action="${r.A.CLICK}" noun="${r.N.OPEN}" data-faceplate-tracking-context="${n}"> ${t.o({appearance:"secondary",size:t.q.Small,attributes:{id:"show-community-guide-btn",className:"w-full",onclick:this.onShowCommunityGuide},children:"Community Guide",leadingIcon:a.b({size:e.I.ExtraSmall})})} </faceplate-tracker> `;}return this.isModerator?t.o({appearance:"bordered",size:t.q.Small,attributes:{id:"community-guide-settings",className:"w-full mt-sm mb-md",href:`/mod/${this.name}/guide`,target:"_blank"},children:"Add a community guide",leadingIcon:n.a({size:e.I.ExtraSmall})}):"";}renderModOnboardingGuidePreviewBtn(){return this.isModerator&&this.isModOnboardingGuidesExperimentEnabled?e.x`${t.o({appearance:"secondary",size:t.q.Small,attributes:{id:"show-mod-onboarding-guide-preview-btn",className:"w-full mt-sm",onclick:this.onShowModOnboardingGuidePreview},children:"Mod Guide",leadingIcon:i.t({size:e.I.Small})})}`:"";}renderTitle(){const n=this.displayName||this.name,a=e.x`<div id="title" class="i18n-subreddit-title text-start text-neutral-content ${this.isRedesign?"text-16 font-semibold":"text-14 font-bold"} mt-xs"> ${n} </div>`;return this.allowIdCardEdit&&!this.isPdpRoute?e.x` <div class="flex justify-between items-end py-xs"> ${a} <community-widget-edit-button subreddit-name="${this.name}" page-id="${o.E.IdCard}" widget-id="${this.idCardWidgetId}"> <faceplate-tracker source="community_widgets" action="click" noun="edit_widget" data-faceplate-tracking-context="${JSON.stringify({widget:{type:o.W[o.E.IdCard],target_subreddit_name:this.name,target_subreddit_id:this.subredditId}})}"> ${t.o({appearance:"secondary",shape:"pill",attributes:{type:"button",className:"w-lg h-lg","aria-label":"Edit subreddit ID card"},leadingIcon:s.e({size:e.I.ExtraSmall}),size:t.q.ExtraSmall})} </faceplate-tracker> </community-widget-edit-button> </div>`:a;}render(){const t="Community Info Section";return e.x` <div class="header ${this.isRedesign?"":"px-md"}"> <h1 class="absolute -top-full -start-full w-px h-px overflow-hidden" aria-label="${t}"> ${t} </h1> ${this.renderBanner()} ${this.isPdpRoute?this.renderPdpRouteHeader():this.renderHeader()} <div class="flex flex-col justify-start"> ${this.renderTitle()} ${this.renderDescription()} <slot name="community-details"></slot> ${this.renderModOnboardingGuidePreviewBtn()} ${this.renderCommunityGuideBtn()} </div> <div class="flex flex-col justify-start ${this.isActivityIndicatorsEnabled&&this.isModerator&&this.isModInsightsWidgetExperimentEnabled&&!this.isCommunityGuideExperimentEnabled?"mt-md":""}"> <slot name="mod-insights-widget"></slot> </div> ${this.isActivityIndicatorsEnabled?this.renderWeeklyActivityIndicators():this.renderSubscribers()} </div> `}};t._([t.n({type:String})],d.prototype,"name",void 0),t._([t.n({type:String,attribute:"subreddit-id"})],d.prototype,"subredditId",void 0),t._([t.n({type:String,attribute:"prefixed-name"})],d.prototype,"prefixedName",void 0),t._([t.n({type:String,attribute:"display-name"})],d.prototype,"displayName",void 0),t._([t.n({type:String})],d.prototype,"description",void 0),t._([t.n({type:Number})],d.prototype,"subscribers",void 0),t._([t.n({type:String,attribute:"banner-url"})],d.prototype,"bannerUrl",void 0),t._([t.n({type:String,attribute:"router-name"})],d.prototype,"routerName",void 0),t._([t.n({type:String,attribute:"banner-background-fallback-color"})],d.prototype,"bannerFallbackBackgroundColor",void 0),t._([t.n({type:String,attribute:"notification-level"})],d.prototype,"notificationLevel",void 0),t._([t.n({type:String,attribute:"id-card-widget-id"})],d.prototype,"idCardWidgetId",void 0),t._([t.n({type:String,attribute:"subscribers-text"})],d.prototype,"subscribersText",void 0),t._([t.n({type:String,attribute:"currently-viewing-text"})],d.prototype,"currentlyViewingText",void 0),t._([t.n({type:Number,attribute:"weekly-active-users"})],d.prototype,"weeklyActiveUsersCount",void 0),t._([t.n({type:Number,attribute:"weekly-contributions"})],d.prototype,"weeklyContributionsCount",void 0),t._([t.n({type:Boolean,attribute:"activity-indicators-enabled"})],d.prototype,"isActivityIndicatorsEnabled",void 0),t._([t.n({type:Boolean,attribute:"is-moderator"})],d.prototype,"isModerator",void 0),t._([t.n({type:Boolean,attribute:"modqueue-access"})],d.prototype,"hasModqueueAccess",void 0),t._([t.n({type:Boolean,attribute:"is-subscribed"})],d.prototype,"isSubscribed",void 0),t._([t.n({type:Boolean,attribute:"is-muted"})],d.prototype,"isMuted",void 0),t._([t.n({type:Boolean,attribute:"is-favorite"})],d.prototype,"isFavorite",void 0),t._([t.n({type:Boolean,attribute:"is-user-logged-in"})],d.prototype,"isUserLoggedIn",void 0),t._([t.n({type:Boolean,attribute:"is-pdp-route"})],d.prototype,"isPdpRoute",void 0),t._([t.n({type:Boolean,attribute:"new-banner-experiment-enabled"})],d.prototype,"newBannerExperimentEnabled",void 0),t._([t.n({type:Boolean,attribute:"allow-id-card-edit"})],d.prototype,"allowIdCardEdit",void 0),t._([t.n({type:Boolean,attribute:"allow-custom-feed"})],d.prototype,"isCustomFeedEnabled",void 0),t._([t.n({type:Number})],d.prototype,"active",void 0),t._([t.n({type:Boolean,attribute:"has-community-guide"})],d.prototype,"hasCommunityGuide",void 0),t._([t.n({type:Boolean,attribute:"community-guide-experiment-enabled"})],d.prototype,"isCommunityGuideExperimentEnabled",void 0),t._([t.n({type:Boolean,attribute:"is-mod-insights-widget-experiment-enabled"})],d.prototype,"isModInsightsWidgetExperimentEnabled",void 0),t._([t.n({type:Boolean,attribute:"mod-onboarding-guides-experiment-enabled"})],d.prototype,"isModOnboardingGuidesExperimentEnabled",void 0),t._([t.n({type:Boolean,attribute:"redesign"})],d.prototype,"isRedesign",void 0),t._([t.n({type:String,attribute:"mt-seo-subreddit-link"})],d.prototype,"mtSeoSubredditLink",void 0),t._([t.n({type:String,attribute:"hfn-ux-updates-variant"})],d.prototype,"hfnUxUpdatesVariant",void 0),t._([t.n({type:Boolean,attribute:"is-updates-all-enabled"})],d.prototype,"isUpdatesAllEnabled",void 0),t._([t.n({type:String,attribute:"subreddit-updates-all-clients-variant"})],d.prototype,"subredditUpdatesAllClientsVariant",void 0),t._([t.n({type:String,attribute:"shreddit-subreddit-updates-all-variant"})],d.prototype,"shredditSubredditUpdatesAllVariant",void 0),t._([t.n({type:String,attribute:"subreddit-updates-all-clients-version"})],d.prototype,"subredditUpdatesAllClientsVersion",void 0),t._([t.n({type:String,attribute:"shreddit-subreddit-updates-all-version"})],d.prototype,"shredditSubredditUpdatesAllVersion",void 0),d=t._([t.e("shreddit-subreddit-header")],d)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("BDidT9_yHr",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6"],(async(e,t,o)=>{class r extends e.R{constructor(){super(...arguments),this.elevated=!1}render(){return t.x` <slot></slot> `}}e._([e.n({type:Boolean})],r.prototype,"elevated",void 0);var n=t.a`${e.a7}:host{--rpl-card-border-radius:var(--rem16);display:flex;flex-direction:column;background-color:var(--color-neutral-background-container);border-radius:var(--rpl-card-border-radius)}:host([elevated]){background-color:var(--color-neutral-background);box-shadow:var(--0,0) var(--1,1px) var(--2,2px) var(--0,0) var(--color-elevation-xsmall)}`;let l=class extends r{};l.styles=n,l=e._([e.e("rpl-card")],l);class s extends e.R{constructor(){super(...arguments),this.disabled=!1,this.hoverable=!1,this.selected=!1,this.forceTouchOnly=!1,this.role="button",this.inaccessibleHref="",this.preventNavigation=!1,this.slotController=new o.d(this),this.handleClick=e=>{if(this.disabled)return void e.preventDefault();const t=e.target;if(t.closest("a, button"))return;if(t.closest('[slot="leading"]')||t.closest('[slot="trailing"]')||t.closest('[slot="hover-actions"]')||t.closest("#hover-menu"))return;if(t.closest("shreddit-comment-action-row"))return;const o=0===e.button,r=1===e.button,n=o||r;this.inaccessibleHref&&!this.preventNavigation&&n&&this.navigateTo(this.inaccessibleHref,e.metaKey||r?"_blank":this.inaccessibleHrefTarget)},this._assign=e=>{window.location.assign(e)}}connectedCallback(){super.connectedCallback(),(s.isTouchOnly||this.forceTouchOnly)&&this.setAttribute("rpl-touch-only",""),this.addEventListener("mouseup",this.handleClick)}navigateTo(e,t){this.dispatchEvent(new CustomEvent("rpl-inbox-row:navigate",{bubbles:!0,detail:{href:this.inaccessibleHref}})),t?window.open(e,t):this._assign(e)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("mouseup",this.handleClick)}willUpdate(){this.setAttribute("aria-disabled",this.disabled?"true":"false"),this.setAttribute("role",this.role)}render(){return t.x` <div class="${e.Z({leading:!0,hidden:!this.slotController.hasSlotContent("leading")})}"> <slot name="leading" @slotchange="${this.slotController.handleSlotChange}"></slot> </div> <div class="content"><slot></slot></div> <div class="trailing"><slot name="trailing"></slot></div> <div id="hover-menu"> <rpl-card elevated> <slot name="hover-actions"></slot> </rpl-card> </div> `}}s.isTouchOnly=o.w(),e._([e.n({type:Boolean,reflect:!0})],s.prototype,"disabled",void 0),e._([e.n({type:Boolean,reflect:!0})],s.prototype,"hoverable",void 0),e._([e.n({type:Boolean,reflect:!0})],s.prototype,"selected",void 0),e._([e.n({type:Boolean,reflect:!0,attribute:"force-touch-only"})],s.prototype,"forceTouchOnly",void 0),e._([e.n({type:String,reflect:!0})],s.prototype,"role",void 0),e._([e.n({type:String,reflect:!0})],s.prototype,"inaccessibleHref",void 0),e._([e.n({type:String,reflect:!0})],s.prototype,"inaccessibleHrefTarget",void 0),e._([e.n({type:Boolean,reflect:!0})],s.prototype,"preventNavigation",void 0);var i=t.a`${e.a7}:host{display:flex;gap:var(--rem12);padding:var(--rem8) var(--rem16);position:relative}:host([hoverable]:not([disabled])){cursor:pointer}:host([selected]){background-color:var(--color-neutral-background-container-strong)}:host([disabled]){opacity:.5;pointer-events:none}:host(:not([rpl-touch-only]):not([disabled])[hoverable]:hover){background-color:var(--color-neutral-background-hover)}:host([selected]:not([rpl-touch-only]):not([disabled])[hoverable]:hover){background-color:var(--color-neutral-background-container-strong-hover)}#hover-menu{display:flex;opacity:0;position:absolute;top:0;inset-inline-end:0;transform:translateY(-60%);pointer-events:none;z-index:1}:host([disabled]) #hover-menu,:host([rpl-touch-only]) #hover-menu{display:none}:host(:focus-within:not([rpl-touch-only]):not([disabled])) #hover-menu,:host(:hover:not([rpl-touch-only]):not([disabled])) #hover-menu{opacity:1;pointer-events:auto}rpl-card{display:flex;flex-direction:row;padding:var(--rem2)}.leading.hidden{display:none}.content{min-width:0;display:flex;flex:1}.trailing{display:flex;align-items:center}`;let a=class extends s{};return a.styles=i,a=e._([e.e("rpl-inbox-row")],a),{I:s}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("BDs3iC2vQ1",["Dw4vb8Yfbm","5r73EsgItq"],(async(t,e)=>{let o=class extends e.s{constructor(){super(...arguments),this.feature="",this.routeParams="",this.queryParams="",this.dialogId="",this.dialogContentId="",this.featureRootSelector=""}parseParams(t){try{return JSON.parse(t)}catch{return}}async showModal(){await t.r({name:this.feature,routeParams:this.parseParams(this.routeParams),queryParams:this.parseParams(this.queryParams),renderMode:t.P.Contents,root:this.featureRootSelector?document.querySelector(this.featureRootSelector)??document:document});const e=document.querySelector(`rpl-dialog#${this.dialogId}`),o=new CustomEvent("custom-feed-edit-button:dialog-loaded",{detail:{dialog:e}});this.dispatchEvent(o);const r=()=>e.portalContainer,a=()=>{const t=r();return t?.querySelectorAll('[slot="close-button"]')??[]},s=()=>e.hide(),i=()=>{a().forEach((t=>{t.addEventListener("click",s)})),r()?.addEventListener("close-dialog",s)};e.open?i():(e.addEventListener("rpl-dialog:after-show",i),e.showModal()),e.addEventListener("rpl-dialog:hide",(()=>{a().forEach((t=>{t.removeEventListener("click",s)})),r()?.removeEventListener("close-dialog",s)}))}handleKeyDown(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),this.showModal())}render(){return e.x`<slot @click="${this.showModal}" @keydown="${this.handleKeyDown}"></slot>`}};o.styles=[t.t],t._([t.n({type:String})],o.prototype,"feature",void 0),t._([t.n({type:String,attribute:"route-params"})],o.prototype,"routeParams",void 0),t._([t.n({type:String,attribute:"query-params"})],o.prototype,"queryParams",void 0),t._([t.n({type:String,attribute:"dialog-id"})],o.prototype,"dialogId",void 0),t._([t.n({type:String,attribute:"dialog-content-id"})],o.prototype,"dialogContentId",void 0),t._([t.n({type:String,attribute:"feature-root-selector"})],o.prototype,"featureRootSelector",void 0),o=t._([t.e("custom-feed-edit-button")],o)}));
SML.dm("BHQvZGlXFT",[],(async()=>{var t;!function(t){t.Main="main",t.TextArea="text-area",t.Button="button",t.SubredditRules="subreddit-rules",t.Image="image",t.CommunityList="community-list",t.Calendar="calendar",t.Custom="custom",t.IdCard="id-card",t.PostFlair="post-flair",t.Menu="menu"}(t||(t={}));const e={[t.Main]:"",[t.TextArea]:"text_widget",[t.Button]:"button_widget",[t.SubredditRules]:"rules_widget",[t.Image]:"image_widget",[t.CommunityList]:"community_list_widget",[t.Calendar]:"calendar_widget",[t.Custom]:"custom_widget",[t.IdCard]:"id_card",[t.PostFlair]:"post_flair_widget",[t.Menu]:"bookmarks_widget"};return{C:"community-widget-edit-modal",get E(){return t},W:e}}));

SML.di("./DIddQxTrh3.js",import.meta.url,"DIddQxTrh3");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./Cy0QTNmAAP.js",import.meta.url,"Cy0QTNmAAP");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("BIvvQbZj9p",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6"],(async(t,e,i)=>{const n=[{key:"TOTAL_MRC_VIEWABLE_TIME",playing:!0,threshold:t.cg.VIEWABILITY_THRESHOLD},{key:"TOTAL_AUDIBLE_TIME",playing:!0,threshold:0,withSound:!0},{key:"HALF_DURATION_80_IN_VIEW_AUDIBLE",playing:!0,withSound:!0,threshold:t.cg.EIGHTY_VIEWABILITY_THRESHOLD},{key:"FULL_IN_VIEW_AUDIBLE_TIME",playing:!0,threshold:t.cg.FULL_VIEWABILITY_THRESHOLD,withSound:!0},{key:"FULL_IN_VIEW_TIME",playing:!0,threshold:t.cg.FULL_VIEWABILITY_THRESHOLD},{key:"ANY_IN_VIEW_TIME",playing:!0,threshold:t.cg.VISIBILITY_THRESHOLD},{key:"FIFTY_IN_VIEW_TIME",playing:!0,threshold:t.cg.VIEWABILITY_THRESHOLD},{key:"EIGHTY_IN_VIEW_TIME",playing:!0,threshold:t.cg.EIGHTY_VIEWABILITY_THRESHOLD}];function o(t,e){const i=new URL(t);return Object.entries(e).forEach((([t,e])=>{i.searchParams.set(t,String(e))})),i.toString()}const r=n.map((t=>t.key));const a="noopener nofollow sponsored";let s=class extends e.s{constructor(){super(...arguments),this.impressionId="0",this.clickLocation=t.D.UNKNOWN,this.renderAsButton=!1,this.ButtonProps={},this.anchorStyleClass="",this.isOutboundLinkInitialized=!1}static get styles(){return[t.t,t.a0("a {\n  color: inherit;\n  text-decoration: none;\n}\nbutton {\n  all: unset;\n  display: inline-block;\n  height: 100%;\n  width: 100%;\n  background: transparent;\n  cursor: pointer;\n}\n")]}get effectiveOutboundLink(){const t=this.outboundLinkOverride??(this.outboundLinkUrl||"");return i.ae(t)&&this.metadata?o(t,this.metadata):t}get calculatedTabIndex(){return this.disableKeyboardNav?"-1":""===this.effectiveOutboundLink?"0":void 0}connectedCallback(){super.connectedCallback(),void 0===this.outboundLinkOverride&&(this.outboundLinkUrl=this.getOutboundLinkUrlFromParent(),this.isOutboundLinkInitialized=!0)}updated(t){void 0===this.outboundLinkOverride&&t.has("galleryIndex")&&(this.outboundLinkUrl=this.getOutboundLinkUrlFromParent())}getOutboundLinkUrlFromParent(){const t=i.af(this);if(!t)return;if(void 0===this.galleryIndex)return t.getAttribute("outbound-link-url");const e=t.getAttribute("gallery-items");let n;try{n=JSON.parse(e||"[]")}catch{n=[]}return n[this.galleryIndex]?.outboundUrl}fetchAndUpdateMetadata(){if(!i.ae(this.effectiveOutboundLink))return;const e=i.af(this);if(!e)return;const n=e.getMetadataForPixelEvent(t.ch.CLICK);n&&(this.metadata=n)}handleClick(e){if("auxclick"===e.type&&1!==e.button)return;void 0!==this.outboundLinkOverride||this.isOutboundLinkInitialized||(this.outboundLinkUrl=this.getOutboundLinkUrlFromParent(),this.isOutboundLinkInitialized=!0),i.ag(this.effectiveOutboundLink)&&"_blank"===this.target&&t.ci(this.impressionId),this.fetchAndUpdateMetadata(),i.t({el:this,clickLocation:this.clickLocation,galleryIndex:this.galleryIndex});if(this.clickLocation===t.D.PROMOTED_LABEL&&this.hasAttribute("promoted-label-experiment")||i.ah({el:this,clickLocation:this.clickLocation,outboundUrl:this.effectiveOutboundLink,galleryIndex:this.galleryIndex}),function(e){const i=t=>{try{return t()}catch{return null}};let n=i((()=>new URL(e)));return n||(n=i((()=>new URL(e,location.origin)))),!!n&&"1"===n.searchParams.get(t.cf)}(this.effectiveOutboundLink)){const t=this.closest("shreddit-ad-post");if(!t)return;i.ai({impressionId:this.impressionId,adEvents:t.adEvents,clickRedirectUrl:this.effectiveOutboundLink}),i.aj(t.adUserTargeting)}i.ag(this.effectiveOutboundLink)&&"contextmenu"!==e.type&&t.aA(t.cj)&&(e.preventDefault(),this.fetchAndUpdateMetadata(),window.open(this.effectiveOutboundLink,this.target||"_self"))}render(){const n=this.effectiveOutboundLink||void 0,o=e.x`<slot></slot>`;if(this.renderAsButton)return t.o({appearance:i.ak()?"secondary":"bordered",children:o,size:t.q.Medium,attributes:{href:n,onclick:this.handleClick,oncontextmenu:this.handleClick,target:this.target,rel:a,className:this.anchorStyleClass},...this.ButtonProps});const r=this.effectiveOutboundLink||"_self"===this.target,s=i.j(this.anchorStyleClass,r?"cursor-pointer":"cursor-default");return e.x`<a class="${s}" href="${t.ad(n)}" target="${t.ad(this.target)}" tabindex="${t.ad(this.calculatedTabIndex)}" @click="${this.handleClick}" @mouseover="${this.fetchAndUpdateMetadata}" @focus="${this.fetchAndUpdateMetadata}" @contextmenu="${this.handleClick}" @auxclick="${this.handleClick}" rel="${a}" role="${n?"link":"button"}" aria-label="${t.ad(this.ariaLabel)}"> ${o} </a>`}};return t._([t.n({type:String,attribute:"outbound-link-override",reflect:!0})],s.prototype,"outboundLinkOverride",void 0),t._([t.n({type:String,attribute:"impression-id"})],s.prototype,"impressionId",void 0),t._([t.n({type:String,attribute:"click-location"})],s.prototype,"clickLocation",void 0),t._([t.n({type:String,attribute:"post-id"})],s.prototype,"postId",void 0),t._([t.n({type:Number,attribute:"gallery-index",reflect:!0})],s.prototype,"galleryIndex",void 0),t._([t.n({type:String})],s.prototype,"target",void 0),t._([t.n({type:Boolean,attribute:"disable-keyboard-nav"})],s.prototype,"disableKeyboardNav",void 0),t._([t.n({type:Boolean,attribute:"render-as-button"})],s.prototype,"renderAsButton",void 0),t._([t.n({type:Object,attribute:"button-props"})],s.prototype,"ButtonProps",void 0),t._([t.n({type:String,attribute:"anchor-style-class"})],s.prototype,"anchorStyleClass",void 0),t._([t.a2("a")],s.prototype,"anchorEl",void 0),t._([t.a2("slot")],s.prototype,"slotEl",void 0),t._([t.h()],s.prototype,"outboundLinkUrl",void 0),t._([t.h()],s.prototype,"metadata",void 0),s=t._([t.e("shreddit-dynamic-ad-link")],s),{get S(){return s},V:n,a:o,b:r,g:t=>t.reduce(((t,e)=>(t[e]={maxContinuousTime:0,currentContinuousTime:0,totalTime:0},t)),{})}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("BIzQFHISzm",["Dw4vb8Yfbm"],(async a=>{const{svg:c}=a.a();return{c:a.m(c`<path d="M7.09 15.84c-.23 0-.46-.09-.64-.26L1.3 10.42a.9.9 0 010-1.27.9.9 0 011.27 0l4.52 4.52L17.5 3.26a.9.9 0 011.27 0 .9.9 0 010 1.27L7.73 15.58c-.18.18-.41.26-.64.26z"></path>`,"0 0 20 20","checkmark"),n:function(a,c,n){return a?c():null==n?void 0:n()}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("BLIiwX-G4B",["Dw4vb8Yfbm"],(async c=>{const{svg:a}=c.a();return{b:c.m(a`<path d="M10 1c-4.96 0-9 4.04-9 9s4.04 9 9 9 9-4.04 9-9-4.04-9-9-9zm7.2 9c0 .27-.02.54-.05.8h-2.97c-.1 2.33-.63 4.38-1.41 5.84-.75.31-1.56.5-2.42.54.87-.53 2.06-2.85 2.22-6.38H7.41c.16 3.54 1.35 5.85 2.22 6.38a7 7 0 01-2.42-.54c-.78-1.46-1.31-3.52-1.41-5.84H2.83c-.03-.26-.05-.53-.05-.8s.02-.54.05-.8H5.8c.1-2.33.63-4.38 1.41-5.84.75-.31 1.56-.5 2.42-.54-.87.53-2.06 2.85-2.22 6.38h5.16c-.16-3.54-1.35-5.85-2.22-6.38a7 7 0 012.42.54c.78 1.46 1.31 3.52 1.41 5.84h2.97c.03.26.05.53.05.8z"></path>`,"0 0 20 20","browser-fill")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("BLbwpJ0bjx",["Dw4vb8Yfbm"],(async a=>{const{svg:c}=a.a();return{n:a.m(c`<path d="M2.919 3.21a.9.9 0 10-1.273 1.272l1.627 1.627A6.902 6.902 0 003 8v3.184c0 .38-.087.762-.251 1.105l-.927 1.932A1.103 1.103 0 002.82 15.8h3.26A4.007 4.007 0 0010 19a4 4 0 003.69-2.473l1.955 1.955a.897.897 0 001.274 0 .898.898 0 000-1.272l-14-14zm7.08 13.99c-.93 0-1.721-.583-2.042-1.4h4.087A2.197 2.197 0 0110 17.2zM3.926 14l.447-.933c.28-.584.429-1.235.429-1.883V8c0-.113.025-.219.033-.329L11.163 14H3.925zm14.188 1.286a1.098 1.098 0 01-.274.286l-1.941-1.941-.27-.564a4.382 4.382 0 01-.43-1.883V8c0-2.867-2.331-5.2-5.198-5.2-1.365 0-2.6.54-3.528 1.404l-1.28-1.279A6.966 6.966 0 0110 1c3.859 0 7 3.14 7 7v3.184c0 .38.087.762.25 1.105l.926 1.929c.165.348.14.746-.063 1.068z"></path>`,"0 0 20 20","notifications-off")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./Yp_OV6CjXa.js",import.meta.url,"Yp_OV6CjXa");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Dd6H0lWggE.js",import.meta.url,"Dd6H0lWggE");
SML.dm("BLo4HzLOT6",["Dw4vb8Yfbm","Yp_OV6CjXa","5r73EsgItq","Dd6H0lWggE"],(async(e,i,t)=>{const r=e=>{switch(e){case i.R.Spoiler:return `${"View spoiler"}`;case i.R.NsfwAndSpoiler:return `${"View NSFW content & spoilers"}`;default:return `${"View NSFW content"}`;}};let s=class extends t.s{constructor(){super(),this.blurred=!0,this.isNsfwAllowed=!0,this.blurRadius=40,this.mode=i.M.Slot,this.isCrosspost=!1,this.isRichtextContent=!1,this.hasMetadata=!1,this._windowEvents=new e.E(this,(()=>window)),this.handleNsfwEvent=e=>{if("xpromo/view/nsfw_blur"===e.SAN){this.isNsfwAllowed=!1;const e=this.querySelector('div[slot="revealed"]');e&&this.removeChild(e)}},this._windowEvents.define(e.bT,this.handleNsfwEvent)}static get styles(){return[e.t,t.a`.outer{width:100%;overflow:hidden;z-index:0;position:relative}.overlay{cursor:pointer;position:absolute;width:100%;height:100%;top:0;left:0;z-index:1;display:flex;justify-content:center;align-items:center}.inner.blurred{display:block;pointer-events:none;background:rgba(0,0,0,.8)}.legacy-button{background:rgba(0,0,0,.07);border:1px solid #fff;color:#fff;padding:10px 20px;position:absolute;text-transform:uppercase;cursor:pointer}`]}renderOverlay(s){const n=this.reason?e.o({appearance:"media",size:e.q.Small,shape:"pill",children:r(this.reason)}):t.x``;return this.reason===i.R.Spoiler&&this.blurred?t.x`${o({content:n})}`:this.isNsfwAllowed&&this.blurred&&s?o({content:n}):""}render(){const r=this.isRichtextContent&&this.blurred,s=this.reason===i.R.NSFW||this.reason===i.R.NsfwAndSpoiler;return t.x` <div class="${e.Z({outer:!0,"xs:rounded-t-[16px]":!!this.reason&&!this.isCrosspost&&this.blurred,"xs:rounded-b-[16px]":!!this.reason&&!this.isCrosspost&&(r||!this.hasMetadata)&&this.blurred,"h-[88px]":r,"h-full":!r})}" @click="${this.handleClick}"> ${this.renderOverlay(s)} <span class="${e.Z({inner:!0,blurred:this.blurRadius>0&&this.blurred})}" style="${e.a6({filter:this.blurred&&this.blurRadius>0&&`blur(${this.blurRadius}px)`||"none"})}" aria-hidden="${Boolean(this.blurred)}" aria-live="polite"> ${this.mode===i.M.Slot&&this.blurred?t.x` <slot name="blurred"></slot> `:t.x` <slot name="revealed"></slot> `} </span> ${this.blurred?t.x`<div class="absolute top-0 left-0 w-full h-full bg-scrim"></div>`:""} </div> `}handleClick(){const e=this.reason===i.R.NSFW||this.reason===i.R.NsfwAndSpoiler;(this.reason===i.R.Spoiler&&this.blurred||this.blurred&&e)&&(this.isNsfwAllowed||this.reason===i.R.Spoiler)&&(this.blurred=!1)}};e._([e.h()],s.prototype,"blurred",void 0),e._([e.h()],s.prototype,"isNsfwAllowed",void 0),e._([e.n({type:Number,attribute:"blur-radius"})],s.prototype,"blurRadius",void 0),e._([e.n({type:String})],s.prototype,"reason",void 0),e._([e.n({type:String})],s.prototype,"mode",void 0),e._([e.n({type:Boolean,attribute:"is-crosspost"})],s.prototype,"isCrosspost",void 0),e._([e.n({type:Boolean,attribute:"is-richtext-content"})],s.prototype,"isRichtextContent",void 0),e._([e.n({type:Boolean,attribute:"has-metadata"})],s.prototype,"hasMetadata",void 0),s=e._([e.e("shreddit-blurred-container")],s);const o=({content:e})=>t.x`<div data-ignore-click-interception class="overlay">${e}</div>`;return{get S(){return s}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("BLrhRle6xP",["Dw4vb8Yfbm"],(async n=>{var e;!function(n){n.NEUTRAL="NEUTRAL",n.SUCCESS="SUCCESS",n.WARNING="WARNING",n.ALERT="ALERT",n.PLAIN="PLAIN",n.DISABLED="DISABLED",n.DANGER="DANGER",n.INVERTED="INVERTED",n.SECONDARY="SECONDARY",n.MEDIA="MEDIA",n.BRAND="BRAND"}(e||(e={}));const r="bg-brand-background text-brand-onBackground",t="bg-secondary-background text-secondary-onBackground",a={[e.WARNING]:"bg-warning-background text-neutral-background",[e.SUCCESS]:"bg-success-background text-primary-onBackground",[e.NEUTRAL]:"bg-neutral-content text-neutral-background",[e.PLAIN]:t,[e.ALERT]:r,[e.BRAND]:r,[e.DANGER]:"bg-danger-background text-primary-onBackground",[e.DISABLED]:"bg-interactive-content-disabled text-neutral-background",[e.INVERTED]:"bg-inverted-neutral-background text-neutral-background",[e.SECONDARY]:t,[e.MEDIA]:"bg-media-background text-media-onBackground"};return{get B(){return e},b:({attributes:r,appearance:t=e.NEUTRAL,content:o,outline:c=!1})=>{const{html:d,createElement:E}=n.a(),u=d`<span class="font-semibold inline-block text-caption-2 text-center ${o&&"min-h-[1rem] min-w-[0.5rem]"} px-2xs">${o}</span>`;let b="rounded-full inline-flex";return o||(b+=" h-xs w-xs"),c&&(b+=" border-md border-solid border-neutral-background"),E("span",{...r,className:`${[a[t]]} ${b} ${r?.className}`,rpl:!0},u)}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("BM4eKBOTt3",["Dw4vb8Yfbm"],(async a=>{const{svg:h}=a.a();return{l:a.m(h`<path d="M15.995 8.168h-.429V6.61A5.573 5.573 0 0010 1.044 5.573 5.573 0 004.434 6.61v1.557h-.429A2.005 2.005 0 002 10.173v3.692a5.054 5.054 0 005.054 5.054h5.892A5.054 5.054 0 0018 13.865v-3.692a2.005 2.005 0 00-2.005-2.005zM6.233 6.61A3.771 3.771 0 0110 2.843a3.771 3.771 0 013.767 3.767v1.557H6.234V6.61h-.001zm9.967 7.254a3.258 3.258 0 01-3.254 3.254H7.054A3.258 3.258 0 013.8 13.864v-3.692c0-.113.092-.205.205-.205h11.991c.113 0 .205.092.205.205l-.001 3.692zm-7.1-1.676h1.8v2.809H9.1v-2.81z"></path>`,"0 0 20 20","lock")}}));
SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");
SML.dm("BOFc1KQJc-",["C8QDHFSIkY"],(async e=>{var i;!function(e){e.addRemovalReason="add_removal_reason",e.distinguishAsMod="distinguish_as_mod",e.distinguishAsAdmin="distinguish_as_admin",e.sticky="sticky",e.lock="lock",e.approve="approve",e.remove="remove",e.removeAsSpam="remove_as_spam",e.confirmRemoval="confirm_removal",e.approveOptimistic="approve_optimistic",e.removeOptimistic="remove_optimistic",e.removeAsSpamOptimistic="remove_as_spam_optimistic",e.confirmRemovalOptimistic="confirm_removal_optimistic",e.ignoreReports="ignore_reports",e.edit="edit",e.snoozeReporter="snooze_reporter",e.unsnoozeReporter="unsnooze_reporter"}(i||(i={}));const o={[e.M.Distinguish]:i.distinguishAsMod,[e.M.Undistinguish]:i.distinguishAsMod,[e.M.Lock]:i.lock,[e.M.Unlock]:i.lock,[e.M.Sticky]:i.sticky,[e.M.Unsticky]:i.sticky,[e.M.AddRemovalReason]:i.addRemovalReason,[e.M.ApproveContent]:i.approve,[e.M.RemoveContent]:i.remove,[e.M.RemoveContentAsSpam]:i.removeAsSpam,[e.M.ConfirmRemoval]:i.confirmRemoval,[e.M.IgnoreReports]:i.ignoreReports,[e.M.UnignoreReports]:i.ignoreReports,[e.M.SnoozeReporter]:i.snoozeReporter,[e.M.UnsnoozeReporter]:i.unsnoozeReporter,[e.A.Distinguish]:i.distinguishAsAdmin,[e.A.Undistinguish]:i.distinguishAsAdmin,[e.M.ApproveContentOptimistic]:i.approveOptimistic,[e.M.RemoveContentOptimistic]:i.removeOptimistic,[e.M.RemoveContentAsSpamOptimistic]:i.removeAsSpamOptimistic,[e.M.ConfirmRemovalOptimistic]:i.confirmRemovalOptimistic};var t,s;return function(e){e.Preview="preview",e.Pdp="pdp"}(t||(t={})),function(e){e.CommentPreviewUnit="CommentPreviewUnit",e.CommentTree="CommentTree"}(s||(s={})),{get C(){return i},S:o}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("BPE-aUEF5w",["Dw4vb8Yfbm"],(async c=>{const{svg:m}=c.a();return{b:c.m(m`<path d="M10 1c-4.96 0-9 4.04-9 9s4.04 9 9 9 9-4.04 9-9-4.04-9-9-9zm7.15 8.2h-3.17c-.1-2.37-.62-4.46-1.4-5.91 2.46.95 4.27 3.2 4.57 5.91zm-7.15 8c-.66 0-2.2-2.24-2.38-6.4h4.76c-.18 4.16-1.73 6.4-2.38 6.4zm-2.38-8C7.8 5.04 9.35 2.8 10 2.8c.65 0 2.2 2.24 2.38 6.4H7.62zm-.2-5.91c-.78 1.45-1.3 3.55-1.4 5.91H2.85c.3-2.71 2.11-4.97 4.57-5.91zM2.85 10.8h3.17c.1 2.37.62 4.46 1.4 5.91-2.46-.95-4.27-3.2-4.57-5.91zm9.73 5.91c.78-1.45 1.3-3.55 1.4-5.91h3.17a7.188 7.188 0 01-4.57 5.91z"></path>`,"0 0 20 20","browser")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("BQbrDNllG4",["Dw4vb8Yfbm"],(async t=>{const{svg:a}=t.a(),M=t.m(a`<path d="M10 2.8c3.97 0 7.2 3.23 7.2 7.2s-3.23 7.2-7.2 7.2-7.2-3.23-7.2-7.2S6.03 2.8 10 2.8zM10 1a9 9 0 10.001 18.001A9 9 0 0010 1z"></path>`,"0 0 20 20","radio-button"),{svg:s}=t.a(),E=t.m(s`<path d="M10 2.8c3.97 0 7.2 3.23 7.2 7.2s-3.23 7.2-7.2 7.2-7.2-3.23-7.2-7.2S6.03 2.8 10 2.8zM10 1a9 9 0 10.001 18.001A9 9 0 0010 1z"></path><path d="M10 14a4 4 0 100-8 4 4 0 000 8z"></path>`,"0 0 20 20","radio-button-fill"),e={NAME:"Name",ACTIVITY:"Activity",MEMBER_COUNT:"Members"};return{C:e.NAME,S:"selectedCommunities",W:1200,a:M,b:e,r:E}}));
SML.di("./DfOK659qrU.js",import.meta.url,"DfOK659qrU");SML.di("./BLo4HzLOT6.js",import.meta.url,"BLo4HzLOT6");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./E3QE3c4_Ye.js",import.meta.url,"E3QE3c4_Ye");SML.di("./DOqOHj9jA9.js",import.meta.url,"DOqOHj9jA9");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./BRjrtOukap.js",import.meta.url,"BRjrtOukap");SML.di("./Yp_OV6CjXa.js",import.meta.url,"Yp_OV6CjXa");SML.di("./Dd6H0lWggE.js",import.meta.url,"Dd6H0lWggE");
SML.dm("BR9XuBRwIS",["BLo4HzLOT6","Dw4vb8Yfbm","5r73EsgItq","E3QE3c4_Ye","DfOK659qrU","DOqOHj9jA9","jWC3N3n7Al","FQGvCwaizg","BRjrtOukap","Yp_OV6CjXa","Dd6H0lWggE"],(async(e,a,n,t)=>{let i=class extends n.s{constructor(){super(...arguments),this.blurredContainer=null,this.handleSlotchange=a=>{if(!(a.target instanceof HTMLSlotElement))return;const n=a.target.assignedNodes({flatten:!0});for(const a of n)if(a instanceof e.S){this.blurredContainer=a,this.blurredContainer.setAttribute("blurred","");break}}}static get styles(){return[a.t,a.a0(":host {\n  display: block;\n  position: relative;\n  height: 100%;\n}\n.prompt.hidden {\n  display: none;\n}\n.prompt {\n  align-items: center;\n  background-color: rgba(0, 0, 0, 0.45);\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  left: 0;\n  justify-content: center;\n  position: absolute;\n  top: 0;\n  width: 100%;\n}\n.icon {\n  color: hsla(0, 0%, 100%, 0.6);\n  font-size: 36px;\n  text-align: center;\n}\n.title,\n.text {\n  color: hsla(0, 0%, 100%, 0.8);\n  max-width: 300px;\n  text-align: center;\n}\n.title {\n  font: var(--font-title-h3);\n  margin: 18px 0 0;\n}\n.text {\n  font: var(--font-title-h4);\n  font-weight: normal;\n  margin: 10px 0 24px;\n}\n@media (max-width: 320px) {\n  .text {\n    margin: 12px 0 20px;\n  }\n}\n")]}render(){return n.x` <slot @slotchange="${this.handleSlotchange}"></slot> <div class="prompt"> <div class="icon">${t.n({size:n.I.ExtraLarge})}</div> <h3 class="title"> ${"Mature Content"} </h3> <p class="text"> ${"This is mature content and may not be appropriate for certain viewers. To continue, use the app to verify you're over 18 and browse anonymously."} </p> <slot name="view-in-app-button"></slot> </div> `;}};i=a._([a.e("xpromo-nsfw-blocking-container")],i)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("BRjrtOukap",["Dw4vb8Yfbm"],(async s=>{const{svg:e}=s.a();return{c:s.m(e`<path d="M4.21 9.95c-.31 0-.61-.12-.85-.35L.58 6.82a.706.706 0 010-.99c.27-.27.72-.27.99 0l2.64 2.64 6.22-6.22c.27-.27.72-.27.99 0s.27.72 0 .99L5.06 9.6c-.23.23-.54.35-.85.35z"></path>`,"0 0 12 12","checkmark-12"),i:function(s,e,{className:n,size:a="small",label:t,description:i,leadingContent:l,trailingContent:r,truncateTrailingContent:c,disabled:p=!1,id:m,testId:o}){return s`<div class="flex justify-between gap-[0.5rem] text-secondary py-xs ${p?"opacity-60 pointer-events-none":""} ${n??""}" id="${e(m)}" data-testid="${e(o)}"> <span class="flex items-center gap-xs min-w-0 ${c?"shrink-0 grow":"shrink"}"> ${l?s`<span class="flex shrink-0 items-center justify-center h-xl w-xl"> <span class="text-20 leading-4">${l}</span> </span>`:void 0} <span class="flex flex-col justify-center min-w-0 shrink py-[var(--rem6)]"> <span class="${"small"===a?"text-body-2":"text-body-1"} break-normal">${t}</span> <span class="text-caption-1 text-secondary-weak break-normal">${i}</span> </span> </span> <span class="flex items-center ${c?"shrink pl-[8px] min-w-0":"shrink-0"}"> <span class="flex items-center justify-center h-lg ${c?"min-w-0":""}">${r}</span> </span> </div>`}}}));
SML.di("./Cg9a-Ks_jU.js",import.meta.url,"Cg9a-Ks_jU");SML.di("./B2YOiYwFck.js",import.meta.url,"B2YOiYwFck");SML.di("./h4WFGocyAS.js",import.meta.url,"h4WFGocyAS");SML.di("./2Aiv5oCm8E.js",import.meta.url,"2Aiv5oCm8E");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./DY8-AkxZ56.js",import.meta.url,"DY8-AkxZ56");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./CnDGunUlBx.js",import.meta.url,"CnDGunUlBx");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./g8Ezfsb_Vs.js",import.meta.url,"g8Ezfsb_Vs");SML.di("./DfmRUMqhhU.js",import.meta.url,"DfmRUMqhhU");SML.di("./BgnwQeogVz.js",import.meta.url,"BgnwQeogVz");SML.di("./BLIiwX-G4B.js",import.meta.url,"BLIiwX-G4B");SML.di("./BPE-aUEF5w.js",import.meta.url,"BPE-aUEF5w");SML.di("./iewwAXEto0.js",import.meta.url,"iewwAXEto0");SML.di("./BM4eKBOTt3.js",import.meta.url,"BM4eKBOTt3");SML.di("./DI4O_MlG8-.js",import.meta.url,"DI4O_MlG8-");SML.di("./CNVxoLjPZD.js",import.meta.url,"CNVxoLjPZD");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");SML.di("./ankOzFFj6Q.js",import.meta.url,"ankOzFFj6Q");
SML.dm("BSOwLEDVru",["Cg9a-Ks_jU","B2YOiYwFck","h4WFGocyAS","2Aiv5oCm8E","tO6bKRQro7","DY8-AkxZ56","Dw4vb8Yfbm","5r73EsgItq","CnDGunUlBx","B-zFJtiar6","g8Ezfsb_Vs","DfmRUMqhhU","BgnwQeogVz","BLIiwX-G4B","BPE-aUEF5w","iewwAXEto0","BM4eKBOTt3","DI4O_MlG8-","CNVxoLjPZD","Bu440t6XLo","BeFppRYbzE","ankOzFFj6Q"],(async()=>{SML.di("./_C4HT6j0ig.js",import.meta.url,"_C4HT6j0ig").then((function(E){return E.r}))}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("BSYfFtBeKH",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6"],(async(t,e,o)=>{const a="title-icon",l="close-button",n="primary-button",s="secondary-button",r="tertiary-button";class i extends t.R{constructor(){super(...arguments),this.appearance="neutral",this.autoClose=!1,this.emitCloseButtonClickEvent=()=>{this.emitter.dispatch("close-button-clicked",{bubbles:!0,composed:!0})},this.handleCloseButtonClick=t=>{t.stopPropagation(),this.autoClose&&this.emitCloseButtonClickEvent()},this.handleCloseButtonKeydown=t=>{this.autoClose&&"Enter"===t.key&&this.emitCloseButtonClickEvent()}}render(){const t=o.o(this,a),i=o.o(this,l),d=o.o(this,n),c=o.o(this,s),p=o.o(this,r),h=d||c||p;return e.x`<div> <slot name="${"title-graphic"}"></slot> <div class="main"> <div class="content"> <div class="title-row"> <slot name="${a}" class="${t?"has-slotted":""}"></slot> <slot name="${"title"}"></slot> <slot name="${l}" part="close-button" class="${i?"has-slotted":""}" @click="${this.handleCloseButtonClick}" @keydown="${this.handleCloseButtonKeydown}"></slot> </div> <div class="body"><slot></slot></div> </div> <div class="footer ${h?"has-slotted":""}"> <slot name="${r}" class="${p?"has-slotted":""}"></slot> <div class="footer-right"> <slot name="${s}"></slot> <slot name="${n}"></slot> </div> </div> </div> </div>`}}t._([t.n({type:String,reflect:!0})],i.prototype,"appearance",void 0),t._([t.n({type:Boolean,reflect:!0,attribute:"auto-close"})],i.prototype,"autoClose",void 0);var d=e.a`${t.a7}:host{display:flex;flex-direction:column;border-radius:var(--rem16);overflow:hidden;box-shadow:var(--boxshadow-modal);gap:var(--rem8);background-color:var(--color-neutral-background);color:var(--color-neutral-content-strong)}:host([appearance=inverted]){background-color:var(--color-inverted-neutral-background);color:var(--color-inverted-neutral-content-strong)}.main{display:flex;flex-direction:column;padding:var(--rem8) var(--rem8) var(--rem8) var(--rem16)}slot[name=title-graphic]{display:flex}.title-row{display:flex}.body{padding-inline-end:var(--rem8)}slot[name=title-icon].has-slotted{display:flex;padding-top:var(--rem8);padding-inline-end:var(--rem12)}slot[name=title]{display:flex;align-items:center;flex-grow:1;flex-shrink:1;min-width:0;overflow:hidden;font:var(--font-label-1);letter-spacing:var(--font-label-1-kerning);font-weight:700}slot:not([name]){white-space:wrap}slot[name=close-button].has-slotted{display:flex;padding-inline-start:var(--rem4)}slot[name=primary-button]{display:flex;padding-inline-end:var(--rem8)}slot[name=tertiary-button].has-slotted{font:var(--font-caption-1);letter-spacing:var(--font-caption-1-kerning);flex-shrink:1;min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding-inline-end:var(--rem8)}.footer{display:flex;align-items:center;justify-content:end;padding-inline-end:var(--rem8)}.footer.has-slotted{padding-top:var(--rem8)}.footer:has(slot[name=tertiary-button].has-slotted){justify-content:space-between}.footer-right{display:flex}`;let c=class extends i{};return c.styles=d,c=t._([t.e("rpl-coachmark-card")],c),{get RPLCoachmarkCard(){return c}}}));
SML.di("./aPtImf01vE.js",import.meta.url,"aPtImf01vE");SML.di("./7e6Mie450p.js",import.meta.url,"7e6Mie450p");SML.di("./D65LRUFG0U.js",import.meta.url,"D65LRUFG0U");SML.di("./07V_X64YGf.js",import.meta.url,"07V_X64YGf");SML.di("./Bypt3-pSP2.js",import.meta.url,"Bypt3-pSP2");SML.di("./DgW4ULLwQ1.js",import.meta.url,"DgW4ULLwQ1");SML.di("./CBbxnHsw2W.js",import.meta.url,"CBbxnHsw2W");SML.di("./BIvvQbZj9p.js",import.meta.url,"BIvvQbZj9p");SML.di("./B6sa1lzoK7.js",import.meta.url,"B6sa1lzoK7");SML.di("./Cq_XTZLzWW.js",import.meta.url,"Cq_XTZLzWW");SML.di("./D--e2jiRnn.js",import.meta.url,"D--e2jiRnn");SML.di("./Cquj4gqZDa.js",import.meta.url,"Cquj4gqZDa");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./CInntUEpAD.js",import.meta.url,"CInntUEpAD");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./DHw9yEcfFd.js",import.meta.url,"DHw9yEcfFd");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");SML.di("./BlPAB0-vrn.js",import.meta.url,"BlPAB0-vrn");SML.di("./Ctcf-FPPNG.js",import.meta.url,"Ctcf-FPPNG");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");SML.di("./BLrhRle6xP.js",import.meta.url,"BLrhRle6xP");SML.di("./CPSOeCrm6v.js",import.meta.url,"CPSOeCrm6v");SML.di("./C3-eAP6Oln.js",import.meta.url,"C3-eAP6Oln");SML.di("./DMGDObG7XA.js",import.meta.url,"DMGDObG7XA");SML.di("./Z0tk4vmzIQ.js",import.meta.url,"Z0tk4vmzIQ");SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");SML.di("./CDbzh0L9oi.js",import.meta.url,"CDbzh0L9oi");
SML.di("./JaGlTj3I-9.js",import.meta.url,"JaGlTj3I-9");SML.di("./DCbB57ubLb.js",import.meta.url,"DCbB57ubLb");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./lEw4CeTWZd.js",import.meta.url,"lEw4CeTWZd");SML.di("./CqGTWb5M_i.js",import.meta.url,"CqGTWb5M_i");SML.di("./Dw4K28bgT7.js",import.meta.url,"Dw4K28bgT7");SML.di("./CQMf561ZyA.js",import.meta.url,"CQMf561ZyA");SML.di("./CBbxnHsw2W.js",import.meta.url,"CBbxnHsw2W");SML.di("./CEs3hLX56z.js",import.meta.url,"CEs3hLX56z");SML.di("./Cl1pMDH2OX.js",import.meta.url,"Cl1pMDH2OX");SML.di("./DS9WepT8W8.js",import.meta.url,"DS9WepT8W8");SML.di("./DZO4dWmzHb.js",import.meta.url,"DZO4dWmzHb");SML.di("./CE5TLxi7Z3.js",import.meta.url,"CE5TLxi7Z3");SML.di("./DnNITwgp90.js",import.meta.url,"DnNITwgp90");SML.di("./CUIVPWsUpf.js",import.meta.url,"CUIVPWsUpf");SML.di("./DgW4ULLwQ1.js",import.meta.url,"DgW4ULLwQ1");SML.di("./BWv2j8jrjX.js",import.meta.url,"BWv2j8jrjX");
SML.dm("BTnwE85rpZ",["JaGlTj3I-9","DCbB57ubLb","B-zFJtiar6","Dw4vb8Yfbm","5r73EsgItq","lEw4CeTWZd","CqGTWb5M_i","Dw4K28bgT7","CEs3hLX56z","DZO4dWmzHb","CE5TLxi7Z3","DnNITwgp90","CUIVPWsUpf","CQMf561ZyA","CBbxnHsw2W","Cl1pMDH2OX","DS9WepT8W8","DgW4ULLwQ1","BWv2j8jrjX"],(async(e,t,i,a,n,r,o,s,l,d,u,c,p)=>{const m="history-merge";var h;function g(e){if(e instanceof HTMLImageElement){return{node:N({src:e.getAttribute("src")??"",mediaId:e.dataset.mediaId??"",mimetype:e.dataset.mimetype??""})}}return null}!function(e){e.Small="small",e.Large="large"}(h||(h={}));class k extends t.j{static getType(){return"emote"}static getTheme(e=!1){return ["emote","align-text-bottom","[font-size:var(--emote-size)]","[color:transparent]","[caret-color:var(--color-tone-1)]","leading-[--emote-line-height]","before:absolute",...(e ? ["before:bg-[size:--emote-size]","before:w-[--emote-size]","before:h-[--emote-size]"] : ["before:origin-top-left","before:scale-[--emote-scale]"]),"selection:text-transparent"].join(" ");}static mediaIdToCssClass(e){return`rte-${e.replace(k.mediaIdReplaceRE,"-")}`}static isEmoji(e){return!!e.match(k.emojiMediaIdRE)}static addEmoteUrl(e,t){this._styles||(this._styles=new CSSStyleSheet),this._emoteUrls.set(e,t);const i=k.isEmoji(e),a=Array.from(this._emoteUrls.entries()).map((([e,t])=>i?`.${this.mediaIdToCssClass(e)}::before { background-image: url(${t}); content: ""; }`:`.${this.mediaIdToCssClass(e)}::before { content: url(${t}); }`)).join("\n");this._styles.replaceSync(a),document.adoptedStyleSheets=[...document.adoptedStyleSheets,this._styles]}constructor({src:e,mediaId:t,mimetype:i},a){super("",a),this.__src=e,this.__mediaId=t,this.__mimetype=i}get src(){return this.__src}get mediaId(){return this.__mediaId}get mimetype(){return this.__mimetype}createDOM(){const e=super.createDOM({theme:{}});return e.classList.add(...k.getTheme(k.isEmoji(this.mediaId)).split(" ")),e.classList.add(k.mediaIdToCssClass(this.__mediaId)),k.addEmoteUrl(this.__mediaId,this.__src),e}updateDOM(){return!1}static importDOM(){return{img:e=>e instanceof HTMLImageElement&&e.dataset.mediaId?.startsWith(i.d3)?{conversion:g,priority:1}:null}}static importJSON(e){return N({src:e.src,mediaId:e.mediaId,mimetype:e.mimetype})}exportDOM(){const e=document.createElement("img");return e.setAttribute("src",this.__src),e.setAttribute("data-media-id",this.__mediaId),e.setAttribute("data-mimetype",this.__mimetype),{element:e}}exportJSON(){return{...super.exportJSON(),type:"emote",src:this.__src,mediaId:this.__mediaId,mimetype:this.__mimetype,version:1}}static clone(e){const{__src:t,__mediaId:i,__mimetype:a,__key:n}=e;return new k({src:t,mediaId:i,mimetype:a},n)}}function N({src:e,mediaId:i,mimetype:a}){const n=new k({src:e,mediaId:i,mimetype:a}).setMode("token").toggleUnmergeable();return t.aQ(n)}k._emoteUrls=new Map,k.mediaIdReplaceRE=/[|:]/g,k.emojiMediaIdRE=/^:[\w-]+:$/;const I={},f={},v={},b=new WeakMap;function R(e,t){const i=t.split(".");let a=function(e){return b.get(e)}(e);if(!a)throw new Error("No config found for the given Editor instance.");for(const e of i){if(!a||!(e in a))return;a=a[e]}return a}var T="top",E="bottom",L="right",S="left",y="auto",O=[T,E,L,S],P="start",_="end",z="viewport",H="popper",D=O.reduce((function(e,t){return e.concat([t+"-"+P,t+"-"+_])}),[]),x=[].concat(O,[y]).reduce((function(e,t){return e.concat([t,t+"-"+P,t+"-"+_])}),[]),U=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function A(e){return e?(e.nodeName||"").toLowerCase():null}function C(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function j(e){return e instanceof C(e).Element||e instanceof Element}function $(e){return e instanceof C(e).HTMLElement||e instanceof HTMLElement}function w(e){return"undefined"!=typeof ShadowRoot&&(e instanceof C(e).ShadowRoot||e instanceof ShadowRoot)}var M={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var i=t.styles[e]||{},a=t.attributes[e]||{},n=t.elements[e];$(n)&&A(n)&&(Object.assign(n.style,i),Object.keys(a).forEach((function(e){var t=a[e];!1===t?n.removeAttribute(e):n.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach((function(e){var a=t.elements[e],n=t.attributes[e]||{},r=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:i[e]).reduce((function(e,t){return e[t]="",e}),{});$(a)&&A(a)&&(Object.assign(a.style,r),Object.keys(n).forEach((function(e){a.removeAttribute(e)})))}))}},requires:["computeStyles"]};function G(e){return e.split("-")[0]}var B=Math.max,K=Math.min,F=Math.round;function V(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function Y(){return !/^((?!chrome|android).)*safari/i.test(V());}function W(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);var a=e.getBoundingClientRect(),n=1,r=1;t&&$(e)&&(n=e.offsetWidth>0&&F(a.width)/e.offsetWidth||1,r=e.offsetHeight>0&&F(a.height)/e.offsetHeight||1);var o=(j(e)?C(e):window).visualViewport,s=!Y()&&i,l=(a.left+(s&&o?o.offsetLeft:0))/n,d=(a.top+(s&&o?o.offsetTop:0))/r,u=a.width/n,c=a.height/r;return{width:u,height:c,top:d,right:l+u,bottom:d+c,left:l,x:l,y:d}}function Z(e){var t=W(e),i=e.offsetWidth,a=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-a)<=1&&(a=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:a}}function J(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&w(i)){var a=t;do{if(a&&e.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function X(e){return C(e).getComputedStyle(e)}function q(e){return["table","td","th"].indexOf(A(e))>=0}function Q(e){return((j(e)?e.ownerDocument:e.document)||window.document).documentElement}function ee(e){return"html"===A(e)?e:e.assignedSlot||e.parentNode||(w(e)?e.host:null)||Q(e)}function te(e){return $(e)&&"fixed"!==X(e).position?e.offsetParent:null}function ie(e){for(var t=C(e),i=te(e);i&&q(i)&&"static"===X(i).position;)i=te(i);return i&&("html"===A(i)||"body"===A(i)&&"static"===X(i).position)?t:i||function(e){var t=/firefox/i.test(V());if(/Trident/i.test(V())&&$(e)&&"fixed"===X(e).position)return null;var i=ee(e);for(w(i)&&(i=i.host);$(i)&&["html","body"].indexOf(A(i))<0;){var a=X(i);if("none"!==a.transform||"none"!==a.perspective||"paint"===a.contain||-1!==["transform","perspective"].indexOf(a.willChange)||t&&"filter"===a.willChange||t&&a.filter&&"none"!==a.filter)return i;i=i.parentNode}return null}(e)||t;}function ae(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function ne(e,t,i){return B(e,K(t,i))}function re(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function oe(e,t){return t.reduce((function(t,i){return t[i]=e,t}),{})}var se={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,i=e.state,a=e.name,n=e.options,r=i.elements.arrow,o=i.modifiersData.popperOffsets,s=G(i.placement),l=ae(s),d=[S,L].indexOf(s)>=0?"height":"width";if(r&&o){var u=function(e,t){return re("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:oe(e,O))}(n.padding,i),c=Z(r),p="y"===l?T:S,m="y"===l?E:L,h=i.rects.reference[d]+i.rects.reference[l]-o[l]-i.rects.popper[d],g=o[l]-i.rects.reference[l],k=ie(r),N=k?"y"===l?k.clientHeight||0:k.clientWidth||0:0,I=h/2-g/2,f=u[p],v=N-c[d]-u[m],b=N/2-c[d]/2+I,R=ne(f,b,v),y=l;i.modifiersData[a]=((t={})[y]=R,t.centerOffset=R-b,t)}},effect:function(e){var t=e.state,i=e.options.element,a=void 0===i?"[data-popper-arrow]":i;null!=a&&("string"!=typeof a||(a=t.elements.popper.querySelector(a)))&&J(t.elements.popper,a)&&(t.elements.arrow=a)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function le(e){return e.split("-")[1]}var de={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ue(e){var t,i=e.popper,a=e.popperRect,n=e.placement,r=e.variation,o=e.offsets,s=e.position,l=e.gpuAcceleration,d=e.adaptive,u=e.roundOffsets,c=e.isFixed,p=o.x,m=void 0===p?0:p,h=o.y,g=void 0===h?0:h,k="function"==typeof u?u({x:m,y:g}):{x:m,y:g};m=k.x,g=k.y;var N=o.hasOwnProperty("x"),I=o.hasOwnProperty("y"),f=S,v=T,b=window;if(d){var R=ie(i),y="clientHeight",O="clientWidth";if(R===C(i)&&"static"!==X(R=Q(i)).position&&"absolute"===s&&(y="scrollHeight",O="scrollWidth"),n===T||(n===S||n===L)&&r===_)v=E,g-=(c&&R===b&&b.visualViewport?b.visualViewport.height:R[y])-a.height,g*=l?1:-1;if(n===S||(n===T||n===E)&&r===_)f=L,m-=(c&&R===b&&b.visualViewport?b.visualViewport.width:R[O])-a.width,m*=l?1:-1}var P,z=Object.assign({position:s},d&&de),H=!0===u?function(e,t){var i=e.x,a=e.y,n=t.devicePixelRatio||1;return{x:F(i*n)/n||0,y:F(a*n)/n||0}}({x:m,y:g},C(i)):{x:m,y:g};return m=H.x,g=H.y,l?Object.assign({},z,((P={})[v]=I?"0":"",P[f]=N?"0":"",P.transform=(b.devicePixelRatio||1)<=1?"translate("+m+"px, "+g+"px)":"translate3d("+m+"px, "+g+"px, 0)",P)):Object.assign({},z,((t={})[v]=I?g+"px":"",t[f]=N?m+"px":"",t.transform="",t))}var ce={passive:!0};var pe={left:"right",right:"left",bottom:"top",top:"bottom"};function me(e){return e.replace(/left|right|bottom|top/g,(function(e){return pe[e]}));}var he={start:"end",end:"start"};function ge(e){return e.replace(/start|end/g,(function(e){return he[e]}));}function ke(e){var t=C(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Ne(e){return W(Q(e)).left+ke(e).scrollLeft}function Ie(e){var t=X(e),i=t.overflow,a=t.overflowX,n=t.overflowY;return /auto|scroll|overlay|hidden/.test(i+n+a);}function fe(e){return["html","body","#document"].indexOf(A(e))>=0?e.ownerDocument.body:$(e)&&Ie(e)?e:fe(ee(e))}function ve(e,t){var i;void 0===t&&(t=[]);var a=fe(e),n=a===(null==(i=e.ownerDocument)?void 0:i.body),r=C(a),o=n?[r].concat(r.visualViewport||[],Ie(a)?a:[]):a,s=t.concat(o);return n?s:s.concat(ve(ee(o)))}function be(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Re(e,t,i){return t===z?be(function(e,t){var i=C(e),a=Q(e),n=i.visualViewport,r=a.clientWidth,o=a.clientHeight,s=0,l=0;if(n){r=n.width,o=n.height;var d=Y();(d||!d&&"fixed"===t)&&(s=n.offsetLeft,l=n.offsetTop)}return{width:r,height:o,x:s+Ne(e),y:l}}(e,i)):j(t)?function(e,t){var i=W(e,!1,"fixed"===t);return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}(t,i):be(function(e){var t,i=Q(e),a=ke(e),n=null==(t=e.ownerDocument)?void 0:t.body,r=B(i.scrollWidth,i.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),o=B(i.scrollHeight,i.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),s=-a.scrollLeft+Ne(e),l=-a.scrollTop;return"rtl"===X(n||i).direction&&(s+=B(i.clientWidth,n?n.clientWidth:0)-r),{width:r,height:o,x:s,y:l}}(Q(e)))}function Te(e,t,i,a){var n="clippingParents"===t?function(e){var t=ve(ee(e)),i=["absolute","fixed"].indexOf(X(e).position)>=0&&$(e)?ie(e):e;return j(i)?t.filter((function(e){return j(e)&&J(e,i)&&"body"!==A(e)})):[]}(e):[].concat(t),r=[].concat(n,[i]),o=r[0],s=r.reduce((function(t,i){var n=Re(e,i,a);return t.top=B(n.top,t.top),t.right=K(n.right,t.right),t.bottom=K(n.bottom,t.bottom),t.left=B(n.left,t.left),t}),Re(e,o,a));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function Ee(e){var t,i=e.reference,a=e.element,n=e.placement,r=n?G(n):null,o=n?le(n):null,s=i.x+i.width/2-a.width/2,l=i.y+i.height/2-a.height/2;switch(r){case T:t={x:s,y:i.y-a.height};break;case E:t={x:s,y:i.y+i.height};break;case L:t={x:i.x+i.width,y:l};break;case S:t={x:i.x-a.width,y:l};break;default:t={x:i.x,y:i.y}}var d=r?ae(r):null;if(null!=d){var u="y"===d?"height":"width";switch(o){case P:t[d]=t[d]-(i[u]/2-a[u]/2);break;case _:t[d]=t[d]+(i[u]/2-a[u]/2)}}return t}function Le(e,t){void 0===t&&(t={});var i=t,a=i.placement,n=void 0===a?e.placement:a,r=i.strategy,o=void 0===r?e.strategy:r,s=i.boundary,l=void 0===s?"clippingParents":s,d=i.rootBoundary,u=void 0===d?z:d,c=i.elementContext,p=void 0===c?H:c,m=i.altBoundary,h=void 0!==m&&m,g=i.padding,k=void 0===g?0:g,N=re("number"!=typeof k?k:oe(k,O)),I=p===H?"reference":H,f=e.rects.popper,v=e.elements[h?I:p],b=Te(j(v)?v:v.contextElement||Q(e.elements.popper),l,u,o),R=W(e.elements.reference),S=Ee({reference:R,element:f,strategy:"absolute",placement:n}),y=be(Object.assign({},f,S)),P=p===H?y:R,_={top:b.top-P.top+N.top,bottom:P.bottom-b.bottom+N.bottom,left:b.left-P.left+N.left,right:P.right-b.right+N.right},D=e.modifiersData.offset;if(p===H&&D){var x=D[n];Object.keys(_).forEach((function(e){var t=[L,E].indexOf(e)>=0?1:-1,i=[T,E].indexOf(e)>=0?"y":"x";_[e]+=x[i]*t}))}return _}function Se(e,t){void 0===t&&(t={});var i=t,a=i.placement,n=i.boundary,r=i.rootBoundary,o=i.padding,s=i.flipVariations,l=i.allowedAutoPlacements,d=void 0===l?x:l,u=le(a),c=u?s?D:D.filter((function(e){return le(e)===u})):O,p=c.filter((function(e){return d.indexOf(e)>=0}));0===p.length&&(p=c);var m=p.reduce((function(t,i){return t[i]=Le(e,{placement:i,boundary:n,rootBoundary:r,padding:o})[G(i)],t}),{});return Object.keys(m).sort((function(e,t){return m[e]-m[t]}))}var ye={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,a=e.name;if(!t.modifiersData[a]._skip){for(var n=i.mainAxis,r=void 0===n||n,o=i.altAxis,s=void 0===o||o,l=i.fallbackPlacements,d=i.padding,u=i.boundary,c=i.rootBoundary,p=i.altBoundary,m=i.flipVariations,h=void 0===m||m,g=i.allowedAutoPlacements,k=t.options.placement,N=G(k),I=l||(N===k||!h?[me(k)]:function(e){if(G(e)===y)return[];var t=me(e);return[ge(e),t,ge(t)]}(k)),f=[k].concat(I).reduce((function(e,i){return e.concat(G(i)===y?Se(t,{placement:i,boundary:u,rootBoundary:c,padding:d,flipVariations:h,allowedAutoPlacements:g}):i)}),[]),v=t.rects.reference,b=t.rects.popper,R=new Map,O=!0,_=f[0],z=0;z<f.length;z++){var H=f[z],D=G(H),x=le(H)===P,U=[T,E].indexOf(D)>=0,A=U?"width":"height",C=Le(t,{placement:H,boundary:u,rootBoundary:c,altBoundary:p,padding:d}),j=U?x?L:S:x?E:T;v[A]>b[A]&&(j=me(j));var $=me(j),w=[];if(r&&w.push(C[D]<=0),s&&w.push(C[j]<=0,C[$]<=0),w.every((function(e){return e}))){_=H,O=!1;break}R.set(H,w)}if(O)for(var M=function(e){var t=f.find((function(t){var i=R.get(t);if(i)return i.slice(0,e).every((function(e){return e}))}));if(t)return _=t,"break"},B=h?3:1;B>0;B--){if("break"===M(B))break}t.placement!==_&&(t.modifiersData[a]._skip=!0,t.placement=_,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Oe(e,t,i){return void 0===i&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function Pe(e){return[T,L,E,S].some((function(t){return e[t]>=0}))}var _e={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,i=e.options,a=e.name,n=i.offset,r=void 0===n?[0,0]:n,o=x.reduce((function(e,i){return e[i]=function(e,t,i){var a=G(e),n=[S,T].indexOf(a)>=0?-1:1,r="function"==typeof i?i(Object.assign({},t,{placement:e})):i,o=r[0],s=r[1];return o=o||0,s=(s||0)*n,[S,L].indexOf(a)>=0?{x:s,y:o}:{x:o,y:s}}(i,t.rects,r),e}),{}),s=o[t.placement],l=s.x,d=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=d),t.modifiersData[a]=o}};var ze={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,a=e.name,n=i.mainAxis,r=void 0===n||n,o=i.altAxis,s=void 0!==o&&o,l=i.boundary,d=i.rootBoundary,u=i.altBoundary,c=i.padding,p=i.tether,m=void 0===p||p,h=i.tetherOffset,g=void 0===h?0:h,k=Le(t,{boundary:l,rootBoundary:d,padding:c,altBoundary:u}),N=G(t.placement),I=le(t.placement),f=!I,v=ae(N),b="x"===v?"y":"x",R=t.modifiersData.popperOffsets,y=t.rects.reference,O=t.rects.popper,_="function"==typeof g?g(Object.assign({},t.rects,{placement:t.placement})):g,z="number"==typeof _?{mainAxis:_,altAxis:_}:Object.assign({mainAxis:0,altAxis:0},_),H=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,D={x:0,y:0};if(R){if(r){var x,U="y"===v?T:S,A="y"===v?E:L,C="y"===v?"height":"width",j=R[v],$=j+k[U],w=j-k[A],M=m?-O[C]/2:0,F=I===P?y[C]:O[C],V=I===P?-O[C]:-y[C],Y=t.elements.arrow,W=m&&Y?Z(Y):{width:0,height:0},J=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},X=J[U],q=J[A],Q=ne(0,y[C],W[C]),ee=f?y[C]/2-M-Q-X-z.mainAxis:F-Q-X-z.mainAxis,te=f?-y[C]/2+M+Q+q+z.mainAxis:V+Q+q+z.mainAxis,re=t.elements.arrow&&ie(t.elements.arrow),oe=re?"y"===v?re.clientTop||0:re.clientLeft||0:0,se=null!=(x=null==H?void 0:H[v])?x:0,de=j+te-se,ue=ne(m?K($,j+ee-se-oe):$,j,m?B(w,de):w);R[v]=ue,D[v]=ue-j}if(s){var ce,pe="x"===v?T:S,me="x"===v?E:L,he=R[b],ge="y"===b?"height":"width",ke=he+k[pe],Ne=he-k[me],Ie=-1!==[T,S].indexOf(N),fe=null!=(ce=null==H?void 0:H[b])?ce:0,ve=Ie?ke:he-y[ge]-O[ge]-fe+z.altAxis,be=Ie?he+y[ge]+O[ge]-fe-z.altAxis:Ne,Re=m&&Ie?function(e,t,i){var a=ne(e,t,i);return a>i?i:a}(ve,he,be):ne(m?ve:ke,he,m?be:Ne);R[b]=Re,D[b]=Re-he}t.modifiersData[a]=D}},requiresIfExists:["offset"]};function He(e,t,i){void 0===i&&(i=!1);var a,n,r=$(t),o=$(t)&&function(e){var t=e.getBoundingClientRect(),i=F(t.width)/e.offsetWidth||1,a=F(t.height)/e.offsetHeight||1;return 1!==i||1!==a}(t),s=Q(t),l=W(e,o,i),d={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(r||!r&&!i)&&(("body"!==A(t)||Ie(s))&&(d=(a=t)!==C(a)&&$(a)?{scrollLeft:(n=a).scrollLeft,scrollTop:n.scrollTop}:ke(a)),$(t)?((u=W(t,!0)).x+=t.clientLeft,u.y+=t.clientTop):s&&(u.x=Ne(s))),{x:l.left+d.scrollLeft-u.x,y:l.top+d.scrollTop-u.y,width:l.width,height:l.height}}function De(e){var t=new Map,i=new Set,a=[];function n(e){i.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!i.has(e)){var a=t.get(e);a&&n(a)}})),a.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){i.has(e.name)||n(e)})),a}var xe={placement:"bottom",modifiers:[],strategy:"absolute"};function Ue(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function Ae(e){void 0===e&&(e={});var t=e,i=t.defaultModifiers,a=void 0===i?[]:i,n=t.defaultOptions,r=void 0===n?xe:n;return function(e,t,i){void 0===i&&(i=r);var n,o,s={placement:"bottom",orderedModifiers:[],options:Object.assign({},xe,r),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},l=[],d=!1,u={state:s,setOptions:function(i){var n="function"==typeof i?i(s.options):i;c(),s.options=Object.assign({},r,s.options,n),s.scrollParents={reference:j(e)?ve(e):e.contextElement?ve(e.contextElement):[],popper:ve(t)};var o,d,p=function(e){var t=De(e);return U.reduce((function(e,i){return e.concat(t.filter((function(e){return e.phase===i})))}),[])}((o=[].concat(a,s.options.modifiers),d=o.reduce((function(e,t){var i=e[t.name];return e[t.name]=i?Object.assign({},i,t,{options:Object.assign({},i.options,t.options),data:Object.assign({},i.data,t.data)}):t,e}),{}),Object.keys(d).map((function(e){return d[e]}))));return s.orderedModifiers=p.filter((function(e){return e.enabled})),s.orderedModifiers.forEach((function(e){var t=e.name,i=e.options,a=void 0===i?{}:i,n=e.effect;if("function"==typeof n){var r=n({state:s,name:t,instance:u,options:a}),o=function(){};l.push(r||o)}})),u.update()},forceUpdate:function(){if(!d){var e=s.elements,t=e.reference,i=e.popper;if(Ue(t,i)){s.rects={reference:He(t,ie(i),"fixed"===s.options.strategy),popper:Z(i)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(e){return s.modifiersData[e.name]=Object.assign({},e.data)}));for(var a=0;a<s.orderedModifiers.length;a++)if(!0!==s.reset){var n=s.orderedModifiers[a],r=n.fn,o=n.options,l=void 0===o?{}:o,c=n.name;"function"==typeof r&&(s=r({state:s,options:l,name:c,instance:u})||s)}else s.reset=!1,a=-1}}},update:(n=function(){return new Promise((function(e){u.forceUpdate(),e(s)}))},function(){return o||(o=new Promise((function(e){Promise.resolve().then((function(){o=void 0,e(n())}))}))),o}),destroy:function(){c(),d=!0}};if(!Ue(e,t))return u;function c(){l.forEach((function(e){return e()})),l=[]}return u.setOptions(i).then((function(e){!d&&i.onFirstUpdate&&i.onFirstUpdate(e)})),u}}var Ce=Ae({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,i=e.instance,a=e.options,n=a.scroll,r=void 0===n||n,o=a.resize,s=void 0===o||o,l=C(t.elements.popper),d=[].concat(t.scrollParents.reference,t.scrollParents.popper);return r&&d.forEach((function(e){e.addEventListener("scroll",i.update,ce)})),s&&l.addEventListener("resize",i.update,ce),function(){r&&d.forEach((function(e){e.removeEventListener("scroll",i.update,ce)})),s&&l.removeEventListener("resize",i.update,ce)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,i=e.name;t.modifiersData[i]=Ee({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,i=e.options,a=i.gpuAcceleration,n=void 0===a||a,r=i.adaptive,o=void 0===r||r,s=i.roundOffsets,l=void 0===s||s,d={placement:G(t.placement),variation:le(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:n,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,ue(Object.assign({},d,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,ue(Object.assign({},d,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},M,_e,ye,ze,se,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,i=e.name,a=t.rects.reference,n=t.rects.popper,r=t.modifiersData.preventOverflow,o=Le(t,{elementContext:"reference"}),s=Le(t,{altBoundary:!0}),l=Oe(o,a),d=Oe(s,n,r),u=Pe(l),c=Pe(d);t.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:d,isReferenceHidden:u,hasPopperEscaped:c},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":c})}}]});function je(e,t){return e.getNodes().some((e=>t(e)||e.getParents().some(t)))}function $e(e,t,i){const a=t.getType?.(),{validChildren:n}=R(e.getEditor(),`nodes.${a}`)??{};return!!n&&(n.includes(i.getType())||n.includes("*"))}function we(e,i){const a=t.E(),n=e[0];let r=n;const o=(e,i)=>{if(t.aX(e)){const t=e.getPreviousSibling();t?t.insertAfter(i):e.getParent()?.insertBefore(i)}else e?.insertBefore(i)};return e.forEach((e=>{if(e.is(n)){if(t.u(a)){const n=a.focus.getNode();if(a.isCollapsed()&&t.K(n)&&t.g(n)&&0===n.getChildrenSize())n.replace(e);else if(t.w(n)){const t=n.getParent();0!==a.focus.offset&&n.getTextContent()?(a.focus.offset===n.getTextContent().length&&t?.getNextSibling()||!$e(i,t,e))&&t?.insertAfter(e):o(t,e)}else if(t.x(n)){const t=n.getFirstChild();o(t,e)}else o(n,e)}e.isAttached()||t.at(e)}else r.insertAfter(e);r=e})),t.g(r)?r.selectEnd():(r.getNextSibling()||r.insertAfter(t.I()),r.selectNext()),r}const Me=e=>{var t;return e.attributes??(e.attributes={}),(t=e.attributes).type??(t.type="button"),a.o(e)};let Ge=i.ca({emoji:()=>"Emoji",emojis:()=>"Emojis",gif:()=>"GIF",reload:()=>"Reload",noResults:()=>"No results",searchGiphy:()=>"Search GIPHY",clearInput:()=>"Clear input",poweredByGiphy:()=>"Powered by GIPHY",missingMediaMessage:()=>"Unable to display image. If this issue persists, try removing and reuploading.",richTextEditorImageAlt:()=>"rich text editor image",addImageButton:()=>"Image",addImage:()=>"Add Image",closeImageModal:()=>"Close image modal",postLink:()=>"Post Link",richTextEditorImageDialog:()=>"Rich Text Editor Insert Image Dialog",invalidPostUrl:()=>"Invalid post URL",unableToFetchImageFromPost:()=>"Unable to fetch image",invalidNodePlacementWithinTableErrorMessageVideo:()=>"Unable to insert video inside a table",invalidNodePlacementGenericErrorMessageVideo:()=>"Unable to insert video here",uploadErrorMessageVideo:()=>"Video failed to upload",mediaNotAllowedErrorMessageVideo:()=>"Videos are not allowed",overMediaLimitErrorMessageVideo:e=>a.cB({one:`Unable to add more than ${e} video`,other:`Unable to add more than ${e} videos`,count:e}),invalidNodePlacementWithinTableErrorMessage:()=>"Unable to insert image inside a table",invalidNodePlacementGenericErrorMessage:()=>"Unable to insert image here",uploadErrorMessage:()=>"Image failed to upload",mediaNotAllowedErrorMessage:()=>"Images are not allowed",overAttachmentLimitErrorMessage:e=>a.cB({one:`Unable to add more than ${e} attachment`,other:`Unable to add more than ${e} attachments`,count:e}),overMediaLimitErrorMessageImage:e=>a.cB({one:`Unable to add more than ${e} image`,other:`Unable to add more than ${e} images`,count:e}),unableToReadImageError:()=>"Unable to read the provided image.",invalidUrl:()=>"Invalid URL",editLink:()=>"Edit Link",addLink:()=>"Add Link",closeLinkModal:()=>"Close link modal",closeTableActionsMenu:()=>"Close table actions menu",text:()=>"Text",link:()=>"Link",cancel:()=>"Cancel",save:()=>"Save",addLinkButton:()=>"Link",linkOptions:()=>"Link Options",removeLink:()=>"Remove Link",editLinkWithUrl:e=>`Edit link: ${e}`,removeLinkWithUrl:e=>`Remove link: ${e}`,bulletList:()=>"Bullet List",numberList:()=>"Number List",captionPlaceholder:()=>"Optional: add a short caption for your image or video",addCaptionPlaceholder:()=>"Add a caption",fileSelectorDragAndDrop:()=>"drag and drop,",fileSelectorAddAnImage:()=>"add an image",fileSelectorOr:()=>", or",fileSelectorAddAVideo:()=>"add a video",unableToUpload:()=>"Unable to upload",remove:()=>"Remove",retry:()=>"Retry",bold:()=>"Bold",italic:()=>"Italic",strikethrough:()=>"Strikethrough",superscript:()=>"Superscript",tableActionsMenu:()=>"Table actions menu",removeHeaderRowStyle:()=>"Remove header row style",makeHeaderRow:()=>"Make header row",insertRowAbove:()=>"Insert row above",insertRowBelow:()=>"Insert row below",deleteRow:()=>"Delete row",insertColumnBefore:()=>"Insert column before",insertColumnAfter:()=>"Insert column after",deleteColumn:()=>"Delete column",alignLeft:()=>"Align left",alignCenter:()=>"Align center",alignRight:()=>"Align right",deleteTable:()=>"Delete table",table:()=>"Table",video:()=>"Video",unableToReadVideoError:()=>"Unable to read the provided video.",unableToDisplayVideoError:()=>"Unable to display video. If this issue persists, try removing and reuploading.",richTextEditorVideoAlt:()=>"rich text editor video",thereAreSomeErrors:()=>"There are some errors",hideFormattingOptions:()=>"Hide formatting options",showFormattingOptions:()=>"Show formatting options",textFormattingToolbar:()=>"text formatting toolbar",richTextEditorLinkActionsDialog:()=>"Rich Text Editor Link Actions Dialog",richTextEditorLinkDialog:()=>"Rich Text Editor Link Add/Edit Dialog",headingLevelNormalText:()=>"Normal text",headingLevel:e=>`Heading ${e}`,commentPreviewFailedToLoad:()=>"Failed to load preview",commentPreviewCommentDeleted:()=>"Comment deleted",richTextEditorEmbedDialog:()=>"Rich Text Editor Insert Embed Dialog",embed:()=>"Embed",insertComment:()=>"Insert Comment",closeEmbedModal:()=>"Close embed modal",commentLink:()=>"Comment Link",invalidCommentUrl:()=>"Invalid comment URL"}),Be=class extends n.s{constructor(e){super(),this.shown=!1,this.editor=e}static get styles(){return[a.t]}connectedCallback(){super.connectedCallback(),this.classList.add("z-[1001]")}isShown(){return this.shown}show(e){this.shown=!0,this.link=e}hide(){this.shown=!1}onRemove(e){if(e.preventDefault(),this.editor){const e={currentSelection:this.link?.currentSelection};this.editor.dispatchCommand(v,e)}this.hide()}onEdit(e){e.preventDefault(),this.editor?.dispatchCommand(I,this.link),this.hide()}setEditor(e){this.editor=e}render(){return n.x`<article role="dialog" class="rte-tooltip bg-neutral-background w-fit p-sm flex flex-none flex-nowrap flex-row justify-start items-center box-border rounded-4 shadow-md z-10 absolute start-0 top-0 ${this.shown?"":"hidden"}" aria-labelledby="rte-tooltip-title"> <p class="sr-only" id="rte-tooltip-title">${Ge.linkOptions()}</p> <a href="${this.link?.url}" style="max-width:302px" target="_blank" class="truncate inline-block me-sm"> ${this.link?.url} </a> <div class="me-sm"> ${Me({attributes:{onclick:this.onEdit},shape:"pill",appearance:"plain",size:a.q.Small,leadingIcon:d.e({size:n.I.Small}),screenReaderContent:Ge.editLinkWithUrl(this.link?.url??"")})} </div> ${Me({attributes:{onclick:this.onRemove,"data-testid":"remove-link-button"},shape:"pill",appearance:"plain",size:a.q.Small,leadingIcon:s.d({size:n.I.Small}),screenReaderContent:Ge.removeLinkWithUrl(this.link?.url??"")})} </article>`}};a._([a.h()],Be.prototype,"shown",void 0),a._([a.h()],Be.prototype,"link",void 0),Be=a._([a.e("rte-link-tooltip")],Be);const Ke=new Map,Fe=new Map;function Ve(e){const{popper:t,tooltip:i}=Ke.get(e)??{};t?.destroy(),i?.remove(),Fe.get(e)?.forEach((e=>e()))}function Ye({forceToHide:e,editor:i,node:a}){const{tooltip:n,popper:r}=Ke.get(a.getKey())??{};n&&i?.getEditorState().read((()=>{const i=t.E(),o=function(e,i){if(!e)return!1;if(!t.u(i))return!1;if(i.anchor.key!==i.focus.key)return!1;return je(i,(t=>t.getKey()===e.getKey()))}(a,i);!e&&o?(n.show({text:a.getTextContent(),url:a.getURL(),nodeKey:a.getKey(),currentSelection:t.u(i)?i:void 0}),r?.update()):n.hide()}))}function We(e,t,i){if(t&&!Ke.has(i.getKey())){const a=new Be(t),n=Ce(e,a);Ke.set(i.getKey(),{popper:n,tooltip:a}),Ze(t,i,a)}else if(Ke.has(i.getKey())){const a=Ke.get(i.getKey());a.popper=Ce(e,a.tooltip),Ze(t,i,a.tooltip)}return e}function Ze(e,i,a){const n=[];n.push(e.registerUpdateListener((()=>Ye({editor:e,node:i})))),n.push(e.registerCommand(t.aY,(()=>!!a.isShown()&&(Ye({editor:e,forceToHide:!0,node:i}),!0)),t.ar));const r=e.getRootElement()?.parentElement,o=()=>{setTimeout((()=>{Ye({editor:e,node:i,forceToHide:!0})}),100)};r?.addEventListener("blur",o),n.push((()=>r?.removeEventListener("blur",o))),r?.addEventListener("change",o),n.push((()=>r?.removeEventListener("change",o))),Fe.set(i.getKey(),n);const s=e.getRootElement()?.assignedSlot?.getRootNode();s.append(a)}class Je extends t.A{static getType(){return"reddit-autolink"}static clone(e){return new Je(e.getURL(),{rel:e.getRel(),target:e.getTarget(),title:e.getTitle(),isUnlinked:e.getIsUnlinked()},e.getKey())}static importJSON(e){return t.A.importJSON(e)}static importDOM(){return t.A.importDOM()}exportJSON(){return{...super.exportJSON(),type:"reddit-autolink",version:1}}createDOM(e,t){const i=super.createDOM(e);if(t&&!this.getIsUnlinked()){"true"===R(t,"plugins.composer.isMobile")?i.addEventListener("click",(e=>{e.preventDefault(),t.read((()=>{t.dispatchCommand(f,{url:this.getURL(),text:this.getTextContent(),nodeKey:this.getKey()})}))})):We(i,t,this)}return i}remove(){Ve(this.getKey()),super.remove()}}function Xe(e="",i){return t.aQ(new Je(e,i))}const qe="image-error";class Qe extends t.aP{constructor({src:e,width:t,height:i,mediaId:a,mimetype:n,uploadStatus:r,blob:o,uploadMethod:s,bearerToken:l,caption:d,uploadedUrl:u},c){super(c),this.__src=e,this.__width=t,this.__height=i,this.__mediaId=a,this.__mimetype=n,this.__uploadStatus=r,this.__blob=o,this.__uploadedUrl=u,this.__uploadMethod=s,this.__bearerToken=l,this.__caption=d}upload(e){e.getRootElement()?.dispatchEvent(a.c(r.c,{resolveReadyState:new Promise(((t,i)=>{this.doUpload(e).then(t).catch(i)}))},!0))}async uploadPoster(e){}set blob(e){this.__blob=e}set height(e){this.__height=e}set mediaId(e){this.__mediaId=e}set mimetype(e){this.__mimetype=e}set src(e){this.__src=e}set uploadStatus(e){this.__uploadStatus=e}set uploadTime(e){this.__uploadTime=e}set width(e){this.__width=e}set caption(e){this.__caption=e}set uploadedUrl(e){this.__uploadedUrl=e}get height(){return this.__height}get mediaId(){return this.__mediaId}get bearerToken(){return this.__bearerToken}get blob(){return this.__blob}get mimetype(){return this.__mimetype}get src(){return this.__src}get uploadStatus(){return this.__uploadStatus}get width(){return this.__width}get caption(){return this.__caption}get uploadedUrl(){return this.__uploadedUrl}get uploadMethod(){return this.__uploadMethod}isInline(){return!1}updateDOM(){return!1}}class et extends n.s{constructor(){super(...arguments),this.key="",this.selected=!1,this.unregisterCallbacks=[],this.handleClick=e=>{e.stopPropagation(),e.shiftKey?this.setSelected(!this.selected):(this.clearSelection(),this.setSelected(!0))}}get readonly(){return this.editor&&!this.editor.isEditable()}clearSelection(){this.editor?.update((()=>{const e=t.E();t.aZ(e)&&e.clear()}))}setSelected(e){this.editor?.update((()=>{let i=t.E();t.aZ(i)||(i=t.a_(),t.l(i)),t.aZ(i)&&(e?i.add(this.key):i.delete(this.key))}))}executeOnNode(e){this.editor?.getEditorState().read((()=>{const i=t.S(this.key);i&&this.isMatchingNodeType(i)&&this.editor?.update((()=>{e(i)}))}))}deleteNode(){this.executeOnNode((e=>{const t=e.getParent(),i=e?.getIndexWithinParent();this.editor?.update((()=>{e.getPreviousSibling()?e.selectPrevious():e.getNextSibling()?e.selectNext():t?.select(i,i),e.remove()})),this.dispatchEvent(a.c(r.e,this.key,!0)),this.dispatchEvent(a.c(this.removeEvent,e.metadata,!0))}))}onDeleteNode(e){return e.stopPropagation(),this.editor?.getEditorState().read((()=>{this.selected&&t.aZ(t.E())&&this.deleteNode()})),!1}connectedCallback(){super.connectedCallback(),this.readonly||this.selectableElement.then((e=>{e.addEventListener("click",this.handleClick),this.unregisterCallbacks.push((()=>{e.removeEventListener("click",this.handleClick)}))})),this.editor&&!this.readonly&&this.unregisterCallbacks.push(t.t(this.editor.registerUpdateListener((({editorState:e})=>{e.read((()=>{this.selected=!!t.S(this.key)?.isSelected()}))})),this.editor.registerCommand(t.a$,this.onDeleteNode.bind(this),t.s),this.editor.registerCommand(t.ae,this.onDeleteNode.bind(this),t.s)))}disconnectedCallback(){super.disconnectedCallback(),this.unregisterCallbacks.forEach((e=>e()))}updated(e){e.get("selected")&&this.editor?.dispatchCommand(t.Y,void 0),super.updated(e)}renderDeleteButton(){return n.x`${Me({size:a.q.Small,shape:"pill",appearance:"media",attributes:{className:"absolute top-xs right-xs z-1",onclick:this.onDeleteNode},leadingIcon:s.d({size:n.I.Small})})}`}}a._([a.n({type:String})],et.prototype,"key",void 0),a._([a.n({type:Object})],et.prototype,"editor",void 0),a._([a.h()],et.prototype,"selected",void 0);class tt extends et{constructor(){super(...arguments),this.allowCaption=!1,this.caption=""}get captionPlaceholder(){return Ge.addCaptionPlaceholder()}onCaptionInput(e){const t=e.target;t.value=t.value.replace(/\n/g,""),t.style.height="",t.style.height=t.scrollHeight+"px"}onCaptionChange(e){const i=e.target;this.executeOnNode((e=>{const a=t.S(e.getKey());if(a){const e=a.getWritable();"caption"in e&&(e.caption=i.value)}}))}onKeyUp(e){"Enter"===e.key&&(e.preventDefault(),this.executeOnNode((e=>{e.getNextSibling()||e.insertAfter(t.I()),e.selectNext()})))}renderCaptionInput(){const e="font-sans text-12 border-none text-center resize-none w-full box-border outline-none";return this.readonly?this.caption?n.x`<figcaption class="mt-xs ${e}">${this.caption}</figcaption>`:"":n.x`<div class="flex flex-col items-center mt-xs"> <input type="text" class="absolute -left-[99999px]"> <textarea type="text" rows="1" class="${e} rounded-2" placeholder="${this.captionPlaceholder}" ?readonly="${this.readonly}" @input="${this.onCaptionInput}" @change="${this.onCaptionChange}" @click="${e=>{e.stopImmediatePropagation();const t=e.target;t.previousElementSibling&&(t.previousElementSibling.focus(),setTimeout((()=>{t.focus()})))}}" @focus="${e=>{e.stopImmediatePropagation(),this.setSelected(!1)}}" @keyup="${this.onKeyUp}">
${this.caption}</textarea> </div>`}}tt.styles=[a.t],a._([a.n({type:Boolean,attribute:"allow-caption"})],tt.prototype,"allowCaption",void 0),a._([a.n({type:String})],tt.prototype,"caption",void 0);class it extends tt{constructor(){super(...arguments),this.key="",this.src="",this.mediaId="",this.width=0,this.height=0,this.hasMediaLoadError=!1}getMediaSrc(){return this.src&&!this.hasMediaLoadError?this.src:this.getSrcPlaceholder()}onMediaLoadError(){this.hasMediaLoadError=!0}updated(e){const t=e.get("uploadStatus");void 0!==t&&("failed"===this.uploadStatus?this.dispatchEvent(a.c(r.d,this.key,!0)):"failed"===t&&this.dispatchEvent(a.c(r.e,this.key,!0))),super.updated(e)}getAdditionalContainerClassNames(){return""}renderLoading(){return n.x`<div class="absolute top-xs end-xs w-md h-md flex items-center justify-center p-xs bg-secondary-background rounded-full"> <faceplate-progress value="20" class="animate-spin"></faceplate-progress> </div>`}renderMissingMediaMessage(){return n.x`<div class="h-0 basis-100"></div> <div class="flex items-center text-danger-content gap-xs py-xs"> ${o.i({size:n.I.Small})} <div> <div>${this.missingMediaMessage}</div> </div> </div>`}renderFailed(){return n.x`<div class="h-0 basis-100"></div> <div class="flex grow flex-wrap"> <div class="flex grow items-center text-danger-content gap-xs"> ${o.i({size:n.I.Small})} <p class="text-12 leading-4 m-0">${Ge.unableToUpload()}</p> </div> <div class="flex gap-s"> ${Me({appearance:"plain",size:a.q.Small,children:Ge.remove(),attributes:{onclick:()=>{this.deleteNode()}}})} ${Me({appearance:"plain",size:a.q.Small,children:Ge.retry(),attributes:{onclick:()=>{this.executeOnNode((e=>{e.upload(this.editor)}))}}})} </div> </div>`}render(){const e="contain-paint box-border";return this.readonly?n.x` <figure class="flex flex-col m-0 ${e} ${this.getAdditionalContainerClassNames()}"> ${this.renderMedia(this.getMediaSrc(),this.onMediaLoadError)} ${this.allowCaption?this.renderCaptionInput():""} </figure> `:n.x` <div class="flex flex-col relative ${this.getAdditionalContainerClassNames()}"> ${"inprogress"===this.uploadStatus||"validating"===this.uploadStatus?this.renderLoading():this.selected?this.renderDeleteButton():""} <div class="${e} rounded-2 h-full w-full ${this.selected?"shadow-[0_0_0_4px_var(--color-primary-background)]":"hover:shadow-[0_0_0_2px_var(--color-primary-background)]"}"> ${this.renderMedia(this.getMediaSrc(),this.onMediaLoadError)} </div> ${this.allowCaption?this.renderCaptionInput():""} </div> ${"failed"===this.uploadStatus?this.renderFailed():""} ${!this.src||this.hasMediaLoadError?this.renderMissingMediaMessage():""}`}}it.styles=[n.a`:host{--loader-size:1rem;display:flex;flex-wrap:wrap;position:relative}.contain-paint{contain:paint}`,a.t],a._([a.n({type:String})],it.prototype,"key",void 0),a._([a.n({type:String})],it.prototype,"src",void 0),a._([a.n({type:String,attribute:"media-id"})],it.prototype,"mediaId",void 0),a._([a.n({type:Number})],it.prototype,"width",void 0),a._([a.n({type:Number})],it.prototype,"height",void 0),a._([a.n({type:String,attribute:"upload-status"})],it.prototype,"uploadStatus",void 0),a._([a.n({type:Object})],it.prototype,"editor",void 0),a._([a.h()],it.prototype,"hasMediaLoadError",void 0);const at=()=>`${window?.CLIENT_CONFIG?.STATIC_BASE_URL}assets/posts-and-comments/broken-image.svg`;let nt=class extends it{constructor(){super(...arguments),this.alt="",this.selectableElement=this.image,this.missingMediaMessage=Ge.missingMediaMessage(),this.removeEvent="image-remove",this.getSrcPlaceholder=at,this.isMatchingNodeType=pt,this.renderMedia=(e,t)=>{const i=[this.height?`max-height: max(20px, ${this.height}px)`:"",this.width?`max-width: max(20px, min(100%, ${this.width}px))`:""],r=this.caption||this.alt||Ge.richTextEditorImageAlt(),o="inprogress"===this.uploadStatus||"validating"===this.uploadStatus||"validated"===this.uploadStatus,s={"opacity-50":o||"failed"===this.uploadStatus,"min-w-[20px]":!o,"min-h-[20px]":!o,"min-w-[100px]":o,"min-h-[100px]":o,"bg-secondary-background":o};return n.x` <div> <img src="${e}" data-media-id="${this.mediaId}" class="rounded-2 box-border max-w-full max-h-[600px] block ${a.Z(s)}" style="${a.ad(i.length?i.join(";"):void 0)}" alt="${r}" @error="${t}"> </div> `}}};async function rt(e,t){let i={};try{i=await l.u(e,t)}catch{}if(i.error)throw new Error(i.error);return i}async function ot(e,t,i){try{if(!t.blob)throw new Error(t.missingSourceErrorMessage);e.update((()=>{const e=t.getWritable();e.uploadStatus="inprogress",e.uploadedUrl=void 0}),{tag:m});const n=Date.now(),r=[],o={...t.metadata};r.push(rt(t.blob,{bearerToken:t.bearerToken,trackEvent:t=>a.i(e.getRootElement(),t),eventSource:R(e,"plugins.composer.eventSource")}).then((i=>{const a=Date.now()-n,r=i?.mediaId??"";e.update((()=>{let e=t.getWritable();e=t.getWritable(),e.uploadTime=a,e.uploadedUrl=i?.url,e.mediaId=r}),{tag:m}),o.mediaId=r,o.mediaUploadDuration=a}))),r.push(i?.(e)),await Promise.all(r),e.update((()=>{let e=t.getWritable();e=t.getWritable(),e.uploadStatus=void 0}),{tag:m}),e.getRootElement()?.dispatchEvent(a.c(t.uploadEventKey,o,!0))}catch{e.update((()=>{t.getWritable().uploadStatus="failed"}),{tag:m});const i=t.errorEventKey;throw (e.getRootElement()?.dispatchEvent(a.c(i,{reason:"ERROR"})), new Error(t.uploadErrorMessage))}}a._([a.n({type:String})],nt.prototype,"alt",void 0),a._([a.eh("img")],nt.prototype,"image",void 0),nt=a._([a.e("rte-image")],nt);const st=/^data:([^;]+);base64,(.+)$/;function lt(e){return st.test(e)}function dt(e){if(e instanceof HTMLImageElement){const{src:t,width:i,height:a,alt:n}=e,r=e.dataset.mediaId,o=e.dataset.mimetype??"",s=e.dataset.uploadStatus,l=e.dataset.caption,d=lt(t);if(!r&&!d)return null;return{node:ct({width:i,height:a,src:t,alt:n,mediaId:r??"",uploadStatus:s,uploadMethod:d?"clipboard":void 0,mimetype:o,caption:l})}}return null}class ut extends Qe{get alt(){return this.__alt}static getType(){return"image"}constructor({alt:e,...t},i){super(t,i),this.missingSourceErrorMessage="Image has no provided source",this.uploadErrorMessage="Image failed to upload",this.errorEventKey=qe,this.uploadEventKey="image-upload",this.__alt=e??"rich text editor image"}get isGiphy(){return this.__mediaId.startsWith(i.d4)||/giphy\.com/.test(this.__src);}get metadata(){return{mediaWidth:this.__width,mediaHeight:this.__height,mediaId:this.__mediaId,mediaMimetype:this.__mimetype,mediaSize:this.__blob?.size,mediaUrl:this.__src,mediaSource:this.__uploadMethod,mediaUploadDuration:this.__uploadTime,mediaFileName:this.__blob instanceof File?this.__blob.name:void 0,mediaCaption:this.__caption,mediaType:"image"}}doUpload(e){return ot(e,this)}createDOM(e){const t=document.createElement("span");return t.setAttribute("class",e.theme.image||""),t}decorate(e){return n.x`<div> <rte-image src="${this.__src}" media-id="${this.__mediaId}" key="${this.__key}" width="${this.__width}" height="${this.__height}" upload-status="${a.ad(this.__uploadStatus)}" .editor="${e}" alt="${this.__alt}" ?allow-caption="${R(e,"plugins.media.allowCaptions")}" caption="${a.ad(this.__caption)}"></rte-image> </div> `}updateDOM(){return!1}static importDOM(){return{img:()=>({conversion:dt,priority:0})}}static importJSON(e){return ct({src:e.src,alt:e.alt,height:e.height,width:e.width,mediaId:e.mediaId,mimetype:e.mimetype,uploadStatus:e.uploadStatus,caption:e.caption})}exportDOM(){const e=document.createElement("img");return e.setAttribute("src",this.__src),e.setAttribute("alt",this.__alt),e.setAttribute("width",`${this.__width}`),e.setAttribute("height",`${this.__height}`),e.setAttribute("data-media-id",this.__mediaId),e.setAttribute("data-mimetype",this.__mimetype),this.__uploadStatus&&e.setAttribute("data-upload-status",`${this.__uploadStatus}`),this.__caption&&e.setAttribute("data-caption",this.__caption),{element:e}}exportJSON(){return{type:"image",src:this.__src,width:this.__width,height:this.__height,alt:this.__alt,mediaId:this.__mediaId,mimetype:this.__mimetype,uploadStatus:this.__uploadStatus,caption:this.__caption,version:1}}static clone(e){const{__src:t,__alt:i,__width:a,__height:n,__mediaId:r,__uploadStatus:o,__blob:s,__uploadMethod:l,__key:d,__mimetype:u,__caption:c,__uploadedUrl:p}=e;return new ut({src:t,alt:i,width:a,height:n,mediaId:r,mimetype:u,uploadStatus:o,blob:s,uploadMethod:l,caption:c,uploadedUrl:p},d)}}function ct(e){return new ut(e)}function pt(e){return e instanceof ut}class mt extends t.o{static getType(){return"reddit-link"}static clone(e){return new mt(e.getURL(),{rel:e.getRel(),target:e.getTarget(),title:e.getTitle()},e.getKey())}static importJSON(e){return t.o.importJSON(e)}static importDOM(){return t.o.importDOM()}exportJSON(){return{...super.exportJSON(),type:"reddit-link",version:1}}createDOM(e,t){const i=super.createDOM(e);if(t){"true"===R(t,"plugins.composer.isMobile")?i.addEventListener("click",(e=>{e.preventDefault(),t.read((()=>{t.dispatchCommand(f,{url:this.getURL(),text:this.getTextContent(),nodeKey:this.getKey()})}))})):We(i,t,this)}return i}remove(){Ve(this.getKey()),super.remove()}}function ht(e="",i){return t.aQ(new mt(e,i))}const gt="video-error";let kt=class extends it{constructor(){super(...arguments),this.type="",this.playerUi="desktop",this.selectableElement=this.shredditPlayer,this.missingMediaMessage=Ge.unableToDisplayVideoError(),this.removeEvent="video-remove",this.getSrcPlaceholder=()=>this.src,this.isMatchingNodeType=vt,this.getAdditionalContainerClassNames=()=>"w-100",this.renderMedia=(e,t)=>{const i=`\n      --aspect-ratio: ${this.width&&this.height?Math.max(this.width/this.height,1):1};\n      --max-height: 450px;\n    `,a=this.caption||Ge.richTextEditorVideoAlt();return n.x` <shreddit-aspect-ratio style="${i}"> <shreddit-player autoplay-pref ?is-mobile="${"mobile"===this.playerUi}" src="${e}" data-media-id="${this.mediaId}" class="rounded-2 h-full w-full max-w-full max-h-[600px] min-w-[20px] min-h-[20px] box-border object-cover block ${"inprogress"===this.uploadStatus||"failed"===this.uploadStatus||"validating"===this.uploadStatus?"opacity-50":""}" ?hide-controls="${"failed"===this.uploadStatus}" @error="${t}" poster="${this.poster}" poster-alt="${a}"> <source src="${e}" type="${this.type}"> </shreddit-player> </shreddit-aspect-ratio> `}}};function Nt(e){if(e instanceof HTMLVideoElement){const{width:t,height:i}=e,a=e.dataset.mediaId,n=e.querySelector("source"),r=n?.getAttribute("src")??"",o=n?.getAttribute("type")??"",s=n?.getAttribute("posterUploadedUrl")??"",l=n?.getAttribute("uploadedUrl")??"",d=e.dataset.uploadStatus,u=e.dataset.playerUi??"desktop",c=e.dataset.caption,p=e.poster;if(!a)return null;return{node:ft({width:t,height:i,src:r,mediaId:a,uploadStatus:d,mimetype:o,playerUi:u,caption:c,poster:p,posterUploadedUrl:s,uploadedUrl:l})}}return null}a._([a.n({type:String})],kt.prototype,"type",void 0),a._([a.n({type:String})],kt.prototype,"playerUi",void 0),a._([a.n({type:String})],kt.prototype,"poster",void 0),a._([a.eh(a.f7)],kt.prototype,"shredditPlayer",void 0),kt=a._([a.e("rte-video")],kt);class It extends Qe{constructor({playerUi:e,getPosterBlob:t,poster:i,posterUploadedUrl:n,...r},o){super(r,o),this.missingSourceErrorMessage="Video has no provided source",this.uploadErrorMessage="Video failed to upload",this.errorEventKey=gt,this.uploadEventKey="video-upload",this.uploadPoster=async e=>{const t=await(this.__getPosterBlob?.());if(!t)throw new Error("Could not get poster file");const i=this.getPosterFile(t),n=await rt(i,{bearerToken:this.__bearerToken,trackEvent:t=>a.i(e.getRootElement(),t),eventSource:R(e,"plugins.composer.eventSource")});if(n?.error)throw new Error(`Could not get poster lease: ${n.error}`);return{blob:t,url:n.url}},this.__playerUi=e??"desktop",this.__getPosterBlob=t,this.__poster=i,this.__posterUploadedUrl=n}static clone(e){const{__src:t,__width:i,__height:a,__mediaId:n,__uploadStatus:r,__blob:o,__uploadMethod:s,__key:l,__mimetype:d,__playerUi:u,__caption:c,__poster:p,__uploadedUrl:m,__posterUploadedUrl:h,__getPosterBlob:g}=e;return new It({src:t,width:i,height:a,mediaId:n,mimetype:d,uploadStatus:r,blob:o,playerUi:u,uploadMethod:s,caption:c,poster:p,uploadedUrl:m,posterUploadedUrl:h,getPosterBlob:g},l)}static getType(){return"video"}getPosterFile(e){return new File([e],"video-poster"+(this.mediaId?`-${this.mediaId}`:""),{type:e.type})}static importDOM(){return{video:()=>({conversion:Nt,priority:0})}}static importJSON(e){return ft({src:e.src,height:e.height,width:e.width,mediaId:e.mediaId,mimetype:e.mimetype,playerUi:e.playerUi,uploadStatus:e.uploadStatus,caption:e.caption,poster:e.poster,posterUploadedUrl:e.posterUploadedUrl})}get playerUi(){return this.__playerUi}get poster(){return this.__poster}set poster(e){this.__poster=e}set getPosterBlob(e){this.__getPosterBlob=e}set posterUploadedUrl(e){this.__posterUploadedUrl=e}get posterUploadedUrl(){return this.__posterUploadedUrl}doUpload(e){return ot(e,this,(async e=>{const{blob:i,url:a}=(await this.uploadPoster(e))??{};i&&a&&e.update((()=>{const e=this.getWritable();e.poster=URL.createObjectURL(i),e.posterUploadedUrl=a}),{tag:t.b0})}));}createDOM(e){const t=document.createElement("span");return t.setAttribute("class",e.theme.video||""),t}decorate(e){return n.x` <div> <rte-video src="${this.__src}" media-id="${this.__mediaId}" key="${this.__key}" width="${this.__width}" height="${this.__height}" playerUi="${this.__playerUi}" upload-status="${a.ad(this.__uploadStatus)}" ?allow-caption="${R(e,"plugins.media.allowCaptions")}" caption="${a.ad(this.__caption)}" poster="${a.ad(this.__poster)}" .editor="${e}"></rte-video> </div> `}exportDOM(){const e=document.createElement("video"),t=document.createElement("source");return e.setAttribute("width",`${this.__width}`),e.setAttribute("height",`${this.__height}`),e.setAttribute("data-media-id",this.__mediaId),e.setAttribute("data-player-ui",this.__playerUi),this.__caption&&e.setAttribute("data-caption",this.__caption),this.__poster&&e.setAttribute("poster",this.__poster),t.setAttribute("src",this.__src),t.setAttribute("type",this.__mimetype),e.appendChild(t),{element:e}}exportJSON(){return{type:"video",src:this.__src,width:this.__width,height:this.__height,mediaId:this.__mediaId,mimetype:this.__mimetype,playerUi:this.__playerUi,uploadStatus:this.__uploadStatus,caption:this.__caption,poster:this.__poster,posterUploadedUrl:this.__posterUploadedUrl,version:1}}get metadata(){return{mediaWidth:this.__width,mediaHeight:this.__height,mediaId:this.__mediaId,mediaMimetype:this.__mimetype,mediaSize:this.__blob?.size,mediaUrl:this.__src,mediaSource:this.__uploadMethod,mediaUploadDuration:this.__uploadTime,mediaFileName:this.__blob instanceof File?this.__blob.name:void 0,mediaCaption:this.__caption,mediaType:"video"}}}function ft({src:e,width:t,height:i,mediaId:a,mimetype:n,uploadStatus:r,blob:o,playerUi:s,uploadMethod:l,bearerToken:d,caption:u,poster:c,getPosterBlob:p}){return new It({src:e,width:t,height:i,mediaId:a,mimetype:n,uploadStatus:r,blob:o,playerUi:s,uploadMethod:l,bearerToken:d,caption:u,poster:c,getPosterBlob:p})}function vt(e){return e instanceof It}const bt=[ut.getType(),It.getType()];class Rt extends Error{constructor(e,t){super(e),this.reason=t}}const Tt={};let Et=class extends tt{constructor(){super(...arguments),this.key="",this.helperText="",this.selectableElement=this.mediaPlaceholder,this.removeEvent="media-placeholder-remove",this.isMatchingNodeType=yt}get captionPlaceholder(){return Ge.captionPlaceholder()}focusOnMediaPlaceholderNode(){this.editor?.dispatchCommand(r.R,{}),this.editor?.update((()=>{const e=t.a_();e.add(this.key),t.l(e)}))}get metadata(){return{mediaPlaceholderCaption:this.caption,mediaPlaceholderHelperText:this.helperText}}onImageInputClick(){this.dispatchEvent(a.c("media-placeholder-upload-image-click",this.metadata,!0)),this.focusOnMediaPlaceholderNode(),this.editor?.dispatchCommand(Tt,{type:"image"})}onVideoInputClick(){this.dispatchEvent(a.c("media-placeholder-upload-video-click",this.metadata,!0)),this.focusOnMediaPlaceholderNode(),this.editor?.dispatchCommand(Tt,{type:"video"})}render(){return n.x` <div class="flex flex-col h-full w-full"> <div class="overflow-hidden rounded-4 text-center ${this.readonly?"":this.selected?"shadow-[0_0_0_4px_var(--color-primary-background)]":"hover:shadow-[0_0_0_2px_var(--color-primary-background)]"}" data-is-media-placeholder=""> <div class="border border-coolgray-350 border-dashed pb-2xl pt-2xl rounded-4"> <div class="flex flex-col h-4xl justify-center"> <h4 class="font-semibold m-0 mb-2xs">${this.helperText}</h4> <span class="text-secondary-weak">${Ge.fileSelectorDragAndDrop()} <button class="bg-transparent border-none cursor-pointer p-0 text-global-alienblue text-inherit" @click="${this.onImageInputClick}"> ${Ge.fileSelectorAddAnImage()}</button>${Ge.fileSelectorOr()} <button class="bg-transparent border-none cursor-pointer p-0 text-global-alienblue text-inherit" @click="${this.onVideoInputClick}"> ${Ge.fileSelectorAddAVideo()} </button> </span> ${this.selected?this.renderDeleteButton():""} </div> </div> </div> ${this.allowCaption?this.renderCaptionInput():""} </div> `}};function Lt(e){if(e instanceof HTMLSpanElement&&"isMediaPlaceholder"in e.dataset){return{node:Ot({caption:e.getAttribute("caption")??void 0,helperText:e.getAttribute("helper-text")??void 0})}}return null}Et.styles=[n.a`:host{--loader-size:1rem;display:flex;flex-wrap:wrap;position:relative}`,a.t],a._([a.n({type:String})],Et.prototype,"key",void 0),a._([a.n({type:String,attribute:"helper-text"})],Et.prototype,"helperText",void 0),a._([a.n({type:Object})],Et.prototype,"editor",void 0),a._([a.eh("div[data-is-media-placeholder]")],Et.prototype,"mediaPlaceholder",void 0),Et=a._([a.e("rte-media-placeholder")],Et);class St extends t.aP{static getType(){return"mediaplaceholder"}constructor({caption:e,helperText:t},i){super(i),this.__caption=e,this.__helperText=t}get caption(){return this.__caption}get helperText(){return this.__helperText}get metadata(){return{mediaPlaceholderCaption:this.__caption,mediaPlaceholderHelperText:this.__helperText}}set caption(e){this.__caption=e}set helperText(e){this.__helperText=e}createDOM(e){const t=document.createElement("span");return t.setAttribute("class",e.theme?.mediaplaceholder||""),t}updateDOM(){return!1}static importDOM(){return{span:e=>e instanceof HTMLSpanElement&&"isMediaPlaceholder"in e.dataset?{conversion:Lt,priority:1}:null}}exportDOM(){const e=document.createElement("span");return e.setAttribute("data-is-media-placeholder",""),e.setAttribute("caption",this.__caption??""),e.setAttribute("helper-text",this.__helperText??""),{element:e}}static importJSON(e){return Ot({caption:e.caption,helperText:e.helperText})}decorate(e){return n.x` <rte-media-placeholder ?allow-caption="${R(e,"plugins.media.allowCaptions")}" caption="${a.ad(this.__caption)}" helper-text="${a.ad(this.__helperText)}" key="${this.__key}" .editor="${e}"></rte-media-placeholder> `}exportJSON(){return{type:"mediaplaceholder",caption:this.__caption,helperText:this.__helperText,version:1}}static clone(e){return new St({caption:e.caption,helperText:e.helperText},e.getKey())}isInline(){return!1}}const yt=e=>e instanceof St;function Ot({caption:e,helperText:t}){return new St({caption:e,helperText:t})}class Pt extends t.b1{constructor(){super(...arguments),this._canBeEmpty=!0}static getType(){return"spoiler"}isInline(){return!0}createDOM(e){const t=document.createElement("span");return t.setAttribute("class",e.theme?.spoiler||""),t}updateDOM(){return!1}static importDOM(){return{span:e=>e instanceof HTMLSpanElement&&"isSpoiler"in e.dataset?{conversion:()=>({node:_t()}),priority:1}:null}}exportDOM(){const e=document.createElement("span");return e.setAttribute("data-is-spoiler",""),{element:e}}static importJSON(e){const t=_t();return t.setFormat(e.format),t.setIndent(e.indent),t.setDirection(e.direction),t}exportJSON(){return{type:Pt.getType(),children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),version:1}}insertNewAfter(e,i=!0){const a=this.getParentOrThrow().insertNewAfter(e,i);if(t.g(a)){const e=_t();return e._canBeEmpty=!1,a.append(e),e}return null}canBeEmpty(){return!1===this._canBeEmpty?(this._canBeEmpty=!0,!1):this._canBeEmpty}static clone(e){return new Pt(e.getKey())}}function _t(){return new Pt}function zt(e){if(e.startsWith("/")){const[,t,i]=e.split("/");return[t.toLowerCase(),i]}const[t,i]=e.split("/");return[t.toLowerCase(),i]}function Ht(e){let t=e;0===e.search(/^@[A-Za-z0-9]/)&&(t=e.replace("@","u/"));const[i,a]=zt(t);return[t,i,a]}function Dt(e){return{node:Ut(e.innerText)}}class xt extends t.j{static getType(){return"reddit-mention"}static clone(e){return new xt(e.__text,e.__key)}static importJSON(e){const t=Ut(e.text);return t.setFormat(e.format),t.setDetail(e.detail),t.setMode(e.mode),t.setStyle(e.style),t}constructor(e,t){const[i,a,n]=Ht(e);super(i,t),this.__mentionType=a,this.__mentionName=n}moveCursorToTextEnd(){const e=t.E();if(t.u(e)){const t=this.getWritable(),i=t.getTextContentSize();e.setTextNodeRange(t,i,t,i)}}exportJSON(){return{...super.exportJSON(),mentionType:this.getMentionType(),mentionName:this.getMentionName(),type:"reddit-mention",version:1}}getMentionType(){return this.getLatest().__mentionType}getMentionName(){return this.getLatest().__mentionName}setTextContent(e){if(this.__text===e)return this;const[t,i,a]=Ht(e),n=super.setTextContent(t);return n.__mentionName=a,n.__mentionType=i,n}createDOM(e){const t=document.createElement("a");return t.textContent=this.__text,t.className="u"===this.getMentionType()?"user-mention":"subreddit-mention",t}updateDOM(e,t){return t.innerText=this.__text,!1}static importDOM(){return{a:e=>e instanceof HTMLAnchorElement&&"isMention"in e.dataset?{conversion:Dt,priority:2}:null}}exportDOM(){const e=document.createElement("a");return e.setAttribute("data-is-mention",""),e.innerText=this.__text,{element:e}}canInsertTextBefore(){return!1}isTextEntity(){return!0}}function Ut(e){const i=new xt(e);return i.setDetail(2),e.startsWith("@")&&i.moveCursorToTextEnd(),t.aQ(i)}let At=class extends n.s{constructor(e,t,i){super(),this.unsubscribeFn=[],this.options=[],this.selectedIndex=-1,this.updateOptions=a.ao((async e=>{this.searchOperationAbortController?.abort("Redundant request"),this.searchOperationAbortController=new AbortController;try{this.options=await this.filter(e,{signal:this.searchOperationAbortController.signal}),this.selectedIndex=0}catch(e){if("AbortError"===e.name)throw e}}),128),this.handlePointerDown=e=>{e.preventDefault()},this.handleClick=e=>{const t=e.currentTarget;this.selectedIndex=parseInt(t.dataset.index??"-1"),this.applyCurrentSelection()},this.handlePointerEnter=e=>{const t=e.currentTarget;this.selectedIndex=parseInt(t.dataset.index??"-1")},this.editor=e,this.filter=i,this.mentionNode=t}connectedCallback(){super.connectedCallback();const e=this.editor.registerCommand(t.a,(e=>(e.preventDefault(),e.stopImmediatePropagation(),this.incrementSelectedIndex(),!0)),t.ar);this.unsubscribeFn.push(e);const i=this.editor.registerCommand(t.b2,(e=>(e.preventDefault(),e.stopImmediatePropagation(),this.decrementSelectedIndex(),!0)),t.ar);this.unsubscribeFn.push(i);const a=e=>!!this.options.at(this.selectedIndex)&&(e?.preventDefault(),e?.stopImmediatePropagation(),this.applyCurrentSelection(),!0),n=this.editor.registerCommand(t.M,a,t.ar);this.unsubscribeFn.push(n);const r=this.editor.registerCommand(t.D,a,t.ar);this.unsubscribeFn.push(r);const o=this.editor.registerCommand(t.aY,(e=>(e?.preventDefault(),e?.stopImmediatePropagation(),this.resetOptions(),!0)),t.ar);this.unsubscribeFn.push(o)}disconnectedCallback(){this.unsubscribeFn.forEach((e=>e())),super.disconnectedCallback()}scrollToSelectedItem(){const e=this.shadowRoot.querySelector(`[data-index="${this.selectedIndex}"]`);e?.scrollIntoView({block:"end",behavior:"auto"})}static get styles(){return[a.t]}incrementSelectedIndex(){this.selectedIndex=(this.selectedIndex+1)%this.options.length,this.scrollToSelectedItem()}decrementSelectedIndex(){this.selectedIndex=(this.selectedIndex-1+this.options.length)%this.options.length,this.scrollToSelectedItem()}resetOptions(){this.selectedIndex=-1,this.options=[]}applyCurrentSelection(){const e=this.options.at(this.selectedIndex);e&&this.editor.update((()=>{this.mentionNode.setTextContent(e.text);const i=t.Z(" ");this.mentionNode.insertAfter(i);const a=t.T();a.anchor.type="text",a.focus.type="text",a.anchor.key=i.getKey(),a.focus.key=i.getKey(),a.anchor.offset=1,a.focus.offset=1,t.l(a)}))}async setQuery(e){this.updateOptions(e)}renderListOption(e,t){const i=t===this.selectedIndex;return n.x` <li tabindex="-1" class="cursor-pointer m-0 px-md py-sm text-14 leading-5 truncate ${i?"bg-neutral-background-selected text-secondary-onBackground":"text-secondary"}" role="option" aria-selected="${i.toString()}" data-index="${t}" @pointerenter="${this.handlePointerEnter}" @pointerdown="${this.handlePointerDown}" @click="${this.handleClick}"> <span>${e.text}</span> </li> `}renderListOptions(){return n.x` <ul class="list-none m-0 p-0"> ${a.c2(this.options,(e=>e.id),((e,t)=>this.renderListOption(e,t)))} </ul> `}render(){return 0===this.options.length?n.x``:n.x` <div aria-label="${"Mentions autocomplete list"}" role="listbox" class="overflow-y-auto w-[200px] max-h-[336px] py-xs rounded-2 bg-neutral-background shadow-md"> ${this.renderListOptions()} </div> `;}};a._([a.h()],At.prototype,"options",void 0),a._([a.h()],At.prototype,"selectedIndex",void 0),At=a._([a.e("rte-mention-list")],At),t.a1.prototype.isInline=()=>!0;const Ct=[t.a0,t.C,t.aB,t.a3,t.$,t.a2,t.y,t.ak,t.aj,mt,{replace:t.o,with:e=>new mt(e.getURL(),{rel:e.getRel(),target:e.getTarget(),title:e.getTitle()}),withKlass:mt},Je,{replace:t.A,with:e=>new Je(e.getURL(),{rel:e.getRel(),target:e.getTarget(),title:e.getTitle()}),withKlass:Je},Pt,ut,It,k,St];let jt=class extends n.s{beforeCreateEditor(e){return"function"==typeof this.beforeCreateEditorCallback?this.beforeCreateEditorCallback?.(e):e}createEditor(e){this._rte=e,this._editor=e.getEditor(),"function"==typeof this.createEditorCallback&&this.createEditorCallback?.(e)}};jt=a._([a.e("rte-plugin")],jt);const $t={};function wt(e){return"Comment"===e?.typename}var Mt;!function(e){e.Initial="initial",e.Loading="loading",e.Loaded="loaded",e.Error="error"}(Mt||(Mt={}));let Gt=class extends et{constructor(){super(...arguments),this.id="",this.state=Mt.Initial,this.commentInfo=null,this.errorInfo=null,this.selectableElement=Promise.resolve(this),this.removeEvent="remove-rte-comment-preview",this.isMatchingNodeType=Ft,this.pubsub=new a.u(this),this.handleFetchSuccess=e=>{e.id===this.id&&(this.commentInfo={typename:e.typename,richtext:"Comment"===e.typename?e.richtext:"",permalink:"Comment"===e.typename?e.permalink:"",score:"Comment"===e.typename?e.score:void 0,subredditPrefixedName:"Comment"===e.typename?e.subredditPrefixedName:void 0},this.state=Mt.Loaded)},this.handleFetchError=e=>{e.id===this.id&&(this.state=Mt.Error,this.commentInfo=null,this.errorInfo={errorMsg:e.errorMsg,canBeRetried:e.canBeRetried})},this.onEditNode=e=>{e.stopPropagation();const t=wt(this.commentInfo)&&this.commentInfo.permalink?`${CLIENT_CONFIG.ORIGIN}${this.commentInfo.permalink}`:"";return this.editor?.dispatchCommand($t,{url:t,nodeKey:this.key}),!1}}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(a.T.RTECommentPreviewFetchSuccess,this.handleFetchSuccess),this.pubsub.subscribe(a.T.RTECommentPreviewFetchError,this.handleFetchError),this.state===Mt.Initial&&this.requestData()}updated(e){super.updated(e),e.has("id")&&void 0!==e.get("id")&&this.requestData()}get isLoading(){return this.state===Mt.Loading||this.state===Mt.Initial}requestData(){this.commentInfo=null,this.errorInfo=null,this.state=Mt.Loading,this.pubsub.publish(a.T.RTECommentPreviewFetch,{id:this.id})}renderSuccessState(e){return wt(e)?this.renderAvailableCommentContent(e):this.renderDeletedCommentContent()}renderDeletedCommentContent(){return n.x` <div class="h-[60px] bg-neutral-background-container flex justify-between items-center px-md py-2xs"> <p class="text-neutral-content-weak">${Ge.commentPreviewCommentDeleted()}</p> </div> `}renderAvailableCommentContent(e){const t=e.subredditPrefixedName;return n.x` <div class="bg-neutral-background-container px-md py-xs"> <div class="text-14 text-neutral-content"> ${u.c({richtext:JSON.parse(e.richtext)})} </div> <div class="flex justify-between items-center w-full mt-xs"> <div class="flex items-center gap-2xs"> ${t?n.x` <a href="${CLIENT_CONFIG.ORIGIN}/${t}" target="_blank" rel="noopener noreferrer" class="text-12 text-neutral-content-strong no-underline hover:underline">${t}</a> `:n.A} </div> <span class="inline-flex items-center gap-2xs text-12 mb-2xs"> ${p.u({size:n.I.Small})} <faceplate-number number="${e.score??0}" pretty></faceplate-number> </span> </div> </div> `}renderLoadingState(){return n.x` <faceplate-shimmer class="block h-[60px] w-full"></faceplate-shimmer> `}renderErrorState(){const e=this.errorInfo?.errorMsg??Ge.commentPreviewFailedToLoad(),t=this.errorInfo?.canBeRetried??!0;return n.x` <div class="h-[60px] bg-neutral-background-container flex items-center px-md"> <p class="inline-flex items-center text-neutral-content-weak"> ${c.e({attributes:{className:"me-xs"}})} <span>${e}</span> </p> ${t?a.o({appearance:"plain",size:a.q.Small,children:Ge.retry(),attributes:{onclick:()=>this.requestData(),className:"ms-sm"}}):n.A} </div> `}renderPreview(){return this.state===Mt.Error?this.renderErrorState():this.isLoading||!this.commentInfo?this.renderLoadingState():this.renderSuccessState(this.commentInfo)}renderEditButton(){return n.x`${a.o({size:a.q.Small,shape:"pill",appearance:"media",attributes:{className:"absolute top-xs end-[46px] z-1",onclick:this.onEditNode,"data-testid":"rte-comment-preview-edit-button"},leadingIcon:d.e({size:n.I.Small})})}`}get canEdit(){return this.state===Mt.Loaded}render(){return n.x` <div class="relative rounded-4 overflow-hidden ${this.readonly?"":this.selected?"shadow-[0_0_0_4px_var(--color-primary-background)]":"hover:shadow-[0_0_0_2px_var(--color-primary-background)]"}"> ${this.renderPreview()} ${this.selected?n.x`${this.canEdit?this.renderEditButton():""} ${this.renderDeleteButton()} `:""} </div> `}};Gt.styles=[a.t],a._([a.n({type:String,attribute:"comment-id"})],Gt.prototype,"id",void 0),a._([a.h()],Gt.prototype,"state",void 0),a._([a.h()],Gt.prototype,"commentInfo",void 0),a._([a.h()],Gt.prototype,"errorInfo",void 0),Gt=a._([a.e("rte-comment-preview")],Gt);const Bt="reddit-comment";class Kt extends t.aP{static getType(){return Bt}static clone(e){return new Kt({id:e.id},e.getKey())}constructor({id:e},t){super(t),this.__id=e}get id(){return this.__id}get metadata(){return{commentId:this.__id}}setComment(e){this.getWritable().__id=e}createDOM(e){const t=document.createElement("div");return t.setAttribute("class",e.theme?.[this.getType()]||""),t}updateDOM(){return!1}exportDOM(){const e=document.createElement("div");return e.setAttribute("data-is-reddit-comment",""),e.setAttribute("data-comment-id",this.__id),{element:e}}static importDOM(){return{div:e=>{const t=e instanceof HTMLDivElement&&"isRedditComment"in e.dataset,{commentId:i}=e.dataset;return t&&i?{conversion:()=>({node:Vt({id:i})}),priority:1}:null}}}exportJSON(){return{...super.exportJSON(),type:Bt,id:this.id}}static importJSON(e){return Vt({id:e.id})}decorate(e){return n.x` <rte-comment-preview comment-id="${this.__id}" key="${this.__key}" .editor="${e}"></rte-comment-preview> `}isInline(){return!1}}function Ft(e){return e instanceof Kt}function Vt(e){return new Kt(e)}const Yt=/^\/cmnt\/t1_([a-zA-Z0-9]+)\/?$/;const Wt=/^:.+:$/;var Zt;!function(e){e[e.bold=1]="bold",e[e.italic=2]="italic",e[e.strikethrough=4]="strikethrough",e[e.underline=8]="underline",e[e.monospace=16]="monospace",e[e.subscript=32]="subscript",e[e.superscript=64]="superscript"}(Zt||(Zt={}));const Jt={h1:1,h2:2,h3:3,h4:4,h5:5,h6:6};function Xt(i){if(!ti(i))return[];switch(i.type){case t.y.getType():return function(t){let i=t.children;const a=i[0].children.map((t=>{const i=t.children[0],a=function(t){switch(t){case"right":return e.k.RIGHT;case"center":return e.k.CENTER;case"left":return e.k.LEFT;default:return}}(i?.format??null),n={};return n.c=ii(t)?ni(t.children[0]):[],a&&(n.a=a),n})).filter((e=>null!=e));return i=i.slice(1),[a,i.map((e=>e.children.map((e=>({c:ii(e)?ni(e.children[0]):[]})))))]}(i);case t.$.getType():return function(t){const i=t.children.map((e=>ei(e,t))).filter(Boolean);return ri(i).filter(((t,i,a)=>t.e!==e.L||(i===a.length-1||a[i+1].e===e.L))).map((t=>t.e===e.L?{e:e.R,t:""}:{e:e.R,t:t.t}))}(i);default:return ni(i)}}const qt=[Je.getType(),mt.getType()];function Qt(i,a){const n=i.text;return"\0"===n?null:[t.a0.getType(),t.$.getType()].some((e=>a?.type===e))?{e:e.R,t:n}:{e:e.j,t:n,f:n.trim().length>0?ai(i):void 0}}function ei(i,a){if("linebreak"===i.type)return{e:"br"};const n=Xt(i);switch(i.type){case ut.getType():case k.getType():{if(i.mediaId.match(Wt)){const t=i;return{e:e.b,a:t.mediaId,u:t.src}}const t=i;return{e:"image/gif"===t.mimetype?e.A:e.I,id:t.mediaId,c:t.caption}}case It.getType():{const t=i;return{e:e.V,id:t.mediaId,c:t.caption}}case t.F.getType():return oi(n);case t.$.getType():return{e:e.c,c:n};case t.a2.getType():return i.text;case t.a3.getType():{const t=oi(n);return{e:e.B,c:[t]}}case Pt.getType():return{e:e.S,c:n};case t.C.getType():{const t="number"===i.listType;return{e:e.f,o:t,c:n}}case t.aB.getType():{const t=[e.j,e.S,e.i,e.g,e.h],i=[];let a;for(const r of n)t.includes(r.e)?(a??(a={e:e.P,c:[]})).c.push(r):(a&&(i.push({...a}),a=void 0),i.push(r));a&&i.push(a);return{e:e.e,c:i}}case t.a0.getType():return{e:e.d,l:Jt[i.tag],c:n};case mt.getType():{const t=ri(n).find((t=>t.e===e.j));return{e:e.i,t:t?t.t:"",u:i.url,f:t?t.f:void 0}}case Kt.getType():{const t=i.id,a=function(e){return`/cmnt/${e}`}(t);return oi([{e:e.i,t,u:a,f:void 0}])}case Je.getType():{const t=ri(n).find((t=>t.e===e.j)),a=t?t.t:"",r=t?t.f:void 0,o=i;return o.isUnlinked?{e:e.j,t:a,f:r}:{e:e.i,t:a,u:o.url,f:r}}case xt.getType():{const e=i,[t,n]=zt(e.text);return!n||a&&function(e){return qt.includes(e.type)}(a)?Qt(i,a):{e:`${t}/`,t:n,l:!1}}case t.y.getType():{const[t,i]=n;return{e:e.T,h:t,c:i}}case t.j.getType():case t.b3.getType():return Qt(i,a);case St.getType():return null;default:return window.Sentry?.captureMessage?.(`Lexical to RTJSON: unimplemented node type: ${i.type}`),null}}const ti=e=>!!e?.children;function ii(e){const i=e?.children??[];return 0!==i.length&&(1!==i.length||i[0].type!==t.F.getType()||0!==(i[0]?.children?.length??0)&&i[0]?.children[0]?.type!==t.a1.getType())}function ai(e,t=!1){const i=e,a=u.b(i.text);return[[si(t?16|i.format:i.format),a[(n=i.text,n.length-n.trimStart().length)],a[i.text.trim().length]]];var n}function ni(e){return ri(e.children.map((t=>ei(t,e))).filter(Boolean))}function ri(t){const i=[];let a=null;for(const n of t)n.e===e.j?a?li(a,n):(i.push(n),a=n):(a=null,i.push(n));return i.forEach((t=>{if(t.e===e.j&&t.f){const e=t.f.filter((e=>e[0]>0));t.f=e.length>0?e:void 0}})),i}function oi(t){return{e:e.P,c:t?.length?t:[{e:e.j,t:""}]}}function si(t){let i=0;for(const a in Zt){if(!t)break;if(isNaN(Number(a)))continue;const n=Number(a);if(n===Zt.underline)continue;if(n&t){const t=Zt[a];i|=e.F[t]}t&=~n}return i}function li(e,t){const i=u.b(e.t)[e.t.length];e.t+=t.t;const[a,n,r]=t.f?.[0]??[0,0,0];return r>0&&(e.f??(e.f=[])).push([a,n+i,r]),e}function di(a,n){switch(a.e){case e.P:{const e=ui(a,n);if(1===e.length){const i=e[0];if("image"===i.getType())return i;if(t.ah(i)&&(r=i.getURL(),Yt.test(r))){const e=function(e){const t=e.match(Yt);return t?.[1]?`t1_${t[1]}`:""}(i.getURL());return Vt({id:e})}}const i=t.I();return i.append(...e),i}case e.j:return ci(a);case e.R:return t.Z(a.t);case e.i:{const e=a.u===a.t?Xe(a.u):ht(a.u),t=ci(a),i=Array.isArray(t)?t:[t];return e.append(...i),e}case e.S:{const e=_t();return e.append(...ui(a,n)),e}case e.c:{const e=t.a8();return e.append(...function(e){const i=e.c.reduce(((i,a,n)=>(a.t?.length>0&&i.push(t.Z(a.t)),(0===a.t?.length||n<e.c.length-1)&&i.push(t.b6()),i)),[]);0===e.c[e.c.length-1].t.length&&i.splice(i.length-1,1);return i}(a)),e}case e.L:return t.b6();case e.g:case e.h:return Ut(`${a.e}${a.t}`);case e.B:{const i=t.a7();return a.c[0]?.e===e.P?i.append(...ui(a.c[0],n)):i.append(...ui(a,n)),i}case e.f:{const e=t.b5(a.o?"number":"bullet");return e.append(...ui(a,n)),e.getChildren().forEach(((e,t)=>{e.setValue(t+1)})),e}case e.e:{const e=t.b4();return e.append(...ui(a,n)),e}case e.d:{const e=t.aa(`h${a.l}`);return e.append(...ui(a,n)),e}case e.I:case e.A:{const t=n[a.id],r=a.e===e.A?"image/gif":t?.mimetype??"";return a.id.startsWith(i.d3)?N({mediaId:a.id,src:t?.src??"",mimetype:r}):ct({mediaId:a.id,src:t?.src??"",width:t?.width??0,height:t?.height??0,mimetype:r,caption:a?.c})}case e.V:{const e=n[a.id];return ft({mediaId:a.id,src:e?.src??"",width:e?.width??0,height:e?.height??0,mimetype:e?.mimetype??"",caption:a?.c,poster:e?.poster})}case e.T:return function(e,i){const a=t.b7(),n=e.h.map(pi),r=e.h.filter((e=>e.c)).map(((e,a)=>{const r=t.b8(t.al.ROW),o=ui(e,i),s=t.I();return s.append(...o),s.setFormat(n[a]),r.append(s),r})),o=e.c.map((e=>{const a=t.b9(),r=e.map(((e,a)=>{const r=t.b8(t.al.NO_STATUS),o=ui(e,i),s=t.I();return s.append(...o),s.setFormat(n[a]),r.append(s),r}));return a.append(...r),a}));if(r.length>0){const e=t.b9();e.append(...r),o.splice(0,0,e)}return a.append(...o),a}(a,n);case e.b:return N({mediaId:a.a,src:a?.u,mimetype:"image/png"});case"mediaplaceholder":return Ot({caption:a.c,helperText:a.h});default:return window.Sentry?.captureMessage?.(`Lexical to RTJSON: unimplemented node type in rtjson->lexical conversion: ${a.e}`),[]}var r}function ui(e,t){return e.c?.map((e=>di(e,t))).flat()??[]}function ci(i){const a=i.f;if(!a)return t.Z(i.t);const n=i.t,r=u.d(n),o=function(e,t){const i=[];let a=0,n=0;for(;a<t;)if(e[n]){const[t,r,o]=e[n];r>a?(i.push([0,a,r-a]),a=r):r===a&&(i.push([t,r,o]),a=r+o,n++)}else i.push([0,a,t-a]),a=t;return i}(a,r.length);return o.flatMap((i=>{const[a,o,s]=i,l=r[o],d=r[o+s],u=n.substring(l,d),c=t.Z(u);return c.setFormat(function(t){let i=0;for(const a in e.F){if(!t)break;if(isNaN(Number(a)))continue;const n=Number(a);if(n&t){const t=e.F[a];i|=Zt[t]}t&=~n}return i}(a)),c}))}function pi(t){switch(t.a){case e.n:return"right";case e.m:return"center";case e.l:return"left";default:return""}}return {$:N,A:bt,B:"\0",C:lt,D:function(e){const t=e.match(st);if(!t)throw new Error("Invalid data URI format. Expected format: data:<contentType>;base64,<data>");const i=t[1],a=t[2],n=atob(a),r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);return new Blob([r],{type:i})},E:k,F:ct,G:qe,H:m,I:ut,J:It,K:ft,L:gt,M:St,N:"open-video-tooltip",O:"open-image-tooltip",P:function(e,i){const a=e.getChildren(),n=a.findIndex((e=>t.p(e)));if(n>-1){if(a[n].remove(),n===a.length-1){const i=t.I();return e.insertAfter(i),void i.select()}if(0===n){const i=t.I();return void e.insertBefore(i)}if(n>0){const t=i();for(let e=n+1;e<a.length;e++)t.append(a[e]);e.insertAfter(t),t.selectStart()}}},Q:_t,R:function(e,i){const a=t.b();a.clear();for(const t of e.document){const e=di(t,i);a.append(...(Array.isArray(e) ? e : [e]))}},S:Ct,T:function(e,i,a){const n=i.splitText(e.anchor.offset);n[1]||t.ag(e.focus)?n[0].insertAfter(a):i.insertBefore(a)},U:{},V:Rt,W:{},X:I,Y:{},get Z(){return Be},_:function(e,i){return i.getEditor()?.registerNodeTransform(e,(a=>{try{a.getTextContent()&&!$e(i,a.getParentOrThrow(),e)&&(a.insertBefore(new t.j(a.getTextContent())),a.remove(!0))}catch(e){}}))},a:e=>e instanceof Pt,a0:f,a1:ht,a2:function(e,t){return b.set(e,t)},a3:function(e){const t={document:[]};for(const i of e.root.children){const e=ei(i);e&&t.document.push(e)}return t},a4:vt,a5:class{constructor(){this.nodeSetMap=new Map}count(){let e=0;for(const[,t]of this.nodeSetMap)e+=t.size;return e}add(e,t){return this.nodeSetMap.has(e)||this.nodeSetMap.set(e,new Set),this.nodeSetMap.get(e).add(t),!0}delete(e,t){return!!this.nodeSetMap.has(e)&&this.nodeSetMap.get(e).delete(t)}countOf(e){return this.nodeSetMap.get(e)?.size??0}},a6:function e(t=document){const i=t.activeElement;return i?i.shadowRoot?e(i.shadowRoot):i:null},b:xt,c:je,d:function(e){return e instanceof xt},get e(){return Ce},get f(){return At},g:Ut,h:Je,i:$e,j:v,k:function(e){return e instanceof Je},l:function(e){return e instanceof mt},m:Xe,get n(){return jt},o:R,p:Me,q:function(e,...t){return t.some((t=>e.getType()===t.getType()))},r:Ve,s:mt,t:Pt,u:function(e,i,{isValidPlacement:a=()=>!0,handleFiles:n=()=>{},shouldMergeSameNodeType:r=!1}={}){return function(o){const[s,l]=t.aR(o);if(s)return n(o,l),!1;if(r){const e=t.E();if(t.u(e)){const a=e.focus.getNode();if(t.g(a)&&a.getType()===i.getType()||!t.g(a)&&a.getTopLevelElement()?.getType()===i.getType())return!1}}let d=null;if(o instanceof DragEvent?d=o.dataTransfer:o instanceof ClipboardEvent&&(d=o.clipboardData),d){const n=d.getData("application/x-lexical-editor");if(n)try{const r=JSON.parse(n);if(Array.isArray(r.nodes)){if(r.nodes.filter((e=>e.type===i.getType())).length){const i=t.aS(r.nodes);return a(i)&&we(i,e),!0}}return!1}catch(e){window.Sentry?.captureMessage?.(`Error importing Lexical string via paste or drop: ${e?.message}`)}const r=d.getData("text/html");if(r)try{const n=(new DOMParser).parseFromString(r,"text/html"),o=t.aT(e.getEditor(),n);if(o.some((e=>e.getType()===i.getType()))){if(a(o)){const i=o.filter((e=>t.aU(e)||t.aV(e)));we(i,e)}return!0}}catch(e){window.Sentry?.captureMessage?.(`Error importing HTML string via paste or drop: ${e?.message}`)}}return!1}},v:function(e,i,a){return e.registerNodeTransform(t.j,(e=>{try{!i()&&e.hasFormat(a)&&e.toggleFormat(a)}catch(e){}}))},w:function(e,i,a={}){const{collapseBlock:n=!1,fixUpNode:r,nodeHandlers:o}=a,{validChildren:s}=R(i.getEditor(),`nodes.${e.getType()}`);if(s.includes("*"))return()=>{};const l=new Set(s),d=i.getEditor(),u=[d.registerNodeTransform(e,(e=>{!function(e,i,a=[],n){for(const r of a){const o=r.getParentOrThrow();if(n?.[r.getType()])return void n?.[r.getType()]({parent:o,child:r});if(!e.has(r.getType())||i&&a.length>1&&t.g(r)&&!r.isInline()){if(t.p(r))return void r.replace(t.Z(" "));if(t.g(r)){const e=!r.isInline()&&!t.g(r.getFirstChild()),i=r===a[a.length-1];try{const a=r.getLastChild();t.aW(r),e&&!i&&a?.insertAfter(t.Z(" "))}catch(e){}finally{r.getChildren().length>0&&o.append(...r.getChildren())}}r.remove()}}}(l,n,e.getChildren(),o)}))];return r&&u.push(d.registerNodeTransform(e,(e=>{e.isDirty()||r(e)}))),t.t(...u)},x:we,get y(){return Ge},z:Tt};}));
SML.di("./CMwg6atOpj.js",import.meta.url,"CMwg6atOpj");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BkihtVv9so.js",import.meta.url,"BkihtVv9so");SML.di("./CFd1NJhleF.js",import.meta.url,"CFd1NJhleF");SML.di("./BwcUp7XlaC.js",import.meta.url,"BwcUp7XlaC");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./DnNITwgp90.js",import.meta.url,"DnNITwgp90");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");SML.di("./CQMf561ZyA.js",import.meta.url,"CQMf561ZyA");SML.di("./Py9rIF7r2a.js",import.meta.url,"Py9rIF7r2a");SML.di("./KkXqW5RUm3.js",import.meta.url,"KkXqW5RUm3");SML.di("./BAGS8uwlNZ.js",import.meta.url,"BAGS8uwlNZ");SML.di("./lxqt5OPiQh.js",import.meta.url,"lxqt5OPiQh");SML.di("./Q1IJQIXJf2.js",import.meta.url,"Q1IJQIXJf2");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./D1ScrvIqaY.js",import.meta.url,"D1ScrvIqaY");SML.di("./YFXcK0ZyJl.js",import.meta.url,"YFXcK0ZyJl");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./C2l05LS-ga.js",import.meta.url,"C2l05LS-ga");SML.di("./Wt225_9ix9.js",import.meta.url,"Wt225_9ix9");SML.di("./E3QE3c4_Ye.js",import.meta.url,"E3QE3c4_Ye");SML.di("./DbJ72GsAzT.js",import.meta.url,"DbJ72GsAzT");SML.di("./CGFmQ-cmFf.js",import.meta.url,"CGFmQ-cmFf");SML.di("./Bb_6_71M-3.js",import.meta.url,"Bb_6_71M-3");SML.di("./BIvvQbZj9p.js",import.meta.url,"BIvvQbZj9p");SML.di("./Z0tk4vmzIQ.js",import.meta.url,"Z0tk4vmzIQ");SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");SML.di("./Cl1pMDH2OX.js",import.meta.url,"Cl1pMDH2OX");SML.di("./CEs3hLX56z.js",import.meta.url,"CEs3hLX56z");SML.di("./B6Ai7g9fbR.js",import.meta.url,"B6Ai7g9fbR");SML.di("./pA9dwrnd0r.js",import.meta.url,"pA9dwrnd0r");SML.di("./BXUgRcxEAi.js",import.meta.url,"BXUgRcxEAi");SML.di("./w2XkRJ2mzc.js",import.meta.url,"w2XkRJ2mzc");SML.di("./h4Pa0OJr_5.js",import.meta.url,"h4Pa0OJr_5");SML.di("./DFh5Z0Dv0L.js",import.meta.url,"DFh5Z0Dv0L");SML.di("./CCBTR4TAfR.js",import.meta.url,"CCBTR4TAfR");SML.di("./DjACS3kR0A.js",import.meta.url,"DjACS3kR0A");SML.di("./j0TSFgPKaL.js",import.meta.url,"j0TSFgPKaL");SML.di("./DFBfgTBypk.js",import.meta.url,"DFBfgTBypk");SML.di("./0hqgxSo9Jy.js",import.meta.url,"0hqgxSo9Jy");SML.di("./DpoX9fLllS.js",import.meta.url,"DpoX9fLllS");SML.di("./DyRz1vAoTm.js",import.meta.url,"DyRz1vAoTm");SML.di("./DasPtA-dN5.js",import.meta.url,"DasPtA-dN5");SML.di("./DtjwywDamI.js",import.meta.url,"DtjwywDamI");SML.di("./CE5TLxi7Z3.js",import.meta.url,"CE5TLxi7Z3");SML.di("./JaGlTj3I-9.js",import.meta.url,"JaGlTj3I-9");SML.di("./CRzmHkIoo0.js",import.meta.url,"CRzmHkIoo0");
SML.dm("BVpaEkKbzy",["Dw4vb8Yfbm","5r73EsgItq","BkihtVv9so","CFd1NJhleF","CMwg6atOpj","BwcUp7XlaC","FQGvCwaizg","BIzQFHISzm","BwcMg3lXAs","DnNITwgp90","jWC3N3n7Al","CQMf561ZyA","Py9rIF7r2a","KkXqW5RUm3","BAGS8uwlNZ","lxqt5OPiQh","Q1IJQIXJf2","xrDbp1ee_h","B-zFJtiar6","D1ScrvIqaY","YFXcK0ZyJl","D_g7f2Ewyi","C2l05LS-ga","Wt225_9ix9","E3QE3c4_Ye","DbJ72GsAzT","CGFmQ-cmFf","Bb_6_71M-3","BIvvQbZj9p","Z0tk4vmzIQ","C8QDHFSIkY","Cl1pMDH2OX","CEs3hLX56z","B6Ai7g9fbR","pA9dwrnd0r","BXUgRcxEAi","w2XkRJ2mzc","h4Pa0OJr_5","DFh5Z0Dv0L","CCBTR4TAfR","DjACS3kR0A","j0TSFgPKaL","DFBfgTBypk","0hqgxSo9Jy","DpoX9fLllS","DyRz1vAoTm","DasPtA-dN5","DtjwywDamI","CE5TLxi7Z3","JaGlTj3I-9","CRzmHkIoo0"],(async(E,t,e,r)=>{class o{constructor(t){this.onKeyDown=E=>{const t="Escape"===E.key,e="Tab"===E.key,r=Boolean(e&&this.host.shadowRoot&&this.host.input&&this.host.shadowRoot.activeElement===this.host.input),o=e&&!E.shiftKey;t&&E.preventDefault(),(t||r||o)&&this.host.handleBlur()},this.getKeyboardNavigableDropdownItems=()=>{const t=`[role="menuitem"],summary[aria-controls*="${E.gR}"],${r.R}`,e=[];return[this.host.suggestedSearchResultsContainer,this.host.recentSearchesContainer,this.host.trendingSearchesContainer,this.host.typeaheadResultsContainer].forEach((E=>{if(!E)return;E.querySelectorAll(t).forEach((E=>{const t=null!==E.offsetParent&&E.offsetHeight>0,r="SUMMARY"===E.tagName,o=E.closest("faceplate-expandable-section-helper");t&&(r||!o||o.open)&&e.push(E)}))})),e},this.handleDropdownKeyDown=E=>{if("ArrowDown"===E.key||"ArrowUp"===E.key){E.preventDefault();const t=E.target,e=this.getKeyboardNavigableDropdownItems();let r=-1;e.forEach(((E,e)=>{E===t&&(r=e)}));const o="ArrowDown"===E.key?r+1:r-1,T=r>=0&&r<e.length?e[o]:void 0;T?T.focus():this.focusSearchInputWithArrowKeys()}},this.host=t}hostConnected(){this.host.addEventListener("keydown",this.onKeyDown)}hostDisconnected(){this.host.removeEventListener("keydown",this.onKeyDown)}handleKeyDown(E){if(!["ArrowDown","ArrowUp"].includes(E.key))return;E.preventDefault();const t=this.getKeyboardNavigableDropdownItems();0!==t.length&&("ArrowDown"===E.key?t[0].focus():"ArrowUp"===E.key&&t[t.length-1].focus())}focusSearchInputWithArrowKeys(){const E=this.host.input?.shadowRoot?.querySelector("input");E?.focus();const t=E?.value.length;t&&E?.setSelectionRange(t,t)}}let T=class extends e.R{constructor(){super(...arguments),this.handleDropdownKeyDown=E=>{super.handleDropdownKeyDown(E),this.keyboardNavigationController?.handleDropdownKeyDown(E)}}handleFocus(){super.handleFocus(),this.keyboardNavigationController||(this.keyboardNavigationController=new o(this),this.addController(this.keyboardNavigationController))}handleBlur(){super.handleBlur(),this.handleScreenLeaveTracking()}handleKeyDown(E){super.handleKeyDown(E),this.keyboardNavigationController?.handleKeyDown(E)}render(){const r=this.showDropdown&&(this.showAskButton||this.homeRevampEnabled);return t.x` <div class="flex w-100"> <div class="reddit-search-bar rounded-5 flex-1 box-border ${E.Z({"shadow-sm":this.isFocused,"bg-neutral-background-strong":this.isFocused,"bg-secondary-background":!this.isFocused,outline:r,"outline-1":r,"outline-[--color-neutral-border-strong]":r})}" data-faceplate-tracking-context="${JSON.stringify(this.searchTelemetryData)}"> <div class="${E.Z({"pb-[.5rem]":this.showDropdown&&!this.isSearchScopeEnabled,"pb-xs":this.showDropdown&&this.isSearchScopeEnabled,"border-b-sm":this.showDropdown,"border-t-0":this.showDropdown,"border-e-0":this.showDropdown,"border-s-0":this.showDropdown,"border-solid":this.showDropdown,"border-neutral-border-weak":this.showDropdown})}"> <form autocomplete="off" class="flex relative items-center text-neutral-content-strong" @submit="${this.handleSubmit}"> ${this.renderSearchInput(!0)} </form> </div> <div class="max-h-[calc(100vh-var(--shreddit-header-height)-15px-10px)] overflow-y-auto overflow-x-hidden m-t ${E.Z({hidden:!this.showDropdown})}" id="${e.S}"> ${this.renderDropdownContent(!0)} </div> </div> ${this.renderShowFiltersEntryPoint()} </div> `}};T=E._([E.e("reddit-search-large")],T)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("BVyDr1LjSS",["Dw4vb8Yfbm","5r73EsgItq"],(async(s,e)=>{const i=s.a9.PaidUaBlockingModalData;let t=class extends e.s{constructor(){super(...arguments),this.sessionData={dialogShown:!1,sessionStartTime:void 0,isPaidUaSession:!1},this.timeThresholdReached=!1,this.handleCookieBannerHide=s=>{"data-protection-consent-sheet"===s.target.id&&(this.sessionData.dialogShown||this.hasReachedMaxScreenviews()||this.timeThresholdReached)&&this.showDialog()},this.hasReachedMaxScreenviews=()=>s.hn()>=2}static get styles(){return[s.t]}get dialog(){return this.querySelector("rpl-dialog")}connectedCallback(){super.connectedCallback(),this.loadSessionData(),this.isPaidUaSession()&&(document.addEventListener("rpl-dialog-sheet:hide",this.handleCookieBannerHide),this.sessionData.sessionStartTime||this.setSessionStartTime(),this.sessionData.dialogShown||this.hasReachedMaxScreenviews()?requestAnimationFrame((()=>{this.showDialogIfNotCookieBanner()})):this.startTimeTracking())}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("rpl-dialog-sheet:hide",this.handleCookieBannerHide),this.cleanup()}isPaidUaSession(){if(this.sessionData.isPaidUaSession)return!0;return!!new URLSearchParams(window.location.search).has("utm_source","UA")&&(this.sessionData.isPaidUaSession=!0,this.saveSessionData(),!0)}loadSessionData(){const s=sessionStorage.getItem(i);if(s)try{this.sessionData=JSON.parse(s)}catch{this.sessionData={dialogShown:!1,sessionStartTime:Date.now(),isPaidUaSession:this.isPaidUaSession()},this.saveSessionData()}}saveSessionData(){sessionStorage.setItem(i,JSON.stringify(this.sessionData))}showDialogIfNotCookieBanner(){document.querySelector("#data-protection-consent-dialog")||this.showDialog()}setSessionStartTime(){this.sessionData.sessionStartTime=Date.now(),this.saveSessionData()}startTimeTracking(){this.timeCheckInterval=setInterval((()=>{if(this.sessionData.dialogShown)return void this.stopTimeTracking();this.sessionData.sessionStartTime||this.setSessionStartTime();Date.now()-this.sessionData.sessionStartTime>=3e4&&(this.timeThresholdReached=!0,this.showDialogIfNotCookieBanner(),this.stopTimeTracking())}),1e3)}stopTimeTracking(){this.timeCheckInterval&&(clearInterval(this.timeCheckInterval),this.timeCheckInterval=void 0)}showDialog(){this.isPaidUaSession()&&(this.sessionData.dialogShown=!0,this.saveSessionData(),this.dialog?.showModal())}cleanup(){this.stopTimeTracking()}render(){return e.x`<slot></slot>`}};s._([s.h()],t.prototype,"sessionData",void 0),t=s._([s.e("paid-ua-blocking-modal")],t)}));
SML.dm("BWUv70NGv2",[],(async()=>{var t,T,S;return function(t){t.MODERATOR="moderator",t.COMMUNITY_STATUS="community_status"}(t||(t={})),function(t){t.VIEW="view",t.CLICK="click"}(T||(T={})),function(t){t.STATUS_EDIT="status_edit",t.STATUS_CANCEL="status_cancel",t.STATUS_CREATE="status_create",t.STATUS_DELETE="status_delete",t.STATUS_LINK="status_link",t.STATUS_DISPLAY="status_display",t.STATUS_SUB_LINK="subreddit_link"}(S||(S={})),{get A(){return T},get N(){return S},get S(){return t}}}));

SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("BWv2j8jrjX",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,r)=>{var t;!function(e){e.CIRCLE="circle",e.RECTANGLE="rectangle",e.PILL="pill"}(t||(t={}));const i=2500;let s=0,a=null,o=class extends r.s{constructor(){super(...arguments),this.shape=t.RECTANGLE,this.calcDelay=e=>{if(0===e)return 0;let r=0;const t=a?.getAnimations()[0];return t&&(r=t.effect?.getComputedTiming().progress*i),(r+200*e)%i}}static get styles(){return r.a`:host{display:inline-flex}:host([shape=pill]) #loader{border-radius:var(--rem8)}:host([shape=circle]) #loader{border-radius:50%}#loader{background:var(--color-shimmer-background);height:100%;width:100%;position:relative;overflow-x:hidden}#shimmer-object{background:var(--color-shimmer-gradient-overlay);border-radius:.5rem;height:100%;width:200%;position:absolute;top:0;inset-inline-start:0;transform:translateX(-100%)}`}firstUpdated(){this.shimmer(s++)}async shimmer(e){await new Promise((e=>requestAnimationFrame(e)));a||(a=this.shimmerObject);const r={duration:i,delay:-1*this.calcDelay(e),iterations:1/0};this.shimmerObject?.animate([{transform:"translateX(50%)"}],r)}render(){return r.x`<div id="loader"> <span id="shimmer-object"></span> </div> `}};e._([e.n({type:String})],o.prototype,"shape",void 0),e._([e.a2("#shimmer-object")],o.prototype,"shimmerObject",void 0),o=e._([e.e("faceplate-shimmer")],o);var n=Object.freeze({__proto__:null,get FaceplateShimmer(){return o},get LOADER_SHAPES(){return t}});return{get L(){return t},get f(){return n}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./gvWVn4JBWB.js",import.meta.url,"gvWVn4JBWB");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./DWhb02bbsY.js",import.meta.url,"DWhb02bbsY");SML.di("./jTFRatIQcd.js",import.meta.url,"jTFRatIQcd");SML.di("./DLXAqLxSut.js",import.meta.url,"DLXAqLxSut");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./CZLMnmUH44.js",import.meta.url,"CZLMnmUH44");SML.di("./CspnAIpcFE.js",import.meta.url,"CspnAIpcFE");
SML.dm("BX2z6Mar1p",["Dw4vb8Yfbm","gvWVn4JBWB","5r73EsgItq","DWhb02bbsY","jTFRatIQcd","DLXAqLxSut","CZLMnmUH44","CspnAIpcFE","tO6bKRQro7"],(async(t,e,n,a,i,r,o,s)=>{const l=t.W(n.s);let m=class extends l{constructor(){super(...arguments),this.isVisible=!1}connectedCallback(){super.connectedCallback(),this.enableObserver({threshold:1})}disconnectedCallback(){super.disconnectedCallback(),this.disableObserver()}publishEvent(){t.p(t.T.TriggerCommentBlockingAuth,{source:e.C.Scroll})}publishCloseEvent(){t.p(t.T.TriggerCommentBlockingAuth,{source:e.C.Close})}observerIsIntersectingCallback(){this.publishEvent(),this.isVisible=!0}observerIsNotIntersectingCallback(t){const{boundingClientRect:e,rootBounds:n}=t;n&&this.isVisible&&e.top>n.bottom&&(this.isVisible=!1,this.publishCloseEvent())}render(){return n.x`<div></div> `}};m=t._([t.e("cbau-trigger")],m);let d=class extends n.s{constructor(){super(...arguments),this.isCommentPretranslated=!1,this.translationContextValue=t.aQ,this.pubsub=new t.u(this),this.onPostTranslationOverride=t=>{(t.id===this.postId||t.isContextUpdateEvent)&&(this.commentTranslated=t.isTranslationActive)},this.onCommentTranslationOverride=t=>{t.id===this.commentId&&(this.commentTranslated=t.isTranslationActive)},this.handleClick=()=>{if(!this.commentId)return;const e=!this.commentTranslated,n=document.querySelector(`shreddit-comment[thingId*="${this.commentId}"]`),a=o.e({id:this.commentId,parent_id:n?.parentId,post_id:this.postId,score:parseInt(n?.score??"",10)||void 0,type:"comment",created_timestamp:t.cN(n?.created??""),content_type:n?.contentType===s.C.TEXT?void 0:n?.contentType,translation_state:this.commentTranslated,translation_language:document.querySelector(`shreddit-post[id*="${this.postId}"]`)?.translationLanguage});t.i(this,a),this.pubsub.publish(t.T.I18nCommentTranslationOverride,{id:this.commentId,isTranslationActive:e})}}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(t.T.I18nCommentTranslationOverride,this.onCommentTranslationOverride,!1),this.pubsub.subscribe(t.T.I18nPostTranslationOverride,this.onPostTranslationOverride,!0),this.commentTranslated=this.isCommentPretranslated||r.i()}updated(t){r.s({changedProperties:t,translationContextValue:this.translationContextValue,overrideEnabled:this.commentTranslated})&&(this.commentTranslated=this.translationContextValue.isTranslationActive)}render(){return n.x` <rpl-tooltip appearance="inverted" placement="top" trigger="hover focus" content="${this.commentTranslated?"Show original":"Translate"}"> ${t.o({appearance:"plain",attributes:{onclick:this.handleClick,"data-testid":"comment-translation-status-icon","aria-label":"Toggle comment translation"},leadingIcon:this.commentTranslated?i.t({size:n.I.ExtraSmall,attributes:{"data-testid":"comment-translation-status-icon-translated-icon","aria-label":"Comment is translated",className:"text-primary-plain"}}):a.t({size:n.I.ExtraSmall,attributes:{"data-testid":"comment-translation-status-icon-original-icon","aria-label":"Comment is in original language",className:"text-primary-plain"}}),size:t.q.ExtraSmall})} </rpl-tooltip> `;}};d.styles=[t.t],t._([t.h()],d.prototype,"commentTranslated",void 0),t._([t.n({type:String,attribute:"comment-id"})],d.prototype,"commentId",void 0),t._([t.n({type:String,attribute:"post-id"})],d.prototype,"postId",void 0),t._([t.n({type:Boolean,attribute:"comment-pretranslated"})],d.prototype,"isCommentPretranslated",void 0),t._([t.aP({context:t.aR,subscribe:!0}),t.h()],d.prototype,"translationContextValue",void 0),d=t._([t.e("comment-translation-status-icon")],d);let c=class extends n.s{constructor(){super(...arguments),this.commentId="",this.dedupe=!1,this.shouldTrackPosition=!1,this.pubsub=new t.u(this),this.loadInAd=()=>{const t=this.shouldTrackPosition?this:this.shadowRoot;if(!t||t.childNodes.length>0)return;const e=document.querySelector(`shreddit-comment-tree-ads > template#comment-tree-ad_${this.commentId}`),n=e?.content.querySelector("shreddit-comments-page-ad");e&&n&&this.isNotADuplicate(n)&&(t.replaceChildren(e.content.cloneNode(!0)),n.hasAttribute("is-blank")||this.removeAttribute("class"))},this.isNotADuplicate=t=>{if(!this.dedupe||t.hasAttribute("is-blank"))return!0;const e=document.querySelector("shreddit-comments-page-ad");return!e||t.getAttribute("campaign-id")!==e.getAttribute("campaign-id")}}createRenderRoot(){return this.shouldTrackPosition?this:super.createRenderRoot()}connectedCallback(){super.connectedCallback(),this.commentId&&(this.loadInAd(),this.pubsub.subscribe(t.T.CommentTreeAdsLoaded,this.loadInAd))}render(){return n.A}};c.styles=[t.t],t._([t.n({type:String,attribute:"comment-id"})],c.prototype,"commentId",void 0),t._([t.n({type:Boolean,attribute:"dedupe"})],c.prototype,"dedupe",void 0),t._([t.n({type:Boolean,attribute:"should-track-position"})],c.prototype,"shouldTrackPosition",void 0),c=t._([t.e("shreddit-comment-tree-ad")],c)}));
SML.di("./DgFeZwOkXZ.js",import.meta.url,"DgFeZwOkXZ");SML.di("./CIOo61duNV.js",import.meta.url,"CIOo61duNV");SML.di("./Dr5Tgf4HIv.js",import.meta.url,"Dr5Tgf4HIv");SML.di("./CF6nQkAyW-.js",import.meta.url,"CF6nQkAyW-");SML.di("./C-yoNTAv-M.js",import.meta.url,"C-yoNTAv-M");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./DOqOHj9jA9.js",import.meta.url,"DOqOHj9jA9");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./DoSzdRrY_z.js",import.meta.url,"DoSzdRrY_z");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./BQbrDNllG4.js",import.meta.url,"BQbrDNllG4");SML.di("./CpZ44pmnxI.js",import.meta.url,"CpZ44pmnxI");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./Df3SFBpZLO.js",import.meta.url,"Df3SFBpZLO");SML.di("./DnNITwgp90.js",import.meta.url,"DnNITwgp90");SML.di("./BTnwE85rpZ.js",import.meta.url,"BTnwE85rpZ");SML.di("./JaGlTj3I-9.js",import.meta.url,"JaGlTj3I-9");SML.di("./DCbB57ubLb.js",import.meta.url,"DCbB57ubLb");SML.di("./lEw4CeTWZd.js",import.meta.url,"lEw4CeTWZd");SML.di("./CqGTWb5M_i.js",import.meta.url,"CqGTWb5M_i");SML.di("./Dw4K28bgT7.js",import.meta.url,"Dw4K28bgT7");SML.di("./CQMf561ZyA.js",import.meta.url,"CQMf561ZyA");SML.di("./BwcUp7XlaC.js",import.meta.url,"BwcUp7XlaC");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./CBbxnHsw2W.js",import.meta.url,"CBbxnHsw2W");SML.di("./CEs3hLX56z.js",import.meta.url,"CEs3hLX56z");SML.di("./Cl1pMDH2OX.js",import.meta.url,"Cl1pMDH2OX");SML.di("./B6Ai7g9fbR.js",import.meta.url,"B6Ai7g9fbR");SML.di("./pA9dwrnd0r.js",import.meta.url,"pA9dwrnd0r");SML.di("./BXUgRcxEAi.js",import.meta.url,"BXUgRcxEAi");SML.di("./w2XkRJ2mzc.js",import.meta.url,"w2XkRJ2mzc");SML.di("./h4Pa0OJr_5.js",import.meta.url,"h4Pa0OJr_5");SML.di("./DFh5Z0Dv0L.js",import.meta.url,"DFh5Z0Dv0L");SML.di("./DS9WepT8W8.js",import.meta.url,"DS9WepT8W8");SML.di("./DZO4dWmzHb.js",import.meta.url,"DZO4dWmzHb");SML.di("./CE5TLxi7Z3.js",import.meta.url,"CE5TLxi7Z3");SML.di("./CRzmHkIoo0.js",import.meta.url,"CRzmHkIoo0");SML.di("./CUIVPWsUpf.js",import.meta.url,"CUIVPWsUpf");SML.di("./DgW4ULLwQ1.js",import.meta.url,"DgW4ULLwQ1");SML.di("./BWv2j8jrjX.js",import.meta.url,"BWv2j8jrjX");SML.di("./Py9rIF7r2a.js",import.meta.url,"Py9rIF7r2a");SML.di("./D_6DXw1u0k.js",import.meta.url,"D_6DXw1u0k");SML.di("./CMwg6atOpj.js",import.meta.url,"CMwg6atOpj");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./w2XkRJ2mzc.js",import.meta.url,"w2XkRJ2mzc");
SML.dm("BXUgRcxEAi",["Dw4vb8Yfbm","w2XkRJ2mzc"],(async(t,e)=>{const{svg:i}=t.a(),l=t.m(i`<path d="M3.018 13.566a3.858 3.858 0 01-1.483-1.462A4.09 4.09 0 011 10.027c0-.774.183-1.474.551-2.102A3.939 3.939 0 013.09 6.44c.657-.361 1.407-.542 2.247-.542a4.753 4.753 0 011.642.29.813.813 0 01.473 1.08l-.011.028a.818.818 0 01-1.058.43l-.094-.034a3.025 3.025 0 00-1.001-.166c-.469 0-.894.1-1.274.302a2.27 2.27 0 00-.9.86c-.22.373-.33.806-.33 1.299 0 .486.105.92.314 1.304.209.384.496.682.861.897.365.214.775.32 1.231.32.37 0 .705-.07 1.003-.212.298-.142.532-.34.701-.591a1.47 1.47 0 00.249-.847H5.687a.74.74 0 110-1.48h2.4a.74.74 0 01.742.74v.55c0 .65-.151 1.236-.451 1.756-.3.52-.727.93-1.281 1.228-.554.299-1.197.447-1.928.447-.8 0-1.517-.178-2.15-.534h-.001zm7.082-.453V6.887c0-.49.403-.887.9-.887s.9.397.9.887v6.226c0 .49-.403.887-.9.887a.894.894 0 01-.9-.887zm3.918.094V6.792c0-.438.355-.793.794-.793h3.394a.793.793 0 110 1.586h-2.405v1.83h1.921a.793.793 0 110 1.586h-1.921v2.207a.793.793 0 01-.794.793h-.195a.793.793 0 01-.794-.793v-.001z"></path>`,"0 0 20 20","gif"),{svg:s}=t.a(),a=t.m(s`<path d="M6.348 1.5c-1.66 0-3.2 1.32-3.2 3.2v10.6c0 1.87 1.54 3.2 3.2 3.2.57 0 1.16-.16 1.7-.5l8.32-5.3c1.97-1.25 1.97-4.13 0-5.39L8.048 2c-.54-.35-1.13-.5-1.7-.5z"></path>`,"0 0 20 20","play-fill");var h=Object.freeze({__proto__:null,ToggleableVideoAdController:class{constructor(e,i){this.expandVideoPlayer=()=>{this.toggleElVisibility(this.videoPlayerEl,!0),this.toggleElVisibility(this.thumbnailContainerEl,!1),this.toggleElVisibility(this.thumbnailImageEl,!1),this.toggleElVisibility(this.thumbnailPlayBtnEl,!1),setTimeout((()=>{this.shredditPlayer&&this.updateVideoAdMeasurerDimensions(this.shredditPlayer.offsetHeight,this.shredditPlayer.offsetWidth)}),300)},this.hideVideoPlayer=()=>{this.toggleElVisibility(this.videoPlayerEl,!1),this.toggleElVisibility(this.thumbnailContainerEl,!0),this.toggleElVisibility(this.thumbnailImageEl,!0),this.toggleElVisibility(this.thumbnailPlayBtnEl,!0),this.shredditPlayer?.mediaUI?.hasAttribute(t.h9.PLAYING)&&this.host.dispatchEvent(new CustomEvent(t.fd,{detail:{currentTime:this.shredditPlayer?.videoElement.currentTime,duration:this.shredditPlayer?.videoElement.duration}}))},(this.host=e).addController(this),this.updateVideoAdMeasurerDimensions=i}get videoPlayerEl(){return this.host.querySelector(`.${e.E}`)}get videoPlayerCloseBtnEl(){return this.host.querySelector(`.${e.V}`)}get thumbnailContainerEl(){return this.host.querySelector(`.${e.T}`)}get thumbnailImageEl(){return this.host.querySelector(`.${e.a}`)}get thumbnailPlayBtnEl(){return this.host.querySelector(`.${e.b}`)}get shredditPlayer(){return t.bw.map((t=>this.host.querySelector(t))).find((t=>null!==t))||null}toggleElVisibility(t,i){if(null===t)return;const l=i?t.dataset[e.c]:t.dataset[e.d];l&&l?.split(" ").forEach((e=>{t.classList.remove(e)}));const s=i?t.dataset[e.d]:t.dataset[e.c];s&&s?.split(" ").forEach((e=>{t.classList.add(e)}))}async hostConnected(){this.host.adType===t.f9.VIDEO&&(this.thumbnailContainerEl?.addEventListener("click",this.expandVideoPlayer),this.videoPlayerCloseBtnEl?.addEventListener("click",this.hideVideoPlayer))}hostDisconnected(){this.host.adType===t.f9.VIDEO&&(this.thumbnailContainerEl?.removeEventListener("click",this.expandVideoPlayer),this.videoPlayerCloseBtnEl?.removeEventListener("click",this.hideVideoPlayer))}}});return{g:l,get i(){return h},p:a}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("BYpE6FdcdE",["Dw4vb8Yfbm","5r73EsgItq"],(async(a,e)=>{class i extends Error{constructor(a,e){super(a),this.name="UpsertWikiPageLimiterError",this.rateLimitEndsAt=e}}const n={PermissionDenied:()=>"You don't have permission to save the page",ResourceExhausted:()=>"You need to wait a bit before updating the page again",Unauthenticated:()=>"You need to sign in to change this page",InvalidArgument:()=>"The page you're saving is malformed"},t={"page name is special":()=>"Page name is reserved","page name is too long or too short":()=>"Page name is too long or too short","page name is restricted":()=>"Page name is restricted","page name has too many namespaces":()=>"Page is nested too deep (maximum: 3 levels)","page content is too long":()=>"Page content is too long","page content is empty":()=>"Page content can't be empty"};a.d9(e.a`rpl-modal-card.confirmation-modal-card.full-width-buttons::part(footer){display:block}`);let r=class extends e.s{constructor(){super(...arguments),this.dialogId="confirmation-modal",this.message="",this.title="Are you sure?",this.confirmText="Confirm",this.cancelText="Cancel",this.confirmButtonAppearance="destructive",this.cancelButtonAppearance="secondary",this.alignActions="stretch",this.ariaHidden="true",this.modal=a.a3(),this._onConfirmCallback=()=>{},this.onConfirm=a=>{a.stopPropagation(),this._onConfirmCallback(),this.close()},this.onCancel=a=>{a?.stopPropagation(),this._onCancelCallback?.(),this.close()}}static get styles(){return[a.t]}show(a,e){this._onConfirmCallback=a,this._onCancelCallback=e,this.modal.value?.showModal(),this.ariaHidden="false"}close(){this.modal.value?.hide(),this.ariaHidden="true"}confirm(a){return this.modal.value?.open?Promise.reject("Modal already open"):(a?.title&&(this.title=a.title),a?.message&&(this.message=a.message),new Promise((a=>{this.show((()=>a(!0)),(()=>a(!1)))})))}renderModalContent(){const i=`min-h-[auto] confirmation-modal-card ${this.modalClassName??""}`;return e.x` <rpl-modal-card class="${i} ${"stretch"===this.alignActions?"full-width-buttons":""}" aria-labelledby="${this.dialogId}-title" aria-describedby="${this.dialogId}-desc"> <div slot="title" id="${this.dialogId}-title">${this.title}</div> ${this.message?e.x`<p id="${this.dialogId}-desc">${this.message}</p>`:e.A} ${this.litTemplateBody?this.litTemplateBody:e.A} ${a.o({size:a.q.Medium,appearance:this.confirmButtonAppearance,children:this.confirmText,attributes:{className:"stretch"===this.alignActions?"flex-1":void 0,onclick:this.onConfirm,type:"button",id:"confirmation-modal-confirm",slot:"primary-button"}})} ${a.o({size:a.q.Medium,appearance:this.cancelButtonAppearance,children:this.cancelText,attributes:{slot:"secondary-button",className:"stretch"===this.alignActions?"flex-1":void 0,onclick:this.onCancel,type:"button",id:"confirmation-modal-cancel"}})} ${a.o({appearance:"secondary",leadingIcon:a.al({size:e.I.Small}),size:a.q.Small,attributes:{slot:"close-button",onclick:this.onCancel,type:"button",id:"confirmation-modal-close","aria-label":"Close modal"}})} </rpl-modal-card>`;}render(){return e.x` <rpl-dialog dialog-id="${this.dialogId}" @rpl-dialog:hide="${()=>this.onCancel()}" ${a.a4(this.modal)} .litTemplateChildren="${this.renderModalContent()}"> </rpl-dialog>`}};return a._([a.n({type:String,attribute:"dialog-id"})],r.prototype,"dialogId",void 0),a._([a.n({type:String})],r.prototype,"message",void 0),a._([a.n({attribute:!1})],r.prototype,"litTemplateBody",void 0),a._([a.n({type:String})],r.prototype,"title",void 0),a._([a.n({type:String,attribute:"confirm-text"})],r.prototype,"confirmText",void 0),a._([a.n({type:String,attribute:"cancel-text"})],r.prototype,"cancelText",void 0),a._([a.n({attribute:"confirm-button-appearance"})],r.prototype,"confirmButtonAppearance",void 0),a._([a.n({attribute:"cancel-button-appearance"})],r.prototype,"cancelButtonAppearance",void 0),a._([a.n({attribute:"modal-class"})],r.prototype,"modalClassName",void 0),a._([a.n({attribute:"align-actions"})],r.prototype,"alignActions",void 0),a._([a.n({attribute:"aria-hidden",reflect:!0})],r.prototype,"ariaHidden",void 0),r=a._([a.e("confirmation-modal")],r),{U:i,u:async function({subredditName:e,content:r,page:o,reason:s,postToCommunity:l,pageTitle:d}){const u={input:{page:o,subredditName:e,reason:s,content:r,postToCommunity:l,pageTitle:d}},p=await a.Y({operation:a.O.UpsertWikiPage,variables:u});if(p.errors.length>0)throw new Error("Received invalid data from upsertWikiPageMutation GQL query");const{ok:m,errors:g,fieldErrors:c,isRateLimited:k,rateLimitEndsAt:h}=p.data.upsertWikiPage;if(!m){const a=((a,e)=>a?a in t?t[a]():a:e&&e in n?n[e]():"Failed to edit Wiki Page")((c?.[0]?.message||g?.[0]?.message)??null,(c?.[0].code||g?.[0]?.code)??null);if(k&&h)throw new i(a,h);throw new Error(a)}return {success:!0,...(k&&h ? {isRateLimited:!0,rateLimitEndsAt:h} : {})};}};}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("BYzqEZ3uv3",["Dw4vb8Yfbm","5r73EsgItq","Cv4mWnWE30","B-zFJtiar6"],(async(e,t,n,s)=>{let i=class extends t.s{constructor(){super(...arguments),this.position="bottom-middle",this.triggerEvent="click",this.disabled=!1,this.manualTriggerFocus=!1,this.containerElement=document.documentElement,this.scrollContainerElement=window,this.onopen=null,this.onclose=null,this.emitter=s.n(this),this._popperController=new n.P(this,{position:this.position,referenceElementKey:"referenceElement",popperElementKey:"_menu",containerElement:this.containerElement,scrollContainerElement:this.scrollContainerElement,manualTriggerFocus:this.manualTriggerFocus}),this._eventUsedMap=new WeakMap,this.updated=e=>{e.has("position")&&this._popperController.updateOptions({position:this.position}),e.has("manualTriggerFocus")&&this._popperController.updateOptions({manualTriggerFocus:this.manualTriggerFocus})},this.handleDocumentClick=e=>{if(!(e.target instanceof Element)||this.hidden)return;const t=e.target.closest('[slot="menu"]'),n=this._eventUsedMap.has(e);null!==t||n||this.close()},this.handleEscape=e=>{"Escape"===e.key&&this.close(e)},this.addListenersWhileOpened=()=>{document.addEventListener("click",this.handleDocumentClick),document.addEventListener("keydown",this.handleEscape)},this.cleanupListenersWhileOpened=()=>{document.removeEventListener("click",this.handleDocumentClick),document.removeEventListener("keydown",this.handleEscape)},this.show=e=>{this.hidden=!1,this.emitter.dispatch("open"),this._menu.style.pointerEvents="auto",this._popperController.currentState.animationFinished.then((()=>{this.addListenersWhileOpened(),this.emitter.dispatch("opened")})),this.onopen?.(e??new Event("faceplate-dropdown-menu-show"))},this.close=(e,t)=>{!0===t?.disableRestoreFocus&&this._popperController.updateOptions({manualTriggerFocus:!0}),this.cleanupListenersWhileOpened(),this.hidden=!0,this.emitter.dispatch("close"),this._menu.style.pointerEvents="none",this._popperController.currentState.animationFinished.then((()=>{this.emitter.dispatch("closed"),this._popperController.updateOptions({manualTriggerFocus:this.manualTriggerFocus})})),this.onclose?.(e??new Event("faceplate-dropdown-menu-open"))},this.toggle=e=>{this.hidden?this.show(e):this.close(e)},this.handleClick=this.disabledHandler((e=>{this._eventUsedMap.set(e,!0),"click"===this.triggerEvent&&(this.hidden?this.show(e):this.close(e))})),this.handleMouseenter=this.disabledHandler((e=>{"hover"===this.triggerEvent&&this.show(e)})),this.handleMouseleave=this.disabledHandler((e=>{"hover"===this.triggerEvent&&this.close(e)})),this.handleFocusOut=this.disabledHandler((e=>{!this.hidden&&e.relatedTarget instanceof HTMLElement&&!o(this,e.relatedTarget)&&this.close(e,{disableRestoreFocus:!0})}))}get referenceElement(){return this.shadowRoot?.querySelector("#trigger")?.assignedElements()[0]??this}static get styles(){return[t.a`:host{--faceplate-dropdown-menu-z-index:1000;display:flex}#menu{border-radius:var(--rem8);box-shadow:0 4px 8px 0 rgba(0,0,0,.1),0 6px 12px 0 rgba(0,0,0,.25);display:inline-flex;justify-content:center;overflow:hidden;width:max-content;z-index:var(--faceplate-dropdown-menu-z-index);outline-offset:-1px}`,n.P.defaultPopperContentStyles]}get hidden(){return"closed"===this._popperController.currentState.state}set hidden(e){!0===e?this._popperController.close():this._popperController.open()}connectedCallback(){super.connectedCallback(),this.classList.add("connected")}firstUpdated(){this._menu&&(this._menu.style.pointerEvents="none")}disconnectedCallback(){super.disconnectedCallback(),this.cleanupListenersWhileOpened()}disabledHandler(e){return t=>{this.disabled||e(t)}}render(){return t.x` <slot id="trigger" aria-describedby="menu" faceplate-popper-trigger aria-controls="menu" @click="${this.handleClick}" @mouseenter="${this.handleMouseenter}" @mouseleave="${this.handleMouseleave}" @focusin="${this.handleMouseenter}" @focusout="${this.handleMouseleave}"></slot> <article id="menu" faceplate-popper-content @focusout="${this.handleFocusOut}"> <slot name="menu"></slot> </article> `}};e._([e.n({type:String})],i.prototype,"position",void 0),e._([e.n({type:String,attribute:"trigger-event"})],i.prototype,"triggerEvent",void 0),e._([e.n({type:Boolean})],i.prototype,"disabled",void 0),e._([e.n({type:Boolean,attribute:"manual-trigger-focus"})],i.prototype,"manualTriggerFocus",void 0),e._([e.a2("#menu")],i.prototype,"_menu",void 0),e._([e.a2("#trigger")],i.prototype,"_trigger",void 0),i=e._([e.e("faceplate-dropdown-menu")],i);const o=(e,t)=>{if(!e||!t)return!1;if(e===t)return!0;if(0===e.childElementCount&&!(e instanceof HTMLSlotElement))return!1;if(e.contains(t))return!0;if(e instanceof HTMLSlotElement&&e.assignedElements().some((e=>o(e,t))))return!0;if(e instanceof Element&&e.shadowRoot&&o(e.shadowRoot,t))return!0;for(const n of e.querySelectorAll("slot"))if(n.assignedElements().some((e=>o(e,t))))return!0;return!1};return{get F(){return i},a:({attributes:t,children:n})=>{const{html:s,createElement:i}=e.a();return i("li",{...t,booleanListItemGroup:!0,className:"list-none",rpl:!0},s`<ul class="p-0"> ${n} </ul>`)},l:({attributes:t,children:n,trailingSlot:s})=>{const{html:i,createElement:o}=e.a();return o("li",{...t,booleanListItemHeader:!0,className:"flex items-center m-0 pe-md h-2xl min-w-0 text-secondary text-label-2",rpl:!0},i`<span class="grow min-w-0 px-sm truncate">${n}</span> ${s?i`<span class="flex items-center">${s}</span> `:void 0}`)}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./ClaQym8zez.js",import.meta.url,"ClaQym8zez");
SML.dm("BaxkLfaoug",["Dw4vb8Yfbm","5r73EsgItq","Cv4mWnWE30","B-zFJtiar6","ClaQym8zez"],(async(e,t,s,i,o)=>{const r=new WeakSet,n=async(t,{includeShadowRoot:s=!1}={})=>{const i="faceplate-partial",o=Array.from(t.querySelectorAll(i));s&&o.push(...Array.from(t.shadowRoot?.querySelectorAll(i)??[]));return(await Promise.all(o.map((async t=>!t||r.has(t)||t.loading!==e.y.Programmatic?Promise.resolve(!1):(r.add(t),t.load().then((()=>!0))))))).filter(Boolean).length>0},a=e=>t=>(e(t),t);let h=class extends o.FaceplateTooltip{constructor(){super(...arguments),this.mouseEnterDelay=750,this.mouseLeaveDelay=500,this.closeOnTrack=!1,this.disableTouchActivation=!1,this.partialLoading=e.y.Action,this.label="",this.mouseOnly=!1,this.sleepAfterEscape=!1,this.enterTimeout=-1,this.leaveTimeout=-1,this._popperController=new s.P(this,{position:this.position,referenceElementKey:"referenceElement",popperElementKey:"_tooltip"}),this._isHandlingTouch=!1,this.cleanupTimeouts=()=>{this.enterTimeout=this.leaveTimeout=-1},this.triggerEvent="hover",this.emitter=i.n(this),this.handleFocusOut=e=>{const t=e.relatedTarget;this.hidden||this.hasUserInteraction(t)||(this.close(),this.anchorEl&&(this.sleepAfterEscape=!0,this.anchorEl?.focus({preventScroll:!0})))},this.rplHovercardShowHandler=e=>{e.target===this||this.hidden||this.close()},this.onEscape=e=>{"Escape"===e.key&&(this.sleepAfterEscape=!0,this.close(),this.trigger?.focus())},this.mouseOverTrigger=e=>{this.setAttribute("trigger","mouse"),this.handleMouseenter(e)},this.handleClick=e=>{"hover"===this.triggerEvent&&this._isHandlingTouch&&this.disableTouchActivation&&(this.cleanupTimeouts(),this._isHandlingTouch=!1),super.handleClick(e)},this.handleTouchstart=()=>{this._isHandlingTouch=!0},this.handleMouseenter=t=>{if(this.mouseOnly&&"focusin"===t?.type)return;if(this.sleepAfterEscape)return void(this.sleepAfterEscape=!1);if(!this.hidden)return this.cleanupTimeouts();this.emitter.dispatch("entered"),this.partialLoading===e.y.Intent&&this.load();const s=window.setTimeout((()=>{s===this.enterTimeout&&this.hasUserInteraction()&&this.show()}),this.mouseEnterDelay);this.enterTimeout=s,document.addEventListener("keydown",this.onEscape),t?.currentTarget?.addEventListener("mouseleave",this.handleMouseleave,{once:!0})},this.handleMouseleave=()=>{if(this.hidden)return this.cleanupTimeouts();const e=window.setTimeout((()=>{e===this.leaveTimeout&&this.close()}),this.mouseLeaveDelay);this.leaveTimeout=e},this.handleMouseEnterTooltip=()=>{this.cleanupTimeouts()},this.handleMouseLeaveTooltip=()=>{this.handleMouseleave(),document.removeEventListener("keydown",this.onEscape)},this.handleFaceplateTrack=()=>{this.closeOnTrack&&this.close()},this.handleSlotChange=()=>{this.initializeFocusManager(),!this.hidden&&this.focusManager?.focus()},this.initializeFocusManager=()=>{this.content&&(this.focusManager=new e.aJ(this,this.content))},this.render=()=>{const s=this._popperController.actualPosition||this.position;return t.x` <slot aria-describedby="faceplate-tooltip" faceplate-popper-trigger @click="${this.handleClick}" @touchstart="${this.handleTouchstart}" @mouseenter="${this.mouseOverTrigger}" @mouseleave="${this.handleMouseleave}" @focusin="${this.handleMouseenter}" @focusout="${this.handleMouseleave}"></slot> <div aria-label="${e.ad((this.label||this.ariaLabel)??void 0)}" id="faceplate-tooltip" role="dialog" part="content-container" position="${s}" @keydown="${this.handleKeydown}" @mouseenter="${this.handleMouseEnterTooltip}" @mouseleave="${this.handleMouseLeaveTooltip}" @focusin="${this.handleMouseEnterTooltip}" @focusout="${this.handleMouseLeaveTooltip}" @slotchange="${this.handleSlotChange}" faceplate-popper-content> <slot name="content" @faceplate-track="${this.handleFaceplateTrack}"></slot> </div> `}}get content(){return this.contents[0]??null}get trigger(){return this.anchorEl??this.triggers[0]??null}get anchorEl(){try{if(this.anchor&&"string"==typeof this.anchor){return this.getRootNode().getElementById(this.anchor)}return this.anchor instanceof HTMLElement?this.anchor:null}catch{return null}}get referenceElement(){return this.trigger??this}setupAnchorElListeners(){const{anchorEl:e}=this;e&&(e.addEventListener("click",this.handleClick),e.addEventListener("touchstart",this.handleTouchstart),e.addEventListener("mouseenter",this.mouseOverTrigger),e.addEventListener("mouseleave",this.handleMouseleave),e.addEventListener("focusin",this.handleMouseenter),e.addEventListener("focusout",this.handleMouseleave))}cleanupAnchorElListeners(){const{anchorEl:e}=this;e&&(e.removeEventListener("click",this.handleClick),e.removeEventListener("touchstart",this.handleTouchstart),e.removeEventListener("mouseenter",this.mouseOverTrigger),e.removeEventListener("mouseleave",this.handleMouseleave),e.removeEventListener("focusin",this.handleMouseenter),e.removeEventListener("focusout",this.handleMouseleave))}hasUserInteraction(e){const t=Boolean(this.querySelector(":hover")||this.trigger?.matches(":hover")),s=Boolean(e&&(this.contains(e)||this.trigger?.contains(e))||this.querySelector(":focus")||this.trigger?.matches(":focus"));return t||s}hovercardShowHandler(e){e.target!==this&&this.close()}load(){return n(this).then(a(this._popperController.reposition)).then(a((e=>{this.hidden||e&&(this.focusManager?.refresh(),this.focusManager?.focus())})))}async show(){super.show(),this.partialLoading===e.y.Action&&this.load(),await this._popperController.currentState.animationFinished,this.focusManager?.focus(),this.addEventListener("focusout",this.handleFocusOut),document.addEventListener(this.emitter.eventId("open"),this.hovercardShowHandler),document.addEventListener("rpl-hovercard:show",this.rplHovercardShowHandler),this.cleanupTimeouts()}async close(){const e=super.close();document.removeEventListener(this.emitter.eventId("open"),this.hovercardShowHandler),document.removeEventListener("rpl-hovercard:show",this.rplHovercardShowHandler),this.cleanupTimeouts(),await e,this.removeTrigger()}removeTrigger(){this.removeAttribute("trigger")}handleKeydown(){this.removeTrigger()}connectedCallback(){super.connectedCallback(),this.setupAnchorElListeners()}disconnectedCallback(){this.cleanupAnchorElListeners(),super.disconnectedCallback(),this.cleanupTimeouts()}static get styles(){return[...super.styles,t.a`:host{display:contents}#faceplate-tooltip{display:flex;flex-direction:column;width:fit-content;justify-content:flex-start;align-items:flex-start;box-sizing:border-box;border-radius:1rem;box-shadow:var(--elevation-md);z-index:var(--faceplate-hovercard-z-index,1)}#faceplate-tooltip::after{display:none}`]}};e._([e.n({type:String})],h.prototype,"anchor",void 0),e._([e.l({slot:""})],h.prototype,"triggers",void 0),e._([e.l({slot:"content"})],h.prototype,"contents",void 0),e._([e.n({type:Number,attribute:"enter-delay"})],h.prototype,"mouseEnterDelay",void 0),e._([e.n({type:Number,attribute:"leave-delay"})],h.prototype,"mouseLeaveDelay",void 0),e._([e.n({type:Boolean,attribute:"close-on-track"})],h.prototype,"closeOnTrack",void 0),e._([e.n({type:Boolean,attribute:"disable-touch-activation",reflect:!0})],h.prototype,"disableTouchActivation",void 0),e._([e.n({type:String,attribute:"partial-loading"})],h.prototype,"partialLoading",void 0),e._([e.n({type:String})],h.prototype,"label",void 0),e._([e.n({type:Boolean,attribute:"mouse-only"})],h.prototype,"mouseOnly",void 0),e._([e.h()],h.prototype,"sleepAfterEscape",void 0),h=e._([e.e("faceplate-hovercard")],h);var l=Object.freeze({__proto__:null,get FaceplateHovercard(){return h}});return{get F(){return h},get f(){return l},l:n,s:a}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./BIvvQbZj9p.js",import.meta.url,"BIvvQbZj9p");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./Z0tk4vmzIQ.js",import.meta.url,"Z0tk4vmzIQ");SML.di("./Cl1pMDH2OX.js",import.meta.url,"Cl1pMDH2OX");
SML.dm("Bb_6_71M-3",["Dw4vb8Yfbm","BIvvQbZj9p","B-zFJtiar6","Z0tk4vmzIQ","Cl1pMDH2OX"],(async(e,t,i,s)=>{const r=new Set(["t3_103b4tl","t3_u1cuyg","t3_103bmpv","t3_xipqoc","t3_xipsi3"]);function a(e){const t=new Map;return e.forEach((e=>{const i=t.get(e.type)||[];i.push(e),t.set(e.type,i)})),t}function n(e){return!!e.encryptedTrackingId}function o(e,t){return e.encryptedTrackingId+t.additionalEventMetadata}function h({pixelEvent:e,pixelRequestBody:t,metadata:i,target:s}){if(!e.encryptedTrackingId)return;if(l(e.type))return o(e,t);const r=i?function(e){return Object.entries(e).reduce(((e,[t,i])=>(e[t]=i.toString(),e)),{})}(i):{};return fetch("https://alb.reddit.com/track",{method:"POST",mode:"no-cors",body:JSON.stringify({encryptedTrackingId:e.encryptedTrackingId,encryptedTrackingPayload:t.encryptedTrackingPayload,additionalEventMetadata:t.additionalEventMetadata,clientImpressionID:t.impressionId,...r})}).then((()=>{m(s,"succeeded",e)})).catch((t=>{const i="Sentry"in window?window.Sentry:void 0;i?.captureException&&i.captureException(new Error(`Error in POST response from pixel server for pixel of type ${e.type}: ${t}`)),m(s,"failed",e)})),o(e,t)}function d(t){return!!e.eO.includes(t)||e.eP.some((({experimentName:i,pixelEventTypes:s})=>e.aA(i)&&s.includes(t)))}function l(t){return e.eQ.some((({experimentName:i,pixelEventTypes:s})=>e.aA(i)&&s.includes(t)))}function u({pixelEvent:t,impressionId:s,displayMetadata:r,videoMetadata:a,pixelRequestBody:o}){const h=e.eR[t.type];if(!h)return;const d=new URLSearchParams(e.ep.search).get(e.eS),l={impression_id:s,event_timestamp:Math.floor(Date.now()),display_metadata:r,video_metadata:a,additional_metadata:o.additionalEventMetadata,...null!==d&&{test_id:d}};if(n(t))l.encrypted_tracking_id=t.encryptedTrackingId,l.encrypted_tracking_payload=o.encryptedTrackingPayload;else{if(!i.ae(t.url))return;const{encryptedTrackingId:e,encryptedTrackingPayload:s}=function(e){const t=new URL(e);return{encryptedTrackingPayload:t.searchParams.get("za")||"",encryptedTrackingId:t.searchParams.get("zp")||""}}(t.url);l.encrypted_tracking_id=e,l.encrypted_tracking_payload=s}const u={client_ad_event_metadata:l,video_watch_metadata:e.eT[t.type],vendor_fully_in_view_metadata:e.eU[t.type],screen:{height:window.screen.height,width:window.screen.width}},m=document.querySelector("shreddit-app");m&&e.i(m,e.b(h,u))}function m(t,s,r){if(e.aA(e.eV))return;if(!n(r)&&!i.ae(r.url))return;const a=e.eW({name:"ads_igif_requests_total",value:1,label_values:[`tracking_type,${e.ch[r.type]}`,`request_stage,${s}`]});e.i(t,a)}class c{constructor(t,i){this.impressionTimestamp=0,this.wasEverViewableTimer={fired:!1},this.largeAdFullViewTimer={fired:!1},this.hasDispatchedViewEvent=!1,this.resetTimers=()=>{for(const e of this.pixelTimers.keys())this.clearPixelTimer(e);for(const e of this.continuousTimers.keys())this.unsetContinuousTimer(e);for(const e of this.cumulativeTimers.keys())this.pauseCumulativeTimer(e);this.wasEverViewableTimer.timer&&(clearTimeout(this.wasEverViewableTimer.timer),this.wasEverViewableTimer.timer=void 0),this.largeAdFullViewTimer.timer&&(clearTimeout(this.largeAdFullViewTimer.timer),this.largeAdFullViewTimer.timer=void 0)},this.pixelFiringController=i,this.getFiredRedditPixelsCount=t.getFiredRedditPixelsCount,this.postId=t.postId,this.impressionId=t.impressionId,this.postElement=t.postElement,this.galleryItems=t.galleryItems,this.pixelTimers=new Map,this.cumulativeTimers=new Map,this.continuousTimers=new Map,this.setupUnloadFiring(),this.isProductAd=t.events.some((t=>t.type===e.ch.PRODUCT_CLICK||t.type===e.ch.PRODUCT_IMPRESSION))}setupUnloadFiring(){if(window.addEventListener(e.aE.eventType,(()=>this.handleUnload())),r.has(this.postId)){const t=new URLSearchParams(e.ep.search),i=Number.parseInt(t.get(e.eX)||"");isNaN(i)||window.setTimeout((()=>this.fireUnloadPixel()),i)}}getCumulativeTimes(t){const i=this.updateCumulativeTimer(e.er.ANY_TOTAL_VIEW_TIME,t),s=this.updateCumulativeTimer(e.er.FIFTY_TOTAL_VIEW_TIME,t),r=this.updateCumulativeTimer(e.er.FULL_TOTAL_VIEW_TIME,t),a=this.updateCumulativeTimer(e.er.EIGHTY_TOTAL_VIEW_TIME,t);return{totalViewTime:i?.cumulativeTime||0,fiftyViewTime:s?.cumulativeTime||0,fullViewTime:r?.cumulativeTime||0,eightyViewTime:a?.cumulativeTime||0}}getContinuousTimes(t){const i=this.updateContinuousTimer(e.er.ANY_CONTINUOUS_VIEW_TIME,t),s=this.updateContinuousTimer(e.er.FIFTY_CONTINUOUS_VIEW_TIME,t),r=this.updateContinuousTimer(e.er.FULL_CONTINUOUS_VIEW_TIME,t),a=this.updateContinuousTimer(e.er.EIGHTY_CONTINUOUS_VIEW_TIME,t),n=this.updateContinuousTimer(e.er.THIRTY_CONTINUOUS_VIEW_TIME,t);return{maxAnyViewTime:i?.maxContinuousTime||0,maxFiftyViewTime:s?.maxContinuousTime||0,maxFullViewTime:r?.maxContinuousTime||0,maxEightyViewTime:a?.maxContinuousTime||0,maxThirtyViewTime:n?.maxContinuousTime||0}}getMetadata(t){const i=Date.now(),{totalViewTime:s,fiftyViewTime:r,fullViewTime:a,eightyViewTime:n}=this.getCumulativeTimes(i),{maxAnyViewTime:o,maxFiftyViewTime:h,maxFullViewTime:d,maxEightyViewTime:l,maxThirtyViewTime:u}=this.getContinuousTimes(i),m=this.pixelTimers.get(e.ch.GROUP_M_VIEWABLE)?.fired||t===e.ch.GROUP_M_VIEWABLE,c=t===e.ch.VIEWABLE_IMPRESSION||this.wasEverViewableTimer.fired;t===e.ch.IMPRESSION&&0===this.impressionTimestamp&&(this.impressionTimestamp=i);const T=this.postElement?.getBoundingClientRect(),_=Math.floor(T?.width??0),E=Math.floor(T?.height??0),I=this.getFiredRedditPixelsCount?.()||0,p=new URLSearchParams(e.ep.search).get(e.eS);return{[e.er.ANY_TOTAL_VIEW_TIME]:s,[e.er.FIFTY_TOTAL_VIEW_TIME]:r,[e.er.EIGHTY_TOTAL_VIEW_TIME]:n,[e.er.FULL_TOTAL_VIEW_TIME]:a,[e.er.ANY_CONTINUOUS_VIEW_TIME]:o,[e.er.FIFTY_CONTINUOUS_VIEW_TIME]:h,[e.er.THIRTY_CONTINUOUS_VIEW_TIME]:u,[e.er.EIGHTY_CONTINUOUS_VIEW_TIME]:l,[e.er.FULL_CONTINUOUS_VIEW_TIME]:d,[e.er.GLOBAL_COUNT]:I,[e.er.GROUP_M_VIEWABLE]:m?1:0,[e.er.AD_LOAD_TIME]:this.impressionTimestamp,[e.er.TIMESTAMP]:i,[e.er.WAS_EVER_VIEWABLE]:c?1:0,[e.er.LARGE_AD_FULL_VIEW]:this.largeAdFullViewTimer.fired?1:0,[e.er.HEIGHT]:E,[e.er.WIDTH]:_,[e.er.SCREEN_HEIGHT]:window.screen.height,[e.er.SCREEN_WIDTH]:window.screen.width,...null!==p&&{[e.er.TEST_ID]:p}}}getAdEventDisplayMetadata(){const e=Date.now(),{totalViewTime:t,fiftyViewTime:i,eightyViewTime:s,fullViewTime:r}=this.getCumulativeTimes(e),{maxAnyViewTime:a,maxThirtyViewTime:n,maxFiftyViewTime:o,maxEightyViewTime:h,maxFullViewTime:d}=this.getContinuousTimes(e),l=this.postElement?.getBoundingClientRect(),u=Math.floor(l?.width??0),m=Math.floor(l?.height??0);return{any_total_view_time_ms:Math.floor(t),fifty_total_view_time_ms:Math.floor(i),eighty_total_view_time_ms:Math.floor(s),full_total_view_time_ms:Math.floor(r),any_continuous_view_time_ms:Math.floor(a),thirty_continuous_view_time_ms:Math.floor(n),fifty_continuous_view_time_ms:Math.floor(o),eighty_continuous_view_time_ms:Math.floor(h),full_continuous_view_time_ms:Math.floor(d),height:m,width:u,screen_width:Math.floor(window.screen.width),screen_height:Math.floor(window.screen.height)}}getAdEventVideoMetadata(){}getPixelScalingFields(e){return{encryptedTrackingPayload:this.postElement.encryptedTrackingPayload||"",additionalEventMetadata:this.postElement.additionalEventMetadata?this.postElement.additionalEventMetadata[e||0]:"",impressionId:this.impressionId}}firePixel(e,t){const i=d(e);this.pixelFiringController.firePixel({pixelEventType:e,metadata:this.getMetadata(e),displayMetadata:i?this.getAdEventDisplayMetadata():void 0,videoMetadata:i?this.getAdEventVideoMetadata():void 0,galleryIndex:t})}fireUnloadPixel(){this.firePixel(e.ch.UNLOAD)}measureViewChange(t){const i=this.postElement?.getBoundingClientRect(),s=Math.floor(i?.width??0),r=Math.floor(i?.height??0),a=r*s,n=a>=242500,o=r>document.documentElement.clientHeight;if(t.intersectionRatio){this.setCumulativeTimer(e.er.ANY_TOTAL_VIEW_TIME),this.setContinuousTimer(e.er.ANY_CONTINUOUS_VIEW_TIME),this.measureImpressionPixel(),this.galleryItems?.length?this.measureGalleryItemImpression():this.isProductAd&&this.measureProductImpression(),e.eY.queuePostForUnload(this.postId,this.impressionId,this.getMetadata.bind(this),this.pixelFiringController.firePixel.bind(this),this.getPixelScalingFields.bind(this));const t=this.postElement,i=this.galleryItems;if(!this.hasDispatchedViewEvent&&t&&!t.isBlank){const s=e.c("observe-post-view-ad",{postId:this.postId,post:t,galleryItems:i||[]});this.postElement.dispatchEvent(s),this.hasDispatchedViewEvent=!0}}else this.unsetContinuousTimer(e.er.ANY_CONTINUOUS_VIEW_TIME),this.pauseCumulativeTimer(e.er.ANY_TOTAL_VIEW_TIME);if(t.intersectionRatio>=e.cg.LARGE_AD_FULL_VIEW_THRESHOLD?this.setContinuousTimer(e.er.THIRTY_CONTINUOUS_VIEW_TIME):this.unsetContinuousTimer(e.er.THIRTY_CONTINUOUS_VIEW_TIME),t.intersectionRatio>=e.cg.VIEWABILITY_THRESHOLD){this.setCumulativeTimer(e.er.FIFTY_TOTAL_VIEW_TIME),this.setContinuousTimer(e.er.FIFTY_CONTINUOUS_VIEW_TIME),this.pixelTimers.has(e.ch.VIEWABLE_IMPRESSION)||this.setPixelTimer(e.ch.VIEWABLE_IMPRESSION,1e3),this.wasEverViewableTimer.timer||this.wasEverViewableTimer.fired||(this.wasEverViewableTimer.timer=setTimeout((()=>{this.wasEverViewableTimer.timer&&(this.wasEverViewableTimer.fired=!0,this.wasEverViewableTimer.timer=void 0)}),1e3));const t=this.cumulativeTimers.get(e.er.FIFTY_TOTAL_VIEW_TIME);t&&(this.pixelTimers.has(e.ch.VENDOR_FULLY_IN_VIEW_5_SECS)||this.setPixelTimer(e.ch.VENDOR_FULLY_IN_VIEW_5_SECS,5e3-t.cumulativeTime),this.pixelTimers.has(e.ch.VENDOR_FULLY_IN_VIEW_15_SECS)||this.setPixelTimer(e.ch.VENDOR_FULLY_IN_VIEW_15_SECS,15e3-t.cumulativeTime))}else this.pixelTimers.has(e.ch.VIEWABLE_IMPRESSION)&&this.clearPixelTimer(e.ch.VIEWABLE_IMPRESSION),this.pixelTimers.has(e.ch.VENDOR_FULLY_IN_VIEW_5_SECS)&&this.clearPixelTimer(e.ch.VENDOR_FULLY_IN_VIEW_5_SECS),this.pixelTimers.has(e.ch.VENDOR_FULLY_IN_VIEW_15_SECS)&&this.clearPixelTimer(e.ch.VENDOR_FULLY_IN_VIEW_15_SECS),this.pauseCumulativeTimer(e.er.FIFTY_TOTAL_VIEW_TIME),this.unsetContinuousTimer(e.er.FIFTY_CONTINUOUS_VIEW_TIME);t.intersectionRatio>=e.cg.EIGHTY_VIEWABILITY_THRESHOLD?(this.setCumulativeTimer(e.er.EIGHTY_TOTAL_VIEW_TIME),this.setContinuousTimer(e.er.EIGHTY_CONTINUOUS_VIEW_TIME)):(this.pauseCumulativeTimer(e.er.EIGHTY_TOTAL_VIEW_TIME),this.unsetContinuousTimer(e.er.EIGHTY_CONTINUOUS_VIEW_TIME)),t.intersectionRatio>=e.cg.FULL_VIEWABILITY_THRESHOLD?(this.setCumulativeTimer(e.er.FULL_TOTAL_VIEW_TIME),this.setContinuousTimer(e.er.FULL_CONTINUOUS_VIEW_TIME)):(this.pauseCumulativeTimer(e.er.FULL_TOTAL_VIEW_TIME),this.unsetContinuousTimer(e.er.FULL_CONTINUOUS_VIEW_TIME)),t.intersectionRatio<e.cg.VIEWABILITY_THRESHOLD&&this.wasEverViewableTimer.timer&&(clearTimeout(this.wasEverViewableTimer.timer),this.wasEverViewableTimer.timer=void 0);n&&t.intersectionRatio>=e.cg.LARGE_AD_FULL_VIEW_THRESHOLD||t.intersectionRatio>=e.cg.FULL_VIEWABILITY_THRESHOLD?this.largeAdFullViewTimer.timer||this.largeAdFullViewTimer.fired||(this.largeAdFullViewTimer.timer=setTimeout((()=>{this.largeAdFullViewTimer.timer&&(this.largeAdFullViewTimer.fired=!0,this.largeAdFullViewTimer.timer=void 0)}),1e3)):this.largeAdFullViewTimer.timer&&(clearTimeout(this.largeAdFullViewTimer.timer),this.largeAdFullViewTimer.timer=void 0),o?1!==t.intersectionRatio||this.pixelTimers.has(e.ch.GROUP_M_VIEWABLE)?a*t.intersectionRatio<1&&this.pixelTimers.has(e.ch.GROUP_M_VIEWABLE)&&this.clearPixelTimer(e.ch.GROUP_M_VIEWABLE):this.setPixelTimer(e.ch.GROUP_M_VIEWABLE,1e3):t.intersectionRatio>=e.cg.FULL_VIEWABILITY_THRESHOLD?(this.pixelTimers.has(e.ch.GROUP_M_VIEWABLE)||this.setPixelTimer(e.ch.GROUP_M_VIEWABLE,1e3),this.pixelTimers.has(e.ch.VENDOR_FULLY_IN_VIEW)||this.setPixelTimer(e.ch.VENDOR_FULLY_IN_VIEW,100)):(this.pixelTimers.has(e.ch.GROUP_M_VIEWABLE)&&this.clearPixelTimer(e.ch.GROUP_M_VIEWABLE),this.pixelTimers.has(e.ch.VENDOR_FULLY_IN_VIEW)&&this.clearPixelTimer(e.ch.VENDOR_FULLY_IN_VIEW))}clearPixelTimer(e){const t=this.pixelTimers.get(e);t?.timer&&(clearTimeout(t.timer),this.pixelTimers.delete(e))}setPixelTimer(e,t){const i=this.pixelTimers.get(e)?.fired;i||(this.pixelTimers.get(e)?.timer&&this.clearPixelTimer(e),this.pixelTimers.set(e,{timer:setTimeout((()=>{this.pixelTimers.get(e)&&(this.firePixel(e),this.pixelTimers.set(e,{fired:!0,timer:void 0}))}),t)}))}handleClickRedirect(i,s){const r=this.getMetadata(e.ch.CLICK);this.pixelFiringController.fireDebugPixel({pixel:t.a(i,r),pixelEvent:{url:i,type:e.ch.CLICK,metadata:r},impressionId:this.impressionId,postId:this.postId}),this.isProductAd&&this.firePixel(e.ch.PRODUCT_CLICK,s)}measureImpressionPixel(){this.firePixel(e.ch.IMPRESSION)}measureGalleryItemImpression(t=0){this.firePixel(e.ch.GALLERY_ITEM_IMPRESSION,t),this.isProductAd&&this.firePixel(e.ch.PRODUCT_IMPRESSION,t)}measureProductImpression(){this.firePixel(e.ch.PRODUCT_IMPRESSION)}handleUnload(){e.eY.fireQueuedUnloadPixels()}setCumulativeTimer(e){const t=this.cumulativeTimers.get(e),i=Date.now();if(t&&t.previousDate){const s=i-t.previousDate+t.cumulativeTime;this.cumulativeTimers.set(e,{previousDate:i,cumulativeTime:s})}else this.cumulativeTimers.set(e,{previousDate:i,cumulativeTime:t?.cumulativeTime||0})}updateCumulativeTimer(e,t){const i=this.cumulativeTimers.get(e);if(i&&i.previousDate){const s=t-i.previousDate+(i.cumulativeTime||0);this.cumulativeTimers.set(e,{previousDate:t,cumulativeTime:s})}return this.cumulativeTimers.get(e)}pauseCumulativeTimer(e){const t=this.updateCumulativeTimer(e,Date.now());t&&this.cumulativeTimers.set(e,{previousDate:null,cumulativeTime:t.cumulativeTime||0})}setContinuousTimer(e){const t=this.continuousTimers.get(e),i=Date.now();if(t&&t.previousDate){const s=t.currentContinuousTime+(i-t.previousDate),r=Math.max(s,t.maxContinuousTime);this.continuousTimers.set(e,{previousDate:i,currentContinuousTime:s,maxContinuousTime:r})}else this.continuousTimers.set(e,{previousDate:i,currentContinuousTime:t?.currentContinuousTime||0,maxContinuousTime:t?.maxContinuousTime||0})}updateContinuousTimer(e,t){const i=this.continuousTimers.get(e);if(i&&i.previousDate){const s=i.currentContinuousTime+(t-i.previousDate),r=Math.max(s,i.maxContinuousTime);this.continuousTimers.set(e,{previousDate:t,currentContinuousTime:s,maxContinuousTime:r})}return this.continuousTimers.get(e)}unsetContinuousTimer(e){const t=this.continuousTimers.get(e),i=Date.now();if(t&&t.previousDate){const s=Math.max(t.currentContinuousTime+(i-t.previousDate),t.maxContinuousTime);this.continuousTimers.set(e,{previousDate:null,currentContinuousTime:0,maxContinuousTime:s})}}}function T(e=0){return 1e3*e}class _ extends c{get visible(){return!!this.videoIntersectionRatio}get viewable(){return(this.videoIntersectionRatio||0)>=e.cg.VIEWABILITY_THRESHOLD}get currentQuartileState(){switch((this.viewable?1:0)+(this.videoVolume&&this.videoVolume>0?2:0)){case 0:return e.eZ.NOT_VISIBLE_NOT_AUDIBLE;case 1:return e.eZ.VISIBLE_NOT_AUDIBLE;case 2:return e.eZ.AUDIBLE_NOT_VISIBLE;case 3:return e.eZ.VISIBLE_AND_AUDIBLE;default:return e.eZ.NO_EVENT}}constructor(e,i){super(e,i),this.videoDuration=1/0,this.videoCurrentTime=0,this.seekingInitialized=!1,this.hasSeeked=!1,this.accumulatedWatchedTime=0,this.videoWasFullscreen=!1,this.videoWasVisible=!1,this.quartileState=new Map,this.dimensions=e.dimensions,this.thresholds=t.g(t.b)}minTimeRequired({timePercent:e=1/0,time:t=1/0}){const i=Number.isFinite(e)?e*this.videoDuration:1/0,s=Number.isFinite(t)?t:1/0;return Math.min(i,s)}setViewablePixelTimer(e){const t=Date.now(),i=this.pixelTimers.get(e.pixelEvent);if(i?.fired||i?.timer)return;let s=e.time;e.timePercent&&this.videoDuration&&(s=Math.min(this.videoDuration*e.timePercent,e.time));const r=i?.timeLeft?i?.timeLeft:s;this.pixelTimers.set(e.pixelEvent,{timer:setTimeout((()=>{this.firePixel(e.pixelEvent),this.pixelTimers.set(e.pixelEvent,{fired:!0,timer:void 0})}),r),timeLeft:r,lastSetTime:t})}resetViewablePixelTimer(e){const t=this.pixelTimers.get(e.pixelEvent);t?.fired||t&&!t.fired&&this.clearPixelTimer(e.pixelEvent)}pauseViewablePixelTimer(e){const t=this.pixelTimers.get(e.pixelEvent);if(t&&!t?.fired&&void 0!==this.videoCurrentTime&&void 0!==this.videoDuration){const i=Date.now();if(t.timer&&t.lastSetTime){const s=e.time-(i-t.lastSetTime);clearTimeout(t.timer),this.pixelTimers.set(e.pixelEvent,{timeLeft:s})}}}videoStateChange(){this.visible&&!this.videoWasVisible&&(this.videoWasVisible=!0),this.videoPlaying&&(this.updateQuartileState(),this.firePixel(e.ch.VIDEO_STARTED),this.videoVolume&&this.firePixel(e.ch.VIDEO_PLAYED_WITH_SOUND),e.e_.forEach((e=>{this.videoViewabilityStateChange(e)}))),e.e$.forEach((e=>{this.videoWatchedPercentStateChange(e)})),e.f0.forEach((e=>{this.videoWatchedSecondsStateChange(e)})),this.videoGroupMViewableChange()}videoViewabilityStateChange(e){this.videoIntersectionRatio&&this.videoIntersectionRatio>=e.threshold?this.videoPlaying?this.setViewablePixelTimer(e):this.pauseViewablePixelTimer(e):this.resetViewablePixelTimer({pixelEvent:e.pixelEvent,time:e.time})}videoWatchedPercentStateChange(t){if("number"==typeof this.videoCurrentTime&&"number"==typeof this.videoDuration){this.videoCurrentTime/this.videoDuration>=t.timePercent&&(t.quartileKey&&!this.quartileState.has(t.quartileKey)&&(t.quartileKey!==e.f1.VIDEO_STATE_Q0||this.videoPlaying)&&this.quartileState.set(t.quartileKey,this.currentQuartileState),e.f2(t)&&this.firePixel(t.pixelEvent))}}updateQuartileState(){e.e$.forEach((e=>{if(e.quartileKey&&"number"==typeof this.videoCurrentTime&&"number"==typeof this.videoDuration){this.videoCurrentTime/this.videoDuration>=e.timePercent&&e.quartileKey&&!this.quartileState.has(e.quartileKey)&&this.quartileState.set(e.quartileKey,this.currentQuartileState)}}))}videoWatchedSecondsStateChange(e){this.accumulatedWatchedTime>=this.minTimeRequired(e)&&this.firePixel(e.pixelEvent)}setMediaDetails(e){Number.isFinite(e.volume)&&(this.videoVolume=e.muted?0:e.volume),Number.isFinite(e.duration)&&(this.videoDuration=T(e.duration)),Number.isFinite(e.currentTime)&&(this.videoCurrentTime=T(e.currentTime))}updateAccumulatedWatchTime(e){const t=e-this.videoCurrentTime;return this.accumulatedWatchedTime+=t,t}updateThresholds(e){const{visibleThresholds:t}=this.getHiddenAndVisibleThresholds();t.forEach((t=>{this.thresholds[t.key].totalTime+=e,this.thresholds[t.key].currentContinuousTime+=e;const{currentContinuousTime:i,maxContinuousTime:s}=this.thresholds[t.key];i>s&&(this.thresholds[t.key].maxContinuousTime=i)})),this.resetContinuousTimerForHiddenThresholds()}getHiddenAndVisibleThresholds(){const e=[],i=[];return t.V.forEach((t=>{this.meetsViewabilityRequirements(t)?e.push(t):i.push(t)})),{visibleThresholds:e,hiddenThresholds:i}}resetContinuousTimerForHiddenThresholds(){this.resetContinuousTimerForThresholds(this.getHiddenAndVisibleThresholds().hiddenThresholds)}resetContinuousTimerForThresholds(e){e.forEach((e=>{this.thresholds[e.key].currentContinuousTime=0}))}measureViewChange(e){e.isVideoPlayer?this.videoIntersectionRatio=e.intersectionRatio:super.measureViewChange(e),this.videoStateChange(),this.resetContinuousTimerForHiddenThresholds()}measureVideoPlay(e){this.videoPlaying=!0,this.setMediaDetails(e),this.videoStateChange()}measureVideoPause(t){this.videoPlaying=!1,this.setMediaDetails(t),this.videoStateChange(),e.e_.forEach((e=>{this.pauseViewablePixelTimer(e)}))}measureVideoSeek(t){this.hasSeeked=!0,this.seekingInitialized||(this.videoPlaying=!1,this.setMediaDetails(t),e.e_.forEach((e=>{this.resetViewablePixelTimer({pixelEvent:e.pixelEvent,time:e.time})})),this.seekingInitialized=!0)}measureVideoSeeked(e){this.seekingInitialized=!1,this.hasSeeked=!0,this.videoCurrentTime=T(e.currentTime),e.paused||this.measureVideoPlay(e)}measureVolumeChange(t){this.setMediaDetails(t),this.videoStateChange(),t.volume&&!t.muted&&this.videoPlaying&&e.e_.forEach((e=>{this.firePixel(e.pixelEvent),this.pixelTimers.set(e.pixelEvent,{fired:!0})}))}measureFullscreenChange(t){this.videoFullscreen=t.fullscreen,this.videoStateChange(),t.fullscreen&&(this.videoWasFullscreen=!0,this.firePixel(e.ch.VIDEO_PLAYED_EXPANDED),this.videoPlaying&&e.e_.forEach((e=>{this.firePixel(e.pixelEvent),this.pixelTimers.set(e.pixelEvent,{fired:!0})})))}measureVideoTimeUpdate(e){const t=this.updateAccumulatedWatchTime(T(e.currentTime));this.updateThresholds(t),this.videoCurrentTime=T(e.currentTime),this.videoStateChange()}getMetadata(t){const i=super.getMetadata(t),s=this.thresholds.HALF_DURATION_80_IN_VIEW_AUDIBLE.totalTime;return{...i,[e.es.IS_VIDEO_AD]:1,[e.es.TOTAL_MRC_VIEWABLE_TIME]:Math.floor(this.thresholds.TOTAL_MRC_VIEWABLE_TIME.totalTime),[e.es.VIDEO_AD_DURATION]:isFinite(this.videoDuration)?Math.floor(this.videoDuration):0,[e.es.TOTAL_PLAY_TIME]:Math.floor(this.accumulatedWatchedTime),[e.es.VOLUME]:Math.floor(100*(this.videoVolume??0)),[e.es.IS_VISIBLE]:this.visible?1:0,[e.es.VIDEO_HEIGHT]:this.visible&&this.dimensions?this.dimensions.height:0,[e.es.TOTAL_AUDIBLE_TIME]:Math.floor(this.thresholds.TOTAL_AUDIBLE_TIME.totalTime),[e.es.VIDEO_STATE_Q0]:this.quartileState.get(e.f1.VIDEO_STATE_Q0)??e.eZ.NO_EVENT,[e.es.VIDEO_STATE_Q1]:this.quartileState.get(e.f1.VIDEO_STATE_Q1)??e.eZ.NO_EVENT,[e.es.VIDEO_STATE_Q2]:this.quartileState.get(e.f1.VIDEO_STATE_Q2)??e.eZ.NO_EVENT,[e.es.VIDEO_STATE_Q3]:this.quartileState.get(e.f1.VIDEO_STATE_Q3)??e.eZ.NO_EVENT,[e.es.VIDEO_STATE_Q4]:this.quartileState.get(e.f1.VIDEO_STATE_Q4)??e.eZ.NO_EVENT,[e.es.VIDEO_WIDTH]:this.visible&&this.dimensions?this.dimensions.width:0,[e.es.WAS_FULL_SCREEN]:this.videoWasFullscreen?1:0,[e.es.HALF_DURATION_80_IN_VIEW_AUDIBLE]:s>=15e3||this.videoDuration&&s>=.5*this.videoDuration?1:0,[e.es.FULL_IN_VIEW_AUDIBLE_TIME]:Math.floor(this.thresholds.FULL_IN_VIEW_AUDIBLE_TIME.totalTime),[e.es.EIGHTY_TOTAL_VIDEO_VIEW_TIME]:Math.floor(this.thresholds.EIGHTY_IN_VIEW_TIME.totalTime),[e.es.FULL_IN_VIEW_TIME]:Math.floor(this.thresholds.FULL_IN_VIEW_TIME.totalTime),[e.es.WAS_FULL_IN_VIEW_1SEC]:this.thresholds.FULL_IN_VIEW_TIME.maxContinuousTime>=1e3?1:0,[e.es.ANY_CONTINUOUS_VIDEO_VIEW_TIME]:Math.floor(this.thresholds.ANY_IN_VIEW_TIME.maxContinuousTime),[e.es.FIFTY_CONTINUOUS_VIDEO_VIEW_TIME]:Math.floor(this.thresholds.FIFTY_IN_VIEW_TIME.maxContinuousTime),[e.es.FULL_CONTINUOUS_VIDEO_VIEW_TIME]:Math.floor(this.thresholds.FULL_IN_VIEW_TIME.maxContinuousTime),[e.es.HAS_SEEKED]:this.hasSeeked?1:0}}getAdEventVideoMetadata(){return{is_video:!0,total_mrc_viewable_time_ms:Math.floor(this.thresholds.TOTAL_MRC_VIEWABLE_TIME.totalTime),video_ad_duration:isFinite(this.videoDuration)?Math.floor(this.videoDuration):0,total_play_time:Math.floor(this.accumulatedWatchedTime),volume:Math.floor(100*(this.videoVolume??0)),total_audible_time:Math.floor(this.thresholds.TOTAL_AUDIBLE_TIME.totalTime),was_full_screen:this.videoWasFullscreen,video_state_q1:(this.quartileState.get(e.f1.VIDEO_STATE_Q1)??e.eZ.NO_EVENT).toString(),video_state_q2:(this.quartileState.get(e.f1.VIDEO_STATE_Q2)??e.eZ.NO_EVENT).toString(),video_state_q3:(this.quartileState.get(e.f1.VIDEO_STATE_Q3)??e.eZ.NO_EVENT).toString(),video_state_q4:(this.quartileState.get(e.f1.VIDEO_STATE_Q4)??e.eZ.NO_EVENT).toString(),full_in_view_audible_time_ms:Math.floor(this.thresholds.FULL_IN_VIEW_AUDIBLE_TIME.totalTime),full_in_view_time_ms:Math.floor(this.thresholds.FULL_IN_VIEW_TIME.totalTime),video_height:this.visible&&this.dimensions?this.dimensions.height:0,video_width:this.visible&&this.dimensions?this.dimensions.width:0,fifty_continuous_video_view_time_v2_ms:Math.floor(this.thresholds.FIFTY_IN_VIEW_TIME.maxContinuousTime),eighty_total_video_view_time_v2_ms:Math.floor(this.thresholds.EIGHTY_IN_VIEW_TIME.totalTime),any_continuous_video_view_time_v2_ms:Math.floor(this.thresholds.ANY_IN_VIEW_TIME.maxContinuousTime),full_continuous_video_view_time_v2_ms:Math.floor(this.thresholds.FULL_IN_VIEW_TIME.maxContinuousTime)}}isAdequatelyInView(e){return!!this.videoFullscreen||(this.videoIntersectionRatio||0)>=e}meetsViewabilityRequirements(e){return this.isAdequatelyInView(e.threshold)&&(!e.playing||this.videoPlaying)&&(!e.withSound||this.videoVolume&&this.videoVolume>0)}videoGroupMViewableChange(){const t=this.dimensions?.height*this.dimensions?.width;let i=this.thresholds.FULL_IN_VIEW_AUDIBLE_TIME.totalTime;t>=3e5&&(i=this.thresholds.HALF_DURATION_80_IN_VIEW_AUDIBLE.totalTime),i/this.videoDuration>=e.cg.VIEWABILITY_THRESHOLD&&this.firePixel(e.ch.VIDEO_GROUP_M_VIEWABLE)}}const E=(e,{ignoredTags:t=new Set}={})=>{const i=(e=>{const t=window.getComputedStyle(e).borderRadius,i=Number.parseInt(t)/2,s=e.getBoundingClientRect();return document.elementFromPoint(s.left+i,s.top+i)})(e);return{overlappingElement:i,isOverlapped:!(!i||e.isSameNode(i)||e.contains(i)||t.has(i.tagName)||!((e,t)=>{const i=e.getBoundingClientRect(),s=t.getBoundingClientRect();return!(i.top>s.bottom||i.right<s.left||i.bottom<s.top||i.left>s.right)})(e,i))}},I=(e,t)=>{if((e=>{const t=e.getBoundingClientRect();if(t.width*t.height==0)return!0;const i=window.innerWidth||document.documentElement.clientWidth,s=window.innerHeight||document.documentElement.clientHeight;return t.right<0||t.bottom<0||t.left>i||t.top>s})(e))return 0;const i=e.getBoundingClientRect(),s=t.getBoundingClientRect(),r=window.innerHeight||document.documentElement.clientHeight,a=Math.min(r,i.bottom);return Math.max(0,a-s.bottom)/i.height},p=(e,t)=>{if(!e||!e.title)return 0;if(!1===e.renderTitleTruncation)return e.title.length;const i=e?.querySelector('[click-location="title"]')?.shadowRoot?.querySelector("a"),s=document.body,r=document.createElement("div");if(r.id="dummyDiv",r.className=i?.className,r.className=r.className.replace(/line-clamp-\d+/,""),r.classList.add("px-md"),t||(r.classList.add("font-normal"),r.classList.add("text-14")),r.style.position="absolute",r.style.left="-9999px",r.style.top="-9999px",r.style.visibility="hidden",s?.appendChild(r),r.style.width=i?.clientWidth+"px",r.textContent=e.title,r.offsetHeight<=i?.offsetHeight)return r?.remove(),e.title.length;let a=0;r.textContent="";for(let t=0;t<e.title.length;t++){const s=e.title?.slice(0,t+1);if(r.textContent=s+"",r.offsetHeight>i?.offsetHeight)break;a+=1}return r?.remove(),a},v=({postId:t,post:s,galleryItems:r,page_request_id:a,adsCorrelationId:n})=>{const o=s?.querySelector(`[click-location=${e.D.MEDIA}]`);let h;o&&(h=o.getBoundingClientRect());const d={post:{id:t,subreddit_id:s?.subredditId,subreddit_name:s?.subredditPrefixedName,author_id:s?.authorId,promoted:!0,title:s?.postTitle||s?.title,domain:s?.domain,nsfw:s?.nsfw,number_comments:s?.commentCount,type:s?.postType,created_timestamp:e.cN(s?.createdTimestamp||""),spoiler:s?.spoiler,url:s?.outboundLinkUrl},ad_metadata:{impression_id:s?.impressionId||"",placement:i.bj({post:s}),ad_correlation_id:n},feed:e.f3(),action_info:{page_request_id:a},screen:{height:window.screen.height,width:window.screen.width}};s&&i.bk(s)&&(d.action_info||(d.action_info={}),d.action_info.position=s.feedIndex,d.screen||(d.screen={}),d.screen={},d.screen.view_type=e.f4(s.viewType));const l=r&&r.length>0||!1;if(s&&i.bl(s)&&(d.view_stats={characters_displayed:p(s,l)},d.parent={post_id:s?.parentElement?.querySelector("shreddit-post")?.id},d.action_info||(d.action_info={}),d.action_info.position=(t=>{if(t.shouldTrackPosition&&!t.isBlank)return t.placement===e.aj.COMMENTS_PAGE?0:[...document.querySelectorAll('shreddit-comments-page-ad[placement="comments_page"], shreddit-comments-page-ad[placement="comment_trees"], shreddit-comment[depth="0"]')].findIndex((e=>e.id===t.id))||void 0})(s)),r&&r.length>0){const e=r.map((e=>e.media?.id||""));d.gallery={num_items:r.length,media_ids:e,id:r[0].id},d.media={id:r[0].media?r[0].media.id:"",width:r[0].media?r[0].media.width:0,height:r[0].media?r[0].media.height:0}}else h&&(d.media={id:t,height:Math.round(h?.height),width:Math.round(h?.width)});if(d.ad_metadata)if(r&&r.length>0){let e=!1;const t=[];for(const i of r){const s=i.overlayData?.overlayText||"";t.push(s),s&&(e=!0)}const i=r[0]?.overlayData?.overlayType??void 0;e&&(d.ad_metadata.has_overlay=!0,d.ad_metadata.overlay_text=t,d.ad_metadata.overlay_type=i)}else s?.overlayText&&(d.ad_metadata.has_overlay=!0,d.ad_metadata.overlay_text=s.overlayText?[s.overlayText]:[],d.ad_metadata.overlay_type=s.overlayType);return e.b(e.f5,d)},g=t=>t.map((t=>{const i=e.ch[t.type];return{...t,type:i}}));class V{constructor(s){this.firedPixels=new Set,this.firedRedditPixels=new Set,this.firePixel=({pixelEventType:e,metadata:t,galleryIndex:i,displayMetadata:s,videoMetadata:r})=>{const a=this.postEvents?.get(e)||[];if(this.host.galleryItems){const t=this.getGalleryUrls(e,i)||[];a.push(...t)}const n=this.getPixelScalingFields(i);return this.firePixelsFromEvents({pixelEvents:a,metadata:t,pixelRequestBody:n,displayMetadata:s,videoMetadata:r})},this.fireDebugPixel=t=>{const i=e.c("pixelFired",t);window.dispatchEvent(i)},this.firePixelsFromEvents=({pixelEvents:e,metadata:t,pixelRequestBody:i,displayMetadata:s,videoMetadata:r})=>{const a=[];return e.forEach((e=>{const n=this.firePixelRequest({pixelEvent:e,metadata:t,pixelRequestBody:i,displayMetadata:s,videoMetadata:r});n&&a.push(n)})),a},this.firePixelRequest=({pixelEvent:s,metadata:r,pixelRequestBody:a,displayMetadata:c,videoMetadata:T})=>{if(this.hasPixelAlreadyFired(s,a))return;let _;return m(this.host,"queued",s),n(s)?_=h({pixelEvent:s,metadata:r,pixelRequestBody:a,target:this.host}):(_=function(e,s,r){const a=!i.ae(e.url);if(l(e.type)&&!a)return e.url;const n=new Image;n.onload=()=>{m(r,"succeeded",e)},n.onerror=t=>{const i="Sentry"in window?window.Sentry:void 0;i?.captureException&&i.captureException(new Error(`Error in GET response from pixel server for pixel of type ${e.type}: ${t}`)),m(r,"failed",e)};let o=e.url;return s&&!a&&(o=t.a(o,s)),n.src=o,e.url}(s,r,this.host),i.ae(s.url)||s.type!==e.ch.IMPRESSION||function(t){const i=t===e.b0.DESKTOP?"shreddit_desktop":"shreddit_mobile";e.as({type:e.at.Counter,name:"ads_third_party_impression_tracker_total",value:1,labels:{client_platform:i}})}(this.deviceType)),d(s.type)&&u({pixelEvent:s,impressionId:this.host.impressionId,displayMetadata:c,videoMetadata:T,pixelRequestBody:a}),_&&(this.firedPixels.add(_),(n(s)||i.ae(_))&&this.firedRedditPixels.add(_)),n(s)?this.fireDebugPixel({pixel:o(s,a),pixelEvent:{encryptedTrackingId:s.encryptedTrackingId,type:s.type,metadata:r},encryptedTrackingPayload:a.encryptedTrackingPayload,additionalEventMetadata:a.additionalEventMetadata,postId:this.host.postId,impressionId:this.host.impressionId}):this.fireDebugPixel({pixel:s.url,pixelEvent:{url:s.url,type:s.type,metadata:i.ae(s.url)?r:void 0},postId:this.host.postId,impressionId:this.host.impressionId}),_},this.hasPixelAlreadyFired=(e,t)=>n(e)?this.firedPixels.has(o(e,t)):this.firedPixels.has(e.url),this.deviceType=document.querySelector("shreddit-app")?.deviceType||e.b0.MOBILE,this.host=s,this.host.addController(this)}hostConnected(){const e=g(this.host.adEvents);this.postEvents=a(e),this.host.galleryItems&&(this.galleryEvents=this.host.galleryItems.map((e=>a(g(e.adEvents||[])))))}get firedRedditPixelsCount(){return this.firedRedditPixels.size}getPixelScalingFields(e){return{encryptedTrackingPayload:this.host.encryptedTrackingPayload||"",additionalEventMetadata:this.host.additionalEventMetadata?this.host.additionalEventMetadata[e||0]:"",impressionId:this.host.impressionId}}getGalleryUrls(t,i){const s=void 0===i&&t===e.ch.IMPRESSION,r=s?0:i;if(void 0===r)return;const a=s?e.ch.GALLERY_ITEM_IMPRESSION:t;return this.galleryEvents?.[r]&&this.galleryEvents[r].get(a)||[]}}class f{constructor({host:t,isVideoAd:i,onIntersectionEvent:s}){this.host=t,this.isVideoAd=i,this.onIntersectionEvent=s,this.observer=new IntersectionObserver((e=>{e.forEach((e=>{this.triggerIntersectionEventCallback(e)}))}),{threshold:e.f6,rootMargin:`-${this._getHeaderHeight()}px 0px 0px 0px`}),this.host.addController(this)}get shredditPlayer(){return this.host.querySelector(e.f7)}hostConnected(){this.observer.observe(this.host),this.isVideoAd&&this.shredditPlayer&&this.observer.observe(this.shredditPlayer)}hostDisconnected(){this.observer.disconnect()}triggerIntersectionEventCallback(e){const t=e.target===this.shredditPlayer;this.onIntersectionEvent({isVideoPlayer:t,intersectionRatio:e.intersectionRatio})}_getHeaderHeight(){let e=0;const t=document.querySelector("shreddit-app");if(t){const i=getComputedStyle(t).getPropertyValue("--shreddit-header-height");e=parseInt(i,10)||0}return e}}const C=Symbol("mixins/with-ad-observer"),y=new Set(["SHREDDIT-APP","FACEPLATE-PARTIAL"]);return{W:function(t){const r=t;if(e.di(r,C))return r;class a extends r{constructor(){super(...arguments),this.eventController=new e.E(this),this.pubsub=new e.u(this),this.isOverlapped=!1,this.isVideo=!1,this.isGallery=!1,this.visibilityChangeHandler=this.onVisibilityChange.bind(this),this.isAdObserved=!1,this.onCommentCreated=()=>{this.firePixel(e.ch.COMMENT)},this.onCommentUpvoted=()=>{this.firePixel(e.ch.COMMENT_UPVOTE)},this.onCommentDownvoted=()=>{this.firePixel(e.ch.COMMENT_DOWNVOTE)},this.onHideAd=({impressionId:e,action:t})=>{this.impressionId===e&&t===s.a.hide&&this.adMeasurer?.resetTimers()},this.checkAndMeasureIfAdIsBeingOverlapped=e.ao((()=>{if(!this.postElement||!this.postElement.isConnected)return;const{hidden:e}=this.getHiddenAndVisibilityChangeForDocument();if(document[e])return void this.measureOutOfViewChange();const{isOverlapped:t,overlappingElement:i}=E(this.postElement,{ignoredTags:y});if(t&&i){this.isOverlapped=!0;const e={intersectionRatio:I(this.postElement,i)};this.adMeasurer?.measureViewChange(e),this.updateViewChangeDetails(e)}else this.isOverlapped&&(this.isOverlapped=!1,this.measureBackInViewChange())}),30),this.updateViewChangeDetails=e=>{e.isVideoPlayer?this.lastVideoIOEvent=e:(this.lastAdIOEvent=e,e.intersectionRatio>0&&(this.lastVisibleAdIOEvent=e))},this.measureOutOfViewChange=()=>{const e={intersectionRatio:0};if(this.adMeasurer?.measureViewChange(e),this.updateViewChangeDetails(e),this.isVideo){const t={...e,isVideo:!0};this.adMeasurer?.measureViewChange(t),this.updateViewChangeDetails(t)}},this.measureBackInViewChange=()=>{this.lastVisibleAdIOEvent&&(this.adMeasurer?.measureViewChange(this.lastVisibleAdIOEvent),this.updateViewChangeDetails(this.lastVisibleAdIOEvent),this.isVideo&&this.lastVideoIOEvent&&(this.adMeasurer?.measureViewChange(this.lastVideoIOEvent),this.updateViewChangeDetails(this.lastVideoIOEvent)))},this.handleAnalyticEvent=this.eventController.define("faceplate-track",(t=>{const i=t.detail;if(i.post?.id!==this.postId)return;const{source:s,action:r,noun:a}=i;if("gallery"===s&&this.isGallery){if("forward"!==a&&"backward"!==a)return;const e="forward"===a?this.galleryIndex+1:this.galleryIndex-1;if(e<0||e>=this.galleryItemLength)return;this.galleryIndex=e,this.adMeasurer?.measureGalleryItemImpression(this.galleryIndex),this.lastAdIOEvent&&this.adMeasurer?.measureViewChange(this.lastAdIOEvent)}if("post_detail"===s&&"click"===r)switch(a){case"upvote_comment":this.firePixel(e.ch.COMMENT_UPVOTE);break;case"downvote_comment":this.firePixel(e.ch.COMMENT_DOWNVOTE);break;case"submit_comment":this.firePixel(e.ch.COMMENT)}if("post"===s&&"click"===r)switch(a){case"comments":this.firePixel(e.ch.COMMENTS_VIEW);break;case"upvote":this.firePixel(e.ch.UPVOTE);break;case"downvote":this.firePixel(e.ch.DOWNVOTE)}})),this.handlePostViewAdEvent=this.eventController.define("observe-post-view-ad",(t=>{const i=t.detail.post,{postId:s,galleryItems:r}=t.detail,a=e.cr();e.i(this,v({postId:s,post:i,galleryItems:r,page_request_id:a,adsCorrelationId:i.adsCorrelationId}))})),this.handleAdClickEvent=this.eventController.define("observe-ad-click",(t=>{const{postId:s,impressionId:r,outboundUrl:a,galleryIndex:n}=t.detail;if(s!==this.postId&&r!==this.impressionId)return;i.ag(a)&&this.adMeasurer?.handleClickRedirect(a,n);const o=n??this.galleryIndex;this.firePixel(e.ch.CLICK,o)})),this.handleLeadGenSubmissionEvent=this.eventController.define(e.f8,(t=>{this.firePixel(e.ch.LEAD_GENERATION)})),this.handleAdEngagedClickEvent=this.eventController.define(e.ef,(t=>{this.firePixel(e.ch.ENGAGED_CLICK)}))}getMetadataForPixelEvent(e){return this.adMeasurer?.getMetadata(e)}enableAdObserver(t){try{if(this.isAdObserved)return;const{adType:i,...s}=t;this.postId=t.postId,this.impressionId=t.impressionId,this.postElement=t.postElement,this.isVideo=i===e.f9.VIDEO,Array.isArray(t.galleryItems)&&(this.isGallery=!0,this.galleryIndex=0,this.galleryItemLength=t.galleryItems.length),this.overlappingObserver=new MutationObserver(this.checkAndMeasureIfAdIsBeingOverlapped),new f({host:t.postElement,isVideoAd:this.isVideo,onIntersectionEvent:this.isIntersectingChange.bind(this)}),this.pixelFiringController=new V(t.postElement),s.getFiredRedditPixelsCount=()=>this.pixelFiringController?.firedRedditPixelsCount||0,this.adMeasurer=this.isVideo?new _(s,this.pixelFiringController):new c(s,this.pixelFiringController),this.isVideo&&this.setupVideoEvents(),this.isGallery&&this.setupGalleryEvents(),this.setupVisibilityTracking(),this.isAdObserved=!0,this.impressionId||this.fireInitializationErrorMetricEvent("missing_impression_id")}catch(e){window.Sentry?.captureException?.(`enableAdObserver | ${e.stack}`),this.fireInitializationErrorMetricEvent("exception")}}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.AdUpdated,this.onHideAd),this.postElement&&this.postElement.isPDP&&(this.pubsub.subscribe(e.T.CommentCreated,this.onCommentCreated),this.pubsub.subscribe(e.T.CommentUpvoted,this.onCommentUpvoted),this.pubsub.subscribe(e.T.CommentDownvoted,this.onCommentDownvoted))}disconnectedCallback(){super.disconnectedCallback(),this.teardownVisibilityTracking(),this.measureOutOfViewChange()}firePixel(e,t){if(!this.adMeasurer||!this.pixelFiringController)return;const i=d(e);this.pixelFiringController.firePixel({pixelEventType:e,metadata:this.adMeasurer.getMetadata(e),displayMetadata:i?this.adMeasurer.getAdEventDisplayMetadata():void 0,videoMetadata:i?this.adMeasurer.getAdEventVideoMetadata():void 0,galleryIndex:t})}measureOutOfViewChangeIgnoringPrompts(e){e.relatedTarget&&this.measureOutOfViewChange()}onVisibilityChange(){const{hidden:e}=this.getHiddenAndVisibilityChangeForDocument();this.lastAdIOEvent&&(document[e]?this.measureOutOfViewChange():this.measureBackInViewChange())}setupVisibilityTracking(){const{visibilityChange:e}=this.getHiddenAndVisibilityChangeForDocument();document.addEventListener(e,this.visibilityChangeHandler),window.addEventListener("blur",this.measureOutOfViewChangeIgnoringPrompts),window.addEventListener("focus",this.measureBackInViewChange),this.overlappingObserver?.observe(document.body,{childList:!0,subtree:!0,attributes:!0,characterData:!1})}teardownVisibilityTracking(){const{visibilityChange:e}=this.getHiddenAndVisibilityChangeForDocument();document.removeEventListener(e,this.visibilityChangeHandler),window.removeEventListener("blur",this.measureOutOfViewChangeIgnoringPrompts),window.removeEventListener("focus",this.measureBackInViewChange),this.overlappingObserver?.disconnect()}isIntersectingChange(e){this.updateViewChangeDetails(e),this.adMeasurer?.measureViewChange(e),(e.intersectionRatio||this.isOverlapped)&&this.checkAndMeasureIfAdIsBeingOverlapped()}getHiddenAndVisibilityChangeForDocument(){let t=e.fa.Standard,i=e.fb.hidden;return void 0!==document.hidden?(t=e.fa.Standard,i=e.fb.hidden):void 0!==document.webkitHidden&&(t=e.fa.Webkit,i=e.fb.webkitHidden),{hidden:t,visibilityChange:i}}setupVideoEvents(){this.handleVideoFullscreenEvent=this.eventController.define(e.fc,(e=>{this.adMeasurer?.measureFullscreenChange(e.detail)})),this.handleVideoPauseEvent=this.eventController.define(e.fd,(e=>{this.adMeasurer?.measureVideoPause(e.detail)})),this.handleVideoPlayEvent=this.eventController.define(e.fe,(e=>{this.adMeasurer?.measureVideoPlay(e.detail)})),this.handleVideoVolumeEvent=this.eventController.define(e.ff,(e=>{this.adMeasurer?.measureVolumeChange(e.detail)})),this.handleVideoSeekingEvent=this.eventController.define(e.fg,(e=>{e.detail.fromReconnect||this.adMeasurer?.measureVideoSeek(e.detail)})),this.handleVideoSeekedEvent=this.eventController.define(e.fh,(e=>{e.detail.fromReconnect||this.adMeasurer?.measureVideoSeeked(e.detail)})),this.handleVideoTimeUpdateEvent=this.eventController.define(e.fi,(e=>{setTimeout((()=>{this.adMeasurer?.measureVideoTimeUpdate(e.detail)}))}))}setupGalleryEvents(){this.handleGalleryItemImpressionEvent=this.eventController.define(i.O,(e=>{const{postId:t,itemIndex:i}=e.detail;t===this.postId&&this.adMeasurer?.measureGalleryItemImpression(i)}))}fireInitializationErrorMetricEvent(t){const i=e.eW({name:"shreddit_ad_init_failure",value:1,label_values:[`error_type,${t}`,`post_id,${this.postId}`,`impression_id,${this.impressionId}`]});e.i(this.postElement,i)}}return a[C]=!0,a},e:g}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("BeFppRYbzE",["Dw4vb8Yfbm","5r73EsgItq"],(async(t,e)=>{const o=Math.min,n=Math.max,i=Math.round,r=Math.floor,a=t=>({x:t,y:t}),s={left:"right",right:"left",bottom:"top",top:"bottom"},l={start:"end",end:"start"};function c(t,e,i){return n(t,o(e,i))}function p(t,e){return"function"==typeof t?t(e):t}function f(t){return t.split("-")[0]}function h(t){return t.split("-")[1]}function u(t){return"x"===t?"y":"x"}function d(t){return"y"===t?"height":"width"}function m(t){return["top","bottom"].includes(f(t))?"y":"x"}function y(t){return u(m(t))}function g(t){return t.replace(/start|end/g,(t=>l[t]))}function v(t){return t.replace(/left|right|bottom|top/g,(t=>s[t]))}function b(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function w(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function x(t,e,o){let{reference:n,floating:i}=t;const r=m(e),a=y(e),s=d(a),l=f(e),c="y"===r,p=n.x+n.width/2-i.width/2,u=n.y+n.height/2-i.height/2,g=n[s]/2-i[s]/2;let v;switch(l){case"top":v={x:p,y:n.y-i.height};break;case"bottom":v={x:p,y:n.y+n.height};break;case"right":v={x:n.x+n.width,y:u};break;case"left":v={x:n.x-i.width,y:u};break;default:v={x:n.x,y:n.y}}switch(h(e)){case"start":v[a]-=g*(o&&c?-1:1);break;case"end":v[a]+=g*(o&&c?-1:1)}return v}async function E(t,e){var o;void 0===e&&(e={});const{x:n,y:i,platform:r,rects:a,elements:s,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:f="viewport",elementContext:h="floating",altBoundary:u=!1,padding:d=0}=p(e,t),m=b(d),y=s[u?"floating"===h?"reference":"floating":h],g=w(await r.getClippingRect({element:null==(o=await(null==r.isElement?void 0:r.isElement(y)))||o?y:y.contextElement||await(null==r.getDocumentElement?void 0:r.getDocumentElement(s.floating)),boundary:c,rootBoundary:f,strategy:l})),v="floating"===h?{...a.floating,x:n,y:i}:a.reference,x=await(null==r.getOffsetParent?void 0:r.getOffsetParent(s.floating)),E=await(null==r.isElement?void 0:r.isElement(x))&&await(null==r.getScale?void 0:r.getScale(x))||{x:1,y:1},P=w(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({rect:v,offsetParent:x,strategy:l}):v);return{top:(g.top-P.top+m.top)/E.y,bottom:(P.bottom-g.bottom+m.bottom)/E.y,left:(g.left-P.left+m.left)/E.x,right:(P.right-g.right+m.right)/E.x}}const P=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var o,n;const{placement:i,middlewareData:r,rects:a,initialPlacement:s,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:m=!0,fallbackPlacements:b,fallbackStrategy:w="bestFit",fallbackAxisSideDirection:x="none",flipAlignment:P=!0,...R}=p(t,e);if(null!=(o=r.arrow)&&o.alignmentOffset)return{};const S=f(i),T=f(s)===s,z=await(null==l.isRTL?void 0:l.isRTL(c.floating)),L=b||(T||!P?[v(s)]:function(t){const e=v(t);return[g(t),e,g(e)]}(s));b||"none"===x||L.push(...function(t,e,o,n){const i=h(t);let r=function(t,e,o){const n=["left","right"],i=["right","left"],r=["top","bottom"],a=["bottom","top"];switch(t){case"top":case"bottom":return o?e?i:n:e?n:i;case"left":case"right":return e?r:a;default:return[]}}(f(t),"start"===o,n);return i&&(r=r.map((t=>t+"-"+i)),e&&(r=r.concat(r.map(g)))),r}(s,P,x,z));const A=[s,...L],_=await E(e,R),O=[];let k=(null==(n=r.flip)?void 0:n.overflows)||[];if(u&&O.push(_[S]),m){const t=function(t,e,o){void 0===o&&(o=!1);const n=h(t),i=y(t),r=d(i);let a="x"===i?n===(o?"end":"start")?"right":"left":"start"===n?"bottom":"top";return e.reference[r]>e.floating[r]&&(a=v(a)),[a,v(a)]}(i,a,z);O.push(_[t[0]],_[t[1]])}if(k=[...k,{placement:i,overflows:O}],!O.every((t=>t<=0))){var C,D;const t=((null==(C=r.flip)?void 0:C.index)||0)+1,e=A[t];if(e)return{data:{index:t,overflows:k},reset:{placement:e}};let o=null==(D=k.filter((t=>t.overflows[0]<=0)).sort(((t,e)=>t.overflows[1]-e.overflows[1]))[0])?void 0:D.placement;if(!o)switch(w){case"bestFit":{var B;const t=null==(B=k.map((t=>[t.placement,t.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)])).sort(((t,e)=>t[1]-e[1]))[0])?void 0:B[0];t&&(o=t);break}case"initialPlacement":o=s}if(i!==o)return{reset:{placement:o}}}return{}}}};const R=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){var o,n;const{x:i,y:r,placement:a,middlewareData:s}=e,l=await async function(t,e){const{placement:o,platform:n,elements:i}=t,r=await(null==n.isRTL?void 0:n.isRTL(i.floating)),a=f(o),s=h(o),l="y"===m(o),c=["left","top"].includes(a)?-1:1,u=r&&l?-1:1,d=p(e,t);let{mainAxis:y,crossAxis:g,alignmentAxis:v}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&"number"==typeof v&&(g="end"===s?-1*v:v),l?{x:g*u,y:y*c}:{x:y*c,y:g*u}}(e,t);return a===(null==(o=s.offset)?void 0:o.placement)&&null!=(n=s.arrow)&&n.alignmentOffset?{}:{x:i+l.x,y:r+l.y,data:{...l,placement:a}}}}},S=function(t){return void 0===t&&(t={}),{name:"size",options:t,async fn(e){const{placement:i,rects:r,platform:a,elements:s}=e,{apply:l=()=>{},...c}=p(t,e),u=await E(e,c),d=f(i),y=h(i),g="y"===m(i),{width:v,height:b}=r.floating;let w,x;"top"===d||"bottom"===d?(w=d,x=y===(await(null==a.isRTL?void 0:a.isRTL(s.floating))?"start":"end")?"left":"right"):(x=d,w="end"===y?"top":"bottom");const P=b-u[w],R=v-u[x],S=!e.middlewareData.shift;let T=P,z=R;if(g){const t=v-u.left-u.right;z=y||S?o(R,t):t}else{const t=b-u.top-u.bottom;T=y||S?o(P,t):t}if(S&&!y){const t=n(u.left,0),e=n(u.right,0),o=n(u.top,0),i=n(u.bottom,0);g?z=v-2*(0!==t||0!==e?t+e:n(u.left,u.right)):T=b-2*(0!==o||0!==i?o+i:n(u.top,u.bottom))}await l({...e,availableWidth:z,availableHeight:T});const L=await a.getDimensions(s.floating);return v!==L.width||b!==L.height?{reset:{rects:!0}}:{}}}};function T(t){return A(t)?(t.nodeName||"").toLowerCase():"#document"}function z(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function L(t){var e;return null==(e=(A(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function A(t){return t instanceof Node||t instanceof z(t).Node}function _(t){return t instanceof Element||t instanceof z(t).Element}function O(t){return t instanceof HTMLElement||t instanceof z(t).HTMLElement}function k(t){return"undefined"!=typeof ShadowRoot&&(t instanceof ShadowRoot||t instanceof z(t).ShadowRoot)}function C(t){const{overflow:e,overflowX:o,overflowY:n,display:i}=N(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+o)&&!["inline","contents"].includes(i)}function D(t){return["table","td","th"].includes(T(t))}function B(t){const e=$(),o=N(t);return"none"!==o.transform||"none"!==o.perspective||!!o.containerType&&"normal"!==o.containerType||!e&&!!o.backdropFilter&&"none"!==o.backdropFilter||!e&&!!o.filter&&"none"!==o.filter||["transform","perspective","filter"].some((t=>(o.willChange||"").includes(t)))||["paint","layout","strict","content"].some((t=>(o.contain||"").includes(t)))}function $(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function F(t){return["html","body","#document"].includes(T(t))}function N(t){return z(t).getComputedStyle(t)}function H(t){return _(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function M(t){if("html"===T(t))return t;const e=t.assignedSlot||t.parentNode||k(t)&&t.host||L(t);return k(e)?e.host:e}function W(t){const e=M(t);return F(e)?t.ownerDocument?t.ownerDocument.body:t.body:O(e)&&C(e)?e:W(e)}function j(t,e,o){var n;void 0===e&&(e=[]),void 0===o&&(o=!0);const i=W(t),r=i===(null==(n=t.ownerDocument)?void 0:n.body),a=z(i);return r?e.concat(a,a.visualViewport||[],C(i)?i:[],a.frameElement&&o?j(a.frameElement):[]):e.concat(i,j(i,[],o))}function V(t){const e=N(t);let o=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const r=O(t),a=r?t.offsetWidth:o,s=r?t.offsetHeight:n,l=i(o)!==a||i(n)!==s;return l&&(o=a,n=s),{width:o,height:n,$:l}}function I(t){return _(t)?t:t.contextElement}function q(t){const e=I(t);if(!O(e))return a(1);const o=e.getBoundingClientRect(),{width:n,height:r,$:s}=V(e);let l=(s?i(o.width):o.width)/n,c=(s?i(o.height):o.height)/r;return l&&Number.isFinite(l)||(l=1),c&&Number.isFinite(c)||(c=1),{x:l,y:c}}const Y=a(0);function U(t){const e=z(t);return $()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:Y}function X(t,e,o,n){void 0===e&&(e=!1),void 0===o&&(o=!1);const i=t.getBoundingClientRect(),r=I(t);let s=a(1);e&&(n?_(n)&&(s=q(n)):s=q(t));const l=function(t,e,o){return void 0===e&&(e=!1),!(!o||e&&o!==z(t))&&e}(r,o,n)?U(r):a(0);let c=(i.left+l.x)/s.x,p=(i.top+l.y)/s.y,f=i.width/s.x,h=i.height/s.y;if(r){const t=z(r),e=n&&_(n)?z(n):n;let o=t.frameElement;for(;o&&n&&e!==t;){const t=q(o),e=o.getBoundingClientRect(),n=N(o),i=e.left+(o.clientLeft+parseFloat(n.paddingLeft))*t.x,r=e.top+(o.clientTop+parseFloat(n.paddingTop))*t.y;c*=t.x,p*=t.y,f*=t.x,h*=t.y,c+=i,p+=r,o=z(o).frameElement}}return w({width:f,height:h,x:c,y:p})}function Z(t){return X(L(t)).left+H(t).scrollLeft}function K(t,e,o){let i;if("viewport"===e)i=function(t,e){const o=z(t),n=L(t),i=o.visualViewport;let r=n.clientWidth,a=n.clientHeight,s=0,l=0;if(i){r=i.width,a=i.height;const t=$();(!t||t&&"fixed"===e)&&(s=i.offsetLeft,l=i.offsetTop)}return{width:r,height:a,x:s,y:l}}(t,o);else if("document"===e)i=function(t){const e=L(t),o=H(t),i=t.ownerDocument.body,r=n(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),a=n(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let s=-o.scrollLeft+Z(t);const l=-o.scrollTop;return"rtl"===N(i).direction&&(s+=n(e.clientWidth,i.clientWidth)-r),{width:r,height:a,x:s,y:l}}(L(t));else if(_(e))i=function(t,e){const o=X(t,!0,"fixed"===e),n=o.top+t.clientTop,i=o.left+t.clientLeft,r=O(t)?q(t):a(1);return{width:t.clientWidth*r.x,height:t.clientHeight*r.y,x:i*r.x,y:n*r.y}}(e,o);else{const o=U(t);i={...e,x:e.x-o.x,y:e.y-o.y}}return w(i)}function G(t,e){const o=M(t);return!(o===e||!_(o)||F(o))&&("fixed"===N(o).position||G(o,e))}function J(t,e,o){const n=O(e),i=L(e),r="fixed"===o,s=X(t,!0,r,e);let l={scrollLeft:0,scrollTop:0};const c=a(0);if(n||!n&&!r)if(("body"!==T(e)||C(i))&&(l=H(e)),n){const t=X(e,!0,r,e);c.x=t.x+e.clientLeft,c.y=t.y+e.clientTop}else i&&(c.x=Z(i));return{x:s.left+l.scrollLeft-c.x,y:s.top+l.scrollTop-c.y,width:s.width,height:s.height}}function Q(t,e){return O(t)&&"fixed"!==N(t).position?e?e(t):t.offsetParent:null}function tt(t,e){const o=z(t);if(!O(t))return o;let n=Q(t,e);for(;n&&D(n)&&"static"===N(n).position;)n=Q(n,e);return n&&("html"===T(n)||"body"===T(n)&&"static"===N(n).position&&!B(n))?o:n||function(t){let e=M(t);for(;O(e)&&!F(e);){if(B(e))return e;e=M(e)}return null}(t)||o}const et={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:o,strategy:n}=t;const i=O(o),r=L(o);if(o===r)return e;let s={scrollLeft:0,scrollTop:0},l=a(1);const c=a(0);if((i||!i&&"fixed"!==n)&&(("body"!==T(o)||C(r))&&(s=H(o)),O(o))){const t=X(o);l=q(o),c.x=t.x+o.clientLeft,c.y=t.y+o.clientTop}return{width:e.width*l.x,height:e.height*l.y,x:e.x*l.x-s.scrollLeft*l.x+c.x,y:e.y*l.y-s.scrollTop*l.y+c.y}},getDocumentElement:L,getClippingRect:function(t){let{element:e,boundary:i,rootBoundary:r,strategy:a}=t;const s=[..."clippingAncestors"===i?function(t,e){const o=e.get(t);if(o)return o;let n=j(t,[],!1).filter((t=>_(t)&&"body"!==T(t))),i=null;const r="fixed"===N(t).position;let a=r?M(t):t;for(;_(a)&&!F(a);){const e=N(a),o=B(a);o||"fixed"!==e.position||(i=null),(r?!o&&!i:!o&&"static"===e.position&&i&&["absolute","fixed"].includes(i.position)||C(a)&&!o&&G(t,a))?n=n.filter((t=>t!==a)):i=e,a=M(a)}return e.set(t,n),n}(e,this._c):[].concat(i),r],l=s[0],c=s.reduce(((t,i)=>{const r=K(e,i,a);return t.top=n(r.top,t.top),t.right=o(r.right,t.right),t.bottom=o(r.bottom,t.bottom),t.left=n(r.left,t.left),t}),K(e,l,a));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}},getOffsetParent:tt,getElementRects:async function(t){let{reference:e,floating:o,strategy:n}=t;const i=this.getOffsetParent||tt,r=this.getDimensions;return{reference:J(e,await i(o),n),floating:{x:0,y:0,...await r(o)}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){return V(t)},getScale:q,isElement:_,isRTL:function(t){return"rtl"===N(t).direction}};function ot(t,e,i,a){void 0===a&&(a={});const{ancestorScroll:s=!0,ancestorResize:l=!0,elementResize:c="function"==typeof ResizeObserver,layoutShift:p="function"==typeof IntersectionObserver,animationFrame:f=!1}=a,h=I(t),u=s||l?[...h?j(h):[],...j(e)]:[];u.forEach((t=>{s&&t.addEventListener("scroll",i,{passive:!0}),l&&t.addEventListener("resize",i)}));const d=h&&p?function(t,e){let i,a=null;const s=L(t);function l(){clearTimeout(i),a&&a.disconnect(),a=null}return function c(p,f){void 0===p&&(p=!1),void 0===f&&(f=1),l();const{left:h,top:u,width:d,height:m}=t.getBoundingClientRect();if(p||e(),!d||!m)return;const y={rootMargin:-r(u)+"px "+-r(s.clientWidth-(h+d))+"px "+-r(s.clientHeight-(u+m))+"px "+-r(h)+"px",threshold:n(0,o(1,f))||1};let g=!0;function v(t){const e=t[0].intersectionRatio;if(e!==f){if(!g)return c();e?c(!1,e):i=setTimeout((()=>{c(!1,1e-7)}),100)}g=!1}try{a=new IntersectionObserver(v,{...y,root:s.ownerDocument})}catch(t){a=new IntersectionObserver(v,y)}a.observe(t)}(!0),l}(h,i):null;let m,y=-1,g=null;c&&(g=new ResizeObserver((t=>{let[o]=t;o&&o.target===h&&g&&(g.unobserve(e),cancelAnimationFrame(y),y=requestAnimationFrame((()=>{g&&g.observe(e)}))),i()})),h&&!f&&g.observe(h),g.observe(e));let v=f?X(t):null;return f&&function e(){const o=X(t);!v||o.x===v.x&&o.y===v.y&&o.width===v.width&&o.height===v.height||i();v=o,m=requestAnimationFrame(e)}(),i(),()=>{u.forEach((t=>{s&&t.removeEventListener("scroll",i),l&&t.removeEventListener("resize",i)})),d&&d(),g&&g.disconnect(),g=null,f&&cancelAnimationFrame(m)}}const nt=(t,e,o)=>{const n=new Map,i={platform:et,...o},r={...i.platform,_c:n};return(async(t,e,o)=>{const{placement:n="bottom",strategy:i="absolute",middleware:r=[],platform:a}=o,s=r.filter(Boolean),l=await(null==a.isRTL?void 0:a.isRTL(e));let c=await a.getElementRects({reference:t,floating:e,strategy:i}),{x:p,y:f}=x(c,n,l),h=n,u={},d=0;for(let o=0;o<s.length;o++){const{name:r,fn:m}=s[o],{x:y,y:g,data:v,reset:b}=await m({x:p,y:f,initialPlacement:n,placement:h,strategy:i,middlewareData:u,rects:c,platform:a,elements:{reference:t,floating:e}});p=null!=y?y:p,f=null!=g?g:f,u={...u,[r]:{...u[r],...v}},b&&d<=50&&(d++,"object"==typeof b&&(b.placement&&(h=b.placement),b.rects&&(c=!0===b.rects?await a.getElementRects({reference:t,floating:e,strategy:i}):b.rects),({x:p,y:f}=x(c,h,l))),o=-1)}return{x:p,y:f,placement:h,strategy:i,middlewareData:u}})(t,e,{...i,platform:r})};function it(t){return function(t){for(let e=t;e;e=rt(e))if(e instanceof Element&&"none"===getComputedStyle(e).display)return null;for(let e=rt(t);e;e=rt(e)){if(!(e instanceof Element))continue;const t=getComputedStyle(e);if("contents"!==t.display){if("static"!==t.position||"none"!==t.filter)return e;if("BODY"===e.tagName)return e}}return null}(t)}function rt(t){return t.assignedSlot?t.assignedSlot:t.parentNode instanceof ShadowRoot?t.parentNode.host:t.parentNode}var at=e.a`${t.a7}:host{--arrow-color:var(--color-neutral-background-strong);--arrow-size:6px;--arrow-size-diagonal:calc(var(--arrow-size) * 0.7071);--arrow-padding-offset:calc(var(--arrow-size-diagonal) - var(--arrow-size));display:contents}.popup{position:absolute;isolation:isolate;max-width:var(--auto-size-available-width,none);max-height:var(--auto-size-available-height,none)}.popup--fixed{position:fixed}.popup:not(.popup--active){display:none}.popup--arrow{position:absolute;width:calc(var(--arrow-size-diagonal) * 2);height:calc(var(--arrow-size-diagonal) * 2);rotate:45deg;background:var(--arrow-color)}.popup-safe-area:not(.popup-safe-area--visible){display:none}.popup-safe-area{position:fixed;z-index:calc(var(--faceplate-tooltip-z-index,1) - 1);inset:0;clip-path:polygon(var(--safe-area-top-left-x,0) var(--safe-area-top-left-y,0),var(--safe-area-top-right-x,0) var(--safe-area-top-right-y,0),var(--safe-area-bottom-right-x,0) var(--safe-area-bottom-right-y,0),var(--safe-area-bottom-left-x,0) var(--safe-area-bottom-left-y,0))}`;const st={Top:"top",TopStart:"top-start",TopEnd:"top-end",Bottom:"bottom",BottomStart:"bottom-start",BottomEnd:"bottom-end",Right:"right",RightStart:"right-start",RightEnd:"right-end",Left:"left",LeftStart:"left-start",LeftEnd:"left-end"},lt="anchor";class ct extends t.R{constructor(){super(...arguments),this.anchorEl=null,this.active=!1,this.placement=st.Top,this.strategy="absolute",this.distance=0,this.skidding=0,this.arrow=!1,this.arrowPlacement=lt,this.arrowPadding=10,this.flip=!1,this.flipFallbackPlacements="",this.flipFallbackStrategy="best-fit",this.flipPadding=0,this.shift=!1,this.shiftPadding=0,this.autoSizePadding=0,this.safeArea=!1,this.noScreenReader=!1,this.updateSafeArea=()=>{if(!this.safeArea||!this.anchorEl)return;const t=this.anchorEl.getBoundingClientRect(),e=this.popup.getBoundingClientRect();let o=0,n=0,i=0,r=0,a=0,s=0,l=0,c=0;this.placement.includes("top")||this.placement.includes("bottom")?t.top<e.top?(o=t.left,n=t.bottom,i=t.right,r=t.bottom,a=e.left,s=e.top,l=e.right,c=e.top):(o=e.left,n=e.bottom,i=e.right,r=e.bottom,a=t.left,s=t.top,l=t.right,c=t.top):t.left<e.left?(o=t.right,n=t.top,i=e.left,r=e.top,a=t.right,s=t.bottom,l=e.left,c=e.bottom):(o=e.right,n=e.top,i=t.left,r=t.top,a=e.right,s=e.bottom,l=t.left,c=t.bottom),this.style.setProperty("--safe-area-top-left-x",`${o}px`),this.style.setProperty("--safe-area-top-left-y",`${n}px`),this.style.setProperty("--safe-area-top-right-x",`${i}px`),this.style.setProperty("--safe-area-top-right-y",`${r}px`),this.style.setProperty("--safe-area-bottom-left-x",`${a}px`),this.style.setProperty("--safe-area-bottom-left-y",`${s}px`),this.style.setProperty("--safe-area-bottom-right-x",`${l}px`),this.style.setProperty("--safe-area-bottom-right-y",`${c}px`)}}async connectedCallback(){super.connectedCallback(),await this.updateComplete,this.start()}disconnectedCallback(){super.disconnectedCallback(),this.stop()}async updated(t){super.updated(t),t.has("active")&&(this.active?this.start():this.stop()),t.has("anchor")&&this.handleAnchorChange(),this.active&&(await this.updateComplete,this.reposition())}async handleAnchorChange(){if(await this.stop(),this.anchor&&"string"==typeof this.anchor){const t=this.getRootNode();this.anchorEl=t.getElementById(this.anchor)}else this.anchor instanceof Element||null!==(t=this.anchor)&&"object"==typeof t&&"getBoundingClientRect"in t?this.anchorEl=this.anchor:this.anchorEl=this.querySelector('[slot="anchor"]');var t;this.anchorEl instanceof HTMLSlotElement&&(this.anchorEl=this.anchorEl.assignedElements({flatten:!0})[0]),this.anchorEl&&this.start()}start(){this.anchorEl&&(this.cleanup=ot(this.anchorEl,this.popup,(()=>{this.reposition()})))}async stop(){return new Promise((t=>{this.cleanup?(this.cleanup(),this.cleanup=void 0,this.removeAttribute("data-current-placement"),this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height"),requestAnimationFrame((()=>t()))):t()}))}reposition(){if(!this.active||!this.anchorEl)return;const t=[R({mainAxis:this.distance,crossAxis:this.skidding})];var e;this.sync?t.push(S({apply:({rects:t})=>{const e="width"===this.sync||"both"===this.sync,o="height"===this.sync||"both"===this.sync;this.popup.style.width=e?`${t.reference.width}px`:"",this.popup.style.height=o?`${t.reference.height}px`:""}})):(this.popup.style.width="",this.popup.style.height=""),this.flip&&t.push(P({boundary:this.flipBoundary,fallbackPlacements:this.flipFallbackPlacements,fallbackStrategy:"best-fit"===this.flipFallbackStrategy?"bestFit":"initialPlacement",padding:this.flipPadding})),this.shift&&t.push((void 0===(e={boundary:this.shiftBoundary,padding:this.shiftPadding})&&(e={}),{name:"shift",options:e,async fn(t){const{x:o,y:n,placement:i}=t,{mainAxis:r=!0,crossAxis:a=!1,limiter:s={fn:t=>{let{x:e,y:o}=t;return{x:e,y:o}}},...l}=p(e,t),h={x:o,y:n},d=await E(t,l),y=m(f(i)),g=u(y);let v=h[g],b=h[y];if(r){const t="y"===g?"bottom":"right";v=c(v+d["y"===g?"top":"left"],v,v-d[t])}if(a){const t="y"===y?"bottom":"right";b=c(b+d["y"===y?"top":"left"],b,b-d[t])}const w=s.fn({...t,[g]:v,[y]:b});return{...w,data:{x:w.x-o,y:w.y-n}}}})),this.autoSize?t.push(S({boundary:this.autoSizeBoundary,padding:this.autoSizePadding,apply:({availableWidth:t,availableHeight:e})=>{"vertical"===this.autoSize||"both"===this.autoSize?this.style.setProperty("--auto-size-available-height",`${e}px`):this.style.removeProperty("--auto-size-available-height"),"horizontal"===this.autoSize||"both"===this.autoSize?this.style.setProperty("--auto-size-available-width",`${t}px`):this.style.removeProperty("--auto-size-available-width")}})):(this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height")),this.arrow&&t.push((t=>({name:"arrow",options:t,async fn(e){const{x:n,y:i,placement:r,rects:a,platform:s,elements:l,middlewareData:f}=e,{element:u,padding:m=0}=p(t,e)||{};if(null==u)return{};const g=b(m),v={x:n,y:i},w=y(r),x=d(w),E=await s.getDimensions(u),P="y"===w,R=P?"top":"left",S=P?"bottom":"right",T=P?"clientHeight":"clientWidth",z=a.reference[x]+a.reference[w]-v[w]-a.floating[x],L=v[w]-a.reference[w],A=await(null==s.getOffsetParent?void 0:s.getOffsetParent(u));let _=A?A[T]:0;_&&await(null==s.isElement?void 0:s.isElement(A))||(_=l.floating[T]||a.floating[x]);const O=z/2-L/2,k=_/2-E[x]/2-1,C=o(g[R],k),D=o(g[S],k),B=C,$=_-E[x]-D,F=_/2-E[x]/2+O,N=c(B,F,$),H=!f.arrow&&null!=h(r)&&F!=N&&a.reference[x]/2-(F<B?C:D)-E[x]/2<0,M=H?F<B?F-B:F-$:0;return{[w]:v[w]+M,data:{[w]:N,centerOffset:F-N-M,...H&&{alignmentOffset:M}},reset:H}}}))({element:this.arrowEl,padding:this.arrowPadding}));const n="absolute"===this.strategy?t=>et.getOffsetParent(t,it):et.getOffsetParent;nt(this.anchorEl,this.popup,{placement:this.placement,middleware:t,strategy:this.strategy,platform:{...et,getOffsetParent:n}}).then((({x:t,y:e,middlewareData:o,placement:n})=>{const i="rtl"===getComputedStyle(this).direction,r={top:"bottom",right:"left",bottom:"top",left:"right"}[n.split("-")[0]];if(this.setAttribute("data-current-placement",n),Object.assign(this.popup.style,{left:`${t}px`,top:`${e}px`}),!this.arrow)return;const a=o.arrow.x,s=o.arrow.y;let l="",c="",p="",f="";if("start"===this.arrowPlacement){const t="number"==typeof a?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";l="number"==typeof s?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"",c=i?t:"",f=i?"":t}else if("end"===this.arrowPlacement){const t="number"==typeof a?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";c=i?"":t,f=i?t:"",p="number"==typeof s?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:""}else"center"===this.arrowPlacement?(f="number"==typeof a?"calc(50% - var(--arrow-size-diagonal))":"",l="number"==typeof s?"calc(50% - var(--arrow-size-diagonal))":""):(f="number"==typeof a?`${a}px`:"",l="number"==typeof s?`${s}px`:"");Object.assign(this.arrowEl.style,{top:l,right:c,bottom:p,left:f,[r]:"calc(var(--arrow-size-diagonal) * -1)"})})),requestAnimationFrame((()=>this.updateSafeArea())),this.emitter.dispatch("reposition")}render(){return e.x` <slot name="anchor" @slotchange="${this.handleAnchorChange}"></slot> <span part="safe-area" class="${t.Z({"popup-safe-area":!0,"popup-safe-area--visible":this.safeArea&&this.active})}"></span> <div part="popup" class="${t.Z({popup:!0,"popup--active":this.active,"popup--fixed":"fixed"===this.strategy,"popup--has-arrow":this.arrow})}" aria-hidden="${this.noScreenReader?"true":"false"}"> <slot></slot> ${this.arrow?e.x`<div part="arrow" class="popup--arrow" role="presentation"></div>`:""} </div> `}}ct.styles=at,t._([t.a2(".popup")],ct.prototype,"popup",void 0),t._([t.a2(".popup--arrow")],ct.prototype,"arrowEl",void 0),t._([t.n()],ct.prototype,"anchor",void 0),t._([t.n({type:Boolean,reflect:!0})],ct.prototype,"active",void 0),t._([t.n({reflect:!0})],ct.prototype,"placement",void 0),t._([t.n({reflect:!0})],ct.prototype,"strategy",void 0),t._([t.n({type:Number})],ct.prototype,"distance",void 0),t._([t.n({type:Number})],ct.prototype,"skidding",void 0),t._([t.n({type:Boolean})],ct.prototype,"arrow",void 0),t._([t.n({attribute:"arrow-placement"})],ct.prototype,"arrowPlacement",void 0),t._([t.n({attribute:"arrow-padding",type:Number})],ct.prototype,"arrowPadding",void 0),t._([t.n({type:Boolean})],ct.prototype,"flip",void 0),t._([t.n({attribute:"flip-fallback-placements",converter:{fromAttribute:t=>t.split(" ").map((t=>t.trim())).filter((t=>""!==t))}})],ct.prototype,"flipFallbackPlacements",void 0),t._([t.n({attribute:"flip-fallback-strategy"})],ct.prototype,"flipFallbackStrategy",void 0),t._([t.n({type:Object})],ct.prototype,"flipBoundary",void 0),t._([t.n({attribute:"flip-padding",type:Number})],ct.prototype,"flipPadding",void 0),t._([t.n({type:Boolean})],ct.prototype,"shift",void 0),t._([t.n({type:Object})],ct.prototype,"shiftBoundary",void 0),t._([t.n({attribute:"shift-padding",type:Number})],ct.prototype,"shiftPadding",void 0),t._([t.n({attribute:"auto-size"})],ct.prototype,"autoSize",void 0),t._([t.n()],ct.prototype,"sync",void 0),t._([t.n({type:Object})],ct.prototype,"autoSizeBoundary",void 0),t._([t.n({attribute:"auto-size-padding",type:Number})],ct.prototype,"autoSizePadding",void 0),t._([t.n({attribute:"safe-area",type:Boolean})],ct.prototype,"safeArea",void 0),t._([t.n({attribute:"no-screen-reader",type:Boolean})],ct.prototype,"noScreenReader",void 0);let pt=class extends ct{};return pt=t._([t.e("rpl-popper")],pt),{P:st}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("BgnwQeogVz",["Dw4vb8Yfbm"],(async a=>{const{svg:c}=a.a(),l=a.m(c`<g clip-path="url(#a)"><path d="M17.01 6.51c-.66 0-1.27.24-1.76.64-1.2-.8-2.7-1.31-4.33-1.46.05-.7.26-1.23.66-1.57.4-.34.97-.48 1.49-.53.33.43.84.71 1.42.71.99 0 1.8-.81 1.8-1.8S15.48.7 14.49.7c-.75 0-1.39.46-1.66 1.12-.78.08-1.68.32-2.4.92-.82.69-1.24 1.69-1.31 2.95-1.65.14-3.16.66-4.37 1.46-.49-.41-1.1-.65-1.77-.65C1.39 6.51.1 7.9.1 9.61c0 1.24.68 2.32 1.66 2.81.1 3.6 3.75 6.5 8.24 6.5s8.15-2.9 8.24-6.51c.98-.5 1.65-1.57 1.65-2.8 0-1.71-1.29-3.1-2.89-3.1h.01z"></path></g><defs><clipPath id="a"><path d="M0 0h20v20H0z"></path></clipPath></defs>`,"0 0 20 20","admin-fill"),{svg:t}=a.a();return{a:a.m(t`<path d="M17.012 6.507v-.002c-.662 0-1.272.24-1.76.643-1.202-.8-2.7-1.31-4.333-1.455.048-.704.259-1.227.664-1.568.403-.34.967-.485 1.493-.534.329.429.84.71 1.423.71a1.8 1.8 0 10-1.664-2.484c-.785.08-1.675.315-2.403.923-.82.686-1.244 1.688-1.305 2.95-1.65.142-3.161.657-4.374 1.465a2.75 2.75 0 00-1.766-.648C1.393 6.506.1 7.896.1 9.61c0 1.244.68 2.316 1.663 2.812.095 3.604 3.749 6.504 8.244 6.504 4.495 0 8.153-2.903 8.244-6.51.975-.5 1.649-1.567 1.649-2.804 0-1.715-1.293-3.105-2.888-3.105v-.001zm-.534 4.793l-.027 1.07c-.066 2.622-2.957 4.755-6.444 4.755s-6.375-2.131-6.444-4.751l-.03-1.075-.96-.484c-.41-.206-.673-.68-.673-1.204 0-.72.488-1.305 1.088-1.305.278 0 .487.126.614.232l1.032.859 1.118-.745C6.79 7.959 8.07 7.547 9.455 7.458l.993-.013c1.419.074 2.735.489 3.807 1.202l1.114.74 1.03-.852a.97.97 0 01.55-.228h.062c.6 0 1.088.585 1.088 1.305 0 .522-.263.994-.67 1.202l-.951.486z"></path>`,"0 0 20 20","admin"),b:l}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("BhZAdnVq89",["Dw4vb8Yfbm"],(async a=>{const{svg:t}=a.a();return{P:"pagination__change-page",c:a.m(t`<path d="M13.7 10c0 .23-.088.46-.264.636l-4.6 4.6a.9.9 0 11-1.273-1.272L11.526 10 7.563 6.036a.9.9 0 011.273-1.272l4.6 4.6A.897.897 0 0113.7 10z"></path>`,"0 0 20 20","caret-right",!0)}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");
SML.dm("Bk8sRXhdir",["Dw4vb8Yfbm","5r73EsgItq","BtqmVQuPYp"],(async(t,e,i)=>{const s="var(--bottom-sheet-max-height)";let o=class extends e.s{constructor(){super(...arguments),this.open=!1,this.blocking=!1,this.docked=!1,this.focusManager=new t.aJ(this,this),this.inFocusTrap=!1,this._isModal=!1,this._isExpanded=!1,this._isExpandable=!1,this._isDockable=!1,this._gesture=new i.T(this,{mouseSupport:!1}),this._cachedHeight="auto",this._dockedHeight="auto",this._cachedHeightAtTouchStartPx=0,this._rafID=null,this._mutationObserver=void 0,this.show=t=>{this._isModal=!1,this._isExpanded=(t&&"expanded"in t&&t.expanded)??!1,this._isExpandable=t?.expandable??!1,this._isDockable=t?.dockable??!1,this.open=!0,this._isExpandable&&(this._gesture.on("panstart",this._onTouchStart),this._gesture.on("panmove",this._onTouchMove),this._gesture.on("panend",this._onTouchEnd)),this._isExpanded?this._content.style.height=s:""!==this._content.style.height&&"auto"!==this._content.style.height||(this._cachedHeight=this._content.clientHeight+"px",this._content.style.height=this._cachedHeight),this._dockedHeight=this._headerElements[0]?this._headerElements[0].clientHeight-1+"px":"auto",this._mutationObserver||this._connectMutationObserver()},this.showModal=e=>{if(this.open)throw new Error('The element already has an "open" attribute, and therefore cannot be opened modally');t.hB.add(this),this.show(e),this._isModal=!0,t.hC.add(this)},this.close=()=>{const e=t.c("faceplate-close");this.dispatchEvent(e),e.defaultPrevented||(this.open=!1,this._isExpanded=!1,this.inFocusTrap&&(t.hC.remove(this),t.hB.remove(this)),this._isExpandable&&(this._gesture.off("panstart",this._onTouchStart),this._gesture.off("panmove",this._onTouchMove),this._gesture.off("panend",this._onTouchEnd)),this._content.style.height=this._cachedHeight)},this.expand=()=>{if(this.open&&this._isExpandable&&!this._isExpanded){const e=t.c("faceplate-expand");if(this.dispatchEvent(e),e.defaultPrevented)return;this._cancelRAF(),this._content.style.height=s,this.docked=!1,this._isExpanded=!0}},this.collapse=()=>{if(this.open&&this._isExpandable&&this._isExpanded){const e=t.c("faceplate-collapse");if(this.dispatchEvent(e),e.defaultPrevented)return;this._cancelRAF(),this._content.style.height=this._cachedHeight,this.docked=!1,this._isExpanded=!1}},this.dock=()=>{if(!this.open||!this._isDockable||this.docked)return;const e=t.c("faceplate-dock");this.dispatchEvent(e),e.defaultPrevented||(this._cancelRAF(),this._content.style.height=this._dockedHeight,this.docked=!0)},this.undock=()=>{if(!this.open||!this._isDockable||!this.docked)return;const e=this._isExpandable&&this._isExpanded?s:this._cachedHeight,i=t.c("faceplate-undock");this.dispatchEvent(i),i.defaultPrevented||(this._cancelRAF(),this._content.style.height=e,this.docked=!1)},this.recalculateCachedHeight=()=>{const e=this._cachedHeight;this._content.style.height="auto";const i=this._content.clientHeight+"px";this._cachedHeight=i,this._isDockable&&this.docked?this._content.style.height=this._dockedHeight:this._isExpandable&&this._isExpanded?this._content.style.height=s:(this._content.style.height=e,window.requestAnimationFrame((()=>{this._content.style.height=i,this._cancelRAF()})));const o=t.c("__TEST-ONLY_bottom-sheet-recalculation",{cachedHeight:this._cachedHeight,dockedHeight:this._dockedHeight,expandedHeight:s});this.dispatchEvent(o)},this._onTouchStart=()=>{this._cancelRAF(),this._content.style.transitionDuration="0ms",this._cachedHeightAtTouchStartPx=this._content.clientHeight},this._onTouchMove=()=>{this._cancelRAF(),this._isExpanded&&(this._gesture.touchMoveY??0)<=0||(this._rafID=window.requestAnimationFrame((()=>{null!=this._gesture.touchMoveY&&(this._content.style.height=this._cachedHeightAtTouchStartPx-this._gesture.touchMoveY+"px")})))},this._onTouchEnd=()=>{if(this._cancelRAF(),this._content.style.transitionDuration="300ms",!this.open||null==this._gesture.touchMoveY)return;const t=this._gesture.touchMoveY>=this._gesture.thresholdY,e=this._gesture.touchMoveY<=-this._gesture.thresholdY;t?this._isExpanded?this.collapse():this._closeIfNotBlocked():e?this._isExpanded||this.expand():this._isExpanded?this._content.style.height=s:this._content.style.height=this._cachedHeight},this._cancelRAF=()=>{this._rafID&&(window.cancelAnimationFrame(this._rafID),this._rafID=null)},this._renderHandle=()=>this._isExpandable?e.x`<div id="handle" class="${this._isModal?"out":"in"}"></div>`:null,this._handleBackDropKeyUp=t=>{"Enter"===t.key&&this._closeIfNotBlocked()},this._closeIfNotBlocked=()=>{this.blocking||this.close()},this.render=()=>e.x` <div id="backdrop" part="backdrop" class="${this._isModal&&this.open?"blocker":""}" @click="${this._closeIfNotBlocked}" @keyup="${this._handleBackDropKeyUp}"></div> <div id="content" part="content" role="${t.ad(this.open?"dialog":void 0)}" aria-label="${t.ad(this.label??void 0)}" aria-modal="${t.ad(this.open&&this._isModal?"true":void 0)}"> ${this._renderHandle()} <slot name="header"></slot> <slot></slot> </div> `}static get styles(){return e.a`:host{--bottom-sheet-max-height:85vh}@supports (height:95dvh){:host{--bottom-sheet-max-height:95dvh}}:host{position:fixed;bottom:0;inset-inline-start:0;opacity:0;transition-duration:.3s;transition-property:visibility,opacity;transition-timing-function:ease;visibility:hidden;pointer-events:none}:host([open]){opacity:1;z-index:2;visibility:visible}:host([open])>#content{pointer-events:auto;transform:translateY(0)}:host>#backdrop{position:fixed;--backdrop-position-value:-100%;inset-inline:var(--backdrop-position-value) var(--backdrop-position-value);top:var(--backdrop-position-value);bottom:var(--backdrop-position-value)}:host>#backdrop.blocker{background:var(--color-scrim);pointer-events:auto}:host>#content{align-items:center;background:var(--color-ui-modalbackground);bottom:0;border-start-start-radius:var(--rem12);border-start-end-radius:var(--rem12);box-shadow:var(--boxshadow-modal);box-sizing:border-box;display:flex;flex-direction:column;inset-inline-start:0;position:fixed;touch-action:none;transform:translateY(100%);transition-duration:.3s;transition-property:height,transform;transition-timing-function:ease;width:100vw;max-height:var(--bottom-sheet-max-height)}:host>slot:not([name]){align-items:center;display:flex;flex-direction:column;gap:var(--spacer-sm)}#handle{position:absolute;top:0;inset-inline-start:50%;transform:translateX(-50%);height:var(--rem4);width:var(--rem48);border-radius:var(--rem4)}#handle.in{top:var(--spacer-xs);background-color:var(--color-neutral-border)}#handle.out{top:calc(-1 * var(--spacer-xs));background-color:var(--color-global-white)}`}disconnectedCallback(){super.disconnectedCallback(),this._gesture.destroy(),t.hC.remove(this),t.hB.remove(this),this._mutationObserver?.disconnect()}_connectMutationObserver(){this._mutationObserver=new MutationObserver((()=>{window.requestAnimationFrame(this.recalculateCachedHeight)})),this._mutationObserver.observe(this,{characterData:!0,childList:!0,attributes:!1,subtree:!0})}};t._([t.n({type:Boolean,reflect:!0})],o.prototype,"open",void 0),t._([t.n({type:Boolean})],o.prototype,"blocking",void 0),t._([t.n({type:Boolean,reflect:!0})],o.prototype,"docked",void 0),t._([t.n({type:String,attribute:"ariaLabel"})],o.prototype,"label",void 0),t._([t.a2("#content")],o.prototype,"_content",void 0),t._([t.l({slot:"header"})],o.prototype,"_headerElements",void 0),o=t._([t.e("faceplate-bottom-sheet")],o)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");
SML.dm("Bk8sRXhdir",["Dw4vb8Yfbm","5r73EsgItq","BtqmVQuPYp"],(async(t,e,i)=>{const s="var(--bottom-sheet-max-height)";let o=class extends e.s{constructor(){super(...arguments),this.open=!1,this.blocking=!1,this.docked=!1,this.focusManager=new t.aJ(this,this),this.inFocusTrap=!1,this._isModal=!1,this._isExpanded=!1,this._isExpandable=!1,this._isDockable=!1,this._gesture=new i.T(this,{mouseSupport:!1}),this._cachedHeight="auto",this._dockedHeight="auto",this._cachedHeightAtTouchStartPx=0,this._rafID=null,this._mutationObserver=void 0,this.show=t=>{this._isModal=!1,this._isExpanded=(t&&"expanded"in t&&t.expanded)??!1,this._isExpandable=t?.expandable??!1,this._isDockable=t?.dockable??!1,this.open=!0,this._isExpandable&&(this._gesture.on("panstart",this._onTouchStart),this._gesture.on("panmove",this._onTouchMove),this._gesture.on("panend",this._onTouchEnd)),this._isExpanded?this._content.style.height=s:""!==this._content.style.height&&"auto"!==this._content.style.height||(this._cachedHeight=this._content.clientHeight+"px",this._content.style.height=this._cachedHeight),this._dockedHeight=this._headerElements[0]?this._headerElements[0].clientHeight-1+"px":"auto",this._mutationObserver||this._connectMutationObserver()},this.showModal=e=>{if(this.open)throw new Error('The element already has an "open" attribute, and therefore cannot be opened modally');t.hB.add(this),this.show(e),this._isModal=!0,t.hC.add(this)},this.close=()=>{const e=t.c("faceplate-close");this.dispatchEvent(e),e.defaultPrevented||(this.open=!1,this._isExpanded=!1,this.inFocusTrap&&(t.hC.remove(this),t.hB.remove(this)),this._isExpandable&&(this._gesture.off("panstart",this._onTouchStart),this._gesture.off("panmove",this._onTouchMove),this._gesture.off("panend",this._onTouchEnd)),this._content.style.height=this._cachedHeight)},this.expand=()=>{if(this.open&&this._isExpandable&&!this._isExpanded){const e=t.c("faceplate-expand");if(this.dispatchEvent(e),e.defaultPrevented)return;this._cancelRAF(),this._content.style.height=s,this.docked=!1,this._isExpanded=!0}},this.collapse=()=>{if(this.open&&this._isExpandable&&this._isExpanded){const e=t.c("faceplate-collapse");if(this.dispatchEvent(e),e.defaultPrevented)return;this._cancelRAF(),this._content.style.height=this._cachedHeight,this.docked=!1,this._isExpanded=!1}},this.dock=()=>{if(!this.open||!this._isDockable||this.docked)return;const e=t.c("faceplate-dock");this.dispatchEvent(e),e.defaultPrevented||(this._cancelRAF(),this._content.style.height=this._dockedHeight,this.docked=!0)},this.undock=()=>{if(!this.open||!this._isDockable||!this.docked)return;const e=this._isExpandable&&this._isExpanded?s:this._cachedHeight,i=t.c("faceplate-undock");this.dispatchEvent(i),i.defaultPrevented||(this._cancelRAF(),this._content.style.height=e,this.docked=!1)},this.recalculateCachedHeight=()=>{const e=this._cachedHeight;this._content.style.height="auto";const i=this._content.clientHeight+"px";this._cachedHeight=i,this._isDockable&&this.docked?this._content.style.height=this._dockedHeight:this._isExpandable&&this._isExpanded?this._content.style.height=s:(this._content.style.height=e,window.requestAnimationFrame((()=>{this._content.style.height=i,this._cancelRAF()})));const o=t.c("__TEST-ONLY_bottom-sheet-recalculation",{cachedHeight:this._cachedHeight,dockedHeight:this._dockedHeight,expandedHeight:s});this.dispatchEvent(o)},this._onTouchStart=()=>{this._cancelRAF(),this._content.style.transitionDuration="0ms",this._cachedHeightAtTouchStartPx=this._content.clientHeight},this._onTouchMove=()=>{this._cancelRAF(),this._isExpanded&&(this._gesture.touchMoveY??0)<=0||(this._rafID=window.requestAnimationFrame((()=>{null!=this._gesture.touchMoveY&&(this._content.style.height=this._cachedHeightAtTouchStartPx-this._gesture.touchMoveY+"px")})))},this._onTouchEnd=()=>{if(this._cancelRAF(),this._content.style.transitionDuration="300ms",!this.open||null==this._gesture.touchMoveY)return;const t=this._gesture.touchMoveY>=this._gesture.thresholdY,e=this._gesture.touchMoveY<=-this._gesture.thresholdY;t?this._isExpanded?this.collapse():this._closeIfNotBlocked():e?this._isExpanded||this.expand():this._isExpanded?this._content.style.height=s:this._content.style.height=this._cachedHeight},this._cancelRAF=()=>{this._rafID&&(window.cancelAnimationFrame(this._rafID),this._rafID=null)},this._renderHandle=()=>this._isExpandable?e.x`<div id="handle" class="${this._isModal?"out":"in"}"></div>`:null,this._handleBackDropKeyUp=t=>{"Enter"===t.key&&this._closeIfNotBlocked()},this._closeIfNotBlocked=()=>{this.blocking||this.close()},this.render=()=>e.x` <div id="backdrop" part="backdrop" class="${this._isModal&&this.open?"blocker":""}" @click="${this._closeIfNotBlocked}" @keyup="${this._handleBackDropKeyUp}"></div> <div id="content" part="content" role="${t.ad(this.open?"dialog":void 0)}" aria-label="${t.ad(this.label??void 0)}" aria-modal="${t.ad(this.open&&this._isModal?"true":void 0)}"> ${this._renderHandle()} <slot name="header"></slot> <slot></slot> </div> `}static get styles(){return e.a`:host{--bottom-sheet-max-height:85vh}@supports (height:95dvh){:host{--bottom-sheet-max-height:95dvh}}:host{position:fixed;bottom:0;inset-inline-start:0;opacity:0;transition-duration:.3s;transition-property:visibility,opacity;transition-timing-function:ease;visibility:hidden;pointer-events:none}:host([open]){opacity:1;z-index:2;visibility:visible}:host([open])>#content{pointer-events:auto;transform:translateY(0)}:host>#backdrop{position:fixed;--backdrop-position-value:-100%;inset-inline:var(--backdrop-position-value) var(--backdrop-position-value);top:var(--backdrop-position-value);bottom:var(--backdrop-position-value)}:host>#backdrop.blocker{background:var(--color-scrim);pointer-events:auto}:host>#content{align-items:center;background:var(--color-ui-modalbackground);bottom:0;border-start-start-radius:var(--rem12);border-start-end-radius:var(--rem12);box-shadow:var(--boxshadow-modal);box-sizing:border-box;display:flex;flex-direction:column;inset-inline-start:0;position:fixed;touch-action:none;transform:translateY(100%);transition-duration:.3s;transition-property:height,transform;transition-timing-function:ease;width:100vw;max-height:var(--bottom-sheet-max-height)}:host>slot:not([name]){align-items:center;display:flex;flex-direction:column;gap:var(--spacer-sm)}#handle{position:absolute;top:0;inset-inline-start:50%;transform:translateX(-50%);height:var(--rem4);width:var(--rem48);border-radius:var(--rem4)}#handle.in{top:var(--spacer-xs);background-color:var(--color-neutral-border)}#handle.out{top:calc(-1 * var(--spacer-xs));background-color:var(--color-global-white)}`}disconnectedCallback(){super.disconnectedCallback(),this._gesture.destroy(),t.hC.remove(this),t.hB.remove(this),this._mutationObserver?.disconnect()}_connectMutationObserver(){this._mutationObserver=new MutationObserver((()=>{window.requestAnimationFrame(this.recalculateCachedHeight)})),this._mutationObserver.observe(this,{characterData:!0,childList:!0,attributes:!1,subtree:!0})}};t._([t.n({type:Boolean,reflect:!0})],o.prototype,"open",void 0),t._([t.n({type:Boolean})],o.prototype,"blocking",void 0),t._([t.n({type:Boolean,reflect:!0})],o.prototype,"docked",void 0),t._([t.n({type:String,attribute:"ariaLabel"})],o.prototype,"label",void 0),t._([t.a2("#content")],o.prototype,"_content",void 0),t._([t.l({slot:"header"})],o.prototype,"_headerElements",void 0),o=t._([t.e("faceplate-bottom-sheet")],o)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./CMwg6atOpj.js",import.meta.url,"CMwg6atOpj");SML.di("./KkXqW5RUm3.js",import.meta.url,"KkXqW5RUm3");SML.di("./CFd1NJhleF.js",import.meta.url,"CFd1NJhleF");SML.di("./BAGS8uwlNZ.js",import.meta.url,"BAGS8uwlNZ");SML.di("./lxqt5OPiQh.js",import.meta.url,"lxqt5OPiQh");SML.di("./D1ScrvIqaY.js",import.meta.url,"D1ScrvIqaY");SML.di("./YFXcK0ZyJl.js",import.meta.url,"YFXcK0ZyJl");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./C2l05LS-ga.js",import.meta.url,"C2l05LS-ga");SML.di("./Wt225_9ix9.js",import.meta.url,"Wt225_9ix9");SML.di("./E3QE3c4_Ye.js",import.meta.url,"E3QE3c4_Ye");SML.di("./DbJ72GsAzT.js",import.meta.url,"DbJ72GsAzT");SML.di("./BwcUp7XlaC.js",import.meta.url,"BwcUp7XlaC");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./CGFmQ-cmFf.js",import.meta.url,"CGFmQ-cmFf");SML.di("./BIvvQbZj9p.js",import.meta.url,"BIvvQbZj9p");SML.di("./CCBTR4TAfR.js",import.meta.url,"CCBTR4TAfR");SML.di("./DjACS3kR0A.js",import.meta.url,"DjACS3kR0A");SML.di("./j0TSFgPKaL.js",import.meta.url,"j0TSFgPKaL");SML.di("./DFBfgTBypk.js",import.meta.url,"DFBfgTBypk");SML.di("./0hqgxSo9Jy.js",import.meta.url,"0hqgxSo9Jy");SML.di("./DpoX9fLllS.js",import.meta.url,"DpoX9fLllS");SML.di("./Py9rIF7r2a.js",import.meta.url,"Py9rIF7r2a");
SML.dm("BkihtVv9so",["Dw4vb8Yfbm","5r73EsgItq","CFd1NJhleF","D1ScrvIqaY","YFXcK0ZyJl","D_g7f2Ewyi","BwcMg3lXAs","C2l05LS-ga","Wt225_9ix9","E3QE3c4_Ye","DbJ72GsAzT","BwcUp7XlaC","B-zFJtiar6","DFBfgTBypk","0hqgxSo9Jy","DpoX9fLllS","Py9rIF7r2a","CMwg6atOpj","KkXqW5RUm3","BAGS8uwlNZ","lxqt5OPiQh","CGFmQ-cmFf","BIvvQbZj9p","CCBTR4TAfR","DjACS3kR0A","j0TSFgPKaL"],(async(e,t,i,r,a,n,s,o,d,h,c,l,p,u,m,S,y)=>{var b;!function(e){e.PRIMARY="primary",e.SECONDARY="secondary"}(b||(b={}));var E,R,g=t.a`${e.a7}:host{border:1px solid var(--rpl-input-chip-border-color);color:var(--rpl-input-chip-text-color);background:var(--rpl-input-chip-background-color);font:var(--font-label-2);letter-spacing:var(--font-label-2-kerning)}:host([appearance=bordered]){--rpl-input-chip-border-color:var(--color-neutral-border);--rpl-input-chip-text-color:var(--color-secondary-plain);--rpl-input-chip-disabled-background-color:var(--color-interactive-content-disabled);--rpl-input-chip-disabled-text-color:var(--color-interactive-content-disabled);--rpl-input-chip-disabled-border-color:var(--color-neutral-border-weak);--rpl-input-chip-selected-background-color:var(--color-secondary-background-selected);--rpl-input-chip-selected-border-color:var(--color-neutral-border);--rpl-input-chip-hover-background-color:var(--color-secondary-background-hover)}:host([appearance=media]){--rpl-input-chip-border-color:var(--color-media-border-weak);--rpl-input-chip-background-color:var(--color-media-background);--rpl-input-chip-text-color:var(--color-media-onbackground);--rpl-input-chip-disabled-text-color:var(--color-media-onbackground-disabled);--rpl-input-chip-disabled-background-color:var(--color-media-background);--rpl-input-chip-disabled-border-color:var(--color-media-border-weak);--rpl-input-chip-hover-background-color:var(--color-media-background-hover);--rpl-input-chip-selected-background-color:var(--color-media-background-selected);--rpl-input-chip-selected-border-color:var(--color-media-border-selected)}:host([selected]){--rpl-input-chip-background-color:var(--rpl-input-chip-selected-background-color);--rpl-input-chip-border-color:var(--rpl-input-chip-selected-border-color)}:host([disabled]){--rpl-input-chip-background-color:var(--rpl-input-chip-disabled-background-color);--rpl-input-chip-border-color:var(--rpl-input-chip-disabled-border-color);--rpl-input-chip-text-color:var(--rpl-input-chip-disabled-text-color)}:host([type=in-field]){height:var(--rem20);padding:var(--rem1) 0;border-radius:var(--rem4);align-items:center}:host([type=standalone]){height:var(--rem32);padding-block:calc(var(--rem4) - var(--rem1));padding-inline-start:calc(var(--rem12) - var(--rem1));padding-inline-end:calc(var(--rem6) - var(--rem1));border-radius:var(--rem8)}:host([type=standalone][dragged]){box-shadow:0 var(--rem4) var(--rem8) 0 var(--color-elevation-medium2),0 var(--rem6) var(--rem12) 0 var(--color-elevation-medium1);--rpl-input-chip-background-color:var(--rpl-input-chip-selected-background-color);--rpl-input-chip-border-color:var(--rpl-input-chip-selected-border-color)}:host(.hover:not([disabled])),:host(:hover:not([disabled])){background:var(--rpl-input-chip-hover-background-color)}::slotted([slot=leading]){display:inline-flex;margin-inline-start:var(--spacer-2xs);height:100%}::slotted([slot=trailing]){display:inline-flex}slot:not([name]){width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:inline-block}a,button{height:100%;align-items:center}:host([type=in-field]) slot:not([name]){margin-inline-start:calc(var(--rem6) - var(--rem1))}:host([type=standalone]) ::slotted([slot=leading]){margin-block:calc(var(--rem8) - var(--rem1));margin-inline-start:calc(-1 * (var(--rem4) - var(--rem1)));margin-inline-end:var(--rem4)}:host([type=in-field]) ::slotted([slot=trailing]){margin-inline-start:calc(var(--rem6) - var(--rem1));margin-inline-end:calc(var(--rem6) - var(--rem1))}.close-icon-container{height:var(--rem24);width:var(--rem24);display:inline-flex;align-items:center;justify-content:center}`;!function(e){e.Bordered="bordered",e.Media="media"}(E||(E={})),function(e){e.Standalone="standalone",e.InField="in-field"}(R||(R={}));let v=class extends a.R{constructor(){super(...arguments),this.appearance=E.Bordered,this.type=R.InField,this.dragged=!1}static get styles(){return[a.R.styles,g]}renderTrailingContent(){return t.x`${t.A}`}render(){return t.x` ${super.render()} <slot name="trailing"></slot> `}};e._([e.n({type:String})],v.prototype,"appearance",void 0),e._([e.n({type:String})],v.prototype,"type",void 0),e._([e.n({type:Boolean})],v.prototype,"dragged",void 0),v=e._([e.e("rpl-input-chip")],v);const{svg:T}=e.a(),f=e.m(T`<path d="M4.098 17a3.098 3.098 0 01-2.192-5.291l3.647-3.647a3.104 3.104 0 014.385 0l.308.309 1.672-1.672-1.55-1.548a1.254 1.254 0 01-.271-1.373 1.254 1.254 0 011.163-.777h7.84a.9.9 0 01.9.9v7.84c0 .512-.306.968-.777 1.163a1.256 1.256 0 01-1.373-.272l-1.548-1.549-3.861 3.862c-1.172 1.17-3.213 1.17-4.385 0l-.308-.309-1.457 1.458A3.099 3.099 0 014.098 17zm3.647-8.045c-.347 0-.674.135-.92.381L3.18 12.983a1.302 1.302 0 000 1.839 1.302 1.302 0 001.838 0l2.73-2.73 1.58 1.581a1.3 1.3 0 001.839 0L16.3 8.539l1.897 1.899V4.804h-5.634l1.899 1.897-4.218 4.218-1.581-1.581a1.289 1.289 0 00-.92-.381l.002-.002z"></path>`,"0 0 20 20","trend");function k(t){return!!t&&[e.au.SearchResults,e.au.SearchResultsTrending].includes(t)}const I="reddit-recent-searches-partial-container",D="reddit-suggested-search-queries-container",N="search-input",_="search-input-remove-filter",w="search-dropdown-results-container",A="reddit-trending-searches-partial-container",$="reddit-typeahead-results-partial-container",x="/svc/shreddit",C=`${x}/trending-searches`,P={size:t.I.Small,attributes:{"aria-hidden":"true",className:"flex items-center justify-center h-100 ml-px"}};var L,O,F;function M(){return Object.entries(p.u(e.a9.SearchTypeaheadExpanded)??{}).reduce(((e,[t,i])=>(i||e.push(t),e)),[]).join(",")}!function(e){e.Backspace="pill-backspace",e.Click="pill-click"}(L||(L={})),function(e){e.SearchDropdown="search_dropdown"}(O||(O={})),function(e){e.QUERY="query",e.TRENDING="trending",e.TYPEAHEAD="typeahead",e.SUBREDDIT_POST_FLAIR="subreddit_post_flair"}(F||(F={}));class U{constructor(e){this.host=e}async fetchTypeaheadResults(){const t={[i.S.QUERY]:(a=this.host.query,a?a.toLowerCase().trimStart().replace(/\s+/g," "):""),[i.S.CONVERSATION_ID]:r.a.get(e.ea.Qf)};var a;this.host.recentSearchesController.items.length>0&&(t[i.S.RECENT_SEARCHES_COUNT]=this.host.recentSearchesController.items.length.toString());const n=M();n&&(t[i.S.COLLAPSED_SECTIONS]=n),this.host.activeSearchScopeFlair&&(t[i.S.FLAIR]=this.host.activeSearchScopeFlair);const s=new URLSearchParams(t),o=await this.host.partialRequest.request(`${x}${this.host.activeSearchScope.path}search-typeahead?${s.toString()}`);if(this.host.partialRequest.isRequestInProgress)return;const d=await(o?.text());return d?e.bk(d):void 0}}let H;const B=new Uint8Array(16);function j(){if(!H&&(H="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!H))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return H(B)}var q=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const z=[];for(let e=0;e<256;++e)z.push((e+256).toString(16).slice(1));function V(e,t=0){return(z[e[t+0]]+z[e[t+1]]+z[e[t+2]]+z[e[t+3]]+"-"+z[e[t+4]]+z[e[t+5]]+"-"+z[e[t+6]]+z[e[t+7]]+"-"+z[e[t+8]]+z[e[t+9]]+"-"+z[e[t+10]]+z[e[t+11]]+z[e[t+12]]+z[e[t+13]]+z[e[t+14]]+z[e[t+15]]).toLowerCase()}function Q(e){if(!function(e){return"string"==typeof e&&q.test(e)}(e))throw TypeError("Invalid UUID");let t;const i=new Uint8Array(16);return i[0]=(t=parseInt(e.slice(0,8),16))>>>24,i[1]=t>>>16&255,i[2]=t>>>8&255,i[3]=255&t,i[4]=(t=parseInt(e.slice(9,13),16))>>>8,i[5]=255&t,i[6]=(t=parseInt(e.slice(14,18),16))>>>8,i[7]=255&t,i[8]=(t=parseInt(e.slice(19,23),16))>>>8,i[9]=255&t,i[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,i[11]=t/4294967296&255,i[12]=t>>>24&255,i[13]=t>>>16&255,i[14]=t>>>8&255,i[15]=255&t,i}function G(e,t,i){function r(e,r,a,n){var s;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let i=0;i<e.length;++i)t.push(e.charCodeAt(i));return t}(e)),"string"==typeof r&&(r=Q(r)),16!==(null===(s=r)||void 0===s?void 0:s.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let o=new Uint8Array(16+e.length);if(o.set(r),o.set(e,r.length),o=i(o),o[6]=15&o[6]|t,o[8]=63&o[8]|128,a){n=n||0;for(let e=0;e<16;++e)a[n+e]=o[e];return a}return V(o)}try{r.name=e}catch(e){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}function K(e){return 14+(e+64>>>9<<4)+1}function Y(e,t){const i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function Z(e,t,i,r,a,n){return Y((s=Y(Y(t,e),Y(r,n)))<<(o=a)|s>>>32-o,i);var s,o}function J(e,t,i,r,a,n,s){return Z(t&i|~t&r,e,t,a,n,s)}function W(e,t,i,r,a,n,s){return Z(t&r|i&~r,e,t,a,n,s)}function X(e,t,i,r,a,n,s){return Z(t^i^r,e,t,a,n,s)}function ee(e,t,i,r,a,n,s){return Z(i^(t|~r),e,t,a,n,s)}G("v3",48,(function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let i=0;i<t.length;++i)e[i]=t.charCodeAt(i)}return function(e){const t=[],i=32*e.length,r="0123456789abcdef";for(let a=0;a<i;a+=8){const i=e[a>>5]>>>a%32&255,n=parseInt(r.charAt(i>>>4&15)+r.charAt(15&i),16);t.push(n)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[K(t)-1]=t;let i=1732584193,r=-271733879,a=-1732584194,n=271733878;for(let t=0;t<e.length;t+=16){const s=i,o=r,d=a,h=n;i=J(i,r,a,n,e[t],7,-680876936),n=J(n,i,r,a,e[t+1],12,-389564586),a=J(a,n,i,r,e[t+2],17,606105819),r=J(r,a,n,i,e[t+3],22,-1044525330),i=J(i,r,a,n,e[t+4],7,-176418897),n=J(n,i,r,a,e[t+5],12,1200080426),a=J(a,n,i,r,e[t+6],17,-1473231341),r=J(r,a,n,i,e[t+7],22,-45705983),i=J(i,r,a,n,e[t+8],7,1770035416),n=J(n,i,r,a,e[t+9],12,-1958414417),a=J(a,n,i,r,e[t+10],17,-42063),r=J(r,a,n,i,e[t+11],22,-1990404162),i=J(i,r,a,n,e[t+12],7,1804603682),n=J(n,i,r,a,e[t+13],12,-40341101),a=J(a,n,i,r,e[t+14],17,-1502002290),r=J(r,a,n,i,e[t+15],22,1236535329),i=W(i,r,a,n,e[t+1],5,-165796510),n=W(n,i,r,a,e[t+6],9,-1069501632),a=W(a,n,i,r,e[t+11],14,643717713),r=W(r,a,n,i,e[t],20,-373897302),i=W(i,r,a,n,e[t+5],5,-701558691),n=W(n,i,r,a,e[t+10],9,38016083),a=W(a,n,i,r,e[t+15],14,-660478335),r=W(r,a,n,i,e[t+4],20,-405537848),i=W(i,r,a,n,e[t+9],5,568446438),n=W(n,i,r,a,e[t+14],9,-1019803690),a=W(a,n,i,r,e[t+3],14,-187363961),r=W(r,a,n,i,e[t+8],20,1163531501),i=W(i,r,a,n,e[t+13],5,-1444681467),n=W(n,i,r,a,e[t+2],9,-51403784),a=W(a,n,i,r,e[t+7],14,1735328473),r=W(r,a,n,i,e[t+12],20,-1926607734),i=X(i,r,a,n,e[t+5],4,-378558),n=X(n,i,r,a,e[t+8],11,-2022574463),a=X(a,n,i,r,e[t+11],16,1839030562),r=X(r,a,n,i,e[t+14],23,-35309556),i=X(i,r,a,n,e[t+1],4,-1530992060),n=X(n,i,r,a,e[t+4],11,1272893353),a=X(a,n,i,r,e[t+7],16,-155497632),r=X(r,a,n,i,e[t+10],23,-1094730640),i=X(i,r,a,n,e[t+13],4,681279174),n=X(n,i,r,a,e[t],11,-358537222),a=X(a,n,i,r,e[t+3],16,-722521979),r=X(r,a,n,i,e[t+6],23,76029189),i=X(i,r,a,n,e[t+9],4,-640364487),n=X(n,i,r,a,e[t+12],11,-421815835),a=X(a,n,i,r,e[t+15],16,530742520),r=X(r,a,n,i,e[t+2],23,-995338651),i=ee(i,r,a,n,e[t],6,-198630844),n=ee(n,i,r,a,e[t+7],10,1126891415),a=ee(a,n,i,r,e[t+14],15,-1416354905),r=ee(r,a,n,i,e[t+5],21,-57434055),i=ee(i,r,a,n,e[t+12],6,1700485571),n=ee(n,i,r,a,e[t+3],10,-1894986606),a=ee(a,n,i,r,e[t+10],15,-1051523),r=ee(r,a,n,i,e[t+1],21,-2054922799),i=ee(i,r,a,n,e[t+8],6,1873313359),n=ee(n,i,r,a,e[t+15],10,-30611744),a=ee(a,n,i,r,e[t+6],15,-1560198380),r=ee(r,a,n,i,e[t+13],21,1309151649),i=ee(i,r,a,n,e[t+4],6,-145523070),n=ee(n,i,r,a,e[t+11],10,-1120210379),a=ee(a,n,i,r,e[t+2],15,718787259),r=ee(r,a,n,i,e[t+9],21,-343485551),i=Y(i,s),r=Y(r,o),a=Y(a,d),n=Y(n,h)}return[i,r,a,n]}(function(e){if(0===e.length)return[];const t=8*e.length,i=new Uint32Array(K(t));for(let r=0;r<t;r+=8)i[r>>5]|=(255&e[r/8])<<r%32;return i}(e),8*e.length))}));var te={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function ie(e,t,i){if(te.randomUUID&&!e)return te.randomUUID();const r=(e=e||{}).random||(e.rng||j)();return r[6]=15&r[6]|64,r[8]=63&r[8]|128,V(r)}function re(e,t,i,r){switch(e){case 0:return t&i^~t&r;case 1:case 3:return t^i^r;case 2:return t&i^t&r^i&r}}function ae(e,t){return e<<t|e>>>32-t}G("v5",80,(function(e){const t=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let i=0;i<t.length;++i)e.push(t.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const r=e.length/4+2,a=Math.ceil(r/16),n=new Array(a);for(let t=0;t<a;++t){const i=new Uint32Array(16);for(let r=0;r<16;++r)i[r]=e[64*t+4*r]<<24|e[64*t+4*r+1]<<16|e[64*t+4*r+2]<<8|e[64*t+4*r+3];n[t]=i}n[a-1][14]=8*(e.length-1)/Math.pow(2,32),n[a-1][14]=Math.floor(n[a-1][14]),n[a-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<a;++e){const r=new Uint32Array(80);for(let t=0;t<16;++t)r[t]=n[e][t];for(let e=16;e<80;++e)r[e]=ae(r[e-3]^r[e-8]^r[e-14]^r[e-16],1);let a=i[0],s=i[1],o=i[2],d=i[3],h=i[4];for(let e=0;e<80;++e){const i=Math.floor(e/20),n=ae(a,5)+re(i,s,o,d)+h+t[i]+r[e]>>>0;h=d,d=o,o=ae(s,30)>>>0,s=a,a=n}i[0]=i[0]+a>>>0,i[1]=i[1]+s>>>0,i[2]=i[2]+o>>>0,i[3]=i[3]+d>>>0,i[4]=i[4]+h>>>0}return[i[0]>>24&255,i[0]>>16&255,i[0]>>8&255,255&i[0],i[1]>>24&255,i[1]>>16&255,i[1]>>8&255,255&i[1],i[2]>>24&255,i[2]>>16&255,i[2]>>8&255,255&i[2],i[3]>>24&255,i[3]>>16&255,i[3]>>8&255,255&i[3],i[4]>>24&255,i[4]>>16&255,i[4]>>8&255,255&i[4]]}));const ne=/^m\/([\w+-]+)\/?/,se=/^r\/([\w+-]+)\/?/,oe=/^u\/([\w+-]+)\/?/;class de{constructor(t){this._items=null,this.syncWithAnotherInstance=e=>{this._items=e.items},this.removeItem=e=>{this.items=this.items.filter((t=>t.uuid!==e)),this.host.requestUpdate()},this.addItem=({clickedElement:e,flairData:t,type:i})=>{const r=this.buildRecentSearchItem({clickedElement:e,flairData:t,type:i});if(!r)return;const a=this.items.filter((e=>e.path!==r.path));a.length>=this.host.maxRecentSearches&&a.pop(),a.unshift(r),this.items=a},this.moveItemToTop=e=>{let t;const i=this.items.reduce(((i,r)=>(r.uuid===e?t=r:i.push(r),i)),[]);t&&(i.unshift(t),this.items=i)},this.extractDropdownItemTrackingContext=t=>{const i=t?.closest(`[data-type="${e.iD}"]`)?.getAttribute("data-faceplate-tracking-context")??"{}";return JSON.parse(i)},this.extractDropdownItemName=t=>t?.querySelector(`[data-type="${e.iE}"]`)?.textContent,this.buildDropdownItemTrackingContext=(e,t)=>{const i=this.extractDropdownItemTrackingContext(t);return i.search={...e.search,...i.search},delete i.search.impression_id,delete i.search.conversation_id,i},this.getClickedElementHref=t=>{const i=new URL(t.href);return i.searchParams.delete(e.cn.ConversationId),i.searchParams.delete(e.cn.ImpressionId),i.toString()},this.buildTrendingRecentSearchItem=({baseTrackingContext:e,clickedElement:t,query:r,uuid:a})=>{if(!t)return null;const n=this.getClickedElementHref(t),s=this.extractDropdownItemName(t);if(!s||!n)return null;return{name:s,path:n,rawQuery:r,trackingContext:this.buildDropdownItemTrackingContext(e,t),type:i.a.QUERY,uuid:a}},this.buildTypeaheadRecentSearchItem=({baseTrackingContext:e,clickedElement:t,query:r,uuid:a})=>{if(!t)return null;const n=this.getClickedElementHref(t),s=this.extractDropdownItemName(t);if(!s||!n)return null;const o=this.buildDropdownItemTrackingContext(e,t),d=t.querySelector("faceplate-img,img")?.src,h=!!t.getElementsByClassName("text-alert-caution").length,c=!!t.getElementsByClassName("text-category-nsfw").length;let l=i.a.QUERY;return se.test(s)?l=i.a.SUBREDDIT:ne.test(s)?l=i.a.MULTIREDDIT:oe.test(s)&&(l=i.a.PROFILE),{icon:d,isNsfw:c,isQuarantined:h,name:s,path:n,rawQuery:r,trackingContext:o,type:l,uuid:a}},this.buildSubredditPostFlairRecentSearchItem=({baseTrackingContext:e,flairData:t,uuid:r})=>{if(!t)return null;const a=t?.href,n=t?.chip,s=`${p.cW(this.host.activeSearchScope)}`;if(!n||!a||!s)return null;const o=this.host.subreddit?.communityIcon;return{flair:n,icon:o,name:s,path:a,rawQuery:"",trackingContext:e,type:i.a.SUBREDDIT,uuid:r}},this.buildQueryRecentSearchItem=({baseTrackingContext:t,query:r,uuid:a})=>{if(!r)return null;const{activeSearchScope:n,multireddit:s,profile:o,subreddit:d}=this.host,h=p.cW(n),c={[e.aa.GLOBAL]:"",[e.aa.COMMUNITY]:d?.communityIcon,[e.aa.CUSTOM_FEED]:s?.icon,[e.aa.PROFILE]:o?.icon}[n.type],l=r.trim();let u=l;n.type!==e.aa.GLOBAL&&(u=`${h} ${u}`);return{icon:c,name:u,path:e.iF({cursor:{},query:l,scope:n}),rawQuery:r,trackingContext:t,type:i.a.QUERY,uuid:a}},this.buildRecentSearchItem=({clickedElement:e,flairData:t,type:i})=>{const{activeSearchScope:r,query:a}=this.host,n={search:{query:a,scope_path:r.path,scope_type:r.type}},s=ie();switch(i){case F.TRENDING:return this.buildTrendingRecentSearchItem({baseTrackingContext:n,clickedElement:e,query:a,uuid:s});case F.TYPEAHEAD:return this.buildTypeaheadRecentSearchItem({baseTrackingContext:n,clickedElement:e,query:a,uuid:s});case F.SUBREDDIT_POST_FLAIR:return this.buildSubredditPostFlairRecentSearchItem({baseTrackingContext:n,flairData:t,uuid:s});case F.QUERY:return this.buildQueryRecentSearchItem({baseTrackingContext:n,query:a,uuid:s})}},this.host=t}hostDisconnected(){this._items=null}get items(){return this._items=this._items??p.u(e.a9.RecentSearches)??[],this._items}set items(t){this._items=t,p.r(e.a9.RecentSearches,t)}}class he extends t.s{constructor(){super(...arguments),this.scope=e.iG,this.scopedTypeaheadVariant="",this.scopedTypeaheadExperimentName="",this.scopedTypeaheadExperimentVersion="",this.askButtonVariant="",this.askButtonExperimentName="",this.askButtonExperimentVersion="",this.homeRevampVariant="",this.homeRevampExperimentName="",this.homeRevampExperimentVersion="",this.typeaheadDebounceVariant="",this.typeaheadDebounceExperimentName="",this.typeaheadDebounceExperimentVersion="",this.mobileExpandSearchBar=!1,this.isPdpSeekerM2=!1,this.isPdpMwebSimplificationSearchVariant=!1,this.openSearchInSeekerPostQueue=!1,this.suggestedSearchQueries=[],this.showFiltersEntrypoint=!1,this.isSduiZeroStateEnabled=!1,this.typeaheadDebounceDelay=300,this.maxRecentSearches=e.iH,this.showAskButton=!1,this.showAskText=!1,this.showSnooLeadingIcon=!1,this.globalLeaveScreenEventEnabled=!1,this.homeRevampEnabled=!1,this.query="",this.isSearchScopeEnabled=!1,this.trendingSearches=null,this.isFocused=!1,this.typeaheadResults=null,this.showDropdown=!1,this.loadingSearchResults=!1,this.hasFiredScopedTypeaheadExposeEvent=!1,this.hasFiredAskButtonExposeEvent=!1,this.hasFiredHomeRevampExposeEvent=!1,this.hasFiredTypeaheadDebounceExposeEvent=!1,this.isScopedTypeaheadEnabled=!1,this.isScopedTypeaheadPrimaryAdjusterDismissed=!1,this.isScopedTypeaheadSecondaryAdjusterDismissed=!1,this.hasEditedQuery=!1,this.hasFiredDropdownShownInFocusSession=!1,this.isFiltersEntrypointEnabled=!1,this.getPageType=e.H,this.partialRequest=new e.aS(this),this.exposeClientExperiment=e.b5,this.activateFeature=e.r,this.pubsub=new e.u(this),this.sduiTypeaheadRequestController=new U(this),this.recentSearchesController=new de(this),this.searchScrollBlockingController=null,this.handleDeleteRecentSearchItem=(e,t)=>{e.stopPropagation(),e.preventDefault(),this.recentSearchesController.removeItem(t)},this.handleRecentSearchDataUpdate=(e,t,i)=>{let r;t&&t.target instanceof HTMLElement&&(r="menuitem"===t.target.role?t.target:t.target.closest('[role="menuitem"]')),this.recentSearchesController.addItem({clickedElement:r??void 0,flairData:i,type:e})},this.debouncedSearch=()=>{this.debounceHandler||(this.debounceHandler=e.ao(this.fetchTypeaheadResults,this.typeaheadDebounceDelay)),this.debounceHandler(),this.maybeFireTypeaheadDebounceExposure()},this.handleSearchTypeaheadScopeAdjusterDismiss=({scopedTypeaheadChipDismissed:e})=>{e===b.PRIMARY?(this.isScopedTypeaheadPrimaryAdjusterDismissed=!0,this.isScopedTypeaheadSecondaryAdjusterDismissed=!0,this.isSearchScopeEnabled=!1):e===b.SECONDARY&&(this.isScopedTypeaheadSecondaryAdjusterDismissed=!0),this.typeaheadResults=null,this.focusSearchInput(),this.maybeFetchDropdownItems()},this.handleSearchTypeaheadFlairClick=e=>{this.handleRecentSearchDataUpdate(F.SUBREDDIT_POST_FLAIR,void 0,e)},this.handlePageDataReceived=t=>{const{profile:i,search:r,subreddit:a,multireddit:n}=t;r?.query&&this.pageType===e.au.SearchResults&&(this.query=r.query),this.subreddit=a||void 0,this.profile=i||void 0,this.multireddit=n||void 0},this.handleEmptyTypeahead=()=>{this.typeaheadResults=null,this.maybeFetchDropdownItems()},this.handleSearchInput=e=>{this.handleQueryChange(e.target.value)},this.handleQueryChange=t=>{this.query!==t&&(r.S.update(e.ea.Qf),this.query=t,this.hasEditedQuery=!0,t?this.query&&this.debouncedSearch():this.handleEmptyTypeahead())},this.handleSubmit=(e,t=this.activeSearchScope)=>{e.preventDefault(),this.isPdpSeekerM2?this.reloadPostQueueOrRedirect(this.query):(this.handleRecentSearchDataUpdate(F.QUERY),this.redirect(this.getSearchUrl(t)))},this.redirect=e.c9,this.handleClear=()=>{this.handleQueryChange(""),this.input&&this.input.checkVisibility()&&(this.input.value="",this.input.focus())},this.focusSearchInput=()=>{this.input?.focus()},this.handleRemoveFilter=t=>{this.isSearchScopeEnabled&&this.searchScopePillDismissButton&&(e.i(this.searchScopePillDismissButton,{source:"search",action:"click",noun:"disable_scope",action_info:{type:t}}),this.typeaheadResults=null,this.isSearchScopeEnabled=!1,this.focusSearchInput(),this.maybeFetchDropdownItems())},this.handleFilterClick=e=>{e.preventDefault()},this.resetIsSearchScopeEnabled=()=>{this.isSearchScopeEnabled=this.isSearchScopeInitiallyEnabled},this.updateFlairExpansionState=t=>{this.pubsub.publish(e.T.SearchFlairExpansionStateChanged,{isExpanded:t})},this.handleClickAway=e=>{e.target===this||this.shadowRoot.contains(e.target)||this.handleBlur()},this.handleScreenLeaveTracking=()=>{const t=this.closest("shreddit-app"),i=t?._visibilityChange._screenviewId;if(this.globalLeaveScreenEventEnabled){const t={action_info:{page_type:e.au.SearchDropdown},screenview_id:i};e.i(this,{source:"global",action:"leave",noun:"screen",...t})}t?.screenInstanceIdController.clearCustomId()},this.handleTrendingSearchesClick=e=>{this.handleRecentSearchDataUpdate(F.TRENDING,e),this.isPdpSeekerM2&&this.handlePostQueueActionForItem(e)},this.maybeUpdateDropdownState=()=>{const e=Boolean(this.isFocused&&(this.query&&this.typeaheadResults||!this.query&&this.trendingSearches||!this.query&&this.isSearchScopeEnabled&&this.isScopedTypeaheadEnabled&&this.typeaheadResults));this.searchIsVisible&&this.showDropdown!==e&&(!this.showDropdown&&e?(this.showDropdown=!0,this.hasFiredDropdownShownInFocusSession||this.handleDropdownShown()):this.showDropdown=!1)},this.handleDropdownShown=()=>{this.closest("shreddit-app")?.screenInstanceIdController.requestCustomId("search-dropdown"),e.i(this.searchDropdownResultsContainer,{source:"global",action:"view",noun:"screen",action_info:{page_type:e.au.SearchDropdown}}),this.dispatchEvent(new Event(p.an)),this.hasFiredDropdownShownInFocusSession=!0},this.renderSeekerSearchQueries=e=>t.x` ${this.isPdpMwebSimplificationSearchVariant?this.renderSubHeader("Suggested"):t.A} <ul role="menu" id="${D}" @keydown="${this.handleDropdownKeyDown}" class="m-0 p-0 list-none"> ${e.map((e=>n.l({attributes:{className:"suggested-search-item",role:"menuitem",tabindex:"-1","data-label":e},onClick:()=>{this.reloadPostQueueOrRedirect(e)},label:t.x`<div class="text-neutral-content">${e}</div>`,size:n.L.Small,leadingIcon:y.s({size:t.I.Small})})))} </ul> `,this.handlePostQueueActionForItem=e=>{const t=e.target?.closest("li");t&&t.dataset.label&&(e.preventDefault(),this.reloadPostQueueOrRedirect(t.dataset.label))},this.handleRecentSearchClick=(e,t)=>{this.recentSearchesController.moveItemToTop(t.uuid),this.isPdpSeekerM2&&t.type===i.a.QUERY&&t.name&&(e.preventDefault(),this.reloadPostQueueOrRedirect(t.name))},this.renderRecentSearchItem=i=>{const{trackingContext:r}=i,a=e.o({appearance:"plain",attributes:{className:e.gY,slot:"dismiss-button-container",tabindex:"-1"},leadingIcon:s.c({size:t.I.Small}),screenReaderContent:this.getRecentSearchDeleteButtonScreenReaderContent(i.name),shape:"pill",size:e.q.Small});return t.x` <faceplate-tracker source="search" action="click" noun="recent_search" data-type="search-dropdown-item" data-faceplate-tracking-context="${e.ad(r&&JSON.stringify(r))}"> <faceplate-tracker source="search" action="view" noun="recent_search" loading-modifier="${e.iI.Always}" role="none"> <recent-search-item .recentSearchItem="${i}" .onClickLink="${e=>this.handleRecentSearchClick(e,i)}" .onClickDismiss="${e=>this.handleDeleteRecentSearchItem(e,i.uuid)}" .size="${this.isPdpMwebSimplificationSearchVariant?n.L.Small:n.L.Medium}">${a}</recent-search-item> </faceplate-tracker> </faceplate-tracker> `},this.handleShowFiltersEntrypointUpdate=({isEnabled:e})=>{this.isFiltersEntrypointEnabled=e}}static get styles(){return[e.t,e.a0(".search-input {\n  -webkit-appearance: none;\n}\n.search-input::-webkit-search-cancel-button {\n  display: none;\n}\n@media screen and (max-width: 768px) {\n  faceplate-search-input {\n    --font-14-20-regular: var(--font-16-20-regular);\n  }\n}\n.search-input-wrapper {\n  display: flex;\n  position: relative;\n  border-radius: var(--radius-full);\n}\n.search-input-gradient {\n  --color-secondary-background: var(--color-neutral-background);\n  --color-input-secondary: var(--color-neutral-background);\n  --color-input-secondary-hover: var(--color-neutral-background-hover);\n  position: relative;\n  height: var(--rem40);\n  border: 1px solid var(--color-neutral-border);\n  border-radius: var(--radius-full);\n  background-color: var(--color-neutral-background);\n}\n.search-input-gradient faceplate-search-input {\n  --color-input-plain-border: transparent;\n  --color-input-border: transparent;\n}\n.search-input-gradient > * {\n  position: relative;\n  z-index: 1;\n}\n.search-input-gradient:not(:focus-within) {\n  border-color: transparent;\n}\n.search-input-gradient:not(:focus-within)::before {\n  content: '';\n  position: absolute;\n  inset: -1px;\n  border: inherit;\n  border-radius: inherit;\n  background: linear-gradient(var(--color-neutral-background), var(--color-neutral-background)) padding-box, linear-gradient(90deg, var(--color-global-brand-orangered), #FFBF0B) border-box;\n  pointer-events: none;\n}\n.search-input-gradient:not(:focus-within)::after {\n  content: '';\n  position: absolute;\n  inset: -1px;\n  border: inherit;\n  border-radius: inherit;\n  background: linear-gradient(var(--color-neutral-background), var(--color-neutral-background)) padding-box, linear-gradient(90deg, var(--color-global-brand-orangered), #FFBF0B) border-box;\n  z-index: -1;\n  filter: blur(4px);\n  opacity: 0.75;\n  pointer-events: none;\n}\n.last-dropdown-item [role='menuitem'],\n.last-dropdown-item:hover [role='menuitem'],\n.last-dropdown-item:active [role='menuitem'],\n.last-dropdown-item:focus [role='menuitem'] {\n  border-bottom-left-radius: 1.25rem;\n  border-bottom-right-radius: 1.25rem;\n}\n.last-dropdown-section:not([open]) summary,\n.last-dropdown-section:not([open]):hover summary,\n.last-dropdown-section:not([open]):active summary,\n.last-dropdown-section:not([open]):focus summary,\n.last-dropdown-section:not([open]) summary [tabindex='-1'],\n.last-dropdown-section:not([open]):hover summary [tabindex='-1'],\n.last-dropdown-section:not([open]):active summary [tabindex='-1'],\n.last-dropdown-section:not([open]):focus summary [tabindex='-1'] {\n  border-bottom-left-radius: 1.25rem;\n  border-bottom-right-radius: 1.25rem;\n}\n")]}connectedCallback(){super.connectedCallback(),this.pageType=this.getPageType(),this.isSearchScopeEnabled=this.isSearchScopeInitiallyEnabled,this.isScopedTypeaheadEnabled=e.iJ(this.scopedTypeaheadVariant),this.query=this.initialQuery??"",this.pubsub.subscribe(e.T.PageDataLoaded,this.handlePageDataReceived),this.shouldFireExposureOnRender()&&this.maybeFireScopedTypeaheadExposure(),this.omitDynamicId&&(r.a.shouldOverrideId=!0,r.S.shouldOverrideId=!0,r.b.shouldOverrideId=!0),this.isSearchScopeEnabled&&this.isScopedTypeaheadEnabled&&(this.pubsub.subscribe(e.T.SearchTypeaheadScopeAdjusterDismiss,this.handleSearchTypeaheadScopeAdjusterDismiss,!1),this.pubsub.subscribe(e.T.SearchTypeaheadFlairClick,this.handleSearchTypeaheadFlairClick,!1)),this.showFiltersEntrypoint&&k(this.pageType)&&this.pubsub.subscribe(e.T.SearchShowFiltersEntrypoint,this.handleShowFiltersEntrypointUpdate)}disconnectedCallback(){super.disconnectedCallback(),this.isFiltersEntrypointEnabled=!1,this.handleBlur(),this.typeaheadResults=null,this.trendingSearches=null}updated(e){this.loadingSearchResults&&(e.has("typeaheadResults")||e.has("trendingSearches"))&&(this.loadingSearchResults=!1)}getAdParam(){return new URL(window.location.href).searchParams.get(e.cn.Ad)}hydrateSduiRecentSearches(t){if(!t)return;const r=t.reduce(((e,t)=>{if(t.tagName.toLowerCase()===i.R)e.push(t);else{t.querySelectorAll(i.R).forEach((t=>e.push(t)))}return e}),[]);for(let t=0;t<r.length&&t<this.recentSearchesController.items.length;t++){const i=r[t],a=this.recentSearchesController.items[t];i.recentSearchItem=a;const n=i.closest(`.${e.iK}`);n&&a.trackingContext&&n.setAttribute("data-faceplate-tracking-context",JSON.stringify(a.trackingContext));const s=i.querySelector(`.${e.gY}`);s&&(s.ariaLabel=this.getRecentSearchDeleteButtonScreenReaderContent(a.name)),i.onClickLink=e=>this.handleRecentSearchClick(e,a),i.onClickDismiss=t=>{this.handleDeleteRecentSearchItem(t,a.uuid),i.remove(),0===this.recentSearchesController.items.length&&this.trendingSearchesContainer?.querySelector(`[id$="${e.iL}"]`)?.remove()}}}async fetchTrendingSearches(){if(this.isSearchScopeEnabled)return;let t;if(this.loadingSearchResults=!0,this.isSduiZeroStateEnabled)t=await this.sduiTypeaheadRequestController.fetchTypeaheadResults(),this.hydrateSduiRecentSearches(t);else{const i=this.getAdParam(),a=new URLSearchParams({[e.cn.ConversationId]:r.a.get(e.ea.Qf),...(i ? {[e.cn.Ad]:i} : {})}),n=await this.partialRequest.request(`${C}?${a.toString()}`),s=await(n?.text());t=s?e.bk(s):void 0}t&&this.trendingSearchesContainer&&(this.isSduiZeroStateEnabled||function(t){const i=t.find((t=>t.attributes.getNamedItem(e.iU.IsPromoted)));i&&i.querySelector("[role=menuitem]")?.addEventListener("keydown",(function(e){"Enter"===e.key&&e.target?.dispatchEvent(new MouseEvent("click",{bubbles:!0}))}))}(t),this.trendingSearches=t)}async fetchTypeaheadResults(){const e=this.isSearchScopeEnabled&&!this.isScopedTypeaheadPrimaryAdjusterDismissed&&!this.isScopedTypeaheadEnabled&&!this.query,t=!this.isSearchScopeEnabled&&!this.query;if(e||t)return;this.loadingSearchResults=!0;const i=await this.sduiTypeaheadRequestController.fetchTypeaheadResults();i&&this.typeaheadResultsContainer&&(this.typeaheadResults=i)}get isSearchScopeInitiallyEnabled(){return this.scope.type!==e.aa.GLOBAL&&!document.querySelector("#shreddit-forbidden")}get isSearchSmall(){return this.tagName.toLowerCase()===e.s.SearchInputSmall}get activeSearchScope(){return this.isSearchScopeEnabled?this.scope:e.iG}get activeSearchScopeFlair(){const t=this.scope.type===e.aa.COMMUNITY&&this.scope.flair;return t&&this.isSearchScopeEnabled&&!this.isScopedTypeaheadSecondaryAdjusterDismissed?t:void 0}async maybeFetchDropdownItems(){const e=!this.query,t=!!this.trendingSearches,i=!!this.typeaheadResults,{isSearchScopeEnabled:r,isScopedTypeaheadEnabled:a}=this;r&&this.maybeFireScopedTypeaheadExposure(),!e||t||r?e&&(!a||t)||i||this.debouncedSearch():this.fetchTrendingSearches()}handleFocus(){this.isFocused||(this.isFocused=!0,this.isPdpMwebSimplificationSearchVariant&&(this.placeholderText=""),e.i(this.input,{source:"search",action:"click",noun:"search_bar"}),this.mobileExpandSearchBar&&e.i(this.input,{source:"nav",action:"click",noun:"search_opened"}),this.searchScrollBlockingController?.blockPageScrollingForSearch(),this.maybeFetchDropdownItems(),this.updateFlairExpansionState(!1),this.isSearchSmall&&(this.homeRevampVariant&&!this.hasFiredHomeRevampExposeEvent&&this.maybeFireHomeRevampExposure(),this.askButtonVariant&&!this.hasFiredAskButtonExposeEvent&&this.maybeFireAskButtonExposure()),window.requestAnimationFrame((()=>{window.addEventListener("click",this.handleClickAway)})))}handleBlur(){this.input?.blur(),this.isFocused=!1,window.removeEventListener("click",this.handleClickAway),this.searchScrollBlockingController?.unblockPageScrollingForSearch(),r.S.update(e.ea.Qf),r.a.set(e.ea.Qf),this.typeaheadResults=null,this.trendingSearches=null,this.hasFiredDropdownShownInFocusSession=!1,this.isScopedTypeaheadEnabled&&(this.isScopedTypeaheadPrimaryAdjusterDismissed||this.isScopedTypeaheadSecondaryAdjusterDismissed)&&(this.isScopedTypeaheadPrimaryAdjusterDismissed=!1,this.isScopedTypeaheadSecondaryAdjusterDismissed=!1,this.resetIsSearchScopeEnabled()),this.updateFlairExpansionState(!1),this.hasFiredTypeaheadDebounceExposeEvent=!1}getSearchUrl(t){return e.iF({conversationId:r.a.get(e.ea.Qf),cursor:{},impressionId:r.S.getUUID(),query:this.query,flair:this.activeSearchScopeFlair,scope:t})}get searchTelemetryData(){const t={action_info:{pane_name:O.SearchDropdown},search:{conversation_id:r.a.get(e.ea.Qf),impression_id:r.S.get(e.ea.Qf),origin_element:"search_bar",origin_page_type:this.pageType??"",query:this.query,query_id:r.b.get({query:this.query,scope:e.iG},e.ea.Qf),range:e.iM.ALL,sort:e.iN,typeahead_active:this.isFocused}};if(this.isSearchScopeEnabled||this.isSearchScopeTelemetryExperimentEnabled){const{type:i,path:r}=this.isSearchScopeEnabled?this.scope:e.iG;t.search=((t,i,{subreddit_id:r,subreddit_name:a,custom_feed_id:n,scope_type:s,scope_id:o,scope_name:d,scope_path:h}={},c)=>{if(c){const e={...(d ? {scope_name:d} : {}),...(o ? {scope_id:o} : {})};return{...t,...e,scope_type:s,scope_path:h}}return{[e.aa.COMMUNITY]:{...t,subreddit_id:r,subreddit_name:a},[e.aa.CUSTOM_FEED]:{...t,custom_feed_id:n},[e.aa.PROFILE]:t,[e.aa.GLOBAL]:t,[e.aa.PDP]:t}[i]})(t.search,i,{scope_id:this.isSearchScopeEnabled?this.subreddit?.id:"",scope_name:this.isSearchScopeEnabled?this.subreddit?.name:"",scope_type:i,scope_path:r,subreddit_id:this.subreddit?.id,subreddit_name:this.subreddit?.name,custom_feed_id:this.multireddit?.path},this.isSearchScopeTelemetryExperimentEnabled)}return t}handleTypeaheadResultsClick(t,i=F.TYPEAHEAD){const r=document.querySelector("shreddit-good-visit-tracker");r&&(r.pageType=e.au.SearchDropdown,r.setScreenViewData({...this.searchTelemetryData,action_info:{...this.searchTelemetryData.action_info,page_type:e.au.SearchDropdown}})),this.handleRecentSearchDataUpdate(i,t),this.isPdpSeekerM2&&this.handlePostQueueActionForItem(t)}get searchIsVisible(){return!0}willUpdate(){this.maybeUpdateDropdownState()}handleDropdownKeyDown(e){"Enter"===e.key&&this.isPdpSeekerM2&&this.handlePostQueueActionForItem(e)}handleKeyDown(t){if("Backspace"!==t.key||this.query||this.scope.type===e.aa.GLOBAL){if("Enter"===t.key&&this.query&&t.target.id===N){const{activeSearchScope:i}=this;e.i(this.input,{...e.iO,source:this.getFullSearchButtonSource()}),this.handleSubmit(t,i)}}else this.isScopedTypeaheadEnabled||this.handleRemoveFilter(L.Backspace)}renderSearchInput(i=!1,r){let a=this.placeholderText||p.cX(this.activeSearchScope,this.mobileExpandSearchBar,this.showAskButton,this.homeRevampEnabled);a=this.isPdpMwebSimplificationSearchVariant&&!this.isFocused?this.suggestedSearchQueries[0]:a;const n={action_info:{type:`input-${this.activeSearchScope.type}`}},o=i&&(this.showAskButton||this.homeRevampEnabled)&&!this.isSearchScopeEnabled&&!this.isFocused,d=i||!this.isSearchScopeEnabled||this.isSearchScopeEnabled&&this.isScopedTypeaheadEnabled||this.mobileExpandSearchBar&&!this.isFocused&&!this.showDropdown;return t.x` <faceplate-search-input @focus="${this.handleFocus}" @input="${this.handleSearchInput}" @keydown="${this.handleKeyDown}" class="search-input m-0 flex-1 w-full outline-none p-0 font-sans placeholder:text-neutral-content-weak${r??""}" data-faceplate-tracking-context="${JSON.stringify(n)}" autocomplete="off" enterkeyhint="search" id="${N}" inputmode="" maxlength="${128}" name="q" novalidate placeholder="${d?a:""}" ?center-placeholder="${o}" role="search" type="search" value="${l.l(this.query)}">${this.renderLeadingIcon()} ${this.renderScopedSearchPill()} ${e.o({attributes:{className:this.mobileExpandSearchBar&&!this.isFocused?"hidden":"",id:"search-input-clear-button",slot:"clearIcon",type:"button",onclick:this.handleClear,style:!this.showAskButton&&!this.homeRevampEnabled||!this.isSearchScopeEnabled&&this.showAskButton?"":"margin-inline-start: 2px;"},appearance:"plain",size:e.q.Small,screenReaderContent:"Clear search",leadingIcon:this.showAskButton||this.homeRevampEnabled?e.al({size:t.I.Small,attributes:{style:"color: var(--color-neutral-content-weak);"}}):s.c({size:t.I.Small})})} ${this.showAskButton&&!this.isSearchScopeEnabled?t.x`<div slot="trailingContent">${this.renderAskButton()}</div>`:t.A} </faceplate-search-input>`;}handleShowFiltersEntrypointClick(){this.pubsub.publish(e.T.SearchActivateFilterModal)}renderShowFiltersEntryPoint(){if(!this.shouldShowFiltersEntrypoint||this.isSearchSmall&&this.isFocused)return t.A;let i="ms-xs",r=e.q.Medium;return this.isSearchSmall&&(i="ms-[var(--rem6)]",r=e.q.Small),t.x`<rpl-dialog-trigger dialog-id="${e.iP}">${e.o({appearance:"plain",attributes:{"aria-label":"Open filters menu",className:i,onclick:this.handleShowFiltersEntrypointClick,type:"button"},leadingIcon:m.f({size:t.I.Medium}),size:r})}</rpl-dialog-trigger>`;}async maybeFireScopedTypeaheadExposure(){this.scopedTypeaheadVariant&&!this.hasFiredScopedTypeaheadExposeEvent&&this.exposeClientExperiment({experimentName:this.scopedTypeaheadExperimentName,experimentVersion:this.scopedTypeaheadExperimentVersion,variant:this.scopedTypeaheadVariant}).then((()=>{this.hasFiredScopedTypeaheadExposeEvent=!0})).catch((()=>{}))}async maybeFireAskButtonExposure(){this.askButtonVariant&&!this.hasFiredAskButtonExposeEvent&&(this.hasFiredAskButtonExposeEvent=!0,this.exposeClientExperiment({experimentName:this.askButtonExperimentName,experimentVersion:this.askButtonExperimentVersion,variant:this.askButtonVariant}).then((()=>{})).catch((()=>{})))}async maybeFireHomeRevampExposure(){this.homeRevampVariant&&!this.hasFiredHomeRevampExposeEvent&&this.showAskButton&&this.exposeClientExperiment({experimentName:this.homeRevampExperimentName,experimentVersion:this.homeRevampExperimentVersion,variant:this.homeRevampVariant}).then((()=>{this.hasFiredHomeRevampExposeEvent=!0})).catch((()=>{}))}async maybeFireTypeaheadDebounceExposure(){this.typeaheadDebounceVariant&&!this.hasFiredTypeaheadDebounceExposeEvent&&(this.hasFiredTypeaheadDebounceExposeEvent=!0,this.exposeClientExperiment({experimentName:this.typeaheadDebounceExperimentName,experimentVersion:this.typeaheadDebounceExperimentVersion,variant:this.typeaheadDebounceVariant}).catch((()=>{})))}reloadPostQueueOrRedirect(t){if(!this.openSearchInSeekerPostQueue)return this.handleQueryChange(t),this.handleBlur(),this.handleRecentSearchDataUpdate(F.QUERY),void this.redirect(this.getSearchUrl(this.activeSearchScope));this.activateFeature({name:e.ca,queryParams:{context:u.a.PostQuerySearch,q:t,forceScrollToTop:"true",forceLoadFirstPdp:"true",triggerGoodVisit:"true"},renderMode:e.P.Contents}),this.handleQueryChange(t),this.handleBlur()}getRecentSearchDeleteButtonScreenReaderContent(e){return `Delete ${e} from recent searches`;}renderLeadingIcon(){return this.isSearchSmall&&(this.showAskButton||this.homeRevampEnabled)?t.x`<span slot="leadingIcon"></span>`:this.showSnooLeadingIcon?t.x`${e.cO(`<svg\n      slot="leadingIcon"\n      style="margin-inline-start: calc(-1 * var(--spacer-sm))"\n      width="28"\n      height="28"\n      xmlns="http://www.w3.org/2000/svg"\n      viewBox="0 0 256 256"\n      xml:space="preserve"\n      xmlns:xlink="http://www.w3.org/1999/xlink"\n    >${e.iQ}</svg>`)}`:t.A}renderSubHeader(i,r=e.Z({hidden:this.query})){return t.x`<div class="ms-md mt-sm mb-2xs text-neutral-content-weak text-12 font-semibold ${r}"> ${i} </div>`}renderRecentSearches(i){const r=(i?this.recentSearchesController.items.slice(0,i):this.recentSearchesController.items).map(this.renderRecentSearchItem);return t.x` ${this.isPdpMwebSimplificationSearchVariant?this.renderSubHeader("Recent"):t.A} <div class="w-full ${e.Z({hidden:this.query,"border-b-sm":!this.isPdpMwebSimplificationSearchVariant,"border-solid":!this.isPdpMwebSimplificationSearchVariant,"border-neutral-border":!this.isPdpMwebSimplificationSearchVariant,"border-t-0":!this.isPdpMwebSimplificationSearchVariant,"border-e-0":!this.isPdpMwebSimplificationSearchVariant,"border-s-0":!this.isPdpMwebSimplificationSearchVariant})}"> <ul class="p-0 m-0 border-none" id="${I}" @keydown="${this.handleDropdownKeyDown}"> ${r} </ul> </div>`;}renderTrendingSearches(i){const r=this.query||!this.trendingSearches,a=i?this.trendingSearches?.slice(0,i):this.trendingSearches,n=this.isPdpMwebSimplificationSearchVariant?this.renderSubHeader("Trending",e.Z({hidden:r||this.isSduiZeroStateEnabled})):t.x`<div class="ms-md mt-sm mb-2xs text-neutral-content-weak flex items-center ${e.Z({hidden:r||this.isSduiZeroStateEnabled})}"> ${f({attributes:{"aria-hidden":"true",className:"me-2xs"},size:t.I.Small})} ${"TRENDING TODAY"} </div>`;return t.x` ${n} <ul class="list-none mt-0 mb-0 p-0 search-results-list ${e.Z({hidden:r})}" id="${A}" @keydown="${this.handleDropdownKeyDown}" @click="${this.handleTrendingSearchesClick}" role="menu" aria-busy="${this.loadingSearchResults}"> ${a} </ul> `}renderTypeaheadResults(i=!1){return t.x`<ul id="${$}" class="list-none mt-0 mb-0 p-0 search-results-list min-w-0 ${e.Z({"px-md":i,"-mx-md":i})}" @click="${this.handleTypeaheadResultsClick}" @keydown="${this.handleDropdownKeyDown}" role="menu" aria-busy="${this.loadingSearchResults}"> ${this.typeaheadResults??""} </ul>`}renderScopedSearchPill(){if(this.scope.type===e.aa.GLOBAL||!this.isSearchScopeEnabled||this.isSearchScopeEnabled&&this.isScopedTypeaheadEnabled)return t.A;const i=p.cW({type:this.scope.type,path:this.scope.path}),r={search:{origin_element:e.iR.SearchBarPill},...(this.subreddit ? {subreddit:{id:this.subreddit.id,quarantined:this.subreddit.isQuarantined,nsfw:this.subreddit.isNsfw,name:this.subreddit.name}} : {})};return this.showAskButton||this.homeRevampEnabled?t.x`<rpl-input-chip id="${_}" slot="chips" style="--rpl-input-chip-background-color:var(--color-neutral-background);--rpl-input-chip-selected-background-color:var(--color-neutral-background)" data-faceplate-tracking-context="${JSON.stringify(r)}" selected="selected" appearance="bordered" type="standalone" aria-label="${`Remove ${i} filter and expand search to all of Reddit`}" @click="${()=>this.handleRemoveFilter(L.Click)}"> <span slot="leading">${this.getChipIcon()}</span> <span class="whitespace-nowrap overflow-hidden text-ellipsis text-label-2" aria-hidden="true">${i}</span> <span slot="trailing" class="flex items-center ms-[var(--rem4)]">${e.al({size:t.I.ExtraSmall})}</span> </rpl-input-chip>`:S.a({attributes:{id:"search-input-chip",onclick:this.handleFilterClick,slot:"chips",className:this.mobileExpandSearchBar?"max-w-[8rem]":""},deleteButtonConfig:{screenReaderContent:`Remove ${i} filter and expand search to all of Reddit`,attributes:{"data-faceplate-tracking-context":JSON.stringify(r),id:_,onclick:()=>this.handleRemoveFilter(L.Click),type:"button"}},screenReaderContent:`Current search is within ${i}`,selected:!0,leadingIcon:this.getChipIcon(),children:t.x`<span aria-hidden="true">${i}</span>`});}getFullSearchButtonSource(){return this.isPdpSeekerM2?"post_detail":"search"}getChipIcon(){if(this.scope.type===e.aa.GLOBAL)return t.x``;const{defaultIcon:r,iconUrl:a,isScopeNsfw:n}={[e.aa.COMMUNITY]:{defaultIcon:d.c,iconUrl:this.subreddit?.communityIcon,isScopeNsfw:this.subreddit?.isNsfw},[e.aa.CUSTOM_FEED]:{defaultIcon:i.c,iconUrl:this.multireddit?.icon,isScopeNsfw:this.multireddit?.isNsfw},[e.aa.PROFILE]:{defaultIcon:c.p,iconUrl:this.profile?.icon,isScopeNsfw:this.profile?.isNsfw}}[this.scope.type];return n&&!this.isNsfwEnabled?t.x`${h.n(P)}`:a?t.x`<div class="w-full h-full flex justify-center items-center"> <img height="16" width="16" class="rounded-full overflow-hidden" src="${a}" role="presentation"> </div>`:t.x`${r(P)}`}renderDropdownContent(e){const t=[],i=!this.query,r=this.isSearchScopeEnabled&&this.isScopedTypeaheadEnabled;if(this.isPdpSeekerM2&&this.suggestedSearchQueries?.length>0&&!this.hasEditedQuery){const e=this.isPdpMwebSimplificationSearchVariant?this.suggestedSearchQueries.slice(0,3):this.suggestedSearchQueries;t.push(this.renderSeekerSearchQueries(e))}return i&&this.recentSearchesController.items?.length&&!r&&!this.isSduiZeroStateEnabled&&t.push(this.renderRecentSearches(this.isPdpMwebSimplificationSearchVariant?3:void 0)),i&&!r?t.push(this.renderTrendingSearches(this.isPdpMwebSimplificationSearchVariant?6:void 0)):t.push(this.renderTypeaheadResults(e)),t}shouldFireExposureOnRender(){return!!this.isSearchScopeEnabled&&(!this.isSearchSmall||this.mobileExpandSearchBar&&Boolean(this.pageType&&this.pageType===e.au.SearchResults))}get shouldShowFiltersEntrypoint(){return this.showFiltersEntrypoint&&this.isFiltersEntrypointEnabled}renderAskButton(){if(!this.showAskButton||this.isSearchScopeEnabled)return t.A;!this.askButtonVariant||this.hasFiredAskButtonExposeEvent||this.isSearchSmall||this.maybeFireAskButtonExposure(),!this.homeRevampVariant||this.hasFiredHomeRevampExposeEvent||this.isSearchSmall||this.maybeFireHomeRevampExposure();const i=this.searchTelemetryData.search,r=e.iS({conversationID:ie(),query:this.query,source:this.pageType===e.au.SearchResults?e.iT.AskButtonSerp:e.iT.AskButtonTypeahead,upstreamConversationId:i.conversation_id,upstreamImpressionId:i.impression_id,upstreamQuery:this.query,upstreamQueryId:i.query_id,upstreamQueryType:this.pageType===e.au.SearchResults?"search_ask":"typeahead_ask"});return t.x`<faceplate-tracker source="search" action="click" noun="icon" data-faceplate-tracking-context="${JSON.stringify({action_info:{type:"ask"},search:{conversation_id:i.conversation_id,impression_id:i.impression_id,query:this.query,query_id:i.query_id}})}"> ${e.o({size:e.q.Small,appearance:"plain",leadingIcon:o.a({size:t.I.Small,attributes:{className:"text-secondary",style:"color:var(--color-upvote-plain-weaker);"}}),children:this.showAskText?"Ask":void 0,attributes:{href:this.query.trim().length>0?r:e.gT,className:"text-neutral-content no-underline hover:no-underline"}})} </faceplate-tracker>`;}}return e._([e.n({attribute:"initial-query",type:String})],he.prototype,"initialQuery",void 0),e._([e.n({attribute:"scope",type:Object})],he.prototype,"scope",void 0),e._([e.n({attribute:"omit-dynamic-id",type:Boolean})],he.prototype,"omitDynamicId",void 0),e._([e.n({attribute:"is-nsfw-enabled",type:Boolean})],he.prototype,"isNsfwEnabled",void 0),e._([e.n({attribute:"scoped-typeahead-variant",type:String})],he.prototype,"scopedTypeaheadVariant",void 0),e._([e.n({attribute:"scoped-typeahead-experiment-name",type:String})],he.prototype,"scopedTypeaheadExperimentName",void 0),e._([e.n({attribute:"scoped-typeahead-experiment-version",type:String})],he.prototype,"scopedTypeaheadExperimentVersion",void 0),e._([e.n({attribute:"ask-button-variant",type:String})],he.prototype,"askButtonVariant",void 0),e._([e.n({attribute:"ask-button-experiment-name",type:String})],he.prototype,"askButtonExperimentName",void 0),e._([e.n({attribute:"ask-button-experiment-version",type:String})],he.prototype,"askButtonExperimentVersion",void 0),e._([e.n({attribute:"home-revamp-variant",type:String})],he.prototype,"homeRevampVariant",void 0),e._([e.n({attribute:"home-revamp-experiment-name",type:String})],he.prototype,"homeRevampExperimentName",void 0),e._([e.n({attribute:"home-revamp-experiment-version",type:String})],he.prototype,"homeRevampExperimentVersion",void 0),e._([e.n({attribute:"typeahead-debounce-variant",type:String})],he.prototype,"typeaheadDebounceVariant",void 0),e._([e.n({attribute:"typeahead-debounce-experiment-name",type:String})],he.prototype,"typeaheadDebounceExperimentName",void 0),e._([e.n({attribute:"typeahead-debounce-experiment-version",type:String})],he.prototype,"typeaheadDebounceExperimentVersion",void 0),e._([e.n({attribute:"is-search-scope-telemetry-experiment-enabled",type:Boolean})],he.prototype,"isSearchScopeTelemetryExperimentEnabled",void 0),e._([e.n({type:Boolean,attribute:"mobile-expand-search-bar"})],he.prototype,"mobileExpandSearchBar",void 0),e._([e.n({type:Boolean,attribute:"is-pdp-seeker-m2"})],he.prototype,"isPdpSeekerM2",void 0),e._([e.n({type:Boolean,attribute:"is-pdp-mweb-simplification-search-variant"})],he.prototype,"isPdpMwebSimplificationSearchVariant",void 0),e._([e.n({type:Boolean,attribute:"open-search-in-seeker-post-queue"})],he.prototype,"openSearchInSeekerPostQueue",void 0),e._([e.n({type:Array,attribute:"suggested-search-queries"})],he.prototype,"suggestedSearchQueries",void 0),e._([e.n({attribute:"show-filters-entrypoint",type:Boolean})],he.prototype,"showFiltersEntrypoint",void 0),e._([e.n({type:Boolean,attribute:"is-sdui-zero-state-enabled"})],he.prototype,"isSduiZeroStateEnabled",void 0),e._([e.n({type:Number,attribute:"typeahead-debounce-delay"})],he.prototype,"typeaheadDebounceDelay",void 0),e._([e.n({type:String,attribute:"placeholder"})],he.prototype,"placeholderText",void 0),e._([e.n({type:Number,attribute:"max-recent-searches"})],he.prototype,"maxRecentSearches",void 0),e._([e.n({type:Boolean,attribute:"show-ask-button"})],he.prototype,"showAskButton",void 0),e._([e.n({type:Boolean,attribute:"show-ask-text"})],he.prototype,"showAskText",void 0),e._([e.n({type:Boolean,attribute:"show-snoo-leading-icon"})],he.prototype,"showSnooLeadingIcon",void 0),e._([e.n({type:Boolean,attribute:"global-leave-screen-event-enabled"})],he.prototype,"globalLeaveScreenEventEnabled",void 0),e._([e.a2(".search-input",!0)],he.prototype,"input",void 0),e._([e.a2(`#${$}`)],he.prototype,"typeaheadResultsContainer",void 0),e._([e.a2("#typeahead-results-nsfw-section")],he.prototype,"typeaheadResultsNsfwSection",void 0),e._([e.a2(`#${A}`)],he.prototype,"trendingSearchesContainer",void 0),e._([e.a2(`#${I}`)],he.prototype,"recentSearchesContainer",void 0),e._([e.a2(`#${_}`)],he.prototype,"searchScopePillDismissButton",void 0),e._([e.a2(`#${w}`)],he.prototype,"searchDropdownResultsContainer",void 0),e._([e.a2(`#${D}`)],he.prototype,"suggestedSearchResultsContainer",void 0),e._([e.n({type:Boolean,attribute:"home-revamp-enabled"})],he.prototype,"homeRevampEnabled",void 0),e._([e.h()],he.prototype,"query",void 0),e._([e.h()],he.prototype,"subreddit",void 0),e._([e.h()],he.prototype,"profile",void 0),e._([e.h()],he.prototype,"multireddit",void 0),e._([e.h()],he.prototype,"pageType",void 0),e._([e.h()],he.prototype,"isSearchScopeEnabled",void 0),e._([e.h()],he.prototype,"trendingSearches",void 0),e._([e.h()],he.prototype,"isFocused",void 0),e._([e.h()],he.prototype,"typeaheadResults",void 0),e._([e.h()],he.prototype,"showDropdown",void 0),e._([e.h()],he.prototype,"loadingSearchResults",void 0),e._([e.h()],he.prototype,"hasFiredScopedTypeaheadExposeEvent",void 0),e._([e.h()],he.prototype,"hasFiredAskButtonExposeEvent",void 0),e._([e.h()],he.prototype,"hasFiredHomeRevampExposeEvent",void 0),e._([e.h()],he.prototype,"hasFiredTypeaheadDebounceExposeEvent",void 0),e._([e.h()],he.prototype,"isScopedTypeaheadEnabled",void 0),e._([e.h()],he.prototype,"isScopedTypeaheadPrimaryAdjusterDismissed",void 0),e._([e.h()],he.prototype,"isScopedTypeaheadSecondaryAdjusterDismissed",void 0),e._([e.h()],he.prototype,"hasEditedQuery",void 0),e._([e.h()],he.prototype,"hasFiredDropdownShownInFocusSession",void 0),e._([e.h()],he.prototype,"isFiltersEntrypointEnabled",void 0),{R:he,S:w,p:k}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./BaxkLfaoug.js",import.meta.url,"BaxkLfaoug");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("BlsZ37tN43",["Dw4vb8Yfbm","BaxkLfaoug","5r73EsgItq"],(async(t,e,o)=>{let s=class extends e.F{constructor(){super(...arguments),this.tooltipStyle="",this.scrollContainerSelector="",this.customGlobalCloseEvent="",this.triggerEvent="click",this.addListenersWhileOpened2=()=>{document.addEventListener("click",this.handleDocumentClick2),document.addEventListener("keydown",this.handleEscape),this.customGlobalCloseEvent&&document.addEventListener(this.customGlobalCloseEvent,(()=>this.close())),this.scrollRoot?.addEventListener("scroll",this._popperController.reposition),this.setupScrollOutOfViewHandler()},this.cleanupListenersWhileOpened2=()=>{document.removeEventListener("click",this.handleDocumentClick2),document.removeEventListener("keydown",this.handleEscape),this.customGlobalCloseEvent&&document.removeEventListener(this.customGlobalCloseEvent,(()=>this.close())),this.scrollRoot?.removeEventListener("scroll",this._popperController.reposition),this.observer?.disconnect()},this.handleDocumentClick2=t=>{if(!(t.target instanceof HTMLElement)||this.hidden)return;if(this.isEventIgnorable(t))return;this._eventUsedMap.has(t)||this.close()},this.isEventIgnorable=t=>this.contains(t.target)||t.composedPath().includes(this),this.handleFaceplateTrack2=()=>{this.closeOnTrack&&this.close()},this.render=()=>{const e=this._popperController.actualPosition||this.position;return o.x` <slot aria-describedby="faceplate-tooltip" faceplate-popper-trigger @click="${this.handleClick}"></slot> <div id="faceplate-tooltip" role="dialog" position="${e}" faceplate-popper-content aria-label="${t.ad(this.label?this.label:void 0)}" style="${this.tooltipStyle}"> <slot name="content" @faceplate-track="${this.handleFaceplateTrack2}"></slot> </div> `}}get scrollRoot(){return this.scrollContainerSelector?document.querySelector(this.scrollContainerSelector):null}async show(){this.emitter.dispatch("open"),this.updateCustomProperties2(),this._popperController.open().then((()=>{this.hidden||(this.addListenersWhileOpened2(),this.emitter.dispatch("opened"))})),e.l(this).then(e.s(this._popperController.reposition)).then(e.s((t=>{t&&(this.focusManager?.refresh(),this.focusManager?.focus())}))),await this._popperController.currentState.animationFinished,this.focusManager?.focus(),this.cleanupTimeouts()}close(){return this.cleanupListenersWhileOpened2(),super.close()}reposition(){this._popperController.reposition()}updateCustomProperties2(){if("faceplate-tooltip"!==this.tagName.toLocaleLowerCase())return;const{clientHeight:t=null,clientWidth:e=null}=this.referenceElement,{clientHeight:o=null,clientWidth:s=null}=this._tooltip;t&&e&&o&&s&&(this.style.setProperty("--target-width",`${Math.round(e)}px`),this.style.setProperty("--target-height",`${Math.round(t)}px`),this.style.setProperty("--tooltip-width",`${Math.round(s)}px`),this.style.setProperty("--tooltip-height",`${Math.round(o)}px`))}setupScrollOutOfViewHandler(){const t=this.shadowRoot?.querySelector("[faceplate-popper-trigger]")?.assignedElements()?.[0];t&&this.scrollRoot&&(this.observer=new IntersectionObserver((t=>{t.forEach((t=>{t.intersectionRatio<.1&&this.close()}))}),{root:this.scrollRoot,rootMargin:"0px",threshold:[.1]}),this.observer.observe(t))}};t._([t.n({type:String,attribute:"tooltip-style"})],s.prototype,"tooltipStyle",void 0),t._([t.n({type:String,attribute:"scroll-container-selector"})],s.prototype,"scrollContainerSelector",void 0),t._([t.n({type:String,attribute:"custom-global-close-event"})],s.prototype,"customGlobalCloseEvent",void 0),s=t._([t.e("click-card")],s)}));
SML.dm("BtqmVQuPYp",[],(async()=>{class t{constructor(e,o){this.element=e,this.touch1=null,this.touch2=null,this.touchStartX=null,this.touchStartY=null,this.touchEndX=null,this.touchEndY=null,this.touchMove1=null,this.touchMove2=null,this.touchMoveX=null,this.touchMoveY=null,this.velocityX=null,this.velocityY=null,this.longPressTimer=null,this.doubleTapTimer=null,this.doubleTapWaiting=!1,this.thresholdX=0,this.thresholdY=0,this.disregardVelocityThresholdX=0,this.disregardVelocityThresholdY=0,this.swipingHorizontal=!1,this.swipingVertical=!1,this.swipingDirection=null,this.swipedHorizontal=!1,this.swipedVertical=!1,this.originalDistance=null,this.newDistance=null,this.scale=null,this.originalAngle=null,this.newAngle=null,this.rotation=null,this.handlers={panstart:[],panmove:[],panend:[],swipeleft:[],swiperight:[],swipeup:[],swipedown:[],tap:[],doubletap:[],longpress:[],pinch:[],pinchend:[],rotate:[],rotateend:[]},this._onTouchStart=this.onTouchStart.bind(this),this._onTouchMove=this.onTouchMove.bind(this),this._onTouchEnd=this.onTouchEnd.bind(this),this.opts=Object.assign({},t.defaults,o),this.element.addEventListener("touchstart",this._onTouchStart,i),this.element.addEventListener("touchmove",this._onTouchMove,i),this.element.addEventListener("touchend",this._onTouchEnd,i),this.opts.mouseSupport&&!("ontouchstart"in window)&&(this.element.addEventListener("mousedown",this._onTouchStart,i),document.addEventListener("mousemove",this._onTouchMove,i),document.addEventListener("mouseup",this._onTouchEnd,i))}destroy(){var t,i;this.element.removeEventListener("touchstart",this._onTouchStart),this.element.removeEventListener("touchmove",this._onTouchMove),this.element.removeEventListener("touchend",this._onTouchEnd),this.element.removeEventListener("mousedown",this._onTouchStart),document.removeEventListener("mousemove",this._onTouchMove),document.removeEventListener("mouseup",this._onTouchEnd),clearTimeout(null!==(t=this.longPressTimer)&&void 0!==t?t:void 0),clearTimeout(null!==(i=this.doubleTapTimer)&&void 0!==i?i:void 0)}on(t,i){if(this.handlers[t])return this.handlers[t].push(i),{type:t,fn:i,cancel:()=>this.off(t,i)}}off(t,i){if(this.handlers[t]){const e=this.handlers[t].indexOf(i);-1!==e&&this.handlers[t].splice(e,1)}}fire(t,i){for(let e=0;e<this.handlers[t].length;e++)this.handlers[t][e](i)}onTouchStart(t){var i,e,o,s,h,n,l,u,r,d,c,a,v,p,m,T,g,M,w,f,y,X,Y,E,b,S;let V=!1;if("mousedown"!==t.type){if(this.touch1||(this.touch1=t.changedTouches[0],V=!0),(V&&t.changedTouches.length>1||!V)&&!this.touch2)return this.touch2=[...t.changedTouches].find((t=>{var i;return t.identifier!==(null===(i=this.touch1)||void 0===i?void 0:i.identifier)}))||null,this.originalDistance=Math.sqrt(Math.pow((null!==(e=null===(i=this.touch2)||void 0===i?void 0:i.screenX)&&void 0!==e?e:0)-(null!==(n=null!==(s=null===(o=this.touchMove1)||void 0===o?void 0:o.screenX)&&void 0!==s?s:null===(h=this.touch1)||void 0===h?void 0:h.screenX)&&void 0!==n?n:0),2)+Math.pow((null!==(u=null===(l=this.touch2)||void 0===l?void 0:l.screenY)&&void 0!==u?u:0)-(null!==(a=null!==(d=null===(r=this.touchMove1)||void 0===r?void 0:r.screenY)&&void 0!==d?d:null===(c=this.touch1)||void 0===c?void 0:c.screenY)&&void 0!==a?a:0),2)),void(this.originalAngle=Math.atan2((null!==(p=null===(v=this.touch2)||void 0===v?void 0:v.screenY)&&void 0!==p?p:0)-(null!==(M=null!==(T=null===(m=this.touchMove1)||void 0===m?void 0:m.screenY)&&void 0!==T?T:null===(g=this.touch1)||void 0===g?void 0:g.screenY)&&void 0!==M?M:0),(null!==(f=null===(w=this.touch2)||void 0===w?void 0:w.screenX)&&void 0!==f?f:0)-(null!==(E=null!==(X=null===(y=this.touchMove1)||void 0===y?void 0:y.screenX)&&void 0!==X?X:null===(Y=this.touch1)||void 0===Y?void 0:Y.screenX)&&void 0!==E?E:0))/(Math.PI/180));if(!V)return}(V||"mousedown"===t.type)&&(this.thresholdX=this.opts.threshold("x",this),this.thresholdY=this.opts.threshold("y",this),this.disregardVelocityThresholdX=this.opts.disregardVelocityThreshold("x",this),this.disregardVelocityThresholdY=this.opts.disregardVelocityThreshold("y",this),this.touchStartX="mousedown"===t.type?t.screenX:(null===(b=this.touch1)||void 0===b?void 0:b.screenX)||0,this.touchStartY="mousedown"===t.type?t.screenY:(null===(S=this.touch1)||void 0===S?void 0:S.screenY)||0,this.touchMoveX=null,this.touchMoveY=null,this.touchEndX=null,this.touchEndY=null,this.swipingDirection=null,this.longPressTimer=setTimeout((()=>this.fire("longpress",t)),this.opts.longPressTime),this.scale=1,this.rotation=0,this.fire("panstart",t))}onTouchMove(t){var i,e,o,s,h,n,l,u,r,d,c,a,v;if("mousemove"===t.type&&(!this.touchStartX||null!==this.touchEndX))return;let p,m;if("mousemove"!==t.type&&(p=[...t.changedTouches].find((t=>{var i;return t.identifier===(null===(i=this.touch1)||void 0===i?void 0:i.identifier)})),this.touchMove1=p||this.touchMove1,m=[...t.changedTouches].find((t=>{var i;return t.identifier===(null===(i=this.touch2)||void 0===i?void 0:i.identifier)})),this.touchMove2=m||this.touchMove2),"mousemove"===t.type||p){const u=("mousemove"===t.type?t.screenX:null!==(i=null==p?void 0:p.screenX)&&void 0!==i?i:0)-(null!==(e=this.touchStartX)&&void 0!==e?e:0);this.velocityX=u-(null!==(o=this.touchMoveX)&&void 0!==o?o:0),this.touchMoveX=u;const r=("mousemove"===t.type?t.screenY:null!==(s=null==p?void 0:p.screenY)&&void 0!==s?s:0)-(null!==(h=this.touchStartY)&&void 0!==h?h:0);this.velocityY=r-(null!==(n=this.touchMoveY)&&void 0!==n?n:0),this.touchMoveY=r;const d=Math.abs(this.touchMoveX),c=Math.abs(this.touchMoveY);this.swipingHorizontal=d>this.thresholdX,this.swipingVertical=c>this.thresholdY,this.swipingDirection=d>c?this.swipingHorizontal?"horizontal":"pre-horizontal":this.swipingVertical?"vertical":"pre-vertical",Math.max(d,c)>this.opts.pressThreshold&&clearTimeout(null!==(l=this.longPressTimer)&&void 0!==l?l:void 0),this.fire("panmove",t)}"mousemove"!==t.type&&null!=this.touchMove1&&null!=this.touchMove2&&(this.newDistance=Math.sqrt(Math.pow(this.touchMove2.screenX-this.touchMove1.screenX,2)+Math.pow(this.touchMove2.screenY-this.touchMove1.screenY,2)),this.scale=this.newDistance/(null!==(u=this.originalDistance)&&void 0!==u?u:0),this.fire("pinch",t),this.newAngle=Math.atan2((null!==(r=this.touchMove2.screenY)&&void 0!==r?r:0)-(null!==(d=this.touchMove1.screenY)&&void 0!==d?d:0),(null!==(c=this.touchMove2.screenX)&&void 0!==c?c:0)-(null!==(a=this.touchMove1.screenX)&&void 0!==a?a:0))/(Math.PI/180),this.rotation=this.newAngle-(null!==(v=this.originalAngle)&&void 0!==v?v:0),this.fire("rotate",t))}onTouchEnd(t){var i,e,o,s,h,n,l,u,r,d;let c;if("mouseup"!==t.type&&(c=[...t.changedTouches].find((t=>{var i;return t.identifier===(null===(i=this.touch1)||void 0===i?void 0:i.identifier)})),[...t.touches].find((t=>{var i;return t.identifier===(null===(i=this.touch1)||void 0===i?void 0:i.identifier)}))||(this.touch1=null,this.touchMove1=null),[...t.touches].find((t=>{var i;return t.identifier===(null===(i=this.touch2)||void 0===i?void 0:i.identifier)}))||(this.touch2=null,this.touchMove2=null)),"mouseup"!==t.type||this.touchStartX&&null===this.touchEndX){if("mouseup"===t.type||c){this.touchEndX="mouseup"===t.type?t.screenX:null!==(i=null==c?void 0:c.screenX)&&void 0!==i?i:0,this.touchEndY="mouseup"===t.type?t.screenY:null!==(e=null==c?void 0:c.screenY)&&void 0!==e?e:0,this.fire("panend",t),clearTimeout(null!==(o=this.longPressTimer)&&void 0!==o?o:void 0);const a=this.touchEndX-(null!==(s=this.touchStartX)&&void 0!==s?s:0),v=Math.abs(a),p=this.touchEndY-(null!==(h=this.touchStartY)&&void 0!==h?h:0),m=Math.abs(p),T=Math.sqrt(Math.pow(a,2)+Math.pow(p,2)),g=Math.abs(T),M=m/v;v>this.thresholdX||m>this.thresholdY||this.opts.diagonalSwipes&&(g>this.thresholdX||g>this.thresholdY)?(this.swipedHorizontal=v>this.thresholdX||this.opts.diagonalSwipes&&g>this.thresholdX,this.swipedVertical=m>this.thresholdY||this.opts.diagonalSwipes&&g>this.thresholdY,(!this.opts.diagonalSwipes||M<Math.tan((45-this.opts.diagonalLimit)*Math.PI/180)||M>Math.tan((45+this.opts.diagonalLimit)*Math.PI/180))&&(v>=m&&(this.swipedVertical=!1),m>v&&(this.swipedHorizontal=!1)),this.swipedHorizontal&&(a<0?((null!==(n=this.velocityX)&&void 0!==n?n:0)<-this.opts.velocityThreshold||T<-this.disregardVelocityThresholdX)&&this.fire("swipeleft",t):((null!==(l=this.velocityX)&&void 0!==l?l:0)>this.opts.velocityThreshold||T>this.disregardVelocityThresholdX)&&this.fire("swiperight",t)),this.swipedVertical&&(p<0?((null!==(u=this.velocityY)&&void 0!==u?u:0)<-this.opts.velocityThreshold||T<-this.disregardVelocityThresholdY)&&this.fire("swipeup",t):((null!==(r=this.velocityY)&&void 0!==r?r:0)>this.opts.velocityThreshold||T>this.disregardVelocityThresholdY)&&this.fire("swipedown",t))):v<this.opts.pressThreshold&&m<this.opts.pressThreshold&&(this.doubleTapWaiting?(this.doubleTapWaiting=!1,clearTimeout(null!==(d=this.doubleTapTimer)&&void 0!==d?d:void 0),this.fire("doubletap",t)):(this.doubleTapWaiting=!0,this.doubleTapTimer=setTimeout((()=>this.doubleTapWaiting=!1),this.opts.doubleTapTime),this.fire("tap",t)))}this.touch1||this.touch2||(this.fire("pinchend",t),this.fire("rotateend",t),this.originalDistance=null,this.newDistance=null,this.scale=null,this.originalAngle=null,this.newAngle=null,this.rotation=null)}}}t.defaults={threshold:(t,i)=>Math.max(25,Math.floor(.15*("x"===t?window.innerWidth||document.body.clientWidth:window.innerHeight||document.body.clientHeight))),velocityThreshold:10,disregardVelocityThreshold:(t,i)=>Math.floor(.5*("x"===t?i.element.clientWidth:i.element.clientHeight)),pressThreshold:8,diagonalSwipes:!1,diagonalLimit:15,longPressTime:500,doubleTapTime:300,mouseSupport:!0};let i=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){i={passive:!0}}}))}catch(t){}return{T:t}}));

SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");
SML.dm("Bu440t6XLo",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6","BeFppRYbzE"],(async(e,t,i,o)=>{const s={Neutral:"neutral",Inverted:"inverted",Primary:"primary"};class n extends e.R{constructor(){super(...arguments),this.contentSlotRef=e.a3(),this.defaultSlotRef=e.a3(),this.bodyRef=e.a3(),this.popperRef=e.a3(),this.interactionController=new i.X(this,{isInteractedWith:e=>e.open,hoverDelayStart:t=>e.c4(getComputedStyle(t).getPropertyValue("--show-delay")),hoverDelayEnd:t=>e.c4(getComputedStyle(t).getPropertyValue("--hide-delay"))}),this.appearance=s.Neutral,this.content="",this.placement=o.P.Top,this.disabled=!1,this.distance=4,this.open=!1,this.skidding=0,this.trigger="hover focus",this.hoist=!1,this.noAnimate=!1,this.eventUsedMap=new WeakMap,this.handleDocumentKeyDown=e=>{"Escape"===e.key&&(e.stopPropagation(),this.hide())},this.handleDocumentClick=e=>{if(!(e.target instanceof HTMLElement)||this.hidden)return;this.eventUsedMap.has(e)||i.Y(this,e.target)||this.hide()}}disconnectedCallback(){document.removeEventListener("keydown",this.handleDocumentKeyDown),document.removeEventListener("click",this.handleDocumentClick)}willUpdate(e){e.has("open")&&this.hasUpdated&&this.handleOpenChange(),e.has("disabled")&&this.handleDisabledChange(),(e.has("content")||e.has("distance")||e.has("hoist")||e.has("placement")||e.has("skidding"))&&this.handleOptionsChange()}firstUpdated(){this.bodyRef.value&&(this.bodyRef.value.hidden=!this.open),this.open&&(document.addEventListener("keydown",this.handleDocumentKeyDown),document.addEventListener("click",this.handleDocumentClick),this.popperRef.value&&(this.popperRef.value.active=!0,this.popperRef.value.reposition()))}startInteraction(e){this.eventUsedMap.set(e,!0),this.show()}finishInteraction(e){this.eventUsedMap.set(e,!0),this.hide()}async handleOpenChange(){if(!this.disabled&&this.contentSlotRef.value&&this.bodyRef.value&&this.popperRef.value)if(this.open){this.emitter.dispatch("show"),document.addEventListener("keydown",this.handleDocumentKeyDown),document.addEventListener("click",this.handleDocumentClick),await e.c5(this.bodyRef.value),this.bodyRef.value.hidden=!1,this.popperRef.value.active=!0;const{keyframes:t,options:i}=e.c6(this,"tooltip.show");await e.c7(this.popperRef.value.popup,t,i),this.popperRef.value.reposition(),this.emitter.dispatch("after-show")}else{this.emitter.dispatch("hide"),document.removeEventListener("keydown",this.handleDocumentKeyDown),document.removeEventListener("click",this.handleDocumentClick),await e.c5(this.bodyRef.value);const{keyframes:t,options:i}=e.c6(this,"tooltip.hide");await e.c7(this.popperRef.value.popup,t,i),this.popperRef.value.active=!1,this.bodyRef.value.hidden=!0,this.emitter.dispatch("after-hide")}}async handleOptionsChange(){this.hasUpdated&&this.popperRef.value&&(await this.updateComplete,this.popperRef.value.reposition())}handleDisabledChange(){this.disabled&&this.open&&this.hide()}async show(){if(!this.open)return this.open=!0,e.c8(this,this.emitter.eventId("after-show"))}async hide(){if(this.open)return this.open=!1,e.c8(this,this.emitter.eventId("after-hide"))}render(){return t.x` <rpl-popper part="popper" exportparts="
          popup:popper--popup,
          arrow:popper--arrow
        " class="${e.Z({tooltip:!0,"tooltip--open":this.open})}" placement="${this.placement}" distance="${this.distance}" skidding="${this.skidding}" strategy="${this.hoist?"fixed":"absolute"}" flip shift arrow safe-area @mouseenter="${this.interactionController.handleMouseEnter}" @mouseleave="${this.interactionController.handleMouseLeave}" @mousedown="${this.interactionController.handleMouseDown}" @mouseup="${this.interactionController.handleMouseUp}" @focusin="${this.interactionController.handleFocus}" @focusout="${this.interactionController.handleBlur}" no-screen-reader ${e.a4(this.popperRef)}> <slot slot="anchor" aria-describedby="tooltip" @click="${this.interactionController.handleClick}" ${e.a4(this.defaultSlotRef)}></slot> <div part="body" id="tooltip" class="tooltip-body" role="tooltip" aria-live="${this.open?"polite":"off"}" ${e.a4(this.bodyRef)}> <slot name="content" ${e.a4(this.contentSlotRef)}>${this.content}</slot> <slot name="shortcut"></slot> </div> </rpl-popper> `}}return e._([e.n({type:String,reflect:!0})],n.prototype,"appearance",void 0),e._([e.n()],n.prototype,"content",void 0),e._([e.n()],n.prototype,"placement",void 0),e._([e.n({type:Boolean,reflect:!0})],n.prototype,"disabled",void 0),e._([e.n({type:Number})],n.prototype,"distance",void 0),e._([e.n({type:Boolean,reflect:!0})],n.prototype,"open",void 0),e._([e.n({type:Number})],n.prototype,"skidding",void 0),e._([e.n()],n.prototype,"trigger",void 0),e._([e.n({type:Boolean})],n.prototype,"hoist",void 0),e._([e.n({type:Boolean,attribute:"no-animate"})],n.prototype,"noAnimate",void 0),e.c3("tooltip.show",{keyframes:[{visibility:"visible",opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:150,easing:"ease"}}),e.c3("tooltip.hide",{keyframes:[{scale:1},{opacity:0,scale:.8}],options:{duration:150,easing:"ease"}}),{T:n,a:s}}));
SML.dm("Bv2UEnJP_M",[],(async()=>{var e,a,r;return function(e){e.GoldPurchasePaymentForm="award-gold-purchase-payment-form",e.GoldTopupPaymentForm="award-gold-topup-payment-form"}(e||(e={})),function(e){e.SelectionSheet="selection-sheet",e.Leaderboard="leaderboard",e.GoldPurchase="gold-purchase",e.GoldTopUp="gold-top-up"}(a||(a={})),Object.values(a),function(e){e.Limited="award:limited",e.Free="award:free",e.Community="award:community",e.Highlighted="award:highlighted",e.Iconic="award:iconic",e.Branded="award:branded"}(r||(r={})),{get A(){return r},get a(){return a}}}));

SML.di("./C37QCTsxJM.js",import.meta.url,"C37QCTsxJM");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./B4_JewVyg-.js",import.meta.url,"B4_JewVyg-");SML.di("./CT6LvHLTgy.js",import.meta.url,"CT6LvHLTgy");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./M-CiwvFL1u.js",import.meta.url,"M-CiwvFL1u");SML.di("./DmAQ0ztrTj.js",import.meta.url,"DmAQ0ztrTj");SML.di("./gvWVn4JBWB.js",import.meta.url,"gvWVn4JBWB");SML.di("./DvtJ_U6Duj.js",import.meta.url,"DvtJ_U6Duj");SML.di("./kTOUHCND_7.js",import.meta.url,"kTOUHCND_7");SML.di("./DFEdFtCEna.js",import.meta.url,"DFEdFtCEna");SML.di("./oUI692WQat.js",import.meta.url,"oUI692WQat");SML.di("./KHcvarc_gp.js",import.meta.url,"KHcvarc_gp");SML.di("./B7VtDPc4tA.js",import.meta.url,"B7VtDPc4tA");SML.di("./DbsIcWTJ8k.js",import.meta.url,"DbsIcWTJ8k");SML.di("./CG8L8PJoXS.js",import.meta.url,"CG8L8PJoXS");SML.di("./UfsiwdHXZO.js",import.meta.url,"UfsiwdHXZO");SML.di("./CnDGunUlBx.js",import.meta.url,"CnDGunUlBx");SML.di("./D-ibjVaztZ.js",import.meta.url,"D-ibjVaztZ");SML.di("./CqGTWb5M_i.js",import.meta.url,"CqGTWb5M_i");
SML.dm("Bv9lszNEG-",["Dw4vb8Yfbm","B4_JewVyg-","B-zFJtiar6","5r73EsgItq","gvWVn4JBWB","C37QCTsxJM","CT6LvHLTgy","M-CiwvFL1u","DmAQ0ztrTj","DvtJ_U6Duj","kTOUHCND_7","DFEdFtCEna","oUI692WQat","KHcvarc_gp","B7VtDPc4tA","DbsIcWTJ8k","CG8L8PJoXS","UfsiwdHXZO","CnDGunUlBx","D-ibjVaztZ","CqGTWb5M_i"],(async(t,e,i,s,o)=>{const r=e=>t.b({source:"onboarding",action:"view",noun:"upsell_unit"},{action_info:{page_type:e}}),n=()=>t.b({source:"onboarding",action:"click",noun:"upsell_unit"},{action_info:{type:"not_now"}}),a=()=>async function(e,i){await t.aH(e,i)}(t.aI.Dismiss,t.fr.BypassableXpromo);const l=new Set(t.fs.map((e=>t.bb({source:i.ao,action:i.ap,noun:e})))),h=t.W(e.W(s.s));let d=class extends h{get shredditSlotterElm(){return this.shadowRoot?.querySelector("shreddit-slotter")}get bottomSheet(){return this.shredditSlotterElm?.shadowRoot?.querySelector("#inline-auth-upsell-bottom-sheet-modal")}get isInlineRendered(){return this.shredditSlotterElm?.getAttribute("slot-name")===t.ft.InlineAuthLandingExperienceXpromo}constructor(){super(),this.isOverlay=!1,this.events=new t.E(this),this._authFlowModalOpen=!1,this._cachedYScrollPosition=0,this.mounted=!1,this.pubSubController=new t.u(this),this.cacheCurrentScrollPosition=()=>{this.isInlineRendered&&(this._cachedYScrollPosition=window.scrollY||window.pageYOffset)},this.debouncedCacheCurrentScrollPosition=t.ao(this.cacheCurrentScrollPosition,300),this._handleDismissButtonClick=()=>{t.i(this,n()),this.bottomSheet?.close(),this._unmount()},this.onShredditSlotterNameChanged=this.events.define("shreddit-slotter-slot-name-changed",(t=>{this.onSlotterRouteChange(t.detail.slotName)})),this._onAuthFlowModalOpen=this.events.define(t.fu.Open,(()=>{this._authFlowModalOpen=!0,this.setIsOverlayAttr()})),this.onFaceplateTrack=this.events.define("faceplate-track",(t=>{t.SAN&&l.has(t.SAN)&&(this._authFlowModalOpen=!1,this.setIsOverlayAttr(),this.switchToInlineXpromo())})),this.pubSubController.subscribe(t.T.TriggerCommentBlockingAuth,(t=>this.openBottomSheet(t)),!1)}connectedCallback(){super.connectedCallback(),this.isObserved||this.enableObserver({threshold:.8}),document.addEventListener("scroll",this.debouncedCacheCurrentScrollPosition,{passive:!0})}disconnectedCallback(){super.disconnectedCallback(),this.isObserved&&this.disableObserver(),document.removeEventListener("scroll",this.debouncedCacheCurrentScrollPosition)}bindDismissButtonListener(){const t=this.shredditSlotterElm?.shadowRoot?.querySelector("#inline-auth-upsell-bottom-sheet-modal-close");t?.addEventListener("click",this._handleDismissButtonClick)}updated(t){super.updated(t);!0===t.get("isOverlay")&&this.onReturnFromOverlay()}onReturnFromOverlay(){setTimeout((()=>{window.scrollTo(0,this._cachedYScrollPosition)}),0)}_unmount(){this.remove()}switchToInlineXpromo(){this.shredditSlotterElm?.setAttribute("slot-name",t.ft.InlineAuthLandingExperienceXpromo)}openBottomSheet({source:t}){this.triggerType===t&&this.bottomSheet?.show()}observerIsIntersectingCallback(){if(this.disableObserver(),this.mounted)return;this.mounted=!0,a();const e=t.H()??t.au.Unknown;t.i(this,r(e))}setIsOverlayAttr(){const e=this.shredditSlotterElm?.getAttribute("slot-name");this.isOverlay=this._authFlowModalOpen||e!==t.ft.InlineAuthLandingExperienceXpromo}onSlotterRouteChange(e){e===t.ft.InlineAuthLandingExperienceXpromo&&this.bindDismissButtonListener(),this.setIsOverlayAttr()}renderAuthFlowTemplate(){const e=this.querySelector('template[slot="auth-flow"');return e instanceof HTMLTemplateElement?t.a1(e):""}render(){return s.x` <div class="${"relative block -mt-3xl z-10 bg-neutral-background shadow-[0px_-40px_21px_var(--color-neutral-background)]"}">${super.render()} ${this.renderAuthFlowTemplate()}</div> `}};d.styles=[s.a`:host([is-overlay]){display:block;position:relative;z-index:100}`,t.t],t._([t.n({type:Boolean,attribute:"is-overlay",reflect:!0})],d.prototype,"isOverlay",void 0),t._([t.n({type:String,attribute:"trigger-type"})],d.prototype,"triggerType",void 0),d=t._([t.e("inline-auth-landing-experience-xpromo-shell")],d);const u=new Set(t.fs.map((e=>t.bb({source:i.ao,action:i.ap,noun:e})))),c=t.W(s.s);let p=class extends c{constructor(){super(...arguments),this.isOverlay=!1,this.events=new t.E(this),this.isSlim=!1,this.delay=0,this.isVisible=!1,this.canBeShown=!1,this._authFlowModalOpen=!1,this.mounted=!1,this.pubSubController=new t.u(this),this._handleDismissButtonClick=()=>{t.i(this,n()),this._unmount()},this.onShredditSlotterNameChanged=this.events.define("shreddit-slotter-slot-name-changed",(t=>{this.onSlotterRouteChange(t.detail.slotName)})),this._onAuthFlowModalOpen=this.events.define(t.fu.Open,(()=>{this._authFlowModalOpen=!0,this.setIsOverlayAttr()})),this.onFaceplateTrack=this.events.define("faceplate-track",(t=>{t.SAN&&u.has(t.SAN)&&(this._authFlowModalOpen=!1,this.setIsOverlayAttr(),this.switchToInlineXpromo())})),this.hideOrShow=({source:t})=>{t===o.C.Scroll?this.isVisible=!0:t===o.C.Close&&(this.isVisible=!1)}}get shredditSlotterElm(){return this.shadowRoot?.querySelector("shreddit-slotter")}get wrapper(){return this.shadowRoot?.querySelector(".wrapper")}get isInlineRendered(){return this.shredditSlotterElm?.getAttribute("slot-name")===t.ft.InlineAuthLandingExperienceXpromo}connectedCallback(){super.connectedCallback(),this.delay?setTimeout((()=>{this.canBeShown=!0}),this.delay):this.canBeShown=!0,this.pubSubController.subscribe(t.T.TriggerCommentBlockingAuth,this.hideOrShow,!1),this.isObserved||this.enableObserver({threshold:.8})}disconnectedCallback(){super.disconnectedCallback(),this.isObserved&&this.disableObserver()}bindButtonListener(){const t=this.shredditSlotterElm?.shadowRoot?.querySelector("#desktop-cbau-close-button");t?.addEventListener("click",this._handleDismissButtonClick)}updated(t){super.updated(t);if(!0===t.get("isOverlay")||t.has("isVisible")||t.has("canBeShown")){const t=this.shadowRoot.querySelector(".content");this.isVisible&&this.canBeShown?(t.classList.remove("fade-out","hidden"),t.classList.add("fade-in")):(t.classList.remove("fade-in"),t.classList.add("fade-out"))}}_unmount(){this.remove()}switchToInlineXpromo(){this.shredditSlotterElm?.setAttribute("slot-name",t.ft.InlineAuthLandingExperienceXpromo)}observerIsIntersectingCallback(){if(this.disableObserver(),this.mounted)return;this.mounted=!0,a();const e=t.H()??t.au.Unknown;t.i(this,r(e))}setIsOverlayAttr(){const e=this.shredditSlotterElm?.getAttribute("slot-name");this.isOverlay=this._authFlowModalOpen||e!==t.ft.InlineAuthLandingExperienceXpromo}onSlotterRouteChange(e){e===t.ft.InlineAuthLandingExperienceXpromo&&this.bindButtonListener(),this.setIsOverlayAttr()}renderAuthFlowTemplate(){const e=this.querySelector('template[slot="auth-flow"');return e instanceof HTMLTemplateElement?t.a1(e):""}onAnimationEnd(){this.isVisible||this.shadowRoot?.querySelector(".content")?.classList.add("hidden")}render(){return s.x` <div class="content ${this.isOverlay?"":"wrapper sticky -ms-md -me-xs mt-[-65vh] bottom-0 z-[100] hidden"}" @animationend="${this.onAnimationEnd}"> <div class="${this.isOverlay?"":"container p-2xl pb-lg h-[auto] min-h-[65vh] justify-items-end relative flex items-end box-border"}"> <div class="w-100 h-100 absolute z-0 left-0 bottom-0 ${this.isOverlay?"hidden":"overlay"}"></div> <div class="relative z-10 max-w-100 bg-neutral-background-strong ${this.isSlim?"rounded-[12px] border-[1px] border-neutral-border border-solid":"rounded-4"} shadow-md mx-auto pointer-events-auto box-border"> ${this.renderAuthFlowTemplate()} </div> </div> </div>`}};p.styles=[s.a`:host{pointer-events:none}:host([is-overlay]){display:block;position:relative;z-index:100;pointer-events:all}@keyframes fadeInSlideUp{0%{display:none;opacity:0;transform:translateY(50px)}1%{display:block;opacity:0;transform:translateY(50px)}100%{display:block;opacity:1;transform:translateY(0)}}@keyframes fadeOutSlideDown{0%{display:block;opacity:1;transform:translateY(0)}99%{display:block;opacity:0;transform:translateY(50px)}100%{display:none;opacity:0;transform:translateY(50px)}}.fade-in{animation:fadeInSlideUp .8s ease forwards}.fade-out{animation:fadeOutSlideDown .8s ease forwards}.hidden{display:none}.wrapper{margin-top:-65vh}.container{min-height:65vh}.overlay{background:linear-gradient(0deg,var(--color-neutral-background) 10%,rgba(0,0,0,0) 100%)}`,t.t],t._([t.n({type:Boolean,attribute:"is-overlay",reflect:!0})],p.prototype,"isOverlay",void 0),t._([t.n({type:Boolean,attribute:"slim"})],p.prototype,"isSlim",void 0),t._([t.n({type:Number,attribute:"delay"})],p.prototype,"delay",void 0),t._([t.n({type:Boolean})],p.prototype,"isVisible",void 0),t._([t.n({type:Boolean})],p.prototype,"canBeShown",void 0),p=t._([t.e("auth-landing-experience-xpromo-cbau-wrapper")],p)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("BvJOe9C929",["Dw4vb8Yfbm","5r73EsgItq"],(async(t,e)=>{let s=class extends e.s{constructor(){super(...arguments),this.size=1/0,this.target="",this.isBatching=!1}static get styles(){return e.a`:host{display:block}`}render(){return e.x` <slot></slot> `}getCurrentTarget(t=this){return this.target&&t.querySelector(this.target)||t}async batchInsert(e){if(this.isBatching)throw new Error("Cannot call batchInsert while batching is already in progress");const s=this.getCurrentTarget();if(!(s instanceof HTMLElement))throw new TypeError("Target element must be instance of HTMLElement");const i=t.c("faceplate-batch-begin",{size:this.size,count:e.length});if(s.dispatchEvent(i),i.defaultPrevented)return;this.isBatching=!0;const n=()=>{if(e.length){const t=e.slice(0,this.size),i=document.createDocumentFragment();for(let s=0;s<t.length;s++)i.appendChild(e[s]);s.appendChild(i)}e.length>this.size?(e=e.slice(this.size),window.setTimeout(n)):(s.style.willChange="unset",this.isBatching=!1)};s.style.willChange="contents",await n()}};t._([t.n({type:Number})],s.prototype,"size",void 0),t._([t.n({type:String})],s.prototype,"target",void 0),s=t._([t.e("faceplate-batch")],s)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Bb6e8s2O1k.js",import.meta.url,"Bb6e8s2O1k");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./CpZ44pmnxI.js",import.meta.url,"CpZ44pmnxI");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./BOFc1KQJc-.js",import.meta.url,"BOFc1KQJc-");SML.di("./Z0tk4vmzIQ.js",import.meta.url,"Z0tk4vmzIQ");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./CJnU84A1cL.js",import.meta.url,"CJnU84A1cL");SML.di("./D_6DXw1u0k.js",import.meta.url,"D_6DXw1u0k");SML.di("./CBbxnHsw2W.js",import.meta.url,"CBbxnHsw2W");SML.di("./B0p6XlbwHt.js",import.meta.url,"B0p6XlbwHt");SML.di("./CM4Yt4lwBK.js",import.meta.url,"CM4Yt4lwBK");SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");SML.di("./CqGTWb5M_i.js",import.meta.url,"CqGTWb5M_i");SML.di("./CU8weQ2dDy.js",import.meta.url,"CU8weQ2dDy");SML.di("./YFXcK0ZyJl.js",import.meta.url,"YFXcK0ZyJl");SML.di("./BRjrtOukap.js",import.meta.url,"BRjrtOukap");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");SML.di("./BuM34fxA_u.js",import.meta.url,"BuM34fxA_u");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");SML.di("./CQMf561ZyA.js",import.meta.url,"CQMf561ZyA");SML.di("./BwcUp7XlaC.js",import.meta.url,"BwcUp7XlaC");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./DnNITwgp90.js",import.meta.url,"DnNITwgp90");SML.di("./DIrjWut_vd.js",import.meta.url,"DIrjWut_vd");SML.di("./D1DY-avSiT.js",import.meta.url,"D1DY-avSiT");SML.di("./BSYfFtBeKH.js",import.meta.url,"BSYfFtBeKH");SML.di("./Cn5JTNK6V3.js",import.meta.url,"Cn5JTNK6V3");SML.di("./wBWjBlz6KG.js",import.meta.url,"wBWjBlz6KG");SML.di("./kS-PCwPq_X.js",import.meta.url,"kS-PCwPq_X");
SML.dm("BveDHcKZX5",["Dw4vb8Yfbm","5r73EsgItq","Bb6e8s2O1k","B-zFJtiar6","CpZ44pmnxI","FQGvCwaizg","BOFc1KQJc-","Z0tk4vmzIQ","xrDbp1ee_h","CJnU84A1cL","CM4Yt4lwBK","D_6DXw1u0k","CBbxnHsw2W","B0p6XlbwHt","C8QDHFSIkY","CqGTWb5M_i","CU8weQ2dDy","YFXcK0ZyJl","BRjrtOukap","tO6bKRQro7","Bu440t6XLo","BeFppRYbzE","BuM34fxA_u","eY7T41bKac","BYzqEZ3uv3","Cv4mWnWE30","jWC3N3n7Al","CQMf561ZyA","BwcUp7XlaC","BIzQFHISzm","BwcMg3lXAs","DnNITwgp90","DIrjWut_vd","D1DY-avSiT","BSYfFtBeKH","Cn5JTNK6V3","wBWjBlz6KG","kS-PCwPq_X"],(async(e,t,a,s,o,i,n,r,l,d,m)=>{class u extends CustomEvent{constructor(e){super(u.eventName,{bubbles:!0,composed:!0,cancelable:!0,detail:e})}}u.eventName="mod-removal-reason-added";class E extends CustomEvent{constructor(e){super(E.eventName,{bubbles:!0,composed:!0,cancelable:!0,detail:e})}}E.eventName="removal-reason-form-element-clicked";let c=class extends o.F{constructor(){super(),this._eventController=new e.E(this),this.handleFormElementClicked=e=>{e.target?.name&&this.dispatchEvent(new E({formElement:e.target.name}))},this.handleRemovalReasonInputChanged=e=>{if(e.target instanceof d.R){const t=e.target.value!==d.a.DontNotify;this.toggleNotificationSender(t),this.toggleMessageInput(t)}e.target instanceof d.b&&"removal-reason"===e.target.name&&this.toggleDefaultPolicyInput("default-removal-reason"===e.target.value)},this.convertFormDataToGql=e=>{const t=e.get("notification-method"),a=e.get("notification-sender"),s={reasonId:this.getRemovalReasonId(e),type:this.parseRemovalReasonMessageType(t,a),message:t===d.a.DontNotify?null:e.get("message"),isLockComment:e.has("lock")},o=e.get("modNote")||void 0,i={itemId:e.get("thing")?.toString()||"",removalReason:s,modNote:o};return this.lastSubmittedData=i,JSON.stringify({...i,csrf_token:e.get("csrf_token")})},this.encoders={...this.encoders,"application/json":this.convertFormDataToGql}}connectedCallback(){super.connectedCallback(),this._eventController.define(d.c,this.handleRemovalReasonInputChanged),this._eventController.define("click",this.handleFormElementClicked)}toggleNotificationSender(e){const t=this.elements["notification-sender"];t&&(e?t.removeAttribute("disabled"):t.setAttribute("disabled",""))}toggleField(e,t){e&&(t?(e.classList.remove("hidden"),e.setAttribute("required","")):(e.classList.add("hidden"),e.removeAttribute("required")))}toggleMessageInput(e){const t=this.elements.message;t&&this.toggleField(t,e)}toggleDefaultPolicyInput(e){const t=this.elements["default-removal-reason"];t&&this.toggleField(t,e)}showError(){const t={level:e.a5.error,message:"Something went wrong",cause:e.cv.QueryBadResponse};this.dispatchEvent(e.c("faceplate-alert",t))}async handleResponse(t){if(!t.ok)return this.dispatchEvent(e.c(p.eventName)),this.showError();try{const a=await t.text(),s={level:e.a5.success,message:"Removal reason added"},o=this.lastSubmittedData?.itemId||"";if(l.h(o)){const t={postId:o,action:r.a.addRemovalReason,value:!0};e.p(e.T.PostUpdated,t)}else{const t={commentId:o,action:n.C.addRemovalReason,value:!0};e.p(e.T.CommentUpdated,t)}if(a){const t={parentThingId:o,body:a};e.p(e.T.CommentCreated,t)}this.dispatchEvent(e.c(p.eventName)),this.dispatchEvent(e.c("faceplate-alert",s)),this.lastSubmittedData&&this.dispatchEvent(new u(this.lastSubmittedData))}catch{this.showError()}}parseRemovalReasonMessageType(t,a){return t===d.a.Comment?a===d.d.Mod?e.hP.CommentAsSubreddit:e.hP.CommentAsMod:t===d.a.Modmail?a===d.d.Mod?e.hP.MessageAsSubreddit:e.hP.MessageAsMod:null}getRemovalReasonId(e){const t=e.get("removal-reason");return"default-removal-reason"===t?e.get("default-removal-reason"):t}};c=e._([e.e("removal-reason-form")],c),i.r(c);const h={"removal-reason":"subreddit_removal_reason","default-removal-reason":"default_removal_reason",message:"message_to_user","notification-method":"notification_method","notification-sender":"notification_sender",modNote:"mod_note"};class R extends CustomEvent{constructor(e){super(R.eventName,{detail:e,bubbles:!0,composed:!0})}}R.eventName="mod-add-removal-reason-show-modal";class p extends CustomEvent{constructor(){super(p.eventName)}}p.eventName="mod-add-removal-reason-toggle-loading";let T=class extends t.s{constructor(){super(...arguments),this.pubsub=new e.u(this),this.getInputValue=e=>this.removalReasonForm?.querySelector(`input[name="${e}"]`)?.value,this.buildAndTrackEvent=t=>{const a={action:"click",...t,authorId:this.getInputValue("authorId"),subredditId:this.getInputValue("subredditId"),subredditName:this.subredditName,thingId:this.thingId};e.i(this,s.cu(a))},this.firstUpdated=()=>{this.isSmartEscalationsCommunityRulesEnabled&&this.updateComplete.then((()=>{this.primaryButton?.addEventListener("click",(()=>{this.removalReasonForm?.isValid&&(this.toggleButtonLoadingIndicator(),this.initSmartEscalations())}))}))},this.handleAddRemovalReasonEvent=({detail:e})=>{""!==e?this.show(e):this.thingId=void 0},this.handleFormElementClicked=e=>{const t={type:h[e.detail.formElement]||e.detail.formElement},a=this.removalReasonForm?.elements[e.detail.formElement]?.value||this.getInputValue(e.detail.formElement);if("lock"===e.detail.formElement&&(t.isLocked="on"===a),"notification-method"===e.detail.formElement){if(!a)return;t.notificationMethod=a}if("notification-sender"===e.detail.formElement){if(!a)return;t.sendAs=a}this.buildAndTrackEvent(t)},this.handleSelectRemovalReason=async e=>{const t=this.removalReasonInput?.removalReasonSuggestionsContext;e.detail.trackEvent&&this.buildAndTrackEvent({type:e.detail.isSitewide?"default_removal_reason":"subreddit_removal_reason",reason:e.detail.id,noun:"removal_reason_select",subredditId:t?.eventContext?.subredditId,postId:t?.eventContext?.postId,commentId:t?.eventContext?.commentId});const a=this.removalReasonForm,s=this.shadowRoot?.querySelector("faceplate-textarea-input");s&&e.detail.message&&(s.value=await this.renderRemovalReasonMessage(e.detail.id,e.detail.message),await s.updateComplete,s.syncInputValidity(),a?.notifyObservers(s))},this.renderRemovalReasonMessage=async(e,t)=>{try{return await this.renderRemovalReasonAsSavedResponseTemplate(e)}catch{return t}},this.renderSavedResponseTemplateBySubredditId=a.r,this.renderRemovalReasonAsSavedResponseTemplate=async e=>{const t=await this.renderSavedResponseTemplateBySubredditId({responseId:e,subredditId:this.getInputValue("subredditId")||"",contentId:this.thingId});return t?t.templateValidation?.ok?(this.removalReasonInput?.setInvalidMacro(!1),t.response.markdown):(this.removalReasonInput?.setInvalidMacro(!0),""):""},this.handleAddedRemovalReason=t=>{let a=function(t){let a;a=t.type===e.hP.CommentAsMod||t.type===e.hP.CommentAsSubreddit?"comment":t.type===e.hP.MessageAsMod||t.type===e.hP.MessageAsSubreddit?"modmail":"no message";const s=t.type===e.hP.CommentAsSubreddit||t.type===e.hP.MessageAsSubreddit?"subreddit":"self";return{is_locked:t.isLockComment,notify:a,send_as:s}}(t.detail.removalReason);const o=this.removalReasonInput?.removalReasonSuggestionsContext?.predictedRemovalSavedResponses?.map((e=>e.id));o&&(a={...a,suggestion_list:o}),e.i(this,s.cv(a,this.removalReasonInput?.value??void 0,this.removalReasonInput?.removalReasonSuggestionsContext?.eventContext)),this.isSmartEscalationsCommunityRulesEnabled&&!this.isExpandSuggestedActionsEnabled?(this.buildAndTrackEvent({type:"submit_button",reason:"default-removal-reason"===this.removalReasonInput?.value?this.defaultRemovalReasonInput?.value??void 0:this.removalReasonInput?.value??void 0,notificationMethod:this.removalReasonForm?.elements["notification-method"]?.value,sendAs:this.removalReasonForm?.elements["notification-sender"]?.value,isLocked:"on"===this.getInputValue("lock"),modNote:this.getInputValue("modNote"),message:this.getInputValue("message")}),this.pubsub.publish(e.T.RemovalReasonStatus,{status:m.R.SUCCESS})):this.close()},this.handleCancel=t=>{t.stopImmediatePropagation(),this.buildAndTrackEvent({type:"close_button"}),e.i(this,s.cw()),this.close()},this.toggleButtonLoadingIndicator=()=>{this.primaryButton?.querySelector("faceplate-progress")?.classList.toggle("hidden"),this.primaryButton?.querySelector("span.submit-button-content")?.classList.toggle("opacity-0")},this.showHideSubmitButton=()=>{this.removalReasonInput?this.primaryButton?.classList.remove("hidden"):this.primaryButton?.classList.add("hidden")},this.close=()=>{this.modal?.open&&(this.modal?.close(),document.body.style.overflow="auto",document.body.style.pointerEvents="auto")},this.initSmartEscalations=()=>{const t=this.getInputValue("authorId"),a=this.getInputValue("subredditId"),s=t&&a&&this.thingId;s&&this.pubsub.publish(e.T.SmartEscalationsInit,{thingId:this.thingId,authorId:t,subredditId:a,removalReasonId:(this.defaultRemovalReasonInput?.value||this.removalReasonInput?.value)??"",removalReasonDisplayText:(this.defaultRemovalReasonInput?.displayText||this.removalReasonInput?.displayText)??""}),!s&&this.close()}}get removalReasonInput(){return this.shadowRoot?.querySelector('[name="removal-reason"]')}get defaultRemovalReasonInput(){return this.shadowRoot?.querySelector('[name="default-removal-reason"]')}get removalReasonForm(){return this.shadowRoot?.querySelector("removal-reason-form")}get primaryButton(){return this.shadowRoot?.querySelector('faceplate-modal [slot=primaryButton] button[type="submit"]')}get selectedSuggestionValue(){const e=this.removalReasonInput?.shadowRoot?.querySelector("removal-reason-suggestions"),t=e?.getSelectedChip();return t?.dataset.removalReasonId}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.AddRemovalReasonClose,this.close,!1),this.addEventListener(d.S.eventName,this.handleSelectRemovalReason),this.addEventListener(u.eventName,this.handleAddedRemovalReason),this.addEventListener(p.eventName,this.toggleButtonLoadingIndicator),this.addEventListener(E.eventName,this.handleFormElementClicked),window.addEventListener(R.eventName,this.handleAddRemovalReasonEvent)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener(R.eventName,this.handleAddRemovalReasonEvent),this.removeEventListener(d.S.eventName,this.handleSelectRemovalReason),this.removeEventListener(u.eventName,this.handleAddedRemovalReason),this.removeEventListener(p.eventName,this.toggleButtonLoadingIndicator),this.addEventListener(E.eventName,this.handleFormElementClicked)}async show(e){e&&(this.thingId=e,await this.updateComplete),this.modal?.showModal(),await(this.partial?.load()),this.buildAndTrackEvent({action:"view"}),this.primaryButton?.querySelector("faceplate-progress")?.classList.add("hidden"),this.primaryButton?.querySelector("span.submit-button-content")?.classList.remove("opacity-0"),this.showHideSubmitButton()}render(){return t.x` <removal-reason-form class="mb-0" enctype="application/json" method="POST" action="/svc/shreddit/mod/removal-reason"> <faceplate-modal class="max-w-[540px] w-[90v w] z-30"> <div slot="closeButton"> ${e.o({appearance:"secondary",leadingIcon:e.al({size:t.I.Small}),size:e.q.Small,attributes:{type:"button",onclick:this.handleCancel}})} </div> <input type="hidden" name="thing" value="${this.thingId}"> ${s.av(this.thingId,t.x` <faceplate-partial class="w-100" src="/svc/shreddit/removal-reason-form/${this.thingId}" loading="${e.y.Programmatic}"> <div class="w-100 h-4xl flex items-center justify-center"> <faceplate-progress value="20" class="animate-spin"></faceplate-progress> </div> </faceplate-partial> `)} <div slot="primaryButton"> ${e.o({children:t.x`<faceplate-progress value="20" class="animate-spin loading-icon hidden absolute left-0 right-0 m-auto w-[16px]" style="--loader-size:1rem"></faceplate-progress> <span class="submit-button-content"> ${"Submit"}</span>`,appearance:"primary",attributes:{type:"submit",className:"w-100 relative"}})} </div> <div slot="secondaryButton"> ${e.o({children:"Cancel",appearance:"plain",attributes:{className:"w-100",type:"button",onclick:this.handleCancel}})} </div> </faceplate-modal> </removal-reason-form> `;}};return T.styles=[e.t],e._([e.n({type:Boolean,attribute:"is-smart-escalations-community-rules-enabled"})],T.prototype,"isSmartEscalationsCommunityRulesEnabled",void 0),e._([e.n({type:Boolean,attribute:"is-expand-suggested-actions-enabled"})],T.prototype,"isExpandSuggestedActionsEnabled",void 0),e._([e.n({type:String})],T.prototype,"thingId",void 0),e._([e.n({type:String,attribute:"subreddit-name"})],T.prototype,"subredditName",void 0),e._([e.a2("faceplate-modal")],T.prototype,"modal",void 0),e._([e.a2("faceplate-partial")],T.prototype,"partial",void 0),T=e._([e.e("add-removal-reason-modal")],T),{A:R}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");SML.di("./BOFc1KQJc-.js",import.meta.url,"BOFc1KQJc-");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./jTFRatIQcd.js",import.meta.url,"jTFRatIQcd");SML.di("./DWhb02bbsY.js",import.meta.url,"DWhb02bbsY");SML.di("./iewwAXEto0.js",import.meta.url,"iewwAXEto0");SML.di("./C6UOB_RPC4.js",import.meta.url,"C6UOB_RPC4");SML.di("./B2_gjouej4.js",import.meta.url,"B2_gjouej4");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./BSYfFtBeKH.js",import.meta.url,"BSYfFtBeKH");SML.di("./D1DY-avSiT.js",import.meta.url,"D1DY-avSiT");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");
SML.dm("Bw-OyhxMwg",["Dw4vb8Yfbm","C8QDHFSIkY","BOFc1KQJc-","B-zFJtiar6","5r73EsgItq","jTFRatIQcd","DWhb02bbsY","iewwAXEto0","C6UOB_RPC4","B2_gjouej4","BeFppRYbzE","Bu440t6XLo","tO6bKRQro7","BSYfFtBeKH","D1DY-avSiT"],(async(e,t,a,i,n,o,r,s,d,m,l,u)=>{let c=class extends n.s{constructor(){super(...arguments),this.pubsub=new e.u(this),this.class="",this.thingId="",this.isOP=!1,this.isCollaborator=!1,this.isCommentDeleted=!1,this.handleCommentUpdated=({commentId:t,action:i,value:n})=>{this.thingId===t&&i===a.C.distinguishAsMod?this.distinguishedAs=n?e.bl.Moderator:void 0:this.thingId===t&&i===a.C.distinguishAsAdmin&&(this.distinguishedAs=n?e.bl.Admin:void 0)},this.handleCommentDeleted=({commentId:e})=>{this.thingId===e&&(this.isCommentDeleted=!0)}}static get styles(){return[e.t,n.a`:host{display:contents}`]}get authorType(){return this.isCommentDeleted?"":this.distinguishedAs===e.bl.Admin?"admin":this.distinguishedAs===e.bl.Moderator?"moderator":this.isOP?"op":this.isCollaborator?"collaborator":""}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.CommentUpdated,this.handleCommentUpdated,!1),this.pubsub.subscribe(e.T.CommentDeleted,this.handleCommentDeleted,!1)}render(){const e=this.authorType,a=`font-semibold text-12 tracking-wide uppercase ${this.class} ${e}`;switch(e){case"moderator":return n.x`<span class="${i.j(a,"text-identity-moderator")}" aria-label="${"Comment distinguished by moderator"}"> ${t.a()} </span>`;case"admin":return n.x`<span class="${i.j(a,"text-identity-admin")}" aria-label="${"Comment distinguished by admin"}"> ${t.g()} </span>`;case"op":return n.x`<span class="${i.j(a,"comment-op-icon-js text-alienblue-600")}" aria-label="${"Comment distinguished as the original poster"}"> ${t.c()} </span>`;case"collaborator":return n.x`<span class="${i.j(a,"text-alienblue-600")}" aria-label="${"Comment distinguished as a post collaborator"}"> ${t.b()} </span>`;default:return n.A}}};e._([e.n({type:String})],c.prototype,"class",void 0),e._([e.n({type:String,attribute:"thing-id"})],c.prototype,"thingId",void 0),e._([e.n({type:String,attribute:"distinguished-as"})],c.prototype,"distinguishedAs",void 0),e._([e.n({type:Boolean,attribute:"op"})],c.prototype,"isOP",void 0),e._([e.n({type:Boolean,attribute:"collaborator"})],c.prototype,"isCollaborator",void 0),e._([e.n({type:Boolean,attribute:"comment-deleted"})],c.prototype,"isCommentDeleted",void 0),c=e._([e.e("shreddit-comment-author-modifier-icon")],c);let k=class extends n.s{constructor(){super(...arguments),this._showShareToModChatBanner=!e.a8.getItem(this.getLocalStorageKey()),this.closeCoachmark=()=>{this._showShareToModChatBanner=!1}}getLocalStorageKey(){return e.a9.ModQueueTranslationCoachmarkSeen}connectedCallback(){super.connectedCallback();e.a8.getItem(this.getLocalStorageKey())?this._showShareToModChatBanner=!1:(e.a8.setItem(this.getLocalStorageKey(),"true"),this._showShareToModChatBanner=!0)}render(){return n.x`<rpl-coachmark placement="${l.P.Top}" appearance="${u.a.Inverted}" ?open="${this._showShareToModChatBanner}"> <slot></slot> <rpl-coachmark-card slot="content" aria-live="polite" appearance="${u.a.Inverted}" class="w-[220px]"> <div slot="title" class="pt-xs pb-2xs"> <div class="max-w-[120px]"> ${"Translations are active"} </div> </div> ${e.o({attributes:{className:"close-btn",slot:"close-button",onclick:e=>{e.stopPropagation(),this.closeCoachmark()}},appearance:"plainInverted",size:e.q.Small,leadingIcon:e.al({size:n.I.Small})})} <div class="text-12 w-[170px] mb-sm"> ${"Redditors can contribute in any language, so content in communities you mod will be translated for you. Update your known language in account settings."} </div> <div slot="primary-button"> ${e.o({attributes:{onclick:e=>{this.closeCoachmark(),e.stopPropagation()}},appearance:"plainInverted",size:e.q.Small,children:"Got it"})} </div> <div slot="secondary-button"> ${e.o({attributes:{onclick:e=>{window.open("/settings/preferences","_blank"),e.stopPropagation()}},appearance:"plainInverted",size:e.q.Small,children:"Settings"})} </div> </rpl-coachmark-card> </rpl-coachmark>`;}};k.styles=[e.t],e._([e.h()],k.prototype,"_showShareToModChatBanner",void 0),k=e._([e.e("mod-queue-item-translation-coachmark")],k);let p=class extends n.s{constructor(){super(...arguments),this.thingId="",this.iconSize=n.I.Small,this.isDeleted=!1,this.isLocked=!1,this.isStickied=!1,this.isOP=!1,this.translationIndicator=m.T.none,this.pubsub=new e.u(this),this.handleCommentUpdated=({commentId:t,action:i,value:n})=>{if(this.thingId===t)switch(i){case a.C.distinguishAsMod:this.distinguishedAs=n?e.bl.Moderator:void 0;break;case a.C.sticky:this.isStickied=Boolean(n);break;case a.C.lock:this.isLocked=Boolean(n)}},this.handleCommentDeleted=({commentId:e})=>{this.thingId===e&&(this.isDeleted=!0)}}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.CommentUpdated,this.handleCommentUpdated),this.pubsub.subscribe(e.T.CommentDeleted,this.handleCommentDeleted)}renderLockedIcon(){return this.isDeleted||!this.isLocked?null:s.l({size:this.iconSize,attributes:{"aria-label":"Locked comment",className:"lock-icon text-alert-caution"}});}renderStickiedIcon(){if(this.isDeleted||!this.isStickied)return null;let t;return this.distinguishedAs===e.bl.Admin?t="text-identity-admin":this.distinguishedAs===e.bl.Moderator?t="text-identity-moderator":this.isOP&&(t="text-action-secondary"),this.isLocked?d.p({size:this.iconSize,attributes:{"aria-label":"Stickied comment",className:t}}):n.x` <span class="text-12 text-neutral-content inline-flex items-center gap-2xs"> ${d.p({attributes:{"aria-hidden":"true"},size:this.iconSize})} <span> ${"Stickied comment"} </span> </span> `;}renderTranslationIcon(){return this.translationIndicator!==m.T.none?n.x`<rpl-tooltip appearance="inverted" trigger="hover focus"> <span slot="content">${"Translations active"}</span><mod-queue-item-translation-coachmark> ${r.t({size:n.I.ExtraSmall,attributes:{"aria-label":"Comment is translated",className:i.j(this.translationIndicator===m.T.untranslated&&"hidden")}})} </mod-queue-item-translation-coachmark></rpl-tooltip> <rpl-tooltip appearance="inverted" trigger="hover focus"> <span slot="content">${"Translations not active"}</span>${o.t({size:n.I.ExtraSmall,attributes:{"aria-label":"Comment is not translated",className:i.j(this.translationIndicator===m.T.translated&&"hidden")}})}</rpl-tooltip> `:"";}render(){const e=this.renderLockedIcon(),t=this.renderStickiedIcon(),a=this.renderTranslationIcon();return e||t||this.translationIndicator!==m.T.none?n.x` <span class="ml-2xs text-12 text-neutral-content-weak" aria-hidden="true"></span> ${a} ${e} ${t} `:null}};p.styles=[n.a`:host{display:inline-flex;align-items:center;gap:var(--spacer-2xs)}`,e.t],e._([e.n({type:String,attribute:"thing-id"})],p.prototype,"thingId",void 0),e._([e.n({type:String,attribute:"icon-size"})],p.prototype,"iconSize",void 0),e._([e.n({type:Boolean,attribute:"deleted"})],p.prototype,"isDeleted",void 0),e._([e.n({type:Boolean,attribute:"locked"})],p.prototype,"isLocked",void 0),e._([e.n({type:Boolean,attribute:"stickied"})],p.prototype,"isStickied",void 0),e._([e.n({type:Boolean,attribute:"op"})],p.prototype,"isOP",void 0),e._([e.n({type:String,attribute:"distinguished-as"})],p.prototype,"distinguishedAs",void 0),e._([e.n({type:String,attribute:"translation-indicator"})],p.prototype,"translationIndicator",void 0),p=e._([e.e("shreddit-comment-badges")],p)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("BwcMg3lXAs",["Dw4vb8Yfbm"],(async t=>{function n(t){return t<10?`0${t}`:t}const{svg:a}=t.a();return{a:function(t){const[n,a,e]=t.split("-").map(Number);return new Date(n,a-1,e)},c:t.m(a`<path d="M10 1a9 9 0 10.001 18.001A9 9 0 0010 1zm0 16.2c-3.97 0-7.2-3.23-7.2-7.2S6.03 2.8 10 2.8s7.2 3.23 7.2 7.2-3.23 7.2-7.2 7.2z"></path><path d="M12.66 6.06L10 8.73 7.34 6.06 6.06 7.34 8.73 10l-2.67 2.66 1.28 1.28L10 11.27l2.66 2.67 1.28-1.28L11.27 10l2.67-2.66-1.28-1.28z"></path>`,"0 0 20 20","clear"),g:function(t){const[a,e,r]=Array.from(t).map((t=>parseInt(t?.value??"",10)));if(!r||!e||!a)return null;const l=new Date(a,e,0).getDate(),u=(new Date).getFullYear();return r<0||r>l||e<1||e>12||a<u-120||a>u-5?null:`${a}-${n(e)}-${n(r)}`}}}));
SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./DnNITwgp90.js",import.meta.url,"DnNITwgp90");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");
SML.dm("BwcUp7XlaC",["5r73EsgItq","Dw4vb8Yfbm","FQGvCwaizg","BIzQFHISzm","BwcMg3lXAs","DnNITwgp90","jWC3N3n7Al"],(async(t,e,a,i,r,n,s)=>{const o=e.dI(class extends e.dJ{constructor(t){if(super(t),t.type!==e.dK.PROPERTY&&t.type!==e.dK.ATTRIBUTE&&t.type!==e.dK.BOOLEAN_ATTRIBUTE)throw Error("The `live` directive is not allowed on child or event bindings");if(!e.dL(t))throw Error("`live` bindings can only contain a single expression")}render(t){return t}update(a,[i]){if(i===t.T||i===t.A)return i;const r=a.element,n=a.name;if(a.type===e.dK.PROPERTY){if(i===r[n])return t.T}else if(a.type===e.dK.BOOLEAN_ATTRIBUTE){if(!!i===r.hasAttribute(n))return t.T}else if(a.type===e.dK.ATTRIBUTE&&r.getAttribute(n)===i+"")return t.T;return e.dM(a),i}});class l{constructor(t,e){this._observedNames=new Set,this._previousStates=new Map,this._records=new Map,this._eventListener=t=>{this._processRecord(t.detail)},this._callCallback=()=>{this._records.size&&this._callback(this.takeRecords(),this)},this._callback=t,this.form=e.form}_processRecord(t){const e=!this._records.size,{input:a,message:i,name:r}=t;if(!this._observedNames.has(r))return;this._previousStates.get(r)!==i&&(this._records.set(r,{target:a,message:i,name:r}),this._previousStates.set(r,i),this._records.size&&e&&queueMicrotask(this._callCallback))}observe(t){if(this._observedNames.has(t))return;this._observedNames.add(t),1===this._observedNames.size&&this.form.addEventListener("_faceplate-validation-change",this._eventListener);const e=this.form.elements[t];!e||e instanceof HTMLOutputElement||Array.isArray(e)||this._processRecord({input:e,name:t,message:e.validationMessage})}disconnect(){this._observedNames.size&&(this._observedNames.clear(),this._previousStates.clear(),this._records.clear(),this.form.removeEventListener("_faceplate-validation-change",this._eventListener))}takeRecords(){const t=Array.from(this._records.values());return this._records=new Map,t}unobserve(t){this._observedNames.has(t)&&(this._observedNames.delete(t),this._previousStates.delete(t),this._records.delete(t),this._observedNames.size||this.disconnect())}}let c=class extends t.s{constructor(){super(...arguments),this.name="",this.level=null,this.placeholder="",this.ariaLive=null,this.message="",this.characterCount=Number.NEGATIVE_INFINITY,this.characterCountAriaLabel="",this.visuallyHiddenText="",this.isInputDirty=!0,this._message="",this.setIsDirtyByAttribute=t=>{this.isInputDirty=t.hasAttribute("faceplate-dirty")},this.onFormConnect=t=>{t?.addEventListener("faceplate-submit",(()=>{this.isInputDirty=!0})),t&&this.isConnected&&(this._observer=new l((t=>{for(const a of t)if(a.name===this.name){if(a.target instanceof s.F){this.setIsDirtyByAttribute(a.target);new MutationObserver((t=>{for(const e of t)"faceplate-dirty"===e.attributeName&&this.setIsDirtyByAttribute(e.target),"faceplate-validity"===e.attributeName&&this.toggleSuccessStyling(e.target)})).observe(a.target,{attributes:!0})}else this.isInputDirty=!0;this.setMessage(this.message||a.message,"valid"===a.target.getAttribute("faceplate-validity")?e.a5.success:e.a5.error)}}),{form:t}),this._observer.observe(this.name),this._observer.form.addEventListener("faceplate-alert",this._handleAlert))},this.associateForm=t=>{this.onFormConnect(t)},this._handleAlert=t=>{this.isInputDirty=!0;const{name:a,level:i,message:r}=t.detail;a===this.name&&i!==e.a5.error&&this.setMessage(r,i)},this.toggleSuccessStyling=t=>{this.isInputDirty&&("valid"===t.getAttribute("faceplate-validity")?this.shadowRoot?.getElementById("helper-text")?.classList.add("success"):this.shadowRoot?.getElementById("helper-text")?.classList.remove("success"))}}connectedCallback(){super.connectedCallback(),a.c(this).then(this.onFormConnect)}disconnectedCallback(){super.disconnectedCallback(),this._observer&&(this._observer.disconnect(),this._observer.form.removeEventListener("faceplate-alert",this._handleAlert))}setMessage(t,a){t&&void 0!==a?this.level=e.a5[a]:this.removeAttribute("level"),this._message=t||""}get textContent(){return this.shadowRoot?.firstElementChild?.textContent||""}get innerText(){return this.shadowRoot?.firstElementChild?.innerText||""}static get styles(){return t.a`:host{display:block;font-size:var(--font-small);color:var(--color-input-helper-text);line-height:var(--size-md);font-size:var(--font-small);box-sizing:border-box}.container{display:flex;justify-content:space-between;padding-top:var(--spacer-input-padding-top);line-height:var(--size-md);font-size:var(--font-small)}.success,:host([level=success]){color:var(--color-success-content)}.overflow-char-limit,:host([level=alert]),:host([level=critical]),:host([level=emergency]),:host([level=error]){color:var(--color-danger-content)}:host([level=warning]){color:var(--color-alert-caution)}:host([level=notice]){color:var(--color-success-content)}.pristine{color:var(--color-input-helper-text)}:host([character-count]) .character-count{margin-inline-start:var(--spacer-xs);flex-shrink:0}.empty{padding:0}`}render(){const a=this.characterCount>Number.NEGATIVE_INFINITY;let i=this.characterCount;if(this.characterCountMax){i=`${this.characterCountMax-this.characterCount}/${this.characterCountMax}`}return this.placeholder||this._message||a?t.x`<span aria-live="${e.ad(this.ariaLive??void 0)}" class="${e.Z({container:!0,pristine:!this.isInputDirty})}"> <span id="helper-text">${this.isInputDirty&&this._message?this._message:this.placeholder}</span> ${a?t.x`<span class="character-count ${this.characterCount<0?"overflow-char-limit":""}" aria-label="${e.ad(this.characterCountAriaLabel)}">${i}</span>`:void 0} </span> <faceplate-screen-reader-content aria-live="assertive">${this.visuallyHiddenText}</faceplate-screen-reader-content>`:t.x`<faceplate-screen-reader-content aria-live="polite">${this.visuallyHiddenText}</faceplate-screen-reader-content>`}};e._([e.n({type:String,reflect:!0})],c.prototype,"name",void 0),e._([e.n({type:String,reflect:!0})],c.prototype,"level",void 0),e._([e.n({type:String})],c.prototype,"placeholder",void 0),e._([e.n({type:String,reflect:!0,attribute:"aria-live"})],c.prototype,"ariaLive",void 0),e._([e.n({type:String,attribute:"message"})],c.prototype,"message",void 0),e._([e.n({type:Number,attribute:"character-count"})],c.prototype,"characterCount",void 0),e._([e.n({type:Number,attribute:"character-count-max"})],c.prototype,"characterCountMax",void 0),e._([e.n({type:String,attribute:"character-count-aria-label"})],c.prototype,"characterCountAriaLabel",void 0),e._([e.n({type:String,attribute:"visually-hidden-text"})],c.prototype,"visuallyHiddenText",void 0),e._([e.h()],c.prototype,"isInputDirty",void 0),e._([e.h()],c.prototype,"_message",void 0),c=e._([e.e("faceplate-form-helper-text")],c);class h extends s.F{constructor(){super(...arguments),this.suffix="",this.value="",this.name="",this.placeholder="",this.required=!1,this.screenReaderContent="",this.novalidate=!1,this.helperTextLevel=null,this.helperTextPlaceholder="",this.helperTextAriaLive="polite",this.helperTextMessage="",this.hasLabel=!1,this.hasTrailingButton=!1,this.statefulInput=!1,this.reportedDirty=!1,this.hasValidationHelpers=!1,this.suppressInternalClicks=!1,this.validationMsg="",this.allowMaxLengthOverflow=!1,this.setFormValidationHelpers=t=>{t&&(t.addEventListener("faceplate-submit",this.setDirtyAttribute),this.helperText?.associateForm(t),this.hasValidationHelpers=!0)},this.setStatefulInputByValue=()=>{this.statefulInput=!this.isEmpty},this.inputContainer=a=>t.x` <span class="${e.Z({"input-container":!0})}"> ${a} </span> `,this.labelTextWrapper=()=>{const e=t=>t&&t[0]?.textContent;return t.x` <span class="label-text inner-label" id="fp-input-label"><slot name="label" @slotchange="${t=>this.onSlotChange({event:t,property:"hasLabel",name:"label",hasChanged:e})}"></slot>${this.required?t.x`<span class="required-asterisk" aria-hidden="true">*</span>`:null}</span> `},this.setDirtyAttribute=()=>{this.setAttribute("faceplate-dirty","")},this.onSlotChange=({event:t,property:e,name:a,hasChanged:i})=>{t.target?.name===a&&(this[e]=i?i(t.target?.assignedElements()):t.target?.assignedNodes().length>0)}}async connectedCallback(){super.connectedCallback(),this.addEventListener("focus",this.onFocus.bind(this)),this.addEventListener("blur",this.onBlur.bind(this));const t=await a.c(this);this.setFormValidationHelpers(t)}disconnectedCallback(){super.disconnectedCallback(),this?.removeEventListener("focus",this.onFocus),this?.removeEventListener("blur",this.onBlur),this.form?.removeEventListener("faceplate-submit",this.setDirtyAttribute)}async firstUpdated(){super.firstUpdated(),this.calculateLabelPosition(),this.validateMaxLength()}updated(t){if(t.get("prefix")&&this.calculateLabelPosition(),void 0!==t.get("statefulInput")){const t=this.shadowRoot?.querySelector(".input-container")?.classList;this.statefulInput?t.add("stateful-input"):t.remove("stateful-input")}t.has("value")&&(super.value=this.value,this.setStatefulInputByValue())}get delegatedFocusElements(){return[this.innerInput]}static get styles(){return[super.styles,t.a`label{display:flex;position:relative}:host{outline:0;font-family:var(--font-sans);cursor:text}:host input,:host textarea{font:inherit;color:var(--color-neutral-content-strong);padding:0}.label-container{display:inline-flex;position:relative;height:var(--rem40);align-items:center;box-sizing:border-box}:host([appearance=bordered]) .label-container{background:var(--color-input-bordered);color:var(--color-input-bordered-text)}:host([appearance=secondary]) .label-container{background:var(--color-input-secondary);border-radius:var(--radius-md);outline:0;color:var(--color-input-secondary-text)}:host([appearance=secondary]) .label-container:hover{background:var(--color-input-secondary-hover)}:host([appearance=bordered]) .label-container:hover{background:var(--color-input-bordered-hover)}:host(:focus-within) .label-container{outline:1px auto var(--color-global-focus)}:host([faceplate-validity=invalid][faceplate-dirty]) .label-container{border-color:transparent;box-shadow:0 0 0 var(--rem2) var(--color-danger-content)}:host([faceplate-validity=valid][novalidate]) .label-container{border-color:transparent;box-shadow:none}:host .label-container,:host faceplate-form-helper-text{padding-inline-start:var(--spacer-md)}:host .label-container,:host faceplate-form-helper-text:not(.helper-text-without-label-with-trailing){padding-inline-end:var(--spacer-md)}:host([appearance=secondary]) .label-container{align-items:center}:host .label-container.with-trailing-button{padding-inline-end:var(--spacer-xs)}.label-container.interior-label{height:var(--rem56)}.input-container{font:var(--font-16-20-regular)}::slotted([slot=leadingIcon]),::slotted([slot=trailingIconButton]){color:var(--color-neutral-content-weak);display:inline-flex;align-items:center}:host([faceplate-validity=valid][faceplate-dirty]) .trailing-icon.valid{color:var(--color-success-background)}.required-asterisk,:host([faceplate-validity=invalid][faceplate-dirty]) .trailing-icon.invalid{color:var(--color-danger-content)}:host([faceplate-validity=valid][novalidate]) .trailing-icon.valid{display:none}.trailing-icon,::slotted([slot=trailingIcon]){margin-inline-start:var(--spacer-xs);flex-shrink:0}:host([disabled]){color:var(--color-neutral-content-disabled)}:host([faceplate-validity=invalid][faceplate-dirty]) .invalid,:host([faceplate-validity=valid][faceplate-dirty]) .valid{display:inline-block}.trailing-icon{display:none}:host .label-container.without-label faceplate-form-helper-text,:host([appearance=secondary]) .label-container.without-label{padding-top:var(--rem10);padding-bottom:var(--rem10)}:host([faceplate-validity=invalid]:not([disabled])[faceplate-dirty]) .label-text:not(.inner-label),:host([faceplate-validity=valid]:not([disabled])[faceplate-dirty]) .label-text:not(.inner-label){color:var(--color-label-default)}.label-text{position:absolute;pointer-events:none}:host([disabled]) .label-text:not(.inner-label){color:var(--color-neutral-content-disabled)}.stateful-input .label-text:not(.inner-label){clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.stateful-input .label-text.inner-label{transform:translate(calc(-1 * var(--left-label-position)),calc(-1 * (var(--rem16))));font-size:var(--size-sm);line-height:var(--rem16);white-space:nowrap}.label-container:not(.without-label) .input-container:not(.stateful-input) input::placeholder,.label-container:not(.without-label) .input-container:not(.stateful-input) textarea::placeholder{opacity:0}.label-container:not(.without-label) .input-container.stateful-input{transform:translateY(var(--spacer-xs))}.activated,.activated .label-text.inner-label{transition:all 150ms ease-out}.inner-label{inset-inline-start:var(--left-label-position)}.input-container:not(.stateful-input) .inner-label{transform:translateY(0);transition:transform 150ms ease}.hidden{display:none}.label-text:not(.inner-label){color:var(--color-label-default)}slot[name=clearButton]:not(.has-value){display:none}.input-boundary-box{display:flex;align-items:center}.input-boundary-box,.label-container{flex:1}.label-container:not(.without-label) .input-boundary-box{padding:var(--spacer-xs) 0}#trailing-icons-container{display:flex;align-items:center;gap:var(--spacer-xs);justify-content:flex-end}:host([persistent-trailing-icon]) #trailing-icons-general{flex-direction:row-reverse}.input-prefix,.input-suffix,.label-text{color:var(--color-label-default)}:host .without-label.with-trailing-button{padding-inline-end:var(--spacer-2xs)}.input-container{position:relative;transform:translateY(0);display:flex;align-items:center;width:100%;line-height:var(--rem20)}:host([faceplate-validity=invalid]:not([persistent-trailing-icon])[faceplate-dirty]) ::slotted([slot=trailingIconButton]){display:none}#trailing-icons-general{display:flex;align-items:center}#trailing-icons-validation{display:flex}:host(:not([faceplate-dirty])) #trailing-icons-validation{display:none}`]}get isEmpty(){return!(!this.innerInput?.value&&this.innerInput?.validity.badInput)&&!(this.innerInput?.value??this.value)}onFocus(){this.hasAttribute("faceplate-dirty")&&!this.reportedDirty&&(this.reportedDirty=!0),this.removeAttribute("faceplate-dirty"),this.shadowRoot?.querySelector(".input-container")?.classList.add("activated"),this.isEmpty&&(this.statefulInput=!0)}onBlur(){this.isEmpty&&(this.statefulInput=!1),this.reportedDirty&&this.setAttribute("faceplate-dirty","")}focus(){this.innerInput?.focus()}blur(){this.innerInput?.blur()}onChange(t){const e=t?.target;this.value=e?.value||"",this.dispatchEvent(new InputEvent("change",{bubbles:!0}))}onInput(t){const e=t?.target;this.value=e?.value||"",this.handleCharLimit?.(),this.validateMaxLength(),this.setStatefulInputByValue()}validateMaxLength(){if(this.allowMaxLengthOverflow&&this.maxLength){const t=this._internals.validationMessage===this.validationMsg,e=this.value.length>this.maxLength;!t&&e?this.setCustomValidity(this.validationMsg):t&&!e&&this.setCustomValidity("")}}handleCharLimit(){const t=this.maxLength&&this.value.length>=this.maxLength;this.helperText&&this.helperTextScreenReaderMsg&&(t?this.helperText.visuallyHiddenText=this.helperTextScreenReaderMsg:!t&&this.helperText.visuallyHiddenText&&(this.helperText.visuallyHiddenText=""))}async calculateLabelPosition(t=0){let e=0,a=0;const i=this.shadowRoot?.querySelector(".input-prefix");if(i){!getComputedStyle(this.shadowRoot?.host).getPropertyValue("--font-16-20-regular").trim().length&&t<5&&setTimeout((()=>{this.calculateLabelPosition(t+1)}),50),a=i.getBoundingClientRect().width;const r=getComputedStyle(this.shadowRoot?.querySelector(".input-prefix")).getPropertyValue("margin-inline-end");e+=a+parseFloat(r)}(this.shadowRoot?.querySelector("label")).style.setProperty("--left-label-position",`${e}px`)}onLabelClick(t){this.suppressInternalClicks&&"input"!==t.target.nodeName.toLowerCase()&&t.stopPropagation()}renderInput(a){let r;return this.characterCount&&(r=this.maxLength?this.maxLength-this.value.length:this.value.length),t.x`<label @click="${this.onLabelClick}"> <div class="${e.Z({"label-container":!0,"interior-label":!0,"without-label":!this.hasLabel,"with-trailing-button":this.hasTrailingButton})}"> <span class="input-boundary-box"> <slot name="leadingIcon"></slot> ${this.inputContainer(t.x` ${this.prefix?t.x`<span class="input-prefix">${this.prefix}</span>`:void 0} ${this.labelTextWrapper()} ${a} ${this.suffix?t.x`<span class="input-suffix">${this.suffix}</span>`:void 0} `)} <span id="trailing-icons-container"> <span id="trailing-icons-validation"> ${n.e({attributes:{className:"trailing-icon invalid"},size:t.I.Medium})} ${i.c({attributes:{className:"trailing-icon valid"},size:t.I.Medium})} </span> <span id="trailing-icons-general"> <slot name="trailingIconButton" @slotchange="${t=>this.onSlotChange({event:t,property:"hasTrailingButton",name:"trailingIconButton"})}"> </slot> <slot name="clearButton" class="${e.Z({"has-value":!!this.value.length})}"></slot> </span> </span> </span> </div> </label> <faceplate-form-helper-text class="${e.Z({"no-label":!this.hasLabel,"helper-text-without-label-with-trailing":!this.hasLabel&&this.hasTrailingButton})}" character-count="${e.ad(r)}" character-count-max="${e.ad(this.maxLength)}" name="${this.name}" aria-live="${e.ad(this.helperTextAriaLive??void 0)}" message="${e.ad(this.helperTextMessage)}" level="${e.ad(this.helperTextLevel??void 0)}" placeholder="${this.helperTextPlaceholder}" character-count-aria-label="${e.ad(this.characterCountAriaLabel)}"> </faceplate-form-helper-text>`}}return h.clearButton=(a={})=>e.o({attributes:{...a,type:"button"},appearance:"plain",size:e.q.Small,leadingIcon:r.c({attributes:{className:"trailing-icon"},size:t.I.Medium})}),e._([e.n({type:String})],h.prototype,"suffix",void 0),e._([e.n({type:String})],h.prototype,"value",void 0),e._([e.n({type:String})],h.prototype,"name",void 0),e._([e.n({type:String})],h.prototype,"placeholder",void 0),e._([e.n({type:Boolean})],h.prototype,"required",void 0),e._([e.n({type:String})],h.prototype,"screenReaderContent",void 0),e._([e.n({type:String})],h.prototype,"autocomplete",void 0),e._([e.n({type:String})],h.prototype,"inputmode",void 0),e._([e.n({type:Boolean})],h.prototype,"novalidate",void 0),e._([e.n({type:Number,attribute:"maxlength"})],h.prototype,"maxLength",void 0),e._([e.n({type:Number,attribute:"minlength"})],h.prototype,"minLength",void 0),e._([e.a2("input,textarea")],h.prototype,"innerInput",void 0),e._([e.a2("faceplate-form-helper-text")],h.prototype,"helperText",void 0),e._([e.n({type:String,reflect:!0,attribute:"helper-text-level"})],h.prototype,"helperTextLevel",void 0),e._([e.n({type:String,attribute:"helper-text-placeholder"})],h.prototype,"helperTextPlaceholder",void 0),e._([e.n({type:String,reflect:!0,attribute:"helper-text-aria-live"})],h.prototype,"helperTextAriaLive",void 0),e._([e.n({type:String,attribute:"helper-text-message"})],h.prototype,"helperTextMessage",void 0),e._([e.n({type:Boolean,attribute:"character-count"})],h.prototype,"characterCount",void 0),e._([e.n({type:String,attribute:"helper-text-screen-reader-msg"})],h.prototype,"helperTextScreenReaderMsg",void 0),e._([e.n({type:String,attribute:"character-count-aria-label"})],h.prototype,"characterCountAriaLabel",void 0),e._([e.h()],h.prototype,"hasLabel",void 0),e._([e.h()],h.prototype,"hasTrailingButton",void 0),e._([e.l({slot:"label"})],h.prototype,"labelSlot",void 0),e._([e.l({slot:"trailingIconButton"})],h.prototype,"trailingIconButtonSlot",void 0),e._([e.h()],h.prototype,"statefulInput",void 0),e._([e.n({type:Boolean,attribute:"suppress-internal-clicks"})],h.prototype,"suppressInternalClicks",void 0),e._([e.n({type:Boolean})],h.prototype,"readonly",void 0),e._([e.n({type:String,attribute:"validation-message"})],h.prototype,"validationMsg",void 0),e._([e.n({type:Boolean,attribute:"allow-max-length-overflow"})],h.prototype,"allowMaxLengthOverflow",void 0),{T:h,l:o}}));
SML.di("./Cs7sMcuNEu.js",import.meta.url,"Cs7sMcuNEu");SML.di("./CRzmHkIoo0.js",import.meta.url,"CRzmHkIoo0");SML.di("./BvJOe9C929.js",import.meta.url,"BvJOe9C929");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./DXiBrmAMuC.js",import.meta.url,"DXiBrmAMuC");SML.di("./Bw-OyhxMwg.js",import.meta.url,"Bw-OyhxMwg");SML.di("./CSyIYk6M3w.js",import.meta.url,"CSyIYk6M3w");SML.di("./D_4HUCmNhm.js",import.meta.url,"D_4HUCmNhm");SML.di("./CCBTR4TAfR.js",import.meta.url,"CCBTR4TAfR");SML.di("./B9FNmoZbPR.js",import.meta.url,"B9FNmoZbPR");SML.di("./BX2z6Mar1p.js",import.meta.url,"BX2z6Mar1p");SML.di("./CtaRzYFrol.js",import.meta.url,"CtaRzYFrol");SML.di("./KkXqW5RUm3.js",import.meta.url,"KkXqW5RUm3");SML.di("./B0pL5bhFHV.js",import.meta.url,"B0pL5bhFHV");SML.di("./CU8weQ2dDy.js",import.meta.url,"CU8weQ2dDy");SML.di("./hd4nVjQBS-.js",import.meta.url,"hd4nVjQBS-");SML.di("./pA9dwrnd0r.js",import.meta.url,"pA9dwrnd0r");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./CspnAIpcFE.js",import.meta.url,"CspnAIpcFE");SML.di("./2dYGY2J66F.js",import.meta.url,"2dYGY2J66F");SML.di("./Cn5Dm3JnwH.js",import.meta.url,"Cn5Dm3JnwH");SML.di("./DgW4ULLwQ1.js",import.meta.url,"DgW4ULLwQ1");SML.di("./Bypt3-pSP2.js",import.meta.url,"Bypt3-pSP2");SML.di("./D14t1nj-sI.js",import.meta.url,"D14t1nj-sI");SML.di("./DQQjPN-OEj.js",import.meta.url,"DQQjPN-OEj");SML.di("./CQrDBXK-hm.js",import.meta.url,"CQrDBXK-hm");SML.di("./gvWVn4JBWB.js",import.meta.url,"gvWVn4JBWB");SML.di("./DmeLdLooOj.js",import.meta.url,"DmeLdLooOj");SML.di("./DLXAqLxSut.js",import.meta.url,"DLXAqLxSut");SML.di("./CZLMnmUH44.js",import.meta.url,"CZLMnmUH44");SML.di("./Cl1pMDH2OX.js",import.meta.url,"Cl1pMDH2OX");SML.di("./CEs3hLX56z.js",import.meta.url,"CEs3hLX56z");SML.di("./B6Ai7g9fbR.js",import.meta.url,"B6Ai7g9fbR");SML.di("./BXUgRcxEAi.js",import.meta.url,"BXUgRcxEAi");SML.di("./w2XkRJ2mzc.js",import.meta.url,"w2XkRJ2mzc");SML.di("./h4Pa0OJr_5.js",import.meta.url,"h4Pa0OJr_5");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./DFh5Z0Dv0L.js",import.meta.url,"DFh5Z0Dv0L");SML.di("./CsrbxKoUKW.js",import.meta.url,"CsrbxKoUKW");SML.di("./Py9rIF7r2a.js",import.meta.url,"Py9rIF7r2a");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./D1ScrvIqaY.js",import.meta.url,"D1ScrvIqaY");SML.di("./CxA9E_GW4X.js",import.meta.url,"CxA9E_GW4X");SML.di("./CMwg6atOpj.js",import.meta.url,"CMwg6atOpj");SML.di("./BwcUp7XlaC.js",import.meta.url,"BwcUp7XlaC");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./DnNITwgp90.js",import.meta.url,"DnNITwgp90");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");SML.di("./CQMf561ZyA.js",import.meta.url,"CQMf561ZyA");SML.di("./ClaQym8zez.js",import.meta.url,"ClaQym8zez");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");SML.di("./BOFc1KQJc-.js",import.meta.url,"BOFc1KQJc-");SML.di("./jTFRatIQcd.js",import.meta.url,"jTFRatIQcd");SML.di("./Z0tk4vmzIQ.js",import.meta.url,"Z0tk4vmzIQ");SML.di("./DWhb02bbsY.js",import.meta.url,"DWhb02bbsY");SML.di("./iewwAXEto0.js",import.meta.url,"iewwAXEto0");SML.di("./C6UOB_RPC4.js",import.meta.url,"C6UOB_RPC4");SML.di("./B2_gjouej4.js",import.meta.url,"B2_gjouej4");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");SML.di("./BSYfFtBeKH.js",import.meta.url,"BSYfFtBeKH");SML.di("./D1DY-avSiT.js",import.meta.url,"D1DY-avSiT");SML.di("./g8Ezfsb_Vs.js",import.meta.url,"g8Ezfsb_Vs");SML.di("./DfOK659qrU.js",import.meta.url,"DfOK659qrU");SML.di("./DOqOHj9jA9.js",import.meta.url,"DOqOHj9jA9");SML.di("./BRjrtOukap.js",import.meta.url,"BRjrtOukap");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");SML.di("./0hqgxSo9Jy.js",import.meta.url,"0hqgxSo9Jy");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./CwJMtJ-bLN.js",import.meta.url,"CwJMtJ-bLN");SML.di("./COCf9Sdqlx.js",import.meta.url,"COCf9Sdqlx");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");SML.di("./YFXcK0ZyJl.js",import.meta.url,"YFXcK0ZyJl");SML.di("./C0cxgUZlQL.js",import.meta.url,"C0cxgUZlQL");
SML.dm("BxtSkeanpL",["Dw4vb8Yfbm","Cs7sMcuNEu","CRzmHkIoo0","BvJOe9C929","DXiBrmAMuC","Bw-OyhxMwg","CSyIYk6M3w","D_4HUCmNhm","CCBTR4TAfR","B9FNmoZbPR","BX2z6Mar1p","CtaRzYFrol","KkXqW5RUm3","B0pL5bhFHV","CU8weQ2dDy","hd4nVjQBS-","pA9dwrnd0r","xrDbp1ee_h","B-zFJtiar6","5r73EsgItq","CspnAIpcFE","2dYGY2J66F","Cn5Dm3JnwH","DgW4ULLwQ1","Bypt3-pSP2","D14t1nj-sI","DQQjPN-OEj","CQrDBXK-hm","gvWVn4JBWB","DmeLdLooOj","DLXAqLxSut","CZLMnmUH44","Cl1pMDH2OX","CEs3hLX56z","B6Ai7g9fbR","BXUgRcxEAi","w2XkRJ2mzc","h4Pa0OJr_5","BIzQFHISzm","DFh5Z0Dv0L","CsrbxKoUKW","Py9rIF7r2a","BwcMg3lXAs","D1ScrvIqaY","CxA9E_GW4X","CMwg6atOpj","BwcUp7XlaC","FQGvCwaizg","DnNITwgp90","jWC3N3n7Al","CQMf561ZyA","ClaQym8zez","Cv4mWnWE30","C8QDHFSIkY","BOFc1KQJc-","jTFRatIQcd","Z0tk4vmzIQ","DWhb02bbsY","iewwAXEto0","C6UOB_RPC4","B2_gjouej4","tO6bKRQro7","Bu440t6XLo","BeFppRYbzE","BSYfFtBeKH","D1DY-avSiT","g8Ezfsb_Vs","DfOK659qrU","DOqOHj9jA9","BRjrtOukap","BYzqEZ3uv3","eY7T41bKac","0hqgxSo9Jy","D_g7f2Ewyi","CwJMtJ-bLN","COCf9Sdqlx","BtqmVQuPYp","YFXcK0ZyJl","C0cxgUZlQL"],(async E=>{E.g()&&SML.di("./nvzb1psNLM.js",import.meta.url,"nvzb1psNLM")}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("Bypt3-pSP2",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6"],(async(t,e,o)=>{let r=class extends e.s{constructor(){super(),this.ts="",this.short=!1,this.format="",this.locale="",this.date=new Date(this.ts)}getLocale(){return this.locale.length?this.locale:o.bJ()}createRenderRoot(){return this}render(){const t=o.cf(this.getLocale(),{dateStyle:"full",timeStyle:"long"}).format(this.date),r={short:this.short,format:this.format.length?this.format:void 0},i=o.cg(this.date,this.getLocale(),r);return e.x` <time datetime="${this.date.toISOString()}" title="${t}">${i}</time> `}};t._([t.n({type:String})],r.prototype,"ts",void 0),t._([t.n({attribute:"ts",converter:t=>o.bL(t||"")})],r.prototype,"date",void 0),t._([t.n({type:Boolean})],r.prototype,"short",void 0),t._([t.n({type:String})],r.prototype,"format",void 0),t._([t.n({type:String})],r.prototype,"locale",void 0),r=t._([t.e("faceplate-timeago")],r)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("Bypt3-pSP2",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6"],(async(t,e,o)=>{let r=class extends e.s{constructor(){super(),this.ts="",this.short=!1,this.format="",this.locale="",this.date=new Date(this.ts)}getLocale(){return this.locale.length?this.locale:o.bJ()}createRenderRoot(){return this}render(){const t=o.cf(this.getLocale(),{dateStyle:"full",timeStyle:"long"}).format(this.date),r={short:this.short,format:this.format.length?this.format:void 0},i=o.cg(this.date,this.getLocale(),r);return e.x` <time datetime="${this.date.toISOString()}" title="${t}">${i}</time> `}};t._([t.n({type:String})],r.prototype,"ts",void 0),t._([t.n({attribute:"ts",converter:t=>o.bL(t||"")})],r.prototype,"date",void 0),t._([t.n({type:Boolean})],r.prototype,"short",void 0),t._([t.n({type:String})],r.prototype,"format",void 0),t._([t.n({type:String})],r.prototype,"locale",void 0),r=t._([t.e("faceplate-timeago")],r)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Py9rIF7r2a.js",import.meta.url,"Py9rIF7r2a");SML.di("./BTnwE85rpZ.js",import.meta.url,"BTnwE85rpZ");SML.di("./DCbB57ubLb.js",import.meta.url,"DCbB57ubLb");SML.di("./D_6DXw1u0k.js",import.meta.url,"D_6DXw1u0k");SML.di("./CMwg6atOpj.js",import.meta.url,"CMwg6atOpj");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");
SML.dm("C-yoNTAv-M",["Dw4vb8Yfbm","5r73EsgItq","Py9rIF7r2a","BTnwE85rpZ","DCbB57ubLb","D_6DXw1u0k","CMwg6atOpj","eY7T41bKac"],(async(e,t,i,o,s)=>{function r(e,t=document.documentElement){for(;e&&!e.dataset.token&&e!==t;)e=e.parentElement;return e?.dataset.token?e:void 0}function a(e){if(!e)return;const{token:t,url:i}=e.dataset;return t&&i?{token:t,url:i}:void 0}const n=/:/g;let l=class extends t.s{constructor(){super(...arguments),this.isModalView=!1,this.query="",this.options={},this.showAsModal=async()=>{this.modal?.show(),await(this.modal?.updateComplete)},this.showAsBlockingModal=async()=>{this.modal?.showModal(),await(this.modal?.updateComplete),this.removeModalShadow()},this.removeModalShadow=()=>{this.modal&&this.modal.style&&(this.modal.style.boxShadow="")},this.focusSearchInput=()=>{setTimeout((()=>this.searchInput?.focus()),0)},this.resetInputAndFilter=()=>{this.query="",this.searchInput.value=""}}static get styles(){return[e.t,t.a`:host{--content-width:min(400px, calc(100vw - var(--size-4xl)))}`]}setEditor(e){this.editor=e}onSelectEmoji(e){e.preventDefault(),e.stopPropagation();const t=r(e.target);if(!t)return;const i=a(t);i&&this.editor?.update((()=>{const e=s.E()||s.T();if(!s.u(e))return;const t=o.$({src:i.url,mediaId:i.token,mimetype:"image/png"}),{anchor:r}=e;if(s.x(r.getNode())){const e=r.getNode();s.g(e)&&e.getLastChild()?.append(t)}else e.insertNodes([t])}))}async show(){this.isModalView?await this.showAsBlockingModal():await this.showAsModal(),this.focusSearchInput()}close(){this.modal?.open&&(this.resetInputAndFilter(),this.modal?.close())}onSearchFieldInput(e){this.query=e.target?.value??""}preRenderOptions(){this.options={};for(const t of this.optionTemplates){const{token:i}=t.dataset;i&&(this.options[i]=e.a1(t))}}onOptionKeyDown(e){"Enter"!==e.code&&"Space"!==e.code||this.onSelectEmoji(e)}renderSearchInput(){return t.x` <faceplate-search-input class="block pt-xs m-0" type="text" name="emojiQuery" appearance="secondary" placeholder="${"Search for emoji"}" @input="${this.onSearchFieldInput}" clearable> <span slot="leadingIcon">${i.s({size:t.I.Small})}</span> </faceplate-search-input> `;}render(){const i=this.query.replaceAll(n,""),o=Object.entries(this.options).filter((([e])=>!i||e.toLowerCase().includes(i.toLowerCase()))).map((([,e])=>e));return t.x` <slot @slotchange="${this.preRenderOptions}"></slot> <faceplate-modal class="relative"> <div slot="title" class="flex-1 text-neutral-content-strong"> ${"Flair Emojis"} </div> ${e.o({attributes:{slot:"closeButton",type:"button",onclick:this.close},appearance:"secondary",shape:"pill",leadingIcon:e.al({size:t.I.Small}),size:e.q.Small})} <div class="flex flex-col ${this.isModalView?"w-[var(--content-width)]":""}"> ${this.renderSearchInput()} ${o.length?t.x`<ul class="list-none grid grid-cols-[repeat(6,minmax(32px,1fr))] grid-rows-[32px] gap-xs px-xs py-2xs mb-0 mt-md -mx-xs overflow-auto h-[112px]" @click="${this.onSelectEmoji}" @keydown="${this.onOptionKeyDown}"> ${o} </ul>`:t.x`<div class="px-xs py-2xs mt-md h-[112px] text-neutral-content-weak text-14 text-center pt-2xs"> ${`Hm... we couldnt find any emoji for ${this.query}`} </div>`} </div> </faceplate-modal> `;}};e._([e.a2("faceplate-modal")],l.prototype,"modal",void 0),e._([e.a2('faceplate-search-input[name="emojiQuery"]')],l.prototype,"searchInput",void 0),e._([e.l({selector:"template"})],l.prototype,"optionTemplates",void 0),e._([e.n({type:Boolean,attribute:"is-modal-view"})],l.prototype,"isModalView",void 0),e._([e.h()],l.prototype,"query",void 0),e._([e.h()],l.prototype,"options",void 0),l=e._([e.e("emoji-picker")],l);const m=/(:.+?:)/g,u=/(:\w+?)$/;function h(e,t,i,s){let r;0===i?[r]=e.splitText(s):[,r]=e.splitText(i,s);const a=o.$({src:t.url,mediaId:t.token,mimetype:"image/png"});return r.replace(a),a}let c=class extends t.s{constructor(){super(...arguments),this.query="",this.selection=null,this.editorsWeakSet=new WeakSet,this.onEmojiOptionKeyDown=e=>{"Enter"!==e.code&&"Space"!==e.code||this.onSelectEmoji(e)}}static get styles(){return[e.t]}updateQuery(e){this.query=e}close(){this.updateQuery("")}setEditor(e){this.editorsWeakSet.has(e)||(e.registerUpdateListener((({editorState:e})=>{e.read((()=>{const e=s.E();if(!s.u(e)||!e.isCollapsed())return void this.close();const t=function(e){const t=e.anchor;if("text"!==t.type)return null;const i=t.getNode();if(!i.isSimpleText())return null;const o=t.offset;return i.getTextContent().slice(0,o)}(e);if(null===t)return void this.close();const i=t.match(u);i?(this.query=i[1]??"",e&&(this.selection=e)):this.close()}))})),e.registerCommand(s.a,(()=>(this.menu?.setFocus(0),!0)),s.J),e.registerNodeTransform(s.j,(e=>{if(!e.isSimpleText())return;const t=e.getTextContent().matchAll(m),i=Array.from(t);i.reverse();for(const t of i){const{index:i}=t,o=t[0],s=a(this.suggestionTemplates.find((e=>e.dataset.token===o)));"number"==typeof i&&s&&h(e,s,i,i+o.length)}}))),this.editor=e}onSelectEmoji(e){e.preventDefault(),e.stopPropagation();const t=r(e.target);if(!t)return;const i=a(t);i&&this.editor?.update((()=>{const e=this.selection||s.E();if(!s.u(e))return;const t=e.anchor;if("text"!==t.type)return;const o=t.getNode();if(!o.isSimpleText())return;const r=o.getTextContent().toLowerCase(),a=t.offset-this.query.length;let n=t.offset;for(;n<o.getTextContentSize()&&n-a<i.token.length&&r[n]===i.token[n-a];)n++;const l=h(o,i,a,n);this.selection&&(l.select(),this.selection=null),this.close()}))}render(){const e=this.suggestionTemplates.filter((e=>e.dataset.token?.toLowerCase().startsWith(this.query.toLowerCase()))).map((e=>e.cloneNode(!0)));return t.x` <slot class="hidden"></slot> ${this.query?t.x` <faceplate-menu class="${this.query?"block":"hidden"}" disable-auto-focus @click="${this.onSelectEmoji}" @keydown="${this.onEmojiOptionKeyDown}"> ${e} </faceplate-menu> `:""} `}};e._([e.l({selector:"li"})],c.prototype,"suggestionTemplates",void 0),e._([e.a2("faceplate-menu")],c.prototype,"menu",void 0),e._([e.h()],c.prototype,"query",void 0),c=e._([e.e("emoji-typeahead")],c)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("C0cxgUZlQL",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6"],(async(t,e,o)=>{const r={options:{dateStyle:"full",timeStyle:"long"}};let s=class extends e.s{constructor(){super(...arguments),this.ts="",this.date=new Date,this.short=!1,this.locale=""}getLocale(){return this.locale||o.bJ()}createRenderRoot(){return this}render(){const t=this.getLocale(),s=o.bK(this.date,t,r),i=this.formatOptions?{options:this.formatOptions}:{short:this.short},a=o.bK(this.date,t,i);return e.x`<time datetime="${this.date.toISOString()}" title="${s}">${a}</time>`}};t._([t.n({type:String})],s.prototype,"ts",void 0),t._([t.n({attribute:"ts",converter:t=>o.bL(t||"")})],s.prototype,"date",void 0),t._([t.n({type:Boolean})],s.prototype,"short",void 0),t._([t.n({type:String})],s.prototype,"locale",void 0),t._([t.n({type:Object})],s.prototype,"formatOptions",void 0),s=t._([t.e("faceplate-date")],s)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("C1YU_DAt3n",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,s)=>{let t=class extends s.s{constructor(){super(...arguments),this.username=""}firstUpdated(){this.run()}shouldDispatchToast(e){const s=new Date(e).getTime();return!isNaN(s)&&Date.now()-s<=1e4}run(){const t=e.a8.getItem(e.a9.LoginTime);t&&this.shouldDispatchToast(t)&&this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.notice,namedContent:{action:s.x``},message:`Logged in as ${this.username}`,sourceElement:"after-login-toast-dispatcher",cause:"user-login"}))}render(){return s.x``}};e._([e.n({type:String,attribute:"username"})],t.prototype,"username",void 0),t=e._([e.e("after-login-toast-dispatcher")],t)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./DgW4ULLwQ1.js",import.meta.url,"DgW4ULLwQ1");SML.di("./YAFaZPh0hw.js",import.meta.url,"YAFaZPh0hw");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./KHcvarc_gp.js",import.meta.url,"KHcvarc_gp");SML.di("./Dj7wutmAw0.js",import.meta.url,"Dj7wutmAw0");SML.di("./BOFc1KQJc-.js",import.meta.url,"BOFc1KQJc-");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./CQrDBXK-hm.js",import.meta.url,"CQrDBXK-hm");SML.di("./B7VtDPc4tA.js",import.meta.url,"B7VtDPc4tA");SML.di("./CUIVPWsUpf.js",import.meta.url,"CUIVPWsUpf");SML.di("./CzmIuH4u_q.js",import.meta.url,"CzmIuH4u_q");SML.di("./D14t1nj-sI.js",import.meta.url,"D14t1nj-sI");SML.di("./DQQjPN-OEj.js",import.meta.url,"DQQjPN-OEj");SML.di("./CG8L8PJoXS.js",import.meta.url,"CG8L8PJoXS");SML.di("./Bv2UEnJP_M.js",import.meta.url,"Bv2UEnJP_M");SML.di("./JaGlTj3I-9.js",import.meta.url,"JaGlTj3I-9");SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");
SML.dm("C2AqOgl1ck",["Dw4vb8Yfbm","YAFaZPh0hw","B-zFJtiar6","KHcvarc_gp","Dj7wutmAw0","BOFc1KQJc-","xrDbp1ee_h","5r73EsgItq","CQrDBXK-hm","DgW4ULLwQ1","B7VtDPc4tA","CUIVPWsUpf","CzmIuH4u_q","D14t1nj-sI","DQQjPN-OEj","CG8L8PJoXS","Bv2UEnJP_M","JaGlTj3I-9","C8QDHFSIkY"],(async(t,o,e,n,r,i,a,l,s)=>{const u=l.s;let d=window.location.search,c=class extends u{constructor(){super(...arguments),this.commentId="",this.score=void 0,this.isDesktopViewport=!1,this.disabled=!1,this.isUserLoggedIn=!1,this.isMod=!1,this.previousActionsFeature=!1,this.isCommentArchived=!1,this.isViewOnly=!1,this.aggregatedInbox=!1,this.isContestMode=!1,this.isScoreHidden=!1,this.permalink="",this.interactionFromHotkey=!1,this.isUserBanned=!1,this.voteState=t.b6.None,this.updateAnimation=void 0,this.isCommentComposerActive=!1,this.viewContext=a.P.CommentsPage,this.commentOverflowMenu=null,this.pubsub=new t.u(this),this.subscribeToReplyMenuItemClick=()=>{this.commentOverflowMenu=this.getCommentOverflowMenu(),this.commentOverflowMenu?.addEventListener(e.a$,this.handleReply)},this.unsubscribeToReplyMenuItemClick=()=>{this.commentOverflowMenu?.removeEventListener(e.a$,this.handleReply)},this.getCommentOverflowMenu=()=>this.querySelector("shreddit-overflow-menu"),this._events=new t.E(this),this.hideCommentComposer=()=>{const t=this.querySelector('[slot="comment-composer"]');t&&t.remove(),this.isCommentComposerActive=!1},this.handleCommentUpdated=({commentId:t,action:o,value:e})=>{this.commentId===t&&o===i.C.lock&&(this.isViewOnly=r.i({isLocked:Boolean(e),isMod:this.isMod,isArchived:this.isCommentArchived,isUserBanned:this.isUserBanned}),this.isViewOnly&&this.hideCommentComposer())},this.handleCancelDraftEvent=this._events.define(e.b0,this.hideCommentComposer),this.handleCommentPostEvent=this._events.define(e.C,this.hideCommentComposer),this.focusOnCommentComposer=()=>{if(!this.querySelector('[slot="comment-composer"]')){const t=this.querySelector('[slot="comment-composer-template"]');if(!(t instanceof HTMLTemplateElement))return;const o=t.content.cloneNode(!0);this.appendChild(o)}this.isCommentComposerActive=!0,this.querySelector("comment-composer-host")?.focus()},this._pushState=t=>{window.history.pushState({},"",t)},this.handleReply=t=>{if(this.disabled)return;const o=this.closest("shreddit-comment")?.getAttribute("reply-permalink");o?this._pushState(o):(t.stopImmediatePropagation(),t.stopPropagation(),this.focusOnCommentComposer())},this.getCommentVoteTypeFromVoteState=()=>{switch(this.voteState){case t.b6.Up:return n.V.Upvote;case t.b6.Down:return n.V.Downvote;default:return}},this._getCommentScoreDelta=t=>n.g(this.commentVoteType,t),this._onUpdateCommentVoteType=async()=>await n.o(this.commentId,"comment",this.commentVoteType),this.getContestModeVoteCTA=()=>l.x`${"Vote"}`}static get styles(){return[t.t,t.a0(".rpl-vote-button-group {\n  /* APPEARANCE AGNOSTIC STYLES */\n  /* PLAIN APPEARANCE */\n  /* SECONDARY APPEARANCE */\n  /* BORDERED APPEARANCE */\n  --vote-button-divider-color: var(--color-neutral-border-weak);\n  /* MEDIA APPEARANCE */\n}\n.rpl-vote-button-group:not([disabled]) .rpl-vote-button-group-label {\n  color: var(--vote-button-label-color);\n}\n.rpl-vote-button-group:not([disabled]):hover.rpl-vote-button-group-label {\n  color: var(--vote-button-label-color-hover);\n}\n.rpl-vote-button-group .rpl-vote-button-group-divider {\n  background-color: var(--vote-button-divider-color);\n}\n.rpl-vote-button-group[disabled] button[rpl]:disabled {\n  --button-color-background-disabled: transparent;\n}\n.rpl-vote-button-group.button-plain {\n  --vote-button-label-color: var(--color-secondary-plain);\n  --vote-button-label-color-hover: var(--color-secondary-plain);\n}\n.rpl-vote-button-group.button-plain button[rpl]:first-child {\n  --button-color-text-hover: var(--color-upvote-plain-weaker);\n}\n.rpl-vote-button-group.button-plain button[rpl]:last-child {\n  --button-color-text-hover: var(--color-downvote-plain-weaker);\n}\n.rpl-vote-button-group.button-plain.upvote {\n  --vote-button-label-color: var(--color-upvote-plain);\n}\n.rpl-vote-button-group.button-plain.upvote button[rpl]:first-child {\n  --button-color-text-default: var(--color-upvote-plain-weaker);\n  --button-color-text-hover: var(--color-upvote-plain-weaker);\n  --button-color-text-disabled: var(--color-upvote-plain-disabled);\n  --button-color-text-activated: var(--color-upvote-plain-weaker);\n}\n.rpl-vote-button-group.button-plain.downvote {\n  --vote-button-label-color: var(--color-downvote-plain);\n}\n.rpl-vote-button-group.button-plain.downvote button[rpl]:last-child {\n  --button-color-text-default: var(--color-downvote-plain-weaker);\n  --button-color-text-disabled: var(--color-downvote-plain-disabled);\n  --button-color-text-activated: var(--color-downvote-plain-weaker);\n}\n.rpl-vote-button-group.button-secondary {\n  --vote-button-label-color: var(--color-secondary-plain);\n  --vote-button-label-color-hover: var(--color-secondary-plain);\n  --vote-button-divider-color: var(--color-neutral-border);\n}\n.rpl-vote-button-group.button-secondary button[rpl]:first-child {\n  --button-color-text-hover: var(--color-upvote-plain-weaker);\n}\n.rpl-vote-button-group.button-secondary button[rpl]:last-child {\n  --button-color-text-hover: var(--color-downvote-plain-weaker);\n}\n.rpl-vote-button-group.button-secondary.upvote,\n.rpl-vote-button-group.button-secondary.upvote button[rpl] {\n  --button-color-text-default: var(--color-upvote-onBackground);\n  --button-color-text-hover: var(--color-upvote-onBackground);\n  --button-color-text-disabled: var(--color-upvote-disabled);\n  --button-color-text-activated: var(--color-upvote-onBackground);\n}\n.rpl-vote-button-group.button-secondary.upvote:not([disabled]),\n.rpl-vote-button-group.button-secondary.upvote button[rpl]:not([disabled]) {\n  --button-color-background-default: var(--color-upvote-background);\n  --button-color-background-hover: var(--color-upvote-background-hover);\n  --button-color-background-active: var(--color-upvote-background-hover);\n  --vote-button-divider-color: var(--color-upvote-onBackground);\n  --vote-button-label-color: var(--color-media-onBackground);\n}\n.rpl-vote-button-group.button-secondary.downvote,\n.rpl-vote-button-group.button-secondary.downvote button[rpl] {\n  --button-color-text-default: var(--color-downvote-onBackground);\n  --button-color-text-hover: var(--color-downvote-onBackground);\n  --button-color-text-disabled: var(--color-downvote-disabled);\n  --button-color-text-activated: var(--color-downvote-onBackground);\n}\n.rpl-vote-button-group.button-secondary.downvote:not([disabled]),\n.rpl-vote-button-group.button-secondary.downvote button[rpl]:not([disabled]) {\n  --button-color-background-default: var(--color-downvote-background);\n  --button-color-background-hover: var(--color-downvote-background-hover);\n  --button-color-background-active: var(--color-downvote-background-hover);\n  --vote-button-divider-color: var(--color-upvote-onBackground);\n  --vote-button-label-color: var(--color-media-onBackground);\n}\n.rpl-vote-button-group.button-bordered-cab {\n  --vote-button-label-color: var(--color-secondary-plain);\n  --vote-button-label-color-hover: var(--color-secondary-plain);\n}\n.rpl-vote-button-group.button-bordered-cab button[rpl]:first-child {\n  --button-color-text-hover: var(--color-upvote-plain-weaker);\n}\n.rpl-vote-button-group.button-bordered-cab button[rpl]:last-child {\n  --button-color-text-hover: var(--color-downvote-plain-weaker);\n}\n.rpl-vote-button-group.button-bordered-cab.upvote {\n  --vote-button-label-color: var(--color-upvote-plain);\n}\n.rpl-vote-button-group.button-bordered-cab.upvote button[rpl]:first-child {\n  --button-color-text-default: var(--color-upvote-plain-weaker);\n  --button-color-text-hover: var(--color-upvote-plain-weaker);\n  --button-color-text-disabled: var(--color-upvote-plain-disabled);\n  --button-color-text-activated: var(--color-upvote-plain-weaker);\n}\n.rpl-vote-button-group.button-bordered-cab.downvote {\n  --vote-button-label-color: var(--color-downvote-plain);\n}\n.rpl-vote-button-group.button-bordered-cab.downvote button[rpl]:last-child {\n  --button-color-text-default: var(--color-downvote-plain-weaker);\n  --button-color-text-hover: var(--color-downvote-plain-weaker);\n  --button-color-text-disabled: var(--color-downvote-plain-disabled);\n  --button-color-text-activated: var(--color-downvote-plain-weaker);\n}\n.rpl-vote-button-group.button-media-cab {\n  --vote-button-label-color: var(--color-media-onBackground);\n  --vote-button-label-color-hover: var(--color-media-onBackground);\n  --vote-button-divider-color: var(--color-media-border-weak);\n}\n.rpl-vote-button-group.button-media-cab button[rpl]:first-child {\n  --button-color-text-hover: var(--color-upvote-onStrongScrim-weaker);\n}\n.rpl-vote-button-group.button-media-cab button[rpl]:last-child {\n  --button-color-text-hover: var(--color-downvote-onStrongScrim-weaker);\n}\n.rpl-vote-button-group.button-media-cab.upvote {\n  --vote-button-label-color: var(--color-upvote-onStrongScrim);\n}\n.rpl-vote-button-group.button-media-cab.upvote button[rpl]:first-child {\n  --button-color-text-default: var(--color-upvote-onStrongScrim-weaker);\n  --button-color-text-activated: var(--color-upvote-onStrongScrim-weaker);\n  --button-color-text-disabled: var(--color-upvote-onStrongScrim-disabled);\n}\n.rpl-vote-button-group.button-media-cab.downvote {\n  --vote-button-label-color: var(--color-downvote-onStrongScrim);\n}\n.rpl-vote-button-group.button-media-cab.downvote button[rpl]:last-child {\n  --button-color-text-default: var(--color-downvote-onStrongScrim-weaker);\n  --button-color-text-activated: var(--color-downvote-onStrongScrim-weaker);\n  --button-color-text-disabled: var(--color-downvote-onStrongScrim-disabled);\n}\n")]}connectedCallback(){super.connectedCallback(),this.commentVoteType=this.getCommentVoteTypeFromVoteState(),this.isUserLoggedIn&&this.subscribeToReplyMenuItemClick(),this.pubsub.subscribe(t.T.CommentUpdated,this.handleCommentUpdated),this.isUserLoggedIn&&this.initModActionsController()}async initModActionsController(){const{ModActionsController:t}=await SML.di("./i5-QpR8HYV.js",import.meta.url,"i5-QpR8HYV");new t(this,{getThingIdFn:()=>this.commentId})}disconnectedCallback(){super.disconnectedCallback(),this.isUserLoggedIn&&this.unsubscribeToReplyMenuItemClick()}firstUpdated(...t){super.firstUpdated(...t);new URLSearchParams(d).get("reply")===this.commentId&&this.focusOnCommentComposer()}handleInteraction(){document.querySelector(s.S)?.setAttribute("pageindex","1")}async handleDownvote(o){this.isUserLoggedIn?(this.handleInteraction(),await this.handleUpdateCommentVote(n.V.Downvote)):this.disabled||(t.i(this,e.b1(this.telemetrySource)),this.dispatchEvent(t.c(t.dh.downvote,{thingId:this.commentId,permalink:this.permalink})),this.pubsub.publish(t.T.CommentDownvoted))}async handleUpvote(o){this.isUserLoggedIn?(this.handleInteraction(),await this.handleUpdateCommentVote(n.V.Upvote)):this.disabled||(t.i(this,e.b2(this.telemetrySource)),this.dispatchEvent(t.c(t.dh.upvote,{thingId:this.commentId,permalink:this.permalink})),this.pubsub.publish(t.T.CommentUpvoted))}async handleUpdateCommentVote(o){const r=this.score,i=this.commentVoteType;if(void 0!==this.score){const t=this._getCommentScoreDelta(o);this.score=this.score+t}const a=o===this.commentVoteType;this.commentVoteType=a?undefined:o;try{await this._onUpdateCommentVoteType(),a?t.i(this,e.b3(this.telemetrySource,this.interactionFromHotkey?t.d3.HOTKEY:void 0)):o===n.V.Upvote?(t.i(this,e.b2(this.telemetrySource,this.interactionFromHotkey?t.d3.HOTKEY:void 0)),this.pubsub.publish(t.T.CommentUpvoted)):(t.i(this,e.b1(this.telemetrySource,this.interactionFromHotkey?t.d3.HOTKEY:void 0)),t.i(this,e.b1(this.telemetrySource)),this.pubsub.publish(t.T.CommentDownvoted))}catch(o){this.score=r,this.commentVoteType=i,this.dispatchEvent(t.c("faceplate-alert",{level:t.a5.warning,message:o.message}))}}renderVoteButtons(){const n=e.b4(),r=n?o.a:o.v,i=n?o.b:o.u,a=n?o.c:o.d,l=this.isContestMode||this.isScoreHidden?void 0:this.score,s=this.isContestMode||this.isScoreHidden?this.getContestModeVoteCTA():void 0,u={voteType:this.commentVoteType||null,attributes:{disabled:this.disabled||this.isCommentArchived},size:t.q.Small,appearance:"plain-weak"},d=i({...u,voteCount:l,initialStateText:s,screenReaderContent:"Upvote",onClick:this.handleUpvote}),c=a({...u,screenReaderContent:"Downvote",onClick:this.handleDownvote});return r({appearance:"plain-weak",voteCount:l,voteType:this.commentVoteType||void 0,size:u.size,upvoteButton:d,downvoteButton:c,initialStateText:s,attributes:{slot:"vote-button",disabled:this.disabled}})}render(){return l.x`<div class="flex flex-col w-100"> <slot name="mod-content-state-indicators"></slot> <div class="flex items-center max-h-2xl"> <div class="flex items-center max-h-2xl shrink"> ${this.renderVoteButtons()} ${this.isViewOnly?l.A:l.x`<slot name="comment-reply" @click="${this.handleReply}"></slot>`} <slot name="comment-share-as-post-topline"></slot> <slot name="comment-award"></slot> <slot name="comment-share"></slot> <slot name="comment-insight"></slot> <slot name="overflow"></slot> </div> <slot name="mod-content-actions"></slot> </div> ${this.isCommentComposerActive&&!this.isViewOnly?l.x` <div class="py-md ${this.aggregatedInbox?"ms-[-36px]":""}"> <slot name="comment-composer"></slot> </div> `:l.x``} </div>`}};return t._([t.n({type:String,attribute:"comment-id"})],c.prototype,"commentId",void 0),t._([t.n({type:String,attribute:"user-id"})],c.prototype,"userId",void 0),t._([t.n({type:Number})],c.prototype,"score",void 0),t._([t.n({type:Boolean,attribute:"is-desktop-viewport"})],c.prototype,"isDesktopViewport",void 0),t._([t.n({type:Boolean})],c.prototype,"disabled",void 0),t._([t.n({type:Boolean,attribute:"is-user-logged-in"})],c.prototype,"isUserLoggedIn",void 0),t._([t.n({type:Boolean,attribute:"mod"})],c.prototype,"isMod",void 0),t._([t.n({type:String,attribute:"moderation-verdict"})],c.prototype,"moderationVerdict",void 0),t._([t.n({type:Boolean,attribute:"previous-actions-feature"})],c.prototype,"previousActionsFeature",void 0),t._([t.n({type:Boolean,attribute:"comment-archived"})],c.prototype,"isCommentArchived",void 0),t._([t.n({type:Boolean,attribute:"view-only"})],c.prototype,"isViewOnly",void 0),t._([t.n({type:Boolean,attribute:"aggregated-inbox"})],c.prototype,"aggregatedInbox",void 0),t._([t.n({type:Boolean,attribute:"is-contest-mode"})],c.prototype,"isContestMode",void 0),t._([t.n({type:Boolean,attribute:"is-score-hidden"})],c.prototype,"isScoreHidden",void 0),t._([t.n({type:String})],c.prototype,"permalink",void 0),t._([t.n({type:Boolean,attribute:"interaction-from-hotkey"})],c.prototype,"interactionFromHotkey",void 0),t._([t.n({type:Boolean,attribute:"banned"})],c.prototype,"isUserBanned",void 0),t._([t.n({type:String,attribute:"vote-state"})],c.prototype,"voteState",void 0),t._([t.h()],c.prototype,"commentVoteType",void 0),t._([t.n({type:String,attribute:"telemetry-source"})],c.prototype,"telemetrySource",void 0),t._([t.n({type:String,reflect:!0})],c.prototype,"updateAnimation",void 0),t._([t.h()],c.prototype,"isCommentComposerActive",void 0),c=t._([t.e("shreddit-comment-action-row")],c),{get ShredditCommentActionRow(){return c}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./D-ibjVaztZ.js",import.meta.url,"D-ibjVaztZ");SML.di("./YAFaZPh0hw.js",import.meta.url,"YAFaZPh0hw");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./KHcvarc_gp.js",import.meta.url,"KHcvarc_gp");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("C2HHHowe8h",["Dw4vb8Yfbm","D-ibjVaztZ","YAFaZPh0hw","xrDbp1ee_h","KHcvarc_gp","5r73EsgItq"],(async(t,e,i,o,a,s)=>{const n=t.W(s.s);let l=class extends n{constructor(){super(...arguments),this.score=0,this.id="",this.permalink="",this.postTitle="",this.postThumbnail="",this.pubsub=new t.u(this),this._getPostScoreDelta=t=>a.g(this.voteState,t),this._onUpdatePostVoteType=async()=>await a.o(this.id,"post",this.voteState),this.renderVoteButtons=()=>{const e={voteType:this.voteState||null,size:t.q.Small,appearance:"secondary"},o=i.u({...e,voteCount:this.score,screenReaderContent:"Upvote",onClick:this.handleUpvote}),a=i.d({...e,screenReaderContent:"Downvote",onClick:this.handleDownvote});return i.v({...e,voteType:this.voteState,voteCount:this.score,size:e.size,upvoteButton:o,downvoteButton:a,attributes:{slot:"vote-button",className:"flex flex-row justify-center items-center h-xl font-semibold relative"}})}}connectedCallback(){super.connectedCallback()}async handleUpvote(){const t=this.voteState===a.V.Upvote;this.handleClick(t?o.o(this):o.u(this)),await this.handleUpdatePostVote(a.V.Upvote)}async handleDownvote(){this.handleClick(this.voteState===a.V.Downvote?o.o(this):o.q(this)),await this.handleUpdatePostVote(a.V.Downvote)}handleClick(e,i){e&&t.i(this,e),i&&this.dispatchEvent(i)}async handleUpdatePostVote(e){const i=this.score,o=this.voteState;if(void 0!==this.score){const t=this._getPostScoreDelta(e);this.score=this.score+t}this.voteState=e===this.voteState?void 0:e;try{await this._onUpdatePostVoteType(),this.voteState&&this.pubsub.publish(this.voteState===a.V.Upvote?t.T.PostUpvoted:t.T.PostDownvoted,{postId:this.id})}catch(a){this.score=i,this.voteState=o,this.dispatchEvent(t.c("faceplate-alert",{level:t.a5.warning,message:a,sourceElement:e,cause:`failed-${e}`}))}}render(){const t=this.renderVoteButtons();return s.x` <div class="flex flex-col w-100 gap-xs mb-[16px]"> <slot></slot> <div class="flex w-100 justify-between"> <div class="flex flex-col gap-xs"> <div class="flex text-16 font-semibold">${this.postTitle}</div> <div class="flex text-16 font-semibold"> ${e.a({attributes:{href:this.permalink,className:"text-inherit visited:text-inherit !p-0 !m-0"},children:s.x`<span class="text-primary font-semibold">${"See full post"}</span>`})} </div> <span class="relative leading-[0]"> ${t} </span> </div> ${this.postThumbnail?s.x` <div class="min-w-[80px] ms-[4px]"> <img src="${this.postThumbnail}" data-testid="thumbnail" alt="${"Thumbnail image relating to text"}" class="w-[80px] h-[60px] mb-0 rounded-[8px] object-cover"> </div>`:s.A} </div> </div> `;}};l.styles=[t.t],t._([t.n({type:Number,attribute:"score"})],l.prototype,"score",void 0),t._([t.n({type:String,attribute:"id"})],l.prototype,"id",void 0),t._([t.n({type:String,attribute:"vote-state"})],l.prototype,"voteState",void 0),t._([t.n({type:String,attribute:"permalink"})],l.prototype,"permalink",void 0),t._([t.n({type:String,attribute:"post-title"})],l.prototype,"postTitle",void 0),t._([t.n({type:String,attribute:"post-thumbnail"})],l.prototype,"postThumbnail",void 0),l=t._([t.e("aggregated-notifications-header")],l)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("C2l05LS-ga",["Dw4vb8Yfbm"],(async a=>{const{svg:c}=a.a();return{a:a.m(c`<path d="M18.332 11.042l-4.05-7.056A4.875 4.875 0 009.92 1.5a4.898 4.898 0 00-4.198 2.485l-4.05 7.056a4.938 4.938 0 00.042 5.044 4.894 4.894 0 004.238 2.414h8.099c1.82 0 3.437-.957 4.32-2.559a4.956 4.956 0 00-.04-4.9v.002zM9.948 3.306a3.107 3.107 0 012.78 1.583l1.325 2.308c.5.871.697 1.203 1.002 1.559l-.066.093c-.455-.184-1.201-.212-1.885-.082-.757.144-1.38.48-1.48.538a3.229 3.229 0 01-3.241.005A3.272 3.272 0 016.93 7.536c-.428-1.218.012-2.562.96-3.417a3.107 3.107 0 012.058-.813h-.001zM3.253 15.158a3.142 3.142 0 01-.027-3.213L4.55 9.637c.499-.872.687-1.209.84-1.653l.114.011c.069.488.418 1.153.872 1.684a5.283 5.283 0 001.203 1.02 3.27 3.27 0 01.824 4.973c-.834.981-2.212 1.27-3.421.872a3.126 3.126 0 01-1.73-1.386zm13.55-.094a3.105 3.105 0 01-2.751 1.63h-2.65c-1 0-1.383.006-1.842.093l-.047-.104c.386-.305.783-.94 1.013-1.601a5.342 5.342 0 00.277-1.558 3.27 3.27 0 011.616-2.826 3.235 3.235 0 012.253-.378c1.262.236 2.2 1.292 2.46 2.545.16.737.05 1.513-.328 2.199z"></path>`,"0 0 20 20","answers")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BDidT9_yHr.js",import.meta.url,"BDidT9_yHr");
SML.dm("C4w49Ew8DF",["Dw4vb8Yfbm","5r73EsgItq","BDidT9_yHr"],(async(e,t,l)=>{let o=class extends e.R{constructor(){super(...arguments),this.forceTouchOnly=!1,this.handleClick=e=>{e.stopPropagation()}}render(){return l.I.isTouchOnly||this.forceTouchOnly?t.x`<slot></slot>`:t.A}connectedCallback(){super.connectedCallback(),this.addEventListener("click",this.handleClick)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("click",this.handleClick)}};e._([e.n({type:Boolean,attribute:"force-touch-only"})],o.prototype,"forceTouchOnly",void 0),o=e._([e.e("rpl-inbox-row-touch-only")],o)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./D-ibjVaztZ.js",import.meta.url,"D-ibjVaztZ");SML.di("./BIvvQbZj9p.js",import.meta.url,"BIvvQbZj9p");SML.di("./Bb_6_71M-3.js",import.meta.url,"Bb_6_71M-3");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./Z0tk4vmzIQ.js",import.meta.url,"Z0tk4vmzIQ");SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");SML.di("./Cl1pMDH2OX.js",import.meta.url,"Cl1pMDH2OX");SML.di("./CEs3hLX56z.js",import.meta.url,"CEs3hLX56z");SML.di("./B6Ai7g9fbR.js",import.meta.url,"B6Ai7g9fbR");SML.di("./pA9dwrnd0r.js",import.meta.url,"pA9dwrnd0r");SML.di("./BXUgRcxEAi.js",import.meta.url,"BXUgRcxEAi");SML.di("./w2XkRJ2mzc.js",import.meta.url,"w2XkRJ2mzc");SML.di("./h4Pa0OJr_5.js",import.meta.url,"h4Pa0OJr_5");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./DFh5Z0Dv0L.js",import.meta.url,"DFh5Z0Dv0L");
SML.dm("C66PDg3zDE",["Dw4vb8Yfbm","5r73EsgItq","D-ibjVaztZ","Bb_6_71M-3","B-zFJtiar6","BIvvQbZj9p","Z0tk4vmzIQ","C8QDHFSIkY","Cl1pMDH2OX","CEs3hLX56z","B6Ai7g9fbR","pA9dwrnd0r","BXUgRcxEAi","w2XkRJ2mzc","h4Pa0OJr_5","BIzQFHISzm","DFh5Z0Dv0L"],(async(t,e,i,s,r)=>{const n=s.W(e.s);let a=class extends n{constructor(){super(...arguments),this.impressionId="0",this.isBTFPlacement=!1,this.isBlank=!1,this.url="",this.randomHouseAdIndex=0,this.adEvents=[],this.outboundLinkUrl="",this.placement=t.aj.SIDEBARS,this.isLargeBanner=!1,this.hasBrandUnsafeContent=!1,this.showBrandSafeContent=!1,this.visible=!0,this.serverSideRendered=!1,this.adType=t.f9.DISPLAY,this._brandUnsafePostIds=new Set,this.handleVideoMediaClick=()=>{r.ai({impressionId:this.impressionId,adEvents:this.adEvents,clickRedirectUrl:this.outboundLinkUrl})},this.checkNeighboringSidebarAd=()=>{if(this.isBTFPlacement){const t=this.previousElementSibling;"DSA-TRANSPARENCY-MODAL-PROVIDER"===t?.tagName&&this.hideBTFSidebarAd()}},this.hideBTFSidebarAd=()=>{!this.isBlank&&this.isBTFPlacement&&(this.style.display="none")},this.showBTFSidebarAd=()=>{!this.isBlank&&this.isBTFPlacement&&(this.style.display="block")},this.setBrandUnsafeView=t=>{if(this.hasBrandUnsafeContent&&this.isLargeBanner)return;const{postId:e,isInView:i}=t.detail;i?this._brandUnsafePostIds.add(e):this._brandUnsafePostIds.has(e)&&!i&&this._brandUnsafePostIds.delete(e),this.hasBrandUnsafeContent=this._brandUnsafePostIds.size>0}}static get styles(){return[t.t]}connectedCallback(){super.connectedCallback(),this.enableAdObserver({postElement:this,events:s.e(this.adEvents),postId:this.postId,impressionId:this.impressionId,adType:this.adType}),window.addEventListener(t.fF,this.setBrandUnsafeView),window.addEventListener(t.fG,this.hideBTFSidebarAd),window.addEventListener(t.U,this.showBTFSidebarAd),this.checkInitialLoadForBrandSafety(),this.checkNeighboringSidebarAd(),this.videoMediaClickTracker?.addEventListener("click",this.handleVideoMediaClick)}disconnectedCallback(){this.videoMediaClickTracker?.removeEventListener("click",this.handleVideoMediaClick),window.removeEventListener(t.fF,this.setBrandUnsafeView),window.removeEventListener(t.fG,this.hideBTFSidebarAd),window.removeEventListener(t.U,this.showBTFSidebarAd),super.disconnectedCallback()}updated(t){t.has("hasBrandUnsafeContent")&&(this.visible=!1,setTimeout((()=>{this.showBrandSafeContent=this.hasBrandUnsafeContent,this.visible=!0}),250))}get videoMediaClickTracker(){return this.serverSideRendered&&this.adType===t.f9.VIDEO?this.querySelector(`click-location-tracker[click-location="${t.D.MEDIA}"]`):null}checkInitialLoadForBrandSafety(){const e=document.querySelectorAll("shreddit-post[is-not-brand-safe]");for(let i=0;i<e.length;i++){const s=e[i];if(!s.isPostInViewport)break;this.setBrandUnsafeView(t.c(t.fF,{postId:s.id,isInView:!0}))}}trackAdClick(){this.outboundClickHandler()}outboundClickHandler(){t.a8.isAvailable()&&(t.a8.setItem(t.a9.LastClickedAdId,this.postId),t.a8.setItem(t.a9.ImpressionId,this.impressionId),t.a8.setItem(t.a9.AdPlacement,this.placement))}get contentExists(){return!!(this.serverSideRendered?this.shadowRoot?.hasChildNodes:this.querySelector('[slot="sidebar-content"]'))}renderAdSidebarContent(){return e.x` <article class="transition-opacity ease-in-out duration-250 m-0 ${this.visible?"opacity-100":"opacity-0"}"> <slot name="promoted-label"></slot> <shreddit-dynamic-ad-link outbound-link-override="${t.ad(this.outboundLinkUrl?void 0:this.url)}" target="_blank" @click="${this.trackAdClick}" post-id="${this.postId}" click-location="${t.D.MEDIA}" impression-id="${this.impressionId}" encrypted-tracking-payload="${t.ad(this.encryptedTrackingPayload)}"> <div class="flex justify-center"> <slot name="sidebar-content"></slot> </div> </shreddit-dynamic-ad-link> </article> `}renderHouseSidebarContent(){const t="m-0 border-none border-0 p-0 transition-opacity ease-in-out duration-250 "+(this.visible?"opacity-100":"opacity-0");return e.x` ${i.a({attributes:{href:this.houseAdHref,target:"_blank",className:t},suppressVisitedStyle:!0,underline:"none",children:e.x` <article> <div class="h-[32px]"></div> <div class="flex justify-center"> <img alt="brand safe sidebar ad" class="w-[300px] flex rounded-2" slot="sidebar-content" src="${this.houseAdImage}"> </div> </article>`})}`}renderContent(){return this.showBrandSafeContent?this.renderHouseSidebarContent():this.serverSideRendered?e.x`<div class="transition-opacity ease-in-out duration-250 ${this.visible?"opacity-100":"opacity-0"}"> <slot></slot> </div>`:this.renderAdSidebarContent()}render(){return e.x`${!this.isBlank&&this.contentExists?this.renderContent():null}`}};t._([t.n({type:String})],a.prototype,"id",void 0),t._([t.n({type:String,attribute:"post-id"})],a.prototype,"postId",void 0),t._([t.n({type:String,attribute:"house-ad-image"})],a.prototype,"houseAdImage",void 0),t._([t.n({type:String,attribute:"house-ad-href"})],a.prototype,"houseAdHref",void 0),t._([t.n({type:String,attribute:"impression-id"})],a.prototype,"impressionId",void 0),t._([t.n({type:Boolean,attribute:"is-btf-placement"})],a.prototype,"isBTFPlacement",void 0),t._([t.n({type:Boolean,attribute:"is-blank"})],a.prototype,"isBlank",void 0),t._([t.n({type:Boolean,attribute:"is-media-only",reflect:!0})],a.prototype,"isMediaOnly",void 0),t._([t.n({type:String})],a.prototype,"url",void 0),t._([t.n({type:Number})],a.prototype,"randomHouseAdIndex",void 0),t._([t.n({type:Array,attribute:"ad-events",reflect:!0})],a.prototype,"adEvents",void 0),t._([t.n({type:String,attribute:"outbound-link-url",reflect:!0})],a.prototype,"outboundLinkUrl",void 0),t._([t.n({type:String,attribute:"author-id"})],a.prototype,"authorId",void 0),t._([t.n({type:String,attribute:"placement"})],a.prototype,"placement",void 0),t._([t.n({type:String,attribute:"subreddit-id"})],a.prototype,"subredditId",void 0),t._([t.n({type:Boolean,attribute:"is-large-banner"})],a.prototype,"isLargeBanner",void 0),t._([t.n({type:Boolean})],a.prototype,"hasBrandUnsafeContent",void 0),t._([t.n({type:Boolean})],a.prototype,"showBrandSafeContent",void 0),t._([t.n({type:Boolean})],a.prototype,"visible",void 0),t._([t.n({type:String,attribute:"encrypted-tracking-payload"})],a.prototype,"encryptedTrackingPayload",void 0),t._([t.n({type:Boolean,attribute:"server-side-rendered"})],a.prototype,"serverSideRendered",void 0),t._([t.n({type:String,attribute:"ad-type"})],a.prototype,"adType",void 0),t._([t.n({type:String,attribute:"ads-correlation-id"})],a.prototype,"adsCorrelationId",void 0),a=t._([t.e("shreddit-sidebar-ad")],a);var o=Object.freeze({__proto__:null,get ShredditSidebarAd(){return a}});return{get s(){return o}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("C6UOB_RPC4",["Dw4vb8Yfbm"],(async a=>{const{svg:l}=a.a();return{p:a.m(l`<path d="M18.163 6.191a4.194 4.194 0 00-1.237-2.986l-.167-.167a4.197 4.197 0 00-2.986-1.236 4.194 4.194 0 00-2.986 1.237L8.835 4.99a6.267 6.267 0 00-2.708.116 6.276 6.276 0 00-2.798 1.611.902.902 0 00-.001 1.274l3.724 3.723-4.955 4.955a.898.898 0 00.636 1.536c.23 0 .46-.088.636-.264l4.955-4.955 3.644 3.644a.897.897 0 001.273-.001 6.25 6.25 0 001.727-5.499l1.958-1.953a4.197 4.197 0 001.236-2.986h.001z"></path>`,"0 0 20 20","pin-fill")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("C8QDHFSIkY",["Dw4vb8Yfbm"],(async e=>{var o,t,r;!function(e){e.AddRemovalReason="mod-add-removal-reason",e.IgnoreReports="mod-ignore-reports",e.UnignoreReports="mod-unignore-reports",e.Distinguish="mod-distinguish",e.Undistinguish="mod-undistinguish",e.Sticky="mod-sticky",e.Unsticky="mod-unsticky",e.Lock="mod-lock",e.Unlock="mod-unlock",e.ApproveContent="mod-approve-content",e.RemoveContent="mod-remove-content",e.RemoveContentAsSpam="mod-remove-spam-content",e.ConfirmRemoval="mod-confirm-removal",e.RemoveContentMenu="mod-remove-content-menu",e.MarkNsfw="mod-mark-nsfw",e.UnmarkNsfw="mod-unmark-nsfw",e.MarkSpoiler="mod-mark-spoiler",e.UnmarkSpoiler="mod-unmark-spoiler",e.AdjustCrowdControl="mod-adjust-crowd-control",e.OpenEditPostFlairModal="mod-open-edit-post-flair-modal",e.SnoozeReporter="mod-snooze-reporter",e.UnsnoozeReporter="mod-unsnooze-reporter",e.UpdateHighlightedPost="mod-update-highlighted-post",e.RemoveHighlightedPost="mod-remove-highlighted-post",e.ApproveContentOptimistic="mod-approve-content-optimistic",e.RemoveContentOptimistic="mod-remove-content-optimistic",e.ConfirmRemovalOptimistic="mod-confirm-removal-optimistic",e.RemoveContentAsSpamOptimistic="mod-remove-spam-optimistic",e.ShareToModChat="mod-share-to-mod-chat",e.ViewChatThread="view-chat-thread"}(o||(o={})),function(e){e.Distinguish="admin-distinguish",e.Undistinguish="admin-undistinguish"}(t||(t={})),function(e){e.Dismissed="Dismissed",e.Ignored="Ignored",e.Reported="Reported"}(r||(r={}));return {get A(){return t},get M(){return o},get R(){return r},a:()=>"MOD",b:()=>"CO-HOST",c:()=>"OP",d:t=>{switch(t){case e.gc.ApproveComment:case e.gc.ApproveLink:return o.ApproveContent;case e.gc.RemoveComment:case e.gc.RemoveLink:return o.RemoveContent;case e.gc.SpamComment:case e.gc.SpamLink:return o.RemoveContentAsSpam;case e.gc.AddRemovalReason:return o.AddRemovalReason;default:return o.ApproveContent}},g:()=>"ADMIN"};}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("CBbxnHsw2W",["Dw4vb8Yfbm","5r73EsgItq"],(async(t,e)=>{var r;!function(t){t.Error="error",t.Success="success",t.Incomplete="incomplete"}(r||(r={}));const s=a(16);function o(t,e){return t-e/100*t}function a(t){return 2*Math.PI*t}let c=class extends e.s{constructor(){super(...arguments),this.value=0,this.status=r.Incomplete}static get styles(){return e.a`:host{--loader-size-base:var(--rem40);display:inline-block;position:relative}:host([status=incomplete]){color:var(--color-neutral-content,var(--color-tone-1))}:host([status=success]){color:var(--color-success-content,var(--color-alert-positive))}:host([status=error]){color:var(--color-danger-content,var(--color-alert-negative))}svg{height:var(--loader-size,var(--loader-size-base));width:var(--loader-size,var(--loader-size-base));fill:none;stroke-width:8;display:block}.bg{stroke:var(--color-neutral-content-disabled,var(--color-tone-3))}.track{stroke:currentColor;transition:.35s stroke-dashoffset;transform:rotate(-90deg);transform-origin:50% 50%}.icon{position:absolute;inset-inline-start:50%;top:50%;transform:translate(-50%,-50%)}::slotted([slot=error]),::slotted([slot=success]){display:flex}`}render(){const t=this.status===r.Success;return e.x` <svg viewBox="0 0 40 40" class="loader" xmlns="http://www.w3.org/2000/svg"> <circle class="bg" cx="20" cy="20" r="${16}"></circle> <circle class="track ${this.status}" cx="20" cy="20" r="${16}" stroke-dasharray="${s} ${s}" stroke-dashoffset="${o(s,t?100:this.value)}"></circle> </svg> <div class="icon"> <slot name="${this.status}"></slot> </div> `}};t._([t.n({type:Number})],c.prototype,"value",void 0),t._([t.n({type:String,reflect:!0})],c.prototype,"status",void 0),c=t._([t.e("faceplate-progress")],c);var l=Object.freeze({__proto__:null,get FaceplateProgress(){return c},get ProgressState(){return r},calcCircumference:a,calcStokeDashOffset:o});return{get f(){return l}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("CCBTR4TAfR",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,s)=>{var r;!function(e){e.Search="search",e.PostDetail="post_detail"}(r||(r={}));class t{constructor(s,t,i=r.Search){this.checkAndSendImpressionEvent=s=>{if(!s.search?.impression_id)return;const{search:r,action_info:t}=s,i=JSON.parse(sessionStorage.getItem("search_impression_cache")||"[]"),o=new Set([...i]);if(o.has(r.impression_id)||!this.searchTelemetrySource)return;o.add(r.impression_id),sessionStorage.setItem("search_impression_cache",JSON.stringify([...o]));const c=e.b({source:this.source,action:"create",noun:"impression_id"},{...s,search:{...r,impression_id:r.impression_id},action_info:{...t,type:this.searchTelemetrySource}});e.i(this.host,c)},(this.host=s).addController(this),this._v2Events=new e.he(this.host,(e=>{this.checkAndSendImpressionEvent(e)})),this.source=i,this.searchTelemetrySource=t}hostConnected(){}}let i=class extends s.s{constructor(){super(...arguments),this.isPdpSeekerM2=!1,this._searchDynamicIdCacheController=new t(this,this.searchTelemetrySource,this.source)}get source(){return this.isPdpSeekerM2?r.PostDetail:r.Search}willUpdate(e){e.has("searchTelemetrySource")&&(this._searchDynamicIdCacheController.searchTelemetrySource=this.searchTelemetrySource),e.has("isPdpSeekerM2")&&(this._searchDynamicIdCacheController.source=this.source)}createRenderRoot(){return this}};return e._([e.n({attribute:"search-telemetry-source",type:String})],i.prototype,"searchTelemetrySource",void 0),e._([e.n({attribute:"is-pdp-seeker-m2",type:Boolean})],i.prototype,"isPdpSeekerM2",void 0),i=e._([e.e("search-dynamic-id-cache-controller")],i),{S:t}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("CDKdqRuwld",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,a)=>{let t=e.Y,i=e.r,n=class extends a.s{constructor(){super(...arguments),this.registry=e.fO,this.pubsub=new e.u(this),this.compareModifiers=(e,a)=>!!e==!!a,this.hasMatchingModifiers=(e,a)=>{if(!a)return!1;const{metaKey:t,altKey:i,shiftKey:n,ctrlKey:s}=e,{meta:o,alt:r,ctrl:l,shift:d}=a,m=!(navigator.userAgent.includes("Mac")||!o||l||!s);return(this.compareModifiers(t,o)||m)&&(this.compareModifiers(s,l)||m)&&this.compareModifiers(n,d)&&this.compareModifiers(i,r)},this.getContextualSubscriber=(a,t,i)=>{const n=a.composedPath();return Array.from(i).find((i=>this.hasMatchingModifiers(a,e.fP.keys[t]?.[i])&&void 0===e.fQ[i]&&n?.find((a=>e.fR.has(a)))))},this.getGlobalSubscriber=(a,t,i)=>Array.from(i).find((i=>this.hasMatchingModifiers(a,e.fP.keys[t]?.[i]))),this.publishHotkeyEvent=async a=>{const t=a.key.toLowerCase(),n=e.fP.keys[t],s=this.getContextualSubscriber(a,t,e.fS),o=this.getGlobalSubscriber(a,t,e.fT),r=s??o;if(n&&(this.enabled||"?"===t)&&(r&&n[r].allowFromInput||!a.composedPath().find((e=>e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement||e instanceof HTMLElement&&e.hasAttribute("contenteditable"))))){if(n[e.cy.SHOW_SHORTCUTS]&&(await i({name:e.fU,bodyParams:{enabled:encodeURIComponent(!!this.enabled),open:"true"}})),s)return this.pubsub.publish(e.T.Hotkeys,{id:s}),void this.cancelEvent(a);o&&(this.pubsub.publish(e.T.Hotkeys,{id:o}),this.cancelEvent(a))}},this.cancelEvent=e=>{e.preventDefault(),e.stopImmediatePropagation()},this.onHotkeysToggle=async a=>{const{detail:{checked:i,target:n}}=a;try{const a=await t({operation:e.O.UpdateAccountPreferences,variables:{input:{isHotkeysEnabled:i}}});if(this.enabled=i,a.errors.length>0)throw new Error("Could not save setting")}catch{n.checked=!i;const a=e.c("faceplate-alert",{level:e.a5.error,cause:"uncategorized",message:"We had some issues saving your changes. Please try again."});this.dispatchEvent(a)}}}connectedCallback(){super.connectedCallback(),document.addEventListener("keydown",this.publishHotkeyEvent),document.addEventListener(e.fV,this.onHotkeysToggle)}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("keydown",this.publishHotkeyEvent),document.removeEventListener(e.fV,this.onHotkeysToggle)}willUpdate(a){a.has("enabled")&&this.enabled&&!Object.keys(e.fP.keys).length?e.fW(this.registry):a.has("registry")&&(e.fX(),e.fW(this.registry))}};e._([e.n({type:Object})],n.prototype,"registry",void 0),e._([e.n({type:Boolean})],n.prototype,"enabled",void 0),n=e._([e.e("shreddit-hotkeys-controller")],n)}));
SML.di("./JaGlTj3I-9.js",import.meta.url,"JaGlTj3I-9");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./CRzmHkIoo0.js",import.meta.url,"CRzmHkIoo0");
SML.dm("CE5TLxi7Z3",["JaGlTj3I-9","5r73EsgItq","Dw4vb8Yfbm","CRzmHkIoo0"],(async(t,e,r)=>{function a(t){let e=0,r=0;const a=[];for(const s of t)a[e]=r,e++,r+=s.length;return a[e]=r,a}const s={[t.F.bold]:t=>e.x`<strong>${t}</strong>`,[t.F.italic]:t=>e.x`<em>${t}</em>`,[t.F.underline]:t=>e.x`<u>${t}</u>`,[t.F.strikethrough]:t=>e.x`<s>${t}</s>`,[t.F.subscript]:t=>e.x`<sub>${t}</sub>`,[t.F.superscript]:t=>e.x`<sup>${t}</sup>`,[t.F.monospace]:t=>e.x`<code>${t}</code>`},n=(t,e)=>{try{if(e)return new URL(t,e).toString()}catch{}return t},l=e=>{const r=[];for(const a in t.F){if(isNaN(Number(a)))continue;Number(a)&e&&r.push(a)}return r},c=(t,e)=>{let r=t;for(const t of e){const e=s[t];e&&(r=e(r))}return r},o=t=>{const r=function(t,e=[]){const r=a(t),s=[];let n=0;for(const[a,l,c]of e){const e=l+c,o=r[l]??l,i=r[e]??e;n<o&&s.push({text:t.substring(n,o),isFormatted:!1}),s.push({text:t.substring(o,i),isFormatted:!0,bitfield:a}),n=i}return n<t.length&&s.push({text:t.slice(n),isFormatted:!1}),s}(t.t,t.f),s=[];for(const t of r)if(t.isFormatted&&void 0!==t.bitfield){const e=l(t.bitfield),r=c(t.text,e);s.push(r)}else s.push(t.text);return e.x`${s.map((t=>e.x`${t}`))}`},i=t=>"R "===t?"align-right":"C"===t?"align-center":"align-left",u=(a,s)=>{switch(a.e){case t.j:return(t=>o(t))(a);case t.R:return(t=>e.x`${t.t}`)(a);case t.i:return((t,r)=>{const a=r.targetBlankLinks?"_blank":"_self",s=t.u.startsWith("/")?n(t.u,r.baseUrlForRelativeLinks):t.u;return e.x`<a href="${s}" rel="noopener nofollow ugc" target="${a}">${t.t}</a>`})(a,s);case t.h:return((t,r)=>{const a=r.targetBlankSubredditAndUserLinks?"_blank":"_self",s=n(`/${t.e}${t.t}/`,r.baseUrlForRelativeLinks);return e.x`<a href="${s}" target="${a}">r/${t.t}</a>`})(a,s);case t.g:return((t,r)=>{const a=r.targetBlankSubredditAndUserLinks?"_blank":"_self",s=n(`/user/${t.t}/`,r.baseUrlForRelativeLinks);return e.x`<a href="${s}" target="${a}">u/${t.t}</a>`})(a,s);case t.P:return((t,r)=>e.x`<p> ${t.c.map((t=>u(t,r)))} </p>`)(a,s);case t.f:return((t,r)=>{const a=t.c.map((t=>u(t,r)));return t.o?e.x`<ol> ${a} </ol>`:e.x`<ul> ${a} </ul>`})(a,s);case t.e:return((t,r)=>e.x`<li> ${t.c?.map((t=>u(t,r)))??""} </li>`)(a,s);case t.d:return((t,r)=>{const a=t.c?.map((t=>u(t,r)))??"";switch(t.l){case 1:return e.x`<h1 class="text-24-scalable xs:text-20-scalable">${a}</h1>`;case 2:return e.x`<h2 class="text-18-scalable xs:text-20-scalable">${a}</h2>`;case 3:return e.x`<h3 class="text-16-scalable xs:text-18-scalable">${a}</h3>`;case 4:return e.x`<h4 class="font-semibold text-14-scalable xs:text-16-scalable">${a}</h4>`;case 5:return e.x`<h5 class="font-semibold text-14-scalable xs:text-16-scalable">${a}</h5>`;case 6:return e.x`<h6 class="text-14-scalable xs:text-14-scalable">${a}</h6>`}})(a,s);case t.B:return((t,r)=>e.x`<blockquote> ${t.c.map((t=>u(t,r)))} </blockquote>`)(a,s);case t.S:return((t,r)=>e.x`<shreddit-spoiler>${t.c.map((t=>u(t,r)))} </shreddit-spoiler>`)(a,s);case t.c:return(t=>{const a=t.c.map((t=>t.t)).join("\n");return e.x`<pre language="${r.ad(t.l)}">${a}</pre>`})(a);case t.b:return(t=>e.x` <faceplate-img class="flair-image" loading="lazy" width="14" height="14" src="${t.u}" alt="emoji${t.a}"></faceplate-img> `)(a);case t.H:return e.x`<hr>`;case t.L:return e.x`<br>`;case t.I:case t.A:case t.V:return e.x`${a.c}`;case t.C:case t.a:case t.U:return e.x`${a.e}${a.t}`;case t.E:return e.x`${a.c}`;case t.T:return((t,a)=>{const s=t.h;return e.x`<table class="overflow-x-auto"> <thead> <tr> ${t.h.map((t=>e.x`<th class="${r.ad(t.a?i(t.a):void 0)}"> ${t.c?.map((t=>u(t,a)))??""} </th>`))} </tr> <tr></tr> </thead> <tbody> ${t.c.map((t=>e.x`<tr> ${t.map(((t,r)=>e.x`<td class="${i(s[r].a)}"> ${t.c?.map((t=>u(t,a)))??""} </td>`))} </tr>`))} </tbody> </table>`})(a,s);default:return e.x``}},x=({richtext:t,wrapperClassName:a="",targetBlankLinks:s=!1,targetBlankSubredditAndUserLinks:n=!1,baseUrlForRelativeLinks:l=""})=>null===t?e.x``:"string"==typeof t?e.x`<div class="rendererd-rtjson ${a}"><p>${t}</p></div>`:e.x`<div class="rendererd-rtjson ${a}"> ${r.c2(t.document,(t=>u(t,{targetBlankLinks:s,targetBlankSubredditAndUserLinks:n,baseUrlForRelativeLinks:l})))} </div>`,d=/:(.*?):/g;const b=(t,r)=>e.x`<div class="flair-content [&_.flair-image]:align-bottom max-w-full overflow-hidden whitespace-nowrap text-ellipsis"> ${t?.match(d)&&r?x({richtext:{document:JSON.parse(r)},wrapperClassName:"max-w-full overflow-hidden whitespace-nowrap text-ellipsis"}):t} </div>`;return{_:u,a:({color:t,backgroundColor:r,text:a="",richText:s,className:n,flairContentRenderer:l=b})=>{if(!a)return"";const c=function(t,e){return!t||!e||"transparent"===e}(t??"",r??"");return e.x` <span class="bg-tone-4 inline-block truncate max-w-full text-12 font-normal align-text-bottom box-border px-[6px] rounded-5 leading-4 ${c?"text-secondary":"DARK"===t?"text-global-black":"text-global-white"} ${"transparent"===r?"border-solid border border-neutral-border-weak":""} ${n??""}" style="${r?`background-color: ${r};`:""}"> ${l(a,s)} </span> `},b:function(t){let e=0,r=0;const a=[];for(const s of t){for(let t=0;t<s.length;t++)a[r]=e,r++;e++}return a[r]=e,a},c:x,d:a}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("CEs3hLX56z",["Dw4vb8Yfbm","B-zFJtiar6"],(async(e,a)=>{var t,n,o,r,i,c,d,s,u,l,p,f,m,_,y,w;function h(e){window.Sentry?.captureMessage?.(e)}function g(e){return e?.[0]?.message??a.cj.genericErrorMessage()}async function v(t,n){const o=a.R.get(t);if(!o)throw new Error(a.cj.unsupportedMimetype(t));const r={mimetype:o},i=n?await async function(a,t){try{const n=await fetch("https://gql-fed.reddit.com",{method:"POST",headers:{Accept:"application/json",Authorization:`bearer ${t}`,"Content-Type":"application/json","X-Reddit-Loid":e.K.get("loid")??""},body:JSON.stringify({extensions:{persistedQuery:{version:1,sha256Hash:"cd9afac180f0cc91f6b6a4be46385de14fc328090a59b2cdc5e9666cb18779f1"}},operationName:e.O.CreateMediaUploadLease,variables:{input:a}})});if(n.ok)return n.json();const o=await n.text();throw h(`Media upload lease request to gql-fed.reddit.com failed with status ${n.status}: ${o}`),new Error(o)}catch(e){throw h(`Unable to complete the media upload lease grant: ${e}`),e}}(r,n):await e.Y({operation:e.O.CreateMediaUploadLease,variables:{input:r}});if(i.errors?.length)throw new Error(g(i.errors));const c=i.data.createMediaUploadLease;if(c?.ok)return{mediaId:c.mediaId,uploadLeaseUrl:c.uploadLease.uploadLeaseUrl,uploadLeaseHeaders:c.uploadLease.uploadLeaseHeaders};throw new Error(g(c?.errors))}!function(e){e.Unknown="unknown",e.VOD="vod",e.Gif="gif",e.LiveVideo="live-video",e.Image="image",e.Video="video"}(t||(t={})),function(e){e.Landscape="landscape",e.Portrait="portrait"}(n||(n={})),function(e){e.DirectUpload="direct_upload",e.ScrapedLink="scraped_link",e.ImageOptimizer="image_optimizer"}(o||(o={})),function(e){e.Hls="hls",e.SingleFile="single_file"}(r||(r={})),function(e){e.Hls="hls",e.Mp4="mp4"}(i||(i={})),function(e){e.Autoplay="autoplay",e.Click="click"}(c||(c={})),function(e){e.Buffering="buffering",e.Paused="paused",e.Playing="playing"}(d||(d={})),function(e){e.CommentPlayer="comment_player",e.InFeedPlayer="in_feed_player",e.PostDetailScreen="post_detail_screen",e.GalleryMode="gallery_mode",e.VideoFeedV1="video_feed_v1",e.LiveFeedV1="live_feed_v1",e.TheaterMode="theater_mode",e.DiscoveryUnit="discovery_unit",e.RedditAnswers="reddit_answers"}(s||(s={})),function(e){e.Videoplayer="videoplayer"}(u||(u={})),function(e){e.Auto="auto",e.Background="background",e.Click="click",e.End="end",e.Error="error",e.Scroll="scroll",e.Served="served",e.Start="start",e.Switch="switch",e.Trace="trace",e.View="view"}(l||(l={})),function(e){e.Autoplay="autoplay",e.Bitrate="bitrate",e.CaptionsDisabled="overflow_captions_disabled",e.CaptionsEnabled="overflow_captions_enabled",e.Download="download",e.Pause="pause",e.Performance="performance",e.Play="play",e.Rebuffer="rebuffer",e.RecommendationOverlay="recommendation_overlay",e.Replay="replay",e.Video="video"}(p||(p={})),function(e){e.Videoplayer="videoplayer"}(f||(f={})),function(e){e.Click="click",e.Continue="continue",e.IsFullyViewable="is_fully_viewable",e.IsViewable="is_viewable",e.Pause="pause",e.PlayExpanded="play_expanded",e.PlayWithSound="play_with_sound",e.Start="start",e.Watch="watch",e.WatchPercent25="watch_25_percent",e.WatchPercent50="watch_50_percent",e.WatchPercent75="watch_75_percent",e.WatchPercent95="watch_95_percent",e.WatchPercent100="watch_100_percent",e.WatchSeconds2="watch_2_seconds",e.WatchSeconds3="watch_3_seconds",e.WatchSeconds5="watch_5_seconds",e.WatchSeconds10="watch_10_seconds"}(m||(m={})),function(e){e.Pause="pause",e.Play="play",e.Seek="seek",e.Mute="mute",e.Unmute="unmute",e.Replay="replay",e.Video="video"}(_||(_={})),function(e){e.Autoplay="autoplay",e.Manual="manual"}(y||(y={})),function(e){e.Auto="auto",e.Buffer="buffer",e.Manual="manual"}(w||(w={}));const b=e=>({error:e||a.cj.uploadErrorMessage()});return{get A(){return c},get F(){return i},get M(){return t},get P(){return r},get Q(){return u},get T(){return m},get a(){return n},get b(){return l},get c(){return p},get d(){return d},get e(){return _},u:async function(n,o={}){const{bearerToken:r,trackEvent:i,eventSource:c}=o,d=!!i&&!!c;let s,u;try{try{s=await v(n.type,r),u=n.type.includes("video")?t.Video:t.Image,d&&i(e.b({source:c,action:"get",noun:"media_lease"},{media:{id:s.mediaId,type:u},action_info:{success:!!s.mediaId}}))}catch(a){throw d&&i(e.b({source:c,action:"get",noun:"media_lease"},{action_info:{success:!1,reason:a?.message}})),new Error(a)}const o=n.size,l=n.type.split("/")[1];d&&i(e.b({source:c,action:"upload_start",noun:u},{media:{id:s.mediaId,type:u,size:o,format:l}}));const p=await a.T(n,s);return p?(d&&i(e.b({source:c,action:"upload",noun:u},{media:{id:s.mediaId},action_info:{success:!0}})),{url:p,mediaId:s.mediaId}):(d&&i(e.b({source:c,action:"upload",noun:u},{media:{id:s.mediaId},action_info:{success:!1}})),b())}catch(a){return l=a.message,window.Sentry?.captureMessage?.(`Media file upload failed with error: ${l}`),d&&u&&i(e.b({source:c,action:"upload",noun:u},{media:{id:s?.mediaId},action_info:{success:!1,reason:a?.message}})),b(a.message)}var l}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./Df3SFBpZLO.js",import.meta.url,"Df3SFBpZLO");SML.di("./DnNITwgp90.js",import.meta.url,"DnNITwgp90");SML.di("./BTnwE85rpZ.js",import.meta.url,"BTnwE85rpZ");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./JaGlTj3I-9.js",import.meta.url,"JaGlTj3I-9");SML.di("./DgW4ULLwQ1.js",import.meta.url,"DgW4ULLwQ1");SML.di("./DCbB57ubLb.js",import.meta.url,"DCbB57ubLb");
SML.dm("CF6nQkAyW-",["Dw4vb8Yfbm","5r73EsgItq","BwcMg3lXAs","Df3SFBpZLO","DnNITwgp90","BTnwE85rpZ","B-zFJtiar6","JaGlTj3I-9","DgW4ULLwQ1","DCbB57ubLb"],(async(e,t,i,o,r,a,s,n,l,m)=>{function d(e){let t="";for(const i of e.root.children)t+=c(i);return t}function c(e){switch(e.type){case m.F.getType():return e.children.map(c).join("");case m.j.getType():{const t=e.text;return t===a.B?"":t}case a.E.getType():return e.mediaId;default:throw new Error("unimplemented type: "+e.type)}}var E;!function(e){e.EMPTY_CONTENT_REQUIRE_TEXT_OR_EMOJI="EMPTY_CONTENT_REQUIRE_TEXT_OR_EMOJI",e.EMPTY_CONTENT_REQUIRE_TEXT="EMPTY_CONTENT_REQUIRE_TEXT",e.EMPTY_CONTENT_REQUIRE_EMOJI="EMPTY_CONTENT_REQUIRE_EMOJI",e.MAX_FLAIR_LENGTH_EXCEEDED="MAX_FLAIR_LENGTH_EXCEEDED",e.MAX_EMOJI_COUNT_EXCEEDED="MAX_EMOJI_COUNT_EXCEEDED",e.ONLY_EMOJIS_ALLOWED="ONLY_EMOJIS_ALLOWED",e.EMOJIS_NOT_ALLOWED="EMOJIS_NOT_ALLOWED"}(E||(E={}));const j=(e,t)=>({reason:e,message:u(e,t)}),u=(t,i)=>{switch(t){case E.EMPTY_CONTENT_REQUIRE_TEXT_OR_EMOJI:return "Text or emoji is required";case E.EMPTY_CONTENT_REQUIRE_TEXT:return "Text is required";case E.EMPTY_CONTENT_REQUIRE_EMOJI:return "Emoji is required";case E.MAX_FLAIR_LENGTH_EXCEEDED:return "Character limit exceeded";case E.ONLY_EMOJIS_ALLOWED:return "Only emojis allowed";case E.EMOJIS_NOT_ALLOWED:return "Emojis aren't allowed";case E.MAX_EMOJI_COUNT_EXCEEDED:{const t=i?.maxEmojiCount??0;return e.cB({one:`Exceeds ${t} emoji limit`,other:`Exceeds ${t} emojis limit`,count:t});}}},h=t=>t===e.dZ.Emoji||t===e.dZ.All,p=(t,i)=>{const{allowableContent:o,maxEmojiCount:r=0}=i,s=t.getEditorState(),n=d(s.toJSON()).length,l=(t=>t===e.dZ.Text||t===e.dZ.All)(o),c=h(o);if(0===n)return j(l&&c?E.EMPTY_CONTENT_REQUIRE_TEXT_OR_EMOJI:c?E.EMPTY_CONTENT_REQUIRE_EMOJI:E.EMPTY_CONTENT_REQUIRE_TEXT);if(n>64)return j(E.MAX_FLAIR_LENGTH_EXCEEDED);const u=s.read((()=>m.U(a.E).length)),p=s.read((()=>m.U(m.j).length>0));return!l&&p?j(E.ONLY_EMOJIS_ALLOWED):!c&&u>0?j(E.EMOJIS_NOT_ALLOWED):u>r?j(E.MAX_EMOJI_COUNT_EXCEEDED,{maxEmojiCount:r}):null};function T(){return!0}let k=class extends t.s{constructor(){super(...arguments),this.validateAfterInputChange=!1,this.flairText="",this.validationError=null,this.isEmojiPickerOpen=!1,this.isDirty=!1,this.debouncedValidateUserInput=e.ao(this.validateUserInput,100),this.clearFlairEditor=t=>{t?.preventDefault(),t?.stopPropagation(),this.flairType&&e.i(this,s.ba(this.flairType)),this.editor?.update((()=>{const e=m.b();e.clear(),e.append(m.I())})),this.closeEmojiPickerIfOutside(t)},this.onEmojiPickerButtonClick=async e=>{e.preventDefault(),e.stopPropagation(),this.isEmojiPickerOpen=!0,await(this.emojiPickers[0]?.show())},this.closeEmojiPicker=()=>{this.emojiPickers[0]?.close()},this.closeEmojiPickerIfOutside=e=>{const t=this.emojiPickers[0];if(!t||!this.isEmojiPickerOpen)return;const i=t.modal;if(!i)return;const o=e.composedPath();if(!o.includes(i))if(t.close(),o.includes(this))setTimeout((()=>this.editor?.focus()),0);else{const e=o[0];setTimeout((()=>e.focus()),0)}},this.markEmojiPickerAsClosed=()=>{this.isEmojiPickerOpen=!1,document.removeEventListener("click",this.closeEmojiPickerIfOutside)},this.getFlairHtml=()=>this.editor?.getEditorState().read((()=>{const e=m.c(this.editor),t=(new DOMParser).parseFromString(e,"text/html").body.querySelector("p");return t?.querySelectorAll("span").forEach((e=>{e.style.removeProperty("white-space"),""===e.getAttribute("style")&&e.removeAttribute("style")})),t?.outerHTML??""})),this.getDescriptionText=()=>this.allowableContent===e.dZ.All?l.p(this.maxEmojiCount||0):this.allowableContent===e.dZ.Emoji?l.a(this.maxEmojiCount||0):"Allows text",this.getFlairText=()=>this.flairText}get editorRoot(){return this.editorRoots?.[0]}firstUpdated(){this.initLexicalEditor()}updated(e){if(e.has("text")||e.has("richtext"))return void this.updateLexicalEditorContent();const t=e.has("isEmojiPickerOpen");this.isEmojiPickerOpen&&t&&this.loadAndInitEmojis();const i=e.has("allowableContent")&&!!this.allowableContent,o=e.has("maxEmojiCount")&&!!this.maxEmojiCount;(i||o)&&this.validateUserInput()}disconnectedCallback(){this.emojiPickers[0]?.removeEventListener("faceplate-close",this.markEmojiPickerAsClosed),document.removeEventListener("click",this.closeEmojiPickerIfOutside),super.disconnectedCallback()}validateUserInput(){if(!this.allowableContent||!this.editor)return;if(!(!this.validateAfterInputChange||this.isDirty))return;const e={allowableContent:this.allowableContent,maxEmojiCount:this.maxEmojiCount};this.validationError=p(this.editor,e);const t=this.validationError?"flair-input-invalid":"flair-input-valid";this.dispatchEvent(new CustomEvent(t))}initLexicalEditor(){if(!this.editorRoot)throw new Error("A single child div should be passed into FlairEditor. e.g: <flair-editor><div></div></flair-editor>");this.editorRoot.setAttribute("contenteditable","true"),this.editorRoot.setAttribute("role","textbox"),this.editorRoot.setAttribute("class","outline-none relative"),this.editorRoot.setAttribute("tabindex","1");const t={onError:console.error,editable:!0,nodes:[a.E],namespace:`flair-editor-${this.namespace||Math.random()}`,theme:{paragraph:"m-0"}},i=m.d(t);i.setRootElement(this.editorRoot),m.e(i),i.registerUpdateListener((()=>{const t=this.editor?.getEditorState().toJSON(),i=t?d(t):"";this.isDirty=this.isDirty||this.flairText!==i,this.flairText=i,this.dispatchEvent(new InputEvent("input",{bubbles:!0})),this.debouncedValidateUserInput(),t&&this.dispatchEvent(e.c("flair-editor-value-change-event",{flair_text:this.flairText}))})),i.registerCommand(m.f,T,m.J),i.registerCommand(m.h,T,m.J),i.registerCommand(m.M,T,m.J),i.registerCommand(m.B,T,m.J),i.registerCommand(m.i,T,m.J),i.registerCommand(m.k,T,m.J),i.registerCommand(m.W,T,m.J),i.registerCommand(m.z,T,m.J),i.registerCommand(m.L,T,m.J),this.editor=i,this.clearFlairEditor()}setRichText(e){this.editor?.update((()=>{try{a.R({document:[{e:n.P,c:JSON.parse(e)}]},{}),m.l(null)}catch{}}))}setPlainText(e=""){this.editor?.update((()=>{m.b().clear();const t=m.I();t.append(m.Z(e)),m.b().append(t),m.l(null)}))}updateLexicalEditorContent(){this.richtext?this.setRichText(this.richtext):this.setPlainText(this.text||""),this.loadAndInitEmojis()}async loadAndInitEmojis(){await(this.emojiPartials[0]?.load()),this.editor&&this.emojiPickers.length>0&&(this.emojiPickers[0]?.setEditor(this.editor),this.emojiPickers[0]?.addEventListener("faceplate-close",this.markEmojiPickerAsClosed),document.addEventListener("click",this.closeEmojiPickerIfOutside),this.emojiTypeaheads[0]?.setEditor(this.editor))}render(){const a=64-this.flairText.length,s=this.allowableContent&&h(this.allowableContent),n="flex-initial";return t.x` <div class="relative pl-md pr-2xs py-[3px] box-border min-h-[40px] rounded-5 border-sm border-solid ${this.validationError?"border-danger-content":"border-secondary-background"}"> <div class="flex flex-row flex-nowrap items-center focus-within:border-neutral-border-strong cursor-text"> <slot class="block py-2xs text-16 text-tone-1 flex-1" name="editor"></slot> ${this.validationError?r.e({attributes:{className:"text-danger-content p-xs"},size:t.I.Small}):""} ${this.isEmojiPickerOpen?t.x``:e.o({appearance:"plain",attributes:{className:`emoji-picker-button ${s?"":"hidden"} ${n}`,type:"button","aria-label":"Open emoji picker",disabled:this.isEmojiPickerOpen,onclick:this.onEmojiPickerButtonClick},size:e.q.Small,screenReaderContent:"open emoji picker",leadingIcon:o.s({size:t.I.Small})})} ${e.o({appearance:"plain",attributes:{className:`clear-button ${n}`,type:"button","aria-label":"Clear",disabled:0===this.flairText.length,onclick:this.clearFlairEditor},size:e.q.Small,screenReaderContent:"clear",leadingIcon:i.c({size:t.I.Small})})} <slot ?hidden="${!s}" name="emojis"></slot> </div> </div> <div class="flex justify-between items-center pt-2xs px-md"> ${this.validationError?t.x` <span class="text-12 error-message text-danger-content">${this.validationError.message}</span> `:t.x`<span class="text-12">${this.getDescriptionText()}</span>`} <div class="flair-length flex-1 text-right ${a<0?"text-danger-content":"text-secondary-weak"}"> ${a} </div> </div> `}};return k.styles=[t.a`:host{--emote-size:20px;--emote-line-height:inherit}.border-danger-content{border-color:var(--color-danger-content)}`,e.t],e._([e.n({type:String})],k.prototype,"namespace",void 0),e._([e.n({type:String})],k.prototype,"text",void 0),e._([e.n({type:String})],k.prototype,"richtext",void 0),e._([e.n({type:String,attribute:"allowable-content"})],k.prototype,"allowableContent",void 0),e._([e.n({type:Number,attribute:"max-emoji-count"})],k.prototype,"maxEmojiCount",void 0),e._([e.n({type:String,attribute:"flair-type"})],k.prototype,"flairType",void 0),e._([e.n({type:Boolean,attribute:"validate-after-input-change"})],k.prototype,"validateAfterInputChange",void 0),e._([e.h()],k.prototype,"flairText",void 0),e._([e.h()],k.prototype,"validationError",void 0),e._([e.h()],k.prototype,"isEmojiPickerOpen",void 0),e._([e.l({slot:"editor",flatten:!0,selector:"div"})],k.prototype,"editorRoots",void 0),e._([e.l({slot:"emojis",selector:"faceplate-partial"})],k.prototype,"emojiPartials",void 0),e._([e.l({slot:"emojis",selector:"emoji-picker"})],k.prototype,"emojiPickers",void 0),e._([e.l({slot:"emojis",selector:"emoji-typeahead"})],k.prototype,"emojiTypeaheads",void 0),e._([e.a2(".emoji-picker-button")],k.prototype,"emojiPickerButton",void 0),k=e._([e.e("flair-editor")],k),{get F(){return k}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./DyRz1vAoTm.js",import.meta.url,"DyRz1vAoTm");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./DtjwywDamI.js",import.meta.url,"DtjwywDamI");SML.di("./Wt225_9ix9.js",import.meta.url,"Wt225_9ix9");SML.di("./CE5TLxi7Z3.js",import.meta.url,"CE5TLxi7Z3");SML.di("./D1ScrvIqaY.js",import.meta.url,"D1ScrvIqaY");SML.di("./E3QE3c4_Ye.js",import.meta.url,"E3QE3c4_Ye");SML.di("./DasPtA-dN5.js",import.meta.url,"DasPtA-dN5");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./JaGlTj3I-9.js",import.meta.url,"JaGlTj3I-9");SML.di("./CRzmHkIoo0.js",import.meta.url,"CRzmHkIoo0");
SML.dm("CFd1NJhleF",["Dw4vb8Yfbm","DyRz1vAoTm","D_g7f2Ewyi","5r73EsgItq","DtjwywDamI","Wt225_9ix9","CE5TLxi7Z3","D1ScrvIqaY","E3QE3c4_Ye","DasPtA-dN5","B-zFJtiar6","JaGlTj3I-9","CRzmHkIoo0"],(async(e,t,n,a,r,i,o,s)=>{const{svg:c}=e.a(),l=e.m(c`<path d="M14.7 2H5.3C3.48 2 2 3.48 2 5.3v9.4C2 16.52 3.48 18 5.3 18h9.4c1.82 0 3.3-1.48 3.3-3.3V5.3C18 3.48 16.52 2 14.7 2zm-1.42 8.17l-2.77 2.77c-.28.28-.74.28-1.02 0l-2.77-2.77a1.943 1.943 0 112.75-2.75l.53.53.53-.53a1.943 1.943 0 112.75 2.75z"></path>`,"0 0 20 20","custom-feed-fill");var $,u;!function(e){e.QUERY="query",e.SUBREDDIT="subreddit",e.MULTIREDDIT="multireddit",e.PROFILE="profile"}($||($={})),function(e){e.COLLAPSED_SECTIONS="collapsedSections",e.CONVERSATION_ID="cId",e.FLAIR="flair",e.QUERY="query",e.RECENT_SEARCHES_COUNT="recentSearchesCount"}(u||(u={}));const E="recent-search-item";let T=class extends a.s{constructor(){super(...arguments),this.size=n.L.Medium,this.handleKeyDown=t=>{"Tab"===t.key&&t.target instanceof HTMLElement&&(t.shiftKey&&t.target.className.includes(e.gY)?(this.focus(),t.preventDefault(),t.stopPropagation()):t.shiftKey||t.target.className.includes(e.gY)||(this.querySelector(`.${e.gY}`)?.focus(),t.preventDefault(),t.stopPropagation()))}}focus(){this.shadowRoot?.querySelector("a")?.focus()}render(){if(!this.recentSearchItem)return;const{flair:c,icon:E,isNsfw:T,isQuarantined:I,name:d,path:R,type:k}=this.recentSearchItem;let p,h;if(k!==$.QUERY)p=R;else try{const t=new URL(R,window.location.origin);t.searchParams.set(u.CONVERSATION_ID,s.a.get(e.ea.Qf)),p=t.toString()}catch{p=R}if(E||T){const t=T?"Recent search not safe for work icon":`${d} icon`,n=T?`${window?.CLIENT_CONFIG?.STATIC_BASE_URL}assets/avatar_over18.png`:E;h=a.x`<faceplate-img class="rounded-full h-lg w-lg flex items-center justify-center static" loading="lazy" src="${e.ad(n)}" width="16" height="16" alt="${t}"></faceplate-img>`}else h=function(e){return e===$.SUBREDDIT?a.x`${i.c({size:a.I.Small,attributes:{"aria-hidden":"true",className:"flex items-center justify-center h-100 ml-px"}})}`:e===$.MULTIREDDIT?a.x`${l({size:a.I.Small,attributes:{"aria-hidden":"true",className:"flex items-center justify-center h-100 ml-px"}})} `:r.c({size:a.I.Small})}(k);const m=I?a.x`<span class="text-alert-caution inline-block"> ${t.c(t.g()[t.C.QUARANTINED])} </span>`:a.x``,S=c?a.x`<span class="text-alert-caution inline-block" data-test-id="recent-search-flair-item"> ${o.a({backgroundColor:c.colorHint?.backgroundColor,className:"text-12 px-sm py-xs",text:c.text,color:"DEFAULT"===c.colorHint?.textColor?e.fj.Dark:c.colorHint?.textColor,richText:c.richtext})} </span>`:a.x``;return n.l({anchorAttributes:{"aria-label":`Recent search for ${d} ${c?.text??""}`,onkeydown:this.handleKeyDown},attributes:{"data-label":k===$.QUERY?d:"",role:"menuitem",tabindex:"-1"},href:p,onClick:this.onClickLink,leadingAvatar:h,label:a.x` <div class="flex items-center px-4 py-2 gap-2xs align-baseline"> <div class="text-neutral-content flex-grow">${d}</div> ${S} </div>`,trailingSlot:a.x`<slot name="dismiss-button-container" @click="${this.onClickDismiss}" @keydown="${()=>{}}"></slot>`,description:m,size:this.size});}};return T.styles=[e.t],e._([e.n({type:Function})],T.prototype,"onClickLink",void 0),e._([e.n({type:Function})],T.prototype,"onClickDismiss",void 0),e._([e.n({type:Object})],T.prototype,"recentSearchItem",void 0),e._([e.n({type:String})],T.prototype,"size",void 0),T=e._([e.e(E)],T),{R:E,get S(){return u},get a(){return $},c:l}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("CG8L8PJoXS",["Dw4vb8Yfbm","B-zFJtiar6"],(async(n,e)=>{var r;!function(n){n.Comment="t1",n.Profile="t2",n.Post="t3",n.Message="t4",n.Subreddit="t5",n.Trophy="t6"}(r||(r={}));const o=n=>{const e=n.split("_").shift();return Object.values(r).includes(e)?e:void 0},t=n=>o(n)===r.Comment,a=n=>o(n)===r.Post,i="new_awards";function c({thingId:n,awardId:e,groupId:r,subredditId:o,postId:i,pageType:c,paneName:u,position:s,recipientId:d,isAnonymous:_,hasMessage:l,awardPrice:w,topAwardIconUrl:p,animatedAwardIconUrls:f,reason:m,correlationId:b,postType:T,postScore:I,score:g,numberComments:E,referrerCorrelationId:M}){const v={new_award:{}};return e&&(v.new_award.id=e),r&&(v.new_award.group_id=r),d&&(v.new_award.recipient_id=d),null!=_&&(v.new_award.is_anonymous=_),null!=l&&(v.new_award.has_message=l),void 0!==w&&(v.new_award.listing_price=w),p&&(v.new_award.top_award_icon_url=p),f&&(v.new_award.animated_awards_ids=f),o&&(v.subreddit={id:o}),n&&(a(n)?v.post={id:n,type:T,score:g,number_comments:E}:t(n)&&(v.comment={id:n,score:g},i&&(v.post={id:i,type:T,score:I,number_comments:E}))),(c||u||s||m)&&(v.action_info={...c&&{page_type:c},...u&&{pane_name:u},...s&&{position:s},...m&&{reason:m}}),b&&(v.correlation_id=b),M&&(v.feed={referrer_correlation_id:M}),v}return{N:i,get T(){return r},a:function(e){return n.b({source:i,action:"view",noun:"leaderboard_tile"},c(e))},b:c,c:a,d:t,e:function(e){const r=n.iu();return n.b({source:i,action:"click",noun:"entry_point"},c({...e,pageType:n.H(),...r&&{referrerCorrelationId:r}}))},f:function(e){return n.b({source:i,action:"view",noun:"gold_info"},c(e))},g:o,h:function(e){return n.b({source:i,action:"view",noun:"award_info"},c(e))},i:function(r){switch(!0){case e.cT(r):return n.M.Award;case t(r):return n.M.Comment;case a(r):return n.M.Post;default:return null}},j:function(e){return n.b({source:i,action:"click",noun:"overflow_menu"},c(e))},k:function(e){return n.b({source:i,action:"view",noun:"leaderboard"},c(e))},l:function(e,r){return n.b({source:i,action:"click",noun:`leaderboard_${r}`},c(e))},m:function(e){return n.b({source:i,action:"filter",noun:"leaderboard"},c(e))},n:function(e){return n.b({source:i,action:n.an.Click,noun:"confirm_award_option"},c(e))},o:function(e){return n.b({source:i,action:n.an.View,noun:"award_options_sheet"},c(e))},s:function(e){return n.b({source:i,action:n.an.Click,noun:"award_option"},c(e))},v:function(e,{isSuccessful:r}){const o=r?"completed_fe":"failed_fe";return n.b({source:i,action:"award_given",noun:o},c(e))}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./Bb_6_71M-3.js",import.meta.url,"Bb_6_71M-3");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BIvvQbZj9p.js",import.meta.url,"BIvvQbZj9p");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./Z0tk4vmzIQ.js",import.meta.url,"Z0tk4vmzIQ");SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");SML.di("./Cl1pMDH2OX.js",import.meta.url,"Cl1pMDH2OX");SML.di("./CEs3hLX56z.js",import.meta.url,"CEs3hLX56z");SML.di("./B6Ai7g9fbR.js",import.meta.url,"B6Ai7g9fbR");SML.di("./pA9dwrnd0r.js",import.meta.url,"pA9dwrnd0r");SML.di("./BXUgRcxEAi.js",import.meta.url,"BXUgRcxEAi");SML.di("./w2XkRJ2mzc.js",import.meta.url,"w2XkRJ2mzc");SML.di("./h4Pa0OJr_5.js",import.meta.url,"h4Pa0OJr_5");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./DFh5Z0Dv0L.js",import.meta.url,"DFh5Z0Dv0L");
SML.dm("CGFmQ-cmFf",["Dw4vb8Yfbm","Bb_6_71M-3","5r73EsgItq","BIvvQbZj9p","B-zFJtiar6","Z0tk4vmzIQ","C8QDHFSIkY","Cl1pMDH2OX","CEs3hLX56z","B6Ai7g9fbR","pA9dwrnd0r","BXUgRcxEAi","w2XkRJ2mzc","h4Pa0OJr_5","BIzQFHISzm","DFh5Z0Dv0L"],(async(t,e,i)=>{const o=e.W(i.s);let r=class extends o{constructor(){super(...arguments),this.adEvents=[],this.impressionId="0",this.isBlank=!1,this.adType=t.f9.DISPLAY,this.placement=t.aj.BLANK_ONLY,this.hasToggleableVideo=!1,this._isConnected=!1,this.toggleableVideoAdController=null}async connectedCallback(){super.connectedCallback(),this._isConnected||(this.enableAdObserver({postElement:this,adType:this.adType,events:e.e(this.adEvents),postId:this.postId,impressionId:this.impressionId,dimensions:this.dimensions}),this._isConnected=!0,await this.resolveVideoAdDependencies())}async resolveVideoAdDependencies(){if(this.adType!==t.f9.VIDEO||!this.hasToggleableVideo)return;const{ToggleableVideoAdController:e}=await SML.di("./BXUgRcxEAi.js",import.meta.url,"BXUgRcxEAi").then((function(t){return t.i}));this.toggleableVideoAdController=new e(this,((t,e)=>{this.adMeasurer&&(this.adMeasurer.dimensions={height:t,width:e})}))}disconnectedCallback(){this.adMeasurer&&this.adMeasurer.handleUnload(),super.disconnectedCallback()}render(){return i.x`<slot></slot>`}};t._([t.n({type:Array,attribute:"ad-events"})],r.prototype,"adEvents",void 0),t._([t.n({type:String,attribute:"post-id"})],r.prototype,"postId",void 0),t._([t.n({type:String,attribute:"impression-id"})],r.prototype,"impressionId",void 0),t._([t.n({type:String,attribute:"outbound-link-url",reflect:!0})],r.prototype,"outboundLinkUrl",void 0),t._([t.n({type:Boolean,attribute:"is-blank"})],r.prototype,"isBlank",void 0),t._([t.n({type:String,attribute:"ad-type"})],r.prototype,"adType",void 0),t._([t.n({type:Object,attribute:!0})],r.prototype,"dimensions",void 0),t._([t.n({type:String,attribute:"encrypted-tracking-payload"})],r.prototype,"encryptedTrackingPayload",void 0),t._([t.n({type:Array,attribute:"additional-event-metadata"})],r.prototype,"additionalEventMetadata",void 0),t._([t.n({type:String,attribute:"ad-transparency-encoded-data"})],r.prototype,"adTransparencyEncodedData",void 0),t._([t.n({type:String,attribute:"placement"})],r.prototype,"placement",void 0),t._([t.n({type:String,attribute:"ads-correlation-id"})],r.prototype,"adsCorrelationId",void 0),t._([t.n({type:Object,attribute:"ad-user-targeting-info"})],r.prototype,"adUserTargeting",void 0),t._([t.n({type:Boolean,attribute:"has-toggleable-video"})],r.prototype,"hasToggleableVideo",void 0),r=t._([t.e("ad-event-tracker")],r)}));
SML.di("./i2O5XQPDKs.js",import.meta.url,"i2O5XQPDKs");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./DflF56Kkuz.js",import.meta.url,"DflF56Kkuz");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./B0pL5bhFHV.js",import.meta.url,"B0pL5bhFHV");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./DOqOHj9jA9.js",import.meta.url,"DOqOHj9jA9");SML.di("./BQbrDNllG4.js",import.meta.url,"BQbrDNllG4");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");
SML.dm("CIOo61duNV",["Dw4vb8Yfbm","B-zFJtiar6","5r73EsgItq","DOqOHj9jA9","BQbrDNllG4","jWC3N3n7Al","FQGvCwaizg"],(async(t,e,i,o,r)=>{const s=new WeakMap;let c=class extends o.C{constructor(){super(),this.ariaRole="radio"}static get styles(){return[super.styles,i.a`:host(:focus) .icon{border-radius:100%}:host{margin:var(--spacer-sm)}:host([checked]) .icon,:host([indeterminate]) .icon{display:inline-block;color:var(--color-input-radio-hover)}:host .icon{color:var(--color-input-radio)}:host(:hover) .icon{color:var(--color-input-radio-hover)}`]}connectedCallback(){super.connectedCallback(),this._contextKey=e.g(this.name,this.getRootNode()),s.has(this._contextKey)?s.get(this._contextKey).add(this):s.set(this._contextKey,new Set([this]))}disconnectedCallback(){super.disconnectedCallback(),this._contextKey&&s.get(this._contextKey)?.delete(this)}handleInteraction(){if(this._contextKey){const t=s.get(this._contextKey);if(t)for(const e of t)e!==this&&(e.checked=!1)}this.checked=!0,super.handleInteraction()}render(){const t={size:i.I.Small,attributes:{className:"icon"}};return i.x` ${this.checked?r.r(t):r.a(t)} ${super.render()} `}};return c=t._([t.e("faceplate-radio-input")],c),{get FaceplateRadioInput(){return c}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BwcUp7XlaC.js",import.meta.url,"BwcUp7XlaC");SML.di("./CQMf561ZyA.js",import.meta.url,"CQMf561ZyA");SML.di("./Py9rIF7r2a.js",import.meta.url,"Py9rIF7r2a");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./DnNITwgp90.js",import.meta.url,"DnNITwgp90");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");
SML.dm("CMwg6atOpj",["Dw4vb8Yfbm","5r73EsgItq","BwcUp7XlaC","Py9rIF7r2a","CQMf561ZyA","FQGvCwaizg","BIzQFHISzm","BwcMg3lXAs","DnNITwgp90","jWC3N3n7Al"],(async(e,n,t,i)=>{let a=class extends t.T{constructor(){super(...arguments),this.hasChips=!1,this.hasTrailingContent=!1,this.clearable=!0,this.hideLeadingIconWithInput=!1,this.centerPlaceholder=!1}static get styles(){return[super.styles,n.a`:host{margin:var(--spacer-2xs) var(--spacer-md);display:inline-flex}label{flex-grow:1}input{background:0 0;border:none;outline:0;width:100%;text-overflow:ellipsis}input::placeholder{color:var(--color-neutral-content-weak)}:host([center-placeholder]) .leadingIcon:not(:empty)~.input-container input::placeholder{text-align:center}:host([center-placeholder]) .label-container:not(.label-container-trailing) .leadingIcon:not(:empty)~.input-container input::placeholder{padding-inline-start:var(--spacer-sm)}:host([center-placeholder]) .label-container-trailing .leadingIcon:not(:empty)~.input-container input::placeholder{padding-inline-start:var(--spacer-lg)}.label-container,:host([faceplate-validity=invalid]) .label-container,:host([faceplate-validity=valid]) .label-container{border:var(--rem2) solid var(--color-input-border);box-shadow:0 0 0 var(--rem2) transparent}.label-container{align-items:center;box-sizing:border-box;border-radius:var(--radius-full);border:var(--rem2) solid var(--color-input-plain-border);padding-inline:var(--spacer-md)}.label-container-chips{background:var(--color-input-plain)}.label-container:focus-within{background:var(--color-input-plain);border-color:var(--color-neutral-border-strong)}@media (hover:hover){.label-container:focus-within:hover,.label-container:hover{background:var(--color-input-secondary-hover)}}:host .label-container{padding-inline-end:var(--spacer-2xs)}:host faceplate-form-helper-text:not(.helper-text-without-label-with-trailing){padding-inline-end:var(--spacer-2xs)}.label-container.label-container-trailing{padding-inline-end:var(--rem2)}.input-container{align-items:center;display:flex;font:var(--font-14-20-regular);position:relative;transform:translateY(0);transition:transform 150ms ease;width:100%;padding-block:var(--spacer-xs)}.leadingIcon{display:inline-flex;font-size:var(--rem16);margin-inline-end:var(--spacer-xs)}:host([hide-leading-icon-with-input]) .label-container:has(input:not(:placeholder-shown)) .leadingIcon{display:none}.label-container-chips slot[name=chips]{display:inline-flex;margin-inline-end:var(--spacer-xs)}.clear-icon-container{height:var(--rem32);width:var(--rem32);flex-shrink:0}.trailing-content-container{display:none;align-items:center;flex-shrink:0}.trailing-content-container.has-trailing-content{display:flex}.trailing-divider{height:var(--rem24);border:0;border-inline-start:var(--rem1) solid var(--color-neutral-border-weak);margin:0;margin-inline-start:var(--spacer-2xs);margin-inline-end:var(--spacer-2xs);flex-shrink:0}.leadingIcon,:slot[name=chips],:slot[name=clearIcon],:slot[name=trailingContent]{display:flex;flex-shrink:0}`]}render(){return n.x` <label> <div class="${e.Z({"label-container":!0,"label-container-chips":this.hasChips,"label-container-trailing":this.hasTrailingContent,"without-label":!0})}"> <span class="leadingIcon"> <slot name="leadingIcon"> ${i.s({size:n.I.Small,attributes:{"aria-hidden":"true"}})} </slot> </span><slot name="chips" @slotchange="${()=>{this.hasChips=this.chipElements.length>0}}"></slot>${this.inputContainer(n.x` <input type="text" enterkeyhint="${e.ad(this.enterkeyhint)}" @change="${this.onChange}" @input="${this.onInput}" .value="${t.l(this.value)}" name="${e.ad(this.name)}" maxlength="${e.ad(this.maxlength)}" placeholder="${e.ad(this.placeholder)}" ?disabled="${this.disabled}" ?required="${this.required}" autocomplete="${e.ad(this.autocomplete)}" inputmode="${e.ad(this.inputmode)}"> `)} <span class="clear-icon-container" style="${e.a6({display:this.clearable&&this.value.length>0?"":"none"})}"> ${this.clearable&&this.value.length>0?n.x`<slot name="clearIcon"></slot>`:""} </span> ${this.hasTrailingContent?n.x`<hr class="trailing-divider">`:""} <span class="${e.Z({"trailing-content-container":!0,"has-trailing-content":this.hasTrailingContent})}"> <slot name="trailingContent" @slotchange="${()=>{this.hasTrailingContent=this.trailingContentElements.length>0}}"></slot> </span> ${this.screenReaderContent?n.x`<faceplate-screen-reader-content> ${this.screenReaderContent} </faceplate-screen-reader-content>`:""} </div> </label> `}};return e._([e.h()],a.prototype,"hasChips",void 0),e._([e.h()],a.prototype,"hasTrailingContent",void 0),e._([e.l({slot:"chips"})],a.prototype,"chipElements",void 0),e._([e.l({slot:"trailingContent"})],a.prototype,"trailingContentElements",void 0),e._([e.a2(".label-container")],a.prototype,"labelContainer",void 0),e._([e.n({type:String})],a.prototype,"enterkeyhint",void 0),e._([e.n({type:String})],a.prototype,"maxlength",void 0),e._([e.n({type:Boolean})],a.prototype,"clearable",void 0),e._([e.n({type:Boolean,attribute:"hide-leading-icon-with-input"})],a.prototype,"hideLeadingIconWithInput",void 0),e._([e.n({type:Boolean,attribute:"center-placeholder"})],a.prototype,"centerPlaceholder",void 0),a=e._([e.e("faceplate-search-input")],a),{get F(){return a}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("CNVxoLjPZD",["Dw4vb8Yfbm"],(async a=>{const{svg:s}=a.a();return{s:a.m(s`<path d="M10 13.9c-2.15 0-3.9-1.75-3.9-3.9S7.85 6.1 10 6.1s3.9 1.75 3.9 3.9-1.75 3.9-3.9 3.9zm0-6a2.1 2.1 0 100 4.2 2.1 2.1 0 000-4.2z"></path><path d="M10 16.97c-3.8 0-7.28-2.09-9.08-5.44-.51-.96-.51-2.1 0-3.06C2.72 5.11 6.2 3.03 10 3.03s7.28 2.09 9.08 5.44c.51.96.51 2.1 0 3.06-1.8 3.36-5.28 5.44-9.08 5.44zm0-12.14c-3.14 0-6.01 1.72-7.5 4.5-.22.42-.22.94 0 1.35a8.514 8.514 0 007.5 4.5c3.14 0 6.01-1.72 7.5-4.5.22-.42.22-.94 0-1.35a8.514 8.514 0 00-7.5-4.5z"></path>`,"0 0 20 20","show")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("COCf9Sdqlx",["Dw4vb8Yfbm"],(async c=>{const{svg:h}=c.a();return{a:c.m(h`<path d="M15.7 1H4.3C2.48 1 1 2.48 1 4.3v2.76c0 .5.4.9.9.9H2v6.74C2 16.52 3.48 18 5.3 18h9.4c1.82 0 3.3-1.48 3.3-3.3V7.96h.1c.5 0 .9-.4.9-.9V4.3C19 2.48 17.52 1 15.7 1zM2.8 4.3c0-.83.67-1.5 1.5-1.5h11.4c.83 0 1.5.67 1.5 1.5v1.86H2.8V4.3zm13.4 10.4c0 .83-.67 1.5-1.5 1.5H5.3c-.83 0-1.5-.67-1.5-1.5V7.96h12.4v6.74z"></path><path d="M13 10.06H7v1.8h6v-1.8z"></path>`,"0 0 20 20","archive")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BwcUp7XlaC.js",import.meta.url,"BwcUp7XlaC");
SML.dm("CQMf561ZyA",["Dw4vb8Yfbm","5r73EsgItq","BwcUp7XlaC"],(async(t,e,i)=>{var n;!function(t){t.BORDERED="bordered",t.SECONDARY="secondary"}(n||(n={}));let a=class extends i.T{constructor(){super(...arguments),this.prefix="",this.type="text",this.appearance=n.SECONDARY,this.persistentTrailingIcon=!1,this.withSelect=!1}static get styles(){return[super.styles,e.a`input{outline:0;background:0 0;border:none;width:100%}:host([appearance=bordered]) .label-container:not(.without-label) .input-container.stateful-input{transform:translateY(0)}::slotted([slot=leadingIcon]){margin-inline-end:var(--spacer-xs);display:flex}.input-prefix{margin-inline-end:var(--spacer-4xs)}.input-suffix{margin-inline-start:var(--spacer-4xs)}.input-prefix,.input-suffix{flex-shrink:0}:host([appearance=bordered]) .label-container{border-radius:20px 20px 0 0;align-items:flex-end;padding-bottom:var(--spacer-2xs)}:host([appearance=bordered]) .input-boundary-box{margin-bottom:var(--rem6);align-items:center;padding:0}:host .label-container.without-label{height:var(--rem40)}:host(:focus-within) .label-container:not(.with-trailing-button) ::slotted([slot=clearButton].has-value),:host([faceplate-validity=invalid]:not([disabled])[faceplate-dirty]) ::slotted([slot=clearButton].has-value){display:inline-block}`]}dispatchFocusin(){}render(){return super.renderInput(e.x`<input aria-labelledby="fp-input-label" ?readonly="${this.readonly}" type="${this.type}" pattern="${t.ad(this.pattern)}" @input="${this.onInput}" @change="${this.onChange}" @mouseover="${t=>t.stopPropagation()}" .value="${i.l(this.value)}" name="${t.ad(this.withSelect?void 0:this.name)}" minlength="${t.ad(this.minLength)}" maxlength="${t.ad(this.allowMaxLengthOverflow?void 0:this.maxLength)}" min="${t.ad(this.min)}" max="${t.ad(this.max)}" placeholder="${t.ad(0===this.placeholder.length?void 0:this.placeholder)}" ?disabled="${this.disabled}" ?required="${this.required}" autocomplete="${t.ad(this.autocomplete)}" inputmode="${t.ad(this.inputmode)}" step="${t.ad(this.step)}">`)}};return t._([t.n({type:String})],a.prototype,"prefix",void 0),t._([t.n({type:String})],a.prototype,"type",void 0),t._([t.n({type:String})],a.prototype,"pattern",void 0),t._([t.n({converter:t=>"string"==typeof t&&"any"===t.toLowerCase()?"any":isNaN(t)?void 0:Number(t)})],a.prototype,"step",void 0),t._([t.n({type:Number})],a.prototype,"min",void 0),t._([t.n({type:Number})],a.prototype,"max",void 0),t._([t.n({type:String,reflect:!0})],a.prototype,"appearance",void 0),t._([t.n({type:Boolean,attribute:"persistent-trailing-icon"})],a.prototype,"persistentTrailingIcon",void 0),t._([t.n({type:Boolean,attribute:"with-select"})],a.prototype,"withSelect",void 0),a=t._([t.e("faceplate-text-input")],a),{get F(){return a},get T(){return n}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("CQrDBXK-hm",["Dw4vb8Yfbm"],(async t=>{var e,i;!function(t){t.FocusSearchBar="focusSearchBar",t.RegisterAuth="registerAuth",t.UpvoteAuth="upvoteAuth"}(e||(e={})),function(t){t.Sort="sort",t.Filter="filter",t.EntityFilterId="entityFilterId",t.InlineRefresh="inline-refresh",t.SctTopLevelComment="sct-top-level-comment",t.ForceLegacySCT="force-legacy-sct"}(i||(i={}));const n=/(\.|\/\/)(reddit\.com|snoo\.dev|redditstatic\.com|redd\.it|redditmedia\.com)$/;class r extends t.bf{constructor(e,i){super(e),this.events=new t.E(this,(()=>this._host)),this.handleMouseClick=(t,e)=>{if(t.isLinkClickHandled)return;const i=t.composedPath();for(const n of i){if(!(n instanceof HTMLAnchorElement))continue;const i=n.getAttribute("href")||"";if(this.isOutboundUrl(i))return this.trackOutboundLinkClick(i,e),void(t.isLinkClickHandled=!0)}},this.events.define("click",(t=>{this.handleMouseClick(t,i())}))}isOutboundUrl(t){if(t.startsWith("/"))return!1;try{return null==new URL(t).origin.match(n)}catch(t){return!1}}trackOutboundLinkClick(e,i){t.i(this._host,this.outboundLinkClickEvent(e,i))}outboundLinkClickEvent(e,i){return t.b({source:"link",action:"click",noun:"outbound_link"},{outbound:{url:e},action_info:{page_type:i.pageType},...i.postId?{post:{id:i.postId}}:{},...i.subredditId?{subreddit:{id:i.subredditId}}:{},...i.commentId?{comment:{id:i.commentId}}:{}})}}return{get M(){return e},O:r,P:"pdp-chained-right-rail-related-posts",R:"right-rail-entity-panel-root",S:"#subreddit-right-rail-tabs",get a(){return i},b:"remove-flair",g:function(t){return`update-post-flair-modal-${t}`}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("CRzmHkIoo0",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,r)=>{let i=class extends r.s{constructor(){super(...arguments),this.revealed=!1,this.blockRevealOnClick=!1}static get styles(){return r.a`.outer{background:var(--color-category-spoiler);border-radius:2px;cursor:pointer;line-height:21px;transition:background ease-out 1s;border:none;padding:0;font:inherit;color:inherit;margin-right:.25rem}.inner{opacity:0;transition:opacity ease-out 1s;margin-right:-.25rem}.revealed.outer{background:0 0}.revealed .inner{opacity:1}`}revealSpoiler(e){this.revealed||e.preventDefault(),this.revealed=!0}handleKeyPress(e){"Enter"!==e.key&&" "!==e.key||this.revealSpoiler(e)}render(){return this.blockRevealOnClick?r.x` <span class="outer"> <span class="inner" aria-hidden="true"> <slot></slot> </span> </span> `:r.x` <span class="outer${this.revealed?" revealed":""}" title="${"Reveal Spoiler"}" role="button" @click="${this.revealSpoiler}" @keypress="${this.handleKeyPress}" tabindex="0"> <span class="inner" aria-hidden="${!this.revealed}"> <slot></slot> </span> </span> `;}};e._([e.h()],i.prototype,"revealed",void 0),e._([e.n({type:Boolean,attribute:"block-reveal-on-click"})],i.prototype,"blockRevealOnClick",void 0),i=e._([e.e("shreddit-spoiler")],i)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./g8Ezfsb_Vs.js",import.meta.url,"g8Ezfsb_Vs");SML.di("./Py9rIF7r2a.js",import.meta.url,"Py9rIF7r2a");SML.di("./CxA9E_GW4X.js",import.meta.url,"CxA9E_GW4X");SML.di("./CMwg6atOpj.js",import.meta.url,"CMwg6atOpj");SML.di("./ClaQym8zez.js",import.meta.url,"ClaQym8zez");
SML.dm("CSyIYk6M3w",["Dw4vb8Yfbm","5r73EsgItq","g8Ezfsb_Vs","Py9rIF7r2a","CxA9E_GW4X","CMwg6atOpj","ClaQym8zez"],(async(e,t,a,o)=>{let r=class extends t.s{constructor(){super(...arguments),this.target="",this.path="",this.pdpCommentSearchInputSelector=e.w.pdpCommentSearchInput,this.handleBackNavigation=async()=>{this.showCommentComposer();const t=new URL(location.href);t.searchParams.delete(e.cn.Query),t.searchParams.delete(e.cn.Pane),t.searchParams.delete(e.cn.ConversationId),t.searchParams.delete(e.cn.ImpressionId);const a=new URL(`${location.origin}${this.path}`);history.replaceState({},"",t.toString());const o=a.toString().substring(location.origin.length),r=new URLSearchParams(location.search).get(e.cn.Sort),n=`/svc/shreddit/comments${o}?${new URLSearchParams({"inline-refresh":"true","render-mode":"partial",...(r ? {sort:r} : {})}).toString()}`;this.replaceContentController.loadAndReplaceContent({src:n,target:this.target,afterSuccess:()=>e.co(this,{message:"Navigated to all comments successfully",options:{priority:e.S.assertive}}),afterFailure:()=>this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.error,cause:"uncategorized",message:"Failed to load the comments."}))})},this.replaceContentController=new o.R}showCommentComposer(){document.querySelector(this.pdpCommentSearchInputSelector)?.resetSearchInput()}render(){return t.x` <faceplate-tracker source="post" action="click" noun="view_all_comments"> <faceplate-tooltip appearance="inverted">${e.o({appearance:"plain",size:e.q.Small,shape:"pill",attributes:{className:"m-xs border-none","aria-label":"Back",onclick:this.handleBackNavigation,slot:"trigger",type:"button"},children:"All Comments",screenReaderContent:"Show all Comments tree",leadingIcon:a.a({size:t.I.Small})})} ${"Navigate to all comments"} </faceplate-tooltip> </faceplate-tracker>`;}};r.styles=[e.t],e._([e.n({type:String})],r.prototype,"target",void 0),e._([e.n({type:String})],r.prototype,"path",void 0),e._([e.n({type:String,attribute:"pdp-comment-search-input-selector"})],r.prototype,"pdpCommentSearchInputSelector",void 0),r=e._([e.e("pdp-comment-search-close")],r)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./DZO4dWmzHb.js",import.meta.url,"DZO4dWmzHb");SML.di("./DfOK659qrU.js",import.meta.url,"DfOK659qrU");SML.di("./CZ0Z5XJFvV.js",import.meta.url,"CZ0Z5XJFvV");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./DOqOHj9jA9.js",import.meta.url,"DOqOHj9jA9");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./BRjrtOukap.js",import.meta.url,"BRjrtOukap");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");
SML.dm("CT64J_9lkK",["Dw4vb8Yfbm","5r73EsgItq","DZO4dWmzHb","DfOK659qrU","CZ0Z5XJFvV","tO6bKRQro7","DOqOHj9jA9","jWC3N3n7Al","FQGvCwaizg","BRjrtOukap","Bu440t6XLo","B-zFJtiar6","BeFppRYbzE"],(async(e,i,t)=>{let a=class extends i.s{constructor(){super(...arguments),this.target=null,this.includeWrapper=!1,this.tooltipText=""}renderButton(){return i.x` <shreddit-pubsub-publisher class="nd:visible" topic="${e.T.TriggerCommunityAppearanceMenu}" data="${JSON.stringify({target:this.target})}"> <slot> <rpl-tooltip appearance="inverted" placement="left"> ${e.o({appearance:"secondary",shape:"pill",attributes:{"aria-label":"Edit community appearance",type:"button"},leadingIcon:t.e({size:i.I.Small}),size:e.q.Small})} <span slot="content"> ${this.tooltipText||"Edit community appearance"} </span> </rpl-tooltip> </slot> </shreddit-pubsub-publisher>`;}render(){return this.includeWrapper?i.x`<div class="community-appearance flex justify-between items-center"> <span class="flex gap-2xs items-center text-12"> ${"Community Appearance"}</span> <span class="flex gap-2xs items-center"> ${this.renderButton()} </span> </div>`:this.renderButton();}};a.styles=[e.t],e._([e.n({type:String})],a.prototype,"target",void 0),e._([e.n({type:Boolean,attribute:"include-wrapper"})],a.prototype,"includeWrapper",void 0),e._([e.n({type:String,attribute:"tooltip-text"})],a.prototype,"tooltipText",void 0),a=e._([e.e("community-appearance-entrypoint")],a)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./YFXcK0ZyJl.js",import.meta.url,"YFXcK0ZyJl");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BRjrtOukap.js",import.meta.url,"BRjrtOukap");
SML.dm("CU8weQ2dDy",["Dw4vb8Yfbm","YFXcK0ZyJl","5r73EsgItq","BRjrtOukap"],(async(r,e,o,l)=>{var c,a=o.a`${r.a7}.checkmark-icon,::slotted([slot=leading]){display:inline-flex;margin-inline-end:var(--spacer-xs)}a,button{padding:calc(var(--spacer-xs) - var(--rem1))}:host([appearance=bordered]){--rpl-filter-chip-border-color:var(--color-neutral-border);--rpl-filter-chip-text-color:var(--color-secondary-plain);--rpl-filter-chip-disabled-background-color:var(--color-interactive-content-disabled);--rpl-filter-chip-disabled-text-color:var(--color-interactive-content-disabled);--rpl-filter-chip-disabled-border-color:var(--color-neutral-border-weak);--rpl-filter-chip-selected-background-color:var(--color-secondary-background-selected);--rpl-filter-chip-selected-border-color:var(--color-neutral-border);--rpl-filter-chip-hover-background-color:var(--color-secondary-background-hover)}:host([appearance=media]){--rpl-filter-chip-border-color:var(--color-media-border-weak);--rpl-filter-chip-background-color:var(--color-media-background);--rpl-filter-chip-text-color:var(--color-media-onbackground);--rpl-filter-chip-disabled-text-color:var(--color-media-onbackground-disabled);--rpl-filter-chip-disabled-background-color:var(--color-media-background);--rpl-filter-chip-disabled-border-color:var(--color-media-border-weak);--rpl-filter-chip-hover-background-color:var(--color-media-background-hover);--rpl-filter-chip-selected-background-color:var(--color-media-background-selected);--rpl-filter-chip-selected-border-color:var(--color-media-border-selected)}:host{border:1px solid var(--rpl-filter-chip-border-color);color:var(--rpl-filter-chip-text-color);background:var(--rpl-filter-chip-background-color);border-radius:var(--rem8);font-weight:600}:host(.hover:not([disabled])),:host(:hover:not([disabled])){background:var(--rpl-filter-chip-hover-background-color)}:host([selected]){--rpl-filter-chip-background-color:var(--rpl-filter-chip-selected-background-color);--rpl-filter-chip-border-color:var(--rpl-filter-chip-selected-border-color)}:host([disabled]){--rpl-filter-chip-background-color:var(--rpl-filter-chip-disabled-background-color);--rpl-filter-chip-border-color:var(--rpl-filter-chip-disabled-border-color);--rpl-filter-chip-text-color:var(--rpl-filter-chip-disabled-text-color)}`;!function(r){r.Bordered="bordered",r.Media="media"}(c||(c={}));let i=class extends e.R{constructor(){super(...arguments),this.appearance=c.Bordered}static get styles(){return[e.R.styles,a]}renderLeadingContent(){return this.selected?l.c({size:o.I.Small,attributes:{className:"checkmark-icon"}}):super.renderLeadingContent()}};return r._([r.n({type:String})],i.prototype,"appearance",void 0),i=r._([r.e("rpl-filter-chip")],i),{get R(){return c}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("CUIVPWsUpf",["Dw4vb8Yfbm"],(async a=>{const{svg:t}=a.a();return{u:a.m(t`<path d="M10 19a3.966 3.966 0 01-3.96-3.962V10.98H2.838a1.731 1.731 0 01-1.605-1.073 1.734 1.734 0 01.377-1.895L9.364.254a.925.925 0 011.272 0l7.754 7.759c.498.499.646 1.242.376 1.894-.27.652-.9 1.073-1.605 1.073h-3.202v4.058A3.965 3.965 0 019.999 19H10zM2.989 9.179H7.84v5.731c0 1.13.81 2.163 1.934 2.278a2.163 2.163 0 002.386-2.15V9.179h4.851L10 2.163 2.989 9.179z"></path>`,"0 0 20 20","upvote")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./CzwD205thW.js",import.meta.url,"CzwD205thW");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("CVNmbm37o6",["Dw4vb8Yfbm","CzwD205thW","5r73EsgItq"],(async(t,e,s)=>{const r=e.W(s.s);let i=class extends r{constructor(){super(...arguments),this.permalink="",this.isDesktopViewport=!1}static get styles(){return[t.t]}handlePostShareInteract(t){this.isAllowedEvent(t)&&this.handleCopyLinkClick(t)}render(){return s.x`<slot @click="${this.handlePostShareInteract}" @keydown="${this.handlePostShareInteract}"></slot>`}};t._([t.n({type:String})],i.prototype,"permalink",void 0),t._([t.n({type:Boolean,attribute:"is-desktop-viewport"})],i.prototype,"isDesktopViewport",void 0),i=t._([t.e("shreddit-share-list-item")],i)}));
SML.di("./Bypt3-pSP2.js",import.meta.url,"Bypt3-pSP2");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("CW_r9jbopq",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,t)=>{var n;let a=n=class extends t.s{constructor(){super(),this.pubsub=new e.u(this),this.handleTriggerAction=e=>{this.openMenu(e?.target)},this.openMenu=async e=>{await n.activateCommunityAppearanceMenuContentFeature(this.subredditName),await customElements.whenDefined("community-appearance-menu"),this.communityAppearanceMenu=this.communityAppearanceMenu||this.querySelector("community-appearance-menu"),this.communityAppearanceMenu&&await this.communityAppearanceMenu.updateComplete,e&&this.communityAppearanceMenu?.navigateToSubPage(e),this.communityAppearanceMenu?.show()},this.communityAppearanceMenu=this.querySelector("community-appearance-menu")}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.TriggerCommunityAppearanceMenu,this.handleTriggerAction)}async firstUpdated(){this.directLink&&this.openMenu(this.directLink)}static async activateCommunityAppearanceMenuContentFeature(t){await e.r({name:e.ga,routeParams:{subredditName:t}})}render(){return t.x`<slot></slot>`}};e._([e.n({type:String,attribute:"subreddit-name"})],a.prototype,"subredditName",void 0),e._([e.n({type:String,attribute:"direct-link"})],a.prototype,"directLink",void 0),a=n=e._([e.e("community-appearance-settings-controller")],a)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.di("./orYKE3eiZz.js",import.meta.url,"orYKE3eiZz");SML.di("./pGK22CCKQg.js",import.meta.url,"pGK22CCKQg");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./D_6DXw1u0k.js",import.meta.url,"D_6DXw1u0k");SML.di("./bu_4lgLyr3.js",import.meta.url,"bu_4lgLyr3");SML.di("./BH_5BVBNJs.js",import.meta.url,"BH_5BVBNJs");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./aPtImf01vE.js",import.meta.url,"aPtImf01vE");SML.di("./BOhFIvFWxC.js",import.meta.url,"BOhFIvFWxC");SML.di("./DvtJ_U6Duj.js",import.meta.url,"DvtJ_U6Duj");SML.di("./BWv2j8jrjX.js",import.meta.url,"BWv2j8jrjX");SML.di("./CRAFLHYx6W.js",import.meta.url,"CRAFLHYx6W");SML.di("./C8ijvHauXT.js",import.meta.url,"C8ijvHauXT");SML.di("./DTyYwWUJGO.js",import.meta.url,"DTyYwWUJGO");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");SML.di("./Ra7c5dpU9j.js",import.meta.url,"Ra7c5dpU9j");SML.di("./DXiBrmAMuC.js",import.meta.url,"DXiBrmAMuC");SML.di("./KkXqW5RUm3.js",import.meta.url,"KkXqW5RUm3");SML.di("./D1qW6uVN9U.js",import.meta.url,"D1qW6uVN9U");SML.di("./CEUJsu8B0y.js",import.meta.url,"CEUJsu8B0y");SML.di("./C32iWCYscP.js",import.meta.url,"C32iWCYscP");SML.di("./B0pL5bhFHV.js",import.meta.url,"B0pL5bhFHV");SML.di("./CQLIbJ-5V6.js",import.meta.url,"CQLIbJ-5V6");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./CNdFOsbHrs.js",import.meta.url,"CNdFOsbHrs");SML.di("./BIvvQbZj9p.js",import.meta.url,"BIvvQbZj9p");SML.di("./B6sa1lzoK7.js",import.meta.url,"B6sa1lzoK7");SML.di("./Bb_6_71M-3.js",import.meta.url,"Bb_6_71M-3");SML.di("./Z0tk4vmzIQ.js",import.meta.url,"Z0tk4vmzIQ");SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");SML.di("./Cl1pMDH2OX.js",import.meta.url,"Cl1pMDH2OX");SML.di("./CEs3hLX56z.js",import.meta.url,"CEs3hLX56z");SML.di("./B6Ai7g9fbR.js",import.meta.url,"B6Ai7g9fbR");SML.di("./pA9dwrnd0r.js",import.meta.url,"pA9dwrnd0r");SML.di("./BXUgRcxEAi.js",import.meta.url,"BXUgRcxEAi");SML.di("./w2XkRJ2mzc.js",import.meta.url,"w2XkRJ2mzc");SML.di("./h4Pa0OJr_5.js",import.meta.url,"h4Pa0OJr_5");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./DFh5Z0Dv0L.js",import.meta.url,"DFh5Z0Dv0L");SML.di("./CPSOeCrm6v.js",import.meta.url,"CPSOeCrm6v");SML.di("./Ctcf-FPPNG.js",import.meta.url,"Ctcf-FPPNG");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");SML.di("./BLrhRle6xP.js",import.meta.url,"BLrhRle6xP");SML.di("./C3-eAP6Oln.js",import.meta.url,"C3-eAP6Oln");SML.di("./DMGDObG7XA.js",import.meta.url,"DMGDObG7XA");SML.di("./BlPAB0-vrn.js",import.meta.url,"BlPAB0-vrn");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./Cxi0lHfX5y.js",import.meta.url,"Cxi0lHfX5y");SML.di("./Dr-661gpDM.js",import.meta.url,"Dr-661gpDM");SML.di("./D2GdwS8jc7.js",import.meta.url,"D2GdwS8jc7");SML.di("./BhZAdnVq89.js",import.meta.url,"BhZAdnVq89");SML.di("./B0p6XlbwHt.js",import.meta.url,"B0p6XlbwHt");SML.di("./BwcUp7XlaC.js",import.meta.url,"BwcUp7XlaC");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./DnNITwgp90.js",import.meta.url,"DnNITwgp90");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");SML.di("./Wt225_9ix9.js",import.meta.url,"Wt225_9ix9");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./DEkErsMrK1.js",import.meta.url,"DEkErsMrK1");SML.di("./CQMf561ZyA.js",import.meta.url,"CQMf561ZyA");SML.di("./CpZ44pmnxI.js",import.meta.url,"CpZ44pmnxI");SML.di("./wBWjBlz6KG.js",import.meta.url,"wBWjBlz6KG");SML.di("./DT9eLCODQW.js",import.meta.url,"DT9eLCODQW");
SML.dm("CXyx_rJw2f",["Dw4vb8Yfbm","orYKE3eiZz","pGK22CCKQg","5r73EsgItq","D_6DXw1u0k","bu_4lgLyr3","BH_5BVBNJs","aPtImf01vE","BOhFIvFWxC","DvtJ_U6Duj","BWv2j8jrjX","CRAFLHYx6W","C8ijvHauXT","DTyYwWUJGO","BYzqEZ3uv3","eY7T41bKac","Ra7c5dpU9j","DXiBrmAMuC","KkXqW5RUm3","D1qW6uVN9U","CEUJsu8B0y","C32iWCYscP","B0pL5bhFHV","CQLIbJ-5V6","B-zFJtiar6","CNdFOsbHrs","BIvvQbZj9p","B6sa1lzoK7","Bb_6_71M-3","Z0tk4vmzIQ","C8QDHFSIkY","Cl1pMDH2OX","CEs3hLX56z","B6Ai7g9fbR","pA9dwrnd0r","BXUgRcxEAi","w2XkRJ2mzc","h4Pa0OJr_5","BIzQFHISzm","DFh5Z0Dv0L","CPSOeCrm6v","Ctcf-FPPNG","BtqmVQuPYp","BLrhRle6xP","C3-eAP6Oln","DMGDObG7XA","BlPAB0-vrn","xrDbp1ee_h","Cxi0lHfX5y","Dr-661gpDM","D2GdwS8jc7","BhZAdnVq89","B0p6XlbwHt","BwcUp7XlaC","FQGvCwaizg","BwcMg3lXAs","DnNITwgp90","jWC3N3n7Al","Wt225_9ix9","Cv4mWnWE30","DEkErsMrK1","CQMf561ZyA","CpZ44pmnxI","wBWjBlz6KG","DT9eLCODQW"],(async E=>{SML.di("./BaxkLfaoug.js",import.meta.url,"BaxkLfaoug").then((function(E){return E.f})),SML.di("./CBbxnHsw2W.js",import.meta.url,"CBbxnHsw2W").then((function(E){return E.f})),SML.di("./ClaQym8zez.js",import.meta.url,"ClaQym8zez"),E.g()&&SML.di("./Cv9IgiePU4.js",import.meta.url,"Cv9IgiePU4")}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("CZ0Z5XJFvV",["Dw4vb8Yfbm","5r73EsgItq"],(async(t,e)=>{let s=class extends e.s{constructor(){super(...arguments),this.handleInteraction=e=>{t.j(e)&&this.handleAction()}}static get styles(){return e.a`:host{display:contents}`}handleAction(){this.topic&&t.p(this.topic,this.data)}render(){return e.x`<slot @click="${this.handleInteraction}" @keypress="${this.handleInteraction}"></slot>`}};t._([t.n({type:String})],s.prototype,"topic",void 0),t._([t.n({type:Object})],s.prototype,"data",void 0),s=t._([t.e("shreddit-pubsub-publisher")],s)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("CZLMnmUH44",["Dw4vb8Yfbm"],(async t=>{var n;!function(t){t.MULTILINGUAL_ON="multilingual_on",t.ACCOUNT_AGE="account_age",t.BACKEND="backend",t.DEFAULT_OFF="default_off",t.REGULAR_SEO="regular_seo",t.MT_SEO="mt_seo"}(n||(n={}));const o="on",a="off",e="initiated",s=t=>!1===t.isEligibleForImmersive?e:t.isImmersiveTranslationsActive?o:a;return{get T(){return n},a:n=>{const o=n?{post:{id:n}}:{};return t.b({source:"translate_button",action:"view",noun:"post_composer"},{action_info:{reason:"on"},...o})},b:n=>t.b({source:"translate_button",action:"view",noun:"comment"},{comment:{...n,translation_state:n.translation_state,translation_language:n.translation_language?n.translation_language:"original"},post:{id:n.post_id??""},action_info:{reason:n.translation_language?t.bm:t.bn}}),c:(n,o)=>t.b({source:"translate_button",action:"click",noun:"comment_composer"},{action_info:{reason:n?"on":"off"},...o?{comment:{id:o}}:{}}),d:(n,o)=>{const a=o?{post:{id:o}}:{};return t.b({source:"translate_button",action:"click",noun:"post_composer"},{action_info:{reason:n?"on":"off"},...a})},e:n=>t.b({source:"translate_button",action:"click",noun:"comment_indicator"},{comment:{...n,translation_state:n.translation_state,translation_language:n.translation_language?n.translation_language:"original"},post:{id:n.post_id??""},action_info:{reason:n.translation_state?t.bU.SEE_ORIGINAL:t.bU.SEE_TRANSLATION}}),f:n=>t.b({source:"translate_button",action:"dismiss",noun:"translation_intervention"},{action_info:{reason:s(n)},comment:{...n.comment},post:n.post}),g:n=>t.b({source:"translate_button",action:"click",noun:"translation_intervention"},{action_info:{reason:s(n),type:n.actionType},comment:{...n.comment},post:n.post}),h:()=>t.b({source:"translate_button",action:"hide",noun:"comment_composer"}),i:()=>t.b({source:"translate_button",action:"hide",noun:"post_composer"}),j:(n,o)=>t.b({source:"translate_button",action:"submit",noun:"post_composer"},{action_info:{reason:n?"on":"off"},...o?{post:{id:o.id,subreddit_id:o.subredditId,subreddit_name:o.subredditPrefixedName,url:o.permalink}}:{}}),k:n=>t.b({source:"translate_button",action:"dismiss",noun:"post_banner"},{action_info:{reason:s(n)},post:{...n.post,translation_state:n.isPostTranslated}}),l:n=>t.b({source:"overflow_menu",action:"click",noun:"translate_survey"},{post:n?.post,comment:n?.comment}),m:n=>t.b({source:"translate_button",action:"view",noun:"survey"},{post:n?.post,comment:n?.comment}),n:n=>t.b({source:"translate_button",action:"dismiss",noun:"survey"},{post:n?.post,comment:n?.comment}),o:n=>t.b({source:"translate_button",action:"submit",noun:"survey"},{action_info:{reason:n.reason},post:n.post,comment:n.comment,survey:{text:n.survey_text}}),p:({comment:n,post:o})=>t.b({source:"translate_button",action:"view",noun:"feedback"},{post:o,comment:n}),q:(n,o,a)=>t.b({source:"translate_button",action:"click",noun:"toggle"},{action_info:{reason:n?"off":"on"},translation_metrics:{translation_setting_state:n?"off":"on",target_language:o},post:a}),r:({comment:n,post:o})=>t.b({source:"translate_button",action:"click",noun:"feedback"},{post:o,comment:n}),s:(n,o)=>t.b({source:"translate_button",action:"click",noun:"show_post_banner"},{action_info:{reason:n?"on":"off"},post:o}),t:n=>t.b({source:"translate_button",action:"view",noun:"comment_composer"},{action_info:{reason:"on"},...n?{comment:{id:n}}:{}}),u:n=>t.b({source:"translate_button",action:"enabled",noun:"status"},{action_info:{reason:n}}),v:n=>t.b({source:"translate_button",action:"disabled",noun:"status"},{action_info:{reason:n}}),w:n=>t.b({source:"overflow_menu",action:"view",noun:"translate_post"},{action_info:{reason:s(n)},post:{...n.post,translation_state:n.isPostTranslated}}),x:(n,o,a)=>t.b({source:"translate_button",action:"submit",noun:"comment_composer"},{action_info:{reason:n?"on":"off"},...o?{post:{id:o.id,language:o.postLanguage,subreddit_id:o.subredditId,subreddit_name:o.subredditPrefixedName,type:o.postType,url:o.permalink}}:{},...a?{comment:{id:a}}:{}}),y:n=>t.b({source:"overflow_menu",action:"view",noun:"translate_comment"},{action_info:{reason:s(n)},comment:{...n.comment,translation_state:n.isCommentTranslated},post:n.post})}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("C_DxBjcqSi",["Dw4vb8Yfbm"],(async a=>{const{svg:t}=a.a();return{t:a.m(t`<path d="M9.45 13.95a1.033 1.033 0 01-.71-.29 1.014 1.014 0 010-1.42 1.033 1.033 0 011.409 0 1 1 0 01-.699 1.71zm.689-9.9A4.987 4.987 0 007.111 5a.853.853 0 00-.1 1.313l.065.061a.832.832 0 001.085.026 2.987 2.987 0 011.752-.658c.8 0 1.245.371 1.245.9 0 .649-.331.94-1.059 1.351a2.772 2.772 0 00-1.333 1.481c-.058.14-.089.288-.093.439 0 .252.099.494.276.673a.89.89 0 00.665.266.913.913 0 00.661-.265.925.925 0 00.227-.422c0-.006.046-.261.046-.267.095-.479.365-.733 1.141-1.134a2.452 2.452 0 001.562-2.29c-.001-1.405-1.1-2.424-3.112-2.424zM13.376 16h2A4.626 4.626 0 0020 11.379V5.621A4.626 4.626 0 0015.379 1H4.621A4.626 4.626 0 000 5.621v5.758A4.626 4.626 0 004.621 16H7.5v-1.25H4.621a3.375 3.375 0 01-3.371-3.371V5.621A3.375 3.375 0 014.621 2.25h10.758a3.375 3.375 0 013.371 3.371v5.758a3.376 3.376 0 01-3.371 3.371h-2.5l-3.763 3.607.866.9L13.376 16z"></path>`,"0 0 20 20","topic-help-outline")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("Can0MElxF6",["Dw4vb8Yfbm","5r73EsgItq"],(async(t,e)=>{let i=class extends e.s{constructor(){super(...arguments),this.replaceFromCache=()=>{this.imgCache&&this.canvasCache?this.freeze?this.replaceChildSafely(this.canvasCache,this.imgCache):this.replaceChildSafely(this.imgCache,this.canvasCache):this.initialize()},this.replaceChildSafely=(t,e)=>{const i=this._slot?.[0];t!==i&&this.replaceChild(t,e)},this.freezeGif=async()=>{const e=this._slot?.[0];if(!this.freeze||this.canvasCache)return void this.shadowRoot?.host.setAttribute("state","ready");const i=document.createElement("canvas");if(!i||!e||"IMG"!==this._slot?.[0].nodeName)return;this.shadowRoot?.host.setAttribute("state","loading"),this.imgCache||(this.imgCache=e),i.width=e.width,i.height=e.height,i.getContext("2d")?.drawImage(e,0,0,i.width,i.height);for(let t=0;t<e.attributes.length;t++){const s=e.attributes[t];"height"!==s.name&&"width"!==s.name&&i.setAttribute(s.name,s.value)}this.canvasCache=i,this.replaceChild(i,e),this.shadowRoot?.host.setAttribute("state","ready");const s=t.c("__TEST-ONLY_faceplate-gif:canvas-rendered");this.dispatchEvent(s),e.removeEventListener("load",this.freezeGif)}}static get styles(){return e.a`:host{display:block}:host([state=ready]){visibility:visible}:host([state=loading]){visibility:hidden}`}updated(t){t.has("freeze")&&this.replaceFromCache()}async initialize(){const t=this._slot?.[0];t?.complete&&t?.naturalWidth>0?this.freezeGif():t?.addEventListener("load",this.freezeGif)}render(){return e.x`<slot @slotchange="${this.initialize}"></slot>`}};t._([t.l({slot:"",flatten:!0})],i.prototype,"_slot",void 0),t._([t.n({type:Boolean})],i.prototype,"freeze",void 0),i=t._([t.e("faceplate-gif")],i)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("CdmJSaSHd8",["Dw4vb8Yfbm"],(async t=>{const{svg:h}=t.a();return{t:t.m(h`<path d="M14.7 2H5.3C3.48 2 2 3.48 2 5.3v9.4C2 16.52 3.48 18 5.3 18h9.4c1.82 0 3.3-1.48 3.3-3.3V5.3C18 3.48 16.52 2 14.7 2zm1.5 12.7c0 .83-.67 1.5-1.5 1.5H5.3c-.83 0-1.5-.67-1.5-1.5V5.3c0-.83.67-1.5 1.5-1.5h9.4c.83 0 1.5.67 1.5 1.5v9.4z"></path><path d="M12 11.1H6v1.8h6v-1.8zM14 7.1H6v1.8h8V7.1z"></path>`,"0 0 20 20","text-post",!0)}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("CfalWt2tl8",["Dw4vb8Yfbm"],(async a=>{const{svg:c}=a.a(),t=a.m(c`<path d="M18.176 14.218l-.925-1.929A2.577 2.577 0 0117 11.184V8c0-3.86-3.141-7-7-7S3 4.14 3 8v3.184c0 .38-.087.762-.251 1.105l-.927 1.932A1.103 1.103 0 002.82 15.8h3.26A4.007 4.007 0 009.999 19a4.008 4.008 0 003.919-3.2h3.26c.381 0 .729-.192.934-.514a1.1 1.1 0 00.062-1.068h.002zM10 17.2c-.93 0-1.722-.583-2.043-1.4h4.087a2.197 2.197 0 01-2.043 1.4H10zm8.584-12.178a.9.9 0 01-.82-.527 8.542 8.542 0 00-2.073-2.827.9.9 0 011.207-1.335 10.386 10.386 0 012.504 3.417.9.9 0 01-.818 1.272zm-17.168 0a.898.898 0 01-.818-1.273A10.385 10.385 0 013.101.332a.9.9 0 011.208 1.335 8.564 8.564 0 00-2.073 2.827.902.902 0 01-.82.528z"></path>`,"0 0 20 20","notifications-active-fill"),{svg:h}=a.a();return{H:"enabled_copy2",a:a.m(h`<path d="M18.176 14.218l-.925-1.929A2.577 2.577 0 0117 11.184V8c0-3.86-3.141-7-7-7S3 4.14 3 8v3.184c0 .38-.087.762-.251 1.105l-.927 1.932A1.103 1.103 0 002.82 15.8h3.26A4.007 4.007 0 009.999 19a4.008 4.008 0 003.919-3.2h3.26c.381 0 .729-.192.934-.514a1.1 1.1 0 00.062-1.068h.002zM10 17.2c-.93 0-1.722-.583-2.043-1.4h4.087a2.197 2.197 0 01-2.043 1.4H10zM3.925 14l.447-.933c.28-.584.429-1.235.429-1.883V8c0-2.867 2.332-5.2 5.199-5.2A5.205 5.205 0 0115.199 8v3.184c0 .648.148 1.299.429 1.883l.447.933H3.925zm14.659-8.978a.9.9 0 01-.82-.527 8.542 8.542 0 00-2.073-2.827.9.9 0 011.207-1.335 10.386 10.386 0 012.504 3.417.9.9 0 01-.818 1.272zm-17.168 0a.898.898 0 01-.818-1.273A10.385 10.385 0 013.101.332a.9.9 0 011.208 1.335 8.564 8.564 0 00-2.073 2.827.902.902 0 01-.82.528z"></path>`,"0 0 20 20","notifications-active"),b:"enabled_copy1",n:t}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./CnDGunUlBx.js",import.meta.url,"CnDGunUlBx");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("Cg9a-Ks_jU",["Dw4vb8Yfbm","5r73EsgItq","CnDGunUlBx","B-zFJtiar6"],(async(e,t,i,a)=>{const r=t.s,n=e=>{e.preventDefault()};let o=class extends r{constructor(){super(...arguments),this.isHamburgerMenuIncluded=!1,this.isLoggedIn=!1,this.showAccountManagerModal=!1,this.hamburgerMenuButton=null,this.menuDialog=null,this.loginButton=void 0,this.shredditInteractableElement=null,this.search=null,this.userDrawerButton=null,this.userDrawerMenu=null,this.userDrawerContent=null,this.userDrawerLoginButton=null,this.advertiseButton=null,this.createAnchor=null,this.recapCampaignLink=void 0,this.mScreenMediaQueryList=window.matchMedia?.("(min-width: 1200px)"),this.cachedIsHamburgerMenuShown=!(this.mScreenMediaQueryList?.matches??1),this.events=new e.E(this),this.googleApiController=new i.G(this),this._track=this.events.define("faceplate-track",(e=>{const{source:t,action:i,noun:a}=e.detail;"nav"===t&&"click"===i&&"create_community"===a&&this._closeDialog()})),this.handleMScreenMediaQueryListChange=({matches:e})=>{e&&this.cachedIsHamburgerMenuShown&&this._closeDialog(),this.cachedIsHamburgerMenuShown=!e},this.handleOpenUserDrawer=t=>{t.stopPropagation(),this._closeDialog(),e.i(this,e.b_())},this.handleCloseUserDrawer=t=>{t?.stopPropagation(),e.i(this,e.b$())},this.setupUserDrawer=async()=>{this.userDrawerButton=this.querySelector("#expand-user-drawer-button"),this.userDrawerMenu=this.userDrawerButton?.closest("rpl-dropdown")??null,this.userDrawerContent=this.querySelector("#user-drawer-content")??null},this.focusSearchInput=()=>{this.search?.shadowRoot?.querySelector("faceplate-search-input")?.focus()},this.handleClickHamburgerMenu=async()=>{await this.initializeHamburgerMenuSlottedElements(),this.menuDialog&&(this.menuDialog.open?this._closeDialog():(this._closeUserDrawer(),this.menuDialog.showModal(),e.i(this,e.bW())),e.i(this,e.bX()))},this.handleSearchDropdownOpen=()=>{this._closeUserDrawer(),this._closeDialog()},this.handleAdvertiseButtonClick=async t=>{const{isAdblockEnabled:i}=await e.cw();if(i){const i=e.c("faceplate-alert",{level:e.a5.notice,message:"To advertise, disable your ad blocker or add reddit.com as an exception."});t.target?.dispatchEvent(i)}},this.initializeHotkeys=()=>{this.hotkeySubscriberController=new e.cx(this),this.hotkeySubscriberController?.subscribe(e.cy.CREATE_POST,this.onHotkeyCreatePost)},this.cleanupHotkeys=()=>{this.hotkeySubscriberController?.unsubscribe(e.cy.CREATE_POST,this.onHotkeyCreatePost)},this.onHotkeyCreatePost=()=>{this.createAnchor?.click()}}_closeDialog(){this.menuDialog?.open&&(this.menuDialog.hide(),this.reset(),e.i(this,e.bV()))}_closeUserDrawer(){this.userDrawerMenu?.hidden||this.userDrawerMenu?.hide()}connectedCallback(){super.connectedCallback(),this.initializeHotkeys()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListenersFromSlottedElements(),this.cleanupHotkeys()}addEventListenersToSlottedElements(){this.mScreenMediaQueryList?.addEventListener("change",this.handleMScreenMediaQueryListChange),this.userDrawerMenu?.addEventListener("rpl-dropdown:show",this.handleOpenUserDrawer),this.userDrawerMenu?.addEventListener("rpl-dropdown:hide",this.handleCloseUserDrawer),this.advertiseButton?.addEventListener("click",this.handleAdvertiseButtonClick)}removeEventListenersFromSlottedElements(){this.mScreenMediaQueryList?.removeEventListener("change",this.handleMScreenMediaQueryListChange),this.userDrawerMenu?.removeEventListener("rpl-dropdown:show",this.handleOpenUserDrawer),this.userDrawerMenu?.removeEventListener("rpl-dropdown:hide",this.handleCloseUserDrawer)}async initializeHamburgerMenuSlottedElements(){this.isHamburgerMenuIncluded&&(this.menuDialog||(this.menuDialog=this.shadowRoot?.querySelector("slot[name=reddit-header-hamburger-menu]")?.assignedElements({flatten:!0})?.find((e=>e.matches("rpl-dialog#menu")))??null))}initializeSlottedElements(){!this.loginButton&&this.showAccountManagerModal&&(this.loginButton=this.querySelector("a#login-button"),this.loginButton?.addEventListener("click",n)),!this.userDrawerLoginButton&&this.showAccountManagerModal&&(this.userDrawerLoginButton=this.querySelector("#login-list-item"),this.userDrawerLoginButton?.addEventListener("click",(()=>{this._closeUserDrawer()}))),this.search||(this.search=this.querySelector("reddit-search-large"),this.search?.addEventListener(a.an,this.handleSearchDropdownOpen)),this.userDrawerButton||this.setupUserDrawer(),this.advertiseButton||(this.advertiseButton=this.querySelector("#advertise-button")),this.createAnchor||(this.createAnchor=this.querySelector("#create-post")),!this.recapCampaignLink&&this.loginButton&&(this.recapCampaignLink=this.querySelector("a#recap-entrypoint"),this.recapCampaignLink?.addEventListener("click",n))}reset(){this.menuDialog?.scrollTo(0,0)}static get styles(){return[e.t]}firstUpdated(){this.initialize()}async initialize(){this.hamburgerMenuButton||(this.hamburgerMenuButton=this.querySelector("#navbar-menu-button"),this.hamburgerMenuButton?.addEventListener("click",this.handleClickHamburgerMenu)),this.initializeSlottedElements(),this.addEventListenersToSlottedElements(),this.isLoggedIn&&this.googleApiController.initialize()}render(){return t.x` ${this.isHamburgerMenuIncluded?t.x`<slot class="v2" name="reddit-header-hamburger-menu"></slot>`:""} <slot class="v2" name="reddit-search-dialog"></slot> <slot></slot> `}};e._([e.n({type:Boolean,attribute:"is-hamburger-menu-included"})],o.prototype,"isHamburgerMenuIncluded",void 0),e._([e.n({type:Boolean,attribute:"is-logged-in"})],o.prototype,"isLoggedIn",void 0),e._([e.n({type:Boolean,attribute:"show-accountmanager-modal"})],o.prototype,"showAccountManagerModal",void 0),o=e._([e.e("reddit-header-large")],o)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("Chd9fEZKZ6",["Dw4vb8Yfbm"],(async a=>{const{svg:o}=a.a();return{o:a.m(o`<path d="M16 11.75a1.75 1.75 0 11.001-3.501A1.75 1.75 0 0116 11.75zM11.75 10a1.75 1.75 0 10-3.501.001A1.75 1.75 0 0011.75 10zm-6 0a1.75 1.75 0 10-3.501.001A1.75 1.75 0 005.75 10z"></path>`,"0 0 20 20","overflow-horizontal")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("ChmOrWWjfU",["Dw4vb8Yfbm","B-zFJtiar6","5r73EsgItq"],(async(t,e,i)=>{let s=class extends i.s{constructor(){super(...arguments),this.isEventListenerAdded=!1}connectedCallback(){super.connectedCallback(),this._ctrl=t.z(this,this,this.onAction.bind(this))}disconnectedCallback(){super.disconnectedCallback(),this.isEventListenerAdded=!1,this._ctrl&&(this._ctrl=t.B(this,this._ctrl)),this?.dialog?.removeEventListener("rpl-dialog:show",this.resetEligibilityContent)}resetEligibilityContent(){const t=document.querySelector("#post-eligibility-content"),e=document.querySelector("#similar-subreddits-content");t?.classList.remove("hidden"),e?.classList.add("hidden")}async onAction(i){t.C(),this.dialog=document.querySelector(`#${e.S}`)||void 0,this.dialog&&(i.preventDefault(),this.isEventListenerAdded||(this.dialog.addEventListener("rpl-dialog:show",this.resetEligibilityContent),this.isEventListenerAdded=!0),await this.dialog.showModal())}createRenderRoot(){return this}};s=t._([t.e("create-post-entry-point-wrapper")],s)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./CEs3hLX56z.js",import.meta.url,"CEs3hLX56z");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./B6Ai7g9fbR.js",import.meta.url,"B6Ai7g9fbR");SML.di("./pA9dwrnd0r.js",import.meta.url,"pA9dwrnd0r");SML.di("./BXUgRcxEAi.js",import.meta.url,"BXUgRcxEAi");SML.di("./h4Pa0OJr_5.js",import.meta.url,"h4Pa0OJr_5");SML.di("./w2XkRJ2mzc.js",import.meta.url,"w2XkRJ2mzc");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./DFh5Z0Dv0L.js",import.meta.url,"DFh5Z0Dv0L");
SML.dm("Cl1pMDH2OX",["Dw4vb8Yfbm","5r73EsgItq","CEs3hLX56z","B-zFJtiar6","B6Ai7g9fbR","pA9dwrnd0r","BXUgRcxEAi","h4Pa0OJr_5","w2XkRJ2mzc","BIzQFHISzm","DFh5Z0Dv0L"],(async(t,e,i,s,r,n,a,o,l,h,d)=>{function c(t){void 0!==window.requestIdleCallback?window.requestIdleCallback(t):window.setTimeout(t,1)}class u{constructor(t){this.fromReconnect=!1,(this.host=t).addController(this)}async hostConnected(){await this._enableAutoplayIfApplicable()}fullscreenChange(){this.trackEvent(t.fc)}pause(){this.trackEvent(t.fd)}play(){this.trackEvent(t.fe)}timeUpdate(){this.trackEvent(t.fi)}volumeChange(){this.trackEvent(t.ff)}seeking(){this.trackEvent(t.fg)}seeked(){this.trackEvent(t.fh)}trackEvent(e){if(!this.host.postPromoted)return;const{currentTime:i,duration:s,muted:r,paused:n,volume:a}=this.host.videoElement,o=this.host.mediaUI?.hasAttribute(t.h9.FULLSCREEN)||!1;let l=!1;e!==t.fh&&e!==t.fg||(l=this.fromReconnect),e===t.fh&&(this.fromReconnect=!1);const h=t.c(e,{currentTime:i,duration:s,fullscreen:o,muted:r,paused:n,timeStamp:Date.now(),volume:a,fromReconnect:l});this.host.dispatchEvent(h)}async _enableAutoplayIfApplicable(){if(!this.host.postPromoted)return;const e=(await t.cw()).isAdblockEnabled;("true"===new URL(t.ep.href).searchParams.get(t.kU)||!e&&this.host.autoplayPref)&&(this.host.autoplay=!0,this.host.syncPerf||this.host.volumeController.initializeVolume(),this.host.mediaVisibilityController.shouldVideoAutoplay()&&(this.host.idleAutoplay?c(this.host.mediaVisibilityController.attemptAutoplay):this.host.mediaVisibilityController.attemptAutoplay()))}}function f({msg:t,error:e,debugOverlay:i}){const s=m(t,e);window.Sentry?window.Sentry.captureMessage?.(s):console.log(s),i?.log("logMessage",s)}function g({msg:t,error:e,debugOverlay:i}){const s=m(t,e);window.Sentry?window.Sentry.captureException?.(s):console.error(s),i?.log("logException",s)}function m(t,e){return["shreddit-player",t,e].filter(Boolean).join(" | ")}let p=class{constructor(e){this._retryCount=0,this._logException=g,this._logMessage=f,this.setMediaErrorCode=e=>{const i=this.host.mediaUI;i&&(i.setAttr(t.h9.ERROR),i.setPausedState(),i.hideLoadingSpinner(),this.mediaErrorCode=e,i.errorOverlay&&(i.errorOverlay.mediaErrorCode=e))},this.handleVideoError=()=>{c((()=>{const t=this.videoElement?.error,{hlsController:e,isHls:i}=this.host;if(t?.code){if(t.code===v.SrcNotSupported&&i&&this._retryCount<5)return this._retryCount+=1,e.initializeHlsJs(),void this._logMessage({msg:`Legacy: Video error, reinitializing Hls.js: [${t.code}] ${t.message}`,debugOverlay:this.host.debugOverlay});this._logException({msg:`Legacy: Irrecoverable video error: [${t.code}] ${t.message}`,debugOverlay:this.host.debugOverlay}),this.setMediaErrorCode(t.code),this.host.telemetryController.error(),this.host.updateSubSession()}}))},this.handleHlsError=async(t,e)=>{const{hlsController:i}=this.host,{hls:s}=i;if(s){if(this._retryCount>=5)return this._logException({msg:`Legacy: HLS error: exceeded max retries: [${e.details}]`,error:e.error,debugOverlay:this.host.debugOverlay}),void this._handleHlsIrrecoverableError(e);switch(this._retryCount+=1,e.type){case"networkError":(e.networkDetails?.status||0)>=500?(this._logException({msg:`Legacy: HLS error: network error: [${e.networkDetails?.status}] [${e.details}]`,error:e.error,debugOverlay:this.host.debugOverlay}),this._handleHlsIrrecoverableError(e)):403===e.networkDetails?.status?(this._logMessage({msg:`Legacy: HLS error: network error: [${e.networkDetails?.status}] [${e.details}]`,error:e.error,debugOverlay:this.host.debugOverlay}),this._handleHlsIrrecoverableError(e)):(this._logMessage({msg:`Legacy: HLS error: network error: [${e.networkDetails?.status}] [${e.details}]`,error:e.error,debugOverlay:this.host.debugOverlay}),this.setMediaErrorCode(v.Network),this.host.telemetryController.error(),s.startLoad());break;case"mediaError":"audioTrackLoadError"===e.details?(this._logMessage({msg:`Legacy: HLS error: audioTrackLoadError, switching to audio track 0: [${e.details}]`,error:e.error,debugOverlay:this.host.debugOverlay}),s.audioTrack=0):(this._logMessage({msg:`Legacy: HLS error: mediaError: [${e.details}]`,error:e.error,debugOverlay:this.host.debugOverlay}),e.fatal&&s.recoverMediaError());break;default:e.fatal&&(this._logException({msg:`Legacy: HLS error: unknown fatal error: [${e.details}]`,error:e.error,debugOverlay:this.host.debugOverlay}),this._handleHlsIrrecoverableError(e))}}},this.resetRetryCount=()=>{this._retryCount=0},(this.host=e).addController(this),this.videoElement=e.videoElement,this.host.errorImprovements}hostConnected(){this.host.errorImprovements||this.videoElement.addEventListener("error",this.handleVideoError)}hostDisconnected(){this.host.errorImprovements||this.videoElement.removeEventListener("error",this.handleVideoError)}_handleHlsIrrecoverableError(t){this._logException({msg:`Legacy: Irrecoverable HLS error: ${t.type} ${t.details}`,debugOverlay:this.host.debugOverlay}),this.host.hlsController.destroyHlsEngine(),this.setMediaErrorCode(v.Network),this.host.telemetryController.error(),this.host.updateSubSession()}};var v;!function(t){t[t.Aborted=1]="Aborted",t[t.Network=2]="Network",t[t.Decode=3]="Decode",t[t.SrcNotSupported=4]="SrcNotSupported"}(v||(v={}));const y=new Map([[MediaError.MEDIA_ERR_ABORTED,0],[MediaError.MEDIA_ERR_NETWORK,3],[MediaError.MEDIA_ERR_DECODE,2],[MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED,0]]),E={NETWORK:["manifestLoadError","levelLoadError","fragLoadError","bufferStalledError"],DECODE:["keyLoadError","bufferAppendingError","fragDecryptError","levelSwitchError","keySystemNoKeys"],UNSUPPORTED:["manifestParsingError"]};class T{constructor(e){this._retryAttempts=new Map,this._activeRecovery=null,this._errorDuringRecovery=!1,this._recoveryTimeouts=new Set,this._logException=g,this._logMessage=f,this.setMediaError=e=>{const i=this.host.mediaUI;i&&(i.setAttr(t.h9.ERROR),i.setPausedState(),i.hideLoadingSpinner(),this.mediaErrorCode=e,i.errorOverlay&&(i.errorOverlay.mediaErrorCode=e))},this.handleVideoError=()=>{let t=this.videoElement.error;t?.code&&(t.code!==MediaError.MEDIA_ERR_ABORTED?this._activeRecovery?this._errorDuringRecovery=!0:c((()=>{if(t=this.videoElement.error,!t?.code)return;const e=this._recoverFromVideoError(t.code,t.message);this._activeRecovery=e,e.finally((()=>{this._activeRecovery===e&&(this._activeRecovery=null)}))})):this.host.pause("scroll"))},this.handleHlsError=(t,e)=>{const{hls:i}=this.host.hlsController;if(!i)return;if(this._activeRecovery)return void(this._errorDuringRecovery=!0);const s=this._mapHlsErrorCode(e),r=this._recoverFromHlsError(s,e);this._activeRecovery=r,r.finally((()=>{this._activeRecovery===r&&(this._activeRecovery=null)}))},this.resetRetryCount=()=>{this._retryAttempts.clear(),this._cleanup()},(this.host=e).addController(this),this.videoElement=e.videoElement}hostConnected(){this.host.errorImprovements&&this.videoElement.addEventListener("error",this.handleVideoError)}hostDisconnected(){this.host.errorImprovements&&(this.videoElement.removeEventListener("error",this.handleVideoError),this._cleanup())}async _recoverFromVideoError(t,e){this._isConnectedAndVisible()?this._hasExceededRetryLimit(t)?this._finalizeError(t,`Video error: [${t}] ${e}`):(t===MediaError.MEDIA_ERR_DECODE&&this._resetVideoElement(),await this._attemptRetry(t,`Video error [${t}]`)):this.host.pause("scroll")}async _recoverFromHlsError(t,e){if(this._isIrrecoverableNetworkError(e))return this._logException({msg:`HLS fatal network error [${e.networkDetails.status}]: ${e.details}`,error:e.error,debugOverlay:this.host.debugOverlay}),void this._finalizeError(t,`HLS error: ${e.type} ${e.details}`,e);this._isConnectedAndVisible()?this._hasExceededRetryLimit(t)?this._finalizeError(t,`HLS error: ${e.type} ${e.details}`,e):(this._applyHlsRecovery(e),await this._attemptRetry(t,`HLS error [${e.details}]`,e)):this.host.pause("scroll")}_isIrrecoverableNetworkError(t){if("networkError"!==t.type||!t.networkDetails?.status)return!1;const e=t.networkDetails.status;return 403===e||e>=500}async _attemptRetry(t,e,i){const s=this._incrementRetry(t),r=y.get(t)??3;if(this._log(`${e} - retry ${s}/${r}`),await this._delay(100),!this._isConnectedAndVisible())return this._log("Stopping recovery - video no longer in viewport"),void this.host.pause("scroll");this._errorDuringRecovery=!1;if((await this._attemptPlayback())&&!this._errorDuringRecovery)return this._log(`Recovery succeeded after ${s} attempt(s)`),void this._retryAttempts.delete(t);s<r?await this._attemptRetry(t,e,i):this._finalizeError(t,`${e} - max retries exhausted`,i)}_resetVideoElement(){const t=this.videoElement.src;this.videoElement.removeAttribute("src"),this.host.load(),this.videoElement.src=t}_applyHlsRecovery(t){const{hls:e}=this.host.hlsController;if(e)switch(t.type){case"networkError":"manifestLoadError"===t.details||"manifestParsingError"===t.details?e.loadSource(this.host.src):e.startLoad();break;case"mediaError":if("audioTrackLoadError"===t.details&&0!==e.audioTrack)e.audioTrack=0;else if(t.fatal)e.recoverMediaError();else if("bufferStalledError"===t.details)return;break;default:e.startLoad()}}async _attemptPlayback(){return this._log("Retrying playback"),new Promise((t=>{let e=!1;const i=()=>{clearTimeout(r),this.videoElement.removeEventListener("playing",s)},s=()=>{e||(e=!0,i(),t(!0))};this.videoElement.addEventListener("playing",s,{once:!0});const r=window.setTimeout((()=>{e||(e=!0,i(),this._log("Playback attempt timed out"),t(!1))}),1500);this.host.play(!0)}))}_mapHlsErrorCode(t){return E.UNSUPPORTED.includes(t.details)?MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:E.NETWORK.includes(t.details)?MediaError.MEDIA_ERR_NETWORK:E.DECODE.includes(t.details)?MediaError.MEDIA_ERR_DECODE:"networkError"===t.type?MediaError.MEDIA_ERR_NETWORK:MediaError.MEDIA_ERR_DECODE}_isConnectedAndVisible(){return!!this.host.isConnected&&(this.host.mediaVisibilityController?.isVideoInView()||this.host.playOutOfViewport)}_hasExceededRetryLimit(t){const e=y.get(t)??3;return(this._retryAttempts.get(t)??0)>=e}_incrementRetry(t){const e=(this._retryAttempts.get(t)??0)+1;return this._retryAttempts.set(t,e),e}_finalizeError(t,e,i){this.host.isConnected&&(this._logException({msg:e,debugOverlay:this.host.debugOverlay}),i&&this.host.hlsController.destroyHlsEngine(),this.setMediaError(t),this.host.telemetryController.error(),this.host.updateSubSession())}_log(t){this._logMessage({msg:t,debugOverlay:this.host.debugOverlay})}_delay(t){return new Promise((e=>{const i=window.setTimeout((()=>{this._recoveryTimeouts.delete(i),e()}),t);this._recoveryTimeouts.add(i)}))}_cleanup(){this._activeRecovery=null,this._recoveryTimeouts.forEach((t=>clearTimeout(t))),this._recoveryTimeouts.clear()}}class S{constructor(t){this.handleClick=()=>{this.host.isMobile&&!this.host.videoElement?.paused&&this.host.userIdleController?.isIdle||this.host.mediaActionsController?.togglePlay()},this.handleDblClick=()=>{this.host.mediaActionsController?.toggleFullscreen()},(this.host=t).addController(this)}hostConnected(){this.host.gif||(this.host.videoElement.addEventListener("click",this.handleClick),this.host.videoElement.addEventListener("dblclick",this.handleDblClick))}hostDisconnected(){this.host.gif||(this.host.videoElement.removeEventListener("click",this.handleClick),this.host.videoElement.removeEventListener("dblclick",this.handleDblClick))}}function b(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var L,A,R,k,C,_={exports:{}};L=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,A=/^(?=([^\/?#]*))\1([^]*)$/,R=/(?:\/|^)\.(?=\/)/g,k=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,_.exports=C={buildAbsoluteURL:function(t,e,i){if(i=i||{},t=t.trim(),!(e=e.trim())){if(!i.alwaysNormalize)return t;var s=C.parseURL(t);if(!s)throw new Error("Error trying to parse base URL.");return s.path=C.normalizePath(s.path),C.buildURLFromParts(s)}var r=C.parseURL(e);if(!r)throw new Error("Error trying to parse relative URL.");if(r.scheme)return i.alwaysNormalize?(r.path=C.normalizePath(r.path),C.buildURLFromParts(r)):e;var n=C.parseURL(t);if(!n)throw new Error("Error trying to parse base URL.");if(!n.netLoc&&n.path&&"/"!==n.path[0]){var a=A.exec(n.path);n.netLoc=a[1],n.path=a[2]}n.netLoc&&!n.path&&(n.path="/");var o={scheme:n.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};if(!r.netLoc&&(o.netLoc=n.netLoc,"/"!==r.path[0]))if(r.path){var l=n.path,h=l.substring(0,l.lastIndexOf("/")+1)+r.path;o.path=C.normalizePath(h)}else o.path=n.path,r.params||(o.params=n.params,r.query||(o.query=n.query));return null===o.path&&(o.path=i.alwaysNormalize?C.normalizePath(r.path):r.path),C.buildURLFromParts(o)},parseURL:function(t){var e=L.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(R,"");t.length!==(t=t.replace(k,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};var I=_.exports;function D(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function w(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?D(Object(i),!0).forEach((function(e){x(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):D(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function P(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,e||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}function x(t,e,i){return(e=P(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function M(){return M=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},M.apply(this,arguments)}const O=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},F=Number.isSafeInteger||function(t){return"number"==typeof t&&Math.abs(t)<=N},N=Number.MAX_SAFE_INTEGER||9007199254740991;let U=function(t){return t.MEDIA_ATTACHING="hlsMediaAttaching",t.MEDIA_ATTACHED="hlsMediaAttached",t.MEDIA_DETACHING="hlsMediaDetaching",t.MEDIA_DETACHED="hlsMediaDetached",t.BUFFER_RESET="hlsBufferReset",t.BUFFER_CODECS="hlsBufferCodecs",t.BUFFER_CREATED="hlsBufferCreated",t.BUFFER_APPENDING="hlsBufferAppending",t.BUFFER_APPENDED="hlsBufferAppended",t.BUFFER_EOS="hlsBufferEos",t.BUFFER_FLUSHING="hlsBufferFlushing",t.BUFFER_FLUSHED="hlsBufferFlushed",t.MANIFEST_LOADING="hlsManifestLoading",t.MANIFEST_LOADED="hlsManifestLoaded",t.MANIFEST_PARSED="hlsManifestParsed",t.LEVEL_SWITCHING="hlsLevelSwitching",t.LEVEL_SWITCHED="hlsLevelSwitched",t.LEVEL_LOADING="hlsLevelLoading",t.LEVEL_LOADED="hlsLevelLoaded",t.LEVEL_UPDATED="hlsLevelUpdated",t.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",t.LEVELS_UPDATED="hlsLevelsUpdated",t.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",t.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",t.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",t.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",t.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",t.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",t.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",t.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",t.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",t.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",t.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",t.CUES_PARSED="hlsCuesParsed",t.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",t.INIT_PTS_FOUND="hlsInitPtsFound",t.FRAG_LOADING="hlsFragLoading",t.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",t.FRAG_LOADED="hlsFragLoaded",t.FRAG_DECRYPTED="hlsFragDecrypted",t.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",t.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",t.FRAG_PARSING_METADATA="hlsFragParsingMetadata",t.FRAG_PARSED="hlsFragParsed",t.FRAG_BUFFERED="hlsFragBuffered",t.FRAG_CHANGED="hlsFragChanged",t.FPS_DROP="hlsFpsDrop",t.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",t.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",t.ERROR="hlsError",t.DESTROYING="hlsDestroying",t.KEY_LOADING="hlsKeyLoading",t.KEY_LOADED="hlsKeyLoaded",t.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",t.BACK_BUFFER_REACHED="hlsBackBufferReached",t.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",t}({}),$=function(t){return t.NETWORK_ERROR="networkError",t.MEDIA_ERROR="mediaError",t.KEY_SYSTEM_ERROR="keySystemError",t.MUX_ERROR="muxError",t.OTHER_ERROR="otherError",t}({}),B=function(t){return t.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",t.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",t.KEY_SYSTEM_NO_SESSION="keySystemNoSession",t.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",t.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",t.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",t.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",t.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",t.MANIFEST_LOAD_ERROR="manifestLoadError",t.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",t.MANIFEST_PARSING_ERROR="manifestParsingError",t.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",t.LEVEL_EMPTY_ERROR="levelEmptyError",t.LEVEL_LOAD_ERROR="levelLoadError",t.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",t.LEVEL_PARSING_ERROR="levelParsingError",t.LEVEL_SWITCH_ERROR="levelSwitchError",t.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",t.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",t.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",t.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",t.FRAG_LOAD_ERROR="fragLoadError",t.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",t.FRAG_DECRYPT_ERROR="fragDecryptError",t.FRAG_PARSING_ERROR="fragParsingError",t.FRAG_GAP="fragGap",t.REMUX_ALLOC_ERROR="remuxAllocError",t.KEY_LOAD_ERROR="keyLoadError",t.KEY_LOAD_TIMEOUT="keyLoadTimeOut",t.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",t.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",t.BUFFER_APPEND_ERROR="bufferAppendError",t.BUFFER_APPENDING_ERROR="bufferAppendingError",t.BUFFER_STALLED_ERROR="bufferStalledError",t.BUFFER_FULL_ERROR="bufferFullError",t.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",t.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",t.INTERNAL_EXCEPTION="internalException",t.INTERNAL_ABORTED="aborted",t.UNKNOWN="unknown",t}({});const G=function(){},H={trace:G,debug:G,log:G,warn:G,info:G,error:G};let V=H;function K(t,...e){e.forEach((function(e){V[e]=t[e]?t[e].bind(t):function(t){const e=self.console[t];return e?e.bind(self.console,`[${t}] >`):G}(e)}))}const j=V,W=/^(\d+)x(\d+)$/,z=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Y{constructor(t){"string"==typeof t&&(t=Y.parseAttrList(t)),M(this,t)}get clientAttrs(){return Object.keys(this).filter((t=>"X-"===t.substring(0,2)))}decimalInteger(t){const e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e}hexadecimalInteger(t){if(this[t]){let e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;const i=new Uint8Array(e.length/2);for(let t=0;t<e.length/2;t++)i[t]=parseInt(e.slice(2*t,2*t+2),16);return i}return null}hexadecimalIntegerAsNumber(t){const e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,e){const i=this[t];return i?parseFloat(i):e}enumeratedString(t){return this[t]}bool(t){return"YES"===this[t]}decimalResolution(t){const e=W.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}}static parseAttrList(t){let e;const i={};for(z.lastIndex=0;null!==(e=z.exec(t));){let t=e[2];0===t.indexOf('"')&&t.lastIndexOf('"')===t.length-1&&(t=t.slice(1,-1));i[e[1].trim()]=t}return i}}function q(t){return"SCTE35-OUT"===t||"SCTE35-IN"===t}class X{constructor(t,e){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,e){const i=e.attr;for(const e in i)if(Object.prototype.hasOwnProperty.call(t,e)&&t[e]!==i[e]){j.warn(`DATERANGE tag attribute: "${e}" does not match for tags with ID: "${t.ID}"`),this._badValueForSameId=e;break}t=M(new Y({}),i,t)}if(this.attr=t,this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){const t=new Date(this.attr["END-DATE"]);O(t.getTime())&&(this._endDate=t)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const t=this.duration;return null!==t?new Date(this._startDate.getTime()+1e3*t):null}get duration(){if("DURATION"in this.attr){const t=this.attr.decimalFloatingPoint("DURATION");if(O(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&O(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class Q{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var J="audio",Z="video",tt="audiovideo";class et{constructor(t){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[J]:null,[Z]:null,[tt]:null},this.baseurl=t}setByteRange(t,e){const i=t.split("@",2);let s;s=1===i.length?(null==e?void 0:e.byteRangeEndOffset)||0:parseInt(i[1]),this._byteRange=[s,parseInt(i[0])+s]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=I.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}}class it extends et{constructor(t,e){super(e),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new Q,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=t}get decryptdata(){const{levelkeys:t}=this;if(!t&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const t=Object.keys(this.levelkeys);if(1===t.length)return this._decryptdata=this.levelkeys[t[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;if(!O(this.programDateTime))return null;const t=O(this.duration)?this.duration:0;return this.programDateTime+1e3*t}get encrypted(){var t;if(null!=(t=this._decryptdata)&&t.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),e=t.length;if(e>1||1===e&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(t){if(this.levelkeys){const e=this.levelkeys[t];e&&!this._decryptdata&&(this._decryptdata=e.getDecryptData(this.sn))}}abortRequests(){var t,e;null==(t=this.loader)||t.abort(),null==(e=this.keyLoader)||e.abort()}setElementaryStreamInfo(t,e,i,s,r,n=!1){const{elementaryStreams:a}=this,o=a[t];o?(o.startPTS=Math.min(o.startPTS,e),o.endPTS=Math.max(o.endPTS,i),o.startDTS=Math.min(o.startDTS,s),o.endDTS=Math.max(o.endDTS,r)):a[t]={startPTS:e,endPTS:i,startDTS:s,endDTS:r,partial:n}}clearElementaryStreamInfo(){const{elementaryStreams:t}=this;t[J]=null,t[Z]=null,t[tt]=null}}class st extends et{constructor(t,e,i,s,r){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new Q,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=e,this.index=s;const n=t.enumeratedString("BYTERANGE");n&&this.setByteRange(n,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:t}=this;return!!(t.audio||t.video||t.audiovideo)}}class rt{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){if(!t)return this.advanced=!0,void(this.updated=!0);const e=this.lastPartSn-t.lastPartSn,i=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!i||!!e||!this.live,this.advanced=this.endSN>t.endSN||e>0||0===e&&i>0,this.updated||this.advanced?this.misses=Math.floor(.6*t.misses):this.misses=t.misses+1,this.availabilityDelay=t.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&O(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const t=this.driftEndTime-this.driftStartTime;if(t>0){return 1e3*(this.driftEnd-this.driftStart)/t}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var t;return null!=(t=this.fragments)&&t.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function nt(t){return Uint8Array.from(atob(t),(t=>t.charCodeAt(0)))}function at(t){const e=t.split(":");let i=null;if("data"===e[0]&&2===e.length){const t=e[1].split(";"),s=t[t.length-1].split(",");if(2===s.length){const e="base64"===s[0],r=s[1];e?(t.splice(-1,1),i=nt(r)):i=function(t){const e=ot(t).subarray(0,16),i=new Uint8Array(16);return i.set(e,16-e.length),i}(r)}}return i}function ot(t){return Uint8Array.from(unescape(encodeURIComponent(t)),(t=>t.charCodeAt(0)))}const lt="undefined"!=typeof self?self:void 0;var ht={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},dt="org.w3.clearkey",ct="com.apple.streamingkeydelivery",ut="com.microsoft.playready",ft="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function gt(t){switch(t){case ct:return ht.FAIRPLAY;case ut:return ht.PLAYREADY;case ft:return ht.WIDEVINE;case dt:return ht.CLEARKEY}}var mt="edef8ba979d64acea3c827dcd51d21ed";function pt(t){switch(t){case ht.FAIRPLAY:return ct;case ht.PLAYREADY:return ut;case ht.WIDEVINE:return ft;case ht.CLEARKEY:return dt}}function vt(t){const{drmSystems:e,widevineLicenseUrl:i}=t,s=e?[ht.FAIRPLAY,ht.WIDEVINE,ht.PLAYREADY,ht.CLEARKEY].filter((t=>!!e[t])):[];return!s[ht.WIDEVINE]&&i&&s.push(ht.WIDEVINE),s}const yt=null!=lt&&null!=(Et=lt.navigator)&&Et.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;var Et;function Tt(t,e,i){return Uint8Array.prototype.slice?t.slice(e,i):new Uint8Array(Array.prototype.slice.call(t,e,i))}const St=(t,e)=>e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128,bt=(t,e)=>e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128,Lt=(t,e)=>{const i=e;let s=0;for(;St(t,e);){s+=10;s+=At(t,e+6),bt(t,e+10)&&(s+=10),e+=s}if(s>0)return t.subarray(i,i+s)},At=(t,e)=>{let i=0;return i=(127&t[e])<<21,i|=(127&t[e+1])<<14,i|=(127&t[e+2])<<7,i|=127&t[e+3],i},Rt=(t,e)=>St(t,e)&&At(t,e+6)+10<=t.length-e,kt=t=>{const e=It(t);for(let t=0;t<e.length;t++){const i=e[t];if(Ct(i))return Mt(i)}},Ct=t=>t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info,_t=t=>{const e=String.fromCharCode(t[0],t[1],t[2],t[3]),i=At(t,4);return{type:e,size:i,data:t.subarray(10,10+i)}},It=t=>{let e=0;const i=[];for(;St(t,e);){const s=At(t,e+6);e+=10;const r=e+s;for(;e+8<r;){const s=_t(t.subarray(e)),r=Dt(s);r&&i.push(r),e+=s.size+10}bt(t,e)&&(e+=10)}return i},Dt=t=>"PRIV"===t.type?wt(t):"W"===t.type[0]?xt(t):Pt(t),wt=t=>{if(t.size<2)return;const e=Ot(t.data,!0),i=new Uint8Array(t.data.subarray(e.length+1));return{key:t.type,info:e,data:i.buffer}},Pt=t=>{if(t.size<2)return;if("TXXX"===t.type){let e=1;const i=Ot(t.data.subarray(e),!0);e+=i.length+1;const s=Ot(t.data.subarray(e));return{key:t.type,info:i,data:s}}const e=Ot(t.data.subarray(1));return{key:t.type,data:e}},xt=t=>{if("WXXX"===t.type){if(t.size<2)return;let e=1;const i=Ot(t.data.subarray(e),!0);e+=i.length+1;const s=Ot(t.data.subarray(e));return{key:t.type,info:i,data:s}}const e=Ot(t.data);return{key:t.type,data:e}},Mt=t=>{if(8===t.data.byteLength){const e=new Uint8Array(t.data),i=1&e[3];let s=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return s/=45,i&&(s+=47721858.84),Math.round(s)}},Ot=(t,e=!1)=>{const i=Nt();if(i){const s=i.decode(t);if(e){const t=s.indexOf("\0");return-1!==t?s.substring(0,t):s}return s.replace(/\0/g,"");}const s=t.length;let r,n,a,o="",l=0;for(;l<s;){if(r=t[l++],0===r&&e)return o;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(r);break;case 12:case 13:n=t[l++],o+=String.fromCharCode((31&r)<<6|63&n);break;case 14:n=t[l++],a=t[l++],o+=String.fromCharCode((15&r)<<12|(63&n)<<6|63&a)}}return o};let Ft;function Nt(){if(!navigator.userAgent.includes("PlayStation 4"))return Ft||void 0===self.TextDecoder||(Ft=new self.TextDecoder("utf-8")),Ft}const Ut=function(t){let e="";for(let i=0;i<t.length;i++){let s=t[i].toString(16);s.length<2&&(s="0"+s),e+=s}return e},$t=Math.pow(2,32)-1,Bt=[].push,Gt={video:1,audio:2,id3:3,text:4};function Ht(t){return String.fromCharCode.apply(null,t)}function Vt(t,e){const i=t[e]<<8|t[e+1];return i<0?65536+i:i}function Kt(t,e){const i=Wt(t,e);return i<0?4294967296+i:i}function jt(t,e){let i=Kt(t,e);return i*=Math.pow(2,32),i+=Kt(t,e+4),i}function Wt(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function zt(t,e,i){t[e]=i>>24,t[e+1]=i>>16&255,t[e+2]=i>>8&255,t[e+3]=255&i}function Yt(t,e){const i=[];if(!e.length)return i;const s=t.byteLength;for(let r=0;r<s;){const n=Kt(t,r),a=n>1?r+n:s;if(Ht(t.subarray(r+4,r+8))===e[0])if(1===e.length)i.push(t.subarray(r+8,a));else{const s=Yt(t.subarray(r+8,a),e.slice(1));s.length&&Bt.apply(i,s)}r=a}return i}function qt(t){const e=[],i=t[0];let s=8;const r=Kt(t,s);s+=4;let n=0,a=0;0===i?(n=Kt(t,s),a=Kt(t,s+4),s+=8):(n=jt(t,s),a=jt(t,s+8),s+=16),s+=2;let o=t.length+a;const l=Vt(t,s);s+=2;for(let i=0;i<l;i++){let i=s;const n=Kt(t,i);i+=4;const a=2147483647&n;if(1===(2147483648&n)>>>31)return j.warn("SIDX has hierarchical references (not supported)"),null;const l=Kt(t,i);i+=4,e.push({referenceSize:a,subsegmentDuration:l,info:{duration:l/r,start:o,end:o+a-1}}),o+=a,i+=4,s=i}return{earliestPresentationTime:n,timescale:r,version:i,referencesCount:l,references:e}}function Xt(t){const e=[],i=Yt(t,["moov","trak"]);for(let t=0;t<i.length;t++){const s=i[t],r=Yt(s,["tkhd"])[0];if(r){let t=r[0];const i=Kt(r,0===t?12:20),n=Yt(s,["mdia","mdhd"])[0];if(n){t=n[0];const r=Kt(n,0===t?12:20),a=Yt(s,["mdia","hdlr"])[0];if(a){const t=Ht(a.subarray(8,12)),n={soun:J,vide:Z}[t];if(n){const t=Qt(Yt(s,["mdia","minf","stbl","stsd"])[0]);e[i]={timescale:r,type:n},e[n]=w({timescale:r,id:i},t)}}}}}return Yt(t,["moov","mvex","trex"]).forEach((t=>{const i=Kt(t,4),s=e[i];s&&(s.default={duration:Kt(t,12),flags:Kt(t,20)})})),e}function Qt(t){const e=t.subarray(8),i=e.subarray(86),s=Ht(e.subarray(4,8));let r=s;const n="enca"===s||"encv"===s;if(n){const t=Yt(e,[s])[0];Yt(t.subarray("enca"===s?28:78),["sinf"]).forEach((t=>{const e=Yt(t,["schm"])[0];if(e){const i=Ht(e.subarray(4,8));if("cbcs"===i||"cenc"===i){const e=Yt(t,["frma"])[0];e&&(r=Ht(e))}}}))}switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const t=Yt(i,["avcC"])[0];r+="."+Zt(t[1])+Zt(t[2])+Zt(t[3]);break}case"mp4a":{const t=Yt(e,[s])[0],i=Yt(t.subarray(28),["esds"])[0];if(i&&i.length>12){let t=4;if(3!==i[t++])break;t=Jt(i,t),t+=2;const e=i[t++];if(128&e&&(t+=2),64&e&&(t+=i[t++]),4!==i[t++])break;t=Jt(i,t);const s=i[t++];if(64!==s)break;if(r+="."+Zt(s),t+=12,5!==i[t++])break;t=Jt(i,t);const n=i[t++];let a=(248&n)>>3;31===a&&(a+=1+((7&n)<<3)+((224&i[t])>>5)),r+="."+a}break}case"hvc1":case"hev1":{const t=Yt(i,["hvcC"])[0],e=t[1],s=["","A","B","C"][e>>6],n=31&e,a=Kt(t,2),o=(32&e)>>5?"H":"L",l=t[12],h=t.subarray(6,12);r+="."+s+n,r+="."+a.toString(16).toUpperCase(),r+="."+o+l;let d="";for(let t=h.length;t--;){const e=h[t];if(e||d){d="."+e.toString(16).toUpperCase()+d}}r+=d;break}case"dvh1":case"dvhe":{const t=Yt(i,["dvcC"])[0],e=t[2]>>1&127,s=t[2]<<5&32|t[3]>>3&31;r+="."+te(e)+"."+te(s);break}case"vp09":{const t=Yt(i,["vpcC"])[0],e=t[4],s=t[5],n=t[6]>>4&15;r+="."+te(e)+"."+te(s)+"."+te(n);break}case"av01":{const t=Yt(i,["av1C"])[0],e=t[1]>>>5,s=31&t[1],n=t[2]>>>7?"H":"M",a=(64&t[2])>>6,o=(32&t[2])>>5,l=2===e&&a?o?12:10:a?10:8,h=(16&t[2])>>4,d=(8&t[2])>>3,c=(4&t[2])>>2,u=3&t[2],f=1,g=1,m=1,p=0;r+="."+e+"."+te(s)+n+"."+te(l)+"."+h+"."+d+c+u+"."+te(f)+"."+te(g)+"."+te(m)+"."+p;break}}return{codec:r,encrypted:n}}function Jt(t,e){const i=e+5;for(;128&t[e++]&&e<i;);return e}function Zt(t){return("0"+t.toString(16).toUpperCase()).slice(-2)}function te(t){return(t<10?"0":"")+t}function ee(t){const e=Yt(t,["schm"])[0];if(e){const i=Ht(e.subarray(4,8));if("cbcs"===i||"cenc"===i)return Yt(t,["schi","tenc"])[0]}return j.error("[eme] missing 'schm' box"),null}function ie(t){const e=Kt(t,0);let i=8;1&e&&(i+=4),4&e&&(i+=4);let s=0;const r=Kt(t,4);for(let n=0;n<r;n++){if(256&e){s+=Kt(t,i),i+=4}512&e&&(i+=4),1024&e&&(i+=4),2048&e&&(i+=4)}return s}function se(t,e){const i=new Uint8Array(t.length+e.length);return i.set(t),i.set(e,t.length),i}function re(t,e){const i=[],s=e.samples,r=e.timescale,n=e.id;let a=!1;return Yt(s,["moof"]).map((o=>{const l=o.byteOffset-8;Yt(o,["traf"]).map((o=>{const h=Yt(o,["tfdt"]).map((t=>{const e=t[0];let i=Kt(t,4);return 1===e&&(i*=Math.pow(2,32),i+=Kt(t,8)),i/r}))[0];return void 0!==h&&(t=h),Yt(o,["tfhd"]).map((h=>{const d=Kt(h,4),c=16777215&Kt(h,0);let u=0;const f=!!(16&c);let g=0;const m=!!(32&c);let p=8;d===n&&(!!(1&c)&&(p+=8),!!(2&c)&&(p+=4),!!(8&c)&&(u=Kt(h,p),p+=4),f&&(g=Kt(h,p),p+=4),m&&(p+=4),"video"===e.type&&(a=function(t){if(!t)return!1;const e=t.indexOf("."),i=e<0?t:t.substring(0,e);return"hvc1"===i||"hev1"===i||"dvh1"===i||"dvhe"===i}(e.codec)),Yt(o,["trun"]).map((n=>{const o=n[0],h=16777215&Kt(n,0),d=!!(1&h);let c=0;const f=!!(4&h),m=!!(256&h);let p=0;const v=!!(512&h);let y=0;const E=!!(1024&h),T=!!(2048&h);let S=0;const b=Kt(n,4);let L=8;d&&(c=Kt(n,L),L+=4),f&&(L+=4);let A=c+l;for(let l=0;l<b;l++){if(m?(p=Kt(n,L),L+=4):p=u,v?(y=Kt(n,L),L+=4):y=g,E&&(L+=4),T&&(S=0===o?Kt(n,L):Wt(n,L),L+=4),e.type===Z){let e=0;for(;e<y;){const n=Kt(s,A);if(A+=4,ne(a,s[A])){ae(s.subarray(A,A+n),a?2:1,t+S/r,i)}A+=n,e+=n+4}}t+=p/r}})))}))}))})),i}function ne(t,e){if(t){const t=e>>1&63;return 39===t||40===t}return 6===(31&e)}function ae(t,e,i,s){const r=oe(t);let n=0;n+=e;let a=0,o=0,l=0;for(;n<r.length;){a=0;do{if(n>=r.length)break;l=r[n++],a+=l}while(255===l);o=0;do{if(n>=r.length)break;l=r[n++],o+=l}while(255===l);const t=r.length-n;let e=n;if(o<t)n+=o;else if(o>t){j.error(`Malformed SEI payload. ${o} is too small, only ${t} bytes left to parse.`);break}if(4===a){if(181===r[e++]){const t=Vt(r,e);if(e+=2,49===t){const t=Kt(r,e);if(e+=4,1195456820===t){const t=r[e++];if(3===t){const n=r[e++],o=64&n,l=o?2+3*(31&n):0,h=new Uint8Array(l);if(o){h[0]=n;for(let t=1;t<l;t++)h[t]=r[e++]}s.push({type:t,payloadType:a,pts:i,bytes:h})}}}}}else if(5===a&&o>16){const t=[];for(let i=0;i<16;i++){const s=r[e++].toString(16);t.push(1==s.length?"0"+s:s),3!==i&&5!==i&&7!==i&&9!==i||t.push("-")}const n=o-16,l=new Uint8Array(n);for(let t=0;t<n;t++)l[t]=r[e++];s.push({payloadType:a,pts:i,uuid:t.join(""),userData:Ot(l),userDataBytes:l})}}}function oe(t){const e=t.byteLength,i=[];let s=1;for(;s<e-2;)0===t[s]&&0===t[s+1]&&3===t[s+2]?(i.push(s+2),s+=2):s++;if(0===i.length)return t;const r=e-i.length,n=new Uint8Array(r);let a=0;for(s=0;s<r;a++,s++)a===i[0]&&(a++,i.shift()),n[s]=t[a];return n}function le(t,e,i){if(16!==t.byteLength)throw new RangeError("Invalid system id");let s,r,n;s=0,r=new Uint8Array,n=new Uint8Array;const a=new Uint8Array(4);return i&&i.byteLength>0&&new DataView(a.buffer).setUint32(0,i.byteLength,!1),function(t,...e){const i=e.length;let s=8,r=i;for(;r--;)s+=e[r].byteLength;const n=new Uint8Array(s);for(n[0]=s>>24&255,n[1]=s>>16&255,n[2]=s>>8&255,n[3]=255&s,n.set(t,4),r=0,s=8;r<i;r++)n.set(e[r],s),s+=e[r].byteLength;return n}([112,115,115,104],new Uint8Array([0,0,0,0]),t,n,r,a,i||new Uint8Array)}let he={};class de{static clearKeyUriToKeyIdMap(){he={}}constructor(t,e,i,s=[1],r=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=e,this.keyFormat=i,this.keyFormatVersions=s,this.iv=r,this.encrypted=!!t&&"NONE"!==t,this.isCommonEncryption=this.encrypted&&"AES-128"!==t}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case ct:case ft:case ut:case dt:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(t){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof t&&("AES-128"!==this.method||this.iv||j.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),t=0);const e=function(t){const e=new Uint8Array(16);for(let i=12;i<16;i++)e[i]=t>>8*(15-i)&255;return e}(t);return new de(this.method,this.uri,"identity",this.keyFormatVersions,e)}const e=at(this.uri);if(e)switch(this.keyFormat){case ft:this.pssh=e,e.length>=22&&(this.keyId=e.subarray(e.length-22,e.length-6));break;case ut:{const t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=le(t,0,e);const i=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),s=String.fromCharCode.apply(null,Array.from(i)),r=s.substring(s.indexOf("<"),s.length),n=(new DOMParser).parseFromString(r,"text/xml").getElementsByTagName("KID")[0];if(n){const t=n.childNodes[0]?n.childNodes[0].nodeValue:n.getAttribute("VALUE");if(t){const e=nt(t).subarray(0,16);!function(t){const e=function(t,e,i){const s=t[e];t[e]=t[i],t[i]=s};e(t,0,3),e(t,1,2),e(t,4,5),e(t,6,7)}(e),this.keyId=e}}break}default:{let t=e.subarray(0,16);if(16!==t.length){const e=new Uint8Array(16);e.set(t,16-t.length),t=e}this.keyId=t;break}}if(!this.keyId||16!==this.keyId.byteLength){let t=he[this.uri];if(!t){const e=Object.keys(he).length%Number.MAX_SAFE_INTEGER;t=new Uint8Array(16);new DataView(t.buffer,12,4).setUint32(0,e),he[this.uri]=t}this.keyId=t}return this}}const ce=/\{\$([a-zA-Z0-9-_]+)\}/g;function ue(t){return ce.test(t)}function fe(t,e,i){if(null!==t.variableList||t.hasVariableRefs)for(let s=i.length;s--;){const r=i[s],n=e[r];n&&(e[r]=ge(t,n))}}function ge(t,e){if(null!==t.variableList||t.hasVariableRefs){const i=t.variableList;return e.replace(ce,(e=>{const s=e.substring(2,e.length-1),r=null==i?void 0:i[s];return void 0===r?(t.playlistParsingError||(t.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),e):r}))}return e}function me(t,e,i){let s,r,n=t.variableList;if(n||(t.variableList=n={}),"QUERYPARAM"in e){s=e.QUERYPARAM;try{const t=new self.URL(i).searchParams;if(!t.has(s))throw new Error(`"${s}" does not match any query parameter in URI: "${i}"`);r=t.get(s)}catch(e){t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${e.message}`))}}else s=e.NAME,r=e.VALUE;s in n?t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):n[s]=r||""}function pe(t,e,i){const s=e.IMPORT;if(i&&s in i){let e=t.variableList;e||(t.variableList=e={}),e[s]=i[s]}else t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${s}"`))}function ve(t=!0){if("undefined"==typeof self)return;return(t||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}const ye={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Ee(t,e,i=!0){return!t.split(",").some((t=>!Te(t,e,i)))}function Te(t,e,i=!0){var s;const r=ve(i);return null!=(s=null==r?void 0:r.isTypeSupported(Se(t,e)))&&s}function Se(t,e){return`${e}/mp4;codecs="${t}"`}function be(t){if(t){const e=t.substring(0,4);return ye.video[e]}return 2}function Le(t){return t.split(",").reduce(((t,e)=>{const i=ye.video[e];return i?(2*i+t)/(t?3:2):(ye.audio[e]+t)/(t?2:1)}),0)}const Ae={};const Re=/flac|opus/i;function ke(t,e=!0){return t.replace(Re,(t=>(function(t, e=!0) {if(Ae[t])return Ae[t];const i={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[t];for(let s=0;s<i.length;s++)if(Te(i[s],"audio",e))return Ae[t]=i[s],i[s];return t})(t.toLowerCase(),e)));}function Ce(t,e){return t&&"mp4a"!==t?t:e?e.split(",")[0]:e}const _e=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Ie=/#EXT-X-MEDIA:(.*)/g,De=/^#EXT(?:INF|-X-TARGETDURATION):/m,we=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),Pe=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class xe{static findGroup(t,e){for(let i=0;i<t.length;i++){const s=t[i];if(s.id===e)return s}}static resolve(t,e){return I.buildAbsoluteURL(e,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return De.test(t)}static parseMasterPlaylist(t,e){const i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:ue(t)},s=[];let r;for(_e.lastIndex=0;null!=(r=_e.exec(t));)if(r[1]){var n;const t=new Y(r[1]);fe(i,t,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const a=ge(i,r[2]),o={attrs:t,bitrate:t.decimalInteger("BANDWIDTH")||t.decimalInteger("AVERAGE-BANDWIDTH"),name:t.NAME,url:xe.resolve(a,e)},l=t.decimalResolution("RESOLUTION");l&&(o.width=l.width,o.height=l.height),Fe(t.CODECS,o),null!=(n=o.unknownCodecs)&&n.length||s.push(o),i.levels.push(o)}else if(r[3]){const t=r[3],s=r[4];switch(t){case"SESSION-DATA":{const t=new Y(s);fe(i,t,["DATA-ID","LANGUAGE","VALUE","URI"]);const e=t["DATA-ID"];e&&(null===i.sessionData&&(i.sessionData={}),i.sessionData[e]=t);break}case"SESSION-KEY":{const t=Me(s,e,i);t.encrypted&&t.isSupported()?(null===i.sessionKeys&&(i.sessionKeys=[]),i.sessionKeys.push(t)):j.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${s}"`);break}case"DEFINE":{const t=new Y(s);fe(i,t,["NAME","VALUE","QUERYPARAM"]),me(i,t,e)}break;case"CONTENT-STEERING":{const t=new Y(s);fe(i,t,["SERVER-URI","PATHWAY-ID"]),i.contentSteering={uri:xe.resolve(t["SERVER-URI"],e),pathwayId:t["PATHWAY-ID"]||"."};break}case"START":i.startTimeOffset=Oe(s)}}const a=s.length>0&&s.length<i.levels.length;return i.levels=a?s:i.levels,0===i.levels.length&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(t,e,i){let s;const r={},n=i.levels,a={AUDIO:n.map((t=>({id:t.attrs.AUDIO,audioCodec:t.audioCodec}))),SUBTITLES:n.map((t=>({id:t.attrs.SUBTITLES,textCodec:t.textCodec}))),"CLOSED-CAPTIONS":[]};let o=0;for(Ie.lastIndex=0;null!==(s=Ie.exec(t));){const t=new Y(s[1]),n=t.TYPE;if(n){const s=a[n],l=r[n]||[];r[n]=l,fe(i,t,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const h=t.LANGUAGE,d=t["ASSOC-LANGUAGE"],c=t.CHANNELS,u=t.CHARACTERISTICS,f=t["INSTREAM-ID"],g={attrs:t,bitrate:0,id:o++,groupId:t["GROUP-ID"]||"",name:t.NAME||h||"",type:n,default:t.bool("DEFAULT"),autoselect:t.bool("AUTOSELECT"),forced:t.bool("FORCED"),lang:h,url:t.URI?xe.resolve(t.URI,e):""};if(d&&(g.assocLang=d),c&&(g.channels=c),u&&(g.characteristics=u),f&&(g.instreamId=f),null!=s&&s.length){const t=xe.findGroup(s,g.groupId)||s[0];Ne(g,t,"audioCodec"),Ne(g,t,"textCodec")}l.push(g)}}return r}static parseLevelPlaylist(t,e,i,s,r,n){const a=new rt(e),o=a.fragments;let l,h,d,c=null,u=0,f=0,g=0,m=0,p=null,v=new it(s,e),y=-1,E=!1,T=null;for(we.lastIndex=0,a.m3u8=t,a.hasVariableRefs=ue(t);null!==(l=we.exec(t));){E&&(E=!1,v=new it(s,e),v.start=g,v.sn=u,v.cc=m,v.level=i,c&&(v.initSegment=c,v.rawProgramDateTime=c.rawProgramDateTime,c.rawProgramDateTime=null,T&&(v.setByteRange(T),T=null)));const t=l[1];if(t){v.duration=parseFloat(t);const e=(" "+l[2]).slice(1);v.title=e||null,v.tagList.push(e?["INF",t,e]:["INF",t])}else if(l[3]){if(O(v.duration)){v.start=g,d&&Be(v,d,a),v.sn=u,v.level=i,v.cc=m,o.push(v);const t=(" "+l[3]).slice(1);v.relurl=ge(a,t),Ue(v,p),p=v,g+=v.duration,u++,f=0,E=!0}}else if(l[4]){const t=(" "+l[4]).slice(1);p?v.setByteRange(t,p):v.setByteRange(t)}else if(l[5])v.rawProgramDateTime=(" "+l[5]).slice(1),v.tagList.push(["PROGRAM-DATE-TIME",v.rawProgramDateTime]),-1===y&&(y=o.length);else{if(l=l[0].match(Pe),!l){j.warn("No matches on slow regex match for level playlist!");continue}for(h=1;h<l.length&&void 0===l[h];h++);const t=(" "+l[h]).slice(1),r=(" "+l[h+1]).slice(1),g=l[h+2]?(" "+l[h+2]).slice(1):"";switch(t){case"PLAYLIST-TYPE":a.type=r.toUpperCase();break;case"MEDIA-SEQUENCE":u=a.startSN=parseInt(r);break;case"SKIP":{const t=new Y(r);fe(a,t,["RECENTLY-REMOVED-DATERANGES"]);const e=t.decimalInteger("SKIPPED-SEGMENTS");if(O(e)){a.skippedSegments=e;for(let t=e;t--;)o.unshift(null);u+=e}const i=t.enumeratedString("RECENTLY-REMOVED-DATERANGES");i&&(a.recentlyRemovedDateranges=i.split("\t"));break}case"TARGETDURATION":a.targetduration=Math.max(parseInt(r),1);break;case"VERSION":a.version=parseInt(r);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(r||g)&&v.tagList.push(g?[r,g]:[r]);break;case"DISCONTINUITY":m++,v.tagList.push(["DIS"]);break;case"GAP":v.gap=!0,v.tagList.push([t]);break;case"BITRATE":v.tagList.push([t,r]);break;case"DATERANGE":{const t=new Y(r);fe(a,t,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),fe(a,t,t.clientAttrs);const e=new X(t,a.dateRanges[t.ID]);e.isValid||a.skippedSegments?a.dateRanges[e.id]=e:j.warn(`Ignoring invalid DATERANGE tag: "${r}"`),v.tagList.push(["EXT-X-DATERANGE",r]);break}case"DEFINE":{const t=new Y(r);fe(a,t,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in t?pe(a,t,n):me(a,t,e)}break;case"DISCONTINUITY-SEQUENCE":m=parseInt(r);break;case"KEY":{const t=Me(r,e,a);if(t.isSupported()){if("NONE"===t.method){d=void 0;break}d||(d={}),d[t.keyFormat]&&(d=M({},d)),d[t.keyFormat]=t}else j.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${r}"`);break}case"START":a.startTimeOffset=Oe(r);break;case"MAP":{const t=new Y(r);if(fe(a,t,["BYTERANGE","URI"]),v.duration){const r=new it(s,e);$e(r,t,i,d),c=r,v.initSegment=c,c.rawProgramDateTime&&!v.rawProgramDateTime&&(v.rawProgramDateTime=c.rawProgramDateTime)}else{const e=v.byteRangeEndOffset;if(e){const t=v.byteRangeStartOffset;T=`${e-t}@${t}`}else T=null;$e(v,t,i,d),c=v,E=!0}break}case"SERVER-CONTROL":{const t=new Y(r);a.canBlockReload=t.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=t.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=a.canSkipUntil>0&&t.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=t.optionalFloat("PART-HOLD-BACK",0),a.holdBack=t.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const t=new Y(r);a.partTarget=t.decimalFloatingPoint("PART-TARGET");break}case"PART":{let t=a.partList;t||(t=a.partList=[]);const i=f>0?t[t.length-1]:void 0,s=f++,n=new Y(r);fe(a,n,["BYTERANGE","URI"]);const o=new st(n,v,e,s,i);t.push(o),v.duration+=o.duration;break}case"PRELOAD-HINT":{const t=new Y(r);fe(a,t,["URI"]),a.preloadHint=t;break}case"RENDITION-REPORT":{const t=new Y(r);fe(a,t,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push(t);break}default:j.warn(`line parsed but not handled: ${l}`)}}}p&&!p.relurl?(o.pop(),g-=p.duration,a.partList&&(a.fragmentHint=p)):a.partList&&(Ue(v,p),v.cc=m,a.fragmentHint=v,d&&Be(v,d,a));const S=o.length,b=o[0],L=o[S-1];if(g+=a.skippedSegments*a.targetduration,g>0&&S&&L){a.averagetargetduration=g/S;const t=L.sn;a.endSN="initSegment"!==t?t:0,a.live||(L.endList=!0),b&&(a.startCC=b.cc)}else a.endSN=0,a.startCC=0;return a.fragmentHint&&(g+=a.fragmentHint.duration),a.totalduration=g,a.endCC=m,y>0&&function(t,e){let i=t[e];for(let s=e;s--;){const e=t[s];if(!e)return;e.programDateTime=i.programDateTime-1e3*e.duration,i=e}}(o,y),a}}function Me(t,e,i){var s,r;const n=new Y(t);fe(i,n,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const a=null!=(s=n.METHOD)?s:"",o=n.URI,l=n.hexadecimalInteger("IV"),h=n.KEYFORMATVERSIONS,d=null!=(r=n.KEYFORMAT)?r:"identity";o&&n.IV&&!l&&j.error(`Invalid IV: ${n.IV}`);const c=o?xe.resolve(o,e):"",u=(h||"1").split("/").map(Number).filter(Number.isFinite);return new de(a,c,d,u,l)}function Oe(t){const e=new Y(t).decimalFloatingPoint("TIME-OFFSET");return O(e)?e:null}function Fe(t,e){let i=(t||"").split(/[ ,]+/).filter((t=>t));["video","audio","text"].forEach((t=>{const s=i.filter((e=>(function(t, e) {const i=ye[e];return!!i&&!!i[t.slice(0,4)]})(e,t)));s.length&&(e[`${t}Codec`]=s.join(","),i=i.filter((t=>-1===s.indexOf(t))))})),e.unknownCodecs=i}function Ne(t,e,i){const s=e[i];s&&(t[i]=s)}function Ue(t,e){t.rawProgramDateTime?t.programDateTime=Date.parse(t.rawProgramDateTime):null!=e&&e.programDateTime&&(t.programDateTime=e.endProgramDateTime),O(t.programDateTime)||(t.programDateTime=null,t.rawProgramDateTime=null)}function $e(t,e,i,s){t.relurl=e.URI,e.BYTERANGE&&t.setByteRange(e.BYTERANGE),t.level=i,t.sn="initSegment",s&&(t.levelkeys=s),t.initSegment=null}function Be(t,e,i){t.levelkeys=e;const{encryptedFragments:s}=i;s.length&&s[s.length-1].levelkeys===e||!Object.keys(e).some((t=>e[t].isCommonEncryption))||s.push(t)}var Ge="manifest",He="level",Ve="audioTrack",Ke="subtitleTrack",je="main",We="audio",ze="subtitle";function Ye(t){const{type:e}=t;switch(e){case Ve:return We;case Ke:return ze;default:return je}}function qe(t,e){let i=t.url;return void 0!==i&&0!==i.indexOf("data:")||(i=e.url),i}class Xe{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:t}=this;t.on(U.MANIFEST_LOADING,this.onManifestLoading,this),t.on(U.LEVEL_LOADING,this.onLevelLoading,this),t.on(U.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(U.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:t}=this;t.off(U.MANIFEST_LOADING,this.onManifestLoading,this),t.off(U.LEVEL_LOADING,this.onLevelLoading,this),t.off(U.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(U.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(t){const e=this.hls.config,i=e.pLoader,s=e.loader,r=new(i||s)(e);return this.loaders[t.type]=r,r}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const t in this.loaders){const e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,e){const{url:i}=e;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Ge,url:i,deliveryDirectives:null})}onLevelLoading(t,e){const{id:i,level:s,pathwayId:r,url:n,deliveryDirectives:a}=e;this.load({id:i,level:s,pathwayId:r,responseType:"text",type:He,url:n,deliveryDirectives:a})}onAudioTrackLoading(t,e){const{id:i,groupId:s,url:r,deliveryDirectives:n}=e;this.load({id:i,groupId:s,level:null,responseType:"text",type:Ve,url:r,deliveryDirectives:n})}onSubtitleTrackLoading(t,e){const{id:i,groupId:s,url:r,deliveryDirectives:n}=e;this.load({id:i,groupId:s,level:null,responseType:"text",type:Ke,url:r,deliveryDirectives:n})}load(t){var e;const i=this.hls.config;let s,r=this.getInternalLoader(t);if(r){const e=r.context;if(e&&e.url===t.url&&e.level===t.level)return void j.trace("[playlist-loader]: playlist request ongoing");j.log(`[playlist-loader]: aborting previous loader for type: ${t.type}`),r.abort()}if(s=t.type===Ge?i.manifestLoadPolicy.default:M({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(t),O(null==(e=t.deliveryDirectives)?void 0:e.part)){let e;if(t.type===He&&null!==t.level?e=this.hls.levels[t.level].details:t.type===Ve&&null!==t.id?e=this.hls.audioTracks[t.id].details:t.type===Ke&&null!==t.id&&(e=this.hls.subtitleTracks[t.id].details),e){const t=e.partTarget,i=e.targetduration;if(t&&i){const e=1e3*Math.max(3*t,.8*i);s=M({},s,{maxTimeToFirstByteMs:Math.min(e,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(e,s.maxTimeToFirstByteMs)})}}}const n=s.errorRetry||s.timeoutRetry||{},a={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:n.maxNumRetry||0,retryDelay:n.retryDelayMs||0,maxRetryDelay:n.maxRetryDelayMs||0},o={onSuccess:(t,e,i,s)=>{const r=this.getInternalLoader(i);this.resetInternalLoader(i.type);const n=t.data;0===n.indexOf("#EXTM3U")?(e.parsing.start=performance.now(),xe.isMediaPlaylist(n)?this.handleTrackOrLevelPlaylist(t,e,i,s||null,r):this.handleMasterPlaylist(t,e,i,s)):this.handleManifestParsingError(t,i,new Error("no EXTM3U delimiter"),s||null,e)},onError:(t,e,i,s)=>{this.handleNetworkError(e,i,!1,t,s)},onTimeout:(t,e,i)=>{this.handleNetworkError(e,i,!0,void 0,t)}};r.load(t,a,o)}handleMasterPlaylist(t,e,i,s){const r=this.hls,n=t.data,a=qe(t,i),o=xe.parseMasterPlaylist(n,a);if(o.playlistParsingError)return void this.handleManifestParsingError(t,i,o.playlistParsingError,s,e);const{contentSteering:l,levels:h,sessionData:d,sessionKeys:c,startTimeOffset:u,variableList:f}=o;this.variableList=f;const{AUDIO:g=[],SUBTITLES:m,"CLOSED-CAPTIONS":p}=xe.parseMasterPlaylistMedia(n,a,o);if(g.length){g.some((t=>!t.url))||!h[0].audioCodec||h[0].attrs.AUDIO||(j.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),g.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Y({}),bitrate:0,url:""}))}r.trigger(U.MANIFEST_LOADED,{levels:h,audioTracks:g,subtitles:m,captions:p,contentSteering:l,url:a,stats:e,networkDetails:s,sessionData:d,sessionKeys:c,startTimeOffset:u,variableList:f})}handleTrackOrLevelPlaylist(t,e,i,s,r){const n=this.hls,{id:a,level:o,type:l}=i,h=qe(t,i),d=O(o)?o:O(a)?a:0,c=Ye(i),u=xe.parseLevelPlaylist(t.data,h,d,c,0,this.variableList);if(l===Ge){const t={attrs:new Y({}),bitrate:0,details:u,name:"",url:h};n.trigger(U.MANIFEST_LOADED,{levels:[t],audioTracks:[],url:h,stats:e,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}e.parsing.end=performance.now(),i.levelDetails=u,this.handlePlaylistLoaded(u,t,e,i,s,r)}handleManifestParsingError(t,e,i,s,r){this.hls.trigger(U.ERROR,{type:$.NETWORK_ERROR,details:B.MANIFEST_PARSING_ERROR,fatal:e.type===Ge,url:t.url,err:i,error:i,reason:i.message,response:t,context:e,networkDetails:s,stats:r})}handleNetworkError(t,e,i=!1,s,r){let n=`A network ${i?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${t.type}`;t.type===He?n+=`: ${t.level} id: ${t.id}`:t.type!==Ve&&t.type!==Ke||(n+=` id: ${t.id} group-id: "${t.groupId}"`);const a=new Error(n);j.warn(`[playlist-loader]: ${n}`);let o=B.UNKNOWN,l=!1;const h=this.getInternalLoader(t);switch(t.type){case Ge:o=i?B.MANIFEST_LOAD_TIMEOUT:B.MANIFEST_LOAD_ERROR,l=!0;break;case He:o=i?B.LEVEL_LOAD_TIMEOUT:B.LEVEL_LOAD_ERROR,l=!1;break;case Ve:o=i?B.AUDIO_TRACK_LOAD_TIMEOUT:B.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case Ke:o=i?B.SUBTITLE_TRACK_LOAD_TIMEOUT:B.SUBTITLE_LOAD_ERROR,l=!1}h&&this.resetInternalLoader(t.type);const d={type:$.NETWORK_ERROR,details:o,fatal:l,url:t.url,loader:h,context:t,error:a,networkDetails:e,stats:r};if(s){const i=(null==e?void 0:e.url)||t.url;d.response=w({url:i,data:void 0},s)}this.hls.trigger(U.ERROR,d)}handlePlaylistLoaded(t,e,i,s,r,n){const a=this.hls,{type:o,level:l,id:h,groupId:d,deliveryDirectives:c}=s,u=qe(e,s),f=Ye(s),g="number"==typeof s.level&&f===je?l:void 0;if(!t.fragments.length){const t=new Error("No Segments found in Playlist");return void a.trigger(U.ERROR,{type:$.NETWORK_ERROR,details:B.LEVEL_EMPTY_ERROR,fatal:!1,url:u,error:t,reason:t.message,response:e,context:s,level:g,parent:f,networkDetails:r,stats:i})}t.targetduration||(t.playlistParsingError=new Error("Missing Target Duration"));const m=t.playlistParsingError;if(m)a.trigger(U.ERROR,{type:$.NETWORK_ERROR,details:B.LEVEL_PARSING_ERROR,fatal:!1,url:u,error:m,reason:m.message,response:e,context:s,level:g,parent:f,networkDetails:r,stats:i});else switch(t.live&&n&&(n.getCacheAge&&(t.ageHeader=n.getCacheAge()||0),n.getCacheAge&&!isNaN(t.ageHeader)||(t.ageHeader=0)),o){case Ge:case He:a.trigger(U.LEVEL_LOADED,{details:t,level:g||0,id:h||0,stats:i,networkDetails:r,deliveryDirectives:c});break;case Ve:a.trigger(U.AUDIO_TRACK_LOADED,{details:t,id:h||0,groupId:d||"",stats:i,networkDetails:r,deliveryDirectives:c});break;case Ke:a.trigger(U.SUBTITLE_TRACK_LOADED,{details:t,id:h||0,groupId:d||"",stats:i,networkDetails:r,deliveryDirectives:c})}}}function Qe(t,e){let i;try{i=new Event("addtrack")}catch(t){i=document.createEvent("Event"),i.initEvent("addtrack",!1,!1)}i.track=t,e.dispatchEvent(i)}function Je(t,e){const i=t.mode;if("disabled"===i&&(t.mode="hidden"),t.cues&&!t.cues.getCueById(e.id))try{if(t.addCue(e),!t.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(i){j.debug(`[texttrack-utils]: ${i}`);try{const i=new self.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,t.addCue(i)}catch(t){j.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${t}`)}}"disabled"===i&&(t.mode=i)}function Ze(t){const e=t.mode;if("disabled"===e&&(t.mode="hidden"),t.cues)for(let e=t.cues.length;e--;)t.removeCue(t.cues[e]);"disabled"===e&&(t.mode=e)}function ti(t,e,i,s){const r=t.mode;if("disabled"===r&&(t.mode="hidden"),t.cues&&t.cues.length>0){const r=function(t,e,i){const s=[],r=function(t,e){if(e<t[0].startTime)return 0;const i=t.length-1;if(e>t[i].endTime)return-1;let s=0,r=i;for(;s<=r;){const n=Math.floor((r+s)/2);if(e<t[n].startTime)r=n-1;else{if(!(e>t[n].startTime&&s<i))return n;s=n+1}}return t[s].startTime-e<e-t[r].startTime?s:r}(t,e);if(r>-1)for(let n=r,a=t.length;n<a;n++){const r=t[n];if(r.startTime>=e&&r.endTime<=i)s.push(r);else if(r.startTime>i)return s}return s}(t.cues,e,i);for(let e=0;e<r.length;e++)s&&!s(r[e])||t.removeCue(r[e])}"disabled"===r&&(t.mode=r)}function ei(t){const e=[];for(let i=0;i<t.length;i++){const s=t[i];"subtitles"!==s.kind&&"captions"!==s.kind||!s.label||e.push(t[i])}return e}var ii="org.id3",si="com.apple.quicktime.HLS",ri="https://aomedia.org/emsg/ID3";function ni(){if("undefined"!=typeof self)return self.VTTCue||self.TextTrackCue}function ai(t,e,i,s,r){let n=new t(e,i,"");try{n.value=s,r&&(n.type=r)}catch(a){n=new t(e,i,JSON.stringify(r?w({type:r},s):s))}return n}const oi=(()=>{const t=ni();try{t&&new t(0,Number.POSITIVE_INFINITY,"")}catch(t){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function li(t,e){return t.getTime()/1e3-e}class hi{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:t}=this;t.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(U.MANIFEST_LOADING,this.onManifestLoading,this),t.on(U.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(U.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:t}=this;t.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(U.MANIFEST_LOADING,this.onManifestLoading,this),t.off(U.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(U.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(t,e){this.media=e.media}onMediaDetaching(){this.id3Track&&(Ze(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){const e=this.getID3Track(t.textTracks);return e.mode="hidden",e}getID3Track(t){if(this.media){for(let e=0;e<t.length;e++){const i=t[e];if("metadata"===i.kind&&"id3"===i.label)return Qe(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,e){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:i,enableID3MetadataCues:s}}}=this;if(!i&&!s)return;const{samples:r}=e;this.id3Track||(this.id3Track=this.createTrack(this.media));const n=ni();if(n)for(let t=0;t<r.length;t++){const e=r[t].type;if(e===ri&&!i||!s)continue;const a=It(r[t].data);if(a){const i=r[t].pts;let s=i+r[t].duration;s>oi&&(s=oi);s-i<=0&&(s=i+.25);for(let t=0;t<a.length;t++){const r=a[t];if(!Ct(r)){this.updateId3CueEnds(i,e);const t=ai(n,i,s,r,e);t&&this.id3Track.addCue(t)}}}}}updateId3CueEnds(t,e){var i;const s=null==(i=this.id3Track)?void 0:i.cues;if(s)for(let i=s.length;i--;){const r=s[i];r.type===e&&r.startTime<t&&r.endTime===oi&&(r.endTime=t)}}onBufferFlushing(t,{startOffset:e,endOffset:i,type:s}){const{id3Track:r,hls:n}=this;if(!n)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:o}}=n;if(r&&(a||o)){let t;t="audio"===s?t=>t.type===ii&&o:"video"===s?t=>t.type===ri&&a:t=>t.type===ii&&o||t.type===ri&&a,ti(r,e,i,t)}}onLevelUpdated(t,{details:e}){if(!this.media||!e.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:i,id3Track:s}=this,{dateRanges:r}=e,n=Object.keys(r);if(s){const t=Object.keys(i).filter((t=>!n.includes(t)));for(let e=t.length;e--;){const r=t[e];Object.keys(i[r].cues).forEach((t=>{s.removeCue(i[r].cues[t])})),delete i[r]}}const a=e.fragments[e.fragments.length-1];if(0===n.length||!O(null==a?void 0:a.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=a.programDateTime/1e3-a.start,l=ni();for(let t=0;t<n.length;t++){const e=n[t],s=r[e],a=li(s.startDate,o),c=i[e],u=(null==c?void 0:c.cues)||{};let f=(null==c?void 0:c.durationKnown)||!1,g=oi;const m=s.endDate;if(m)g=li(m,o),f=!0;else if(s.endOnNext&&!f){const t=n.reduce(((t,e)=>{if(e!==s.id){const i=r[e];if(i.class===s.class&&i.startDate>s.startDate&&(!t||s.startDate<t.startDate))return i}return t}),null);t&&(g=li(t.startDate,o),f=!0)}const p=Object.keys(s.attr);for(let t=0;t<p.length;t++){const i=p[t];if("ID"===(d=i)||"CLASS"===d||"START-DATE"===d||"DURATION"===d||"END-DATE"===d||"END-ON-NEXT"===d)continue;const r=u[i];if(r)f&&!c.durationKnown&&(r.endTime=g);else if(l){let t=s.attr[i];q(i)&&(h=t,t=Uint8Array.from(h.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer);const r=ai(l,a,g,{key:i,data:t},si);r&&(r.id=e,this.id3Track.addCue(r),u[i]=r)}}i[e]={cues:u,dateRange:s,durationKnown:f}}var h,d}}class di{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=t,this.config=t.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:t,levelDetails:e}=this;return void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:e?t.liveMaxLatencyDurationCount*e.targetduration:0}get targetLatency(){const{levelDetails:t}=this;if(null===t)return null;const{holdBack:e,partHoldBack:i,targetduration:s}=t,{liveSyncDuration:r,liveSyncDurationCount:n,lowLatencyMode:a}=this.config,o=this.hls.userConfig;let l=a&&i||e;(o.liveSyncDuration||o.liveSyncDurationCount||0===l)&&(l=void 0!==r?r:n*s);const h=s;return l+Math.min(1*this.stallCount,h)}get liveSyncPosition(){const t=this.estimateLiveEdge(),e=this.targetLatency,i=this.levelDetails;if(null===t||null===e||null===i)return null;const s=i.edge,r=t-e-this.edgeStalled,n=s-i.totalduration,a=s-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(n,r),a)}get drift(){const{levelDetails:t}=this;return null===t?1:t.drift}get edgeStalled(){const{levelDetails:t}=this;if(null===t)return 0;const e=3*(this.config.lowLatencyMode&&t.partTarget||t.targetduration);return Math.max(t.age-e,0)}get forwardBufferLength(){const{media:t,levelDetails:e}=this;if(!t||!e)return 0;const i=t.buffered.length;return(i?t.buffered.end(i-1):e.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(U.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(U.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(U.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(U.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(U.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(U.ERROR,this.onError,this)}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(t,{details:e}){this.levelDetails=e,e.advanced&&this.timeupdate(),!e.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(t,e){var i;e.details===B.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(i=this.levelDetails)&&i.live&&j.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:t,levelDetails:e}=this;if(!t||!e)return;this.currentTime=t.currentTime;const i=this.computeLatency();if(null===i)return;this._latency=i;const{lowLatencyMode:s,maxLiveSyncPlaybackRate:r}=this.config;if(!s||1===r||!e.live)return;const n=this.targetLatency;if(null===n)return;const a=i-n;if(a<Math.min(this.maxLatency,n+e.targetduration)&&a>.05&&this.forwardBufferLength>1){const e=Math.min(2,Math.max(1,r)),i=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20;t.playbackRate=Math.min(e,Math.max(1,i))}else 1!==t.playbackRate&&0!==t.playbackRate&&(t.playbackRate=1)}estimateLiveEdge(){const{levelDetails:t}=this;return null===t?null:t.edge+t.age}computeLatency(){const t=this.estimateLiveEdge();return null===t?null:t-this.currentTime}}const ci=["NONE","TYPE-0","TYPE-1",null];const ui=["SDR","PQ","HLG"];var fi="",gi="YES",mi="v2";function pi(t){const{canSkipUntil:e,canSkipDateRanges:i,age:s}=t;return e&&s<e/2?i?mi:gi:fi}class vi{constructor(t,e,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=e,this.skip=i}addDirectives(t){const e=new self.URL(t);return void 0!==this.msn&&e.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&e.searchParams.set("_HLS_part",this.part.toString()),this.skip&&e.searchParams.set("_HLS_skip",this.skip),e.href}}class yi{constructor(t){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter((t=>!!t)).map((t=>t.substring(0,4))).join(","),this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(t){return Ei(this._audioGroups,t)}hasSubtitleGroup(t){return Ei(this._subtitleGroups,t)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(t,e){if(e)if("audio"===t){let t=this._audioGroups;t||(t=this._audioGroups=[]),-1===t.indexOf(e)&&t.push(e)}else if("text"===t){let t=this._subtitleGroups;t||(t=this._subtitleGroups=[]),-1===t.indexOf(e)&&t.push(e)}}get urlId(){return 0}set urlId(t){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var t;return null==(t=this.audioGroups)?void 0:t[0]}get textGroupId(){var t;return null==(t=this.subtitleGroups)?void 0:t[0]}addFallback(){}}function Ei(t,e){return!(!e||!t)&&-1!==t.indexOf(e)}function Ti(t,e){const i=e.startPTS;if(O(i)){let s,r=0;e.sn>t.sn?(r=i-t.start,s=t):(r=t.start-i,s=e),s.duration!==r&&(s.duration=r)}else if(e.sn>t.sn){t.cc===e.cc&&t.minEndPTS?e.start=t.start+(t.minEndPTS-t.start):e.start=t.start+t.duration}else e.start=Math.max(t.start-e.duration,0)}function Si(t,e,i,s,r,n){s-i<=0&&(j.warn("Fragment should have a positive duration",e),s=i+e.duration,n=r+e.duration);let a=i,o=s;const l=e.startPTS,h=e.endPTS;if(O(l)){const t=Math.abs(l-i);O(e.deltaPTS)?e.deltaPTS=Math.max(t,e.deltaPTS):e.deltaPTS=t,a=Math.max(i,l),i=Math.min(i,l),r=Math.min(r,e.startDTS),o=Math.min(s,h),s=Math.max(s,h),n=Math.max(n,e.endDTS)}const d=i-e.start;0!==e.start&&(e.start=i),e.duration=s-e.start,e.startPTS=i,e.maxStartPTS=a,e.startDTS=r,e.endPTS=s,e.minEndPTS=o,e.endDTS=n;const c=e.sn;if(!t||c<t.startSN||c>t.endSN)return 0;let u;const f=c-t.startSN,g=t.fragments;for(g[f]=e,u=f;u>0;u--)Ti(g[u],g[u-1]);for(u=f;u<g.length-1;u++)Ti(g[u],g[u+1]);return t.fragmentHint&&Ti(g[g.length-1],t.fragmentHint),t.PTSKnown=t.alignedSliding=!0,d}function bi(t,e){let i=null;const s=t.fragments;for(let t=s.length-1;t>=0;t--){const e=s[t].initSegment;if(e){i=e;break}}t.fragmentHint&&delete t.fragmentHint.endPTS;let r,n=0;if(function(t,e,i){const s=e.skippedSegments,r=Math.max(t.startSN,e.startSN)-e.startSN,n=(t.fragmentHint?1:0)+(s?e.endSN:Math.min(t.endSN,e.endSN))-e.startSN,a=e.startSN-t.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments;for(let t=r;t<=n;t++){const r=l[a+t];let n=o[t];s&&!n&&t<s&&(n=e.fragments[t]=r),r&&n&&i(r,n)}}(t,e,((t,s)=>{t.relurl&&(n=t.cc-s.cc),O(t.startPTS)&&O(t.endPTS)&&(s.start=s.startPTS=t.startPTS,s.startDTS=t.startDTS,s.maxStartPTS=t.maxStartPTS,s.endPTS=t.endPTS,s.endDTS=t.endDTS,s.minEndPTS=t.minEndPTS,s.duration=t.endPTS-t.startPTS,s.duration&&(r=s),e.PTSKnown=e.alignedSliding=!0),s.elementaryStreams=t.elementaryStreams,s.loader=t.loader,s.stats=t.stats,t.initSegment&&(s.initSegment=t.initSegment,i=t.initSegment)})),i){(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach((t=>{var e;!t||t.initSegment&&t.initSegment.relurl!==(null==(e=i)?void 0:e.relurl)||(t.initSegment=i)}))}if(e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some((t=>!t)),e.deltaUpdateFailed){j.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let t=e.skippedSegments;t--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=function(t,e,i){const s=M({},t);i&&i.forEach((t=>{delete s[t]}));return Object.keys(e).forEach((t=>{const i=new X(e[t].attr,s[t]);i.isValid?s[t]=i:j.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[t].attr)}"`)})),s}(t.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));const a=e.fragments;if(n){j.warn("discontinuity sliding from playlist, take drift into account");for(let t=0;t<a.length;t++)a[t].cc+=n}e.skippedSegments&&(e.startCC=e.fragments[0].cc),function(t,e,i){if(t&&e){let s=0;for(let r=0,n=t.length;r<=n;r++){const n=t[r],a=e[r+s];n&&a&&n.index===a.index&&n.fragment.sn===a.fragment.sn?i(n,a):s--}}}(t.partList,e.partList,((t,e)=>{e.elementaryStreams=t.elementaryStreams,e.stats=t.stats})),r?Si(e,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):Li(t,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=t.driftStartTime,e.driftStart=t.driftStart;const o=e.advancedDateTime;if(e.advanced&&o){const t=e.edge;e.driftStart||(e.driftStartTime=o,e.driftStart=t),e.driftEndTime=o,e.driftEnd=t}else e.driftEndTime=t.driftEndTime,e.driftEnd=t.driftEnd,e.advancedDateTime=t.advancedDateTime}function Li(t,e){const i=e.startSN+e.skippedSegments-t.startSN,s=t.fragments;i<0||i>=s.length||Ai(e,s[i].start)}function Ai(t,e){if(e){const i=t.fragments;for(let s=t.skippedSegments;s<i.length;s++)i[s].start+=e;t.fragmentHint&&(t.fragmentHint.start+=e)}}function Ri(t,e,i){var s;return null!=t&&t.details?ki(null==(s=t.details)?void 0:s.partList,e,i):null}function ki(t,e,i){if(t)for(let s=t.length;s--;){const r=t[s];if(r.index===i&&r.fragment.sn===e)return r}return null}function Ci(t){t.forEach(((t,e)=>{const{details:i}=t;null!=i&&i.fragments&&i.fragments.forEach((t=>{t.level=e}))}))}function _i(t){switch(t.details){case B.FRAG_LOAD_TIMEOUT:case B.KEY_LOAD_TIMEOUT:case B.LEVEL_LOAD_TIMEOUT:case B.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Ii(t,e){const i=_i(e);return t.default[(i?"timeout":"error")+"Retry"]}function Di(t,e){const i="linear"===t.backoff?1:Math.pow(2,e);return Math.min(i*t.retryDelayMs,t.maxRetryDelayMs)}function wi(t){return w(w({},t),{errorRetry:null,timeoutRetry:null})}function Pi(t,e,i,s){if(!t)return!1;const r=null==s?void 0:s.code,n=e<t.maxNumRetry&&(function(t){return 0===t&&!1===navigator.onLine||!!t&&(t<400||t>499)}(r)||!!i);return t.shouldRetry?t.shouldRetry(t,e,i,s,n):n}const xi=function(t,e){let i=0,s=t.length-1,r=null,n=null;for(;i<=s;){r=(i+s)/2|0,n=t[r];const a=e(n);if(a>0)i=r+1;else{if(!(a<0))return n;s=r-1}}return null};function Mi(t,e,i=0,s=0){let r=null;if(t){r=e[t.sn-e[0].sn+1]||null;const s=t.endDTS-i;s>0&&s<15e-7&&(i+=15e-7)}else 0===i&&0===e[0].start&&(r=e[0]);if(r&&(!t||t.level===r.level)&&0===Oi(i,s,r))return r;const n=xi(e,Oi.bind(null,i,s));return!n||n===t&&r?r:n}function Oi(t=0,e=0,i){if(i.start<=t&&i.start+i.duration>t)return 0;const s=Math.min(e,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-s<=t?1:i.start-s>t&&i.start?-1:0}function Fi(t,e,i){const s=1e3*Math.min(e,i.duration+(i.deltaPTS?i.deltaPTS:0));return(i.endProgramDateTime||0)-s>t}var Ni=0,Ui=2,$i=3,Bi=5,Gi=0,Hi=1,Vi=2;class Ki{constructor(t,e){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=j.log.bind(j,`${e}:`),this.warn=j.warn.bind(j,`${e}:`),this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(t,e,i){const s=null==e?void 0:e.renditionReports;if(s){let r=-1;for(let i=0;i<s.length;i++){const n=s[i];let a;try{a=new self.URL(n.URI,e.url).href}catch(t){j.warn(`Could not construct new URL for Rendition Report: ${t}`),a=n.URI||""}if(a===t){r=i;break}a===t.substring(0,a.length)&&(r=i)}if(-1!==r){const t=s[r],n=parseInt(t["LAST-MSN"])||(null==e?void 0:e.lastPartSn);let a=parseInt(t["LAST-PART"])||(null==e?void 0:e.lastPartIndex);if(this.hls.config.lowLatencyMode){const t=Math.min(e.age-e.partTarget,e.targetduration);a>=0&&t>e.partTarget&&(a+=1)}const o=i&&pi(i);return new vi(n,a>=0?a:void 0,o)}}}loadPlaylist(t){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}shouldReloadPlaylist(t){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(t)}playlistLoaded(t,e,i){const{details:s,stats:r}=e,n=self.performance.now(),a=r.loading.first?Math.max(0,n-r.loading.first):0;if(s.advancedDateTime=Date.now()-a,s.live||null!=i&&i.live){if(s.reloaded(i),i&&this.log(`live playlist ${t} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED"}`),i&&s.fragments.length>0&&bi(i,s),!this.canLoad||!s.live)return;let a,o,l;if(s.canBlockReload&&s.endSN&&s.advanced){const t=this.hls.config.lowLatencyMode,r=s.lastPartSn,n=s.endSN,h=s.lastPartIndex,d=r===n;-1!==h?(o=d?n+1:r,l=d?t?0:h:h+1):o=n+1;const c=s.age,u=c+s.ageHeader;let f=Math.min(u-s.partTarget,1.5*s.targetduration);if(f>0){if(i&&f>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${f} with playlist age: ${s.age}`),f=0;else{const t=Math.floor(f/s.targetduration);if(o+=t,void 0!==l){l+=Math.round(f%s.targetduration/s.partTarget)}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${c.toFixed(2)}s goal: ${f} skip sn ${t} to part ${l}`)}s.tuneInGoal=f}if(a=this.getDeliveryDirectives(s,e.deliveryDirectives,o,l),t||!d)return void this.loadPlaylist(a)}else(s.canBlockReload||s.canSkipUntil)&&(a=this.getDeliveryDirectives(s,e.deliveryDirectives,o,l));const h=this.hls.mainForwardBufferInfo,d=h?h.end-h.len:0,c=function(t,e=1/0){let i=1e3*t.targetduration;if(t.updated){const s=t.fragments,r=4;if(s.length&&i*r>e){const t=1e3*s[s.length-1].duration;t<i&&(i=t)}}else i/=2;return Math.round(i)}(s,1e3*(s.edge-d));s.updated&&n>this.requestScheduled+c&&(this.requestScheduled=r.loading.start),void 0!==o&&s.canBlockReload?this.requestScheduled=r.loading.first+c-(1e3*s.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+c<n?this.requestScheduled=n:this.requestScheduled-n<=0&&(this.requestScheduled+=c);let u=this.requestScheduled-n;u=Math.max(0,u),this.log(`reload live playlist ${t} in ${Math.round(u)} ms`),this.timer=self.setTimeout((()=>this.loadPlaylist(a)),u)}else this.clearTimer()}getDeliveryDirectives(t,e,i,s){let r=pi(t);return null!=e&&e.skip&&t.deltaUpdateFailed&&(i=e.msn,s=e.part,r=fi),new vi(i,s,r)}checkRetry(t){const e=t.details,i=_i(t),s=t.errorAction,{action:r,retryCount:n=0,retryConfig:a}=s||{},o=!!s&&!!a&&(r===Bi||!s.resolved&&r===Ui);if(o){var l;if(this.requestScheduled=-1,n>=a.maxNumRetry)return!1;if(i&&null!=(l=t.context)&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${n+1}/${a.maxNumRetry} after "${e}" without delivery-directives`),this.loadPlaylist();else{const t=Di(a,n);this.timer=self.setTimeout((()=>this.loadPlaylist()),t),this.warn(`Retrying playlist loading ${n+1}/${a.maxNumRetry} after "${e}" in ${t}ms`)}t.levelRetry=!0,s.resolved=!0}return o}}class ji{constructor(t,e=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=e,this.totalWeight_=i}sample(t,e){const i=Math.pow(this.alpha_,t);this.estimate_=e*(1-i)+i*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}}class Wi{constructor(t,e,i,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new ji(t),this.fast_=new ji(e),this.defaultTTFB_=s,this.ttfb_=new ji(t)}update(t,e){const{slow_:i,fast_:s,ttfb_:r}=this;i.halfLife!==t&&(this.slow_=new ji(t,i.getEstimate(),i.getTotalWeight())),s.halfLife!==e&&(this.fast_=new ji(e,s.getEstimate(),s.getTotalWeight())),r.halfLife!==t&&(this.ttfb_=new ji(t,r.getEstimate(),r.getTotalWeight()))}sample(t,e){const i=(t=Math.max(t,this.minDelayMs_))/1e3,s=8*e/i;this.fast_.sample(i,s),this.slow_.sample(i,s)}sampleTTFB(t){const e=t/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(e,2)/2);this.ttfb_.sample(i,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const zi={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},Yi={};function qi(t,e,i,s,r,n){const a=t.audioCodec?t.audioGroups:null,o=null==n?void 0:n.audioCodec,l=null==n?void 0:n.channels,h=l?parseInt(l):o?1/0:2;let d=null;if(null!=a&&a.length)try{d=1===a.length&&a[0]?e.groups[a[0]].channels:a.reduce(((t,i)=>{if(i){const s=e.groups[i];if(!s)throw new Error(`Audio track group ${i} not found`);Object.keys(s.channels).forEach((e=>{t[e]=(t[e]||0)+s.channels[e]}))}return t}),{2:0})}catch(t){return!0}return void 0!==t.videoCodec&&(t.width>1920&&t.height>1088||t.height>1920&&t.width>1088||t.frameRate>Math.max(s,30)||"SDR"!==t.videoRange&&t.videoRange!==i||t.bitrate>Math.max(r,8e6))||!!d&&O(h)&&Object.keys(d).some((t=>parseInt(t)>h))}function Xi(t,e,i){const s=t.videoCodec,r=t.audioCodec;if(!s||!r||!i)return Promise.resolve(zi);const n={width:t.width,height:t.height,bitrate:Math.ceil(Math.max(.9*t.bitrate,t.averageBitrate)),framerate:t.frameRate||30},a=t.videoRange;"SDR"!==a&&(n.transferFunction=a.toLowerCase());const o=s.split(",").map((t=>({type:"media-source",video:w(w({},n),{},{contentType:Se(t,"video")})})));return r&&t.audioGroups&&t.audioGroups.forEach((t=>{var i;t&&(null==(i=e.groups[t])||i.tracks.forEach((e=>{if(e.groupId===t){const t=e.channels||"",i=parseFloat(t);O(i)&&i>2&&o.push.apply(o,r.split(",").map((t=>({type:"media-source",audio:{contentType:Se(t,"audio"),channels:""+i}}))))}})))})),Promise.all(o.map((t=>{const e=function(t){const{audio:e,video:i}=t,s=i||e;if(s){const t=s.contentType.split('"')[1];if(i)return`r${i.height}x${i.width}f${Math.ceil(i.framerate)}${i.transferFunction||"sd"}_${t}_${Math.ceil(i.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${t}`}return""}(t);return Yi[e]||(Yi[e]=i.decodingInfo(t))}))).then((t=>({supported:!t.some((t=>!t.supported)),configurations:o,decodingInfoResults:t}))).catch((t=>({supported:!1,configurations:o,decodingInfoResults:[],error:t})))}function Qi(t,e){let i=!1,s=[];return t&&(i="SDR"!==t,s=[t]),e&&(s=e.allowedVideoRanges||ui.slice(0),i=void 0!==e.preferHDR?e.preferHDR:function(){if("function"==typeof matchMedia){const t=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(t.media!==e.media)return!0===t.matches}return!1}(),s=i?s.filter((t=>"SDR"!==t)):["SDR"]),{preferHDR:i,allowedVideoRanges:s}}function Ji(t,e){j.log(`[abr] start candidates with "${t}" ignored because ${e}`)}function Zi(t,e,i){if("attrs"in t){const i=e.indexOf(t);if(-1!==i)return i}for(let s=0;s<e.length;s++){if(ts(t,e[s],i))return s}return-1}function ts(t,e,i){const{groupId:s,name:r,lang:n,assocLang:a,characteristics:o,default:l}=t,h=t.forced;return(void 0===s||e.groupId===s)&&(void 0===r||e.name===r)&&(void 0===n||e.lang===n)&&(void 0===n||e.assocLang===a)&&(void 0===l||e.default===l)&&(void 0===h||e.forced===h)&&(void 0===o||function(t,e=""){const i=t.split(","),s=e.split(",");return i.length===s.length&&!i.some((t=>-1===s.indexOf(t)))}(o,e.characteristics))&&(void 0===i||i(t,e))}function es(t,e){const{audioCodec:i,channels:s}=t;return!(void 0!==i&&(e.audioCodec||"").substring(0,4)!==i.substring(0,4)||void 0!==s&&s!==(e.channels||"2"))}function is(t,e,i){for(let s=e;s;s--)if(i(t[s]))return s;for(let s=e+1;s<t.length;s++)if(i(t[s]))return s;return-1}class ss{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var rs="NOT_LOADED",ns="APPENDING",as="PARTIAL",os="OK";class ls{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(U.BUFFER_APPENDED,this.onBufferAppended,this),t.on(U.FRAG_BUFFERED,this.onFragBuffered,this),t.on(U.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:t}=this;t.off(U.BUFFER_APPENDED,this.onBufferAppended,this),t.off(U.FRAG_BUFFERED,this.onFragBuffered,this),t.off(U.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(t,e){const i=this.activePartLists[e];if(i)for(let e=i.length;e--;){const s=i[e];if(!s)break;const r=s.end;if(s.start<=t&&null!==r&&t<=r)return s}return this.getBufferedFrag(t,e)}getBufferedFrag(t,e){const{fragments:i}=this,s=Object.keys(i);for(let r=s.length;r--;){const n=i[s[r]];if((null==n?void 0:n.body.type)===e&&n.buffered){const e=n.body;if(e.start<=t&&t<=e.end)return e}}return null}detectEvictedFragments(t,e,i,s){this.timeRanges&&(this.timeRanges[t]=e);const r=(null==s?void 0:s.fragment.sn)||-1;Object.keys(this.fragments).forEach((s=>{const n=this.fragments[s];if(!n)return;if(r>=n.body.sn)return;if(!n.buffered&&!n.loaded)return void(n.body.type===i&&this.removeFragment(n.body));const a=n.range[t];a&&a.time.some((t=>{const i=!this.isTimeBuffered(t.startPTS,t.endPTS,e);return i&&this.removeFragment(n.body),i}))}))}detectPartialFragments(t){const e=this.timeRanges,{frag:i,part:s}=t;if(!e||"initSegment"===i.sn)return;const r=ds(i),n=this.fragments[r];if(!n||n.buffered&&i.gap)return;const a=!i.relurl;if(Object.keys(e).forEach((t=>{const r=i.elementaryStreams[t];if(!r)return;const o=e[t],l=a||!0===r.partial;n.range[t]=this.getBufferedTimes(i,s,l,o)})),n.loaded=null,Object.keys(n.range).length){n.buffered=!0;(n.body.endList=i.endList||n.body.endList)&&(this.endListFragments[n.body.type]=n),hs(n)||this.removeParts(i.sn-1,i.type)}else this.removeFragment(n.body)}removeParts(t,e){const i=this.activePartLists[e];i&&(this.activePartLists[e]=i.filter((e=>e.fragment.sn>=t)))}fragBuffered(t,e){const i=ds(t);let s=this.fragments[i];!s&&e&&(s=this.fragments[i]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,s.buffered=!0)}getBufferedTimes(t,e,i,s){const r={time:[],partial:i},n=t.start,a=t.end,o=t.minEndPTS||a,l=t.maxStartPTS||n;for(let t=0;t<s.length;t++){const e=s.start(t)-this.bufferPadding,i=s.end(t)+this.bufferPadding;if(l>=e&&o<=i){r.time.push({startPTS:Math.max(n,s.start(t)),endPTS:Math.min(a,s.end(t))});break}if(n<i&&a>e){const e=Math.max(n,s.start(t)),i=Math.min(a,s.end(t));i>e&&(r.partial=!0,r.time.push({startPTS:e,endPTS:i}))}else if(a<=e)break}return r}getPartialFragment(t){let e,i,s,r=null,n=0;const{bufferPadding:a,fragments:o}=this;return Object.keys(o).forEach((l=>{const h=o[l];h&&hs(h)&&(i=h.body.start-a,s=h.body.end+a,t>=i&&t<=s&&(e=Math.min(t-i,s-t),n<=e&&(r=h.body,n=e)))})),r}isEndListAppended(t){const e=this.endListFragments[t];return void 0!==e&&(e.buffered||hs(e))}getState(t){const e=ds(t),i=this.fragments[e];return i?i.buffered?hs(i)?as:os:ns:rs}isTimeBuffered(t,e,i){let s,r;for(let n=0;n<i.length;n++){if(s=i.start(n)-this.bufferPadding,r=i.end(n)+this.bufferPadding,t>=s&&e<=r)return!0;if(e<=s)return!1}return!1}onFragLoaded(t,e){const{frag:i,part:s}=e;if("initSegment"===i.sn||i.bitrateTest)return;const r=s?null:e,n=ds(i);this.fragments[n]={body:i,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(t,e){const{frag:i,part:s,timeRanges:r}=e;if("initSegment"===i.sn)return;const n=i.type;if(s){let t=this.activePartLists[n];t||(this.activePartLists[n]=t=[]),t.push(s)}this.timeRanges=r,Object.keys(r).forEach((t=>{const e=r[t];this.detectEvictedFragments(t,e,n,s)}))}onFragBuffered(t,e){this.detectPartialFragments(e)}hasFragment(t){const e=ds(t);return!!this.fragments[e]}hasParts(t){var e;return!(null==(e=this.activePartLists[t])||!e.length)}removeFragmentsInRange(t,e,i,s,r){s&&!this.hasGaps||Object.keys(this.fragments).forEach((n=>{const a=this.fragments[n];if(!a)return;const o=a.body;o.type!==i||s&&!o.gap||o.start<e&&o.end>t&&(a.buffered||r)&&this.removeFragment(o)}))}removeFragment(t){const e=ds(t);t.stats.loaded=0,t.clearElementaryStreamInfo();const i=this.activePartLists[t.type];if(i){const e=t.sn;this.activePartLists[t.type]=i.filter((t=>t.fragment.sn!==e))}delete this.fragments[e],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function hs(t){var e,i,s;return t.buffered&&(t.body.gap||(null==(e=t.range.video)?void 0:e.partial)||(null==(i=t.range.audio)?void 0:i.partial)||(null==(s=t.range.audiovideo)?void 0:s.partial))}function ds(t){return`${t.type}_${t.level}_${t.sn}`}const cs={length:0,start:()=>0,end:()=>0};class us{static isBuffered(t,e){try{if(t){const i=us.getBuffered(t);for(let t=0;t<i.length;t++)if(e>=i.start(t)&&e<=i.end(t))return!0}}catch(t){}return!1}static bufferInfo(t,e,i){try{if(t){const s=us.getBuffered(t),r=[];let n;for(n=0;n<s.length;n++)r.push({start:s.start(n),end:s.end(n)});return this.bufferedInfo(r,e,i)}}catch(t){}return{len:0,start:e,end:e,nextStart:void 0}}static bufferedInfo(t,e,i){e=Math.max(0,e),t.sort((function(t,e){const i=t.start-e.start;return i||e.end-t.end}));let s=[];if(i)for(let e=0;e<t.length;e++){const r=s.length;if(r){const n=s[r-1].end;t[e].start-n<i?t[e].end>n&&(s[r-1].end=t[e].end):s.push(t[e])}else s.push(t[e])}else s=t;let r,n=0,a=e,o=e;for(let t=0;t<s.length;t++){const l=s[t].start,h=s[t].end;if(e+i>=l&&e<h)a=l,o=h,n=o-e;else if(e+i<l){r=l;break}}return{len:n,start:a||0,end:o||0,nextStart:r}}static getBuffered(t){try{return t.buffered}catch(t){return j.log("failed to get media.buffered",t),cs}}}class fs{constructor(t,e,i,s=0,r=-1,n=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=t,this.sn=e,this.id=i,this.size=s,this.part=r,this.partial=n}}function gs(t,e){for(let s=0,r=t.length;s<r;s++){var i;if((null==(i=t[s])?void 0:i.cc)===e)return t[s]}return null}function ms(t,e){if(t){const i=t.start+e;t.start=t.startPTS=i,t.endPTS=i+t.duration}}function ps(t,e){const i=e.fragments;for(let e=0,s=i.length;e<s;e++)ms(i[e],t);e.fragmentHint&&ms(e.fragmentHint,t),e.alignedSliding=!0}function vs(t,e,i){e&&(!function(t,e,i){if(function(t,e,i){return!(!e||!(i.endCC>i.startCC||t&&t.cc<i.startCC))}(t,i,e)){const t=function(t,e){const i=t.fragments,s=e.fragments;if(!s.length||!i.length)return void j.log("No fragments to align");const r=gs(i,s[0].cc);if(r&&(!r||r.startPTS))return r;j.log("No frag in previous level to align on")}(i,e);t&&O(t.start)&&(j.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),ps(t.start,e))}}(t,i,e),!i.alignedSliding&&e&&ys(i,e),i.alignedSliding||!e||i.skippedSegments||Li(e,i))}function ys(t,e){if(!t.hasProgramDateTime||!e.hasProgramDateTime)return;const i=t.fragments,s=e.fragments;if(!i.length||!s.length)return;let r,n;const a=Math.min(e.endCC,t.endCC);e.startCC<a&&t.startCC<a&&(r=gs(s,a),n=gs(i,a)),r&&n||(r=s[Math.floor(s.length/2)],n=gs(i,r.cc)||i[Math.floor(i.length/2)]);const o=r.programDateTime,l=n.programDateTime;if(!o||!l)return;ps((l-o)/1e3-(n.start-r.start),t)}const Es=Math.pow(2,17);class Ts{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(t,e){const i=t.url;if(!i)return Promise.reject(new Ls({type:$.NETWORK_ERROR,details:B.FRAG_LOAD_ERROR,fatal:!1,frag:t,error:new Error("Fragment does not have a "+(i?"part list":"url")),networkDetails:null}));this.abort();const s=this.config,r=s.fLoader,n=s.loader;return new Promise(((a,o)=>{if(this.loader&&this.loader.destroy(),t.gap){if(t.tagList.some((t=>"GAP"===t[0])))return void o(bs(t));t.gap=!1}const l=this.loader=t.loader=r?new r(s):new n(s),h=Ss(t),d=wi(s.fragLoadPolicy.default),c={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===t.sn?1/0:Es};t.stats=l.stats,l.load(h,c,{onSuccess:(e,i,s,r)=>{this.resetLoader(t,l);let n=e.data;s.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(n.slice(0,16)),n=n.slice(16)),a({frag:t,part:null,payload:n,networkDetails:r})},onError:(e,s,r,n)=>{this.resetLoader(t,l),o(new Ls({type:$.NETWORK_ERROR,details:B.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:w({url:i,data:void 0},e),error:new Error(`HTTP Error ${e.code} ${e.text}`),networkDetails:r,stats:n}))},onAbort:(e,i,s)=>{this.resetLoader(t,l),o(new Ls({type:$.NETWORK_ERROR,details:B.INTERNAL_ABORTED,fatal:!1,frag:t,error:new Error("Aborted"),networkDetails:s,stats:e}))},onTimeout:(e,i,s)=>{this.resetLoader(t,l),o(new Ls({type:$.NETWORK_ERROR,details:B.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,error:new Error(`Timeout after ${c.timeout}ms`),networkDetails:s,stats:e}))},onProgress:(i,s,r,n)=>{e&&e({frag:t,part:null,payload:r,networkDetails:n})}})}))}loadPart(t,e,i){this.abort();const s=this.config,r=s.fLoader,n=s.loader;return new Promise(((a,o)=>{if(this.loader&&this.loader.destroy(),t.gap||e.gap)return void o(bs(t,e));const l=this.loader=t.loader=r?new r(s):new n(s),h=Ss(t,e),d=wi(s.fragLoadPolicy.default),c={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Es};e.stats=l.stats,l.load(h,c,{onSuccess:(s,r,n,o)=>{this.resetLoader(t,l),this.updateStatsFromPart(t,e);const h={frag:t,part:e,payload:s.data,networkDetails:o};i(h),a(h)},onError:(i,s,r,n)=>{this.resetLoader(t,l),o(new Ls({type:$.NETWORK_ERROR,details:B.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:e,response:w({url:h.url,data:void 0},i),error:new Error(`HTTP Error ${i.code} ${i.text}`),networkDetails:r,stats:n}))},onAbort:(i,s,r)=>{t.stats.aborted=e.stats.aborted,this.resetLoader(t,l),o(new Ls({type:$.NETWORK_ERROR,details:B.INTERNAL_ABORTED,fatal:!1,frag:t,part:e,error:new Error("Aborted"),networkDetails:r,stats:i}))},onTimeout:(i,s,r)=>{this.resetLoader(t,l),o(new Ls({type:$.NETWORK_ERROR,details:B.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:e,error:new Error(`Timeout after ${c.timeout}ms`),networkDetails:r,stats:i}))}})}))}updateStatsFromPart(t,e){const i=t.stats,s=e.stats,r=s.total;if(i.loaded+=s.loaded,r){const s=Math.round(t.duration/e.duration),n=Math.min(Math.round(i.loaded/r),s),a=(s-n)*Math.round(i.loaded/n);i.total=i.loaded+a}else i.total=Math.max(i.loaded,i.total);const n=i.loading,a=s.loading;n.start?n.first+=a.first-a.start:(n.start=a.start,n.first=a.first),n.end=a.end}resetLoader(t,e){t.loader=null,this.loader===e&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),e.destroy()}}function Ss(t,e=null){const i=e||t,s={frag:t,part:e,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},r=i.byteRangeStartOffset,n=i.byteRangeEndOffset;if(O(r)&&O(n)){var a;let e=r,i=n;if("initSegment"===t.sn&&"AES-128"===(null==(a=t.decryptdata)?void 0:a.method)){const t=n-r;t%16&&(i=n+(16-t%16)),0!==r&&(s.resetIV=!0,e=r-16)}s.rangeStart=e,s.rangeEnd=i}return s}function bs(t,e){const i=new Error(`GAP ${t.gap?"tag":"attribute"} found`),s={type:$.MEDIA_ERROR,details:B.FRAG_GAP,fatal:!1,frag:t,error:i,networkDetails:null};return e&&(s.part=e),(e||t).stats.aborted=!0,new Ls(s)}class Ls extends Error{constructor(t){super(t.error.message),this.data=void 0,this.data=t}}class As{constructor(t,e){this.subtle=void 0,this.aesIV=void 0,this.subtle=t,this.aesIV=e}decrypt(t,e){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t)}}class Rs{constructor(t,e){this.subtle=void 0,this.key=void 0,this.subtle=t,this.key=e}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}class ks{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){const e=new DataView(t),i=new Uint32Array(4);for(let t=0;t<4;t++)i[t]=e.getUint32(4*t);return i}initTable(){const t=this.sBox,e=this.invSBox,i=this.subMix,s=i[0],r=i[1],n=i[2],a=i[3],o=this.invSubMix,l=o[0],h=o[1],d=o[2],c=o[3],u=new Uint32Array(256);let f=0,g=0,m=0;for(m=0;m<256;m++)u[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){let i=g^g<<1^g<<2^g<<3^g<<4;i=i>>>8^255&i^99,t[f]=i,e[i]=f;const o=u[f],m=u[o],p=u[m];let v=257*u[i]^16843008*i;s[f]=v<<24|v>>>8,r[f]=v<<16|v>>>16,n[f]=v<<8|v>>>24,a[f]=v,v=16843009*p^65537*m^257*o^16843008*f,l[i]=v<<24|v>>>8,h[i]=v<<16|v>>>16,d[i]=v<<8|v>>>24,c[i]=v,f?(f=o^u[u[u[p^o]]],g^=u[u[g]]):f=g=1}}expandKey(t){const e=this.uint8ArrayToUint32Array_(t);let i=!0,s=0;for(;s<e.length&&i;)i=e[s]===this.key[s],s++;if(i)return;this.key=e;const r=this.keySize=e.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);const n=this.ksRows=4*(r+6+1);let a,o;const l=this.keySchedule=new Uint32Array(n),h=this.invKeySchedule=new Uint32Array(n),d=this.sBox,c=this.rcon,u=this.invSubMix,f=u[0],g=u[1],m=u[2],p=u[3];let v,y;for(a=0;a<n;a++)a<r?v=l[a]=e[a]:(y=v,a%r==0?(y=y<<8|y>>>24,y=d[y>>>24]<<24|d[y>>>16&255]<<16|d[y>>>8&255]<<8|d[255&y],y^=c[a/r|0]<<24):r>6&&a%r==4&&(y=d[y>>>24]<<24|d[y>>>16&255]<<16|d[y>>>8&255]<<8|d[255&y]),l[a]=v=(l[a-r]^y)>>>0);for(o=0;o<n;o++)a=n-o,y=3&o?l[a]:l[a-4],h[o]=o<4||a<=4?y:f[d[y>>>24]]^g[d[y>>>16&255]]^m[d[y>>>8&255]]^p[d[255&y]],h[o]=h[o]>>>0}networkToHostOrderSwap(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24}decrypt(t,e,i){const s=this.keySize+6,r=this.invKeySchedule,n=this.invSBox,a=this.invSubMix,o=a[0],l=a[1],h=a[2],d=a[3],c=this.uint8ArrayToUint32Array_(i);let u=c[0],f=c[1],g=c[2],m=c[3];const p=new Int32Array(t),v=new Int32Array(p.length);let y,E,T,S,b,L,A,R,k,C,_,I,D,w;const P=this.networkToHostOrderSwap;for(;e<p.length;){for(k=P(p[e]),C=P(p[e+1]),_=P(p[e+2]),I=P(p[e+3]),b=k^r[0],L=I^r[1],A=_^r[2],R=C^r[3],D=4,w=1;w<s;w++)y=o[b>>>24]^l[L>>16&255]^h[A>>8&255]^d[255&R]^r[D],E=o[L>>>24]^l[A>>16&255]^h[R>>8&255]^d[255&b]^r[D+1],T=o[A>>>24]^l[R>>16&255]^h[b>>8&255]^d[255&L]^r[D+2],S=o[R>>>24]^l[b>>16&255]^h[L>>8&255]^d[255&A]^r[D+3],b=y,L=E,A=T,R=S,D+=4;y=n[b>>>24]<<24^n[L>>16&255]<<16^n[A>>8&255]<<8^n[255&R]^r[D],E=n[L>>>24]<<24^n[A>>16&255]<<16^n[R>>8&255]<<8^n[255&b]^r[D+1],T=n[A>>>24]<<24^n[R>>16&255]<<16^n[b>>8&255]<<8^n[255&L]^r[D+2],S=n[R>>>24]<<24^n[b>>16&255]<<16^n[L>>8&255]<<8^n[255&A]^r[D+3],v[e]=P(y^u),v[e+1]=P(S^f),v[e+2]=P(T^g),v[e+3]=P(E^m),u=k,f=C,g=_,m=I,e+=4}return v.buffer}}class Cs{constructor(t,{removePKCS7Padding:e=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=t.enableSoftwareAES,this.removePKCS7Padding=e,e)try{const t=self.crypto;t&&(this.subtle=t.subtle||t.webkitSubtle)}catch(t){}null===this.subtle&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:t,remainderData:e}=this;if(!t||e)return this.reset(),null;const i=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?function(t){const e=t.byteLength,i=e&&new DataView(t.buffer).getUint8(e-1);return i?Tt(t,0,e-i):t}(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(t,e,i){return this.useSoftware?new Promise(((s,r)=>{this.softwareDecrypt(new Uint8Array(t),e,i);const n=this.flush();n?s(n.buffer):r(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(t),e,i)}softwareDecrypt(t,e,i){const{currentIV:s,currentResult:r,remainderData:n}=this;this.logOnce("JS AES decrypt"),n&&(t=se(n,t),this.remainderData=null);const a=this.getValidChunk(t);if(!a.length)return null;s&&(i=s);let o=this.softwareDecrypter;o||(o=this.softwareDecrypter=new ks),o.expandKey(e);const l=r;return this.currentResult=o.decrypt(a.buffer,0,i),this.currentIV=Tt(a,-16).buffer,l||null}webCryptoDecrypt(t,e,i){const s=this.subtle;return this.key===e&&this.fastAesKey||(this.key=e,this.fastAesKey=new Rs(s,e)),this.fastAesKey.expandKey().then((e=>{if(!s)return Promise.reject(new Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");return new As(s,new Uint8Array(i)).decrypt(t.buffer,e)})).catch((s=>(j.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(t,e,i))))}onWebCryptoError(t,e,i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,e,i);const s=this.flush();if(s)return s.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(t){let e=t;const i=t.length-t.length%16;return i!==t.length&&(e=Tt(t,0,i),this.remainderData=Tt(t,i)),e}logOnce(t){this.logEnabled&&(j.log(`[decrypter]: ${t}`),this.logEnabled=!1)}}const _s=function(t){let e="";const i=t.length;for(let s=0;s<i;s++)e+=`[${t.start(s).toFixed(3)}-${t.end(s).toFixed(3)}]`;return e},Is="STOPPED",Ds="IDLE",ws="KEY_LOADING",Ps="FRAG_LOADING",xs="FRAG_LOADING_WAITING_RETRY",Ms="WAITING_TRACK",Os="PARSING",Fs="PARSED",Ns="ENDED",Us="ERROR",$s="WAITING_INIT_PTS",Bs="WAITING_LEVEL";class Gs extends ss{constructor(t,e,i,s,r){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Is,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=r,this.logPrefix=s,this.log=j.log.bind(j,`${s}:`),this.warn=j.warn.bind(j,`${s}:`),this.hls=t,this.fragmentLoader=new Ts(t.config),this.keyLoader=i,this.fragmentTracker=e,this.config=t.config,this.decrypter=new Cs(t.config),t.on(U.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const t=this.fragCurrent;null!=t&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Is}_streamEnded(t,e){if(e.live||t.nextStart||!t.end||!this.media)return!1;const i=e.partList;if(null!=i&&i.length){const t=i[i.length-1];return us.isBuffered(this.media,t.start+t.duration/2)}const s=e.fragments[e.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(s)}getLevelDetails(){var t;if(this.levels&&null!==this.levelLastLoaded)return null==(t=this.levelLastLoaded)?void 0:t.details}onMediaAttached(t,e){const i=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),i.addEventListener("seeking",this.onvseeking),i.addEventListener("ended",this.onvended);const s=this.config;this.levels&&s.autoStartLoad&&this.state===Is&&this.startLoad(s.startPosition)}onMediaDetaching(){const t=this.media;null!=t&&t.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&this.onvseeking&&this.onvended&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:t,fragCurrent:e,media:i,mediaBuffer:s,state:r}=this,n=i?i.currentTime:0,a=us.bufferInfo(s||i,n,t.maxBufferHole);if(this.log(`media seeking to ${O(n)?n.toFixed(3):n}, state: ${r}`),this.state===Ns)this.resetLoadingState();else if(e){const i=t.maxFragLookUpTolerance,s=e.start-i,r=e.start+e.duration+i;if(!a.len||r<a.start||s>a.end){const t=n>r;(n<s||t)&&(t&&e.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),e.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}i&&(this.fragmentTracker.removeFragmentsInRange(n,1/0,this.playlistType,!0),this.lastCurrentTime=n),this.loadedmetadata||a.len||(this.nextLoadPosition=this.startPosition=n),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(t,e){this.startTimeOffset=e.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(U.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=Is,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,e,i){this._loadFragForPlayback(t,e,i)}_loadFragForPlayback(t,e,i){this._doFragLoad(t,e,i,(e=>{if(this.fragContextChanged(t))return this.warn(`Fragment ${t.sn}${e.part?" p: "+e.part.index:""} of level ${t.level} was dropped during download.`),void this.fragmentTracker.removeFragment(t);t.stats.chunkCount++,this._handleFragmentLoadProgress(e)})).then((e=>{if(!e)return;const i=this.state;this.fragContextChanged(t)?(i===Ps||!this.fragCurrent&&i===Os)&&(this.fragmentTracker.removeFragment(t),this.state=Ds):("payload"in e&&(this.log(`Loaded fragment ${t.sn} of level ${t.level}`),this.hls.trigger(U.FRAG_LOADED,e)),this._handleFragmentLoadComplete(e))})).catch((e=>{this.state!==Is&&this.state!==Us&&(this.warn(e),this.resetFragmentLoading(t))}))}clearTrackerIfNeeded(t){var e;const{fragmentTracker:i}=this;if(i.getState(t)===ns){const e=t.type,s=this.getFwdBufferInfo(this.mediaBuffer,e),r=Math.max(t.duration,s?s.len:this.config.maxBufferLength);this.reduceMaxBufferLength(r)&&i.removeFragment(t)}else 0===(null==(e=this.mediaBuffer)?void 0:e.buffered.length)?i.removeAllFragments():i.hasParts(t.type)&&(i.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),i.getState(t)===as&&i.removeFragment(t))}checkLiveUpdate(t){if(t.updated&&!t.live){const e=t.fragments[t.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type})}t.fragments[0]||(t.deltaUpdateFailed=!0)}flushMainBuffer(t,e,i=null){if(!(t-e))return;const s={startOffset:t,endOffset:e,type:i};this.hls.trigger(U.BUFFER_FLUSHING,s)}_loadInitSegment(t,e){this._doFragLoad(t,e).then((e=>{if(!e||this.fragContextChanged(t)||!this.levels)throw new Error("init load aborted");return e})).then((e=>{const{hls:i}=this,{payload:s}=e,r=t.decryptdata;if(s&&s.byteLength>0&&null!=r&&r.key&&r.iv&&"AES-128"===r.method){const n=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),r.key.buffer,r.iv.buffer).catch((e=>{throw (i.trigger(U.ERROR,{type:$.MEDIA_ERROR,details:B.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}), e)})).then((s=>{const r=self.performance.now();return i.trigger(U.FRAG_DECRYPTED,{frag:t,payload:s,stats:{tstart:n,tdecrypt:r}}),e.payload=s,this.completeInitSegmentLoad(e)}));}return this.completeInitSegmentLoad(e)})).catch((e=>{this.state!==Is&&this.state!==Us&&(this.warn(e),this.resetFragmentLoading(t))}))}completeInitSegmentLoad(t){const{levels:e}=this;if(!e)throw new Error("init load aborted, missing levels");const i=t.frag.stats;this.state=Ds,t.frag.data=new Uint8Array(t.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}fragContextChanged(t){const{fragCurrent:e}=this;return!t||!e||t.sn!==e.sn||t.level!==e.level}fragBufferedComplete(t,e){var i,s,r,n;const a=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.playlistType===je?"level":"track"} ${t.level} (frag:[${(null!=(i=t.startPTS)?i:NaN).toFixed(3)}-${(null!=(s=t.endPTS)?s:NaN).toFixed(3)}] > buffer:${a?_s(us.getBuffered(a)):"(detached)"})`),"initSegment"!==t.sn){var o;if(t.type!==ze){const e=t.elementaryStreams;if(!Object.keys(e).some((t=>!!e[t])))return void(this.state=Ds)}const e=null==(o=this.levels)?void 0:o[t.level];null!=e&&e.fragmentError&&(this.log(`Resetting level fragment error count of ${e.fragmentError} on frag buffered`),e.fragmentError=0)}this.state=Ds,a&&(!this.loadedmetadata&&t.type==je&&a.buffered.length&&(null==(r=this.fragCurrent)?void 0:r.sn)===(null==(n=this.fragPrevious)?void 0:n.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(t){const{transmuxer:e}=this;if(!e)return;const{frag:i,part:s,partsLoaded:r}=t,n=!r||0===r.length||r.some((t=>!t)),a=new fs(i.level,i.sn,i.stats.chunkCount+1,0,s?s.index:-1,!n);e.flush(a)}_handleFragmentLoadProgress(t){}_doFragLoad(t,e,i=null,s){var r;const n=null==e?void 0:e.details;if(!this.levels||!n)throw new Error(`frag load aborted, missing level${n?"":" detail"}s`);let a=null;if(!t.encrypted||null!=(r=t.decryptdata)&&r.key?!t.encrypted&&n.encryptedFragments.length&&this.keyLoader.loadClear(t,n.encryptedFragments):(this.log(`Loading key for ${t.sn} of [${n.startSN}-${n.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${t.level}`),this.state=ws,this.fragCurrent=t,a=this.keyLoader.load(t).then((t=>{if(!this.fragContextChanged(t.frag))return this.hls.trigger(U.KEY_LOADED,t),this.state===ws&&(this.state=Ds),t})),this.hls.trigger(U.KEY_LOADING,{frag:t}),null===this.fragCurrent&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),i=Math.max(t.start,i||0),this.config.lowLatencyMode&&"initSegment"!==t.sn){const r=n.partList;if(r&&s){i>t.end&&n.fragmentHint&&(t=n.fragmentHint);const o=this.getNextPart(r,t,i);if(o>-1){const l=r[o];let h;return this.log(`Loading part sn: ${t.sn} p: ${l.index} cc: ${t.cc} of playlist [${n.startSN}-${n.endSN}] parts [0-${o}-${r.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${t.level}, target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=l.start+l.duration,this.state=Ps,h=a?a.then((i=>!i||this.fragContextChanged(i.frag)?null:this.doFragPartsLoad(t,l,e,s))).catch((t=>this.handleFragLoadError(t))):this.doFragPartsLoad(t,l,e,s).catch((t=>this.handleFragLoadError(t))),this.hls.trigger(U.FRAG_LOADING,{frag:t,part:l,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):h}if(!t.url||this.loadedEndOfParts(r,i))return Promise.resolve(null)}}this.log(`Loading fragment ${t.sn} cc: ${t.cc} ${n?"of ["+n.startSN+"-"+n.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${t.level}, target: ${parseFloat(i.toFixed(3))}`),O(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state=Ps;const o=this.config.progressive;let l;return l=o&&a?a.then((e=>!e||this.fragContextChanged(null==e?void 0:e.frag)?null:this.fragmentLoader.load(t,s))).catch((t=>this.handleFragLoadError(t))):Promise.all([this.fragmentLoader.load(t,o?s:void 0),a]).then((([t])=>(!o&&t&&s&&s(t),t))).catch((t=>this.handleFragLoadError(t))),this.hls.trigger(U.FRAG_LOADING,{frag:t,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):l}doFragPartsLoad(t,e,i,s){return new Promise(((r,n)=>{var a;const o=[],l=null==(a=i.details)?void 0:a.partList,h=e=>{this.fragmentLoader.loadPart(t,e,s).then((s=>{o[e.index]=s;const n=s.part;this.hls.trigger(U.FRAG_LOADED,s);const a=Ri(i,t.sn,e.index+1)||ki(l,t.sn,e.index+1);if(!a)return r({frag:t,part:n,partsLoaded:o});h(a)})).catch(n)};h(e)}))}handleFragLoadError(t){if("data"in t){const e=t.data;t.data&&e.details===B.INTERNAL_ABORTED?this.handleFragLoadAborted(e.frag,e.part):this.hls.trigger(U.ERROR,e)}else this.hls.trigger(U.ERROR,{type:$.OTHER_ERROR,details:B.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0});return null}_handleTransmuxerFlush(t){const e=this.getCurrentContext(t);if(!e||this.state!==Os)return void(this.fragCurrent||this.state===Is||this.state===Us||(this.state=Ds));const{frag:i,part:s,level:r}=e,n=self.performance.now();i.stats.parsing.end=n,s&&(s.stats.parsing.end=n),this.updateLevelTiming(i,s,r,t.partial)}getCurrentContext(t){const{levels:e,fragCurrent:i}=this,{level:s,sn:r,part:n}=t;if(null==e||!e[s])return this.warn(`Levels object was unset while buffering fragment ${r} of level ${s}. The current chunk will not be buffered.`),null;const a=e[s],o=n>-1?Ri(a,r,n):null,l=o?o.fragment:function(t,e,i){if(null==t||!t.details)return null;const s=t.details;let r=s.fragments[e-s.startSN];return r||(r=s.fragmentHint,r&&r.sn===e?r:e<s.startSN&&i&&i.sn===e?i:null)}(a,r,i);return l?(i&&i!==l&&(l.stats=i.stats),{frag:l,part:o,level:a}):null}bufferFragmentData(t,e,i,s,r){var n;if(!t||this.state!==Os)return;const{data1:a,data2:o}=t;let l=a;if(a&&o&&(l=se(a,o)),null==(n=l)||!n.length)return;const h={type:t.type,frag:e,part:i,chunkMeta:s,parent:e.type,data:l};if(this.hls.trigger(U.BUFFER_APPENDING,h),t.dropped&&t.independent&&!i){if(r)return;this.flushBufferGap(e)}}flushBufferGap(t){const e=this.media;if(!e)return;if(!us.isBuffered(e,e.currentTime))return void this.flushMainBuffer(0,t.start);const i=e.currentTime,s=us.bufferInfo(e,i,0),r=t.duration,n=Math.min(2*this.config.maxFragLookUpTolerance,.25*r),a=Math.max(Math.min(t.start-n,s.end-n),i+n);t.start-a>n&&this.flushMainBuffer(a,t.start)}getFwdBufferInfo(t,e){const i=this.getLoadPosition();return O(i)?this.getFwdBufferInfoAtPos(t,i,e):null}getFwdBufferInfoAtPos(t,e,i){const{config:{maxBufferHole:s}}=this,r=us.bufferInfo(t,e,s);if(0===r.len&&void 0!==r.nextStart){const n=this.fragmentTracker.getBufferedFrag(e,i);if(n&&r.nextStart<n.end)return us.bufferInfo(t,e,Math.max(r.nextStart,s))}return r}getMaxBufferLength(t){const{config:e}=this;let i;return i=t?Math.max(8*e.maxBufferSize/t,e.maxBufferLength):e.maxBufferLength,Math.min(i,e.maxMaxBufferLength)}reduceMaxBufferLength(t){const e=this.config,i=t||e.maxBufferLength;return e.maxMaxBufferLength>=i&&(e.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${e.maxMaxBufferLength}s`),!0)}getAppendedFrag(t,e=je){const i=this.fragmentTracker.getAppendedFrag(t,je);return i&&"fragment"in i?i.fragment:i}getNextFragment(t,e){const i=e.fragments,s=i.length;if(!s)return null;const{config:r}=this,n=i[0].start;let a;if(e.live){const o=r.initialLiveManifestSize;if(s<o)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${o})`),null;(!e.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||t<n)&&(a=this.getInitialLiveFragment(e,i),this.startPosition=this.nextLoadPosition=a?this.hls.liveSyncPosition||a.start:t)}else t<=n&&(a=i[0]);if(!a){const i=r.lowLatencyMode?e.partEnd:e.fragmentEnd;a=this.getFragmentAtPosition(t,i,e)}return this.mapToInitFragWhenRequired(a)}isLoopLoading(t,e){const i=this.fragmentTracker.getState(t);return(i===os||i===as&&!!t.gap)&&this.nextLoadPosition>e}getNextFragmentLoopLoading(t,e,i,s,r){const n=t.gap,a=this.getNextFragment(this.nextLoadPosition,e);if(null===a)return a;if(t=a,n&&t&&!t.gap&&i.nextStart){const e=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,s);if(null!==e&&i.len+e.len>=r)return this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${t.sn}`),null}return t}mapToInitFragWhenRequired(t){return null==t||!t.initSegment||null!=t&&t.initSegment.data||this.bitrateTest?t:t.initSegment}getNextPart(t,e,i){let s=-1,r=!1,n=!0;for(let a=0,o=t.length;a<o;a++){const o=t[a];if(n=n&&!o.independent,s>-1&&i<o.start)break;const l=o.loaded;l?s=-1:(r||o.independent||n)&&o.fragment===e&&(s=a),r=l}return s}loadedEndOfParts(t,e){const i=t[t.length-1];return i&&e>i.start&&i.loaded}getInitialLiveFragment(t,e){const i=this.fragPrevious;let s=null;if(i){if(t.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),s=function(t,e,i){if(null===e||!Array.isArray(t)||!t.length||!O(e))return null;if(e<(t[0].programDateTime||0))return null;if(e>=(t[t.length-1].endProgramDateTime||0))return null;i=i||0;for(let s=0;s<t.length;++s){const r=t[s];if(Fi(e,i,r))return r}return null}(e,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){const r=i.sn+1;if(r>=t.startSN&&r<=t.endSN){const n=e[r-t.startSN];i.cc===n.cc&&(s=n,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=function(t,e){return xi(t,(t=>t.cc<e?1:t.cc>e?-1:0))}(e,i.cc),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{const e=this.hls.liveSyncPosition;null!==e&&(s=this.getFragmentAtPosition(e,this.bitrateTest?t.fragmentEnd:t.edge,t))}return s}getFragmentAtPosition(t,e,i){const{config:s}=this;let{fragPrevious:r}=this,{fragments:n,endSN:a}=i;const{fragmentHint:o}=i,l=s.maxFragLookUpTolerance,h=i.partList,d=!!(s.lowLatencyMode&&null!=h&&h.length&&o);let c;if(d&&o&&!this.bitrateTest&&(n=n.concat(o),a=o.sn),t<e){c=Mi(r,n,t,t>e-l?0:l)}else c=n[n.length-1];if(c){const t=c.sn-i.startSN,e=this.fragmentTracker.getState(c);if((e===os||e===as&&c.gap)&&(r=c),r&&c.sn===r.sn&&(!d||h[0].fragment.sn>c.sn)){if(r&&c.level===r.level){const e=n[t+1];c=c.sn<a&&this.fragmentTracker.getState(e)!==os?e:null}}}return c}synchronizeToLiveEdge(t){const{config:e,media:i}=this;if(!i)return;const s=this.hls.liveSyncPosition,r=i.currentTime,n=t.fragments[0].start,a=t.edge,o=r>=n-e.maxFragLookUpTolerance&&r<=a;if(null!==s&&i.duration>s&&(r<s||!o)){const n=void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:e.liveMaxLatencyDurationCount*t.targetduration;(!o&&i.readyState<4||r<a-n)&&(this.loadedmetadata||(this.nextLoadPosition=s),i.readyState&&(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${s.toFixed(3)}`),i.currentTime=s))}}alignPlaylists(t,e,i){const s=t.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;const r=t.fragments[0].start,n=!e,a=t.alignedSliding&&O(r);if(n||!a&&!r){const{fragPrevious:r}=this;vs(r,i,t);const n=t.fragments[0].start;return this.log(`Live playlist sliding: ${n.toFixed(2)} start-sn: ${e?e.startSN:"na"}->${t.startSN} prev-sn: ${r?r.sn:"na"} fragments: ${s}`),n}return r}waitForCdnTuneIn(t){return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,3*t.partTarget)}setStartPosition(t,e){let i=this.startPosition;if(i<e&&(i=-1),-1===i||-1===this.lastCurrentTime){const s=null!==this.startTimeOffset,r=s?this.startTimeOffset:t.startTimeOffset;null!==r&&O(r)?(i=e+r,r<0&&(i+=t.totalduration),i=Math.min(Math.max(e,i),e+t.totalduration),this.log(`Start time offset ${r} found in ${s?"multivariant":"media"} playlist, adjust startPosition to ${i}`),this.startPosition=i):t.live?i=this.hls.liveSyncPosition||e:this.startPosition=i=0,this.lastCurrentTime=i}this.nextLoadPosition=i}getLoadPosition(){const{media:t}=this;let e=0;return this.loadedmetadata&&t?e=t.currentTime:this.nextLoadPosition&&(e=this.nextLoadPosition),e}handleFragLoadAborted(t,e){this.transmuxer&&"initSegment"!==t.sn&&t.stats.aborted&&(this.warn(`Fragment ${t.sn}${e?" part "+e.index:""} of level ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){this.fragCurrent&&(this.fragContextChanged(t)||this.state===xs)||(this.state=Ds)}onFragmentOrKeyLoadError(t,e){if(e.chunkMeta&&!e.frag){const t=this.getCurrentContext(e.chunkMeta);t&&(e.frag=t.frag)}const i=e.frag;if(!i||i.type!==t||!this.levels)return;var s;if(this.fragContextChanged(i))return void this.warn(`Frag load error must match current frag to retry ${i.url} > ${null==(s=this.fragCurrent)?void 0:s.url}`);const r=e.details===B.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(i,!0);const n=e.errorAction,{action:a,retryCount:o=0,retryConfig:l}=n||{};if(n&&a===Bi&&l){this.resetStartWhenNotLoaded(this.levelLastLoaded);const s=Di(l,o);this.warn(`Fragment ${i.sn} of ${t} ${i.level} errored with ${e.details}, retrying loading ${o+1}/${l.maxNumRetry} in ${s}ms`),n.resolved=!0,this.retryDate=self.performance.now()+s,this.state=xs}else if(l&&n){if(this.resetFragmentErrors(t),!(o<l.maxNumRetry))return void j.warn(`${e.details} reached or exceeded max retry (${o})`);r||a===$i||(n.resolved=!0)}else(null==n?void 0:n.action)===Ui?this.state=Bs:this.state=Us;this.tickImmediate()}reduceLengthAndFlushBuffer(t){if(this.state===Os||this.state===Fs){const e=t.parent,i=this.getFwdBufferInfo(this.mediaBuffer,e),s=i&&i.len>.5;s&&this.reduceMaxBufferLength(i.len);const r=!s;return r&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${e} buffer`),t.frag&&(this.fragmentTracker.removeFragment(t.frag),this.nextLoadPosition=t.frag.start),this.resetLoadingState(),r}return!1}resetFragmentErrors(t){t===We&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==Is&&(this.state=Ds)}afterBufferFlushed(t,e,i){if(!t)return;const s=us.getBuffered(t);this.fragmentTracker.detectEvictedFragments(e,s,i),this.state===Ns&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Ds}resetStartWhenNotLoaded(t){if(!this.loadedmetadata){this.startFragRequested=!1;const e=t?t.details:null;null!=e&&e.live?(this.startPosition=-1,this.setStartPosition(e,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(t){this.warn(`The loading context changed while buffering fragment ${t.sn} of level ${t.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(t=0){this.fragmentTracker.removeFragmentsInRange(t,1/0,this.playlistType,!1,!0)}updateLevelTiming(t,e,i,s){var r;const n=i.details;if(!n)return void this.warn("level.details undefined");if(!Object.keys(t.elementaryStreams).reduce(((e,r)=>{const a=t.elementaryStreams[r];if(a){const o=a.endPTS-a.startPTS;if(o<=0)return this.warn(`Could not parse fragment ${t.sn} ${r} duration reliably (${o})`),e||!1;const l=s?0:Si(n,t,a.startPTS,a.endPTS,a.startDTS,a.endDTS);return this.hls.trigger(U.LEVEL_PTS_UPDATED,{details:n,level:i,drift:l,type:r,frag:t,start:a.startPTS,end:a.endPTS}),!0}return e}),!1)&&null===(null==(r=this.transmuxer)?void 0:r.error)){const e=new Error(`Found no media in fragment ${t.sn} of level ${t.level} resetting transmuxer to fallback to playlist timing`);if(0===i.fragmentError&&(i.fragmentError++,t.gap=!0,this.fragmentTracker.removeFragment(t),this.fragmentTracker.fragBuffered(t,!0)),this.warn(e.message),this.hls.trigger(U.ERROR,{type:$.MEDIA_ERROR,details:B.FRAG_PARSING_ERROR,fatal:!1,error:e,frag:t,reason:`Found no media in msn ${t.sn} of level "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Fs,this.hls.trigger(U.FRAG_PARSED,{frag:t,part:e})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(t){"demuxerWorker"===t.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(t){const e=this._state;e!==t&&(this._state=t,this.log(`${e}->${t}`))}get state(){return this._state}}class Hs{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){const{chunks:t,dataLength:e}=this;let i;return t.length?(i=1===t.length?t[0]:function(t,e){const i=new Uint8Array(e);let s=0;for(let e=0;e<t.length;e++){const r=t[e];i.set(r,s),s+=r.length}return i}(t,e),this.reset(),i):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function Vs(t="",e=9e4){return{type:t,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Ks{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,e,i,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,e){return!1}appendFrame(t,e,i){}demux(t,e){this.cachedData&&(t=se(this.cachedData,t),this.cachedData=null);let i,s=Lt(t,0),r=s?s.length:0;const n=this._audioTrack,a=this._id3Track,o=s?kt(s):void 0,l=t.length;for((null===this.basePTS||0===this.frameIndex&&O(o))&&(this.basePTS=js(o,e,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),s&&s.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:s,type:ii,duration:Number.POSITIVE_INFINITY});r<l;){if(this.canParse(t,r)){const e=this.appendFrame(n,t,r);e?(this.frameIndex++,this.lastPTS=e.sample.pts,r+=e.length,i=r):r=l}else Rt(t,r)?(s=Lt(t,r),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:s,type:ii,duration:Number.POSITIVE_INFINITY}),r+=s.length,i=r):r++;if(r===l&&i!==l){const e=Tt(t,i);this.cachedData?this.cachedData=se(this.cachedData,e):this.cachedData=e}}return{audioTrack:n,videoTrack:Vs(),id3Track:a,textTrack:Vs()}}demuxSampleAes(t,e,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){const e=this.cachedData;return e&&(this.cachedData=null,this.demux(e,0)),{audioTrack:this._audioTrack,videoTrack:Vs(),id3Track:this._id3Track,textTrack:Vs()}}destroy(){}}const js=(t,e,i)=>{if(O(t))return 90*t;return 9e4*e+(i?9e4*i.baseTime/i.timescale:0)};function Ws(t,e){return 255===t[e]&&240==(246&t[e+1])}function zs(t,e){return 1&t[e+1]?7:9}function Ys(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function qs(t,e){return e+1<t.length&&Ws(t,e)}function Xs(t,e){if(qs(t,e)){const i=zs(t,e);if(e+i>=t.length)return!1;const s=Ys(t,e);if(s<=i)return!1;const r=e+s;return r===t.length||qs(t,r)}return!1}function Qs(t,e,i,s,r){if(!t.samplerate){const n=function(t,e,i,s){let r,n,a,o;const l=navigator.userAgent.toLowerCase(),h=s,d=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=1+((192&e[i+2])>>>6);const c=(60&e[i+2])>>>2;if(!(c>d.length-1))return a=(1&e[i+2])<<2,a|=(192&e[i+3])>>>6,j.log(`manifest codec:${s}, ADTS type:${r}, samplingIndex:${c}`),/firefox/i.test(l)?c>=6?(r=5,o=new Array(4),n=c-3):(r=2,o=new Array(2),n=c):-1!==l.indexOf("android")?(r=2,o=new Array(2),n=c):(r=5,o=new Array(4),s&&(-1!==s.indexOf("mp4a.40.29")||-1!==s.indexOf("mp4a.40.5"))||!s&&c>=6?n=c-3:((s&&-1!==s.indexOf("mp4a.40.2")&&(c>=6&&1===a||/vivaldi/i.test(l))||!s&&1===a)&&(r=2,o=new Array(2)),n=c)),o[0]=r<<3,o[0]|=(14&c)>>1,o[1]|=(1&c)<<7,o[1]|=a<<3,5===r&&(o[1]|=(14&n)>>1,o[2]=(1&n)<<7,o[2]|=8,o[3]=0),{config:o,samplerate:d[c],channelCount:a,codec:"mp4a.40."+r,manifestCodec:h};{const e=new Error(`invalid ADTS sampling index:${c}`);t.emit(U.ERROR,U.ERROR,{type:$.MEDIA_ERROR,details:B.FRAG_PARSING_ERROR,fatal:!0,error:e,reason:e.message})}}(e,i,s,r);if(!n)return;t.config=n.config,t.samplerate=n.samplerate,t.channelCount=n.channelCount,t.codec=n.codec,t.manifestCodec=n.manifestCodec,j.log(`parsed codec:${t.codec}, rate:${n.samplerate}, channels:${n.channelCount}`)}}function Js(t){return 9216e4/t}function Zs(t,e,i,s,r){const n=s+r*Js(t.samplerate),a=function(t,e){const i=zs(t,e);if(e+i<=t.length){const s=Ys(t,e)-i;if(s>0)return{headerLength:i,frameLength:s}}}(e,i);let o;if(a){const{frameLength:s,headerLength:r}=a,l=r+s,h=Math.max(0,i+l-e.length);h?(o=new Uint8Array(l-r),o.set(e.subarray(i+r,e.length),0)):o=e.subarray(i+r,i+l);const d={unit:o,pts:n};return h||t.samples.push(d),{sample:d,length:l,missing:h}}const l=e.length-i;o=new Uint8Array(l),o.set(e.subarray(i,e.length),0);return{sample:{unit:o,pts:n},length:l,missing:-1}}let tr=null;const er=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],ir=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],sr=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],rr=[0,1,1,4];function nr(t,e,i,s,r){if(i+24>e.length)return;const n=ar(e,i);if(n&&i+n.frameLength<=e.length){const a=s+r*(9e4*n.samplesPerFrame/n.sampleRate),o={unit:e.subarray(i,i+n.frameLength),pts:a,dts:a};return t.config=[],t.channelCount=n.channelCount,t.samplerate=n.sampleRate,t.samples.push(o),{sample:o,length:n.frameLength,missing:0}}}function ar(t,e){const i=t[e+1]>>3&3,s=t[e+1]>>1&3,r=t[e+2]>>4&15,n=t[e+2]>>2&3;if(1!==i&&0!==r&&15!==r&&3!==n){const a=t[e+2]>>1&1,o=t[e+3]>>6,l=1e3*er[14*(3===i?3-s:3===s?3:4)+r-1],h=ir[3*(3===i?0:2===i?1:2)+n],d=3===o?1:2,c=sr[i][s],u=rr[s],f=8*c*u,g=Math.floor(c*l/h+a)*u;if(null===tr){const t=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);tr=t?parseInt(t[1]):0}return!!tr&&tr<=87&&2===s&&l>=224e3&&0===o&&(t[e+3]=128|t[e+3]),{sampleRate:h,channelCount:d,frameLength:g,samplesPerFrame:f}}}function or(t,e){return!(255!==t[e]||224&~t[e+1]||!(6&t[e+1]))}function lr(t,e){return e+1<t.length&&or(t,e)}function hr(t,e){if(e+1<t.length&&or(t,e)){const i=4,s=ar(t,e);let r=i;null!=s&&s.frameLength&&(r=s.frameLength);const n=e+r;return n===t.length||lr(t,n)}return!1}const dr=/\/emsg[-/]ID3/i;const cr=(t,e)=>{let i=0,s=5;e+=s;const r=new Uint32Array(1),n=new Uint32Array(1),a=new Uint8Array(1);for(;s>0;){a[0]=t[e];const o=Math.min(s,8),l=8-o;n[0]=4278190080>>>24+l<<l,r[0]=(a[0]&n[0])>>l,i=i?i<<o|r[0]:r[0],e+=1,s-=o}return i};class ur extends Ks{constructor(t){super(),this.observer=void 0,this.observer=t}resetInitSegment(t,e,i,s){super.resetInitSegment(t,e,i,s),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:e,duration:s,inputTimeScale:9e4,dropped:0}}canParse(t,e){return e+64<t.length}appendFrame(t,e,i){const s=fr(t,e,i,this.basePTS,this.frameIndex);if(-1!==s){return{sample:t.samples[t.samples.length-1],length:s,missing:0}}}static probe(t){if(!t)return!1;const e=Lt(t,0);if(!e)return!1;const i=e.length;return 11===t[i]&&119===t[i+1]&&void 0!==kt(e)&&cr(t,i)<16}}function fr(t,e,i,s,r){if(i+8>e.length)return-1;if(11!==e[i]||119!==e[i+1])return-1;const n=e[i+4]>>6;if(n>=3)return-1;const a=[48e3,44100,32e3][n],o=63&e[i+4],l=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*o+n];if(i+l>e.length)return-1;const h=e[i+6]>>5;let d=0;2===h?d+=2:(1&h&&1!==h&&(d+=2),4&h&&(d+=2));const c=(e[i+6]<<8|e[i+7])>>12-d&1,u=[2,1,2,3,3,4,4,5][h]+c,f=e[i+5]>>3,g=7&e[i+5],m=new Uint8Array([n<<6|f<<1|g>>2,(3&g)<<6|h<<3|c<<2|o>>4,o<<4&224]),p=s+r*(1536/a*9e4),v=e.subarray(i,i+l);return t.config=m,t.channelCount=u,t.samplerate=a,t.samples.push({unit:v,pts:p}),l}class gr{constructor(){this.VideoSample=null}createVideoSample(t,e,i,s){return{key:t,frame:!1,pts:e,dts:i,units:[],debug:s,length:0}}getLastNalUnit(t){var e;let i,s=this.VideoSample;if(s&&0!==s.units.length||(s=t[t.length-1]),null!=(e=s)&&e.units){const t=s.units;i=t[t.length-1]}return i}pushAccessUnit(t,e){if(t.units.length&&t.frame){if(void 0===t.pts){const i=e.samples,s=i.length;if(!s)return void e.dropped++;{const e=i[s-1];t.pts=e.pts,t.dts=e.dts}}e.samples.push(t)}t.debug.length&&j.log(t.pts+"/"+t.dts+":"+t.debug)}}class mr{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const t=this.data,e=this.bytesAvailable,i=t.byteLength-e,s=new Uint8Array(4),r=Math.min(4,e);if(0===r)throw new Error("no bytes available");s.set(t.subarray(i,i+r)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r}skipBits(t){let e;t=Math.min(t,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(e=(t-=this.bitsAvailable)>>3,t-=e<<3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)}readBits(t){let e=Math.min(this.bitsAvailable,t);const i=this.word>>>32-e;if(t>32&&j.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0)this.word<<=e;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return e=t-e,e>0&&this.bitsAvailable?i<<e|this.readBits(e):i}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if(this.word&2147483648>>>t)return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const t=this.skipLZ();return this.readBits(t+1)-1}readEG(){const t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(t){let e,i=8,s=8;for(let r=0;r<t;r++)0!==s&&(e=this.readEG(),s=(i+e+256)%256),i=0===s?i:s}readSPS(){let t,e,i,s=0,r=0,n=0,a=0;const o=this.readUByte.bind(this),l=this.readBits.bind(this),h=this.readUEG.bind(this),d=this.readBoolean.bind(this),c=this.skipBits.bind(this),u=this.skipEG.bind(this),f=this.skipUEG.bind(this),g=this.skipScalingList.bind(this);o();const m=o();if(l(5),c(3),o(),f(),100===m||110===m||122===m||244===m||44===m||83===m||86===m||118===m||128===m){const t=h();if(3===t&&c(1),f(),f(),c(1),d())for(e=3!==t?8:12,i=0;i<e;i++)d()&&g(i<6?16:64)}f();const p=h();if(0===p)h();else if(1===p)for(c(1),u(),u(),t=h(),i=0;i<t;i++)u();f(),c(1);const v=h(),y=h(),E=l(1);0===E&&c(1),c(1),d()&&(s=h(),r=h(),n=h(),a=h());let T=[1,1];if(d()&&d()){switch(o()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[o()<<8|o(),o()<<8|o()]}}return{width:Math.ceil(16*(v+1)-2*s-2*r),height:(2-E)*(y+1)*16-(E?2:4)*(n+a),pixelRatio:T}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class pr extends gr{parseAVCPES(t,e,i,s,r){const n=this.parseAVCNALu(t,i.data);let a,o=this.VideoSample,l=!1;i.data=null,o&&n.length&&!t.audFound&&(this.pushAccessUnit(o,t),o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts,"")),n.forEach((s=>{var n;switch(s.type){case 1:{let e=!1;a=!0;const r=s.data;if(l&&r.length>4){const t=new mr(r).readSliceType();2!==t&&4!==t&&7!==t&&9!==t||(e=!0)}var h;if(e)null!=(h=o)&&h.frame&&!o.key&&(this.pushAccessUnit(o,t),o=this.VideoSample=null);o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts,"")),o.frame=!0,o.key=e;break}case 5:a=!0,null!=(n=o)&&n.frame&&!o.key&&(this.pushAccessUnit(o,t),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts,"")),o.key=!0,o.frame=!0;break;case 6:a=!0,ae(s.data,1,i.pts,e.samples);break;case 7:{var d,c;a=!0,l=!0;const e=s.data,i=new mr(e).readSPS();if(!t.sps||t.width!==i.width||t.height!==i.height||(null==(d=t.pixelRatio)?void 0:d[0])!==i.pixelRatio[0]||(null==(c=t.pixelRatio)?void 0:c[1])!==i.pixelRatio[1]){t.width=i.width,t.height=i.height,t.pixelRatio=i.pixelRatio,t.sps=[e],t.duration=r;const s=e.subarray(1,4);let n="avc1.";for(let t=0;t<3;t++){let e=s[t].toString(16);e.length<2&&(e="0"+e),n+=e}t.codec=n}break}case 8:a=!0,t.pps=[s.data];break;case 9:a=!0,t.audFound=!0,o&&this.pushAccessUnit(o,t),o=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts,"");break;case 12:a=!0;break;default:a=!1,o&&(o.debug+="unknown NAL "+s.type+" ")}if(o&&a){o.units.push(s)}})),s&&o&&(this.pushAccessUnit(o,t),this.VideoSample=null)}parseAVCNALu(t,e){const i=e.byteLength;let s=t.naluState||0;const r=s,n=[];let a,o,l,h=0,d=-1,c=0;for(-1===s&&(d=0,c=31&e[0],s=0,h=1);h<i;)if(a=e[h++],s)if(1!==s)if(a)if(1===a){if(o=h-s-1,d>=0){const t={data:e.subarray(d,o),type:c};n.push(t)}else{const i=this.getLastNalUnit(t.samples);i&&(r&&h<=4-r&&i.state&&(i.data=i.data.subarray(0,i.data.byteLength-r)),o>0&&(i.data=se(i.data,e.subarray(0,o)),i.state=0))}h<i?(l=31&e[h],d=h,c=l,s=0):s=-1}else s=0;else s=3;else s=a?0:2;else s=a?0:1;if(d>=0&&s>=0){const t={data:e.subarray(d,i),type:c,state:s};n.push(t)}if(0===n.length){const i=this.getLastNalUnit(t.samples);i&&(i.data=se(i.data,e))}return t.naluState=s,n}}class vr{constructor(t,e,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new Cs(e,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(t,e,i){const s=t[e].unit;if(s.length<=16)return;const r=s.subarray(16,s.length-s.length%16),n=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(n).then((r=>{const n=new Uint8Array(r);s.set(n,16),this.decrypter.isSync()||this.decryptAacSamples(t,e+1,i)}))}decryptAacSamples(t,e,i){for(;;e++){if(e>=t.length)return void i();if(!(t[e].unit.length<32)&&(this.decryptAacSample(t,e,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(t){const e=16*Math.floor((t.length-48)/160)+16,i=new Int8Array(e);let s=0;for(let e=32;e<t.length-16;e+=160,s+=16)i.set(t.subarray(e,e+16),s);return i}getAvcDecryptedUnit(t,e){const i=new Uint8Array(e);let s=0;for(let e=32;e<t.length-16;e+=160,s+=16)t.set(i.subarray(s,s+16),e);return t}decryptAvcSample(t,e,i,s,r){const n=oe(r.data),a=this.getAvcEncryptedData(n);this.decryptBuffer(a.buffer).then((a=>{r.data=this.getAvcDecryptedUnit(n,a),this.decrypter.isSync()||this.decryptAvcSamples(t,e,i+1,s)}))}decryptAvcSamples(t,e,i,s){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;e++,i=0){if(e>=t.length)return void s();const r=t[e].units;for(;!(i>=r.length);i++){const n=r[i];if(!(n.data.length<=48||1!==n.type&&5!==n.type||(this.decryptAvcSample(t,e,i,s,n),this.decrypter.isSync())))return}}}}const yr=188;class Er{constructor(t,e,i){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.videoParser=new pr}static probe(t){const e=Er.syncOffset(t);return e>0&&j.warn(`MPEG2-TS detected but first sync word found @ offset ${e}`),-1!==e}static syncOffset(t){const e=t.length;let i=Math.min(940,e-yr)+1,s=0;for(;s<i;){let r=!1,n=-1,a=0;for(let o=s;o<e;o+=yr){if(71!==t[o]||e-o!==yr&&71!==t[o+yr]){if(a)return-1;break}if(a++,-1===n&&(n=o,0!==n&&(i=Math.min(n+18612,t.length-yr)+1)),r||(r=0===Tr(t,o)),r&&a>1&&(0===n&&a>2||o+yr>i))return n}s++}return-1}static createTrack(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:Gt[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===t?e:void 0}}resetInitSegment(t,e,i,s){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Er.createTrack("video"),this._audioTrack=Er.createTrack("audio",s),this._id3Track=Er.createTrack("id3"),this._txtTrack=Er.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=e,this.videoCodec=i,this._duration=s}resetTimeStamp(){}resetContiguity(){const{_audioTrack:t,_videoTrack:e,_id3Track:i}=this;t&&(t.pesData=null),e&&(e.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(t,e,i=!1,s=!1){let r;i||(this.sampleAes=null);const n=this._videoTrack,a=this._audioTrack,o=this._id3Track,l=this._txtTrack;let h=n.pid,d=n.pesData,c=a.pid,u=o.pid,f=a.pesData,g=o.pesData,m=null,p=this.pmtParsed,v=this._pmtId,y=t.length;if(this.remainderData&&(y=(t=se(this.remainderData,t)).length,this.remainderData=null),y<yr&&!s)return this.remainderData=t,{audioTrack:a,videoTrack:n,id3Track:o,textTrack:l};const E=Math.max(0,Er.syncOffset(t));y-=(y-E)%yr,y<t.byteLength&&!s&&(this.remainderData=new Uint8Array(t.buffer,y,t.buffer.byteLength-y));let T=0;for(let e=E;e<y;e+=yr)if(71===t[e]){const s=!!(64&t[e+1]),y=Tr(t,e);let T;if((48&t[e+3])>>4>1){if(T=e+5+t[e+4],T===e+yr)continue}else T=e+4;switch(y){case h:s&&(d&&(r=Ar(d))&&this.videoParser.parseAVCPES(n,l,r,!1,this._duration),d={data:[],size:0}),d&&(d.data.push(t.subarray(T,e+yr)),d.size+=e+yr-T);break;case c:if(s){if(f&&(r=Ar(f)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,r);break;case"mp3":this.parseMPEGPES(a,r);break;case"ac3":this.parseAC3PES(a,r)}f={data:[],size:0}}f&&(f.data.push(t.subarray(T,e+yr)),f.size+=e+yr-T);break;case u:s&&(g&&(r=Ar(g))&&this.parseID3PES(o,r),g={data:[],size:0}),g&&(g.data.push(t.subarray(T,e+yr)),g.size+=e+yr-T);break;case 0:s&&(T+=t[T]+1),v=this._pmtId=Sr(t,T);break;case v:{s&&(T+=t[T]+1);const r=br(t,T,this.typeSupported,i);h=r.videoPid,h>0&&(n.pid=h,n.segmentCodec=r.segmentVideoCodec),c=r.audioPid,c>0&&(a.pid=c,a.segmentCodec=r.segmentAudioCodec),u=r.id3Pid,u>0&&(o.pid=u),null===m||p||(j.warn(`MPEG-TS PMT found at ${e} after unknown PID '${m}'. Backtracking to sync byte @${E} to parse all TS packets.`),m=null,e=E-188),p=this.pmtParsed=!0;break}case 17:case 8191:break;default:m=y}}else T++;if(T>0){const t=new Error(`Found ${T} TS packet/s that do not start with 0x47`);this.observer.emit(U.ERROR,U.ERROR,{type:$.MEDIA_ERROR,details:B.FRAG_PARSING_ERROR,fatal:!1,error:t,reason:t.message})}n.pesData=d,a.pesData=f,o.pesData=g;const S={audioTrack:a,videoTrack:n,id3Track:o,textTrack:l};return s&&this.extractRemainingSamples(S),S}flush(){const{remainderData:t}=this;let e;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}extractRemainingSamples(t){const{audioTrack:e,videoTrack:i,id3Track:s,textTrack:r}=t,n=i.pesData,a=e.pesData,o=s.pesData;let l;if(n&&(l=Ar(n))?(this.videoParser.parseAVCPES(i,r,l,!0,this._duration),i.pesData=null):i.pesData=n,a&&(l=Ar(a))){switch(e.segmentCodec){case"aac":this.parseAACPES(e,l);break;case"mp3":this.parseMPEGPES(e,l);break;case"ac3":this.parseAC3PES(e,l)}e.pesData=null}else null!=a&&a.size&&j.log("last AAC PES packet truncated,might overlap between fragments"),e.pesData=a;o&&(l=Ar(o))?(this.parseID3PES(s,l),s.pesData=null):s.pesData=o}demuxSampleAes(t,e,i){const s=this.demux(t,i,!0,!this.config.progressive),r=this.sampleAes=new vr(this.observer,this.config,e);return this.decrypt(s,r)}decrypt(t,e){return new Promise((i=>{const{audioTrack:s,videoTrack:r}=t;s.samples&&"aac"===s.segmentCodec?e.decryptAacSamples(s.samples,0,(()=>{r.samples?e.decryptAvcSamples(r.samples,0,0,(()=>{i(t)})):i(t)})):r.samples&&e.decryptAvcSamples(r.samples,0,0,(()=>{i(t)}))}))}destroy(){this._duration=0}parseAACPES(t,e){let i=0;const s=this.aacOverFlow;let r,n,a,o=e.data;if(s){this.aacOverFlow=null;const e=s.missing,r=s.sample.unit.byteLength;if(-1===e)o=se(s.sample.unit,o);else{const n=r-e;s.sample.unit.set(o.subarray(0,e),n),t.samples.push(s.sample),i=s.missing}}for(r=i,n=o.length;r<n-1&&!qs(o,r);r++);if(r!==i){let t;const e=r<n-1;t=e?`AAC PES did not start with ADTS header,offset:${r}`:"No ADTS header found in AAC PES";const i=new Error(t);if(j.warn(`parsing error: ${t}`),this.observer.emit(U.ERROR,U.ERROR,{type:$.MEDIA_ERROR,details:B.FRAG_PARSING_ERROR,fatal:!1,levelRetry:e,error:i,reason:t}),!e)return}if(Qs(t,this.observer,o,r,this.audioCodec),void 0!==e.pts)a=e.pts;else{if(!s)return void j.warn("[tsdemuxer]: AAC PES unknown PTS");{const e=Js(t.samplerate);a=s.sample.pts+e}}let l,h=0;for(;r<n;){if(l=Zs(t,o,r,a,h),r+=l.length,l.missing){this.aacOverFlow=l;break}for(h++;r<n-1&&!qs(o,r);r++);}}parseMPEGPES(t,e){const i=e.data,s=i.length;let r=0,n=0;const a=e.pts;if(void 0!==a)for(;n<s;)if(lr(i,n)){const e=nr(t,i,n,a,r);if(!e)break;n+=e.length,r++}else n++;else j.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(t,e){{const i=e.data,s=e.pts;if(void 0===s)return void j.warn("[tsdemuxer]: AC3 PES unknown PTS");const r=i.length;let n,a=0,o=0;for(;o<r&&(n=fr(t,i,o,s,a++))>0;)o+=n}}parseID3PES(t,e){if(void 0===e.pts)return void j.warn("[tsdemuxer]: ID3 PES unknown PTS");const i=M({},e,{type:this._videoTrack?ri:ii,duration:Number.POSITIVE_INFINITY});t.samples.push(i)}}function Tr(t,e){return((31&t[e+1])<<8)+t[e+2]}function Sr(t,e){return(31&t[e+10])<<8|t[e+11]}function br(t,e,i,s){const r={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},n=e+3+((15&t[e+1])<<8|t[e+2])-4;for(e+=12+((15&t[e+10])<<8|t[e+11]);e<n;){const n=Tr(t,e),a=(15&t[e+3])<<8|t[e+4];switch(t[e]){case 207:if(!s){Lr("ADTS AAC");break}case 15:-1===r.audioPid&&(r.audioPid=n);break;case 21:-1===r.id3Pid&&(r.id3Pid=n);break;case 219:if(!s){Lr("H.264");break}case 27:-1===r.videoPid&&(r.videoPid=n,r.segmentVideoCodec="avc");break;case 3:case 4:i.mpeg||i.mp3?-1===r.audioPid&&(r.audioPid=n,r.segmentAudioCodec="mp3"):j.log("MPEG audio found, not supported in this browser");break;case 193:if(!s){Lr("AC-3");break}case 129:i.ac3?-1===r.audioPid&&(r.audioPid=n,r.segmentAudioCodec="ac3"):j.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===r.audioPid&&a>0){let s=e+5,o=a;for(;o>2;){if(106===t[s])!0!==i.ac3?j.log("AC-3 audio found, not supported in this browser for now"):(r.audioPid=n,r.segmentAudioCodec="ac3");const e=t[s+1]+2;s+=e,o-=e}}break;case 194:case 135:j.warn("Unsupported EC-3 in M2TS found");break;case 36:j.warn("Unsupported HEVC in M2TS found")}e+=a+5}return r}function Lr(t){j.log(`${t} with AES-128-CBC encryption found in unencrypted stream`)}function Ar(t){let e,i,s,r,n,a=0;const o=t.data;if(!t||0===t.size)return null;for(;o[0].length<19&&o.length>1;)o[0]=se(o[0],o[1]),o.splice(1,1);e=o[0];if(1===(e[0]<<16)+(e[1]<<8)+e[2]){if(i=(e[4]<<8)+e[5],i&&i>t.size-6)return null;const l=e[7];192&l&&(r=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2,64&l?(n=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2,r-n>54e5&&(j.warn(`${Math.round((r-n)/9e4)}s delta between PTS and DTS, align them`),r=n)):n=r),s=e[8];let h=s+9;if(t.size<=h)return null;t.size-=h;const d=new Uint8Array(t.size);for(let t=0,i=o.length;t<i;t++){e=o[t];let i=e.byteLength;if(h){if(h>i){h-=i;continue}e=e.subarray(h),i-=h,h=0}d.set(e,a),a+=i}return i&&(i-=s+3),{data:d,pts:r,dts:n,len:i}}return null}class Rr{static getSilentFrame(t,e){if("mp4a.40.2"===t){if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const kr=Math.pow(2,32)-1;class Cr{static init(){let t;for(t in (Cr.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]}, Cr.types))Cr.types.hasOwnProperty(t)&&(Cr.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);const e=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Cr.HDLR_TYPES={video:e,audio:i};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);Cr.STTS=Cr.STSC=Cr.STCO=r,Cr.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Cr.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Cr.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Cr.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const n=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);Cr.FTYP=Cr.box(Cr.types.ftyp,n,o,n,a),Cr.DINF=Cr.box(Cr.types.dinf,Cr.box(Cr.types.dref,s))}static box(t,...e){let i=8,s=e.length;const r=s;for(;s--;)i+=e[s].byteLength;const n=new Uint8Array(i);for(n[0]=i>>24&255,n[1]=i>>16&255,n[2]=i>>8&255,n[3]=255&i,n.set(t,4),s=0,i=8;s<r;s++)n.set(e[s],i),i+=e[s].byteLength;return n}static hdlr(t){return Cr.box(Cr.types.hdlr,Cr.HDLR_TYPES[t])}static mdat(t){return Cr.box(Cr.types.mdat,t)}static mdhd(t,e){e*=t;const i=Math.floor(e/(kr+1)),s=Math.floor(e%(kr+1));return Cr.box(Cr.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,s>>24,s>>16&255,s>>8&255,255&s,85,196,0,0]))}static mdia(t){return Cr.box(Cr.types.mdia,Cr.mdhd(t.timescale,t.duration),Cr.hdlr(t.type),Cr.minf(t))}static mfhd(t){return Cr.box(Cr.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}static minf(t){return"audio"===t.type?Cr.box(Cr.types.minf,Cr.box(Cr.types.smhd,Cr.SMHD),Cr.DINF,Cr.stbl(t)):Cr.box(Cr.types.minf,Cr.box(Cr.types.vmhd,Cr.VMHD),Cr.DINF,Cr.stbl(t))}static moof(t,e,i){return Cr.box(Cr.types.moof,Cr.mfhd(t),Cr.traf(i,e))}static moov(t){let e=t.length;const i=[];for(;e--;)i[e]=Cr.trak(t[e]);return Cr.box.apply(null,[Cr.types.moov,Cr.mvhd(t[0].timescale,t[0].duration)].concat(i).concat(Cr.mvex(t)))}static mvex(t){let e=t.length;const i=[];for(;e--;)i[e]=Cr.trex(t[e]);return Cr.box.apply(null,[Cr.types.mvex,...i])}static mvhd(t,e){e*=t;const i=Math.floor(e/(kr+1)),s=Math.floor(e%(kr+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,s>>24,s>>16&255,s>>8&255,255&s,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Cr.box(Cr.types.mvhd,r)}static sdtp(t){const e=t.samples||[],i=new Uint8Array(4+e.length);let s,r;for(s=0;s<e.length;s++)r=e[s].flags,i[s+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return Cr.box(Cr.types.sdtp,i)}static stbl(t){return Cr.box(Cr.types.stbl,Cr.stsd(t),Cr.box(Cr.types.stts,Cr.STTS),Cr.box(Cr.types.stsc,Cr.STSC),Cr.box(Cr.types.stsz,Cr.STSZ),Cr.box(Cr.types.stco,Cr.STCO))}static avc1(t){let e,i,s,r=[],n=[];for(e=0;e<t.sps.length;e++)i=t.sps[e],s=i.byteLength,r.push(s>>>8&255),r.push(255&s),r=r.concat(Array.prototype.slice.call(i));for(e=0;e<t.pps.length;e++)i=t.pps[e],s=i.byteLength,n.push(s>>>8&255),n.push(255&s),n=n.concat(Array.prototype.slice.call(i));const a=Cr.box(Cr.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|t.sps.length].concat(r).concat([t.pps.length]).concat(n))),o=t.width,l=t.height,h=t.pixelRatio[0],d=t.pixelRatio[1];return Cr.box(Cr.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,Cr.box(Cr.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Cr.box(Cr.types.pasp,new Uint8Array([h>>24,h>>16&255,h>>8&255,255&h,d>>24,d>>16&255,d>>8&255,255&d])))}static esds(t){const e=t.config.length;return new Uint8Array([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([e]).concat(t.config).concat([6,1,2]))}static audioStsd(t){const e=t.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,e>>8&255,255&e,0,0])}static mp4a(t){return Cr.box(Cr.types.mp4a,Cr.audioStsd(t),Cr.box(Cr.types.esds,Cr.esds(t)))}static mp3(t){return Cr.box(Cr.types[".mp3"],Cr.audioStsd(t))}static ac3(t){return Cr.box(Cr.types["ac-3"],Cr.audioStsd(t),Cr.box(Cr.types.dac3,t.config))}static stsd(t){return"audio"===t.type?"mp3"===t.segmentCodec&&"mp3"===t.codec?Cr.box(Cr.types.stsd,Cr.STSD,Cr.mp3(t)):"ac3"===t.segmentCodec?Cr.box(Cr.types.stsd,Cr.STSD,Cr.ac3(t)):Cr.box(Cr.types.stsd,Cr.STSD,Cr.mp4a(t)):Cr.box(Cr.types.stsd,Cr.STSD,Cr.avc1(t))}static tkhd(t){const e=t.id,i=t.duration*t.timescale,s=t.width,r=t.height,n=Math.floor(i/(kr+1)),a=Math.floor(i%(kr+1));return Cr.box(Cr.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,255&s,0,0,r>>8&255,255&r,0,0]))}static traf(t,e){const i=Cr.sdtp(t),s=t.id,r=Math.floor(e/(kr+1)),n=Math.floor(e%(kr+1));return Cr.box(Cr.types.traf,Cr.box(Cr.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s])),Cr.box(Cr.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n])),Cr.trun(t,i.length+16+20+8+16+8+8),i)}static trak(t){return t.duration=t.duration||4294967295,Cr.box(Cr.types.trak,Cr.tkhd(t),Cr.mdia(t))}static trex(t){const e=t.id;return Cr.box(Cr.types.trex,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,e){const i=t.samples||[],s=i.length,r=12+16*s,n=new Uint8Array(r);let a,o,l,h,d,c;for(e+=8+r,n.set(["video"===t.type?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,255&s,e>>>24&255,e>>>16&255,e>>>8&255,255&e],0),a=0;a<s;a++)o=i[a],l=o.duration,h=o.size,d=o.flags,c=o.cts,n.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,h>>>24&255,h>>>16&255,h>>>8&255,255&h,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,61440&d.degradPrio,15&d.degradPrio,c>>>24&255,c>>>16&255,c>>>8&255,255&c],12+16*a);return Cr.box(Cr.types.trun,n)}static initSegment(t){Cr.types||Cr.init();const e=Cr.moov(t);return se(Cr.FTYP,e)}}Cr.types=void 0,Cr.HDLR_TYPES=void 0,Cr.STTS=void 0,Cr.STSC=void 0,Cr.STCO=void 0,Cr.STSZ=void 0,Cr.VMHD=void 0,Cr.SMHD=void 0,Cr.STSD=void 0,Cr.FTYP=void 0,Cr.DINF=void 0;function _r(t,e,i=1,s=!1){const r=t*e*i;return s?Math.round(r):r}function Ir(t,e=!1){return _r(t,1e3,1/9e4,e)}let Dr,wr=null,Pr=null;class xr{constructor(t,e,i,s=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.ISGenerated=!1,null===wr){const t=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);wr=t?parseInt(t[1]):0}if(null===Pr){const t=navigator.userAgent.match(/Safari\/(\d+)/i);Pr=t?parseInt(t[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(t){j.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=t}resetNextTimestamp(){j.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){j.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(t){let e=!1;const i=t.reduce(((t,i)=>{const s=i.pts-t;return s<-4294967296?(e=!0,Mr(t,i.pts)):s>0?t:i.pts}),t[0].pts);return e&&j.debug("PTS rollover detected"),i}remux(t,e,i,s,r,n,a,o){let l,h,d,c,u,f,g=r,m=r;const p=t.pid>-1,v=e.pid>-1,y=e.samples.length,E=t.samples.length>0,T=a&&y>0||y>1;if((!p||E)&&(!v||T)||this.ISGenerated||a){if(this.ISGenerated){var S,b,L,A;const t=this.videoTrackConfig;!t||e.width===t.width&&e.height===t.height&&(null==(S=e.pixelRatio)?void 0:S[0])===(null==(b=t.pixelRatio)?void 0:b[0])&&(null==(L=e.pixelRatio)?void 0:L[1])===(null==(A=t.pixelRatio)?void 0:A[1])||this.resetInitSegment()}else d=this.generateIS(t,e,r,n);const i=this.isVideoContiguous;let s,a=-1;if(T&&(a=function(t){for(let e=0;e<t.length;e++)if(t[e].key)return e;return-1}(e.samples),!i&&this.config.forceKeyFrameOnDiscontinuity))if(f=!0,a>0){j.warn(`[mp4-remuxer]: Dropped ${a} out of ${y} video samples due to a missing keyframe`);const t=this.getVideoStartPts(e.samples);e.samples=e.samples.slice(a),e.dropped+=a,m+=(e.samples[0].pts-t)/e.inputTimeScale,s=m}else-1===a&&(j.warn(`[mp4-remuxer]: No keyframe found out of ${y} video samples`),f=!1);if(this.ISGenerated){if(E&&T){const i=this.getVideoStartPts(e.samples),s=(Mr(t.samples[0].pts,i)-i)/e.inputTimeScale;g+=Math.max(0,s),m+=Math.max(0,-s)}if(E){if(t.samplerate||(j.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(t,e,r,n)),h=this.remuxAudio(t,g,this.isAudioContiguous,n,v||T||o===We?m:void 0),T){const s=h?h.endPTS-h.startPTS:0;e.inputTimeScale||(j.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(t,e,r,n)),l=this.remuxVideo(e,m,i,s)}}else T&&(l=this.remuxVideo(e,m,i,0));l&&(l.firstKeyFrame=a,l.independent=-1!==a,l.firstKeyFramePTS=s)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(u=Or(i,r,this._initPTS,this._initDTS)),s.samples.length&&(c=Fr(s,r,this._initPTS))),{audio:h,video:l,initSegment:d,independent:f,text:c,id3:u}}generateIS(t,e,i,s){const r=t.samples,n=e.samples,a=this.typeSupported,o={},l=this._initPTS;let h,d,c,u=!l||s,f="audio/mp4";if(u&&(h=d=1/0),t.config&&r.length){switch(t.timescale=t.samplerate,t.segmentCodec){case"mp3":a.mpeg?(f="audio/mpeg",t.codec=""):a.mp3&&(t.codec="mp3");break;case"ac3":t.codec="ac-3"}o.audio={id:"audio",container:f,codec:t.codec,initSegment:"mp3"===t.segmentCodec&&a.mpeg?new Uint8Array(0):Cr.initSegment([t]),metadata:{channelCount:t.channelCount}},u&&(c=t.inputTimeScale,l&&c===l.timescale?u=!1:h=d=r[0].pts-Math.round(c*i))}if(e.sps&&e.pps&&n.length){if(e.timescale=e.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:e.codec,initSegment:Cr.initSegment([e]),metadata:{width:e.width,height:e.height}},u)if(c=e.inputTimeScale,l&&c===l.timescale)u=!1;else{const t=this.getVideoStartPts(n),e=Math.round(c*i);d=Math.min(d,Mr(n[0].dts,t)-e),h=Math.min(h,t-e)}this.videoTrackConfig={width:e.width,height:e.height,pixelRatio:e.pixelRatio}}if(Object.keys(o).length)return this.ISGenerated=!0,u?(this._initPTS={baseTime:h,timescale:c},this._initDTS={baseTime:d,timescale:c}):h=c=void 0,{tracks:o,initPTS:h,timescale:c}}remuxVideo(t,e,i,s){const r=t.inputTimeScale,n=t.samples,a=[],o=n.length,l=this._initPTS;let h,d,c=this.nextAvcDts,u=8,f=this.videoSampleDuration,g=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,p=!1;if(!i||null===c){const t=e*r,s=n[0].pts-Mr(n[0].dts,n[0].pts);wr&&null!==c&&Math.abs(t-s-c)<15e3?i=!0:c=t-s}const v=l.baseTime*r/l.timescale;for(let t=0;t<o;t++){const e=n[t];e.pts=Mr(e.pts-v,c),e.dts=Mr(e.dts-v,c),e.dts<n[t>0?t-1:t].dts&&(p=!0)}p&&n.sort((function(t,e){const i=t.dts-e.dts,s=t.pts-e.pts;return i||s})),h=n[0].dts,d=n[n.length-1].dts;const y=d-h,E=y?Math.round(y/(o-1)):f||t.inputTimeScale/30;if(i){const t=h-c,i=t>E,s=t<-1;if((i||s)&&(i?j.warn(`AVC: ${Ir(t,!0)} ms (${t}dts) hole between fragments detected at ${e.toFixed(3)}`):j.warn(`AVC: ${Ir(-t,!0)} ms (${t}dts) overlapping between fragments detected at ${e.toFixed(3)}`),!s||c>=n[0].pts||wr)){h=c;const e=n[0].pts-t;if(i)n[0].dts=h,n[0].pts=e;else for(let i=0;i<n.length&&!(n[i].dts>e);i++)n[i].dts-=t,n[i].pts-=t;j.log(`Video: Initial PTS/DTS adjusted: ${Ir(e,!0)}/${Ir(h,!0)}, delta: ${Ir(t,!0)} ms`)}}h=Math.max(0,h);let T=0,S=0,b=h;for(let t=0;t<o;t++){const e=n[t],i=e.units,s=i.length;let r=0;for(let t=0;t<s;t++)r+=i[t].data.length;S+=r,T+=s,e.length=r,e.dts<b?(e.dts=b,b+=E/4|0||1):b=e.dts,g=Math.min(e.pts,g),m=Math.max(e.pts,m)}d=n[o-1].dts;const L=S+4*T+8;let A;try{A=new Uint8Array(L)}catch(t){return void this.observer.emit(U.ERROR,U.ERROR,{type:$.MUX_ERROR,details:B.REMUX_ALLOC_ERROR,fatal:!1,error:t,bytes:L,reason:`fail allocating video mdat ${L}`})}const R=new DataView(A.buffer);R.setUint32(0,L),A.set(Cr.types.mdat,4);let k=!1,C=Number.POSITIVE_INFINITY,_=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY,D=Number.NEGATIVE_INFINITY;for(let t=0;t<o;t++){const e=n[t],i=e.units;let l,h=0;for(let t=0,e=i.length;t<e;t++){const e=i[t],s=e.data,r=e.data.byteLength;R.setUint32(u,r),u+=4,A.set(s,u),u+=r,h+=4+r}if(t<o-1)f=n[t+1].dts-e.dts,l=n[t+1].pts-e.pts;else{const i=this.config,a=t>0?e.dts-n[t-1].dts:E;if(l=t>0?e.pts-n[t-1].pts:E,i.stretchShortVideoTrack&&null!==this.nextAudioPts){const t=Math.floor(i.maxBufferHole*r),n=(s?g+s*r:this.nextAudioPts)-e.pts;n>t?(f=n-a,f<0?f=a:k=!0,j.log(`[mp4-remuxer]: It is approximately ${n/90} ms to the next segment; using duration ${f/90} ms for the last video frame.`)):f=a}else f=a}const d=Math.round(e.pts-e.dts);C=Math.min(C,f),I=Math.max(I,f),_=Math.min(_,l),D=Math.max(D,l),a.push(new Nr(e.key,f,h,d))}if(a.length)if(wr){if(wr<70){const t=a[0].flags;t.dependsOn=2,t.isNonSync=0}}else if(Pr&&D-_<I-C&&E/I<.025&&0===a[0].cts){j.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let t=h;for(let e=0,i=a.length;e<i;e++){const s=t+a[e].duration,r=t+a[e].cts;if(e<i-1){const t=s+a[e+1].cts;a[e].duration=t-r}else a[e].duration=e?a[e-1].duration:E;a[e].cts=0,t=s}}f=k||!f?E:f,this.nextAvcDts=c=d+f,this.videoSampleDuration=f,this.isVideoContiguous=!0;const w={data1:Cr.moof(t.sequenceNumber++,h,M({},t,{samples:a})),data2:A,startPTS:g/r,endPTS:(m+f)/r,startDTS:h/r,endDTS:c/r,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:t.dropped};return t.samples=[],t.dropped=0,w}getSamplesPerFrame(t){switch(t.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}remuxAudio(t,e,i,s,r){const n=t.inputTimeScale,a=n/(t.samplerate?t.samplerate:n),o=this.getSamplesPerFrame(t),l=o*a,h=this._initPTS,d="mp3"===t.segmentCodec&&this.typeSupported.mpeg,c=[],u=void 0!==r;let f=t.samples,g=d?0:8,m=this.nextAudioPts||-1;const p=e*n,v=h.baseTime*n/h.timescale;if(this.isAudioContiguous=i=i||f.length&&m>0&&(s&&Math.abs(p-m)<9e3||Math.abs(Mr(f[0].pts-v,p)-m)<20*l),f.forEach((function(t){t.pts=Mr(t.pts-v,p)})),!i||m<0){if(f=f.filter((t=>t.pts>=0)),!f.length)return;m=0===r?0:s&&!u?Math.max(0,p):f[0].pts}if("aac"===t.segmentCodec){const e=this.config.maxAudioFramesDrift;for(let i=0,s=m;i<f.length;i++){const r=f[i],a=r.pts,o=a-s,h=Math.abs(1e3*o/n);if(o<=-e*l&&u)0===i&&(j.warn(`Audio frame @ ${(a/n).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*o/n)} ms.`),this.nextAudioPts=m=s=a);else if(o>=e*l&&h<1e4&&u){let e=Math.round(o/l);s=a-e*l,s<0&&(e--,s+=l),0===i&&(this.nextAudioPts=m=s),j.warn(`[mp4-remuxer]: Injecting ${e} audio frame @ ${(s/n).toFixed(3)}s due to ${Math.round(1e3*o/n)} ms gap.`);for(let n=0;n<e;n++){const e=Math.max(s,0);let n=Rr.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);n||(j.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),n=r.unit.subarray()),f.splice(i,0,{unit:n,pts:e}),s+=l,i++}}r.pts=s,s+=l}}let y,E=null,T=null,S=0,b=f.length;for(;b--;)S+=f[b].unit.byteLength;for(let e=0,s=f.length;e<s;e++){const s=f[e],r=s.unit;let n=s.pts;if(null!==T){c[e-1].duration=Math.round((n-T)/a)}else{if(i&&"aac"===t.segmentCodec&&(n=m),E=n,!(S>0))return;S+=g;try{y=new Uint8Array(S)}catch(t){return void this.observer.emit(U.ERROR,U.ERROR,{type:$.MUX_ERROR,details:B.REMUX_ALLOC_ERROR,fatal:!1,error:t,bytes:S,reason:`fail allocating audio mdat ${S}`})}if(!d){new DataView(y.buffer).setUint32(0,S),y.set(Cr.types.mdat,4)}}y.set(r,g);const l=r.byteLength;g+=l,c.push(new Nr(!0,o,l,0)),T=n}const L=c.length;if(!L)return;const A=c[c.length-1];this.nextAudioPts=m=T+a*A.duration;const R=d?new Uint8Array(0):Cr.moof(t.sequenceNumber++,E/a,M({},t,{samples:c}));t.samples=[];const k=E/n,C=m/n,_={data1:R,data2:y,startPTS:k,endPTS:C,startDTS:k,endDTS:C,type:"audio",hasAudio:!0,hasVideo:!1,nb:L};return this.isAudioContiguous=!0,_}remuxEmptyAudio(t,e,i,s){const r=t.inputTimeScale,n=r/(t.samplerate?t.samplerate:r),a=this.nextAudioPts,o=this._initDTS,l=9e4*o.baseTime/o.timescale,h=(null!==a?a:s.startDTS*r)+l,d=s.endDTS*r+l,c=1024*n,u=Math.ceil((d-h)/c),f=Rr.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(j.warn("[mp4-remuxer]: remux empty Audio"),!f)return void j.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");const g=[];for(let t=0;t<u;t++){const e=h+t*c;g.push({unit:f,pts:e,dts:e})}return t.samples=g,this.remuxAudio(t,e,i,!1)}}function Mr(t,e){let i;if(null===e)return t;for(i=e<t?-8589934592:8589934592;Math.abs(t-e)>4294967296;)t+=i;return t}function Or(t,e,i,s){const r=t.samples.length;if(!r)return;const n=t.inputTimeScale;for(let a=0;a<r;a++){const r=t.samples[a];r.pts=Mr(r.pts-i.baseTime*n/i.timescale,e*n)/n,r.dts=Mr(r.dts-s.baseTime*n/s.timescale,e*n)/n}const a=t.samples;return t.samples=[],{samples:a}}function Fr(t,e,i){const s=t.samples.length;if(!s)return;const r=t.inputTimeScale;for(let n=0;n<s;n++){const s=t.samples[n];s.pts=Mr(s.pts-i.baseTime*r/i.timescale,e*r)/r}t.samples.sort(((t,e)=>t.pts-e.pts));const n=t.samples;return t.samples=[],{samples:n}}class Nr{constructor(t,e,i,s){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=e,this.size=i,this.cts=s,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:t?2:1,isNonSync:t?0:1}}}function Ur(t,e){const i=null==t?void 0:t.codec;if(i&&i.length>4)return i;if(e===J){if("ec-3"===i||"ac-3"===i||"alac"===i)return i;if("fLaC"===i||"Opus"===i){return ke(i,!1)}const t="mp4a.40.5";return j.info(`Parsed audio codec "${i}" or audio object type not handled. Using "${t}"`),t}return j.warn(`Unhandled video codec "${i}"`),"hvc1"===i||"hev1"===i?"hvc1.1.6.L120.90":"av01"===i?"av01.0.04M.08":"avc1.42e01e"}try{Dr=self.performance.now.bind(self.performance)}catch(t){j.debug("Unable to use Performance API on this environment"),Dr=null==lt?void 0:lt.Date.now}const $r=[{demux:class{constructor(t,e){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=e}resetTimeStamp(){}resetInitSegment(t,e,i,s){const r=this.videoTrack=Vs("video",1),n=this.audioTrack=Vs("audio",1),a=this.txtTrack=Vs("text",1);if(this.id3Track=Vs("id3",1),this.timeOffset=0,null==t||!t.byteLength)return;const o=Xt(t);if(o.video){const{id:t,timescale:e,codec:i}=o.video;r.id=t,r.timescale=a.timescale=e,r.codec=i}if(o.audio){const{id:t,timescale:e,codec:i}=o.audio;n.id=t,n.timescale=e,n.codec=i}a.id=Gt.text,r.sampleDuration=0,r.duration=n.duration=s}resetContiguity(){this.remainderData=null}static probe(t){return function(t){const e=t.byteLength;for(let i=0;i<e;){const s=Kt(t,i);if(s>8&&109===t[i+4]&&111===t[i+5]&&111===t[i+6]&&102===t[i+7])return!0;i=s>1?i+s:e}return!1}(t)}demux(t,e){this.timeOffset=e;let i=t;const s=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=se(this.remainderData,t));const e=function(t){const e={valid:null,remainder:null},i=Yt(t,["moof"]);if(i.length<2)return e.remainder=t,e;const s=i[i.length-1];return e.valid=Tt(t,0,s.byteOffset-8),e.remainder=Tt(t,s.byteOffset-8),e}(i);this.remainderData=e.remainder,s.samples=e.valid||new Uint8Array}else s.samples=i;const n=this.extractID3Track(s,e);return r.samples=re(e,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:n,textTrack:this.txtTrack}}flush(){const t=this.timeOffset,e=this.videoTrack,i=this.txtTrack;e.samples=this.remainderData||new Uint8Array,this.remainderData=null;const s=this.extractID3Track(e,this.timeOffset);return i.samples=re(t,e),{videoTrack:e,audioTrack:Vs(),id3Track:s,textTrack:Vs()}}extractID3Track(t,e){const i=this.id3Track;if(t.samples.length){const s=Yt(t.samples,["emsg"]);s&&s.forEach((t=>{const s=function(t){const e=t[0];let i="",s="",r=0,n=0,a=0,o=0,l=0,h=0;if(0===e){for(;"\0"!==Ht(t.subarray(h,h+1));)i+=Ht(t.subarray(h,h+1)),h+=1;for(i+=Ht(t.subarray(h,h+1)),h+=1;"\0"!==Ht(t.subarray(h,h+1));)s+=Ht(t.subarray(h,h+1)),h+=1;s+=Ht(t.subarray(h,h+1)),h+=1,r=Kt(t,12),n=Kt(t,16),o=Kt(t,20),l=Kt(t,24),h=28}else if(1===e){h+=4,r=Kt(t,h),h+=4;const e=Kt(t,h);h+=4;const n=Kt(t,h);for(h+=4,a=2**32*e+n,F(a)||(a=Number.MAX_SAFE_INTEGER,j.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=Kt(t,h),h+=4,l=Kt(t,h),h+=4;"\0"!==Ht(t.subarray(h,h+1));)i+=Ht(t.subarray(h,h+1)),h+=1;for(i+=Ht(t.subarray(h,h+1)),h+=1;"\0"!==Ht(t.subarray(h,h+1));)s+=Ht(t.subarray(h,h+1)),h+=1;s+=Ht(t.subarray(h,h+1)),h+=1}return{schemeIdUri:i,value:s,timeScale:r,presentationTime:a,presentationTimeDelta:n,eventDuration:o,id:l,payload:t.subarray(h,t.byteLength)}}(t);if(dr.test(s.schemeIdUri)){const t=O(s.presentationTime)?s.presentationTime/s.timeScale:e+s.presentationTimeDelta/s.timeScale;let r=4294967295===s.eventDuration?Number.POSITIVE_INFINITY:s.eventDuration/s.timeScale;r<=.001&&(r=Number.POSITIVE_INFINITY);const n=s.payload;i.samples.push({data:n,len:n.byteLength,dts:t,pts:t,type:ri,duration:r})}}))}return i}demuxSampleAes(t,e,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}},remux:class{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(t){this.initPTS=t,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(t,e,i,s){this.audioCodec=e,this.videoCodec=i,this.generateInitSegment(function(t,e){if(!t||!e)return t;const i=e.keyId;i&&e.isCommonEncryption&&Yt(t,["moov","trak"]).forEach((t=>{const e=Yt(t,["mdia","minf","stbl","stsd"])[0].subarray(8);let s=Yt(e,["enca"]);const r=s.length>0;r||(s=Yt(e,["encv"])),s.forEach((t=>{Yt(r?t.subarray(28):t.subarray(78),["sinf"]).forEach((t=>{const e=ee(t);if(e){const t=e.subarray(8,24);t.some((t=>0!==t))||(j.log(`[eme] Patching keyId in 'enc${r?"a":"v"}>sinf>>tenc' box: ${Ut(t)} -> ${Ut(i)}`),e.set(i,8))}}))}))}));return t}(t,s)),this.emitInitSegment=!0}generateInitSegment(t){let{audioCodec:e,videoCodec:i}=this;if(null==t||!t.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const s=this.initData=Xt(t);s.audio&&(e=Ur(s.audio,J)),s.video&&(i=Ur(s.video,Z));const r={};s.audio&&s.video?r.audiovideo={container:"video/mp4",codec:e+","+i,initSegment:t,id:"main"}:s.audio?r.audio={container:"audio/mp4",codec:e,initSegment:t,id:"audio"}:s.video?r.video={container:"video/mp4",codec:i,initSegment:t,id:"main"}:j.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(t,e,i,s,r,n){var a,o;let{initPTS:l,lastEndTime:h}=this;const d={audio:void 0,video:void 0,text:s,id3:i,initSegment:void 0};O(h)||(h=this.lastEndTime=r||0);const c=e.samples;if(null==c||!c.length)return d;const u={initPTS:void 0,timescale:1};let f=this.initData;if(null!=(a=f)&&a.length||(this.generateInitSegment(c),f=this.initData),null==(o=f)||!o.length)return j.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(u.tracks=this.initTracks,this.emitInitSegment=!1);const g=function(t,e){let i=0,s=0,r=0;const n=Yt(t,["moof","traf"]);for(let t=0;t<n.length;t++){const a=n[t],o=Yt(a,["tfhd"])[0],l=e[Kt(o,4)];if(!l)continue;const h=l.default,d=Kt(o,0)|(null==h?void 0:h.flags);let c=null==h?void 0:h.duration;8&d&&(c=Kt(o,2&d?12:8));const u=l.timescale||9e4,f=Yt(a,["trun"]);for(let t=0;t<f.length;t++)i=ie(f[t]),!i&&c&&(i=c*Kt(f[t],4)),l.type===Z?s+=i/u:l.type===J&&(r+=i/u)}if(0===s&&0===r){let e=1/0,i=0,s=0;const r=Yt(t,["sidx"]);for(let t=0;t<r.length;t++){const n=qt(r[t]);if(null!=n&&n.references){e=Math.min(e,n.earliestPresentationTime/n.timescale);const t=n.references.reduce(((t,e)=>t+e.info.duration||0),0);i=Math.max(i,t+n.earliestPresentationTime/n.timescale),s=i-e}}if(s&&O(s))return s}return s||r}(c,f),m=function(t,e){return Yt(e,["moof","traf"]).reduce(((e,i)=>{const s=Yt(i,["tfdt"])[0],r=s[0],n=Yt(i,["tfhd"]).reduce(((e,i)=>{const n=Kt(i,4),a=t[n];if(a){let t=Kt(s,4);if(1===r){if(t===$t)return j.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),e;t*=$t+1,t+=Kt(s,8)}const i=t/(a.timescale||9e4);if(O(i)&&(null===e||i<e))return i}return e}),null);return null!==n&&O(n)&&(null===e||n<e)?n:e}),null)}(f,c),p=null===m?r:m;(function(t,e,i,s){if(null===t)return!0;const r=Math.max(s,1),n=e-t.baseTime/t.timescale;return Math.abs(n-i)>r}(l,p,r,g)||u.timescale!==l.timescale&&n)&&(u.initPTS=p-r,l&&1===l.timescale&&j.warn("Adjusting initPTS by "+(u.initPTS-l.baseTime)),this.initPTS=l={baseTime:u.initPTS,timescale:1});const v=t?p-l.baseTime/l.timescale:h,y=v+g;!function(t,e,i){Yt(e,["moof","traf"]).forEach((e=>{Yt(e,["tfhd"]).forEach((s=>{const r=Kt(s,4),n=t[r];if(!n)return;const a=n.timescale||9e4;Yt(e,["tfdt"]).forEach((t=>{const e=t[0],s=i*a;if(s){let i=Kt(t,4);if(0===e)i-=s,i=Math.max(i,0),zt(t,4,i);else{i*=Math.pow(2,32),i+=Kt(t,8),i-=s,i=Math.max(i,0);const e=Math.floor(i/($t+1)),r=Math.floor(i%($t+1));zt(t,4,e),zt(t,8,r)}}}))}))}))}(f,c,l.baseTime/l.timescale),g>0?this.lastEndTime=y:(j.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const E=!!f.audio,T=!!f.video;let S="";E&&(S+="audio"),T&&(S+="video");const b={data1:c,startPTS:v,startDTS:v,endPTS:y,endDTS:y,type:S,hasAudio:E,hasVideo:T,nb:1,dropped:0};return d.audio="audio"===b.type?b:void 0,d.video="audio"!==b.type?b:void 0,d.initSegment=u,d.id3=Or(i,r,l,l),s.samples.length&&(d.text=Fr(s,r,l)),d}}},{demux:Er,remux:xr},{demux:class extends Ks{constructor(t,e){super(),this.observer=void 0,this.config=void 0,this.observer=t,this.config=e}resetInitSegment(t,e,i,s){super.resetInitSegment(t,e,i,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:e,duration:s,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const e=Lt(t,0);let i=(null==e?void 0:e.length)||0;if(hr(t,i))return!1;for(let e=t.length;i<e;i++)if(Xs(t,i))return j.log("ADTS sync word found !"),!0;return!1}canParse(t,e){return function(t,e){return function(t,e){return e+5<t.length}(t,e)&&Ws(t,e)&&Ys(t,e)<=t.length-e}(t,e)}appendFrame(t,e,i){Qs(t,this.observer,e,i,t.manifestCodec);const s=Zs(t,e,i,this.basePTS,this.frameIndex);if(s&&0===s.missing)return s}},remux:xr},{demux:class extends Ks{resetInitSegment(t,e,i,s){super.resetInitSegment(t,e,i,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:e,duration:s,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const e=Lt(t,0);let i=(null==e?void 0:e.length)||0;if(e&&11===t[i]&&119===t[i+1]&&void 0!==kt(e)&&cr(t,i)<=16)return!1;for(let e=t.length;i<e;i++)if(hr(t,i))return j.log("MPEG Audio sync word found !"),!0;return!1}canParse(t,e){return function(t,e){return or(t,e)&&4<=t.length-e}(t,e)}appendFrame(t,e,i){if(null!==this.basePTS)return nr(t,e,i,this.basePTS,this.frameIndex)}},remux:xr}];$r.splice(2,0,{demux:ur,remux:xr});class Br{constructor(t,e,i,s,r){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=e,this.config=i,this.vendor=s,this.id=r}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,e,i,s){const r=i.transmuxing;r.executeStart=Dr();let n=new Uint8Array(t);const{currentTransmuxState:a,transmuxConfig:o}=this;s&&(this.currentTransmuxState=s);const{contiguous:l,discontinuity:h,trackSwitch:d,accurateTimeOffset:c,timeOffset:u,initSegmentChange:f}=s||a,{audioCodec:g,videoCodec:m,defaultInitPts:p,duration:v,initSegmentData:y}=o,E=function(t,e){let i=null;t.byteLength>0&&null!=(null==e?void 0:e.key)&&null!==e.iv&&null!=e.method&&(i=e);return i}(n,e);if(E&&"AES-128"===E.method){const t=this.getDecrypter();if(!t.isSync())return this.decryptionPromise=t.webCryptoDecrypt(n,E.key.buffer,E.iv.buffer).then((t=>{const e=this.push(t,null,i);return this.decryptionPromise=null,e})),this.decryptionPromise;{let e=t.softwareDecrypt(n,E.key.buffer,E.iv.buffer);if(i.part>-1&&(e=t.flush()),!e)return r.executeEnd=Dr(),Gr(i);n=new Uint8Array(e)}}const T=this.needsProbing(h,d);if(T){const t=this.configureTransmuxer(n);if(t)return j.warn(`[transmuxer] ${t.message}`),this.observer.emit(U.ERROR,U.ERROR,{type:$.MEDIA_ERROR,details:B.FRAG_PARSING_ERROR,fatal:!1,error:t,reason:t.message}),r.executeEnd=Dr(),Gr(i)}(h||d||f||T)&&this.resetInitSegment(y,g,m,v,e),(h||f||T)&&this.resetInitialTimestamp(p),l||this.resetContiguity();const S=this.transmux(n,E,u,c,i),b=this.currentTransmuxState;return b.contiguous=!0,b.discontinuity=!1,b.trackSwitch=!1,r.executeEnd=Dr(),S}flush(t){const e=t.transmuxing;e.executeStart=Dr();const{decrypter:i,currentTransmuxState:s,decryptionPromise:r}=this;if(r)return r.then((()=>this.flush(t)));const n=[],{timeOffset:a}=s;if(i){const e=i.flush();e&&n.push(this.push(e,null,t))}const{demuxer:o,remuxer:l}=this;if(!o||!l)return e.executeEnd=Dr(),[Gr(t)];const h=o.flush(a);return Hr(h)?h.then((e=>(this.flushRemux(n,e,t),n))):(this.flushRemux(n,h,t),n)}flushRemux(t,e,i){const{audioTrack:s,videoTrack:r,id3Track:n,textTrack:a}=e,{accurateTimeOffset:o,timeOffset:l}=this.currentTransmuxState;j.log(`[transmuxer.ts]: Flushed fragment ${i.sn}${i.part>-1?" p: "+i.part:""} of level ${i.level}`);const h=this.remuxer.remux(s,r,n,a,l,o,!0,this.id);t.push({remuxResult:h,chunkMeta:i}),i.transmuxing.executeEnd=Dr()}resetInitialTimestamp(t){const{demuxer:e,remuxer:i}=this;e&&i&&(e.resetTimeStamp(t),i.resetTimeStamp(t))}resetContiguity(){const{demuxer:t,remuxer:e}=this;t&&e&&(t.resetContiguity(),e.resetNextTimestamp())}resetInitSegment(t,e,i,s,r){const{demuxer:n,remuxer:a}=this;n&&a&&(n.resetInitSegment(t,e,i,s),a.resetInitSegment(t,e,i,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,e,i,s,r){let n;return n=e&&"SAMPLE-AES"===e.method?this.transmuxSampleAes(t,e,i,s,r):this.transmuxUnencrypted(t,i,s,r),n}transmuxUnencrypted(t,e,i,s){const{audioTrack:r,videoTrack:n,id3Track:a,textTrack:o}=this.demuxer.demux(t,e,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,n,a,o,e,i,!1,this.id),chunkMeta:s}}transmuxSampleAes(t,e,i,s,r){return this.demuxer.demuxSampleAes(t,e,i).then((t=>({remuxResult:this.remuxer.remux(t.audioTrack,t.videoTrack,t.id3Track,t.textTrack,i,s,!1,this.id),chunkMeta:r})))}configureTransmuxer(t){const{config:e,observer:i,typeSupported:s,vendor:r}=this;let n;for(let e=0,i=$r.length;e<i;e++){var a;if(null!=(a=$r[e].demux)&&a.probe(t)){n=$r[e];break}}if(!n)return new Error("Failed to find demuxer by probing fragment data");const o=this.demuxer,l=this.remuxer,h=n.remux,d=n.demux;l&&l instanceof h||(this.remuxer=new h(i,e,s,r)),o&&o instanceof d||(this.demuxer=new d(i,e,s),this.probe=d.probe)}needsProbing(t,e){return!this.demuxer||!this.remuxer||t||e}getDecrypter(){let t=this.decrypter;return t||(t=this.decrypter=new Cs(this.config)),t}}const Gr=t=>({remuxResult:{},chunkMeta:t});function Hr(t){return"then"in t&&t.then instanceof Function}class Vr{constructor(t,e,i,s,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=e,this.initSegmentData=i,this.duration=s,this.defaultInitPts=r||null}}class Kr{constructor(t,e,i,s,r,n){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=e,this.accurateTimeOffset=i,this.trackSwitch=s,this.timeOffset=r,this.initSegmentChange=n}}var jr={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,i="~";function s(){}function r(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function n(t,e,s,n,a){if("function"!=typeof s)throw new TypeError("The listener must be a function");var o=new r(s,n||t,a),l=i?i+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],o]:t._events[l].push(o):(t._events[l]=o,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new s:delete t._events[e]}function o(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(i=!1)),o.prototype.eventNames=function(){var t,s,r=[];if(0===this._eventsCount)return r;for(s in t=this._events)e.call(t,s)&&r.push(i?s.slice(1):s);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},o.prototype.listeners=function(t){var e=i?i+t:t,s=this._events[e];if(!s)return[];if(s.fn)return[s.fn];for(var r=0,n=s.length,a=new Array(n);r<n;r++)a[r]=s[r].fn;return a},o.prototype.listenerCount=function(t){var e=i?i+t:t,s=this._events[e];return s?s.fn?1:s.length:0},o.prototype.emit=function(t,e,s,r,n,a){var o=i?i+t:t;if(!this._events[o])return!1;var l,h,d=this._events[o],c=arguments.length;if(d.fn){switch(d.once&&this.removeListener(t,d.fn,void 0,!0),c){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,e),!0;case 3:return d.fn.call(d.context,e,s),!0;case 4:return d.fn.call(d.context,e,s,r),!0;case 5:return d.fn.call(d.context,e,s,r,n),!0;case 6:return d.fn.call(d.context,e,s,r,n,a),!0}for(h=1,l=new Array(c-1);h<c;h++)l[h-1]=arguments[h];d.fn.apply(d.context,l)}else{var u,f=d.length;for(h=0;h<f;h++)switch(d[h].once&&this.removeListener(t,d[h].fn,void 0,!0),c){case 1:d[h].fn.call(d[h].context);break;case 2:d[h].fn.call(d[h].context,e);break;case 3:d[h].fn.call(d[h].context,e,s);break;case 4:d[h].fn.call(d[h].context,e,s,r);break;default:if(!l)for(u=1,l=new Array(c-1);u<c;u++)l[u-1]=arguments[u];d[h].fn.apply(d[h].context,l)}}return!0},o.prototype.on=function(t,e,i){return n(this,t,e,i,!1)},o.prototype.once=function(t,e,i){return n(this,t,e,i,!0)},o.prototype.removeListener=function(t,e,s,r){var n=i?i+t:t;if(!this._events[n])return this;if(!e)return a(this,n),this;var o=this._events[n];if(o.fn)o.fn!==e||r&&!o.once||s&&o.context!==s||a(this,n);else{for(var l=0,h=[],d=o.length;l<d;l++)(o[l].fn!==e||r&&!o[l].once||s&&o[l].context!==s)&&h.push(o[l]);h.length?this._events[n]=1===h.length?h[0]:h:a(this,n)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&a(this,e)):(this._events=new s,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,t.exports=o}(jr);var Wr=b(jr.exports);class zr{constructor(t,e,i,s){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const r=t.config;this.hls=t,this.id=e,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=i,this.onFlush=s;const n=(t,e)=>{(e=e||{}).frag=this.frag,e.id=this.id,t===U.ERROR&&(this.error=e.error),this.hls.trigger(t,e)};this.observer=new Wr,this.observer.on(U.FRAG_DECRYPTED,n),this.observer.on(U.ERROR,n);const a=ve(r.preferManagedMediaSource)||{isTypeSupported:()=>!1},o={mpeg:a.isTypeSupported("audio/mpeg"),mp3:a.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:a.isTypeSupported('audio/mp4; codecs="ac-3"')},l=navigator.vendor;if(this.useWorker&&"undefined"!=typeof Worker){if(r.workerPath||"function"==typeof __HLS_WORKER_BUNDLE__){try{r.workerPath?(j.log(`loading Web Worker ${r.workerPath} for "${e}"`),this.workerContext=function(t){const e=new self.URL(t,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}(r.workerPath)):(j.log(`injecting Web Worker for "${e}"`),this.workerContext=function(){const t=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(t);return{worker:new self.Worker(e),objectURL:e}}()),this.onwmsg=t=>this.onWorkerMessage(t);const{worker:t}=this.workerContext;t.addEventListener("message",this.onwmsg),t.onerror=t=>{const i=new Error(`${t.message}  (${t.filename}:${t.lineno})`);r.enableWorker=!1,j.warn(`Error in "${e}" Web Worker, fallback to inline`),this.hls.trigger(U.ERROR,{type:$.OTHER_ERROR,details:B.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:i})},t.postMessage({cmd:"init",typeSupported:o,vendor:l,id:e,config:JSON.stringify(r)})}catch(t){j.warn(`Error setting up "${e}" Web Worker, fallback to inline`,t),this.resetWorker(),this.error=null,this.transmuxer=new Br(this.observer,o,r,l,e)}return}}this.transmuxer=new Br(this.observer,o,r,l,e)}resetWorker(){if(this.workerContext){const{worker:t,objectURL:e}=this.workerContext;e&&self.URL.revokeObjectURL(e),t.removeEventListener("message",this.onwmsg),t.onerror=null,t.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(t,e,i,s,r,n,a,o,l,h){var d,c;l.transmuxing.start=self.performance.now();const{transmuxer:u}=this,f=n?n.start:r.start,g=r.decryptdata,m=this.frag,p=!(m&&r.cc===m.cc),v=!(m&&l.level===m.level),y=m?l.sn-m.sn:-1,E=this.part?l.part-this.part.index:-1,T=0===y&&l.id>1&&l.id===(null==m?void 0:m.stats.chunkCount),S=!v&&(1===y||0===y&&(1===E||T&&E<=0)),b=self.performance.now();(v||y||0===r.stats.parsing.start)&&(r.stats.parsing.start=b),!n||!E&&S||(n.stats.parsing.start=b);const L=!(m&&(null==(d=r.initSegment)?void 0:d.url)===(null==(c=m.initSegment)?void 0:c.url)),A=new Kr(p,S,o,v,f,L);if(!S||p||L){j.log(`[transmuxer-interface, ${r.type}]: Starting new transmux session for sn: ${l.sn} p: ${l.part} level: ${l.level} id: ${l.id}\n        discontinuity: ${p}\n        trackSwitch: ${v}\n        contiguous: ${S}\n        accurateTimeOffset: ${o}\n        timeOffset: ${f}\n        initSegmentChange: ${L}`);const t=new Vr(i,s,e,a,h);this.configureTransmuxer(t)}if(this.frag=r,this.part=n,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:t,decryptdata:g,chunkMeta:l,state:A},t instanceof ArrayBuffer?[t]:[]);else if(u){const e=u.push(t,g,l,A);Hr(e)?(u.async=!0,e.then((t=>{this.handleTransmuxComplete(t)})).catch((t=>{this.transmuxerError(t,l,"transmuxer-interface push error")}))):(u.async=!1,this.handleTransmuxComplete(e))}}flush(t){t.transmuxing.start=self.performance.now();const{transmuxer:e}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:t});else if(e){let i=e.flush(t);Hr(i)||e.async?(Hr(i)||(i=Promise.resolve(i)),i.then((e=>{this.handleFlushResult(e,t)})).catch((e=>{this.transmuxerError(e,t,"transmuxer-interface flush error")}))):this.handleFlushResult(i,t)}}transmuxerError(t,e,i){this.hls&&(this.error=t,this.hls.trigger(U.ERROR,{type:$.MEDIA_ERROR,details:B.FRAG_PARSING_ERROR,chunkMeta:e,fatal:!1,error:t,err:t,reason:i}))}handleFlushResult(t,e){t.forEach((t=>{this.handleTransmuxComplete(t)})),this.onFlush(e)}onWorkerMessage(t){const e=t.data,i=this.hls;switch(e.event){case"init":{var s;const t=null==(s=this.workerContext)?void 0:s.objectURL;t&&self.URL.revokeObjectURL(t);break}case"transmuxComplete":this.handleTransmuxComplete(e.data);break;case"flush":this.onFlush(e.data);break;case"workerLog":j[e.data.logType]&&j[e.data.logType](e.data.message);break;default:e.data=e.data||{},e.data.frag=this.frag,e.data.id=this.id,i.trigger(e.event,e.data)}}configureTransmuxer(t){const{transmuxer:e}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:t}):e&&e.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}}function Yr(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!qr(t[i].attrs,e[i].attrs))return!1;return!0}function qr(t,e,i){const s=t["STABLE-RENDITION-ID"];return s&&!i?s===e["STABLE-RENDITION-ID"]:!(i||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some((i=>t[i]!==e[i]))}function Xr(t,e){return e.label.toLowerCase()===t.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(t.lang||"").toLowerCase())}class Qr{constructor(t){this.buffered=void 0;const e=(e,i,s)=>{if((i>>>=0)>s-1)throw new DOMException(`Failed to execute '${e}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${s})`);return t[i][e]};this.buffered={get length(){return t.length},end:i=>e("end",i,t.length),start:i=>e("start",i,t.length)}}}class Jr{constructor(t){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=t}append(t,e,i){const s=this.queues[e];s.push(t),1!==s.length||i||this.executeNext(e)}insertAbort(t,e){this.queues[e].unshift(t),this.executeNext(e)}appendBlocker(t){let e;const i=new Promise((t=>{e=t})),s={execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(s,t),i}executeNext(t){const e=this.queues[t];if(e.length){const i=e[0];try{i.execute()}catch(e){j.warn(`[buffer-operation-queue]: Exception executing "${t}" SourceBuffer operation: ${e}`),i.onError(e);const s=this.buffers[t];null!=s&&s.updating||this.shiftAndExecuteNext(t)}}}shiftAndExecuteNext(t){this.queues[t].shift(),this.executeNext(t)}current(t){return this.queues[t][0]}}const Zr=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;function tn(t){const e=t.querySelectorAll("source");[].slice.call(e).forEach((e=>{t.removeChild(e)}))}const en={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},sn=function(t){let e=t;return en.hasOwnProperty(t)&&(e=en[t]),String.fromCharCode(e)},rn=15,nn=100,an={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},on={17:2,18:4,21:6,22:8,23:10,19:13,20:15},ln={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},hn={25:2,26:4,29:6,30:8,31:10,27:13,28:15},dn=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class cn{constructor(){this.time=null,this.verboseLevel=0}log(t,e){if(this.verboseLevel>=t){const i="function"==typeof e?e():e;j.log(`${this.time} [${t}] ${i}`)}}}const un=function(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].toString(16));return e};class fn{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(t){const e=["foreground","underline","italics","background","flash"];for(let i=0;i<e.length;i++){const s=e[i];t.hasOwnProperty(s)&&(this[s]=t[s])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class gn{constructor(){this.uchar=" ",this.penState=new fn}reset(){this.uchar=" ",this.penState.reset()}setChar(t,e){this.uchar=t,this.penState.copy(e)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class mn{constructor(t){this.chars=[],this.pos=0,this.currPenState=new fn,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<nn;t++)this.chars.push(new gn);this.logger=t}equals(t){for(let e=0;e<nn;e++)if(!this.chars[e].equals(t.chars[e]))return!1;return!0}copy(t){for(let e=0;e<nn;e++)this.chars[e].copy(t.chars[e])}isEmpty(){let t=!0;for(let e=0;e<nn;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>nn&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=nn)}moveCursor(t){const e=this.pos+t;if(t>1)for(let t=this.pos+1;t<e+1;t++)this.chars[t].setPenState(this.currPenState);this.setCursor(e)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){t>=144&&this.backSpace();const e=sn(t);this.pos>=nn?this.logger.log(0,(()=>"Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!")):(this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1))}clearFromPos(t){let e;for(e=t;e<nn;e++)this.chars[e].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const t=[];let e=!0;for(let i=0;i<nn;i++){const s=this.chars[i].uchar;" "!==s&&(e=!1),t.push(s)}return e?"":t.join("")}setPenStyles(t){this.currPenState.setStyles(t);this.chars[this.pos].setPenState(this.currPenState)}}class pn{constructor(t){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let e=0;e<rn;e++)this.rows.push(new mn(t));this.logger=t}reset(){for(let t=0;t<rn;t++)this.rows[t].clear();this.currRow=14}equals(t){let e=!0;for(let i=0;i<rn;i++)if(!this.rows[i].equals(t.rows[i])){e=!1;break}return e}copy(t){for(let e=0;e<rn;e++)this.rows[e].copy(t.rows[e])}isEmpty(){let t=!0;for(let e=0;e<rn;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t);this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,(()=>"pacData = "+JSON.stringify(t)));let e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(let t=0;t<rn;t++)this.rows[t].clear();const t=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){const s=i.rows[t].cueStartTime,r=this.logger.time;if(null!==s&&null!==r&&s<r)for(let s=0;s<this.nrRollUpRows;s++)this.rows[e-this.nrRollUpRows+s+1].copy(i.rows[t+s])}}this.currRow=e;const i=this.rows[this.currRow];if(null!==t.indent){const e=t.indent,s=Math.max(e-1,0);i.setCursor(t.indent),t.color=i.chars[s].penState.foreground}const s={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(t){this.logger.log(2,(()=>"bkgData = "+JSON.stringify(t))),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,(()=>this.getDisplayText()));const t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),this.logger.log(2,"Rolling up")}getDisplayText(t){t=t||!1;const e=[];let i="",s=-1;for(let i=0;i<rn;i++){const r=this.rows[i].getTextString();r&&(s=i+1,t?e.push("Row "+s+": '"+r+"'"):e.push(r.trim()))}return e.length>0&&(i=t?"["+e.join(" | ")+"]":e.join("\n")),i}getTextAndFormat(){return this.rows}}class vn{constructor(t,e,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new pn(i),this.nonDisplayedMemory=new pn(i),this.lastOutputScreen=new pn(i),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,(()=>"MODE="+t)),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(t){for(let e=0;e<t.length;e++)this.writeScreen.insertChar(t[e]);const e=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(()=>e+": "+this.writeScreen.getDisplayText(!0))),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0))),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(()=>"DISP: "+this.displayedMemory.getDisplayText()))}this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){const e={flash:!1};if(e.underline=t%2==1,e.italics=t>=46,e.italics)e.foreground="white";else{const i=Math.floor(t/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];e.foreground=s[i]}this.logger.log(2,"MIDROW: "+JSON.stringify(e)),this.writeScreen.setPen(e)}outputDataUpdate(t=!1){const e=this.logger.time;null!==e&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}}class yn{constructor(t,e,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;const s=this.logger=new cn;this.channels=[null,new vn(t,e,s),new vn(t+1,i,s)]}getHandler(t){return this.channels[t].getHandler()}setHandler(t,e){this.channels[t].setHandler(e)}addData(t,e){let i,s,r,n=!1;this.logger.time=t;for(let t=0;t<e.length;t+=2)if(s=127&e[t],r=127&e[t+1],0!==s||0!==r){if(this.logger.log(3,"["+un([e[t],e[t+1]])+"] -> ("+un([s,r])+")"),i=this.parseCmd(s,r),i||(i=this.parseMidrow(s,r)),i||(i=this.parsePAC(s,r)),i||(i=this.parseBackgroundAttributes(s,r)),!i&&(n=this.parseChars(s,r),n)){const t=this.currentChannel;if(t&&t>0){this.channels[t].insertChars(n)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}i||n||this.logger.log(2,"Couldn't parse cleaned data "+un([s,r])+" orig: "+un([e[t],e[t+1]]))}}parseCmd(t,e){const{cmdHistory:i}=this;if(!((20===t||28===t||21===t||29===t)&&e>=32&&e<=47)&&!((23===t||31===t)&&e>=33&&e<=35))return!1;if(Tn(t,e,i))return En(null,null,i),this.logger.log(3,"Repeated command ("+un([t,e])+") is dropped"),!0;const s=20===t||21===t||23===t?1:2,r=this.channels[s];return 20===t||21===t||28===t||29===t?32===e?r.ccRCL():33===e?r.ccBS():34===e?r.ccAOF():35===e?r.ccAON():36===e?r.ccDER():37===e?r.ccRU(2):38===e?r.ccRU(3):39===e?r.ccRU(4):40===e?r.ccFON():41===e?r.ccRDC():42===e?r.ccTR():43===e?r.ccRTD():44===e?r.ccEDM():45===e?r.ccCR():46===e?r.ccENM():47===e&&r.ccEOC():r.ccTO(e-32),En(t,e,i),this.currentChannel=s,!0}parseMidrow(t,e){let i=0;if((17===t||25===t)&&e>=32&&e<=47){if(i=17===t?1:2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const s=this.channels[i];return!!s&&(s.ccMIDROW(e),this.logger.log(3,"MIDROW ("+un([t,e])+")"),!0)}return!1}parsePAC(t,e){let i;const s=this.cmdHistory;if(!((t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127)&&!((16===t||24===t)&&e>=64&&e<=95))return!1;if(Tn(t,e,s))return En(null,null,s),!0;const r=t<=23?1:2;i=e>=64&&e<=95?1===r?an[t]:ln[t]:1===r?on[t]:hn[t];const n=this.channels[r];return!!n&&(n.setPAC(this.interpretPAC(i,e)),En(t,e,s),this.currentChannel=r,!0)}interpretPAC(t,e){let i;const s={color:null,italics:!1,indent:null,underline:!1,row:t};return i=e>95?e-96:e-64,s.underline=!(1&~i),i<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(s.italics=!0,s.color="white"):s.indent=4*Math.floor((i-16)/2),s}parseChars(t,e){let i,s=null,r=null;if(t>=25?(i=2,r=t-8):(i=1,r=t),r>=17&&r<=19){let t;t=17===r?e+80:18===r?e+112:e+144,this.logger.log(2,"Special char '"+sn(t)+"' in channel "+i),s=[t]}else t>=32&&t<=127&&(s=0===e?[t]:[t,e]);if(s){const i=un(s);this.logger.log(3,"Char codes =  "+i.join(",")),En(t,e,this.cmdHistory)}return s}parseBackgroundAttributes(t,e){if(!((16===t||24===t)&&e>=32&&e<=47)&&!((23===t||31===t)&&e>=45&&e<=47))return!1;let i;const s={};16===t||24===t?(i=Math.floor((e-32)/2),s.background=dn[i],e%2==1&&(s.background=s.background+"_semi")):45===e?s.background="transparent":(s.foreground="black",47===e&&(s.underline=!0));const r=t<=23?1:2;return this.channels[r].setBkgData(s),En(t,e,this.cmdHistory),!0}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){const e=this.channels[t];e&&e.reset()}this.cmdHistory={a:null,b:null}}cueSplitAtTime(t){for(let e=0;e<this.channels.length;e++){const i=this.channels[e];i&&i.cueSplitAtTime(t)}}}function En(t,e,i){i.a=t,i.b=e}function Tn(t,e,i){return i.a===t&&i.b===e}class Sn{constructor(t,e){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=e}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,e,i){(null===this.startTime||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var bn=function(){if(null!=lt&&lt.VTTCue)return self.VTTCue;const t=["","lr","rl"],e=["start","middle","end","left","right"];function i(t,e){if("string"!=typeof e)return!1;if(!Array.isArray(t))return!1;const i=e.toLowerCase();return!!~t.indexOf(i)&&i}function s(t){return i(e,t)}function r(t,...e){let i=1;for(;i<arguments.length;i++){const e=arguments[i];for(const i in e)t[i]=e[i]}return t}function n(e,n,a){const o=this,l={enumerable:!0};o.hasBeenReset=!1;let h="",d=!1,c=e,u=n,f=a,g=null,m="",p=!0,v="auto",y="start",E=50,T="middle",S=50,b="middle";Object.defineProperty(o,"id",r({},l,{get:function(){return h},set:function(t){h=""+t}})),Object.defineProperty(o,"pauseOnExit",r({},l,{get:function(){return d},set:function(t){d=!!t}})),Object.defineProperty(o,"startTime",r({},l,{get:function(){return c},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");c=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",r({},l,{get:function(){return u},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");u=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",r({},l,{get:function(){return f},set:function(t){f=""+t,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",r({},l,{get:function(){return g},set:function(t){g=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",r({},l,{get:function(){return m},set:function(e){const s=function(e){return i(t,e)}(e);if(!1===s)throw new SyntaxError("An invalid or illegal string was specified.");m=s,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",r({},l,{get:function(){return p},set:function(t){p=!!t,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",r({},l,{get:function(){return v},set:function(t){if("number"!=typeof t&&"auto"!==t)throw new SyntaxError("An invalid number or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",r({},l,{get:function(){return y},set:function(t){const e=s(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",r({},l,{get:function(){return E},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");E=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",r({},l,{get:function(){return T},set:function(t){const e=s(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");T=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",r({},l,{get:function(){return S},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");S=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",r({},l,{get:function(){return b},set:function(t){const e=s(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");b=e,this.hasBeenReset=!0}})),o.displayState=void 0}return n.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},n}();class Ln{decode(t,e){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}function An(t){function e(t,e,i,s){return 3600*(0|t)+60*(0|e)+(0|i)+parseFloat(s||0)}const i=t.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return i?parseFloat(i[2])>59?e(i[2],i[3],0,i[4]):e(i[1],i[2],i[3],i[4]):null}class Rn{constructor(){this.values=Object.create(null)}set(t,e){this.get(t)||""===e||(this.values[t]=e)}get(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e}has(t){return t in this.values}alt(t,e,i){for(let s=0;s<i.length;++s)if(e===i[s]){this.set(t,e);break}}integer(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))}percent(t,e){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(e)){const i=parseFloat(e);if(i>=0&&i<=100)return this.set(t,i),!0}return!1}}function kn(t,e,i,s){const r=s?t.split(s):[t];for(const t in r){if("string"!=typeof r[t])continue;const s=r[t].split(i);if(2!==s.length)continue;e(s[0],s[1])}}const Cn=new bn(0,0,""),_n="middle"===Cn.align?"middle":"center";function In(t,e,i){const s=t;function r(){const e=An(t);if(null===e)throw new Error("Malformed timestamp: "+s);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e;}function n(){t=t.replace(/^\s+/,"")}if(n(),e.startTime=r(),n(),"--\x3e"!==t.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+s);t=t.slice(3),n(),e.endTime=r(),n(),function(t,e){const s=new Rn;kn(t,(function(t,e){let r;switch(t){case"region":for(let r=i.length-1;r>=0;r--)if(i[r].id===e){s.set(t,i[r].region);break}break;case"vertical":s.alt(t,e,["rl","lr"]);break;case"line":r=e.split(","),s.integer(t,r[0]),s.percent(t,r[0])&&s.set("snapToLines",!1),s.alt(t,r[0],["auto"]),2===r.length&&s.alt("lineAlign",r[1],["start",_n,"end"]);break;case"position":r=e.split(","),s.percent(t,r[0]),2===r.length&&s.alt("positionAlign",r[1],["start",_n,"end","line-left","line-right","auto"]);break;case"size":s.percent(t,e);break;case"align":s.alt(t,e,["start",_n,"end","left","right"])}}),/:/,/\s/),e.region=s.get("region",null),e.vertical=s.get("vertical","");let r=s.get("line","auto");"auto"===r&&-1===Cn.line&&(r=-1),e.line=r,e.lineAlign=s.get("lineAlign","start"),e.snapToLines=s.get("snapToLines",!0),e.size=s.get("size",100),e.align=s.get("align",_n);let n=s.get("position","auto");"auto"===n&&50===Cn.position&&(n="start"===e.align||"left"===e.align?0:"end"===e.align||"right"===e.align?100:50),e.position=n}(t,e)}function Dn(t){return t.replace(/<br(?: \/)?>/gi,"\n");}class wn{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Ln,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){const e=this;function i(){let t=e.buffer,i=0;for(t=Dn(t);i<t.length&&"\r"!==t[i]&&"\n"!==t[i];)++i;const s=t.slice(0,i);return"\r"===t[i]&&++i,"\n"===t[i]&&++i,e.buffer=t.slice(i),s}t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));try{let t="";if("INITIAL"===e.state){if(!/\r\n|\n/.test(e.buffer))return this;t=i();const s=t.match(/^()?WEBVTT([ \t].*)?$/);if(null==s||!s[0])throw new Error("Malformed WebVTT signature.");e.state="HEADER"}let s=!1;for(;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(s?s=!1:t=i(),e.state){case"HEADER":/:/.test(t)?kn(t,(function(t,e){}),/:/):t||(e.state="ID");continue;case"NOTE":t||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(t)){e.state="NOTE";break}if(!t)continue;if(e.cue=new bn(0,0,""),e.state="CUE",-1===t.indexOf("--\x3e")){e.cue.id=t;continue}case"CUE":if(!e.cue){e.state="BADCUE";continue}try{In(t,e.cue,e.regionList)}catch(t){e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":{const i=-1!==t.indexOf("--\x3e");if(!t||i&&(s=!0)){e.oncue&&e.cue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}if(null===e.cue)continue;e.cue.text&&(e.cue.text+="\n"),e.cue.text+=t}continue;case"BADCUE":t||(e.state="ID")}}}catch(t){"CUETEXT"===e.state&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state="INITIAL"===e.state?"BADWEBVTT":"BADCUE"}return this}flush(){const t=this;try{if((t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state||"BADWEBVTT"===t.state)throw new Error("Malformed WebVTT signature.")}catch(e){t.onparsingerror&&t.onparsingerror(e)}return t.onflush&&t.onflush(),this}}const Pn=/\r\n|\n\r|\n|\r/g,xn=function(t,e,i=0){return t.slice(i,i+e.length)===e},Mn=function(t){let e=5381,i=t.length;for(;i;)e=33*e^t.charCodeAt(--i);return(e>>>0).toString()};function On(t,e,i){return Mn(t.toString())+Mn(e.toString())+Mn(i)}function Fn(t,e,i,s,r,n,a){const o=new wn,l=Ot(new Uint8Array(t)).trim().replace(Pn,"\n").split("\n"),h=[],d=e?function(t,e=1){return _r(t,9e4,1/e)}(e.baseTime,e.timescale):0;let c,u="00:00.000",f=0,g=0,m=!0;o.oncue=function(t){const n=i[s];let a=i.ccOffset;const o=(f-d)/9e4;if(null!=n&&n.new&&(void 0!==g?a=i.ccOffset=n.start:function(t,e,i){let s=t[e],r=t[s.prevCC];if(!r||!r.new&&s.new)return t.ccOffset=t.presentationOffset=s.start,void(s.new=!1);for(;null!=(n=r)&&n.new;){var n;t.ccOffset+=s.start-r.start,s.new=!1,s=r,r=t[s.prevCC]}t.presentationOffset=i}(i,s,o)),o){if(!e)return void(c=new Error("Missing initPTS for VTT MPEGTS"));a=o-i.presentationOffset}const l=t.endTime-t.startTime,u=Mr(9e4*(t.startTime+a-g),9e4*r)/9e4;t.startTime=Math.max(u,0),t.endTime=Math.max(u+l,0);const m=t.text.trim();t.text=decodeURIComponent(encodeURIComponent(m)),t.id||(t.id=On(t.startTime,t.endTime,m)),t.endTime>0&&h.push(t)},o.onparsingerror=function(t){c=t},o.onflush=function(){c?a(c):n(h)},l.forEach((t=>{if(m){if(xn(t,"X-TIMESTAMP-MAP=")){m=!1,t.slice(16).split(",").forEach((t=>{xn(t,"LOCAL:")?u=t.slice(6):xn(t,"MPEGTS:")&&(f=parseInt(t.slice(7)))}));try{g=function(t){let e=parseInt(t.slice(-3));const i=parseInt(t.slice(-6,-4)),s=parseInt(t.slice(-9,-7)),r=t.length>9?parseInt(t.substring(0,t.indexOf(":"))):0;if(!(O(e)&&O(i)&&O(s)&&O(r)))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${t}`);return e+=1e3*i,e+=6e4*s,e+=36e5*r,e}(u)/1e3}catch(t){c=t}return}""===t&&(m=!1)}o.parse(t+"\n")})),o.flush()}const Nn="stpp.ttml.im1t",Un=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,$n=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Bn={left:"start",center:"center",right:"end",start:"start",end:"end"};function Gn(t,e,i,s){const r=Yt(new Uint8Array(t),["mdat"]);if(0===r.length)return void s(new Error("Could not parse IMSC1 mdat"));const n=r.map((t=>Ot(t))),a=function(t,e,i=1,s=!1){return _r(t,e,1/i,s)}(e.baseTime,1,e.timescale);try{n.forEach((t=>i(function(t,e){const i=(new DOMParser).parseFromString(t,"text/xml"),s=i.getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");const r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},n=Object.keys(r).reduce(((t,e)=>(t[e]=s.getAttribute(`ttp:${e}`)||r[e],t)),{}),a="preserve"!==s.getAttribute("xml:space"),o=Vn(Hn(s,"styling","style")),l=Vn(Hn(s,"layout","region")),h=Hn(s,"body","[begin]");return[].map.call(h,(t=>{const i=Kn(t,a);if(!i||!t.hasAttribute("begin"))return null;const s=zn(t.getAttribute("begin"),n),r=zn(t.getAttribute("dur"),n);let h=zn(t.getAttribute("end"),n);if(null===s)throw Wn(t);if(null===h){if(null===r)throw Wn(t);h=s+r}const d=new bn(s-e,h-e,i);d.id=On(d.startTime,d.endTime,d.text);const c=function(t,e,i){const s="http://www.w3.org/ns/ttml#styling";let r=null;const n=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=null!=t&&t.hasAttribute("style")?t.getAttribute("style"):null;a&&i.hasOwnProperty(a)&&(r=i[a]);return n.reduce(((i,n)=>{const a=jn(e,s,n)||jn(t,s,n)||jn(r,s,n);return a&&(i[n]=a),i}),{})}(l[t.getAttribute("region")],o[t.getAttribute("style")],o),{textAlign:u}=c;if(u){const t=Bn[u];t&&(d.lineAlign=t),d.align=u}return M(d,c),d})).filter((t=>null!==t))}(t,a))))}catch(t){s(t)}}function Hn(t,e,i){const s=t.getElementsByTagName(e)[0];return s?[].slice.call(s.querySelectorAll(i)):[]}function Vn(t){return t.reduce(((t,e)=>{const i=e.getAttribute("xml:id");return i&&(t[i]=e),t}),{})}function Kn(t,e){return [].slice.call(t.childNodes).reduce(((t,i,s)=>{var r;return "br"===i.nodeName&&s?t+"\n":null!=(r=i.childNodes)&&r.length?Kn(i,e):e?t+i.textContent.trim().replace(/\s+/g," "):t+i.textContent;}),"");}function jn(t,e,i){return t&&t.hasAttributeNS(e,i)?t.getAttributeNS(e,i):null}function Wn(t){return new Error(`Could not parse ttml timestamp ${t}`)}function zn(t,e){if(!t)return null;let i=An(t);return null===i&&(Un.test(t)?i=function(t,e){const i=Un.exec(t),s=(0|i[4])+(0|i[5])/e.subFrameRate;return 3600*(0|i[1])+60*(0|i[2])+(0|i[3])+s/e.frameRate}(t,e):$n.test(t)&&(i=function(t,e){const i=$n.exec(t),s=Number(i[1]);switch(i[2]){case"h":return 3600*s;case"m":return 60*s;case"ms":return 1e3*s;case"f":return s/e.frameRate;case"t":return s/e.tickRate}return s}(t,e))),i}function Yn(t){return t.characteristics&&/transcribes-spoken-dialog/gi.test(t.characteristics)&&/describes-music-and-sound/gi.test(t.characteristics)?"captions":"subtitles";}function qn(t,e){return!!t&&t.kind===Yn(e)&&Xr(e,t)}class Xn{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:t}=this;t.on(U.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(U.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(U.MANIFEST_PARSED,this.onManifestParsed,this),t.on(U.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(U.BUFFER_CODECS,this.onBufferCodecs,this),t.on(U.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:t}=this;t.off(U.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(U.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(U.MANIFEST_PARSED,this.onManifestParsed,this),t.off(U.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(U.BUFFER_CODECS,this.onBufferCodecs,this),t.off(U.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,e){const i=this.hls.levels[e.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(t,e){this.media=e.media instanceof HTMLVideoElement?e.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(t,e){const i=this.hls;this.restrictedLevels=[],this.firstLevel=e.firstLevel,i.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onLevelsUpdated(t,e){this.timer&&O(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(t,e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const t=this.hls.levels;if(t.length){const e=this.hls,i=this.getMaxLevel(t.length-1);i!==this.autoLevelCapping&&j.log(`Setting autoLevelCapping to ${i}: ${t[i].height}p@${t[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),e.autoLevelCapping=i,e.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}}getMaxLevel(t){const e=this.hls.levels;if(!e.length)return-1;const i=e.filter(((e,i)=>this.isLevelAllowed(e)&&i<=t));return this.clientRect=null,Xn.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const t=this.media,e={width:0,height:0};if(t){const i=t.getBoundingClientRect();e.width=i.width,e.height=i.height,e.width||e.height||(e.width=i.right-i.left||t.width||0,e.height=i.bottom-i.top||t.height||0)}return this.clientRect=e,e}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch(t){}return t}isLevelAllowed(t){return!this.restrictedLevels.some((e=>t.bitrate===e.bitrate&&t.width===e.width&&t.height===e.height))}static getMaxLevelByMediaSize(t,e,i){if(null==t||!t.length)return-1;let s=t.length-1;const r=Math.max(e,i);for(let e=0;e<t.length;e+=1){const i=t[e];if((i.width>=r||i.height>=r)&&(n=i,!(a=t[e+1])||n.width!==a.width||n.height!==a.height)){s=e;break}}var n,a;return s}}const Qn="[eme]";class Jn{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Jn.CDMCleanupPromise?[Jn.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=j.debug.bind(j,Qn),this.log=j.log.bind(j,Qn),this.warn=j.warn.bind(j,Qn),this.error=j.error.bind(j,Qn),this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(U.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(U.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(U.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(U.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(U.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(U.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(t){const{drmSystems:e,widevineLicenseUrl:i}=this.config,s=e[t];if(s)return s.licenseUrl;if(t===ht.WIDEVINE&&i)return i;throw new Error(`no license server URL configured for key-system "${t}"`)}getServerCertificateUrl(t){const{drmSystems:e}=this.config,i=e[t];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){const e=this.hls.levels,i=(t,e,i)=>!!t&&i.indexOf(t)===e,s=e.map((t=>t.audioCodec)).filter(i),r=e.map((t=>t.videoCodec)).filter(i);return s.length+r.length===0&&r.push("avc1.42e01e"),new Promise(((e,i)=>{const n=t=>{const a=t.shift();this.getMediaKeysPromise(a,s,r).then((t=>e({keySystem:a,mediaKeys:t}))).catch((e=>{t.length?n(t):i(e instanceof Zn?e:new Zn({type:$.KEY_SYSTEM_ERROR,details:B.KEY_SYSTEM_NO_ACCESS,error:e,fatal:!0},e.message))}))};n(t)}))}requestMediaKeySystemAccess(t,e){const{requestMediaKeySystemAccessFunc:i}=this.config;if("function"!=typeof i){let t=`Configured requestMediaKeySystemAccess is not a function ${i}`;return null===yt&&"http:"===self.location.protocol&&(t=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(t))}return i(t,e)}getMediaKeysPromise(t,e,i){const s=function(t,e,i,s){let r;switch(t){case ht.FAIRPLAY:r=["cenc","sinf"];break;case ht.WIDEVINE:case ht.PLAYREADY:r=["cenc"];break;case ht.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${t}`)}return function(t,e,i,s){return[{initDataTypes:t,persistentState:s.persistentState||"optional",distinctiveIdentifier:s.distinctiveIdentifier||"optional",sessionTypes:s.sessionTypes||[s.sessionType||"temporary"],audioCapabilities:e.map((t=>({contentType:`audio/mp4; codecs="${t}"`,robustness:s.audioRobustness||"",encryptionScheme:s.audioEncryptionScheme||null}))),videoCapabilities:i.map((t=>({contentType:`video/mp4; codecs="${t}"`,robustness:s.videoRobustness||"",encryptionScheme:s.videoEncryptionScheme||null})))}]}(r,e,i,s)}(t,e,i,this.config.drmSystemOptions),r=this.keySystemAccessPromises[t];let n=null==r?void 0:r.keySystemAccess;if(!n){this.log(`Requesting encrypted media "${t}" key-system access with config: ${JSON.stringify(s)}`),n=this.requestMediaKeySystemAccess(t,s);const e=this.keySystemAccessPromises[t]={keySystemAccess:n};return n.catch((e=>{this.log(`Failed to obtain access to key-system "${t}": ${e}`)})),n.then((i=>{this.log(`Access for key-system "${i.keySystem}" obtained`);const s=this.fetchServerCertificate(t);return this.log(`Create media-keys for "${t}"`),e.mediaKeys=i.createMediaKeys().then((e=>(this.log(`Media-keys created for "${t}"`),s.then((i=>i?this.setMediaKeysServerCertificate(e,t,i):e))))),e.mediaKeys.catch((e=>{this.error(`Failed to create media-keys for "${t}"}: ${e}`)})),e.mediaKeys}))}return n.then((()=>r.mediaKeys))}createMediaKeySessionContext({decryptdata:t,keySystem:e,mediaKeys:i}){this.log(`Creating key-system session "${e}" keyId: ${Ut(t.keyId||[])}`);const s=i.createSession(),r={decryptdata:t,keySystem:e,mediaKeys:i,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(t){const e=t.decryptdata;if(e.pssh){const i=this.createMediaKeySessionContext(t),s=this.getKeyIdString(e),r="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(i,r,e.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}getKeyIdString(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(null===t.keyId)throw new Error("keyId is null");return Ut(t.keyId)}updateKeySession(t,e){var i;const s=t.mediaKeysSession;return this.log(`Updating key-session "${s.sessionId}" for keyID ${Ut((null==(i=t.decryptdata)?void 0:i.keyId)||[])}\n      } (data length: ${e?e.byteLength:e})`),s.update(e)}selectKeySystemFormat(t){const e=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)),this.keyFormatPromise}getKeyFormatPromise(t){return new Promise(((e,i)=>{const s=vt(this.config),r=t.map(gt).filter((t=>!!t&&-1!==s.indexOf(t)));return this.getKeySystemSelectionPromise(r).then((({keySystem:t})=>{const s=pt(t);s?e(s):i(new Error(`Unable to find format for key-system "${t}"`))})).catch(i)}))}loadKey(t){const e=t.keyInfo.decryptdata,i=this.getKeyIdString(e),s=`(keyId: ${i} format: "${e.keyFormat}" method: ${e.method} uri: ${e.uri})`;this.log(`Starting session for key ${s}`);let r=this.keyIdToKeySessionPromise[i];return r||(r=this.keyIdToKeySessionPromise[i]=this.getKeySystemForKeyPromise(e).then((({keySystem:i,mediaKeys:r})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key ${s}`),this.attemptSetMediaKeys(i,r).then((()=>{this.throwIfDestroyed();const t=this.createMediaKeySessionContext({keySystem:i,mediaKeys:r,decryptdata:e});return this.generateRequestWithPreferredKeySession(t,"cenc",e.pssh,"playlist-key")}))))),r.catch((t=>this.handleError(t)))),r}throwIfDestroyed(t="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(t){this.hls&&(this.error(t.message),t instanceof Zn?this.hls.trigger(U.ERROR,t.data):this.hls.trigger(U.ERROR,{type:$.KEY_SYSTEM_ERROR,details:B.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))}getKeySystemForKeyPromise(t){const e=this.getKeyIdString(t),i=this.keyIdToKeySessionPromise[e];if(!i){const e=gt(t.keyFormat),i=e?[e]:vt(this.config);return this.attemptKeySystemAccess(i)}return i}getKeySystemSelectionPromise(t){if(t.length||(t=vt(this.config)),0===t.length)throw new Zn({type:$.KEY_SYSTEM_ERROR,details:B.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(t)}_onMediaEncrypted(t){const{initDataType:e,initData:i}=t;if(this.debug(`"${t.type}" event: init data type: "${e}"`),null===i)return;let s,r;if("sinf"===e&&this.config.drmSystems[ht.FAIRPLAY]){const t=Ht(new Uint8Array(i));try{const e=nt(JSON.parse(t).sinf),i=ee(new Uint8Array(e));if(!i)return;s=i.subarray(8,24),r=ht.FAIRPLAY}catch(t){return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{const t=function(t){if(!(t instanceof ArrayBuffer)||t.byteLength<32)return null;const e={version:0,systemId:"",kids:null,data:null},i=new DataView(t),s=i.getUint32(0);if(t.byteLength!==s&&s>44)return null;if(1886614376!==i.getUint32(4))return null;if(e.version=i.getUint32(8)>>>24,e.version>1)return null;e.systemId=Ut(new Uint8Array(t,12,16));const r=i.getUint32(28);if(0===e.version){if(s-32<r)return null;e.data=new Uint8Array(t,32,r)}else if(1===e.version){e.kids=[];for(let i=0;i<r;i++)e.kids.push(new Uint8Array(t,32+16*i,16))}return e}(i);if(null===t)return;0===t.version&&t.systemId===mt&&t.data&&(s=t.data.subarray(8,24)),r=function(t){if(t===mt)return ht.WIDEVINE}(t.systemId)}if(!r||!s)return;const n=Ut(s),{keyIdToKeySessionPromise:a,mediaKeySessions:o}=this;let l=a[n];for(let t=0;t<o.length;t++){const r=o[t],h=r.decryptdata;if(h.pssh||!h.keyId)continue;const d=Ut(h.keyId);if(n===d||-1!==h.uri.replace(/-/g,"").indexOf(n)){l=a[d],delete a[d],h.pssh=new Uint8Array(i),h.keyId=s,l=a[n]=l.then((()=>this.generateRequestWithPreferredKeySession(r,e,i,"encrypted-event-key-match")));break}}l||(l=a[n]=this.getKeySystemSelectionPromise([r]).then((({keySystem:t,mediaKeys:r})=>{var a;this.throwIfDestroyed();const o=new de("ISO-23001-7",n,null!=(a=pt(t))?a:"");return o.pssh=new Uint8Array(i),o.keyId=s,this.attemptSetMediaKeys(t,r).then((()=>{this.throwIfDestroyed();const s=this.createMediaKeySessionContext({decryptdata:o,keySystem:t,mediaKeys:r});return this.generateRequestWithPreferredKeySession(s,e,i,"encrypted-event-no-match")}))}))),l.catch((t=>this.handleError(t)))}_onWaitingForKey(t){this.log(`"${t.type}" event`)}attemptSetMediaKeys(t,e){const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${t}"`);const s=Promise.all(i).then((()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(e)}));return this.setMediaKeysQueue.push(s),s.then((()=>{this.log(`Media-keys set for "${t}"`),i.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter((t=>-1===i.indexOf(t)))}))}generateRequestWithPreferredKeySession(t,e,i,s){var r,n;const a=null==(r=this.config.drmSystems)||null==(n=r[t.keySystem])?void 0:n.generateRequest;if(a)try{const s=a.call(this.hls,e,i,t);if(!s)throw new Error("Invalid response from configured generateRequest filter");e=s.initDataType,i=t.decryptdata.pssh=s.initData?new Uint8Array(s.initData):null}catch(t){var o;if(this.warn(t.message),null!=(o=this.hls)&&o.config.debug)throw t}if(null===i)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(t);const l=this.getKeyIdString(t.decryptdata);this.log(`Generating key-session request for "${s}": ${l} (init data type: ${e} length: ${i?i.byteLength:null})`);const h=new Wr,d=t._onmessage=e=>{const i=t.mediaKeysSession;if(!i)return void h.emit("error",new Error("invalid state"));const{messageType:s,message:r}=e;this.log(`"${s}" message event for session "${i.sessionId}" message size: ${r.byteLength}`),"license-request"===s||"license-renewal"===s?this.renewLicense(t,r).catch((t=>{this.handleError(t),h.emit("error",t)})):"license-release"===s?t.keySystem===ht.FAIRPLAY&&(this.updateKeySession(t,ot("acknowledged")),this.removeSession(t)):this.warn(`unhandled media key message type "${s}"`)},c=t._onkeystatuseschange=e=>{if(!t.mediaKeysSession)return void h.emit("error",new Error("invalid state"));this.onKeyStatusChange(t);const i=t.keyStatus;h.emit("keyStatus",i),"expired"===i&&(this.warn(`${t.keySystem} expired for key ${l}`),this.renewKeySession(t))};t.mediaKeysSession.addEventListener("message",d),t.mediaKeysSession.addEventListener("keystatuseschange",c);const u=new Promise(((t,e)=>{h.on("error",e),h.on("keyStatus",(i=>{i.startsWith("usable")?t():"output-restricted"===i?e(new Zn({type:$.KEY_SYSTEM_ERROR,details:B.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===i?e(new Zn({type:$.KEY_SYSTEM_ERROR,details:B.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${i}"`)):"expired"===i?e(new Error("key expired while generating request")):this.warn(`unhandled key status change "${i}"`)}))}));return t.mediaKeysSession.generateRequest(e,i).then((()=>{var e;this.log(`Request generated for key-session "${null==(e=t.mediaKeysSession)?void 0:e.sessionId}" keyId: ${l}`)})).catch((t=>{throw new Zn({type:$.KEY_SYSTEM_ERROR,details:B.KEY_SYSTEM_NO_SESSION,error:t,fatal:!1},`Error generating key-session request: ${t}`)})).then((()=>u)).catch((e=>{throw (h.removeAllListeners(), this.removeSession(t), e)})).then((()=>(h.removeAllListeners(),t)));}onKeyStatusChange(t){t.mediaKeysSession.keyStatuses.forEach(((e,i)=>{this.log(`key status change "${e}" for keyStatuses keyId: ${Ut("buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i))} session keyId: ${Ut(new Uint8Array(t.decryptdata.keyId||[]))} uri: ${t.decryptdata.uri}`),t.keyStatus=e}))}fetchServerCertificate(t){const e=this.config,i=new(0,e.loader)(e),s=this.getServerCertificateUrl(t);return s?(this.log(`Fetching server certificate for "${t}"`),new Promise(((r,n)=>{const a={responseType:"arraybuffer",url:s},o=e.certLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(t,e,i,s)=>{r(t.data)},onError:(e,i,r,o)=>{n(new Zn({type:$.KEY_SYSTEM_ERROR,details:B.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:w({url:a.url,data:void 0},e)},`"${t}" certificate request failed (${s}). Status: ${e.code} (${e.text})`))},onTimeout:(e,i,r)=>{n(new Zn({type:$.KEY_SYSTEM_ERROR,details:B.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:{url:a.url,data:void 0}},`"${t}" certificate request timed out (${s})`))},onAbort:(t,e,i)=>{n(new Error("aborted"))}};i.load(a,l,h)}))):Promise.resolve()}setMediaKeysServerCertificate(t,e,i){return new Promise(((s,r)=>{t.setServerCertificate(i).then((r=>{this.log(`setServerCertificate ${r?"success":"not supported by CDM"} (${null==i?void 0:i.byteLength}) on "${e}"`),s(t)})).catch((t=>{r(new Zn({type:$.KEY_SYSTEM_ERROR,details:B.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:t,fatal:!0},t.message))}))}))}renewLicense(t,e){return this.requestLicense(t,new Uint8Array(e)).then((e=>this.updateKeySession(t,new Uint8Array(e)).catch((t=>{throw new Zn({type:$.KEY_SYSTEM_ERROR,details:B.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:t,fatal:!0},t.message)}))))}unpackPlayReadyKeyMessage(t,e){const i=String.fromCharCode.apply(null,new Uint16Array(e.buffer));if(!i.includes("PlayReadyKeyMessage"))return t.setRequestHeader("Content-Type","text/xml; charset=utf-8"),e;const s=(new DOMParser).parseFromString(i,"application/xml"),r=s.querySelectorAll("HttpHeader");if(r.length>0){let e;for(let i=0,s=r.length;i<s;i++){var n,a;e=r[i];const s=null==(n=e.querySelector("name"))?void 0:n.textContent,o=null==(a=e.querySelector("value"))?void 0:a.textContent;s&&o&&t.setRequestHeader(s,o)}}const o=s.querySelector("Challenge"),l=null==o?void 0:o.textContent;if(!l)throw new Error("Cannot find <Challenge> in key message");return ot(atob(l))}setupLicenseXHR(t,e,i,s){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then((()=>{if(!i.decryptdata)throw new Error("Key removed");return r.call(this.hls,t,e,i,s)})).catch((n=>{if(!i.decryptdata)throw n;return t.open("POST",e,!0),r.call(this.hls,t,e,i,s)})).then((i=>{t.readyState||t.open("POST",e,!0);return{xhr:t,licenseChallenge:i||s}})):(t.open("POST",e,!0),Promise.resolve({xhr:t,licenseChallenge:s}))}requestLicense(t,e){const i=this.config.keyLoadPolicy.default;return new Promise(((s,r)=>{const n=this.getLicenseServerUrl(t.keySystem);this.log(`Sending license request to URL: ${n}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return r(new Error("invalid state"));if(4===a.readyState)if(200===a.status){this._requestLicenseFailureCount=0;let e=a.response;this.log(`License received ${e instanceof ArrayBuffer?e.byteLength:e}`);const i=this.config.licenseResponseCallback;if(i)try{e=i.call(this.hls,a,n,t)}catch(t){this.error(t)}s(e)}else{const o=i.errorRetry,l=o?o.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||a.status>=400&&a.status<500)r(new Zn({type:$.KEY_SYSTEM_ERROR,details:B.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:n,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${n}). Status: ${a.status} (${a.statusText})`));else{const i=l-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${i} attempts left`),this.requestLicense(t,e).then(s,r)}}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=a,this.setupLicenseXHR(a,n,t,e).then((({xhr:e,licenseChallenge:i})=>{t.keySystem==ht.PLAYREADY&&(i=this.unpackPlayReadyKeyMessage(e,i)),e.send(i)}))}))}onMediaAttached(t,e){if(!this.config.emeEnabled)return;const i=e.media;this.media=i,i.addEventListener("encrypted",this.onMediaEncrypted),i.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const t=this.media,e=this.mediaKeySessions;t&&(t.removeEventListener("encrypted",this.onMediaEncrypted),t.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},de.clearKeyUriToKeyIdMap();const i=e.length;Jn.CDMCleanupPromise=Promise.all(e.map((t=>this.removeSession(t))).concat(null==t?void 0:t.setMediaKeys(null).catch((t=>{this.log(`Could not clear media keys: ${t}`)})))).then((()=>{i&&(this.log("finished closing key sessions and clearing media keys"),e.length=0)})).catch((t=>{this.log(`Could not close sessions and clear media keys: ${t}`)}))}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(t,{sessionKeys:e}){if(e&&this.config.emeEnabled&&!this.keyFormatPromise){const t=e.reduce(((t,e)=>(-1===t.indexOf(e.keyFormat)&&t.push(e.keyFormat),t)),[]);this.log(`Selecting key-system from session-keys ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)}}removeSession(t){const{mediaKeysSession:e,licenseXhr:i}=t;if(e){this.log(`Remove licenses and keys and close session ${e.sessionId}`),t._onmessage&&(e.removeEventListener("message",t._onmessage),t._onmessage=void 0),t._onkeystatuseschange&&(e.removeEventListener("keystatuseschange",t._onkeystatuseschange),t._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;const s=this.mediaKeySessions.indexOf(t);return s>-1&&this.mediaKeySessions.splice(s,1),e.remove().catch((t=>{this.log(`Could not remove session: ${t}`)})).then((()=>e.close())).catch((t=>{this.log(`Could not close session: ${t}`)}))}}}Jn.CDMCleanupPromise=void 0;class Zn extends Error{constructor(t,e){super(e),this.data=void 0,t.error||(t.error=new Error(e)),this.data=t,t.err=t.error}}var ta,ea,ia;!function(t){t.MANIFEST="m",t.AUDIO="a",t.VIDEO="v",t.MUXED="av",t.INIT="i",t.CAPTION="c",t.TIMED_TEXT="tt",t.KEY="k",t.OTHER="o"}(ta||(ta={})),function(t){t.DASH="d",t.HLS="h",t.SMOOTH="s",t.OTHER="o"}(ea||(ea={})),function(t){t.OBJECT="CMCD-Object",t.REQUEST="CMCD-Request",t.SESSION="CMCD-Session",t.STATUS="CMCD-Status"}(ia||(ia={}));const sa={[ia.OBJECT]:["br","d","ot","tb"],[ia.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[ia.SESSION]:["cid","pr","sf","sid","st","v"],[ia.STATUS]:["bs","rtp"]};class ra{constructor(t,e){this.value=void 0,this.params=void 0,Array.isArray(t)&&(t=t.map((t=>t instanceof ra?t:new ra(t)))),this.value=t,this.params=e}}class na{constructor(t){this.description=void 0,this.description=t}}function aa(t,e,i,s){return new Error(`failed to ${t} "${(r=e, Array.isArray(r)?JSON.stringify(r):r instanceof Map?"Map{}":r instanceof Set?"Set{}":"object"==typeof r?JSON.stringify(r):String(r))}" as ${i}`,{cause:s});var r}const oa="Bare Item";const la=/[\x00-\x1f\x7f]+/;function ha(t,e,i){return aa("serialize",t,e,i)}function da(t){if(!1===ArrayBuffer.isView(t))throw ha(t,"Byte Sequence");return `:${(e=t, btoa(String.fromCharCode(...e)))}:`;var e}function ca(t){if(function(t){return t<-999999999999999||999999999999999<t}(t))throw ha(t,"Integer");return t.toString()}function ua(t,e){if(t<0)return-ua(-t,e);const i=Math.pow(10,e);if(Math.abs(t*i%1-.5)<Number.EPSILON){const e=Math.floor(t*i);return(e%2==0?e:e+1)/i}return Math.round(t*i)/i}function fa(t){const e=ua(t,3);if(Math.floor(Math.abs(e)).toString().length>12)throw ha(t,"Decimal");const i=e.toString();return i.includes(".")?i:`${i}.0`}function ga(t){const e=(i=t).description||i.toString().slice(7,-1);var i;if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e))throw ha(e,"Token");return e}function ma(t){switch(typeof t){case"number":if(!O(t))throw ha(t,oa);return Number.isInteger(t)?ca(t):fa(t);case"string":return function(t){if(la.test(t))throw ha(t,"String");return `"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`;}(t);case"symbol":return ga(t);case"boolean":return function(t){if("boolean"!=typeof t)throw ha(t,"Boolean");return t?"?1":"?0"}(t);case"object":if(t instanceof Date)return function(t){return`@${ca(t.getTime()/1e3)}`}(t);if(t instanceof Uint8Array)return da(t);if(t instanceof na)return ga(t);default:throw ha(t,oa)}}function pa(t){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(t))throw ha(t,"Key");return t}function va(t){return null==t?"":Object.entries(t).map((([t,e])=>!0===e?`;${pa(t)}`:`;${pa(t)}=${ma(e)}`)).join("")}function ya(t){return t instanceof ra?`${ma(t.value)}${va(t.params)}`:ma(t)}function Ea(t,e={whitespace:!0}){if("object"!=typeof t)throw ha(t,"Dict");const i=t instanceof Map?t.entries():Object.entries(t),s=null!=e&&e.whitespace?" ":"";return Array.from(i).map((([t,e])=>{e instanceof ra==!1&&(e=new ra(e));let i=pa(t);var s;return!0===e.value?i+=va(e.params):(i+="=",Array.isArray(e.value)?i+=`(${(s=e).value.map(ya).join(" ")})${va(s.params)}`:i+=ya(e)),i})).join(`,${s}`)}const Ta=t=>Math.round(t),Sa=t=>100*Ta(t/100),ba={br:Ta,d:Ta,bl:Sa,dl:Sa,mtp:Sa,nor:(t,e)=>(null!=e&&e.baseUrl&&(t=function(t,e){const i=new URL(t),s=new URL(e);if(i.origin!==s.origin)return t;const r=i.pathname.split("/").slice(1),n=s.pathname.split("/").slice(1,-1);for(;r[0]===n[0];)r.shift(),n.shift();for(;n.length;)n.shift(),r.unshift("..");return r.join("/")}(t,e.baseUrl)),encodeURIComponent(t)),rtp:Sa,tb:Ta};function La(t,e){const i={};if(null==t||"object"!=typeof t)return i;const s=Object.keys(t).sort(),r=M({},ba,null==e?void 0:e.formatters),n=null==e?void 0:e.filter;return s.forEach((s=>{if(null!=n&&n(s))return;let a=t[s];const o=r[s];o&&(a=o(a,e)),"v"===s&&1===a||"pr"==s&&1===a||(t=>"number"==typeof t?O(t):null!=t&&""!==t&&!1!==t)(a)&&((t=>"ot"===t||"sf"===t||"st"===t)(s)&&"string"==typeof a&&(a=new na(a)),i[s]=a)})),i}function Aa(t,e={}){return t?function(t,e){return Ea(t,e)}(La(t,e),M({whitespace:!1},e)):""}function Ra(t,e,i){return M(t,function(t,e={}){if(!t)return{};const i=Object.entries(t),s=Object.entries(sa).concat(Object.entries((null==e?void 0:e.customHeaderMap)||{})),r=i.reduce(((t,e)=>{var i;const[r,n]=e,a=(null==(i=s.find((t=>t[1].includes(r))))?void 0:i[0])||ia.REQUEST;return null!=t[a]||(t[a]={}),t[a][r]=n,t}),{});return Object.entries(r).reduce(((t,[i,s])=>(t[i]=Aa(s,e),t)),{})}(e,i))}const ka=/CMCD=[^&#]+/;function Ca(t,e,i){const s=function(t,e={}){if(!t)return"";const i=Aa(t,e);return`CMCD=${encodeURIComponent(i)}`}(e,i);if(!s)return t;if(ka.test(t))return t.replace(ka,s);const r=t.includes("?")?"&":"?";return`${t}${r}${s}`}function _a(t,e,i,s){t&&Object.keys(e).forEach((r=>{const n=t.filter((t=>t.groupId===r)).map((t=>{const n=M({},t);return n.details=void 0,n.attrs=new Y(n.attrs),n.url=n.attrs.URI=Ia(t.url,t.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",i),n.groupId=n.attrs["GROUP-ID"]=e[r],n.attrs["PATHWAY-ID"]=s,n}));t.push(...n)}))}function Ia(t,e,i,s){const{HOST:r,PARAMS:n,[i]:a}=s;let o;e&&(o=null==a?void 0:a[e],o&&(t=o));const l=new self.URL(t);return r&&!o&&(l.host=r),n&&Object.keys(n).sort().forEach((t=>{t&&l.searchParams.set(t,n[t])})),l.href}const Da=/^age:\s*[\d.]+\s*$/im;class wa{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new Q,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null,this.stats=null}abortInternal(){const t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,4!==t.readyState&&(this.stats.aborted=!0,t.abort()))}abort(){var t;this.abortInternal(),null!=(t=this.callbacks)&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,e,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=e,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:t,context:e}=this;if(!t||!e)return;const i=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0,s.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then((()=>{if(!this.stats.aborted)return r(i,e.url)})).catch((t=>(i.open("GET",e.url,!0),r(i,e.url)))).then((()=>{this.stats.aborted||this.openAndSendXhr(i,e,t)})).catch((t=>{this.callbacks.onError({code:i.status,text:t.message},e,i,s)})):this.openAndSendXhr(i,e,t)}openAndSendXhr(t,e,i){t.readyState||t.open("GET",e.url,!0);const s=e.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:n}=i.loadPolicy;if(s)for(const e in s)t.setRequestHeader(e,s[e]);e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,self.clearTimeout(this.requestTimeout),i.timeout=r&&O(r)?r:n,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),t.send()}readystatechange(){const{context:t,loader:e,stats:i}=this;if(!t||!e)return;const s=e.readyState,r=this.config;if(!i.aborted&&s>=2&&(0===i.loading.first&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),4===s)){self.clearTimeout(this.requestTimeout),e.onreadystatechange=null,e.onprogress=null;const s=e.status,n="text"!==e.responseType;if(s>=200&&s<300&&(n&&e.response||null!==e.responseText)){i.loading.end=Math.max(self.performance.now(),i.loading.first);const r=n?e.response:e.responseText,a="arraybuffer"===e.responseType?r.byteLength:r.length;if(i.loaded=i.total=a,i.bwEstimate=8e3*i.total/(i.loading.end-i.loading.first),!this.callbacks)return;const o=this.callbacks.onProgress;if(o&&o(i,t,r,e),!this.callbacks)return;const l={url:e.responseURL,data:r,code:s};this.callbacks.onSuccess(l,i,t,e)}else{const n=r.loadPolicy.errorRetry;Pi(n,i.retry,!1,{url:t.url,data:void 0,code:s})?this.retry(n):(j.error(`${s} while loading ${t.url}`),this.callbacks.onError({code:s,text:e.statusText},t,e,i))}}}loadtimeout(){var t;const e=null==(t=this.config)?void 0:t.loadPolicy.timeoutRetry;if(Pi(e,this.stats.retry,!0))this.retry(e);else{var i;j.warn(`timeout while loading ${null==(i=this.context)?void 0:i.url}`);const t=this.callbacks;t&&(this.abortInternal(),t.onTimeout(this.stats,this.context,this.loader))}}retry(t){const{context:e,stats:i}=this;this.retryDelay=Di(t,i.retry),i.retry++,j.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${null==e?void 0:e.url}, retrying ${i.retry}/${t.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){const e=this.stats;e.loaded=t.loaded,t.lengthComputable&&(e.total=t.total)}getCacheAge(){let t=null;if(this.loader&&Da.test(this.loader.getAllResponseHeaders())){const e=this.loader.getResponseHeader("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.loader&&new RegExp(`^${t}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}}const Pa=/(\d+)-(\d+)\/(\d+)/;class xa{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||Ma,this.controller=new self.AbortController,this.stats=new Q}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),null!=(t=this.callbacks)&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(t,e,i){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();const r=function(t,e){const i={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(M({},t.headers))};t.rangeEnd&&i.headers.set("Range","bytes="+t.rangeStart+"-"+String(t.rangeEnd-1));return i}(t,this.controller.signal),n=i.onProgress,a="arraybuffer"===t.responseType,o=a?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:h}=e.loadPolicy;this.context=t,this.config=e,this.callbacks=i,this.request=this.fetchSetup(t,r),self.clearTimeout(this.requestTimeout),e.timeout=l&&O(l)?l:h,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),i.onTimeout(s,t,this.response)}),e.timeout),self.fetch(this.request).then((r=>{this.response=this.loader=r;const o=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),e.timeout=h,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),i.onTimeout(s,t,this.response)}),h-(o-s.loading.start)),!r.ok){const{status:t,statusText:e}=r;throw new Oa(e||"fetch, bad network response",t,r)}return s.loading.first=o,s.total=function(t){const e=t.get("Content-Range");if(e){const t=function(t){const e=Pa.exec(t);if(e)return parseInt(e[2])-parseInt(e[1])+1}(e);if(O(t))return t}const i=t.get("Content-Length");if(i)return parseInt(i)}(r.headers)||s.total,n&&O(e.highWaterMark)?this.loadProgressively(r,s,t,e.highWaterMark,n):a?r.arrayBuffer():"json"===t.responseType?r.json():r.text()})).then((r=>{const a=this.response;if(!a)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);const l=r[o];l&&(s.loaded=s.total=l);const h={url:a.url,data:r,code:a.status};n&&!O(e.highWaterMark)&&n(s,t,r,a),i.onSuccess(h,s,t,a)})).catch((e=>{if(self.clearTimeout(this.requestTimeout),s.aborted)return;const r=e&&e.code||0,n=e?e.message:null;i.onError({code:r,text:n},t,e?e.details:null,s)}))}getCacheAge(){let t=null;if(this.response){const e=this.response.headers.get("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(t,e,i,s=0,r){const n=new Hs,a=t.body.getReader(),o=()=>a.read().then((a=>{if(a.done)return n.dataLength&&r(e,i,n.flush(),t),Promise.resolve(new ArrayBuffer(0));const l=a.value,h=l.length;return e.loaded+=h,h<s||n.dataLength?(n.push(l),n.dataLength>=s&&r(e,i,n.flush(),t)):r(e,i,l,t),o()})).catch((()=>Promise.reject()));return o()}}function Ma(t,e){return new self.Request(t.url,e)}class Oa extends Error{constructor(t,e,i){super(t),this.code=void 0,this.details=void 0,this.code=e,this.details=i}}const Fa=/\s/,Na={newCue(t,e,i,s){const r=[];let n,a,o,l,h;const d=self.VTTCue||self.TextTrackCue;for(let u=0;u<s.rows.length;u++)if(n=s.rows[u],o=!0,l=0,h="",!n.isEmpty()){var c;for(let t=0;t<n.chars.length;t++)Fa.test(n.chars[t].uchar)&&o?l++:(h+=n.chars[t].uchar,o=!1);n.cueStartTime=e,e===i&&(i+=1e-4),l>=16?l--:l++;const s=Dn(h.trim()),f=On(e,i,s);null!=t&&null!=(c=t.cues)&&c.getCueById(f)||(a=new d(e,i,s),a.id=f,a.line=u+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*l/32)),r.push(a))}return t&&r.length&&(r.sort(((t,e)=>"auto"===t.line||"auto"===e.line?0:t.line>8&&e.line>8?e.line-t.line:t.line-e.line)),r.forEach((e=>Je(t,e)))),r}},Ua=w(w({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:wa,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class{constructor(t){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:t,partCurrent:e,hls:i}=this,{autoLevelEnabled:s,media:r}=i;if(!t||!r)return;const n=performance.now(),a=e?e.stats:t.stats,o=e?e.duration:t.duration,l=n-a.loading.start,h=i.minAutoLevel;if(a.aborted||a.loaded&&a.loaded===a.total||t.level<=h)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!s||r.paused||!r.playbackRate||!r.readyState)return;const d=i.mainForwardBufferInfo;if(null===d)return;const c=this.bwEstimator.getEstimateTTFB(),u=Math.abs(r.playbackRate);if(l<=Math.max(c,o/(2*u)*1e3))return;const f=d.len/u,g=a.loading.first?a.loading.first-a.loading.start:-1,m=a.loaded&&g>-1,p=this.getBwEstimate(),v=i.levels,y=v[t.level],E=a.total||Math.max(a.loaded,Math.round(o*y.averageBitrate/8));let T=m?l-g:l;T<1&&m&&(T=Math.min(l,8*a.loaded/p));const S=m?1e3*a.loaded/T:0,b=S?(E-a.loaded)/S:8*E/p+c/1e3;if(b<=f)return;const L=S?8*S:p;let A,R=Number.POSITIVE_INFINITY;for(A=t.level-1;A>h;A--){const t=v[A].maxBitrate;if(R=this.getTimeToLoadFrag(c/1e3,L,o*t,!v[A].details),R<f)break}if(R>=b)return;if(R>10*o)return;i.nextLoadLevel=i.nextAutoLevel=A,m?this.bwEstimator.sample(l-Math.min(c,g),a.loaded):this.bwEstimator.sampleTTFB(l);const k=v[A].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>k&&this.resetEstimator(k),this.clearTimer(),j.warn(`[abr] Fragment ${t.sn}${e?" part "+e.index:""} of level ${t.level} is loading too slowly;\n      Time to underbuffer: ${f.toFixed(3)} s\n      Estimated load time for current fragment: ${b.toFixed(3)} s\n      Estimated load time for down switch fragment: ${R.toFixed(3)} s\n      TTFB estimate: ${0|g} ms\n      Current BW estimate: ${O(p)?0|p:"Unknown"} bps\n      New BW estimate: ${0|this.getBwEstimate()} bps\n      Switching to level ${A} @ ${0|k} bps`),i.trigger(U.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:e,stats:a})},this.hls=t,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(t){t&&(j.log(`setting initial bwe to ${t}`),this.hls.config.abrEwmaDefaultEstimate=t),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const t=this.hls.config;return new Wi(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate)}registerListeners(){const{hls:t}=this;t.on(U.MANIFEST_LOADING,this.onManifestLoading,this),t.on(U.FRAG_LOADING,this.onFragLoading,this),t.on(U.FRAG_LOADED,this.onFragLoaded,this),t.on(U.FRAG_BUFFERED,this.onFragBuffered,this),t.on(U.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(U.LEVEL_LOADED,this.onLevelLoaded,this),t.on(U.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(U.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.on(U.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t&&(t.off(U.MANIFEST_LOADING,this.onManifestLoading,this),t.off(U.FRAG_LOADING,this.onFragLoading,this),t.off(U.FRAG_LOADED,this.onFragLoaded,this),t.off(U.FRAG_BUFFERED,this.onFragBuffered,this),t.off(U.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(U.LEVEL_LOADED,this.onLevelLoaded,this),t.off(U.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(U.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.off(U.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(t,e){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(t,e){const i=e.frag;if(!this.ignoreFragment(i)){var s;if(!i.bitrateTest)this.fragCurrent=i,this.partCurrent=null!=(s=e.part)?s:null;this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(t,e){this.clearTimer()}onError(t,e){if(!e.fatal)switch(e.details){case B.BUFFER_ADD_CODEC_ERROR:case B.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case B.FRAG_LOAD_TIMEOUT:{const t=e.frag,{fragCurrent:i,partCurrent:s}=this;if(t&&i&&t.sn===i.sn&&t.level===i.level){const e=performance.now(),i=s?s.stats:t.stats,r=e-i.loading.start,n=i.loading.first?i.loading.first-i.loading.start:-1;if(i.loaded&&n>-1){const t=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(r-Math.min(t,n),i.loaded)}else this.bwEstimator.sampleTTFB(r)}break}}}getTimeToLoadFrag(t,e,i,s){return t+i/e+(s?this.lastLevelLoadSec:0)}onLevelLoaded(t,e){const i=this.hls.config,{loading:s}=e.stats,r=s.end-s.start;O(r)&&(this.lastLevelLoadSec=r/1e3),e.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD)}onFragLoaded(t,{frag:e,part:i}){const s=i?i.stats:e.stats;if(e.type===je&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(e)){if(this.clearTimer(),e.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const t=i?i.duration:e.duration,r=this.hls.levels[e.level],n=(r.loaded?r.loaded.bytes:0)+s.loaded,a=(r.loaded?r.loaded.duration:0)+t;r.loaded={bytes:n,duration:a},r.realBitrate=Math.round(8*n/a)}if(e.bitrateTest){const t={stats:s,frag:e,part:i,id:e.type};this.onFragBuffered(U.FRAG_BUFFERED,t),e.bitrateTest=!1}else this.lastLoadedFragLevel=e.level}}onFragBuffered(t,e){const{frag:i,part:s}=e,r=null!=s&&s.stats.loaded?s.stats:i.stats;if(r.aborted)return;if(this.ignoreFragment(i))return;const n=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(n,r.loaded),r.bwEstimate=this.getBwEstimate(),i.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}ignoreFragment(t){return t.type!==je||"initSegment"===t.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:t,minAutoLevel:e}=this.hls,i=this.getBwEstimate(),s=this.hls.config.maxStarvationDelay,r=this.findBestLevel(i,e,t,0,s,1,1);if(r>-1)return r;const n=this.hls.firstLevel,a=Math.min(Math.max(n,e),t);return j.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${n} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const t=this.forcedAutoLevel,e=this.bwEstimator.canEstimate(),i=this.lastLoadedFragLevel>-1;if(!(-1===t||e&&i&&this.nextAutoLevelKey!==this.getAutoLevelKey()))return t;const s=e&&i?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==t){const e=this.hls.levels;if(e.length>Math.max(t,s)&&e[t].loadError<=e[s].loadError)return t}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:t,partCurrent:e,hls:i}=this,{maxAutoLevel:s,config:r,minAutoLevel:n}=i,a=e?e.duration:t?t.duration:0,o=this.getBwEstimate(),l=this.getStarvationDelay();let h=r.abrBandWidthFactor,d=r.abrBandWidthUpFactor;if(l){const t=this.findBestLevel(o,n,s,l,0,h,d);if(t>=0)return t}let c=a?Math.min(a,r.maxStarvationDelay):r.maxStarvationDelay;if(!l){const t=this.bitrateTestDelay;if(t){c=(a?Math.min(a,r.maxLoadingDelay):r.maxLoadingDelay)-t,j.info(`[abr] bitrate test took ${Math.round(1e3*t)}ms, set first fragment max fetchDuration to ${Math.round(1e3*c)} ms`),h=d=1}}const u=this.findBestLevel(o,n,s,l,c,h,d);if(j.info(`[abr] ${l?"rebuffering expected":"buffer is empty"}, optimal quality level ${u}`),u>-1)return u;const f=i.levels[n],g=i.levels[i.loadLevel];return(null==f?void 0:f.bitrate)<(null==g?void 0:g.bitrate)?n:i.loadLevel}getStarvationDelay(){const t=this.hls,e=t.media;if(!e)return 1/0;const i=e&&0!==e.playbackRate?Math.abs(e.playbackRate):1,s=t.mainForwardBufferInfo;return(s?s.len:0)/i}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(t,e,i,s,r,n,a){var o;const l=s+r,h=this.lastLoadedFragLevel,d=-1===h?this.hls.firstLevel:h,{fragCurrent:c,partCurrent:u}=this,{levels:f,allAudioTracks:g,loadLevel:m,config:p}=this.hls;if(1===f.length)return 0;const v=f[d],y=!(null==v||null==(o=v.details)||!o.live),E=-1===m||-1===h;let T,S="SDR",b=(null==v?void 0:v.frameRate)||0;const{audioPreference:L,videoPreference:A}=p,R=this.audioTracksByGroup||(this.audioTracksByGroup=function(t){return t.reduce(((t,e)=>{let i=t.groups[e.groupId];i||(i=t.groups[e.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(e);const s=e.channels||"2";return i.channels[s]=(i.channels[s]||0)+1,i.hasDefault=i.hasDefault||e.default,i.hasAutoSelect=i.hasAutoSelect||e.autoselect,i.hasDefault&&(t.hasDefaultAudio=!0),i.hasAutoSelect&&(t.hasAutoSelectAudio=!0),t}),{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}(g));if(E){if(-1!==this.firstSelection)return this.firstSelection;const s=this.codecTiers||(this.codecTiers=function(t,e,i,s){return t.slice(i,s+1).reduce(((t,i)=>{if(!i.codecSet)return t;const s=i.audioGroups;let r=t[i.codecSet];r||(t[i.codecSet]=r={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!s,fragmentError:0}),r.minBitrate=Math.min(r.minBitrate,i.bitrate);const n=Math.min(i.height,i.width);return r.minHeight=Math.min(r.minHeight,n),r.minFramerate=Math.min(r.minFramerate,i.frameRate),r.maxScore=Math.max(r.maxScore,i.score),r.fragmentError+=i.fragmentError,r.videoRanges[i.videoRange]=(r.videoRanges[i.videoRange]||0)+1,s&&s.forEach((t=>{if(!t)return;const i=e.groups[t];i&&(r.hasDefaultAudio=r.hasDefaultAudio||e.hasDefaultAudio?i.hasDefault:i.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(i.channels).forEach((t=>{r.channels[t]=(r.channels[t]||0)+i.channels[t]})))})),t}),{})}(f,R,e,i)),r=function(t,e,i,s,r){const n=Object.keys(t),a=null==s?void 0:s.channels,o=null==s?void 0:s.audioCodec,l=a&&2===parseInt(a);let h=!0,d=!1,c=1/0,u=1/0,f=1/0,g=0,m=[];const{preferHDR:p,allowedVideoRanges:v}=Qi(e,r);for(let e=n.length;e--;){const i=t[n[e]];h=i.channels[2]>0,c=Math.min(c,i.minHeight),u=Math.min(u,i.minFramerate),f=Math.min(f,i.minBitrate);const s=v.filter((t=>i.videoRanges[t]>0));s.length>0&&(d=!0,m=s)}c=O(c)?c:0,u=O(u)?u:0;const y=Math.max(1080,c),E=Math.max(30,u);return f=O(f)?f:i,i=Math.max(f,i),d||(e=void 0,m=[]),{codecSet:n.reduce(((e,s)=>{const r=t[s];if(s===e)return e;if(r.minBitrate>i)return Ji(s,`min bitrate of ${r.minBitrate} > current estimate of ${i}`),e;if(!r.hasDefaultAudio)return Ji(s,"no renditions with default or auto-select sound found"),e;if(o&&s.indexOf(o.substring(0,4))%5!=0)return Ji(s,`audio codec preference "${o}" not found`),e;if(a&&!l){if(!r.channels[a])return Ji(s,`no renditions with ${a} channel sound found (channels options: ${Object.keys(r.channels)})`),e}else if((!o||l)&&h&&0===r.channels[2])return Ji(s,"no renditions with stereo sound found"),e;return r.minHeight>y?(Ji(s,`min resolution of ${r.minHeight} > maximum of ${y}`),e):r.minFramerate>E?(Ji(s,`min framerate of ${r.minFramerate} > maximum of ${E}`),e):m.some((t=>r.videoRanges[t]>0))?r.maxScore<g?(Ji(s,`max score of ${r.maxScore} < selected max of ${g}`),e):e&&(Le(s)>=Le(e)||r.fragmentError>t[e].fragmentError)?e:(g=r.maxScore,s):(Ji(s,`no variants with VIDEO-RANGE of ${JSON.stringify(m)} found`),e)}),void 0),videoRanges:m,preferHDR:p,minFramerate:u,minBitrate:f}}(s,S,t,L,A),{codecSet:n,videoRanges:a,minFramerate:o,minBitrate:l,preferHDR:h}=r;T=n,S=h?a[a.length-1]:a[0],b=o,t=Math.max(t,l),j.log(`[abr] picked start tier ${JSON.stringify(r)}`)}else T=null==v?void 0:v.codecSet,S=null==v?void 0:v.videoRange;const k=u?u.duration:c?c.duration:0,C=this.bwEstimator.getEstimateTTFB()/1e3,_=[];for(let o=i;o>=e;o--){var I;const e=f[o],c=o>d;if(!e)continue;if(p.useMediaCapabilities&&!e.supportedResult&&!e.supportedPromise){const i=navigator.mediaCapabilities;"function"==typeof(null==i?void 0:i.decodingInfo)&&qi(e,R,S,b,t,L)?(e.supportedPromise=Xi(e,R,i),e.supportedPromise.then((t=>{if(!this.hls)return;e.supportedResult=t;const i=this.hls.levels,s=i.indexOf(e);t.error?j.warn(`[abr] MediaCapabilities decodingInfo error: "${t.error}" for level ${s} ${JSON.stringify(t)}`):t.supported||(j.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${s} ${JSON.stringify(t)}`),s>-1&&i.length>1&&(j.log(`[abr] Removing unsupported level ${s}`),this.hls.removeLevel(s)))}))):e.supportedResult=zi}if(T&&e.codecSet!==T||S&&e.videoRange!==S||c&&b>e.frameRate||!c&&b>0&&b<e.frameRate||e.supportedResult&&(null==(I=e.supportedResult.decodingInfoResults)||!I[0].smooth)){_.push(o);continue}const g=e.details,A=(u?null==g?void 0:g.partTarget:null==g?void 0:g.averagetargetduration)||k;let D;D=c?a*t:n*t;const w=k&&s>=2*k&&0===r?f[o].averageBitrate:f[o].maxBitrate,P=this.getTimeToLoadFrag(C,D,w*A,void 0===g);if(D>=w&&(o===h||0===e.loadError&&0===e.fragmentError)&&(P<=C||!O(P)||y&&!this.bitrateTestDelay||P<l)){const t=this.forcedAutoLevel;return o===m||-1!==t&&t===m||(_.length&&j.trace(`[abr] Skipped level(s) ${_.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${f[_[0]].codecs}" ${f[_[0]].videoRange}; not compatible with "${v.codecs}" ${S}`),j.info(`[abr] switch candidate:${d}->${o} adjustedbw(${Math.round(D)})-bitrate=${Math.round(D-w)} ttfb:${C.toFixed(1)} avgDuration:${A.toFixed(1)} maxFetchDuration:${l.toFixed(1)} fetchDuration:${P.toFixed(1)} firstSelection:${E} codecSet:${T} videoRange:${S} hls.loadLevel:${m}`)),E&&(this.firstSelection=o),o}}return-1}set nextAutoLevel(t){const{maxAutoLevel:e,minAutoLevel:i}=this.hls,s=Math.min(Math.max(t,i),e);this._nextAutoLevel!==s&&(this.nextAutoLevelKey="",this._nextAutoLevel=s)}},bufferController:class{constructor(t){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=t=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=t=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:t,mediaSource:e}=this;this.log("Media source opened"),t&&(t.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(U.MEDIA_ATTACHED,{media:t,mediaSource:e})),e&&e.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:t,_objectUrl:e}=this;t!==e&&j.error(`Media element src was set while attaching MediaSource (${e} > ${t})`)},this.hls=t;const e="[buffer-controller]";var i;this.appendSource=(i=ve(t.config.preferManagedMediaSource),"undefined"!=typeof self&&i===self.ManagedMediaSource),this.log=j.log.bind(j,e),this.warn=j.warn.bind(j,e),this.error=j.error.bind(j,e),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:t}=this;t.on(U.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(U.MANIFEST_LOADING,this.onManifestLoading,this),t.on(U.MANIFEST_PARSED,this.onManifestParsed,this),t.on(U.BUFFER_RESET,this.onBufferReset,this),t.on(U.BUFFER_APPENDING,this.onBufferAppending,this),t.on(U.BUFFER_CODECS,this.onBufferCodecs,this),t.on(U.BUFFER_EOS,this.onBufferEos,this),t.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(U.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(U.FRAG_PARSED,this.onFragParsed,this),t.on(U.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:t}=this;t.off(U.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(U.MANIFEST_LOADING,this.onManifestLoading,this),t.off(U.MANIFEST_PARSED,this.onManifestParsed,this),t.off(U.BUFFER_RESET,this.onBufferReset,this),t.off(U.BUFFER_APPENDING,this.onBufferAppending,this),t.off(U.BUFFER_CODECS,this.onBufferCodecs,this),t.off(U.BUFFER_EOS,this.onBufferEos,this),t.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(U.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(U.FRAG_PARSED,this.onFragParsed,this),t.off(U.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Jr(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,e){let i=2;(e.audio&&!e.video||!e.altAudio)&&(i=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=i,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(t,e){const i=this.media=e.media,s=ve(this.appendSource);if(i&&s){var r;const t=this.mediaSource=new s;this.log(`created media source: ${null==(r=t.constructor)?void 0:r.name}`),t.addEventListener("sourceopen",this._onMediaSourceOpen),t.addEventListener("sourceended",this._onMediaSourceEnded),t.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.addEventListener("startstreaming",this._onStartStreaming),t.addEventListener("endstreaming",this._onEndStreaming));const e=this._objectUrl=self.URL.createObjectURL(t);if(this.appendSource)try{i.removeAttribute("src");const s=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||s&&t instanceof s,tn(i),function(t,e){const i=self.document.createElement("source");i.type="video/mp4",i.src=e,t.appendChild(i)}(i,e),i.load()}catch(t){i.src=e}else i.src=e;i.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:t,mediaSource:e,_objectUrl:i}=this;if(e){if(this.log("media source detaching"),"open"===e.readyState)try{e.endOfStream()}catch(t){this.warn(`onMediaDetaching: ${t.message} while calling endOfStream`)}this.onBufferReset(),e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.removeEventListener("startstreaming",this._onStartStreaming),e.removeEventListener("endstreaming",this._onEndStreaming)),t&&(t.removeEventListener("emptied",this._onMediaEmptied),i&&self.URL.revokeObjectURL(i),this.mediaSrc===i?(t.removeAttribute("src"),this.appendSource&&tn(t),t.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(U.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach((t=>{this.resetBuffer(t)})),this._initSourceBuffer()}resetBuffer(t){const e=this.sourceBuffer[t];try{var i;if(e)this.removeBufferListeners(t),this.sourceBuffer[t]=void 0,null!=(i=this.mediaSource)&&i.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(e)}catch(e){this.warn(`onBufferReset ${t}`,e)}}onBufferCodecs(t,e){const i=this.getSourceBufferTypes().length,s=Object.keys(e);if(s.forEach((t=>{if(i){const i=this.tracks[t];if(i&&"function"==typeof i.buffer.changeType){var s;const{id:r,codec:n,levelCodec:a,container:o,metadata:l}=e[t],h=Ce(i.codec,i.levelCodec),d=null==h?void 0:h.replace(Zr,"$1");let c=Ce(n,a);const u=null==(s=c)?void 0:s.replace(Zr,"$1");if(c&&d!==u){"audio"===t.slice(0,5)&&(c=ke(c,this.appendSource));const e=`${o};codecs=${c}`;this.appendChangeType(t,e),this.log(`switching codec ${h} to ${c}`),this.tracks[t]={buffer:i.buffer,codec:n,container:o,levelCodec:a,metadata:l,id:r}}}}else this.pendingTracks[t]=e[t]})),i)return;const r=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==r&&(this.log(`${r} bufferCodec event(s) expected ${s.join(",")}`),this.bufferCodecEventsExpected=r),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks()}appendChangeType(t,e){const{operationQueue:i}=this,s={execute:()=>{const s=this.sourceBuffer[t];s&&(this.log(`changing ${t} sourceBuffer type to ${e}`),s.changeType(e)),i.shiftAndExecuteNext(t)},onStart:()=>{},onComplete:()=>{},onError:e=>{this.warn(`Failed to change ${t} SourceBuffer type`,e)}};i.append(s,t,!!this.pendingTracks[t])}onBufferAppending(t,e){const{hls:i,operationQueue:s,tracks:r}=this,{data:n,type:a,frag:o,part:l,chunkMeta:h}=e,d=h.buffering[a],c=self.performance.now();d.start=c;const u=o.stats.buffering,f=l?l.stats.buffering:null;0===u.start&&(u.start=c),f&&0===f.start&&(f.start=c);const g=r.audio;let m=!1;"audio"===a&&"audio/mpeg"===(null==g?void 0:g.container)&&(m=!this.lastMpegAudioChunk||1===h.id||this.lastMpegAudioChunk.sn!==h.sn,this.lastMpegAudioChunk=h);const p=o.start,v={execute:()=>{if(d.executeStart=self.performance.now(),m){const t=this.sourceBuffer[a];if(t){const e=p-t.timestampOffset;Math.abs(e)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${p} (delta: ${e}) sn: ${o.sn})`),t.timestampOffset=p)}}this.appendExecutor(n,a)},onStart:()=>{},onComplete:()=>{const t=self.performance.now();d.executeEnd=d.end=t,0===u.first&&(u.first=t),f&&0===f.first&&(f.first=t);const{sourceBuffer:e}=this,i={};for(const t in e)i[t]=us.getBuffered(e[t]);this.appendErrors[a]=0,"audio"===a||"video"===a?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(U.BUFFER_APPENDED,{type:a,frag:o,part:l,chunkMeta:h,parent:o.type,timeRanges:i})},onError:t=>{const e={type:$.MEDIA_ERROR,parent:o.type,details:B.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:o,part:l,chunkMeta:h,error:t,err:t,fatal:!1};if(t.code===DOMException.QUOTA_EXCEEDED_ERR)e.details=B.BUFFER_FULL_ERROR;else{const t=++this.appendErrors[a];e.details=B.BUFFER_APPEND_ERROR,this.warn(`Failed ${t}/${i.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer`),t>=i.config.appendErrorMaxRetry&&(e.fatal=!0)}i.trigger(U.ERROR,e)}};s.append(v,a,!!this.pendingTracks[a])}onBufferFlushing(t,e){const{operationQueue:i}=this,s=t=>({execute:this.removeExecutor.bind(this,t,e.startOffset,e.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(U.BUFFER_FLUSHED,{type:t})},onError:e=>{this.warn(`Failed to remove from ${t} SourceBuffer`,e)}});e.type?i.append(s(e.type),e.type):this.getSourceBufferTypes().forEach((t=>{i.append(s(t),t)}))}onFragParsed(t,e){const{frag:i,part:s}=e,r=[],n=s?s.elementaryStreams:i.elementaryStreams;n[tt]?r.push("audiovideo"):(n[J]&&r.push("audio"),n[Z]&&r.push("video"));0===r.length&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers((()=>{const t=self.performance.now();i.stats.buffering.end=t,s&&(s.stats.buffering.end=t);const e=s?s.stats:i.stats;this.hls.trigger(U.FRAG_BUFFERED,{frag:i,part:s,stats:e,id:i.type})}),r)}onFragChanged(t,e){this.trimBuffers()}onBufferEos(t,e){this.getSourceBufferTypes().reduce(((t,i)=>{const s=this.sourceBuffer[i];return!s||e.type&&e.type!==i||(s.ending=!0,s.ended||(s.ended=!0,this.log(`${i} sourceBuffer now EOS`))),t&&!(s&&!s.ended)}),!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers((()=>{this.getSourceBufferTypes().forEach((t=>{const e=this.sourceBuffer[t];e&&(e.ending=!1)}));const{mediaSource:t}=this;t&&"open"===t.readyState?(this.log("Calling mediaSource.endOfStream()"),t.endOfStream()):t&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${t.readyState}`)})))}onLevelUpdated(t,{details:e}){e.fragments.length&&(this.details=e,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:t,details:e,media:i}=this;if(!i||null===e)return;if(!this.getSourceBufferTypes().length)return;const s=t.config,r=i.currentTime,n=e.levelTargetDuration,a=e.live&&null!==s.liveBackBufferLength?s.liveBackBufferLength:s.backBufferLength;if(O(a)&&a>0){const t=Math.max(a,n),e=Math.floor(r/n)*n-t;this.flushBackBuffer(r,n,e)}if(O(s.frontBufferFlushThreshold)&&s.frontBufferFlushThreshold>0){const t=Math.max(s.maxBufferLength,s.frontBufferFlushThreshold),e=Math.max(t,n),i=Math.floor(r/n)*n+e;this.flushFrontBuffer(r,n,i)}}flushBackBuffer(t,e,i){const{details:s,sourceBuffer:r}=this;this.getSourceBufferTypes().forEach((n=>{const a=r[n];if(a){const r=us.getBuffered(a);if(r.length>0&&i>r.start(0)){if(this.hls.trigger(U.BACK_BUFFER_REACHED,{bufferEnd:i}),null!=s&&s.live)this.hls.trigger(U.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(a.ended&&r.end(r.length-1)-t<2*e)return void this.log(`Cannot flush ${n} back buffer while SourceBuffer is in ended state`);this.hls.trigger(U.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:n})}}}))}flushFrontBuffer(t,e,i){const{sourceBuffer:s}=this;this.getSourceBufferTypes().forEach((r=>{const n=s[r];if(n){const s=us.getBuffered(n),a=s.length;if(a<2)return;const o=s.start(a-1),l=s.end(a-1);if(i>o||t>=o&&t<=l)return;if(n.ended&&t-l<2*e)return void this.log(`Cannot flush ${r} front buffer while SourceBuffer is in ended state`);this.hls.trigger(U.BUFFER_FLUSHING,{startOffset:o,endOffset:1/0,type:r})}}))}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||"open"!==this.mediaSource.readyState)return;const{details:t,hls:e,media:i,mediaSource:s}=this,r=t.fragments[0].start+t.totalduration,n=i.duration,a=O(s.duration)?s.duration:0;t.live&&e.config.liveDurationInfinity?(s.duration=1/0,this.updateSeekableRange(t)):(r>a&&r>n||!O(n))&&(this.log(`Updating Media Source duration to ${r.toFixed(3)}`),s.duration=r)}updateSeekableRange(t){const e=this.mediaSource,i=t.fragments;if(i.length&&t.live&&null!=e&&e.setLiveSeekableRange){const s=Math.max(0,i[0].start),r=Math.max(s,s+t.totalduration);this.log(`Media Source duration is set to ${e.duration}. Setting seekable range to ${s}-${r}.`),e.setLiveSeekableRange(s,r)}}checkPendingTracks(){const{bufferCodecEventsExpected:t,operationQueue:e,pendingTracks:i}=this,s=Object.keys(i).length;if(s&&(!t||2===s||"audiovideo"in i)){this.createSourceBuffers(i),this.pendingTracks={};const t=this.getSourceBufferTypes();if(t.length)this.hls.trigger(U.BUFFER_CREATED,{tracks:this.tracks}),t.forEach((t=>{e.executeNext(t)}));else{const t=new Error("could not create source buffer for media codec(s)");this.hls.trigger(U.ERROR,{type:$.MEDIA_ERROR,details:B.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:t,reason:t.message})}}}createSourceBuffers(t){const{sourceBuffer:e,mediaSource:i}=this;if(!i)throw Error("createSourceBuffers called when mediaSource was null");for(const r in t)if(!e[r]){var s;const n=t[r];if(!n)throw Error(`source buffer exists for track ${r}, however track does not`);let a=-1===(null==(s=n.levelCodec)?void 0:s.indexOf(","))?n.levelCodec:n.codec;a&&"audio"===r.slice(0,5)&&(a=ke(a,this.appendSource));const o=`${n.container};codecs=${a}`;this.log(`creating sourceBuffer(${o})`);try{const t=e[r]=i.addSourceBuffer(o),s=r;this.addBufferListener(s,"updatestart",this._onSBUpdateStart),this.addBufferListener(s,"updateend",this._onSBUpdateEnd),this.addBufferListener(s,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(s,"bufferedchange",((t,e)=>{const i=e.removedRanges;null!=i&&i.length&&this.hls.trigger(U.BUFFER_FLUSHED,{type:r})})),this.tracks[r]={buffer:t,codec:a,container:n.container,levelCodec:n.levelCodec,metadata:n.metadata,id:n.id}}catch(t){this.error(`error while trying to add sourceBuffer: ${t.message}`),this.hls.trigger(U.ERROR,{type:$.MEDIA_ERROR,details:B.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:t,sourceBufferName:r,mimeType:o})}}}get mediaSrc(){var t;const e=(null==(t=this.media)?void 0:t.firstChild)||this.media;return null==e?void 0:e.src}_onSBUpdateStart(t){const{operationQueue:e}=this;e.current(t).onStart()}_onSBUpdateEnd(t){var e;if("closed"===(null==(e=this.mediaSource)?void 0:e.readyState))return void this.resetBuffer(t);const{operationQueue:i}=this;i.current(t).onComplete(),i.shiftAndExecuteNext(t)}_onSBUpdateError(t,e){var i;const s=new Error(`${t} SourceBuffer error. MediaSource readyState: ${null==(i=this.mediaSource)?void 0:i.readyState}`);this.error(`${s}`,e),this.hls.trigger(U.ERROR,{type:$.MEDIA_ERROR,details:B.BUFFER_APPENDING_ERROR,sourceBufferName:t,error:s,fatal:!1});const r=this.operationQueue.current(t);r&&r.onError(s)}removeExecutor(t,e,i){const{media:s,mediaSource:r,operationQueue:n,sourceBuffer:a}=this,o=a[t];if(!s||!r||!o)return this.warn(`Attempting to remove from the ${t} SourceBuffer, but it does not exist`),void n.shiftAndExecuteNext(t);const l=O(s.duration)?s.duration:1/0,h=O(r.duration)?r.duration:1/0,d=Math.max(0,e),c=Math.min(i,l,h);c>d&&(!o.ending||o.ended)?(o.ended=!1,this.log(`Removing [${d},${c}] from the ${t} SourceBuffer`),o.remove(d,c)):n.shiftAndExecuteNext(t)}appendExecutor(t,e){const i=this.sourceBuffer[e];if(i)i.ended=!1,i.appendBuffer(t);else if(!this.pendingTracks[e])throw new Error(`Attempting to append to the ${e} SourceBuffer, but it does not exist`)}blockBuffers(t,e=this.getSourceBufferTypes()){if(!e.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(t);const{operationQueue:i}=this,s=e.map((t=>i.appendBlocker(t)));Promise.all(s).then((()=>{t(),e.forEach((t=>{const e=this.sourceBuffer[t];null!=e&&e.updating||i.shiftAndExecuteNext(t)}))}))}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(t,e,i){const s=this.sourceBuffer[t];if(!s)return;const r=i.bind(this,t);this.listeners[t].push({event:e,listener:r}),s.addEventListener(e,r)}removeBufferListeners(t){const e=this.sourceBuffer[t];e&&this.listeners[t].forEach((t=>{e.removeEventListener(t.event,t.listener)}))}},capLevelController:Xn,errorController:class{constructor(t){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=t,this.log=j.log.bind(j,"[info]:"),this.warn=j.warn.bind(j,"[warning]:"),this.error=j.error.bind(j,"[error]:"),this.registerListeners()}registerListeners(){const t=this.hls;t.on(U.ERROR,this.onError,this),t.on(U.MANIFEST_LOADING,this.onManifestLoading,this),t.on(U.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const t=this.hls;t&&(t.off(U.ERROR,this.onError,this),t.off(U.ERROR,this.onErrorOut,this),t.off(U.MANIFEST_LOADING,this.onManifestLoading,this),t.off(U.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(t){}stopLoad(){this.playlistError=0}getVariantLevelIndex(t){return(null==t?void 0:t.type)===je?t.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(t,e){var i,s;if(e.fatal)return;const r=this.hls,n=e.context;switch(e.details){case B.FRAG_LOAD_ERROR:case B.FRAG_LOAD_TIMEOUT:case B.KEY_LOAD_ERROR:case B.KEY_LOAD_TIMEOUT:return void(e.errorAction=this.getFragRetryOrSwitchAction(e));case B.FRAG_PARSING_ERROR:if(null!=(i=e.frag)&&i.gap)return void(e.errorAction={action:Ni,flags:Gi});case B.FRAG_GAP:case B.FRAG_DECRYPT_ERROR:return e.errorAction=this.getFragRetryOrSwitchAction(e),void(e.errorAction.action=Ui);case B.LEVEL_EMPTY_ERROR:case B.LEVEL_PARSING_ERROR:{var a,o;const t=e.parent===je?e.level:r.loadLevel;e.details===B.LEVEL_EMPTY_ERROR&&null!=(a=e.context)&&null!=(o=a.levelDetails)&&o.live?e.errorAction=this.getPlaylistRetryOrSwitchAction(e,t):(e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t))}return;case B.LEVEL_LOAD_ERROR:case B.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==n?void 0:n.level)&&(e.errorAction=this.getPlaylistRetryOrSwitchAction(e,n.level)));case B.AUDIO_TRACK_LOAD_ERROR:case B.AUDIO_TRACK_LOAD_TIMEOUT:case B.SUBTITLE_LOAD_ERROR:case B.SUBTITLE_TRACK_LOAD_TIMEOUT:if(n){const t=r.levels[r.loadLevel];if(t&&(n.type===Ve&&t.hasAudioGroup(n.groupId)||n.type===Ke&&t.hasSubtitleGroup(n.groupId)))return e.errorAction=this.getPlaylistRetryOrSwitchAction(e,r.loadLevel),e.errorAction.action=Ui,void(e.errorAction.flags=Hi)}return;case B.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const t=r.levels[r.loadLevel],i=null==t?void 0:t.attrs["HDCP-LEVEL"];i?e.errorAction={action:Ui,flags:Vi,hdcpLevel:i}:this.keySystemError(e)}return;case B.BUFFER_ADD_CODEC_ERROR:case B.REMUX_ALLOC_ERROR:case B.BUFFER_APPEND_ERROR:return void(e.errorAction=this.getLevelSwitchAction(e,null!=(s=e.level)?s:r.loadLevel));case B.INTERNAL_EXCEPTION:case B.BUFFER_APPENDING_ERROR:case B.BUFFER_FULL_ERROR:case B.LEVEL_SWITCH_ERROR:case B.BUFFER_STALLED_ERROR:case B.BUFFER_SEEK_OVER_HOLE:case B.BUFFER_NUDGE_ON_STALL:return void(e.errorAction={action:Ni,flags:Gi})}e.type===$.KEY_SYSTEM_ERROR&&this.keySystemError(e)}keySystemError(t){const e=this.getVariantLevelIndex(t.frag);t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e)}getPlaylistRetryOrSwitchAction(t,e){const i=Ii(this.hls.config.playlistLoadPolicy,t),s=this.playlistError++;if(Pi(i,s,_i(t),t.response))return{action:Bi,flags:Gi,retryConfig:i,retryCount:s};const r=this.getLevelSwitchAction(t,e);return i&&(r.retryConfig=i,r.retryCount=s),r}getFragRetryOrSwitchAction(t){const e=this.hls,i=this.getVariantLevelIndex(t.frag),s=e.levels[i],{fragLoadPolicy:r,keyLoadPolicy:n}=e.config,a=Ii(t.details.startsWith("key")?n:r,t),o=e.levels.reduce(((t,e)=>t+e.fragmentError),0);if(s){t.details!==B.FRAG_GAP&&s.fragmentError++;if(Pi(a,o,_i(t),t.response))return{action:Bi,flags:Gi,retryConfig:a,retryCount:o}}const l=this.getLevelSwitchAction(t,i);return a&&(l.retryConfig=a,l.retryCount=o),l}getLevelSwitchAction(t,e){const i=this.hls;null==e&&(e=i.loadLevel);const s=this.hls.levels[e];if(s){var r,n;const e=t.details;s.loadError++,e===B.BUFFER_APPEND_ERROR&&s.fragmentError++;let l=-1;const{levels:h,loadLevel:d,minAutoLevel:c,maxAutoLevel:u}=i;i.autoLevelEnabled||(i.loadLevel=-1);const f=null==(r=t.frag)?void 0:r.type,g=(f===We&&e===B.FRAG_PARSING_ERROR||"audio"===t.sourceBufferName&&(e===B.BUFFER_ADD_CODEC_ERROR||e===B.BUFFER_APPEND_ERROR))&&h.some((({audioCodec:t})=>s.audioCodec!==t)),m="video"===t.sourceBufferName&&(e===B.BUFFER_ADD_CODEC_ERROR||e===B.BUFFER_APPEND_ERROR)&&h.some((({codecSet:t,audioCodec:e})=>s.codecSet!==t&&s.audioCodec===e)),{type:p,groupId:v}=null!=(n=t.context)?n:{};for(let i=h.length;i--;){const r=(i+d)%h.length;if(r!==d&&r>=c&&r<=u&&0===h[r].loadError){var a,o;const i=h[r];if(e===B.FRAG_GAP&&t.frag){const e=h[r].details;if(e){const i=Mi(t.frag,e.fragments,t.frag.start);if(null!=i&&i.gap)continue}}else{if(p===Ve&&i.hasAudioGroup(v)||p===Ke&&i.hasSubtitleGroup(v))continue;if(f===We&&null!=(a=s.audioGroups)&&a.some((t=>i.hasAudioGroup(t)))||f===ze&&null!=(o=s.subtitleGroups)&&o.some((t=>i.hasSubtitleGroup(t)))||g&&s.audioCodec===i.audioCodec||!g&&s.audioCodec!==i.audioCodec||m&&s.codecSet===i.codecSet)continue}l=r;break}}if(l>-1&&i.loadLevel!==l)return t.levelRetry=!0,this.playlistError=0,{action:Ui,flags:Gi,nextAutoLevel:l}}return{action:Ui,flags:Hi}}onErrorOut(t,e){var i;switch(null==(i=e.errorAction)?void 0:i.action){case Ni:break;case Ui:this.sendAlternateToPenaltyBox(e),e.errorAction.resolved||e.details===B.FRAG_GAP?/MediaSource readyState: ended/.test(e.error.message)&&(this.warn(`MediaSource ended after "${e.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError()):e.fatal=!0}e.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(t){const e=this.hls,i=t.errorAction;if(!i)return;const{flags:s,hdcpLevel:r,nextAutoLevel:n}=i;switch(s){case Gi:this.switchLevel(t,n);break;case Vi:r&&(e.maxHdcpLevel=ci[ci.indexOf(r)-1],i.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${e.maxHdcpLevel}" or lower`)}i.resolved||this.switchLevel(t,n)}switchLevel(t,e){void 0!==e&&t.errorAction&&(this.warn(`switching to level ${e} after ${t.details}`),this.hls.nextAutoLevel=e,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}},fpsController:class{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on(U.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(U.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,e){const i=this.hls.config;if(i.capLevelOnFPSDrop){const t=e.media instanceof self.HTMLVideoElement?e.media:null;this.media=t,t&&"function"==typeof t.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}checkFPS(t,e,i){const s=performance.now();if(e){if(this.lastTime){const t=s-this.lastTime,r=i-this.lastDroppedFrames,n=e-this.lastDecodedFrames,a=1e3*r/t,o=this.hls;if(o.trigger(U.FPS_DROP,{currentDropped:r,currentDecoded:n,totalDroppedFrames:i}),a>0&&r>o.config.fpsDroppedMonitoringThreshold*n){let t=o.currentLevel;j.warn("drop FPS ratio greater than max allowed value for currentLevel: "+t),t>0&&(-1===o.autoLevelCapping||o.autoLevelCapping>=t)&&(t-=1,o.trigger(U.FPS_DROP_LEVEL_CAPPING,{level:t,droppedLevel:o.currentLevel}),o.autoLevelCapping=t,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=i,this.lastDecodedFrames=e}}checkFPSInterval(){const t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){const e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:yt,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:Na,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends Gs{constructor(t,e,i){super(t,e,i,"[subtitle-stream-controller]",ze),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:t}=this;t.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(U.MANIFEST_LOADING,this.onManifestLoading,this),t.on(U.LEVEL_LOADED,this.onLevelLoaded,this),t.on(U.ERROR,this.onError,this),t.on(U.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(U.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(U.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(U.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(U.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(U.MANIFEST_LOADING,this.onManifestLoading,this),t.off(U.LEVEL_LOADED,this.onLevelLoaded,this),t.off(U.ERROR,this.onError,this),t.off(U.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(U.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(U.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(U.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(U.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(t){this.stopLoad(),this.state=Ds,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(t,e){this.mainDetails=e.details}onSubtitleFragProcessed(t,e){const{frag:i,success:s}=e;if(this.fragPrevious=i,this.state=Ds,!s)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let n;const a=i.start;for(let t=0;t<r.length;t++)if(a>=r[t].start&&a<=r[t].end){n=r[t];break}const o=i.start+i.duration;n?n.end=o:(n={start:a,end:o},r.push(n)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null)}onBufferFlushing(t,e){const{startOffset:i,endOffset:s}=e;if(0===i&&s!==Number.POSITIVE_INFINITY){const t=s-1;if(t<=0)return;e.endOffsetSubtitles=Math.max(0,t),this.tracksBuffered.forEach((e=>{for(let i=0;i<e.length;)if(e[i].end<=t)e.shift();else{if(!(e[i].start<t))break;e[i].start=t,i++}})),this.fragmentTracker.removeFragmentsInRange(i,t,ze)}}onFragBuffered(t,e){var i;this.loadedmetadata||e.frag.type!==je||null!=(i=this.media)&&i.buffered.length&&(this.loadedmetadata=!0)}onError(t,e){const i=e.frag;(null==i?void 0:i.type)===ze&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Is&&(this.state=Ds))}onSubtitleTracksUpdated(t,{subtitleTracks:e}){this.levels&&Yr(this.levels,e)?this.levels=e.map((t=>new yi(t))):(this.tracksBuffered=[],this.levels=e.map((t=>{const e=new yi(t);return this.tracksBuffered[e.id]=[],e})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ze),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(t,e){var i;if(this.currentTrackId=e.id,null==(i=this.levels)||!i.length||-1===this.currentTrackId)return void this.clearInterval();const s=this.levels[this.currentTrackId];null!=s&&s.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,s&&this.setInterval(500)}onSubtitleTrackLoaded(t,e){var i;const{currentTrackId:s,levels:r}=this,{details:n,id:a}=e;if(!r)return void this.warn(`Subtitle tracks were reset while loading level ${a}`);const o=r[s];if(a>=r.length||a!==s||!o)return;this.log(`Subtitle track ${a} loaded [${n.startSN},${n.endSN}]${n.lastPartSn?`[part-${n.lastPartSn}-${n.lastPartIndex}]`:""},duration:${n.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(n.live||null!=(i=o.details)&&i.live){const t=this.mainDetails;if(n.deltaUpdateFailed||!t)return;const e=t.fragments[0];var h;if(o.details)l=this.alignPlaylists(n,o.details,null==(h=this.levelLastLoaded)?void 0:h.details),0===l&&e&&(l=e.start,Ai(n,l));else n.hasProgramDateTime&&t.hasProgramDateTime?(ys(n,t),l=n.fragments[0].start):e&&(l=e.start,Ai(n,l))}if(o.details=n,this.levelLastLoaded=o,this.startFragRequested||!this.mainDetails&&n.live||this.setStartPosition(this.mainDetails||n,l),this.tick(),n.live&&!this.fragCurrent&&this.media&&this.state===Ds){Mi(null,n.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0)}}_handleFragmentLoadComplete(t){const{frag:e,payload:i}=t,s=e.decryptdata,r=this.hls;if(!this.fragContextChanged(e)&&i&&i.byteLength>0&&null!=s&&s.key&&s.iv&&"AES-128"===s.method){const t=performance.now();this.decrypter.decrypt(new Uint8Array(i),s.key.buffer,s.iv.buffer).catch((t=>{throw (r.trigger(U.ERROR,{type:$.MEDIA_ERROR,details:B.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}), t)})).then((i=>{const s=performance.now();r.trigger(U.FRAG_DECRYPTED,{frag:e,payload:i,stats:{tstart:t,tdecrypt:s}})})).catch((t=>{this.warn(`${t.name}: ${t.message}`),this.state=Ds}))}}doTick(){if(this.media){if(this.state===Ds){const{currentTrackId:t,levels:e}=this,i=null==e?void 0:e[t];if(!i||!e.length||!i.details)return;const{config:s}=this,r=this.getLoadPosition(),n=us.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,s.maxBufferHole),{end:a,len:o}=n,l=this.getFwdBufferInfo(this.media,je),h=i.details;if(o>this.getMaxBufferLength(null==l?void 0:l.len)+h.levelTargetDuration)return;const d=h.fragments,c=d.length,u=h.edge;let f=null;const g=this.fragPrevious;if(a<u){const t=s.maxFragLookUpTolerance,e=a>u-t?0:t;f=Mi(g,d,Math.max(d[0].start,a),e),!f&&g&&g.start<d[0].start&&(f=d[0])}else f=d[c-1];if(!f)return;if(f=this.mapToInitFragWhenRequired(f),"initSegment"!==f.sn){const t=d[f.sn-h.startSN-1];t&&t.cc===f.cc&&this.fragmentTracker.getState(t)===rs&&(f=t)}this.fragmentTracker.getState(f)===rs&&this.loadFragment(f,i,a)}}else this.state=Ds}getMaxBufferLength(t){const e=super.getMaxBufferLength();return t?Math.max(e,t):e}loadFragment(t,e,i){this.fragCurrent=t,"initSegment"===t.sn?this._loadInitSegment(t,e):(this.startFragRequested=!0,super.loadFragment(t,e,i))}get mediaBufferTimeRanges(){return new Qr(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends Ki{constructor(t){super(t,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const e=ei(this.media.textTracks);for(let i=0;i<e.length;i++)if("hidden"===e[i].mode)t=e[i];else if("showing"===e[i].mode){t=e[i];break}const i=this.findTrackForTextTrack(t);this.subtitleTrack!==i&&this.setSubtitleTrack(i)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:t}=this;t.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(U.MANIFEST_LOADING,this.onManifestLoading,this),t.on(U.MANIFEST_PARSED,this.onManifestParsed,this),t.on(U.LEVEL_LOADING,this.onLevelLoading,this),t.on(U.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(U.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(U.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(U.MANIFEST_LOADING,this.onManifestLoading,this),t.off(U.MANIFEST_PARSED,this.onManifestParsed,this),t.off(U.LEVEL_LOADING,this.onLevelLoading,this),t.off(U.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(U.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(U.ERROR,this.onError,this)}onMediaAttached(t,e){this.media=e.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,t)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);ei(this.media.textTracks).forEach((t=>{Ze(t)})),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.subtitleTracks}onSubtitleTrackLoaded(t,e){const{id:i,groupId:s,details:r}=e,n=this.tracksInGroup[i];if(!n||n.groupId!==s)return void this.warn(`Subtitle track with id:${i} and group:${s} not found in active group ${null==n?void 0:n.groupId}`);const a=n.details;n.details=e.details,this.log(`Subtitle track ${i} "${n.name}" lang:${n.lang} group:${s} loaded [${r.startSN}-${r.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,a)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const i=e.subtitleGroups||null,s=this.groupIds;let r=this.currentTrack;if(!i||(null==s?void 0:s.length)!==(null==i?void 0:i.length)||null!=i&&i.some((t=>-1===(null==s?void 0:s.indexOf(t))))){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const t=this.tracks.filter((t=>!i||-1!==i.indexOf(t.groupId)));if(t.length)this.selectDefaultTrack&&!t.some((t=>t.default))&&(this.selectDefaultTrack=!1),t.forEach(((t,e)=>{t.id=e}));else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=t;const e=this.hls.config.subtitlePreference;if(!r&&e){this.selectDefaultTrack=!1;const i=Zi(e,t);if(i>-1)r=t[i];else{const t=Zi(e,this.tracks);r=this.tracks[t]}}let s=this.findTrackId(r);-1===s&&r&&(s=this.findTrackId(null));const n={subtitleTracks:t};this.log(`Updating subtitle tracks, ${t.length} track(s) found in "${null==i?void 0:i.join(",")}" group-id`),this.hls.trigger(U.SUBTITLE_TRACKS_UPDATED,n),-1!==s&&-1===this.trackId&&this.setSubtitleTrack(s)}else this.shouldReloadPlaylist(r)&&this.setSubtitleTrack(this.trackId)}findTrackId(t){const e=this.tracksInGroup,i=this.selectDefaultTrack;for(let s=0;s<e.length;s++){const r=e[s];if((!i||r.default)&&(i||t)&&(!t||ts(r,t)))return s}if(t){for(let i=0;i<e.length;i++){const s=e[i];if(qr(t.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<e.length;i++){const s=e[i];if(qr(t.attrs,s.attrs,["LANGUAGE"]))return i}}return-1}findTrackForTextTrack(t){if(t){const e=this.tracksInGroup;for(let i=0;i<e.length;i++){if(Xr(e[i],t))return i}}return-1}onError(t,e){!e.fatal&&e.context&&(e.context.type!==Ke||e.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(e.context.groupId)||this.checkRetry(e))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1,this.setSubtitleTrack(t)}setSubtitleOption(t){if(this.hls.config.subtitlePreference=t,t){const e=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,e.length){const i=this.currentTrack;if(i&&ts(t,i))return i;const s=Zi(t,this.tracksInGroup);if(s>-1){const t=this.tracksInGroup[s];return this.setSubtitleTrack(s),t}if(i)return null;{const i=Zi(t,e);if(i>-1)return e[i]}}}return null}loadPlaylist(t){super.loadPlaylist();const e=this.currentTrack;if(this.shouldLoadPlaylist(e)&&e){const i=e.id,s=e.groupId;let r=e.url;if(t)try{r=t.addDirectives(r)}catch(t){this.warn(`Could not construct new URL with HLS Delivery Directives: ${t}`)}this.log(`Loading subtitle playlist for id ${i}`),this.hls.trigger(U.SUBTITLE_TRACK_LOADING,{url:r,id:i,groupId:s,deliveryDirectives:t||null})}}toggleTrackModes(){const{media:t}=this;if(!t)return;const e=ei(t.textTracks),i=this.currentTrack;let s;if(i&&(s=e.filter((t=>Xr(i,t)))[0],s||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(e).forEach((t=>{"disabled"!==t.mode&&t!==s&&(t.mode="disabled")})),s){const t=this.subtitleDisplay?"showing":"hidden";s.mode!==t&&(s.mode=t)}}setSubtitleTrack(t){const e=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=t);if(t<-1||t>=e.length||!O(t))return void this.warn(`Invalid subtitle track id: ${t}`);this.clearTimer(),this.selectDefaultTrack=!1;const i=this.currentTrack,s=e[t]||null;if(this.trackId=t,this.currentTrack=s,this.toggleTrackModes(),!s)return void this.hls.trigger(U.SUBTITLE_TRACK_SWITCH,{id:t});const r=!!s.details&&!s.details.live;if(t===this.trackId&&s===i&&r)return;this.log(`Switching to subtitle-track ${t}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:""));const{id:n,groupId:a="",name:o,type:l,url:h}=s;this.hls.trigger(U.SUBTITLE_TRACK_SWITCH,{id:n,groupId:a,name:o,type:l,url:h});const d=this.switchParams(s.url,null==i?void 0:i.details,s.details);this.loadPlaylist(d)}},timelineController:class{constructor(t){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},t.on(U.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(U.MANIFEST_LOADING,this.onManifestLoading,this),t.on(U.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(U.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(U.FRAG_LOADING,this.onFragLoading,this),t.on(U.FRAG_LOADED,this.onFragLoaded,this),t.on(U.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(U.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(U.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(U.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:t}=this;t.off(U.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(U.MANIFEST_LOADING,this.onManifestLoading,this),t.off(U.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(U.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(U.FRAG_LOADING,this.onFragLoading,this),t.off(U.FRAG_LOADED,this.onFragLoaded,this),t.off(U.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(U.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(U.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(U.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const t=new Sn(this,"textTrack1"),e=new Sn(this,"textTrack2"),i=new Sn(this,"textTrack3"),s=new Sn(this,"textTrack4");this.cea608Parser1=new yn(1,t,e),this.cea608Parser2=new yn(3,i,s)}}addCues(t,e,i,s,r){let n=!1;for(let t=r.length;t--;){const s=r[t],d=(a=s[0],o=s[1],l=e,h=i,Math.min(o,h)-Math.max(a,l));if(d>=0&&(s[0]=Math.min(s[0],e),s[1]=Math.max(s[1],i),n=!0,d/(i-e)>.5))return}var a,o,l,h;if(n||r.push([e,i]),this.config.renderTextTracksNatively){const r=this.captionsTracks[t];this.Cues.newCue(r,e,i,s)}else{const r=this.Cues.newCue(null,e,i,s);this.hls.trigger(U.CUES_PARSED,{type:"captions",cues:r,track:t})}}onInitPtsFound(t,{frag:e,id:i,initPTS:s,timescale:r}){const{unparsedVttFrags:n}=this;"main"===i&&(this.initPTS[e.cc]={baseTime:s,timescale:r}),n.length&&(this.unparsedVttFrags=[],n.forEach((t=>{this.onFragLoaded(U.FRAG_LOADED,t)})))}getExistingTrack(t,e){const{media:i}=this;if(i)for(let s=0;s<i.textTracks.length;s++){const r=i.textTracks[s];if(qn(r,{name:t,lang:e,attrs:{}}))return r}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){if(this.captionsTracks[t])return;const{captionsProperties:e,captionsTracks:i,media:s}=this,{label:r,languageCode:n}=e[t],a=this.getExistingTrack(r,n);if(a)i[t]=a,Ze(i[t]),Qe(i[t],s);else{const e=this.createTextTrack("captions",r,n);e&&(e[t]=!0,i[t]=e)}}createNonNativeTrack(t){if(this.nonNativeCaptionsTracks[t])return;const e=this.captionsProperties[t];if(!e)return;const i={_id:t,label:e.label,kind:"captions",default:!!e.media&&!!e.media.default,closedCaptions:e.media};this.nonNativeCaptionsTracks[t]=i,this.hls.trigger(U.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(t,e,i){const s=this.media;if(s)return s.addTextTrack(t,e,i)}onMediaAttaching(t,e){this.media=e.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:t}=this;Object.keys(t).forEach((e=>{Ze(t[e]),delete t[e]})),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:t}=this;if(!t)return;const e=t.textTracks;if(e)for(let t=0;t<e.length;t++)Ze(e[t])}onSubtitleTracksUpdated(t,e){const i=e.subtitleTracks||[],s=i.some((t=>t.textCodec===Nn));if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(Yr(this.tracks,i))return void(this.tracks=i);if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const t=this.media,e=t?ei(t.textTracks):null;if(this.tracks.forEach(((t,i)=>{let s;if(e){let i=null;for(let s=0;s<e.length;s++)if(e[s]&&qn(e[s],t)){i=e[s],e[s]=null;break}i&&(s=i)}if(s)Ze(s);else{const e=Yn(t);s=this.createTextTrack(e,t.name,t.lang),s&&(s.mode="disabled")}s&&this.textTracks.push(s)})),null!=e&&e.length){const t=e.filter((t=>null!==t)).map((t=>t.label));t.length&&j.warn(`Media element contains unused subtitle tracks: ${t.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const t=this.tracks.map((t=>({label:t.name,kind:t.type.toLowerCase(),default:t.default,subtitleTrack:t})));this.hls.trigger(U.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:t})}}}onManifestLoaded(t,e){this.config.enableCEA708Captions&&e.captions&&e.captions.forEach((t=>{const e=/(?:CC|SERVICE)([1-4])/.exec(t.instreamId);if(!e)return;const i=`textTrack${e[1]}`,s=this.captionsProperties[i];s&&(s.label=t.name,t.lang&&(s.languageCode=t.lang),s.media=t)}))}closedCaptionsForLevel(t){const e=this.hls.levels[t.level];return null==e?void 0:e.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,e){this.initCea608Parsers();const{cea608Parser1:i,cea608Parser2:s,lastCc:r,lastSn:n,lastPartIndex:a}=this;if(this.enabled&&i&&s&&e.frag.type===je){var o,l;const{cc:t,sn:h}=e.frag,d=null!=(o=null==e||null==(l=e.part)?void 0:l.index)?o:-1;h===n+1||h===n&&d===a+1||t===r||(i.reset(),s.reset()),this.lastCc=t,this.lastSn=h,this.lastPartIndex=d}}onFragLoaded(t,e){const{frag:i,payload:s}=e;if(i.type===ze)if(s.byteLength){const t=i.decryptdata,r="stats"in e;if(null==t||!t.encrypted||r){const t=this.tracks[i.level],r=this.vttCCs;r[i.cc]||(r[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),t&&t.textCodec===Nn?this._parseIMSC1(i,s):this._parseVTTs(e)}}else this.hls.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(t,e){const i=this.hls;Gn(e,this.initPTS[t.cc],(e=>{this._appendCues(e,t.level),i.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})}),(e=>{j.log(`Failed to parse IMSC1: ${e}`),i.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:e})}))}_parseVTTs(t){var e;const{frag:i,payload:s}=t,{initPTS:r,unparsedVttFrags:n}=this,a=r.length-1;if(!r[i.cc]&&-1===a)return void n.push(t);const o=this.hls;Fn(null!=(e=i.initSegment)&&e.data?se(i.initSegment.data,new Uint8Array(s)):s,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,(t=>{this._appendCues(t,i.level),o.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})}),(e=>{const r="Missing initPTS for VTT MPEGTS"===e.message;r?n.push(t):this._fallbackToIMSC1(i,s),j.log(`Failed to parse VTT cue: ${e}`),r&&a>i.cc||o.trigger(U.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:e})}))}_fallbackToIMSC1(t,e){const i=this.tracks[t.level];i.textCodec||Gn(e,this.initPTS[t.cc],(()=>{i.textCodec=Nn,this._parseIMSC1(t,e)}),(()=>{i.textCodec="wvtt"}))}_appendCues(t,e){const i=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[e];if(!i||"disabled"===i.mode)return;t.forEach((t=>Je(i,t)))}else{const s=this.tracks[e];if(!s)return;const r=s.default?"default":"subtitles"+e;i.trigger(U.CUES_PARSED,{type:"subtitles",cues:t,track:r})}}onFragDecrypted(t,e){const{frag:i}=e;i.type===ze&&this.onFragLoaded(U.FRAG_LOADED,e)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,e){this.initCea608Parsers();const{cea608Parser1:i,cea608Parser2:s}=this;if(!this.enabled||!i||!s)return;const{frag:r,samples:n}=e;if(r.type!==je||"NONE"!==this.closedCaptionsForLevel(r))for(let t=0;t<n.length;t++){const e=n[t].bytes;if(e){const r=this.extractCea608Data(e);i.addData(n[t].pts,r[0]),s.addData(n[t].pts,r[1])}}}onBufferFlushing(t,{startOffset:e,endOffset:i,endOffsetSubtitles:s,type:r}){const{media:n}=this;if(n&&!(n.currentTime<i)){if(!r||"video"===r){const{captionsTracks:t}=this;Object.keys(t).forEach((s=>ti(t[s],e,i)))}if(this.config.renderTextTracksNatively&&0===e&&void 0!==s){const{textTracks:t}=this;Object.keys(t).forEach((i=>ti(t[i],e,s)))}}}extractCea608Data(t){const e=[[],[]],i=31&t[0];let s=2;for(let r=0;r<i;r++){const i=t[s++],r=127&t[s++],n=127&t[s++];if(0===r&&0===n)continue;if(!!(4&i)){const t=3&i;0!==t&&1!==t||(e[t].push(r),e[t].push(n))}}return e}},audioStreamController:class extends Gs{constructor(t,e,i){super(t,e,i,"[audio-stream-controller]",We),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:t}=this;t.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(U.MANIFEST_LOADING,this.onManifestLoading,this),t.on(U.LEVEL_LOADED,this.onLevelLoaded,this),t.on(U.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(U.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(U.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(U.ERROR,this.onError,this),t.on(U.BUFFER_RESET,this.onBufferReset,this),t.on(U.BUFFER_CREATED,this.onBufferCreated,this),t.on(U.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(U.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(U.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(U.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(U.MANIFEST_LOADING,this.onManifestLoading,this),t.off(U.LEVEL_LOADED,this.onLevelLoaded,this),t.off(U.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(U.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(U.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(U.ERROR,this.onError,this),t.off(U.BUFFER_RESET,this.onBufferReset,this),t.off(U.BUFFER_CREATED,this.onBufferCreated,this),t.off(U.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(U.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(U.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(U.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(t,{frag:e,id:i,initPTS:s,timescale:r}){if("main"===i){const t=e.cc;this.initPTS[e.cc]={baseTime:s,timescale:r},this.log(`InitPTS for cc: ${t} found from main: ${s}`),this.videoTrackCC=t,this.state===$s&&this.tick()}}startLoad(t){if(!this.levels)return this.startPosition=t,void(this.state=Is);const e=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),e>0&&-1===t?(this.log(`Override startPosition with lastCurrentTime @${e.toFixed(3)}`),t=e,this.state=Ds):(this.loadedmetadata=!1,this.state=Ms),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}doTick(){switch(this.state){case Ds:this.doTickIdle();break;case Ms:{var t;const{levels:e,trackId:i}=this,s=null==e||null==(t=e[i])?void 0:t.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state=$s}break}case xs:{var e;const t=performance.now(),i=this.retryDate;if(!i||t>=i||null!=(e=this.media)&&e.seeking){const{levels:t,trackId:e}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((null==t?void 0:t[e])||null),this.state=Ds}break}case $s:{const t=this.waitingData;if(t){const{frag:e,part:i,cache:s,complete:r}=t;if(void 0!==this.initPTS[e.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=Ps;const t={frag:e,part:i,payload:s.flush(),networkDetails:null};this._handleFragmentLoadProgress(t),r&&super._handleFragmentLoadComplete(t)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${e.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const t=this.getLoadPosition(),i=us.bufferInfo(this.mediaBuffer,t,this.config.maxBufferHole);Oi(i.end,this.config.maxFragLookUpTolerance,e)<0&&(this.log(`Waiting fragment cc (${e.cc}) @ ${e.start} cancelled because another fragment at ${i.end} is needed`),this.clearWaitingFragment())}}else this.state=Ds}}this.onTickEnd()}clearWaitingFragment(){const t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Ds)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:t}=this;null!=t&&t.readyState&&(this.lastCurrentTime=t.currentTime)}doTickIdle(){const{hls:t,levels:e,media:i,trackId:s}=this,r=t.config;if(!i&&(this.startFragRequested||!r.startFragPrefetch)||null==e||!e[s])return;const n=e[s],a=n.details;if(!a||a.live&&this.levelLastLoaded!==n||this.waitForCdnTuneIn(a))return void(this.state=Ms);const o=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&o&&(this.bufferFlushed=!1,this.afterBufferFlushed(o,J,We));const l=this.getFwdBufferInfo(o,We);if(null===l)return;const{bufferedTrack:h,switchingTrack:d}=this;if(!d&&this._streamEnded(l,a))return t.trigger(U.BUFFER_EOS,{type:"audio"}),void(this.state=Ns);const c=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,je),u=l.len,f=this.getMaxBufferLength(null==c?void 0:c.len),g=a.fragments,m=g[0].start;let p=this.flushing?this.getLoadPosition():l.end;if(d&&i){const t=this.getLoadPosition();h&&!qr(d.attrs,h.attrs)&&(p=t),a.PTSKnown&&t<m&&(l.end>m||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=m+.05)}if(u>=f&&!d&&p<g[g.length-1].start)return;let v=this.getNextFragment(p,a),y=!1;if(v&&this.isLoopLoading(v,p)&&(y=!!v.gap,v=this.getNextFragmentLoopLoading(v,a,l,je,f)),!v)return void(this.bufferFlushed=!0);const E=c&&v.start>c.end+a.targetduration;if(E||(null==c||!c.len)&&l.len){const t=this.getAppendedFrag(v.start,je);if(null===t)return;if(y||(y=!!t.gap||!!E&&0===c.len),E&&!y||y&&l.nextStart&&l.nextStart<t.end)return}this.loadFragment(v,n,p)}getMaxBufferLength(t){const e=super.getMaxBufferLength();return t?Math.min(Math.max(e,t),this.config.maxMaxBufferLength):e}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(t,{audioTracks:e}){this.resetTransmuxer(),this.levels=e.map((t=>new yi(t)))}onAudioTrackSwitching(t,e){const i=!!e.url;this.trackId=e.id;const{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),i?this.setInterval(100):this.resetTransmuxer(),i?(this.switchingTrack=e,this.state=Ds,this.flushAudioIfNeeded(e)):(this.switchingTrack=null,this.bufferedTrack=e,this.state=Is),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(t,e){this.mainDetails=e.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(U.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(t,e){var i;if(null==this.mainDetails)return void(this.cachedTrackLoadedData=e);const{levels:s}=this,{details:r,id:n}=e;if(!s)return void this.warn(`Audio tracks were reset while loading level ${n}`);this.log(`Audio track ${n} loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const a=s[n];let o=0;if(r.live||null!=(i=a.details)&&i.live){this.checkLiveUpdate(r);const t=this.mainDetails;if(r.deltaUpdateFailed||!t)return;var l;if(!a.details&&r.hasProgramDateTime&&t.hasProgramDateTime)ys(r,t),o=r.fragments[0].start;else o=this.alignPlaylists(r,a.details,null==(l=this.levelLastLoaded)?void 0:l.details)}a.details=r,this.levelLastLoaded=a,this.startFragRequested||!this.mainDetails&&r.live||this.setStartPosition(this.mainDetails||r,o),this.state!==Ms||this.waitForCdnTuneIn(r)||(this.state=Ds),this.tick()}_handleFragmentLoadProgress(t){var e;const{frag:i,part:s,payload:r}=t,{config:n,trackId:a,levels:o}=this;if(!o)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);const l=o[a];if(!l)return void this.warn("Audio track is undefined on fragment load progress");const h=l.details;if(!h)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(i.start);const d=n.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let c=this.transmuxer;c||(c=this.transmuxer=new zr(this.hls,We,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const u=this.initPTS[i.cc],f=null==(e=i.initSegment)?void 0:e.data;if(void 0!==u){const t=!1,e=s?s.index:-1,n=-1!==e,a=new fs(i.level,i.sn,i.stats.chunkCount,r.byteLength,e,n);c.push(r,f,d,"",i,s,h.totalduration,t,a,u)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${h.startSN} ,${h.endSN}],track ${a}`);const{cache:t}=this.waitingData=this.waitingData||{frag:i,part:s,cache:new Hs,complete:!1};t.push(new Uint8Array(r)),this.waitingVideoCC=this.videoTrackCC,this.state=$s}}_handleFragmentLoadComplete(t){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(t,e){const i=e.tracks.audio;i&&(this.mediaBuffer=i.buffer||null),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer||null)}onFragBuffered(t,e){const{frag:i,part:s}=e;if(i.type===We)if(this.fragContextChanged(i))this.warn(`Fragment ${i.sn}${s?" p: "+s.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if("initSegment"!==i.sn){this.fragPrevious=i;const t=this.switchingTrack;t&&(this.bufferedTrack=t,this.switchingTrack=null,this.hls.trigger(U.AUDIO_TRACK_SWITCHED,w({},t)))}this.fragBufferedComplete(i,s)}else if(!this.loadedmetadata&&i.type===je){const t=this.videoBuffer||this.media;if(t){us.getBuffered(t).length&&(this.loadedmetadata=!0)}}}onError(t,e){var i;if(e.fatal)this.state=Us;else switch(e.details){case B.FRAG_GAP:case B.FRAG_PARSING_ERROR:case B.FRAG_DECRYPT_ERROR:case B.FRAG_LOAD_ERROR:case B.FRAG_LOAD_TIMEOUT:case B.KEY_LOAD_ERROR:case B.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(We,e);break;case B.AUDIO_TRACK_LOAD_ERROR:case B.AUDIO_TRACK_LOAD_TIMEOUT:case B.LEVEL_PARSING_ERROR:e.levelRetry||this.state!==Ms||(null==(i=e.context)?void 0:i.type)!==Ve||(this.state=Ds);break;case B.BUFFER_APPEND_ERROR:case B.BUFFER_FULL_ERROR:if(!e.parent||"audio"!==e.parent)return;if(e.details===B.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(e)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case B.INTERNAL_EXCEPTION:this.recoverWorkerError(e)}}onBufferFlushing(t,{type:e}){e!==Z&&(this.flushing=!0)}onBufferFlushed(t,{type:e}){if(e!==Z){this.flushing=!1,this.bufferFlushed=!0,this.state===Ns&&(this.state=Ds);const t=this.mediaBuffer||this.media;t&&(this.afterBufferFlushed(t,e,We),this.tick())}}_handleTransmuxComplete(t){var e;const i="audio",{hls:s}=this,{remuxResult:r,chunkMeta:n}=t,a=this.getCurrentContext(n);if(!a)return void this.resetWhenMissingContext(n);const{frag:o,part:l,level:h}=a,{details:d}=h,{audio:c,text:u,id3:f,initSegment:g}=r;if(!this.fragContextChanged(o)&&d){if(this.state=Os,this.switchingTrack&&c&&this.completeAudioSwitch(this.switchingTrack),null!=g&&g.tracks){const t=o.initSegment||o;this._bufferInitSegment(h,g.tracks,t,n),s.trigger(U.FRAG_PARSING_INIT_SEGMENT,{frag:t,id:i,tracks:g.tracks})}if(c){const{startPTS:t,endPTS:e,startDTS:i,endDTS:s}=c;l&&(l.elementaryStreams[J]={startPTS:t,endPTS:e,startDTS:i,endDTS:s}),o.setElementaryStreamInfo(J,t,e,i,s),this.bufferFragmentData(c,o,l,n)}if(null!=f&&null!=(e=f.samples)&&e.length){const t=M({id:i,frag:o,details:d},f);s.trigger(U.FRAG_PARSING_METADATA,t)}if(u){const t=M({id:i,frag:o,details:d},u);s.trigger(U.FRAG_PARSING_USERDATA,t)}}else this.fragmentTracker.removeFragment(o)}_bufferInitSegment(t,e,i,s){if(this.state!==Os)return;e.video&&delete e.video;const r=e.audio;if(!r)return;r.id="audio";const n=t.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${n}/${r.codec}]`),n&&1===n.split(",").length&&(r.levelCodec=n),this.hls.trigger(U.BUFFER_CODECS,e);const a=r.initSegment;if(null!=a&&a.byteLength){const t={type:"audio",frag:i,part:null,chunkMeta:s,parent:i.type,data:a};this.hls.trigger(U.BUFFER_APPENDING,t)}this.tickImmediate()}loadFragment(t,e,i){const s=this.fragmentTracker.getState(t);var r;if(this.fragCurrent=t,this.switchingTrack||s===rs||s===as)if("initSegment"===t.sn)this._loadInitSegment(t,e);else if(null!=(r=e.details)&&r.live&&!this.initPTS[t.cc]){this.log(`Waiting for video PTS in continuity counter ${t.cc} of live stream before loading audio fragment ${t.sn} of level ${this.trackId}`),this.state=$s;const i=this.mainDetails;i&&i.fragments[0].start!==e.details.fragments[0].start&&ys(e.details,i)}else this.startFragRequested=!0,super.loadFragment(t,e,i);else this.clearTrackerIfNeeded(t)}flushAudioIfNeeded(t){const{media:e,bufferedTrack:i}=this,s=null==i?void 0:i.attrs,r=t.attrs;e&&s&&(s.CHANNELS!==r.CHANNELS||i.name!==t.name||i.lang!==t.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(t){const{hls:e}=this;this.flushAudioIfNeeded(t),this.bufferedTrack=t,this.switchingTrack=null,e.trigger(U.AUDIO_TRACK_SWITCHED,w({},t))}},audioTrackController:class extends Ki{constructor(t){super(t,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(U.MANIFEST_LOADING,this.onManifestLoading,this),t.on(U.MANIFEST_PARSED,this.onManifestParsed,this),t.on(U.LEVEL_LOADING,this.onLevelLoading,this),t.on(U.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(U.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(U.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(U.MANIFEST_LOADING,this.onManifestLoading,this),t.off(U.MANIFEST_PARSED,this.onManifestParsed,this),t.off(U.LEVEL_LOADING,this.onLevelLoading,this),t.off(U.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(U.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(U.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.audioTracks||[]}onAudioTrackLoaded(t,e){const{id:i,groupId:s,details:r}=e,n=this.tracksInGroup[i];if(!n||n.groupId!==s)return void this.warn(`Audio track with id:${i} and group:${s} not found in active group ${null==n?void 0:n.groupId}`);const a=n.details;n.details=e.details,this.log(`Audio track ${i} "${n.name}" lang:${n.lang} group:${s} loaded [${r.startSN}-${r.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,a)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const i=e.audioGroups||null,s=this.groupIds;let r=this.currentTrack;if(!i||(null==s?void 0:s.length)!==(null==i?void 0:i.length)||null!=i&&i.some((t=>-1===(null==s?void 0:s.indexOf(t))))){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const t=this.tracks.filter((t=>!i||-1!==i.indexOf(t.groupId)));if(t.length)this.selectDefaultTrack&&!t.some((t=>t.default))&&(this.selectDefaultTrack=!1),t.forEach(((t,e)=>{t.id=e}));else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=t;const e=this.hls.config.audioPreference;if(!r&&e){const i=Zi(e,t,es);if(i>-1)r=t[i];else{const t=Zi(e,this.tracks);r=this.tracks[t]}}let s=this.findTrackId(r);-1===s&&r&&(s=this.findTrackId(null));const a={audioTracks:t};this.log(`Updating audio tracks, ${t.length} track(s) found in group(s): ${null==i?void 0:i.join(",")}`),this.hls.trigger(U.AUDIO_TRACKS_UPDATED,a);const o=this.trackId;if(-1!==s&&-1===o)this.setAudioTrack(s);else if(t.length&&-1===o){var n;const e=new Error(`No audio track selected for current audio group-ID(s): ${null==(n=this.groupIds)?void 0:n.join(",")} track count: ${t.length}`);this.warn(e.message),this.hls.trigger(U.ERROR,{type:$.MEDIA_ERROR,details:B.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:e})}}else this.shouldReloadPlaylist(r)&&this.setAudioTrack(this.trackId)}onError(t,e){!e.fatal&&e.context&&(e.context.type!==Ve||e.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(e.context.groupId)||(this.requestScheduled=-1,this.checkRetry(e)))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioOption(t){const e=this.hls;if(e.config.audioPreference=t,t){const i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){const s=this.currentTrack;if(s&&ts(t,s,es))return s;const r=Zi(t,this.tracksInGroup,es);if(r>-1){const t=this.tracksInGroup[r];return this.setAudioTrack(r),t}if(s){let s=e.loadLevel;-1===s&&(s=e.firstAutoLevel);const r=function(t,e,i,s,r){const n=e[s],a=e.reduce(((t,e,i)=>{const s=e.uri;return(t[s]||(t[s]=[])).push(i),t}),{})[n.uri];a.length>1&&(s=Math.max.apply(Math,a));const o=n.videoRange,l=n.frameRate,h=n.codecSet.substring(0,4),d=is(e,s,(e=>{if(e.videoRange!==o||e.frameRate!==l||e.codecSet.substring(0,4)!==h)return!1;const s=e.audioGroups,n=i.filter((t=>!s||-1!==s.indexOf(t.groupId)));return Zi(t,n,r)>-1}));return d>-1?d:is(e,s,(e=>{const s=e.audioGroups,n=i.filter((t=>!s||-1!==s.indexOf(t.groupId)));return Zi(t,n,r)>-1}))}(t,e.levels,i,s,es);if(-1===r)return null;e.nextLoadLevel=r}if(t.channels||t.audioCodec){const e=Zi(t,i);if(e>-1)return i[e]}}}return null}setAudioTrack(t){const e=this.tracksInGroup;if(t<0||t>=e.length)return void this.warn(`Invalid audio track id: ${t}`);this.clearTimer(),this.selectDefaultTrack=!1;const i=this.currentTrack,s=e[t],r=s.details&&!s.details.live;if(t===this.trackId&&s===i&&r)return;if(this.log(`Switching to audio-track ${t} "${s.name}" lang:${s.lang} group:${s.groupId} channels:${s.channels}`),this.trackId=t,this.currentTrack=s,this.hls.trigger(U.AUDIO_TRACK_SWITCHING,w({},s)),r)return;const n=this.switchParams(s.url,null==i?void 0:i.details,s.details);this.loadPlaylist(n)}findTrackId(t){const e=this.tracksInGroup;for(let i=0;i<e.length;i++){const s=e[i];if((!this.selectDefaultTrack||s.default)&&(!t||ts(t,s,es)))return i}if(t){const{name:i,lang:s,assocLang:r,characteristics:n,audioCodec:a,channels:o}=t;for(let t=0;t<e.length;t++){if(ts({name:i,lang:s,assocLang:r,characteristics:n,audioCodec:a,channels:o},e[t],es))return t}for(let i=0;i<e.length;i++){const s=e[i];if(qr(t.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<e.length;i++){const s=e[i];if(qr(t.attrs,s.attrs,["LANGUAGE"]))return i}}return-1}loadPlaylist(t){const e=this.currentTrack;if(this.shouldLoadPlaylist(e)&&e){super.loadPlaylist();const i=e.id,s=e.groupId;let r=e.url;if(t)try{r=t.addDirectives(r)}catch(t){this.warn(`Could not construct new URL with HLS Delivery Directives: ${t}`)}this.log(`loading audio-track playlist ${i} "${e.name}" lang:${e.lang} group:${s}`),this.clearTimer(),this.hls.trigger(U.AUDIO_TRACK_LOADING,{url:r,id:i,groupId:s,deliveryDirectives:t||null})}}},emeController:Jn,cmcdController:class{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=t=>{try{this.apply(t,{ot:ta.MANIFEST,su:!this.initialized})}catch(t){j.warn("Could not generate manifest CMCD data.",t)}},this.applyFragmentData=t=>{try{const e=t.frag,i=this.hls.levels[e.level],s=this.getObjectType(e),r={d:1e3*e.duration,ot:s};s!==ta.VIDEO&&s!==ta.AUDIO&&s!=ta.MUXED||(r.br=i.bitrate/1e3,r.tb=this.getTopBandwidth(s)/1e3,r.bl=this.getBufferLength(s)),this.apply(t,r)}catch(t){j.warn("Could not generate segment CMCD data.",t)}},this.hls=t;const e=this.config=t.config,{cmcd:i}=e;null!=i&&(e.pLoader=this.createPlaylistLoader(),e.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||function(){try{return crypto.randomUUID()}catch(t){try{const t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.slice(e.lastIndexOf("/")+1)}catch(t){let e=(new Date).getTime();return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?i:3&i|8).toString(16)}));}}}(),this.cid=i.contentId,this.useHeaders=!0===i.useHeaders,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){const t=this.hls;t.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(U.MEDIA_DETACHED,this.onMediaDetached,this),t.on(U.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const t=this.hls;t.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(U.MEDIA_DETACHED,this.onMediaDetached,this),t.off(U.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,e){var i,s;this.audioBuffer=null==(i=e.tracks.audio)?void 0:i.buffer,this.videoBuffer=null==(s=e.tracks.video)?void 0:s.buffer}createData(){var t;return{v:1,sf:ea.HLS,sid:this.sid,cid:this.cid,pr:null==(t=this.media)?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t,e={}){M(e,this.createData());const i=e.ot===ta.INIT||e.ot===ta.VIDEO||e.ot===ta.MUXED;this.starved&&i&&(e.bs=!0,e.su=!0,this.starved=!1),null==e.su&&(e.su=this.buffering);const{includeKeys:s}=this;s&&(e=Object.keys(e).reduce(((t,i)=>(s.includes(i)&&(t[i]=e[i]),t)),{})),this.useHeaders?(t.headers||(t.headers={}),Ra(t.headers,e)):t.url=Ca(t.url,e)}getObjectType(t){const{type:e}=t;return"subtitle"===e?ta.TIMED_TEXT:"initSegment"===t.sn?ta.INIT:"audio"===e?ta.AUDIO:"main"===e?this.hls.audioTracks.length?ta.VIDEO:ta.MUXED:void 0}getTopBandwidth(t){let e,i=0;const s=this.hls;if(t===ta.AUDIO)e=s.audioTracks;else{const t=s.maxAutoLevel,i=t>-1?t+1:s.levels.length;e=s.levels.slice(0,i)}for(const t of e)t.bitrate>i&&(i=t.bitrate);return i>0?i:NaN}getBufferLength(t){const e=this.hls.media,i=t===ta.AUDIO?this.audioBuffer:this.videoBuffer;if(!i||!e)return NaN;return 1e3*us.bufferInfo(i,e.currentTime,this.config.maxBufferHole).len}createPlaylistLoader(){const{pLoader:t}=this.config,e=this.applyPlaylistData,i=t||this.config.loader;return class{constructor(t){this.loader=void 0,this.loader=new i(t)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(t,i,s){e(t),this.loader.load(t,i,s)}}}createFragmentLoader(){const{fLoader:t}=this.config,e=this.applyFragmentData,i=t||this.config.loader;return class{constructor(t){this.loader=void 0,this.loader=new i(t)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(t,i,s){e(t),this.loader.load(t,i,s)}}}},contentSteeringController:class{constructor(t){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.log=j.log.bind(j,"[content-steering]:"),this.registerListeners()}registerListeners(){const t=this.hls;t.on(U.MANIFEST_LOADING,this.onManifestLoading,this),t.on(U.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(U.MANIFEST_PARSED,this.onManifestParsed,this),t.on(U.ERROR,this.onError,this)}unregisterListeners(){const t=this.hls;t&&(t.off(U.MANIFEST_LOADING,this.onManifestLoading,this),t.off(U.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(U.MANIFEST_PARSED,this.onManifestParsed,this),t.off(U.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const t=1e3*this.timeToLoad-(performance.now()-this.updated);if(t>0)return void this.scheduleRefresh(this.uri,t)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(t){const e=this.levels;e&&(this.levels=e.filter((e=>e!==t)))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,e){const{contentSteering:i}=e;null!==i&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(t,e){this.audioTracks=e.audioTracks,this.subtitleTracks=e.subtitleTracks}onError(t,e){const{errorAction:i}=e;if((null==i?void 0:i.action)===Ui&&i.flags===Hi){const t=this.levels;let s=this.pathwayPriority,r=this.pathwayId;if(e.context){const{groupId:i,pathwayId:s,type:n}=e.context;i&&t?r=this.getPathwayForGroupId(i,n,r):s&&(r=s)}r in this.penalizedPathways||(this.penalizedPathways[r]=performance.now()),!s&&t&&(s=t.reduce(((t,e)=>(-1===t.indexOf(e.pathwayId)&&t.push(e.pathwayId),t)),[])),s&&s.length>1&&(this.updatePathwayPriority(s),i.resolved=this.pathwayId!==r),i.resolved||j.warn(`Could not resolve ${e.details} ("${e.error.message}") with content-steering for Pathway: ${r} levels: ${t?t.length:t} priorities: ${JSON.stringify(s)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(t){this.levels=t;let e=this.getLevelsForPathway(this.pathwayId);if(0===e.length){const i=t[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),e=this.getLevelsForPathway(i),this.pathwayId=i}return e.length!==t.length?(this.log(`Found ${e.length}/${t.length} levels in Pathway "${this.pathwayId}"`),e):t}getLevelsForPathway(t){return null===this.levels?[]:this.levels.filter((e=>t===e.pathwayId))}updatePathwayPriority(t){let e;this.pathwayPriority=t;const i=this.penalizedPathways,s=performance.now();Object.keys(i).forEach((t=>{s-i[t]>3e5&&delete i[t]}));for(let s=0;s<t.length;s++){const r=t[s];if(r in i)continue;if(r===this.pathwayId)return;const n=this.hls.nextLoadLevel,a=this.hls.levels[n];if(e=this.getLevelsForPathway(r),e.length>0){this.log(`Setting Pathway to "${r}"`),this.pathwayId=r,Ci(e),this.hls.trigger(U.LEVELS_UPDATED,{levels:e});const t=this.hls.levels[n];a&&t&&this.levels&&(t.attrs["STABLE-VARIANT-ID"]!==a.attrs["STABLE-VARIANT-ID"]&&t.bitrate!==a.bitrate&&this.log(`Unstable Pathways change from bitrate ${a.bitrate} to ${t.bitrate}`),this.hls.nextLoadLevel=n);break}}}getPathwayForGroupId(t,e,i){const s=this.getLevelsForPathway(i).concat(this.levels||[]);for(let i=0;i<s.length;i++)if(e===Ve&&s[i].hasAudioGroup(t)||e===Ke&&s[i].hasSubtitleGroup(t))return s[i].pathwayId;return i}clonePathways(t){const e=this.levels;if(!e)return;const i={},s={};t.forEach((t=>{const{ID:r,"BASE-ID":n,"URI-REPLACEMENT":a}=t;if(e.some((t=>t.pathwayId===r)))return;const o=this.getLevelsForPathway(n).map((t=>{const e=new Y(t.attrs);e["PATHWAY-ID"]=r;const n=e.AUDIO&&`${e.AUDIO}_clone_${r}`,o=e.SUBTITLES&&`${e.SUBTITLES}_clone_${r}`;n&&(i[e.AUDIO]=n,e.AUDIO=n),o&&(s[e.SUBTITLES]=o,e.SUBTITLES=o);const l=Ia(t.uri,e["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a),h=new yi({attrs:e,audioCodec:t.audioCodec,bitrate:t.bitrate,height:t.height,name:t.name,url:l,videoCodec:t.videoCodec,width:t.width});if(t.audioGroups)for(let e=1;e<t.audioGroups.length;e++)h.addGroupId("audio",`${t.audioGroups[e]}_clone_${r}`);if(t.subtitleGroups)for(let e=1;e<t.subtitleGroups.length;e++)h.addGroupId("text",`${t.subtitleGroups[e]}_clone_${r}`);return h}));e.push(...o),_a(this.audioTracks,i,a,r),_a(this.subtitleTracks,s,a,r)}))}loadSteeringManifest(t){const e=this.hls.config,i=e.loader;let s;this.loader&&this.loader.destroy(),this.loader=new i(e);try{s=new self.URL(t)}catch(e){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${t}`)}if("data:"!==s.protocol){const t=0|(this.hls.bandwidthEstimate||e.abrEwmaDefaultEstimate);s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+t)}const r={responseType:"json",url:s.href},n=e.steeringManifestLoadPolicy.default,a=n.errorRetry||n.timeoutRetry||{},o={loadPolicy:n,timeout:n.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(t,e,i,r)=>{this.log(`Loaded steering manifest: "${s}"`);const n=t.data;if(1!==n.VERSION)return void this.log(`Steering VERSION ${n.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=n.TTL;const{"RELOAD-URI":a,"PATHWAY-CLONES":o,"PATHWAY-PRIORITY":l}=n;if(a)try{this.uri=new self.URL(a,s).href}catch(t){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${a}`)}this.scheduleRefresh(this.uri||i.url),o&&this.clonePathways(o);const h={steeringManifest:n,url:s.toString()};this.hls.trigger(U.STEERING_MANIFEST_LOADED,h),l&&this.updatePathwayPriority(l)},onError:(t,e,i,s)=>{if(this.log(`Error loading steering manifest: ${t.code} ${t.text} (${e.url})`),this.stopLoad(),410===t.code)return this.enabled=!1,void this.log(`Steering manifest ${e.url} no longer available`);let r=1e3*this.timeToLoad;if(429!==t.code)this.scheduleRefresh(this.uri||e.url,r);else{const t=this.loader;if("function"==typeof(null==t?void 0:t.getResponseHeader)){const e=t.getResponseHeader("Retry-After");e&&(r=1e3*parseFloat(e))}this.log(`Steering manifest ${e.url} rate limited`)}},onTimeout:(t,e,i)=>{this.log(`Timeout loading steering manifest (${e.url})`),this.scheduleRefresh(this.uri||e.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(r,o,l)}scheduleRefresh(t,e=1e3*this.timeToLoad){this.clearTimeout(),this.reloadTimer=self.setTimeout((()=>{var e;const i=null==(e=this.hls)?void 0:e.media;!i||i.ended?this.scheduleRefresh(t,1e3*this.timeToLoad):this.loadSteeringManifest(t)}),e)}}});function $a(t){return t&&"object"==typeof t?Array.isArray(t)?t.map($a):Object.keys(t).reduce(((e,i)=>(e[i]=$a(t[i]),e)),{}):t}function Ba(t){const e=t.loader;if(e!==xa&&e!==wa)j.log("[config]: Custom loader detected, cannot enable progressive streaming"),t.progressive=!1;else{(function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(t){}return!1})()&&(t.loader=xa,t.progressive=!0,t.enableSoftwareAES=!0,j.log("[config]: Progressive streaming enabled, using FetchLoader"))}}let Ga;class Ha extends Ki{constructor(t,e){super(t,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=e,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(U.MANIFEST_LOADING,this.onManifestLoading,this),t.on(U.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(U.LEVEL_LOADED,this.onLevelLoaded,this),t.on(U.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(U.FRAG_BUFFERED,this.onFragBuffered,this),t.on(U.ERROR,this.onError,this)}_unregisterListeners(){const{hls:t}=this;t.off(U.MANIFEST_LOADING,this.onManifestLoading,this),t.off(U.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(U.LEVEL_LOADED,this.onLevelLoaded,this),t.off(U.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(U.FRAG_BUFFERED,this.onFragBuffered,this),t.off(U.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach((t=>{t.loadError=0,t.fragmentError=0})),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(t,e){this.resetLevels()}onManifestLoaded(t,e){const i=this.hls.config.preferManagedMediaSource,s=[],r={},n={};let a=!1,o=!1,l=!1;e.levels.forEach((t=>{var e,h;const d=t.attrs;let{audioCodec:c,videoCodec:u}=t;-1!==(null==(e=c)?void 0:e.indexOf("mp4a.40.34"))&&(Ga||(Ga=/chrome|firefox/i.test(navigator.userAgent)),Ga&&(t.audioCodec=c=void 0)),c&&(t.audioCodec=c=ke(c,i)),0===(null==(h=u)?void 0:h.indexOf("avc1"))&&(u=t.videoCodec=function(t){const e=t.split(".");if(e.length>2){let t=e.shift()+".";return t+=parseInt(e.shift()).toString(16),t+=("000"+parseInt(e.shift()).toString(16)).slice(-4),t}return t}(u));const{width:f,height:g,unknownCodecs:m}=t;if(a||(a=!(!f||!g)),o||(o=!!u),l||(l=!!c),null!=m&&m.length||c&&!Ee(c,"audio",i)||u&&!Ee(u,"video",i))return;const{CODECS:p,"FRAME-RATE":v,"HDCP-LEVEL":y,"PATHWAY-ID":E,RESOLUTION:T,"VIDEO-RANGE":S}=d,b=`${`${E||"."}-`}${t.bitrate}-${T}-${v}-${p}-${S}-${y}`;if(r[b])if(r[b].uri===t.url||t.attrs["PATHWAY-ID"])r[b].addGroupId("audio",d.AUDIO),r[b].addGroupId("text",d.SUBTITLES);else{const e=n[b]+=1;t.attrs["PATHWAY-ID"]=new Array(e+1).join(".");const i=new yi(t);r[b]=i,s.push(i)}else{const e=new yi(t);r[b]=e,n[b]=1,s.push(e)}})),this.filterAndSortMediaOptions(s,e,a,o,l)}filterAndSortMediaOptions(t,e,i,s,r){let n=[],a=[],o=t;if((i||s)&&r&&(o=o.filter((({videoCodec:t,videoRange:e,width:i,height:s})=>{return(!!t||!(!i||!s))&&(!!(r=e)&&ui.indexOf(r)>-1);var r}))),0===o.length)return void Promise.resolve().then((()=>{if(this.hls){e.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(e.levels[0].attrs)}`);const t=new Error("no level with compatible codecs found in manifest");this.hls.trigger(U.ERROR,{type:$.MEDIA_ERROR,details:B.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:e.url,error:t,reason:t.message})}}));if(e.audioTracks){const{preferManagedMediaSource:t}=this.hls.config;n=e.audioTracks.filter((e=>!e.audioCodec||Ee(e.audioCodec,"audio",t))),Va(n)}e.subtitles&&(a=e.subtitles,Va(a));const l=o.slice(0);o.sort(((t,e)=>{if(t.attrs["HDCP-LEVEL"]!==e.attrs["HDCP-LEVEL"])return(t.attrs["HDCP-LEVEL"]||"")>(e.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&t.height!==e.height)return t.height-e.height;if(t.frameRate!==e.frameRate)return t.frameRate-e.frameRate;if(t.videoRange!==e.videoRange)return ui.indexOf(t.videoRange)-ui.indexOf(e.videoRange);if(t.videoCodec!==e.videoCodec){const i=be(t.videoCodec),s=be(e.videoCodec);if(i!==s)return s-i}if(t.uri===e.uri&&t.codecSet!==e.codecSet){const i=Le(t.codecSet),s=Le(e.codecSet);if(i!==s)return s-i}return t.averageBitrate!==e.averageBitrate?t.averageBitrate-e.averageBitrate:0}));let h=l[0];if(this.steering&&(o=this.steering.filterParsedLevels(o),o.length!==l.length))for(let t=0;t<l.length;t++)if(l[t].pathwayId===o[0].pathwayId){h=l[t];break}this._levels=o;for(let t=0;t<o.length;t++)if(o[t]===h){var d;this._firstLevel=t;const e=h.bitrate,i=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${o.length} level(s) found, first bitrate: ${e}`),void 0===(null==(d=this.hls.userConfig)?void 0:d.abrEwmaDefaultEstimate)){const t=Math.min(e,this.hls.config.abrEwmaDefaultEstimateMax);t>i&&i===Ua.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=t)}break}const c=r&&!s,u={levels:o,audioTracks:n,subtitleTracks:a,sessionData:e.sessionData,sessionKeys:e.sessionKeys,firstLevel:this._firstLevel,stats:e.stats,audio:r,video:s,altAudio:!c&&n.some((t=>!!t.url))};this.hls.trigger(U.MANIFEST_PARSED,u),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(t){const e=this._levels;if(0===e.length)return;if(t<0||t>=e.length){const i=new Error("invalid level idx"),s=t<0;if(this.hls.trigger(U.ERROR,{type:$.OTHER_ERROR,details:B.LEVEL_SWITCH_ERROR,level:t,fatal:s,error:i,reason:i.message}),s)return;t=Math.min(t,e.length-1)}const i=this.currentLevelIndex,s=this.currentLevel,r=s?s.attrs["PATHWAY-ID"]:void 0,n=e[t],a=n.attrs["PATHWAY-ID"];if(this.currentLevelIndex=t,this.currentLevel=n,i===t&&n.details&&s&&r===a)return;this.log(`Switching to level ${t} (${n.height?n.height+"p ":""}${n.videoRange?n.videoRange+" ":""}${n.codecSet?n.codecSet+" ":""}@${n.bitrate})${a?" with Pathway "+a:""} from level ${i}${r?" with Pathway "+r:""}`);const o={level:t,attrs:n.attrs,details:n.details,bitrate:n.bitrate,averageBitrate:n.averageBitrate,maxBitrate:n.maxBitrate,realBitrate:n.realBitrate,width:n.width,height:n.height,codecSet:n.codecSet,audioCodec:n.audioCodec,videoCodec:n.videoCodec,audioGroups:n.audioGroups,subtitleGroups:n.subtitleGroups,loaded:n.loaded,loadError:n.loadError,fragmentError:n.fragmentError,name:n.name,id:n.id,uri:n.uri,url:n.url,urlId:0,audioGroupIds:n.audioGroupIds,textGroupIds:n.textGroupIds};this.hls.trigger(U.LEVEL_SWITCHING,o);const l=n.details;if(!l||l.live){const t=this.switchParams(n.uri,null==s?void 0:s.details,l);this.loadPlaylist(t)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){if(void 0===this._startLevel){const t=this.hls.config.startLevel;return void 0!==t?t:this.hls.firstAutoLevel}return this._startLevel}set startLevel(t){this._startLevel=t}onError(t,e){!e.fatal&&e.context&&e.context.type===He&&e.context.level===this.level&&this.checkRetry(e)}onFragBuffered(t,{frag:e}){if(void 0!==e&&e.type===je){const t=e.elementaryStreams;if(!Object.keys(t).some((e=>!!t[e])))return;const i=this._levels[e.level];null!=i&&i.loadError&&(this.log(`Resetting level error count of ${i.loadError} on frag buffered`),i.loadError=0)}}onLevelLoaded(t,e){var i;const{level:s,details:r}=e,n=this._levels[s];var a;if(!n)return this.warn(`Invalid level index ${s}`),void(null!=(a=e.deliveryDirectives)&&a.skip&&(r.deltaUpdateFailed=!0));s===this.currentLevelIndex?(0===n.fragmentError&&(n.loadError=0),this.playlistLoaded(s,e,n.details)):null!=(i=e.deliveryDirectives)&&i.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(t){super.loadPlaylist();const e=this.currentLevelIndex,i=this.currentLevel;if(i&&this.shouldLoadPlaylist(i)){let s=i.uri;if(t)try{s=t.addDirectives(s)}catch(t){this.warn(`Could not construct new URL with HLS Delivery Directives: ${t}`)}const r=i.attrs["PATHWAY-ID"];this.log(`Loading level index ${e}${void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:""} with${r?" Pathway "+r:""} ${s}`),this.clearTimer(),this.hls.trigger(U.LEVEL_LOADING,{url:s,level:e,pathwayId:i.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}removeLevel(t){var e;const i=this._levels.filter(((e,i)=>i!==t||(this.steering&&this.steering.removeLevel(e),e===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,e.details&&e.details.fragments.forEach((t=>t.level=-1))),!1)));Ci(i),this._levels=i,this.currentLevelIndex>-1&&null!=(e=this.currentLevel)&&e.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(U.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(t,{levels:e}){this._levels=e}checkMaxAutoUpdated(){const{autoLevelCapping:t,maxAutoLevel:e,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==e&&(this._maxAutoLevel=e,this.hls.trigger(U.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:e,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}function Va(t){const e={};t.forEach((t=>{const i=t.groupId||"";t.id=e[i]=e[i]||0,e[i]++}))}class Ka{constructor(t){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(const i in this.keyUriToKeyInfo){const s=this.keyUriToKeyInfo[i].loader;if(s){var e;if(t&&t!==(null==(e=s.context)?void 0:e.frag.type))return;s.abort()}}}detach(){for(const t in this.keyUriToKeyInfo){const e=this.keyUriToKeyInfo[t];(e.mediaKeySessionContext||e.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[t]}}destroy(){this.detach();for(const t in this.keyUriToKeyInfo){const e=this.keyUriToKeyInfo[t].loader;e&&e.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(t,e=B.KEY_LOAD_ERROR,i,s,r){return new Ls({type:$.NETWORK_ERROR,details:e,fatal:!1,frag:t,response:r,error:i,networkDetails:s})}loadClear(t,e){if(this.emeController&&this.config.emeEnabled){const{sn:i,cc:s}=t;for(let t=0;t<e.length;t++){const r=e[t];if(s<=r.cc&&("initSegment"===i||"initSegment"===r.sn||i<r.sn)){this.emeController.selectKeySystemFormat(r).then((t=>{r.setKeyFormat(t)}));break}}}}load(t){return!t.decryptdata&&t.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(t).then((e=>this.loadInternal(t,e))):this.loadInternal(t)}loadInternal(t,e){var i,s;e&&t.setKeyFormat(e);const r=t.decryptdata;if(!r){const i=new Error(e?`Expected frag.decryptdata to be defined after setting format ${e}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(t,B.KEY_LOAD_ERROR,i))}const n=r.uri;if(!n)return Promise.reject(this.createKeyLoadError(t,B.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${n}"`)));let a=this.keyUriToKeyInfo[n];if(null!=(i=a)&&i.decryptdata.key)return r.key=a.decryptdata.key,Promise.resolve({frag:t,keyInfo:a});var o;if(null!=(s=a)&&s.keyLoadPromise)switch(null==(o=a.mediaKeySessionContext)?void 0:o.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then((e=>(r.key=e.keyInfo.decryptdata.key,{frag:t,keyInfo:a})))}switch(a=this.keyUriToKeyInfo[n]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===r.keyFormat?this.loadKeyHTTP(a,t):this.loadKeyEME(a,t);case"AES-128":return this.loadKeyHTTP(a,t);default:return Promise.reject(this.createKeyLoadError(t,B.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(t,e){const i={frag:e,keyInfo:t};if(this.emeController&&this.config.emeEnabled){const e=this.emeController.loadKey(i);if(e)return (t.keyLoadPromise=e.then((e=>(t.mediaKeySessionContext=e,i)))).catch((e=>{throw (t.keyLoadPromise=null, e)}));}return Promise.resolve(i)}loadKeyHTTP(t,e){const i=this.config,s=new(0,i.loader)(i);return e.keyLoader=t.loader=s,t.keyLoadPromise=new Promise(((r,n)=>{const a={keyInfo:t,frag:e,responseType:"arraybuffer",url:t.decryptdata.uri},o=i.keyLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(t,e,i,s)=>{const{frag:a,keyInfo:o,url:l}=i;if(!a.decryptdata||o!==this.keyUriToKeyInfo[l])return n(this.createKeyLoadError(a,B.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),s));o.decryptdata.key=a.decryptdata.key=new Uint8Array(t.data),a.keyLoader=null,o.loader=null,r({frag:a,keyInfo:o})},onError:(t,i,s,r)=>{this.resetLoader(i),n(this.createKeyLoadError(e,B.KEY_LOAD_ERROR,new Error(`HTTP Error ${t.code} loading key ${t.text}`),s,w({url:a.url,data:void 0},t)))},onTimeout:(t,i,s)=>{this.resetLoader(i),n(this.createKeyLoadError(e,B.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),s))},onAbort:(t,i,s)=>{this.resetLoader(i),n(this.createKeyLoadError(e,B.INTERNAL_ABORTED,new Error("key loading aborted"),s))}};s.load(a,l,h)}))}resetLoader(t){const{frag:e,keyInfo:i,url:s}=t,r=i.loader;e.keyLoader===r&&(e.keyLoader=null,i.loader=null),delete this.keyUriToKeyInfo[s],r&&r.destroy()}}function ja(){return self.SourceBuffer||self.WebKitSourceBuffer}function Wa(){if(!ve())return!1;const t=ja();return!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove}class za{constructor(t,e,i,s){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=t,this.media=e,this.fragmentTracker=i,this.hls=s}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(t,e){const{config:i,media:s,stalled:r}=this;if(null===s)return;const{currentTime:n,seeking:a}=s,o=this.seeking&&!a,l=!this.seeking&&a;if(this.seeking=a,n!==t){if(this.moved=!0,a||(this.nudgeRetry=0),null!==r){if(this.stallReported){const t=self.performance.now()-r;j.warn(`playback not stuck anymore @${n}, after ${Math.round(t)}ms`),this.stallReported=!1}this.stalled=null}return}if(l||o)return void(this.stalled=null);if(s.paused&&!a||s.ended||0===s.playbackRate||!us.getBuffered(s).length)return void(this.nudgeRetry=0);const h=us.bufferInfo(s,n,0),d=h.nextStart||0;if(a){const t=h.len>2,i=!d||e&&e.start<=n||d-n>2&&!this.fragmentTracker.getPartialFragment(n);if(t||i)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var c;if(!(h.len>0)&&!d)return;const t=Math.max(d,h.start||0)-n,e=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,i=(null==e||null==(c=e.details)?void 0:c.live)?2*e.details.targetduration:2,r=this.fragmentTracker.getPartialFragment(n);if(t>0&&(t<=i||r))return void(s.paused||this._trySkipBufferHole(r))}const u=self.performance.now();if(null===r)return void(this.stalled=u);const f=u-r;if(!a&&f>=250&&(this._reportStall(h),!this.media))return;const g=us.bufferInfo(s,n,i.maxBufferHole);this._tryFixBufferStall(g,f)}_tryFixBufferStall(t,e){const{config:i,fragmentTracker:s,media:r}=this;if(null===r)return;const n=r.currentTime,a=s.getPartialFragment(n);if(a){if(this._trySkipBufferHole(a)||!this.media)return}(t.len>i.maxBufferHole||t.nextStart&&t.nextStart-n<i.maxBufferHole)&&e>1e3*i.highBufferWatchdogPeriod&&(j.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(t){const{hls:e,media:i,stallReported:s}=this;if(!s&&i){this.stallReported=!0;const s=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${JSON.stringify(t)})`);j.warn(s.message),e.trigger(U.ERROR,{type:$.MEDIA_ERROR,details:B.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:t.len})}}_trySkipBufferHole(t){const{config:e,hls:i,media:s}=this;if(null===s)return 0;const r=s.currentTime,n=us.bufferInfo(s,r,0),a=r<n.start?n.start:n.nextStart;if(a){const o=n.len<=e.maxBufferHole,l=n.len>0&&n.len<1&&s.readyState<3,h=a-r;if(h>0&&(o||l)){if(h>e.maxBufferHole){const{fragmentTracker:e}=this;let i=!1;if(0===r){const t=e.getAppendedFrag(0,je);t&&a<t.end&&(i=!0)}if(!i){const i=t||e.getAppendedFrag(r,je);if(i){let t=!1,s=i.end;for(;s<a;){const i=e.getPartialFragment(s);if(!i){t=!0;break}s+=i.duration}if(t)return 0}}}const n=Math.max(a+.05,r+.1);if(j.warn(`skipping hole, adjusting currentTime from ${r} to ${n}`),this.moved=!0,this.stalled=null,s.currentTime=n,t&&!t.gap){const e=new Error(`fragment loaded with buffer holes, seeking from ${r} to ${n}`);i.trigger(U.ERROR,{type:$.MEDIA_ERROR,details:B.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:e,reason:e.message,frag:t})}return n}}return 0}_tryNudgeBuffer(){const{config:t,hls:e,media:i,nudgeRetry:s}=this;if(null===i)return;const r=i.currentTime;if(this.nudgeRetry++,s<t.nudgeMaxRetry){const n=r+(s+1)*t.nudgeOffset,a=new Error(`Nudging 'currentTime' from ${r} to ${n}`);j.warn(a.message),i.currentTime=n,e.trigger(U.ERROR,{type:$.MEDIA_ERROR,details:B.BUFFER_NUDGE_ON_STALL,error:a,fatal:!1})}else{const i=new Error(`Playhead still not moving while enough data buffered @${r} after ${t.nudgeMaxRetry} nudges`);j.error(i.message),e.trigger(U.ERROR,{type:$.MEDIA_ERROR,details:B.BUFFER_STALLED_ERROR,error:i,fatal:!0})}}}class Ya extends Gs{constructor(t,e,i){super(t,e,i,"[stream-controller]",je),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(U.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(U.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(U.MANIFEST_LOADING,this.onManifestLoading,this),t.on(U.MANIFEST_PARSED,this.onManifestParsed,this),t.on(U.LEVEL_LOADING,this.onLevelLoading,this),t.on(U.LEVEL_LOADED,this.onLevelLoaded,this),t.on(U.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(U.ERROR,this.onError,this),t.on(U.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(U.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(U.BUFFER_CREATED,this.onBufferCreated,this),t.on(U.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(U.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(U.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(U.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(U.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(U.MANIFEST_LOADING,this.onManifestLoading,this),t.off(U.MANIFEST_PARSED,this.onManifestParsed,this),t.off(U.LEVEL_LOADED,this.onLevelLoaded,this),t.off(U.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(U.ERROR,this.onError,this),t.off(U.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(U.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(U.BUFFER_CREATED,this.onBufferCreated,this),t.off(U.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(U.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(U.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(t){if(this.levels){const{lastCurrentTime:e,hls:i}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let t=i.startLevel;-1===t&&(i.config.testBandwidth&&this.levels.length>1?(t=0,this.bitrateTest=!0):t=i.firstAutoLevel),i.nextLoadLevel=t,this.level=i.loadLevel,this.loadedmetadata=!1}e>0&&-1===t&&(this.log(`Override startPosition with lastCurrentTime @${e.toFixed(3)}`),t=e),this.state=Ds,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this._forceStartLoad=!0,this.state=Is}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Bs:{const{levels:t,level:e}=this,i=null==t?void 0:t[e],s=null==i?void 0:i.details;if(s&&(!s.live||this.levelLastLoaded===i)){if(this.waitForCdnTuneIn(s))break;this.state=Ds;break}if(this.hls.nextLoadLevel!==this.level){this.state=Ds;break}break}case xs:{var t;const e=self.performance.now(),i=this.retryDate;if(!i||e>=i||null!=(t=this.media)&&t.seeking){const{levels:t,level:e}=this,i=null==t?void 0:t[e];this.resetStartWhenNotLoaded(i||null),this.state=Ds}}}this.state===Ds&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:t,levelLastLoaded:e,levels:i,media:s}=this;if(null===e||!s&&(this.startFragRequested||!t.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const r=t.nextLoadLevel;if(null==i||!i[r])return;const n=i[r],a=this.getMainFwdBufferInfo();if(null===a)return;const o=this.getLevelDetails();if(o&&this._streamEnded(a,o)){const t={};return this.altAudio&&(t.type="video"),this.hls.trigger(U.BUFFER_EOS,t),void(this.state=Ns)}t.loadLevel!==r&&-1===t.manualLevel&&this.log(`Adapting to level ${r} from level ${this.level}`),this.level=t.nextLoadLevel=r;const l=n.details;if(!l||this.state===Bs||l.live&&this.levelLastLoaded!==n)return this.level=r,void(this.state=Bs);const h=a.len,d=this.getMaxBufferLength(n.maxBitrate);if(h>=d)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const c=this.backtrackFragment?this.backtrackFragment.start:a.end;let u=this.getNextFragment(c,l);if(this.couldBacktrack&&!this.fragPrevious&&u&&"initSegment"!==u.sn&&this.fragmentTracker.getState(u)!==os){var f;const t=(null!=(f=this.backtrackFragment)?f:u).sn-l.startSN,e=l.fragments[t-1];e&&u.cc===e.cc&&(u=e,this.fragmentTracker.removeFragment(e))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(u&&this.isLoopLoading(u,c)){if(!u.gap){const t=this.audioOnly&&!this.altAudio?J:Z,e=(t===Z?this.videoBuffer:this.mediaBuffer)||this.media;e&&this.afterBufferFlushed(e,t,je)}u=this.getNextFragmentLoopLoading(u,l,a,je,d)}u&&(!u.initSegment||u.initSegment.data||this.bitrateTest||(u=u.initSegment),this.loadFragment(u,n,c))}loadFragment(t,e,i){const s=this.fragmentTracker.getState(t);this.fragCurrent=t,s===rs||s===as?"initSegment"===t.sn?this._loadInitSegment(t,e):this.bitrateTest?(this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t,e)):(this.startFragRequested=!0,super.loadFragment(t,e,i)):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,je)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:t,media:e}=this;if(null!=e&&e.readyState){let i;const s=this.getAppendedFrag(e.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);const r=this.getLevelDetails();if(null!=r&&r.live){const t=this.getMainFwdBufferInfo();if(!t||t.len<2*r.targetduration)return}if(!e.paused&&t){const e=t[this.hls.nextLoadLevel],s=this.fragLastKbps;i=s&&this.fragCurrent?this.fragCurrent.duration*e.maxBitrate/(1e3*s)+1:0}else i=0;const n=this.getBufferedFrag(e.currentTime+i);if(n){const t=this.followingBufferedFrag(n);if(t){this.abortCurrentFrag();const e=t.maxStartPTS?t.maxStartPTS:t.start,i=t.duration,s=Math.max(n.end,e+Math.min(Math.max(i-this.config.maxFragLookUpTolerance,i*(this.couldBacktrack?.5:.125)),i*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(s,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case ws:case Ps:case xs:case Os:case Fs:this.state=Ds}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,e){super.flushMainBuffer(t,e,this.altAudio?"video":null)}onMediaAttached(t,e){super.onMediaAttached(t,e);const i=e.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),i.addEventListener("playing",this.onvplaying),i.addEventListener("seeked",this.onvseeked),this.gapController=new za(this.config,i,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:t}=this;t&&this.onvplaying&&this.onvseeked&&(t.removeEventListener("playing",this.onvplaying),t.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const t=this.media,e=t?t.currentTime:null;O(e)&&this.log(`Media seeked to ${e.toFixed(3)}`);const i=this.getMainFwdBufferInfo();null!==i&&0!==i.len?this.tick():this.warn(`Main forward buffer length on "seeked" event ${i?i.len:"empty"})`)}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(U.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(t,e){let i=!1,s=!1;e.levels.forEach((t=>{const e=t.audioCodec;e&&(i=i||-1!==e.indexOf("mp4a.40.2"),s=s||-1!==e.indexOf("mp4a.40.5"))})),this.audioCodecSwitch=i&&s&&!function(){var t;const e=ja();return"function"==typeof(null==e||null==(t=e.prototype)?void 0:t.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1}onLevelLoading(t,e){const{levels:i}=this;if(!i||this.state!==Ds)return;const s=i[e.level];(!s.details||s.details.live&&this.levelLastLoaded!==s||this.waitForCdnTuneIn(s.details))&&(this.state=Bs)}onLevelLoaded(t,e){var i;const{levels:s}=this,r=e.level,n=e.details,a=n.totalduration;if(!s)return void this.warn(`Levels were reset while loading level ${r}`);this.log(`Level ${r} loaded [${n.startSN},${n.endSN}]${n.lastPartSn?`[part-${n.lastPartSn}-${n.lastPartIndex}]`:""}, cc [${n.startCC}, ${n.endCC}] duration:${a}`);const o=s[r],l=this.fragCurrent;!l||this.state!==Ps&&this.state!==xs||l.level!==e.level&&l.loader&&this.abortCurrentFrag();let h=0;if(n.live||null!=(i=o.details)&&i.live){var d;if(this.checkLiveUpdate(n),n.deltaUpdateFailed)return;h=this.alignPlaylists(n,o.details,null==(d=this.levelLastLoaded)?void 0:d.details)}if(o.details=n,this.levelLastLoaded=o,this.hls.trigger(U.LEVEL_UPDATED,{details:n,level:r}),this.state===Bs){if(this.waitForCdnTuneIn(n))return;this.state=Ds}this.startFragRequested?n.live&&this.synchronizeToLiveEdge(n):this.setStartPosition(n,h),this.tick()}_handleFragmentLoadProgress(t){var e;const{frag:i,part:s,payload:r}=t,{levels:n}=this;if(!n)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);const a=n[i.level],o=a.details;if(!o)return this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),void this.fragmentTracker.removeFragment(i);const l=a.videoCodec,h=o.PTSKnown||!o.live,d=null==(e=i.initSegment)?void 0:e.data,c=this._getAudioCodec(a),u=this.transmuxer=this.transmuxer||new zr(this.hls,je,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),f=s?s.index:-1,g=-1!==f,m=new fs(i.level,i.sn,i.stats.chunkCount,r.byteLength,f,g),p=this.initPTS[i.cc];u.push(r,d,c,l,i,s,o.totalduration,h,m,p)}onAudioTrackSwitching(t,e){const i=this.altAudio;if(!!!e.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const t=this.fragCurrent;t&&(this.log("Switching to main audio track, cancel main fragment load"),t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const t=this.hls;i&&(t.trigger(U.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),t.trigger(U.AUDIO_TRACK_SWITCHED,e)}}onAudioTrackSwitched(t,e){const i=e.id,s=!!this.hls.audioTracks[i].url;if(s){const t=this.videoBuffer;t&&this.mediaBuffer!==t&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=t)}this.altAudio=s,this.tick()}onBufferCreated(t,e){const i=e.tracks;let s,r,n=!1;for(const t in i){const e=i[t];if("main"===e.id){if(r=t,s=e,"video"===t){const e=i[t];e&&(this.videoBuffer=e.buffer)}}else n=!0}n&&s?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(t,e){const{frag:i,part:s}=e;if(i&&i.type!==je)return;if(this.fragContextChanged(i))return this.warn(`Fragment ${i.sn}${s?" p: "+s.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===Fs&&(this.state=Ds));const r=s?s.stats:i.stats;this.fragLastKbps=Math.round(8*r.total/(r.buffering.end-r.loading.first)),"initSegment"!==i.sn&&(this.fragPrevious=i),this.fragBufferedComplete(i,s)}onError(t,e){var i;if(e.fatal)this.state=Us;else switch(e.details){case B.FRAG_GAP:case B.FRAG_PARSING_ERROR:case B.FRAG_DECRYPT_ERROR:case B.FRAG_LOAD_ERROR:case B.FRAG_LOAD_TIMEOUT:case B.KEY_LOAD_ERROR:case B.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(je,e);break;case B.LEVEL_LOAD_ERROR:case B.LEVEL_LOAD_TIMEOUT:case B.LEVEL_PARSING_ERROR:e.levelRetry||this.state!==Bs||(null==(i=e.context)?void 0:i.type)!==He||(this.state=Ds);break;case B.BUFFER_APPEND_ERROR:case B.BUFFER_FULL_ERROR:if(!e.parent||"main"!==e.parent)return;if(e.details===B.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(e)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case B.INTERNAL_EXCEPTION:this.recoverWorkerError(e)}}checkBuffer(){const{media:t,gapController:e}=this;if(t&&e&&t.readyState){if(this.loadedmetadata||!us.getBuffered(t).length){const t=this.state!==Ds?this.fragCurrent:null;e.poll(this.lastCurrentTime,t)}this.lastCurrentTime=t.currentTime}}onFragLoadEmergencyAborted(){this.state=Ds,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(t,{type:e}){if(e!==J||this.audioOnly&&!this.altAudio){const t=(e===Z?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(t,e,je),this.tick()}}onLevelsUpdated(t,e){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=e.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:t}=this;if(!t)return;const e=t.currentTime;let i=this.startPosition;if(i>=0&&e<i){if(t.seeking)return void this.log(`could not seek to ${i}, already seeking at ${e}`);const s=us.getBuffered(t),r=(s.length?s.start(0):0)-i;r>0&&(r<this.config.maxBufferHole||r<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${r} to match buffer start`),i+=r,this.startPosition=i),this.log(`seek to target start position ${i} from current time ${e}`),t.currentTime=i}}_getAudioCodec(t){let e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&e&&(this.log("Swapping audio codec"),e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),e}_loadBitrateTestFrag(t,e){t.bitrateTest=!0,this._doFragLoad(t,e).then((i=>{const{hls:s}=this;if(!i||this.fragContextChanged(t))return;e.fragmentError=0,this.state=Ds,this.startFragRequested=!1,this.bitrateTest=!1;const r=t.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),s.trigger(U.FRAG_LOADED,i),t.bitrateTest=!1}))}_handleTransmuxComplete(t){var e;const i="main",{hls:s}=this,{remuxResult:r,chunkMeta:n}=t,a=this.getCurrentContext(n);if(!a)return void this.resetWhenMissingContext(n);const{frag:o,part:l,level:h}=a,{video:d,text:c,id3:u,initSegment:f}=r,{details:g}=h,m=this.altAudio?void 0:r.audio;if(this.fragContextChanged(o))this.fragmentTracker.removeFragment(o);else{if(this.state=Os,f){if(null!=f&&f.tracks){const t=o.initSegment||o;this._bufferInitSegment(h,f.tracks,t,n),s.trigger(U.FRAG_PARSING_INIT_SEGMENT,{frag:t,id:i,tracks:f.tracks})}const t=f.initPTS,e=f.timescale;O(t)&&(this.initPTS[o.cc]={baseTime:t,timescale:e},s.trigger(U.INIT_PTS_FOUND,{frag:o,id:i,initPTS:t,timescale:e}))}if(d&&g&&"initSegment"!==o.sn){const t=g.fragments[o.sn-1-g.startSN],e=o.sn===g.startSN,i=!t||o.cc>t.cc;if(!1!==r.independent){const{startPTS:t,endPTS:s,startDTS:r,endDTS:a}=d;if(l)l.elementaryStreams[d.type]={startPTS:t,endPTS:s,startDTS:r,endDTS:a};else if(d.firstKeyFrame&&d.independent&&1===n.id&&!i&&(this.couldBacktrack=!0),d.dropped&&d.independent){const r=this.getMainFwdBufferInfo(),n=(r?r.end:this.getLoadPosition())+this.config.maxBufferHole,l=d.firstKeyFramePTS?d.firstKeyFramePTS:t;if(!e&&n<l-this.config.maxBufferHole&&!i)return void this.backtrack(o);i&&(o.gap=!0),o.setElementaryStreamInfo(d.type,o.start,s,o.start,a,!0)}else e&&t>2&&(o.gap=!0);o.setElementaryStreamInfo(d.type,t,s,r,a),this.backtrackFragment&&(this.backtrackFragment=o),this.bufferFragmentData(d,o,l,n,e||i)}else{if(!e&&!i)return void this.backtrack(o);o.gap=!0}}if(m){const{startPTS:t,endPTS:e,startDTS:i,endDTS:s}=m;l&&(l.elementaryStreams[J]={startPTS:t,endPTS:e,startDTS:i,endDTS:s}),o.setElementaryStreamInfo(J,t,e,i,s),this.bufferFragmentData(m,o,l,n)}if(g&&null!=u&&null!=(e=u.samples)&&e.length){const t={id:i,frag:o,details:g,samples:u.samples};s.trigger(U.FRAG_PARSING_METADATA,t)}if(g&&c){const t={id:i,frag:o,details:g,samples:c.samples};s.trigger(U.FRAG_PARSING_USERDATA,t)}}}_bufferInitSegment(t,e,i,s){if(this.state!==Os)return;this.audioOnly=!!e.audio&&!e.video,this.altAudio&&!this.audioOnly&&delete e.audio;const{audio:r,video:n,audiovideo:a}=e;if(r){let e=t.audioCodec;const i=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(e&&(e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==r.metadata.channelCount&&-1===i.indexOf("firefox")&&(e="mp4a.40.5")),e&&-1!==e.indexOf("mp4a.40.5")&&-1!==i.indexOf("android")&&"audio/mpeg"!==r.container&&(e="mp4a.40.2",this.log(`Android: force audio codec to ${e}`)),t.audioCodec&&t.audioCodec!==e&&this.log(`Swapping manifest audio codec "${t.audioCodec}" for "${e}"`),r.levelCodec=e,r.id="main",this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${e||""}/${t.audioCodec||""}/${r.codec}]`)}n&&(n.levelCodec=t.videoCodec,n.id="main",this.log(`Init video buffer, container:${n.container}, codecs[level/parsed]=[${t.videoCodec||""}/${n.codec}]`)),a&&this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${t.codecs}/${a.codec}]`),this.hls.trigger(U.BUFFER_CODECS,e),Object.keys(e).forEach((t=>{const r=e[t].initSegment;null!=r&&r.byteLength&&this.hls.trigger(U.BUFFER_APPENDING,{type:t,data:r,frag:i,part:null,chunkMeta:s,parent:i.type})})),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,je)}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state=Ds}checkFragmentChanged(){const t=this.media;let e=null;if(t&&t.readyState>1&&!1===t.seeking){const i=t.currentTime;if(us.isBuffered(t,i)?e=this.getAppendedFrag(i):us.isBuffered(t,i+.1)&&(e=this.getAppendedFrag(i+.1)),e){this.backtrackFragment=null;const t=this.fragPlaying,i=e.level;t&&e.sn===t.sn&&t.level===i||(this.fragPlaying=e,this.hls.trigger(U.FRAG_CHANGED,{frag:e}),t&&t.level===i||this.hls.trigger(U.LEVEL_SWITCHED,{level:i}))}}}get nextLevel(){const t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){const t=this.media;return t?this.fragPlaying||this.getAppendedFrag(t.currentTime):null}get currentProgramDateTime(){const t=this.media;if(t){const e=t.currentTime,i=this.currentFrag;if(i&&O(e)&&O(i.programDateTime)){const t=i.programDateTime+1e3*(e-i.start);return new Date(t)}}return null}get currentLevel(){const t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){const t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}}class qa{static get version(){return"1.5.8"}static isMSESupported(){return Wa()}static isSupported(){return function(){if(!Wa())return!1;const t=ve();return"function"==typeof(null==t?void 0:t.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some((e=>t.isTypeSupported(Se(e,"video"))))||["mp4a.40.2","fLaC"].some((e=>t.isTypeSupported(Se(e,"audio")))))}()}static getMediaSource(){return ve()}static get Events(){return U}static get ErrorTypes(){return $}static get ErrorDetails(){return B}static get DefaultConfig(){return qa.defaultConfig?qa.defaultConfig:Ua}static set DefaultConfig(t){qa.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new Wr,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,function(t,e){if("object"==typeof console&&!0===t||"object"==typeof t){K(t,"debug","log","info","warn","error");try{V.log(`Debug logs enabled for "${e}" in hls.js version 1.5.8`)}catch(t){V=H}}else V=H}(t.debug||!1,"Hls instance");const e=this.config=function(t,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==e.liveMaxLatencyDurationCount&&(void 0===e.liveSyncDurationCount||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==e.liveMaxLatencyDuration&&(void 0===e.liveSyncDuration||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=$a(t),s=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((t=>{const r=`${"level"===t?"playlist":t}LoadPolicy`,n=void 0===e[r],a=[];s.forEach((s=>{const o=`${t}Loading${s}`,l=e[o];if(void 0!==l&&n){a.push(o);const t=i[r].default;switch(e[r]={default:t},s){case"TimeOut":t.maxLoadTimeMs=l,t.maxTimeToFirstByteMs=l;break;case"MaxRetry":t.errorRetry.maxNumRetry=l,t.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":t.errorRetry.retryDelayMs=l,t.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":t.errorRetry.maxRetryDelayMs=l,t.timeoutRetry.maxRetryDelayMs=l}}})),a.length&&j.warn(`hls.js config: "${a.join('", "')}" setting(s) are deprecated, use "${r}": ${JSON.stringify(e[r])}`)})),w(w({},i),e)}(qa.DefaultConfig,t);this.userConfig=t,e.progressive&&Ba(e);const{abrController:i,bufferController:s,capLevelController:r,errorController:n,fpsController:a}=e,o=new n(this),l=this.abrController=new i(this),h=this.bufferController=new s(this),d=this.capLevelController=new r(this),c=new a(this),u=new Xe(this),f=new hi(this),g=e.contentSteeringController,m=g?new g(this):null,p=this.levelController=new Ha(this,m),v=new ls(this),y=new Ka(this.config),E=this.streamController=new Ya(this,v,y);d.setStreamController(E),c.setStreamController(E);const T=[u,p,E];m&&T.splice(1,0,m),this.networkControllers=T;const S=[l,h,d,c,f,v];this.audioTrackController=this.createController(e.audioTrackController,T);const b=e.audioStreamController;b&&T.push(new b(this,v,y)),this.subtitleTrackController=this.createController(e.subtitleTrackController,T);const L=e.subtitleStreamController;L&&T.push(new L(this,v,y)),this.createController(e.timelineController,S),y.emeController=this.emeController=this.createController(e.emeController,S),this.cmcdController=this.createController(e.cmcdController,S),this.latencyController=this.createController(di,S),this.coreComponents=S,T.push(o);const A=o.onErrorOut;"function"==typeof A&&this.on(U.ERROR,A,o)}createController(t,e){if(t){const i=new t(this);return e&&e.push(i),i}return null}on(t,e,i=this){this._emitter.on(t,e,i)}once(t,e,i=this){this._emitter.once(t,e,i)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,e,i=this,s){this._emitter.off(t,e,i,s)}listeners(t){return this._emitter.listeners(t)}emit(t,e,i){return this._emitter.emit(t,e,i)}trigger(t,e){if(this.config.debug)return this.emit(t,t,e);try{return this.emit(t,t,e)}catch(e){if(j.error("An internal error happened while handling event "+t+'. Error message: "'+e.message+'". Here is a stacktrace:',e),!this.triggeringException){this.triggeringException=!0;const i=t===U.ERROR;this.trigger(U.ERROR,{type:$.OTHER_ERROR,details:B.INTERNAL_EXCEPTION,fatal:i,event:t,error:e}),this.triggeringException=!1}}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){j.log("destroy"),this.trigger(U.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((t=>t.destroy())),this.networkControllers.length=0,this.coreComponents.forEach((t=>t.destroy())),this.coreComponents.length=0;const t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){j.log("attachMedia"),this._media=t,this.trigger(U.MEDIA_ATTACHING,{media:t})}detachMedia(){j.log("detachMedia"),this.trigger(U.MEDIA_DETACHING,void 0),this._media=null}loadSource(t){this.stopLoad();const e=this.media,i=this.url,s=this.url=I.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,j.log(`loadSource:${s}`),e&&i&&(i!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(e)),this.trigger(U.MANIFEST_LOADING,{url:t})}startLoad(t=-1){j.log(`startLoad(${t})`),this.started=!0,this.networkControllers.forEach((e=>{e.startLoad(t)}))}stopLoad(){j.log("stopLoad"),this.started=!1,this.networkControllers.forEach((t=>{t.stopLoad()}))}resumeBuffering(){this.started&&this.networkControllers.forEach((t=>{"fragmentLoader"in t&&t.startLoad(-1)}))}pauseBuffering(){this.networkControllers.forEach((t=>{"fragmentLoader"in t&&t.stopLoad()}))}swapAudioCodec(){j.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){j.log("recoverMediaError");const t=this._media;this.detachMedia(),t&&this.attachMedia(t)}removeLevel(t){this.levelController.removeLevel(t)}get levels(){const t=this.levelController.levels;return t||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){j.log(`set currentLevel:${t}`),this.levelController.manualLevel=t,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){j.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){j.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){j.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){const t=this.levelController.startLevel;return-1===t&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:t}set startLevel(t){j.log(`set startLevel:${t}`),-1!==t&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){const e=!!t;e!==this.config.capLevelToPlayerSize&&(e?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=e)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}set bandwidthEstimate(t){this.abrController.resetEstimator(t)}get ttfbEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(j.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){(function(t){return ci.indexOf(t)>-1})(t)&&this._maxHdcpLevel!==t&&(this._maxHdcpLevel=t,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:t,config:{minAutoBitrate:e}}=this;if(!t)return 0;const i=t.length;for(let s=0;s<i;s++)if(t[s].maxBitrate>=e)return s;return 0}get maxAutoLevel(){const{levels:t,autoLevelCapping:e,maxHdcpLevel:i}=this;let s;if(s=-1===e&&null!=t&&t.length?t.length-1:e,i)for(let e=s;e--;){const s=t[e].attrs["HDCP-LEVEL"];if(s&&s<=i)return e}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(t){this.abrController.nextAutoLevel=t}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(t){var e;return null==(e=this.audioTrackController)?void 0:e.setAudioOption(t)}setSubtitleOption(t){var e;return null==(e=this.subtitleTrackController)||e.setSubtitleOption(t),null}get allAudioTracks(){const t=this.audioTrackController;return t?t.allAudioTracks:[]}get audioTracks(){const t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){const t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){const e=this.audioTrackController;e&&(e.audioTrack=t)}get allSubtitleTracks(){const t=this.subtitleTrackController;return t?t.allSubtitleTracks:[]}get subtitleTracks(){const t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){const t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){const e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}get subtitleDisplay(){const t=this.subtitleTrackController;return!!t&&t.subtitleDisplay}set subtitleDisplay(t){const e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}qa.defaultConfig=void 0;const Xa=new RegExp("(^https://v.redd.it/)([a-zA-Z0-9]+)/");function Qa(t){const e=t?.match(Xa);return 3===e?.length?e[2]:""}const Ja="@reddit/shreddit-player-media-quality";function Za(t){return t>=1080?1080:t>=720?720:t>=540?540:t>=480?480:t>=360?360:t>=240?240:144}function to({hlsEngine:t,mp4Sources:e}){return e?e.some((t=>t.source.dimensions.height>t.source.dimensions.width&&t.source.dimensions.height>768)):!!t&&t.levels.some((t=>t.height>t.width&&t.height>768))}function eo(t=[]){return t.sort(((t,e)=>t.quality>e.quality?-1:1))}function io(t,e=[]){for(let i=0;i<e.length;i++)if(t>=e[i].quality)return i;return e.length-1}function so(){const e=t.a8.getItem(Ja);return e?parseInt(e):void 0}class ro{constructor(t){(this.host=t).addController(this),this.videoElement=t.videoElement}hostDisconnected(){this.destroyHlsEngine()}get isHlsStream(){return this.host.src.includes(".m3u8")}async initializeHlsJs(){qa.isSupported()?(this.hls=new qa((({cmcdSessionId:t,src:e})=>({capLevelToPlayerSize:!0,cmcd:{sessionId:t,contentId:Qa(e),useHeaders:!0},maxBufferLength:20,maxMaxBufferLength:20,backBufferLength:3}))({authToken:this.host.streamingAuthToken,cmcdSessionId:this.host.subSessionId,src:this.host.src})),this.hls.once(qa.Events.MANIFEST_PARSED,(()=>{this.host.qualityLevels=this.createQualityLevels(),this.host.currentQualityLevelIndex=this.getInitialQualityLevel()})),this.hls.on(qa.Events.MANIFEST_LOADING,(()=>{this.host.telemetryController.startDownload()})),this.hls.on(qa.Events.MANIFEST_LOADED,(()=>{this.host.telemetryController.endDownload()})),this.hls.on(qa.Events.FRAG_LOADED,(()=>{this.host.errorController.resetRetryCount()})),this.hls.on(qa.Events.LEVEL_SWITCHED,(()=>{this.host.telemetryController.switchBitrate()})),this.hls.on(qa.Events.BUFFER_APPENDED,(()=>{this.host.errorController.resetRetryCount()})),this.hls.on(qa.Events.LEVEL_LOADED,(()=>{this.host.errorController.resetRetryCount()})),this.hls.on(qa.Events.ERROR,this.host.errorController.handleHlsError),this.hls.loadSource(this.host.src),this.hls.attachMedia(this.videoElement)):this.videoElement.src||(this.videoElement.src=this.host.src)}setQualityLevel(t){this.host.currentQualityLevelIndex=t,this.hls&&(this.hls.nextLevel=t)}createQualityLevels(){if(!this.hls)return[];const t=[],e=to({hlsEngine:this.hls});return(this.hls.levels||[]).map(((t,e)=>({...t,hlsLevelIndex:e}))).sort(((t,e)=>t.bitrate>e.bitrate?-1:1)).forEach((i=>{const s=Za(e?i?.width:i?.height);s&&-1===t.map((t=>t.quality)).indexOf(s)&&t.push({hlsLevelIndex:i.hlsLevelIndex,quality:s})})),eo(t)}getInitialQualityLevel(){const t=so();if(t&&this.hls){const e=this.host.qualityLevels.filter((e=>e.quality===t))[0]?.hlsLevelIndex;if(void 0!==e)return this.hls.startLevel=e,this.hls.loadLevel=e,e}return-1}updateCmcdSessionId(t){this.hls&&this.hls.cmcdController&&(this.hls.cmcdController.sid=t)}destroyHlsEngine(){this.hls?.destroy(),this.hls=void 0}getCurLevel(){return this.hls?.levels&&void 0!==this.hls?.currentLevel?this.hls.levels[this.hls.currentLevel]:void 0}getCurAudioTrack(){return this.hls?.audioTracks&&void 0!==this.hls?.audioTrack?this.hls.audioTracks[this.hls.audioTrack]:void 0}}var no={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5,fullscreen:6},ao=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],oo=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],lo=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"],ho="undefined"!=typeof window&&void 0!==window.document?window.document:{},co="fullscreenEnabled"in ho&&Object.keys(no)||ao[0]in ho&&ao||oo[0]in ho&&oo||lo[0]in ho&&lo||[],uo={requestFullscreen:function(t){return t[co[no.requestFullscreen]]()},requestFullscreenFunction:function(t){return t[co[no.requestFullscreen]]},get exitFullscreen(){return ho[co[no.exitFullscreen]].bind(ho)},get fullscreenPseudoClass(){return":"+co[no.fullscreen]},addEventListener:function(t,e,i){return ho.addEventListener(co[no[t]],e,i)},removeEventListener:function(t,e,i){return ho.removeEventListener(co[no[t]],e,i)},get fullscreenEnabled(){return Boolean(ho[co[no.fullscreenEnabled]])},set fullscreenEnabled(t){},get fullscreenElement(){return ho[co[no.fullscreenElement]]},set fullscreenElement(t){},get onfullscreenchange(){return ho[("on"+co[no.fullscreenchange]).toLowerCase()]},set onfullscreenchange(t){return ho[("on"+co[no.fullscreenchange]).toLowerCase()]=t},get onfullscreenerror(){return ho[("on"+co[no.fullscreenerror]).toLowerCase()]},set onfullscreenerror(t){return ho[("on"+co[no.fullscreenerror]).toLowerCase()]=t}};class fo{constructor(e){this._logMessage=f,this._playRequested=!1,this._loadRequested=!1,this.play=async(t=!1)=>{if(this.host.hasHadPlayAttempt=!0,this._playRequested=!0,!this.videoElement.paused)return;const e=Date.now();if(t?this.host.telemetryController.autoplay():this.host.telemetryController.clickPlay(),this.host.mediaUI?.showLoadingSpinner(),this.host.initializeVideoElement(),this.host.syncPerf&&this.host.volumeController.initializeVolume(),this.host.isHls&&!this.host.hlsController.hls&&(await (this.host.hlsController?.initializeHlsJs())),this.host.mediaVisibilityController?.isVideoInView()||this.host.playOutOfViewport){this.host.subSessionPlayStartTime=this.host.subSessionPlayStartTime||Date.now();try{await this.videoElement.play(),this.host.debugOverlay?.log("Load time",Date.now()-e+"ms")}catch(t){this._logMessage({msg:"Play failed",error:t,debugOverlay:this.host.debugOverlay}),this.host.pause("scroll")}}else this.pause("scroll")},this.pause=t=>{if(this._playRequested){if("click"===t)this.host.telemetryController.clickPause();else if("scroll"===t)this.host.telemetryController.scrollPause();else if("background"===t)this.host.telemetryController.backgroundVideo();else if("ended"===t&&(this.host.playCount++,this.host.telemetryController.servedVideo(),this._shouldLoop()))return this.loop();this.host.updateSubSession()}this._playRequested=!1,"click"===t&&this.host.autoplay&&(this.host.autoplay=!1),this.videoElement.pause(),this.host.mediaUI?.setPausedState()},this.loop=()=>{this.host.telemetryController.looped=!0,this.host.updateSubSession(),this.play(!0)},this._shouldLoop=()=>!(!this.host.gif&&!this.host.loop)&&(!this.host.loopLimit||this.host.playCount<=this.host.loopLimit),this.togglePlay=()=>{this.videoElement.paused?this.play(!1):this.pause("click")},this.load=async(e=t.kV.AUTO)=>{this._loadRequested||this._playRequested||this.host.hasHadPlayAttempt||(this._loadRequested=!0,this.host.initializeVideoElement(),this.host.isHls&&!this.host.hlsController.hls&&(await (this.host.hlsController?.initializeHlsJs())),this.videoElement.preload=e,this.videoElement.load())},this.stop=()=>{this.host.initialized&&(this.host.stoppedState={currentTime:this.videoElement.currentTime},this.videoElement.pause(),this.host.isHls&&this.host.hlsController.destroyHlsEngine(),this.videoElement.removeAttribute("src"),this.videoElement.load(),this.host.initialized=!1)},this.toggleFullscreen=()=>{if(uo.fullscreenElement===this.host)uo.exitFullscreen();else{this.host.mediaSyncController.syncPlayback();try{uo.fullscreenEnabled?(uo.requestFullscreen(this.host),this.host.telemetryController.enterFullscreen()):"function"==typeof this.host.videoElement.webkitSetPresentationMode?(this.host.videoElement.webkitSetPresentationMode?.("fullscreen"),this.host.telemetryController.enterFullscreen()):this._logMessage({msg:"Could not enter fullscreen for device",debugOverlay:this.host.debugOverlay})}catch(t){this._logMessage({msg:"Error entering fullscreen",error:t,debugOverlay:this.host.debugOverlay})}}},this.setQualityLevel=t=>{this.host.isHls?this.host.hlsController.setQualityLevel(t):this.host.isMp4&&this.host.packagedMediaController.setQualityLevel(t)},this.toggleCaptions=()=>this.host.mediaUI?.captionController?.toggleCaptions(),this.setVolume=t=>this.host.volumeController.setVolume(t),this.increaseVolume=()=>this.host.volumeController.increaseVolume(),this.decreaseVolume=()=>this.host.volumeController.decreaseVolume(),this.toggleMute=()=>this.host.volumeController.toggleMute(),(this.host=e).addController(this),this.videoElement=e.videoElement}hostDisconnected(){this._playRequested=!1,this._loadRequested=!1}}class go{constructor(e){this.initializeSubscribers=()=>{this.hotkeyController?.contextualSubscribe(t.kW.TOGGLE_PLAY,this.mediaActionsController?.togglePlay),this.hotkeyController?.contextualSubscribe(t.kW.TOGGLE_FULLSCREEN,this.mediaActionsController?.toggleFullscreen),this.hotkeyController?.contextualSubscribe(t.kW.REWIND_5,this._rewind5),this.hotkeyController?.contextualSubscribe(t.kW.FAST_FORWARD_5,this._fastForward5),this.hotkeyController?.contextualSubscribe(t.kW.INCREASE_VOLUME,this.mediaActionsController?.increaseVolume),this.hotkeyController?.contextualSubscribe(t.kW.DECREASE_VOLUME,this.mediaActionsController?.decreaseVolume),this.hotkeyController?.contextualSubscribe(t.kW.REWIND_10,this._rewind10),this.hotkeyController?.contextualSubscribe(t.kW.FAST_FORWARD_10,this._fastForward10),this.hotkeyController?.contextualSubscribe(t.kW.RESTART,this._restart),this.hotkeyController?.contextualSubscribe(t.kW.TOGGLE_MUTE,this.mediaActionsController?.toggleMute),this.hotkeyController?.contextualSubscribe(t.kW.TOGGLE_CAPTIONS,this.mediaActionsController?.toggleCaptions)},this._rewind5=()=>{this.timeController?.skipTime(-5)},this._fastForward5=()=>{this.timeController?.skipTime(5)},this._rewind10=()=>{this.timeController?.skipTime(-10)},this._fastForward10=()=>{this.timeController?.skipTime(10)},this._restart=()=>{this.timeController?.setTime(0)},(this.host=e).addController(this)}get mediaActionsController(){return this.host.mediaActionsController}get timeController(){return this.host.mediaUI?.timeController}hostConnected(){this.hotkeyController=new t.cx(this.host),this.initializeSubscribers()}hostDisconnected(){this.hotkeyController?.contextualUnsubscribe(t.kW.TOGGLE_PLAY,this.mediaActionsController?.togglePlay),this.hotkeyController?.contextualUnsubscribe(t.kW.TOGGLE_FULLSCREEN,this.mediaActionsController?.toggleFullscreen),this.hotkeyController?.contextualUnsubscribe(t.kW.REWIND_5,this._rewind5),this.hotkeyController?.contextualUnsubscribe(t.kW.FAST_FORWARD_5,this._fastForward5),this.hotkeyController?.contextualUnsubscribe(t.kW.INCREASE_VOLUME,this.mediaActionsController?.increaseVolume),this.hotkeyController?.contextualUnsubscribe(t.kW.DECREASE_VOLUME,this.mediaActionsController?.decreaseVolume),this.hotkeyController?.contextualUnsubscribe(t.kW.REWIND_10,this._rewind10),this.hotkeyController?.contextualUnsubscribe(t.kW.FAST_FORWARD_10,this._fastForward10),this.hotkeyController?.contextualUnsubscribe(t.kW.RESTART,this._restart),this.hotkeyController?.contextualUnsubscribe(t.kW.TOGGLE_MUTE,this.mediaActionsController?.toggleMute),this.hotkeyController?.contextualUnsubscribe(t.kW.TOGGLE_CAPTIONS,this.mediaActionsController?.toggleCaptions),this.hotkeyController=void 0}}let mo;class po{constructor(e){this.syncPlayback=()=>{this.host.syncPerf?(mo&&mo!==this.host&&mo.pause("scroll"),mo=this.host):this.pubSubController.publish(t.T.MediaSyncPlayback,{subSessionId:this.host.subSessionId})},this.handlePlaybackSync=({subSessionId:t})=>{t!==this.host.subSessionId&&this.host.pause("scroll")},this.syncVolume=()=>{this.pubSubController.publish(t.T.MediaSyncVolume,{volume:this.videoElement.volume,muted:this.videoElement.muted})},this.handleVolumeSync=({volume:t,muted:e})=>{this.videoElement.volume===t&&this.videoElement.muted===e||(this.videoElement.volume=t,this.videoElement.muted=e)},this.syncVolumeToActivePlayers=()=>{const t=this.videoElement.volume,e=this.videoElement.muted;this.host.mediaVisibilityController.activeAutoplayPlayers().forEach((i=>{i===this.host||i.gif||i.videoElement.volume===t&&i.videoElement.muted===e||(i.videoElement.volume=t,i.videoElement.muted=e)}))},(this.host=e).addController(this),this.videoElement=e.videoElement,this.pubSubController=new t.u(this.host)}hostConnected(){this.host.singlePlayback&&(this.videoElement?.addEventListener("playing",this.syncPlayback),this.host.syncPerf||this.pubSubController.subscribe(t.T.MediaSyncPlayback,this.handlePlaybackSync)),this.host.gif||(this.host.syncPerf?this.videoElement?.addEventListener("volumechange",this.syncVolumeToActivePlayers):c((()=>{this.videoElement?.addEventListener("volumechange",this.syncVolume),this.pubSubController.subscribe(t.T.MediaSyncVolume,this.handleVolumeSync)})))}hostDisconnected(){this.host.singlePlayback&&(this.videoElement?.removeEventListener("playing",this.syncPlayback),this.host.syncPerf||this.pubSubController.unsubscribe(t.T.MediaSyncPlayback,this.handlePlaybackSync)),this.host.gif||(this.host.syncPerf?this.videoElement?.removeEventListener("volumechange",this.syncVolumeToActivePlayers):(this.videoElement?.removeEventListener("volumechange",this.syncVolume),this.pubSubController.unsubscribe(t.T.MediaSyncVolume,this.handleVolumeSync)))}}const vo=new Set;let yo=null;class Eo{constructor(t){this._isWithinAutoplayThreshold=!1,this._autoplayAttemptFailures=0,this.preloadIntersectionCallback=t=>{const e=t[t.length-1].isIntersecting;e&&this.host.autoplay?(vo.add(this.host),this.host.load()):e||this.host.playOutOfViewport||(this.host.stop(),vo.delete(this.host))},this.autoplayIntersectionCallback=t=>{const e=t[t.length-1].intersectionRatio;this._isWithinAutoplayThreshold=e>=.5,this._isWithinAutoplayThreshold?(vo.add(this.host),this.host.idleAutoplay?c(this.attemptAutoplay):this.attemptAutoplay()):this.host.playOutOfViewport||(this.host.pause("scroll"),this._clearAutoplayAttemptingPlayer())},this.attemptAutoplay=async()=>{if(this.shouldVideoAutoplay())if(this.host.initializeVideoElement(),this.host.singlePlayback){if(uo.fullscreenElement)return;if(yo&&yo!==this.host)return void this.host.mediaUI?.showPoster();yo=this.host;try{await this.host.play(!0)}catch(t){if(this._autoplayAttemptFailures++,this._autoplayAttemptFailures<3)return void this.attemptAutoplay();this.host.pause("scroll"),this.host.mediaUI?.showPoster()}finally{this._clearAutoplayAttemptingPlayer()}}else this.host.play(!0)},(this.host=t).addController(this)}hostConnected(){this.preloadObserver=new IntersectionObserver(this.preloadIntersectionCallback,{threshold:0,rootMargin:"500px 0px"}),this.preloadObserver.observe(this.host),this.autoplayObserver=new IntersectionObserver(this.autoplayIntersectionCallback,{threshold:.5}),this.autoplayObserver.observe(this.host)}hostDisconnected(){this.preloadObserver?.unobserve(this.host),this.preloadObserver?.disconnect(),this.autoplayObserver?.unobserve(this.host),this.autoplayObserver?.disconnect(),this._isWithinAutoplayThreshold=!1,this._autoplayAttemptFailures=0,this._clearAutoplayAttemptingPlayer(),vo.delete(this.host)}isVideoInView(){return"visible"===document.visibilityState&&this._isWithinAutoplayThreshold}shouldVideoAutoplay(){return Boolean(this.host.autoplay&&this.isVideoInView()&&!this.host.mediaUI?.hasAttribute(t.h9.ENDED))}activeAutoplayPlayers(){return vo}_clearAutoplayAttemptingPlayer(){yo===this.host&&(yo=null)}}let To=t.Y;class So{constructor(t){this._logException=g,(this.host=t).addController(this),this.videoElement=t.videoElement}async hostDisconnected(){this.packagedMedia=void 0}get hasPackagedMedia(){return!!this.host.packagedMediaJSON}initialize(){if(!this.videoElement)throw new Error("Video element not found");this.hasPackagedMedia&&(this.parsePackagedMedia(),this.host.qualityLevels=this.createQualityLevels(),this.setQualityLevel(this.getInitialQualityLevel()))}parsePackagedMedia(){try{this.packagedMedia=JSON.parse(this.host.packagedMediaJSON),this.packagedMedia?.playbackMp4s?.permutations?.length||this.errorParsingPackagedMedia()}catch(t){this.errorParsingPackagedMedia(t)}}errorParsingPackagedMedia(t){this._logException({msg:"Could not parse packaged-media-json",error:t,debugOverlay:this.host.debugOverlay}),this.host.packagedMediaJSON=void 0,this.packagedMedia=void 0}setQualityLevel(t){this.host.currentQualityLevelIndex=t;const e=this.packagedMedia?.playbackMp4s.permutations[-1===t?function(t){let e=0;const i=navigator?.connection||navigator?.mozConnection||navigator?.webkitConnection,s=i?.effectiveType;return e="4g"===s||(i?.downlink??0)>3?0:io("3g"===s?360:"2g"===s||"slow-2g"===s?144:480,t),t[e].mp4SourceIndex??0}(this.host.qualityLevels):t]?.source.url,i=this.videoElement.currentTime;if(e){const t=new URL(e);i&&(t.hash=`t=${i}`);const s=!this.videoElement.paused;this.videoElement.src=t.toString(),s&&this.host.play()}}updateAuthTokenParam(){this.videoElement.src=function(e,i){if(!i)return e;const s=new URL(e);return s.searchParams.set(t.kX,i),s.toString()}(this.videoElement.src,this.host.packagedAuthToken)}createQualityLevels(){const t=this.packagedMedia?.playbackMp4s.permutations;if(!t)return[];const e=[],i=to({mp4Sources:t});return(t||[]).forEach(((t,s)=>{const r=Za(i?t.source.dimensions.width:t.source.dimensions.height);r&&-1===e.map((t=>t.quality)).indexOf(r)&&e.push({mp4SourceIndex:s,quality:r})})),eo(e)}getInitialQualityLevel(){const t=so();if(t){const e=this.host.qualityLevels.filter((e=>e.quality===t))[0]?.mp4SourceIndex;if(void 0!==e)return e}return-1}}class bo{constructor(t){this.handleVisibilityChange=t=>{t||this.host.playOutOfViewport||this.host.pause("background"),t&&this.host.mediaVisibilityController.attemptAutoplay()},this.onBeforeUnload=()=>{this.host.pause("background")},(this.host=t).addController(this)}hostConnected(){t.cp(this.handleVisibilityChange),t.aE.subscribe(this.onBeforeUnload)}hostDisconnected(){t.cq(this.handleVisibilityChange),t.aE.unsubscribe(this.onBeforeUnload)}}class Lo{constructor(){this.firstStartedAt=0,this.startedAt=null,this._laps=[],this._time=0}get paused(){return null===this.startedAt}get time(){if(this.paused)return this._time;const t=Date.now()-this.startedAt;return this._time+t}start(){this.firstStartedAt=this.firstStartedAt||Date.now(),this.paused&&(this.startedAt=Date.now())}pause(){this.paused||(this._time=this.time,this.startedAt=null)}reset(){this._laps=[],this.startedAt=null,this._time=0}lap(){const{_laps:t,time:e}=this,i=t[t.length-1],s={time:i?e-i.cumulativeTime:e,cumulativeTime:e};return t.push(s),s}}const Ao=[25,50,75,95,100],Ro=[2,3,5,10];function ko(t){const{host:e}=t,{videoElement:s}=e,r=e.isHls?e.src:s.src,{hostname:n,pathname:a,id:o}=function(t){let e,i,s="";try{const r=new URL(t);if(e=r.hostname,i=r.pathname,"v.redd.it"===e){const t=i.split("/");s=t[1]||"";const e=t.findIndex((t=>"asset"===t)),r=-1!==e?e+1:-1;r>=0&&r<t.length&&(s=t[r])}}catch{}return{hostname:e,pathname:i,id:s}}(r),{height:l,width:h}=function(t){return{height:t?.videoHeight||0,width:t?.videoWidth||0}}(s),d=h>=l?i.a.Landscape:i.a.Portrait;let c,u,f,g;e.isHls?(u=i.F.Hls,f=!!e.hlsController?.getCurAudioTrack(),c=e.hlsController.hls?.streamController?.fragCurrent?.byteRange):(u=i.F.Mp4,f=s?.mozHasAudio||Boolean(s?.webkitAudioDecodedByteCount)||Boolean(s?.audioTracks?.length)),Array.isArray(c)&&2===c.length&&(g=c[1]-c[0]);let m=i.M.VOD;e.gif&&(m=i.M.Gif),e.commentId&&!e.gif&&(m=i.M.Video);const p=uo.fullscreenElement===e||"fullscreen"===e.videoElement.webkitPresentationMode;return{duration:Math.round(1e3*s.duration),height:l,width:h,id:o,domain:n,orientation:d,origin:e.mediaOrigin,size:g,type:m,packaging_format:e.isHls?i.P.Hls:i.P.SingleFile,byte_range:Array.isArray(c)?c.toString():void 0,time:Math.round(1e3*s.currentTime),zoomed:p,format:u,has_audio:f,file_name:a,url:r,captions_present:e.mediaUI?.captionController?.captionsPresent}}function Co(t){const{host:e}=t,i=e.closest?.("shreddit-comment");return i?{id:i.getAttribute("thingid")??void 0,parent_id:i.getAttribute("parentid")??void 0}:{id:e.commentId}}function _o(){return{device_name:navigator.userAgent,os_name:navigator.platform,browser_name:navigator.userAgent,browser_version:navigator.appVersion}}function Io(e,{source:s,action:r,noun:n}){const{host:a}=e,{videoElement:o}=a,l=Po(e),h=l?`[${l.error_code}] ${l.error_message||l.reason||l.custom_response}`:void 0,d=a.hlsController?.getCurLevel()?.bitrate,c=a.hlsController?.getCurAudioTrack()?.bitrate,{height:u,width:f}=function(t){return{height:t?.clientHeight||0,width:t?.clientWidth||0}}(o),g=s===i.Q.Videoplayer&&r===i.b.Switch&&n===i.c.Bitrate;return{id:a.playbackId,sub_session_id:a.subSessionId,is_live:!1,is_looped:e.looped,state:xo(e),error:h,watch_duration_ms:Math.round(e.stopwatch.time),heartbeat_duration_ms:e.stopwatch.lap().time,playhead_offset_ms:Math.round(1e3*(o.duration-o.currentTime)),timestamp_ms:Math.round(1e3*o.currentTime),start_time_ms:e.stopwatch.firstStartedAt,volume:o.muted?0:Math.round(100*o.volume),total_bitrate:(d??0)+(c??0),video_bitrate:d,audio_bitrate:c,player_type:a.playerType??null,player_width:f,player_height:u,autoplay_setting:a.autoplay?i.A.Autoplay:i.A.Click,sequence_number:e.sequenceNumber+=1,user_bitrate_switch:g&&e.manualQualityChange,captions_enabled:a.mediaUI?.hasAttribute(t.h9.CAPTIONS_ENABLED)}}function Do(e){const{host:i}=e;return{created_timestamp:i.postCreatedAt?t.cN(i.postCreatedAt):void 0,domain:i.postDomain,id:i.postId||"",nsfw:!!i.postNsfw,promoted:!!i.postPromoted,score:i.postScore,spoiler:!!i.postSpoiler,subreddit_name:i.subredditName,subreddit_id:i.subredditId,type:i.postType}}function wo({instructionTimestamp:t}={}){return{event_timestamp:Date.now(),instruction_timestamp:t}}function Po(t){const{error:e}=t.host.videoElement,{errorController:i}=t.host;if(!e&&!i?.mediaErrorCode)return;return{reason:undefined,custom_response:undefined,error_code:i?.mediaErrorCode||e?.code,error_message:e?.message}}function xo(e){return e.host.mediaUI?.hasAttribute(t.h9.LOADING)?i.d.Buffering:e.host.mediaUI?.hasAttribute(t.h9.PLAYING)?i.d.Playing:e.host.mediaUI?.hasAttribute(t.h9.PAUSED)?i.d.Paused:i.d.Buffering}class Mo{get complete(){return 0===this._thresholds.length}constructor(t){const e=Array.isArray(t)?Array.from(t):[t];this._thresholds=e.sort(((t,e)=>t-e))}test(t){const e=[];for(;!this.complete;){const i=this._thresholds[0];if(t<i)return e;this._thresholds.shift(),e.push(i)}return e}}class Oo{constructor(t){this.stopwatch=new Lo,this.started=!1,this.looped=!1,this.sequenceNumber=-1,this._buffering=!1,this._playedInFullscreen=!1,this._playedWithSound=!1,this.watchPercentThresholdObserver=new Mo(Ao),this.watchSecondsThresholdObserver=new Mo(Ro),this.manualQualityChange=!1,(this.host=t).addController(this)}hostConnected(){}hostDisconnected(){}autoplay(){this.host.subSessionInstructionTime=Date.now();const e=this.host.mediaUI?.hasAttribute(t.h9.ENDED);e?this.trackEvent({action:i.b.Auto,noun:i.c.Replay}):this.trackEvent({action:i.b.View,noun:i.c.Autoplay})}clickPlay(){this.host.subSessionInstructionTime=Date.now();const e=this.host.mediaUI?.hasAttribute(t.h9.ENDED);e?this.trackEvent({action:i.b.Click,noun:i.c.Replay}):this.trackEvent({action:i.b.Click,noun:i.c.Play})}backgroundVideo(){this.stopwatch.pause(),this.trackEvent({action:i.b.Background,noun:i.c.Video}),this.tracePerformance()}scrollPause(){this.stopwatch.pause(),this.trackEvent({action:i.b.Scroll,noun:i.c.Pause}),this.tracePerformance()}clickPause(){this.stopwatch.pause(),this.trackEvent({action:i.b.Click,noun:i.c.Pause}),this.tracePerformance()}servedVideo(){this.trackEvent({action:i.b.Served,noun:i.c.Video}),this.tracePerformance()}startVideo(){this.stopwatch.start(),this.endRebuffer(),this.started=!0,this.trackEvent({action:i.b.Start,noun:i.c.Video}),this.checkPlayedWithSound(),this.host.subSessionInstructionTime=void 0}enterFullscreen(){this.trackEvent({action:i.T.IsFullyViewable,noun:i.e.Video}),this.started&&!this._playedInFullscreen&&this.trackEvent({action:i.T.PlayExpanded,noun:i.e.Video})}clickMute(t){this.trackEvent({action:i.T.Click,noun:t?i.e.Mute:i.e.Unmute}),this.checkPlayedWithSound()}clickCaptions(t){this.trackEvent({action:i.b.Click,noun:t?i.c.CaptionsEnabled:i.c.CaptionsDisabled})}startDownload(){this.trackEvent({action:i.b.Start,noun:i.c.Download})}endDownload(){this.trackEvent({action:i.b.End,noun:i.c.Download})}startRebuffer(){!this._buffering&&this.started&&(this.trackEvent({action:i.b.Start,noun:i.c.Rebuffer}),this._buffering=!0),this.stopwatch.pause()}endRebuffer(){this._buffering&&(this.trackEvent({action:i.b.End,noun:i.c.Rebuffer}),this._buffering=!1)}switchBitrate(){this.trackEvent({action:i.b.Switch,noun:i.c.Bitrate})}clickSeek(){this.trackEvent({action:i.T.Click,noun:i.e.Seek})}error(){const{errorController:t,videoElement:e}=this.host;(t?.mediaErrorCode||e.error?.code)&&this.trackEvent({action:i.b.Error,noun:i.c.Video})}timeUpdate(){const t=function(t){if(!t.started||t.watchPercentThresholdObserver?.complete)return[];const{currentTime:e,duration:i}=t.host.videoElement,s=100*(i>=e?e/i:0);return t.watchPercentThresholdObserver?.test(s)}(this);for(const e of t||[])this.trackEvent({action:`watch_${e}_percent`,noun:i.e.Video});const e=function(t){if(t.watchSecondsThresholdObserver?.complete)return[];const e=t.stopwatch.time/1e3;return t.watchSecondsThresholdObserver?.test(e)}(this);for(const t of e||[])this.trackEvent({action:`watch_${t}_seconds`,noun:i.e.Video})}checkPlayedWithSound(){this.started&&!this._playedWithSound&&this._isAudible()&&(this._playedWithSound=!0,this.trackEvent({action:i.T.PlayWithSound,noun:i.e.Video}))}viewRecommendationOverlay(){this.trackEvent({action:i.b.View,noun:i.c.RecommendationOverlay})}tracePerformance(){if(this.host.isBot)return;const e=t.b({source:i.Q.Videoplayer,action:i.b.Trace,noun:i.c.Performance},{platform:_o(),video_performance_report:{loading_report:{file_load_started_timestamp:this.host.subSessionPlayStartTime,file_load_completed_timestamp:this.host.subSessionPlayingStartTime},playback_report:{session_id_v2:this.host.subSessionId}}});t.i(this.host,e)}trackEvent({source:e=i.Q.Videoplayer,action:s,noun:r}){if(this.host.isBot)return;const n=t.b({source:e,action:s,noun:r},{comment:Co(this),media:ko(this),media_system_info:wo({instructionTimestamp:this.host.subSessionInstructionTime}),platform:_o(),playback:Io(this,{source:e,action:s,noun:r}),post:Do(this),subreddit:{name:this.host.subredditName,id:this.host.subredditId},video_error_report:Po(this)});t.i(this.host,n)}_isAudible(){const{videoElement:t}=this.host;return!t.muted&&t.volume>0}}const Fo=["click","pointerup","pointermove","focus","keydown","mouseleave"];class No{constructor(t){this.isIdle=!1,this._handleIdleChange=()=>{requestAnimationFrame((()=>{const t=this.host.mediaUI?.progressBar?.hasAttribute("dragging");return this.host.isMobile||this.host.matches(":hover")||t?!this.host.isMobile&&this.host.mediaUI?.controlBar?.matches(":hover")||t?(this._stopIdleTimer(),void this._setIdleState(!1)):void this._startIdleTimer():(this._stopIdleTimer(),void this._setIdleState(!0))}))},(this.host=t).addController(this)}async hostConnected(){this.host.gif||(Fo.forEach((t=>{this.host.addEventListener(t,this._handleIdleChange)})),this._startIdleTimer())}hostDisconnected(){this.host.gif||(Fo.forEach((t=>{this.host.removeEventListener(t,this._handleIdleChange)})),this._stopIdleTimer())}restartIdleTimer(){this._startIdleTimer()}_startIdleTimer(){this._stopIdleTimer(),this._idleTimeout=window.setTimeout((()=>{this._setIdleState(!0)}),1500)}_stopIdleTimer(){window.clearTimeout(this._idleTimeout),this._idleTimeout=void 0,this._setIdleState(!1)}_setIdleState(e){this.isIdle=e,this.host.mediaUI?.setAttr(t.h9.USER_IDLE,e)}}const Uo="@reddit/shreddit-player-media-volume";let $o;class Bo{constructor(t){this.setVolume=t=>{let e=parseFloat(Math.pow(t,2).toFixed(2));e=Math.min(Math.max(e,0),1),this.videoElement.volume=e,this.videoElement.muted=!e,Ho({volume:e,muted:this.videoElement.muted})},this.increaseVolume=()=>{const t=Math.min(this.sliderPosition+.1,1);this.setVolume(t)},this.decreaseVolume=()=>{const t=Math.max(this.sliderPosition-.1,0);this.setVolume(t)},this.toggleMute=()=>{const t=!this.videoElement.muted;this.videoElement.muted=t,this.host.telemetryController.clickMute(t),t||0===this.videoElement.volume&&(this.videoElement.volume=this.defaultVolumeSetting.volume),Ho({volume:this.videoElement.volume,muted:this.videoElement.muted})},(this.host=t).addController(this),this.videoElement=t.videoElement}hostConnected(){}hostDisconnected(){}get defaultVolumeSetting(){return{volume:.25,muted:!1}}initializeVolume(){const{gif:e}=this.host;if(e)return this.videoElement.volume=0,void(this.videoElement.muted=!0);const i=$o||Go(),s={...this.defaultVolumeSetting,...i}.volume,r=this.isEffectivelyMuted();this.host.syncPerf&&this.videoElement.volume===s&&this.videoElement.muted===r||(this.videoElement.volume=s,this.videoElement.muted=r),this.host.mediaUI?.setAttr(t.h9.MUTED,r)}isEffectivelyMuted(){const{autoplay:t,gif:e}=this.host;if(e)return!0;const i=$o||Go(),s={...this.defaultVolumeSetting,...i};return t&&!$o||s.muted||0===s.volume}get sliderPosition(){return this.videoElement.muted?0:Math.sqrt(this.videoElement.volume)}updateVolumeFillRate(){this.host.mediaUI?.style.setProperty(t.kY.VOLUME_FILL_RATE,this.sliderPosition.toString())}}function Go(){try{return JSON.parse(t.a8.getItem(Uo))}catch(t){return}}function Ho({volume:e,muted:i}){t.a8.setItem(Uo,JSON.stringify({volume:e,muted:i})),$o={volume:e,muted:i}}var Vo;!function(t){t.AVC="video/avc",t.VP9="video/vp9"}(Vo||(Vo={}));let Ko=s.ca({videoPlayerLabel:()=>"video player"});const{svg:jo}=t.a(),Wo=t.m(jo`<path d="M15.696 3H4.297c-1.819 0-3.3 1.48-3.3 3.3v7.4c0 1.82 1.48 3.301 3.3 3.301h11.4c1.82 0 3.301-1.48 3.301-3.301V6.3c0-1.819-1.48-3.3-3.302-3.3zM8.521 13.201a3.833 3.833 0 01-1.07.149 3.597 3.597 0 01-1.764-.443 3.386 3.386 0 01-1.277-1.214 3.19 3.19 0 01-.473-1.705c0-.615.155-1.177.464-1.687.31-.51.728-.912 1.256-1.208a3.48 3.48 0 011.726-.443 3.698 3.698 0 012.021.601L8.7 8.792a1.863 1.863 0 00-1.268-.485c-.336 0-.63.076-.883.228a1.553 1.553 0 00-.583.61 1.761 1.761 0 00-.203.837c0 .312.071.598.212.859a1.623 1.623 0 001.451.853c.251 0 .865-.07 1.3-.443l.685 1.572a3.6 3.6 0 01-.889.379v-.001zm6.541 0a3.833 3.833 0 01-1.07.149 3.597 3.597 0 01-1.764-.443 3.386 3.386 0 01-1.277-1.214 3.19 3.19 0 01-.473-1.705c0-.615.155-1.177.464-1.687.31-.51.728-.912 1.256-1.208a3.48 3.48 0 011.726-.443c.368 0 .726.053 1.074.158.344.104.656.249.936.436.006.004.01.012.005.019l-.699 1.53a1.863 1.863 0 00-1.268-.485c-.336 0-.63.076-.883.228a1.553 1.553 0 00-.583.61 1.761 1.761 0 00-.203.837c0 .312.071.598.212.859a1.623 1.623 0 001.451.853c.25 0 .855-.069 1.288-.434a.01.01 0 01.016.004l.68 1.559a3.6 3.6 0 01-.889.379l.001-.002z"></path>`,"0 0 20 20","closed-caption-fill"),{svg:zo}=t.a(),Yo=t.m(zo`<path d="M6.167 12.777a3.243 3.243 0 01-1.22-1.159 3.054 3.054 0 01-.452-1.629c0-.587.148-1.125.443-1.612a3.22 3.22 0 011.2-1.154A3.311 3.311 0 017.787 6.8a3.505 3.505 0 011.93.574l-.672 1.472a1.784 1.784 0 00-1.212-.464c-.321 0-.602.072-.843.217a1.486 1.486 0 00-.557.583c-.13.244-.194.51-.194.8 0 .298.068.571.203.82s.324.447.565.594c.241.147.515.22.82.22.24 0 .826-.067 1.241-.423l.655 1.501a3.45 3.45 0 01-.849.362 3.68 3.68 0 01-1.023.142 3.432 3.432 0 01-1.684-.423v.002zm5.809 0a3.243 3.243 0 01-1.22-1.159 3.054 3.054 0 01-.452-1.629c0-.587.148-1.125.443-1.612a3.22 3.22 0 011.2-1.154 3.311 3.311 0 011.649-.423 3.505 3.505 0 011.92.567.014.014 0 01.005.018l-.667 1.461a1.784 1.784 0 00-1.212-.464c-.321 0-.602.072-.843.217a1.486 1.486 0 00-.557.583c-.13.244-.194.51-.194.8 0 .298.068.571.203.82s.324.447.565.594c.241.147.515.22.82.22.238 0 .817-.066 1.231-.415.005-.004.013-.003.015.003l.65 1.489a3.45 3.45 0 01-.849.362 3.648 3.648 0 01-1.023.142 3.432 3.432 0 01-1.684-.423v.003zM15.7 17H4.3C2.481 17 1 15.52 1 13.7V6.3C1 4.481 2.48 3 4.3 3h11.4C17.519 3 19 4.48 19 6.3v7.4c0 1.819-1.48 3.3-3.3 3.3zM4.3 4.8c-.827 0-1.499.673-1.499 1.5v7.4c0 .827.672 1.5 1.499 1.5h11.4c.827 0 1.499-.673 1.499-1.5V6.3c0-.827-.672-1.5-1.499-1.5H4.3z"></path>`,"0 0 20 20","closed-caption"),{svg:qo}=t.a(),Xo=t.m(qo`<path d="M8.6 5.3a3.3 3.3 0 10-6.6 0v9.4a3.3 3.3 0 006.6 0V5.3zM18 5.3a3.3 3.3 0 00-6.6 0v9.4a3.3 3.3 0 006.6 0V5.3z"></path>`,"0 0 20 20","pause-fill"),{svg:Qo}=t.a(),Jo=t.m(Qo`<g clip-path="url(#a)"><path d="M12.998 15.9v-1.801a4.103 4.103 0 004.1-4.099 4.104 4.104 0 00-4.1-4.099V4.1c3.253 0 5.9 2.647 5.9 5.9 0 3.253-2.647 5.9-5.9 5.9zm0-7.9v4a2 2 0 100-4zM9.131 1.5c.91 0 1.757.721 1.757 1.752v13.496c0 1.031-.847 1.752-1.757 1.752-.336 0-.68-.098-.993-.316l-5.88-4.081c-2.866-1.988-2.866-6.219 0-8.207l5.88-4.08c.313-.217.658-.316.993-.316z"></path></g><defs><clipPath id="a"><path d="M0 0h20v20H0z"></path></clipPath></defs>`,"0 0 20 20","volume-on-fill",!0),Zo="@reddit/shreddit-player-media-captions";class tl{constructor(e){this.captionsPresent=!1,this.initializeCaptions=async()=>{if(!this.captionsEnabled())return;const{captionUrl:t,captionOverlay:e}=this.host;if(!t||!e?.captionsTarget)return void this._disableCaptionButton();const i=await this._requestCaptions();if(i?.ok){await async function(){"undefined"==typeof ResizeObserver&&(window.ResizeObserver=(await SML.di("./gXddY58AT3.js",import.meta.url,"gXddY58AT3"))?.default)}();const{CaptionsRenderer:t,parseResponse:s}=await SML.di("./B6Ai7g9fbR.js",import.meta.url,"B6Ai7g9fbR").then((function(t){return t.p})),r=await s(i);r?.cues?.length>0?(this.destroyCaptionsRenderer(),this.captionsRenderer=new t(e.captionsTarget),this.captionsRenderer.changeTrack(r),this.captionsPresent=!0,this._handleTimeUpdate(),this.videoElement?.addEventListener("timeupdate",this._handleTimeUpdate)):this._disableCaptionButton()}else this._disableCaptionButton()},this.captionsEnabled=()=>this.host.hasAttribute(t.h9.CAPTIONS_ENABLED),this.toggleCaptions=async()=>{const e=!this.captionsEnabled();var i;this.host.playerRoot?.telemetryController.clickCaptions(e),this.host.setAttr(t.h9.CAPTIONS_ENABLED,e),i=e,t.a8.setItem(Zo,i.toString()),e&&this.initializeCaptions()},this._disableCaptionButton=()=>{this.host.captionButton&&(this.host.captionButton.disabled=!0)},this._handleTimeUpdate=()=>{this.captionsRenderer&&(this.captionsRenderer.currentTime=this.videoElement?.currentTime||0)},this._requestCaptions=async()=>{const{captionUrl:e}=this.host;if(!e)return;const i=new Headers,s=this.host.playerRoot?.streamingAuthToken;return s&&i.set(t.k_,s),fetch(e,{headers:i})},(this.host=e).addController(this)}async hostConnected(){this.videoElement=this.host.videoElement,"true"===(t.a8.getItem(Zo)||"").toLowerCase()&&this.host.setAttr(t.h9.CAPTIONS_ENABLED)}hostDisconnected(){this.videoElement=void 0,this.captionsPresent=!1,this.destroyCaptionsRenderer()}destroyCaptionsRenderer(){this.captionsRenderer?.destroy(),this.captionsRenderer=void 0,this.videoElement?.removeEventListener("timeupdate",this._handleTimeUpdate)}}function el(t,e){return t.toString().padStart(e,"0")}var il;function sl(t){const e=Math.round(1e3*t)/1e3,i=Math.trunc(e/3600),s=Math.trunc(e%3600/60),r=Math.trunc(e%60),n=Number((e-Math.trunc(e)).toPrecision(3));return{[il.Hours]:i,[il.Minutes]:s,[il.Seconds]:r,[il.Fraction]:n}}function rl(t,e=!1,i=!1){if(Number.isNaN(t))return"0:00";const{hours:s,minutes:r,seconds:n}=sl(t),a=e?el(s,2):s,o=el(r,2),l=el(n,2);return s>0||i?`${a}:${o}:${l}`:`${r}:${l}`}function nl(t){const e=[],{hours:i,minutes:s,seconds:r}=sl(t),n=(t,e)=>1===t?e:`${e}s`;return i>0&&e.push(`${i} ${n(i,"hour")}`),s>0&&e.push(`${s} ${n(s,"minute")}`),(r>0||0===e.length)&&e.push(`${r} ${n(r,"second")}`),e.join(", ")}function al(t){return"number"==typeof t&&!Number.isNaN(t)}function ol(t){return Math.round(10*t)/10}!function(t){t.Hours="hours",t.Minutes="minutes",t.Seconds="seconds",t.Fraction="fraction"}(il||(il={}));const{ENDED:ll,ERROR:hl,FULLSCREEN:dl,MUTED:cl,PLAYING:ul,PAUSED:fl,SHOW_POSTER:gl}=t.h9;class ml{constructor(t){this._logException=g,this._started=!1,this.handleWaiting=()=>{this.videoElement&&this.videoElement.readyState<3&&(this.host.showLoadingSpinner(),this._started&&this.host.playerRoot?.telemetryController.startRebuffer())},this.handlePlay=()=>{this.host.setAttr(gl,!1),this.host.setAttr(fl,!1),this.host.setAttr(ll,!1)},this.handlePlaying=()=>{this._started=!0,this.host.hideLoadingSpinner(),this.host.setAttr(gl,!1),this.host.setAttr(ul),this.host.setAttr(fl,!1),this.host.setAttr(ll,!1),this.host.setAttr(hl,!1),this.host.playerRoot?.errorController?.resetRetryCount(),this.host.recommendationOverlayController.handlePlaying(),this.host.playerRoot&&(this.host.playerRoot.subSessionPlayingStartTime=this.host.playerRoot.subSessionPlayingStartTime||Date.now(),this.host.playerRoot.telemetryController.startVideo(),this.host.playerRoot.adController.play())},this.handlePause=()=>{this.host.setPausedState(),this.host.playerRoot?.adController.pause()},this.handleEnded=()=>{this.host.hideLoadingSpinner(),this.host.setAttr(ll),this.host.setPausedState(),this.host.recommendationOverlayController.handleEnded(),this.host.playerRoot&&this.host.playerRoot.pause("ended")},this.handleLoadStart=()=>{this.host.setAttr(hl,!1)},this.handleLoadedData=()=>{this.host.setAttr(hl,!1),this.host.playerRoot?.errorController?.resetRetryCount()},this.handleCanPlay=()=>{this.host.hideLoadingSpinner(),this.host.setAttr(hl,!1),this.host.playerRoot?.errorController?.resetRetryCount()},this.handleError=()=>{this.host.hideLoadingSpinner()},this.handleVolumeChange=()=>{if(this.host.gif&&this.host.playerRoot?.syncPerf)return;const{muted:t,volume:e}=this.videoElement||{};this.host.setAttr(cl,t||0===e),this.host.playerRoot?.volumeController.updateVolumeFillRate(),this.host.playerRoot?.adController.volumeChange()},this.handleFullscreenChange=t=>{t?.target===this.host.playerRoot&&(uo.fullscreenElement?this.host.setAttr(dl):this.host.setAttr(dl,!1),this.host.playerRoot?.adController.fullscreenChange())},this.handleTimeUpdate=()=>{al(this.videoElement?.currentTime)&&al(this.videoElement?.duration)&&(this.videoElement?.currentTime&&this.videoElement?.duration&&ol(this.videoElement.currentTime)>=ol(this.videoElement.duration)?this.host.setAttr(ll):this.host.setAttr(ll,!1),this.host.playerRoot?.telemetryController.timeUpdate(),this.host.playerRoot?.adController.timeUpdate(),this.host.recommendationOverlayController.handleTimeUpdate())},this.handleSeeking=()=>{this.host.playerRoot?.adController.seeking()},this.handleSeeked=()=>{this.host.playerRoot?.adController.seeked()},this.handlePresentationModeChange=()=>{const t="fullscreen"===this.videoElement?.webkitPresentationMode;this.host.setAttr(dl,t),this.host.playerRoot?.adController.fullscreenChange()},(this.host=t).addController(this)}hostConnected(){if(this.videoElement=this.host.videoElement,!this.videoElement){const t="MediaEventsController: videoElement is not defined";throw (this._logException({msg:t,debugOverlay:this.host.playerRoot?.debugOverlay}), new Error(t))}this.eventListeners.forEach((({eventName:t,callback:e})=>{this.videoElement?.addEventListener(t,e)})),uo.addEventListener("fullscreenchange",this.handleFullscreenChange)}hostDisconnected(){this.eventListeners.forEach((({eventName:t,callback:e})=>{this.videoElement?.removeEventListener(t,e)})),uo.removeEventListener("fullscreenchange",this.handleFullscreenChange),this.videoElement=void 0,this._started=!1}get eventListeners(){return[{eventName:"play",callback:this.handlePlay},{eventName:"playing",callback:this.handlePlaying},{eventName:"pause",callback:this.handlePause},{eventName:"ended",callback:this.handleEnded},{eventName:"loadstart",callback:this.handleLoadStart},{eventName:"loadeddata",callback:this.handleLoadedData},{eventName:"canplay",callback:this.handleCanPlay},{eventName:"error",callback:this.handleError},{eventName:"volumechange",callback:this.handleVolumeChange},{eventName:"timeupdate",callback:this.handleTimeUpdate},{eventName:"seeking",callback:this.handleSeeking},{eventName:"seeked",callback:this.handleSeeked},{eventName:"webkitpresentationmodechanged",callback:this.handlePresentationModeChange},{eventName:"waiting",callback:this.handleWaiting},{eventName:"stalled",callback:this.handleWaiting}]}}class pl{constructor(e){this._isActivated=!1,this._activateFeature=t.r,this.handlePlaying=()=>{this.hideRecommendationOverlay()},this.handleEnded=()=>{this.showRecommendationOverlay()},this.handleTimeUpdate=()=>{const{currentTime:t,duration:e}=this.videoElement||{};al(t)&&al(e)&&this.isPostSupported()&&(e-t<=3&&this._activateRecommendedMediaOverlay(),ol(t)>=ol(e)?this.showRecommendationOverlay():this.hideRecommendationOverlay())},this._activateRecommendedMediaOverlay=async()=>{if(this._isActivated||!this.isPostSupported())return;this._isActivated=!0;const{postId:e,subredditId:i,isMobile:s,playerRoot:r}=this.host,n=this.host.playerRoot?.closest("shreddit-app")?.pageType;try{await this._activateFeature({name:t.k$,routeParams:{postId:e,subredditId:i,limit:s?"1":"4",navigationSessionId:r?.navigationSessionId,pageType:n},renderMode:t.P.Contents,root:r??void 0})}catch(t){this._isActivated=!1}},(this.host=e).addController(this)}hostConnected(){this.videoElement=this.host.videoElement}hostDisconnected(){this.videoElement=void 0}showRecommendationOverlay(){this.host.hasAttribute(t.h9.SHOW_RECOMMENDATION_OVERLAY)||(this.host.setAttr(t.h9.SHOW_RECOMMENDATION_OVERLAY),this.host.playerRoot?.telemetryController?.viewRecommendationOverlay())}hideRecommendationOverlay(){this.host.setAttr(t.h9.SHOW_RECOMMENDATION_OVERLAY,!1)}isPostSupported(){return Boolean(!this.host.playerRoot?.postPromoted&&!this.host.playerRoot?.gif&&!this.host.playerRoot?.loop&&!this.host.playerRoot?.hideControls&&this.host.playerRoot?.postId&&this.host.playerRoot?.subredditId)}}class vl{constructor(e){this._timeRAF=void 0,this.skipTime=t=>{this.currentTime+=t},this.setTime=t=>{this.currentTime=t},this._updateTimeProperties=()=>{al(this.videoElement?.duration)&&(this._updateStyleProperties(),this._updateFormattedTime(),this.host.playerRoot?.adController.timeUpdate())},this._updateStyleProperties=()=>{if(!this.videoElement)return;const e=this.currentTime/this.videoElement.duration||0;this.host.style.setProperty(t.kY.PROGRESS_FILL_RATE,e.toFixed(4))},this._updateFormattedTime=()=>{if(!this.videoElement)return;const t=this.currentTime;if((this.formattedCurrentTime!==rl(t)||this.formattedDuration!==rl(this.videoElement.duration))&&(this.formattedCurrentTime=rl(t),this.formattedDuration=rl(this.videoElement.duration),this.host.currentTimeElement?.requestUpdate(),this.host.progressBar)){this.host.progressBar.ariaValueMax=this.formattedDuration,this.host.progressBar.ariaValueNow=this.formattedCurrentTime;const e=`${nl(t)} out of ${nl(this.videoElement.duration)}`;this.host.progressBar.ariaValueText=e}},this._cancelTimeUpdates=()=>{al(this._timeRAF)&&window.cancelAnimationFrame(this._timeRAF),this._timeRAF=void 0},this._requestTimeUpdates=()=>{this._timeRAF||this._requestTimeUpdate()},this._requestTimeUpdate=()=>{this.videoElement&&(this._updateTimeProperties(),this._timeRAF=window.requestAnimationFrame((()=>{void 0!==this._timeRAF&&this._requestTimeUpdate()})))},(this.host=e).addController(this),this.host.style.setProperty(t.kY.PROGRESS_FILL_RATE,"0")}hostConnected(){this.videoElement=this.host.videoElement,this.host.gif||(this.videoElement?.addEventListener("loadedmetadata",this._updateTimeProperties),this.videoElement?.addEventListener("timeupdate",this._updateTimeProperties),this.videoElement?.addEventListener("playing",this._requestTimeUpdates),this.videoElement?.addEventListener("pause",this._cancelTimeUpdates))}hostDisconnected(){this.host.gif||(this.videoElement?.removeEventListener("loadedmetadata",this._updateTimeProperties),this.videoElement?.removeEventListener("timeupdate",this._updateTimeProperties),this.videoElement?.removeEventListener("playing",this._requestTimeUpdates),this.videoElement?.removeEventListener("pause",this._cancelTimeUpdates)),this._cancelTimeUpdates(),this.videoElement=void 0}get currentTime(){return Math.min(this.videoElement?.currentTime||0,this.videoElement?.duration||0)}set currentTime(t){this.videoElement&&(this.host.playerRoot?.telemetryController?.clickSeek(),this.videoElement.currentTime=t,this._updateTimeProperties())}get duration(){return this.videoElement?.duration||0}}const yl=({icon:i,onClick:s,disabled:r,ariaLabel:n,ariaKeyshortcuts:a,ariaHidden:o,additionalClasses:l=""})=>e.x` <button class="min-h-[42px] min-w-[42px] p-0 bg-transparent border-none transition-all pointer-events-auto enabled:cursor-pointer enabled:hover:scale-[1.2] disabled:opacity-60${l?` ${l}`:""}" @click="${t=>{s&&(s(t),t.stopPropagation())}}" @keydown="${e=>{!s||"Enter"!==e.key&&" "!==e.key||(s(e),t.l0(e))}}" ?disabled="${r}" aria-label="${n||e.A}" aria-keyshortcuts="${a||e.A}" aria-hidden="${o||e.A}"> ${i} </button> `,El=({icon:t,additionalClasses:i="",size:s=e.I.Medium})=>t({attributes:{className:`text-white ease duration-150 ${i}`.trim()},size:s});var Tl=e.a`:host{--slider-bg:#434343;--slider-fill:#fff;position:absolute;inset:0}.poster-play-button svg{filter:drop-shadow(3px 3px 2px rgba(0, 0, 0, .5));-webkit-filter:drop-shadow(3px 3px 2px rgba(0, 0, 0, .5))}:host(:not([show-poster]):not([gif])) .poster-play-button,:host([gif][playing]) .poster-play-button{display:none}:host(:not([show-poster])) .poster-play-button,:host([loading]) .poster-play-button{display:none}:host(:not([loading])) ::slotted([slot=loading-spinner]){display:none!important}:host([show-poster]) .controls{display:none}.scrim{background:linear-gradient(to top,rgba(0,0,0,.4) 40px,transparent 80px)}:host(:not([captions-enabled])) .caption-disabled-icon,:host(:not([fullscreen])) .expand-icon,:host(:not([muted])) .volume-icon,:host(:not([paused])) .pause-icon,:host([captions-enabled]) .caption-enabled-icon,:host([ended]) .refresh-icon,:host([fullscreen]) .collapse-icon,:host([muted]) .mute-icon,:host([paused]:not([ended])) .play-icon{display:inline-block}:host([user-idle]:not([paused])) .disappearing-controls,:host([user-idle]:not([paused])) .scrim{opacity:0;pointer-events:none}:host ::slotted([slot=recommendation-overlay]){transition:opacity .2s}:host([show-rec-overlay]) ::slotted([slot=recommendation-overlay]){opacity:1;visibility:visible;pointer-events:auto}:host(:not([show-rec-overlay])) ::slotted([slot=recommendation-overlay]){opacity:0;visibility:hidden;pointer-events:none}:host([captions-enabled]) shreddit-caption-overlay{display:block}:host(:not([captions-enabled])) shreddit-caption-overlay{display:none}:host([loading]) shreddit-caption-overlay,:host([show-poster]) shreddit-caption-overlay{display:none}:host(:not([error])) shreddit-error-overlay{display:none}`,Sl=e.a`:where([data-part=captions]),:where([part=captions]){--overlay-padding:1%;--cue-color:white;--cue-bg-color:rgba(0, 0, 0, 0.75);--cue-font-size:16px;--cue-line-height:calc(var(--cue-font-size) * 1.2);--cue-padding-x:0.5rem;--cue-padding-y:0.5rem;position:absolute;inset:0;contain:content;margin:var(--overlay-padding);font-size:var(--cue-font-size);font-family:sans-serif;box-sizing:border-box;pointer-events:none;user-select:none;word-spacing:normal;word-break:break-word}:where([data-part=captions]>[data-part=cue-display]),:where([part=captions]>[part=cue-display]){position:absolute;bottom:0;direction:ltr;overflow:visible;contain:content;width:var(--cue-width,auto);height:var(--cue-height,auto);box-sizing:border-box;transform:var(--cue-transform);text-align:var(--cue-text-align);writing-mode:var(--cue-writing-mode,unset);white-space:pre-line;unicode-bidi:plaintext;min-width:min-content;min-height:min-content}:where([data-dir=rtl][data-part=cue-display]),:where([data-dir=rtl][part=cue-display]){direction:rtl}:where([data-part=captions]>[data-part=cue-display]>[data-part=cue]),:where([part=captions]>[part=cue-display]>[part=cue]){display:inline-block;padding:var(--cue-padding-y) var(--cue-padding-x);line-height:var(--cue-line-height);background-color:var(--cue-bg-color);box-sizing:border-box;color:var(--cue-color);box-shadow:var(--cue-box-shadow);white-space:var(--cue-white-space,pre-wrap);outline:var(--cue-outline);text-shadow:var(--cue-text-shadow)}:where([data-part=captions][data-part=cue-display][data-vertical][data-part=cue]),:where([part=captions][part=cue-display][data-vertical][part=cue]){padding:var(--cue-padding-x) var(--cue-padding-y)}`;let bl=class extends e.s{constructor(){super(...arguments),this.captionsTarget=document.createElement("div")}connectedCallback(){super.connectedCallback(),this.captionController?.initializeCaptions()}disconnectedCallback(){super.disconnectedCallback(),this.captionController?.destroyCaptionsRenderer(),this.captionsTarget.innerHTML=""}render(){return e.x`${this.captionsTarget}`}};bl.styles=[t.t,Sl],t._([t.n()],bl.prototype,"captionController",void 0),bl=t._([t.e("shreddit-caption-overlay")],bl);let Ll=class extends e.s{render(){return e.x` <span class="whitespace-nowrap font-semibold text-white"> <span>${this.timeController?.formattedCurrentTime??"0:00"}</span><span class="embed-m:hidden"> / ${this.timeController?.formattedDuration??"0:00"}</span> </span> `}};Ll.styles=[t.t],t._([t.n()],Ll.prototype,"timeController",void 0),Ll=t._([t.e("shreddit-current-time")],Ll);let Al=class extends e.s{render(){if(void 0===this.mediaErrorCode)return;let t;return t=this.mediaErrorCode===MediaError.MEDIA_ERR_NETWORK?"This video is no longer available.":"This video cannot be played.",e.x` <p class="h-full w-full flex justify-center items-center text-white">${t}</p> `;}};Al.styles=[t.t],t._([t.n({type:Number})],Al.prototype,"mediaErrorCode",void 0),Al=t._([t.e("shreddit-error-overlay")],Al);let Rl=class extends e.s{constructor(){super(...arguments),this.isMobile=!1,this.loadedPreviewVideo=!1,this._onCanPlay=()=>{this.videoElement.style.display="block"}}disconnectedCallback(){super.disconnectedCallback(),this.videoElement?.removeEventListener("canplay",this._onCanPlay)}loadPreviewVideo(){!this.loadedPreviewVideo&&this.videoElement&&(this.loadedPreviewVideo=!0,this.videoElement.load(),this.videoElement.addEventListener("canplay",this._onCanPlay))}render(){return e.x` ${this.isMobile||!this.preview?e.A:e.x` <video muted playsinline preload="none" src="${this.preview}" class="bg-black border border-1 border-solid rounded-2 mb-2xs hidden w-[130px] max-h-[130px] h-auto"></video> `} <span class="formatted-current-time m-auto text-14 font-semibold px-2xs bg-black bg-opacity-55 text-white rounded-1 whitespace-nowrap">0:00</span> `}};Rl.styles=[e.a`:host{display:inline-block;contain:content}:host(:not([preview])) video,:host([hidden]) video{display:none}`,t.t],t._([t.n({type:String})],Rl.prototype,"preview",void 0),t._([t.n({type:Boolean})],Rl.prototype,"isMobile",void 0),t._([t.h()],Rl.prototype,"loadedPreviewVideo",void 0),t._([t.a2("video")],Rl.prototype,"videoElement",void 0),t._([t.a2("span.formatted-current-time")],Rl.prototype,"formattedCurrentTime",void 0),Rl=t._([t.e("shreddit-preview-video-lazy")],Rl);let kl=class extends e.s{constructor(){super(...arguments),this._isPointerDown=!1,this.idleUpdate=!1,this._handlePointerDown=e=>{t.l0(e),this._isPointerDown=!0,this.onPointerDownMove?.(e),this.idleUpdate||this.onChange?.(e),this.dispatchEvent(new Event("slider-dragstart"))},this._handlePointerUp=e=>{this._isPointerDown&&(t.l0(e),this._isPointerDown=!1,this.onChange?.(e),this.dispatchEvent(new Event("slider-dragend")))},this._handlePointerMove=e=>{this._isPointerDown&&(t.l0(e),this.onPointerDownMove?.(e),this.idleUpdate||this.onChange?.(e))}}connectedCallback(){super.connectedCallback(),document.addEventListener("pointerup",this._handlePointerUp),document.addEventListener("pointercancel",this._handlePointerUp),document.addEventListener("pointermove",this._handlePointerMove)}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("pointerup",this._handlePointerUp),document.removeEventListener("pointercancel",this._handlePointerUp),document.removeEventListener("pointermove",this._handlePointerMove)}render(){return e.x` <slot class="touch-none flex w-full h-full items-center justify-center cursor-pointer${this.additionalClasses?` ${this.additionalClasses}`:""}" @pointerdown="${this._handlePointerDown}"></slot> `}};kl.styles=[t.t],t._([t.n({type:Boolean})],kl.prototype,"idleUpdate",void 0),t._([t.n()],kl.prototype,"onChange",void 0),t._([t.n()],kl.prototype,"onPointerDownMove",void 0),t._([t.n()],kl.prototype,"additionalClasses",void 0),kl=t._([t.e("shreddit-slider-element")],kl);let Cl=class extends e.s{constructor(){super(...arguments),this.isMobile=!1,this._updateTime=t=>{const{left:e,width:i}=this.getBoundingClientRect(),s=Math.min((t.x-e)/i,1),r=(this.timeController?.duration??0)*s;Number.isNaN(r)||(this.timeController.currentTime=r)},this._handleSliderChange=t=>{this._updateTime(t),this._updatePreviewVideoPosition(t)},this._handleDragStart=()=>{this.setAttribute("dragging","")},this._handleDragEnd=()=>{this.removeAttribute("dragging")},this._handlePointerDownMove=t=>{this._updateSliderBallPosition(t),this._updatePreviewVideoPosition(t)},this._handleMouseEnter=()=>{this.isMobile||this.setAttribute("hovered","")},this._handleMouseLeave=()=>{this.isMobile||this.removeAttribute("hovered")},this._updateSliderBallPosition=e=>{const{left:i,width:s}=this.getBoundingClientRect(),r=Math.max(0,Math.min(e.x-i,s));this.style.setProperty(t.kY.SLIDER_BALL_LEFT_PX,`${r}px`)},this._updatePreviewVideoPosition=e=>{const{left:i,width:s}=this.getBoundingClientRect(),r=Math.max(0,Math.min((e.x-i)/s,1)),n=(this.timeController?.duration||0)*r;this.previewVideoLazy?.loadPreviewVideo(),this.previewVideoLazy?.videoElement&&(this.previewVideoLazy.videoElement.currentTime=n),this.previewVideoLazy?.formattedCurrentTime&&(this.previewVideoLazy.formattedCurrentTime.innerText=rl(n));const a=Math.max(0,Math.min(e.x-i,s));this.previewVideoLazy?.style.setProperty(t.kY.PREVIEW_VIDEO_LEFT_PX,`${a}px`)}}renderPreviewVideo(){return e.x` <shreddit-preview-video-lazy .isMobile="${this.isMobile}" .preview="${this.preview}" class="embed-s:hidden absolute transition-opacity bottom-2xl left-0 -translate-x-1/2 text-center flex-col pointer-events-none" style="left:var(${t.kY.PREVIEW_VIDEO_LEFT_PX});will-change:left"></shreddit-preview-video-lazy> `}render(){return e.x` <shreddit-slider-element class="h-full w-full flex items-center" .onChange="${this._handleSliderChange}" .onPointerDownMove="${this._handlePointerDownMove}" @mouseenter="${this._handleMouseEnter}" @mouseleave="${this._handleMouseLeave}" @mousemove="${this._updatePreviewVideoPosition}" @slider-dragstart="${this._handleDragStart}" @slider-dragend="${this._handleDragEnd}" idleUpdate> <div class="bg-[--slider-bg] h-[4px] w-full relative cursor-pointer"> <div class="bg-[--slider-fill] h-full w-full origin-left cursor-pointer" style="transform:scaleX(var(${t.kY.PROGRESS_FILL_RATE}));will-change:transform"></div> <div class="slider-ball absolute top-1/2 left-0 w-lg h-lg rounded-full cursor-pointer bg-[--slider-fill] -translate-x-1/2 -translate-y-1/2 scale-75" style="will-change:left"></div> </div> </shreddit-slider-element> ${this.renderPreviewVideo()} `}};Cl.styles=[e.a`:host shreddit-preview-video-lazy{display:none}:host([dragging]) shreddit-preview-video-lazy,:host([hovered]) shreddit-preview-video-lazy{display:flex}:host(:not([dragging])) shreddit-slider-element .slider-ball{left:calc(var(--progress-fill-rate) * 100%)}:host([dragging]) shreddit-slider-element .slider-ball{left:var(--slider-ball-left-px)}`,t.t],t._([t.n()],Cl.prototype,"timeController",void 0),t._([t.n({type:String})],Cl.prototype,"preview",void 0),t._([t.n({type:Boolean})],Cl.prototype,"isMobile",void 0),t._([t.a2("shreddit-preview-video-lazy")],Cl.prototype,"previewVideoLazy",void 0),Cl=t._([t.e("shreddit-progress-bar")],Cl);let _l=class extends e.s{constructor(){super(...arguments),this.autoplayPref=!1,this.isLoggedInUser=!1,this.hideAutoplayToggle=!1,this.qualityLevels=[],this.currentQualityLevelIndex=-1,this.rootSelector="shreddit-player",this.isMenuOpen=!1}showSettings(){this.isMenuOpen=!0}hideSettings(){this.isMenuOpen=!1}handleQualityChange(e,i){e.stopPropagation();const s=i?"hlsLevelIndex"in i?i.hlsLevelIndex:i.mp4SourceIndex:-1;var r;this.mediaActionsController?.setQualityLevel(s),r=i?.quality,r?t.a8.setItem(Ja,r.toString()):t.a8.removeItem(Ja);const n=t.bN(this,this.rootSelector);n&&(n.telemetryController.manualQualityChange=!0)}renderSettings(){const i=t=>this.currentQualityLevelIndex===("hlsLevelIndex"in t?t.hlsLevelIndex:t.mp4SourceIndex),s="px-sm py-xs flex justify-center border-none bg-transparent cursor-pointer text-white",r=this.isLoggedInUser&&!this.hideAutoplayToggle,n=e.x` ${r?e.x` <button class="${s}" @click="${()=>(async function({newPref:e,dispatchEvent:i,onSuccess:s}) {try{await To({operation:t.O.UpdateAccountPreferences,variables:{input:{isVideoAutoplayEnabled:e}}}),s?.()}catch(e){i(t.c("faceplate-alert",{level:t.a5.error,cause:"uncategorized",message:"Error changing autoplay preference"}))}})({newPref:!this.autoplayPref,dispatchEvent:this.dispatchEvent,onSuccess:()=>{this.autoplayPref=!this.autoplayPref}})}" data-testid="autoplay-toggle"> ${this.renderCheckmark(this.autoplayPref)} <span> ${"Autoplay"}</span> </button> <div class="h-[1px] w-[calc(100%-1rem)] bg-[#82959b] opacity-50 mx-auto"></div> `:e.A} `;return e.x` <div class="absolute flex flex-col bg-black bg-opacity-60 bottom-[42px] -left-1/2 min-w-4xl transition-all rounded-1 ${this.isMenuOpen?"opacity-100":"opacity-0 pointer-events-none"}" aria-hidden="${!this.isMenuOpen||e.A}" inert="${!this.isMenuOpen||e.A}"> ${n} ${this.qualityLevels?.map((t=>e.x` <button data-testid="quality-option" class="${s}" @click="${e=>this.handleQualityChange(e,t)}"> ${this.renderCheckmark(i(t))} <span>${t.quality}p</span> </button> `))} <button data-testid="auto-quality-option" class="${s}" @click="${t=>this.handleQualityChange(t)}"> ${this.renderCheckmark(-1===this.currentQualityLevelIndex)} <span> ${"Auto"}</span> </button> </div> `;}renderCheckmark(t){return t?e.x` <span class="pr-2xs" data-testid="checkmark"> ${h.c({size:e.I.ExtraSmall})} </span> `:e.A}render(){return e.x` <div class="embed-s:hidden" @mouseleave="${this.hideSettings}" @blur="${this.hideSettings}"> ${yl({icon:El({icon:d.s}),onClick:()=>this.isMenuOpen?this.hideSettings():this.showSettings(),ariaLabel:"Settings"})} ${this.renderSettings()} </div> `;}};_l.styles=[e.a`:host{position:relative}`,t.t],t._([t.n()],_l.prototype,"mediaActionsController",void 0),t._([t.n({type:Boolean})],_l.prototype,"autoplayPref",void 0),t._([t.n({type:Boolean})],_l.prototype,"isLoggedInUser",void 0),t._([t.n({type:Boolean,attribute:"hide-autoplay-toggle"})],_l.prototype,"hideAutoplayToggle",void 0),t._([t.n()],_l.prototype,"qualityLevels",void 0),t._([t.n()],_l.prototype,"currentQualityLevelIndex",void 0),t._([t.n({type:String})],_l.prototype,"rootSelector",void 0),t._([t.h()],_l.prototype,"isMenuOpen",void 0),_l=t._([t.e("shreddit-video-settings")],_l);let Il=class extends e.s{constructor(){super(...arguments),this.isMobile=!1,this._updateVolume=e=>{t.l0(e);const{height:i=0,y:s=0}=this.sliderTrack?.getBoundingClientRect()??{};if(!i)return;const r=Math.min(1,Math.max(0,(s+i-e.y)/i));this.mediaActionsController?.setVolume(r)}}render(){const i=this.isMobile?e.A:e.x` <div class="slider-element-wrapper absolute rounded-2 h-[90px] bottom-[44px] py-md px-xs opacity-[--slider-opacity] transition-opacity bg-[rgba(0,0,0,0.6)]"> <shreddit-slider-element class="slider-track flex items-center h-full w-full box-border" additionalClasses="px-[10px]" .onChange="${this._updateVolume}"> <div class="bg-[--slider-bg] w-[2px] h-full relative flex justify-center"> <div class="bg-[--slider-fill] h-full w-full origin-bottom" style="transform:scaleY(var(${t.kY.VOLUME_FILL_RATE}));will-change:transform"></div> <div class="absolute bottom-0 w-md h-md translate-y-1/2 rounded-full bg-white scale-90" style="bottom:calc(var(${t.kY.VOLUME_FILL_RATE}) * 100%);will-change:bottom"></div> </div> </shreddit-slider-element> </div> `;return e.x` <div class="relative flex justify-center"> <slot></slot> ${i} </div> `}};Il.styles=[e.a`:host .slider-element-wrapper{display:none}:host(:hover) .slider-element-wrapper{display:block}`,t.t],t._([t.n()],Il.prototype,"mediaActionsController",void 0),t._([t.n({type:Boolean})],Il.prototype,"isMobile",void 0),t._([t.a2(".slider-track")],Il.prototype,"sliderTrack",void 0),Il=t._([t.e("shreddit-volume-slider")],Il);let Dl=class extends e.s{constructor(){super(...arguments),this.mediaEventsController=new ml(this),this.timeController=new vl(this),this.captionController=new tl(this),this.recommendationOverlayController=new pl(this),this.autoplay=!1,this.autoplayPref=!1,this.gif=!1,this.hideControls=!1,this.hideFullscreenButton=!1,this.hideAutoplayToggle=!1,this.isMobile=!1,this.isLoggedInUser=!1,this.qualityLevels=[],this.currentQualityLevelIndex=-1,this.hideGifIcon=!1,this.rootSelector="shreddit-player",this.gifToggle=t=>{this.mediaActionsController?.togglePlay(),t.stopImmediatePropagation(),t.preventDefault()},this.renderGifControls=()=>e.x`${this.autoplay?e.A:e.x`${this.renderPosterPlayButton()} <div class="controls"> ${yl({icon:e.x` ${El({icon:a.p,additionalClasses:"hidden play-icon"})} ${El({icon:Xo,additionalClasses:"hidden pause-icon"})} `,additionalClasses:"absolute left-0 bottom-0",onClick:t=>this.gifToggle(t)})} </div>`} ${this.hideGifIcon?e.A:yl({icon:El({icon:a.g}),disabled:!0,ariaHidden:!0,additionalClasses:"absolute right-0 bottom-0"})} ${this.renderErrorOverlay()}`}connectedCallback(){super.connectedCallback(),this.autoplay||this.playerRoot?.hasHadPlayAttempt||(this.showPoster(),this.setPausedState()),this.playerRoot?.volumeController&&this.setAttr(t.h9.MUTED,this.playerRoot.volumeController.isEffectivelyMuted())}disconnectedCallback(){super.disconnectedCallback(),this.hideLoadingSpinner()}get playerRoot(){return t.bN(this,this.rootSelector)}renderPosterPlayButton(){return yl({icon:e.x` ${El({icon:a.p,size:e.I.ExtraLarge})} `,onClick:t=>{t?.preventDefault(),t?.stopImmediatePropagation(),this.mediaActionsController?.play()},ariaLabel:"Play",additionalClasses:"poster-play-button absolute inset-0 flex items-center justify-center cursor-pointer pointer-events-auto"});}showPoster(){this.setAttr(t.h9.SHOW_POSTER)}showLoadingSpinner(){this.hasAttribute(t.h9.LOADING)||(this._loadingSpinnerRAF=requestAnimationFrame((()=>{this.videoElement&&this.videoElement.readyState<3&&this.setAttr(t.h9.LOADING)})))}hideLoadingSpinner(){this._loadingSpinnerRAF&&(cancelAnimationFrame(this._loadingSpinnerRAF),this._loadingSpinnerRAF=void 0),this.hasAttribute(t.h9.LOADING)&&requestAnimationFrame((()=>{this.setAttr(t.h9.LOADING,!1)}))}renderCaptionOverlay(){return e.x`<shreddit-caption-overlay class="pointer-events-none absolute left-0 right-0 top-0 bottom-[42px]" .captionController="${this.captionController}"></shreddit-caption-overlay>`}renderControls(){if(this.hideControls)return;const t=yl({icon:e.x` ${El({icon:a.p,additionalClasses:"hidden play-icon"})} ${El({icon:Xo,additionalClasses:"hidden pause-icon"})} ${El({icon:l.r,additionalClasses:"hidden refresh-icon"})} `,onClick:this.mediaActionsController?.togglePlay,ariaLabel:"Toggle playback",ariaKeyshortcuts:"k",additionalClasses:"play-pause-button"}),i=e.x` <shreddit-progress-bar class="embed-s:hidden relative flex items-center h-full w-full mx-md" .timeController="${this.timeController}" ?isMobile="${this.isMobile}" preview="${this.preview}" tabindex="0" aria-label="${"Media time"}" aria-valuemin="0"></shreddit-progress-bar> `,s=e.x` <shreddit-current-time class="mr-xs" .timeController="${this.timeController}"></shreddit-current-time> `,h=this.isMobile?e.x``:e.x` <shreddit-video-settings .mediaActionsController="${this.mediaActionsController}" .qualityLevels="${this.qualityLevels}" .currentQualityLevelIndex="${this.currentQualityLevelIndex}" .rootSelector="${this.rootSelector}" ?hide-autoplay-toggle="${this.hideAutoplayToggle}" ?autoplayPref="${this.autoplayPref}" ?isLoggedInUser="${this.isLoggedInUser}"></shreddit-video-settings>`,d=yl({icon:e.x` ${El({icon:n.e,additionalClasses:"hidden expand-icon"})} ${El({icon:r.c,additionalClasses:"hidden collapse-icon"})} `,onClick:this.mediaActionsController?.toggleFullscreen,ariaLabel:"Toggle fullscreen",ariaKeyshortcuts:"f",additionalClasses:"fullscreen-button "+(this.hideFullscreenButton?"invisible":"")}),c=yl({additionalClasses:"embed-s:hidden caption-button",icon:e.x` ${El({icon:Wo,additionalClasses:"hidden caption-enabled-icon"})} ${El({icon:Yo,additionalClasses:"hidden caption-disabled-icon"})} `,onClick:this.mediaActionsController?.toggleCaptions,ariaLabel:"Toggle captions",ariaKeyshortcuts:"c"}),u=e.x` <shreddit-volume-slider .mediaActionsController="${this.mediaActionsController}" ?isMobile="${this.isMobile}"> ${yl({icon:e.x` ${El({icon:Jo,additionalClasses:"hidden volume-icon"})} ${El({icon:o.v,additionalClasses:"hidden mute-icon"})} `,onClick:this.mediaActionsController?.toggleMute,ariaLabel:"Toggle volume",ariaKeyshortcuts:"m",additionalClasses:"mute-button"})} </shreddit-volume-slider> `;return e.x` <div class="controls absolute inset-0 outline-none" tabindex="-1"> <div class="scrim absolute inset-0 pointer-events-none transition-opacity duration-300"></div> <div class="control-bar flex items-center justify-between absolute bottom-0 w-full h-[${50}px] box-border px-2xs pointer-events-auto"> ${""} <div class="disappearing-controls embed-s:justify-between flex items-center w-full h-full transition-opacity duration-300"> ${t} ${i} ${s} ${c} ${h} ${d} </div> ${""} <div class="flex items-center h-full">${u}</div> </div> </div> `}renderRecommendationOverlay(){return e.x`<slot name="recommendation-overlay"></slot>`}renderErrorOverlay(){return e.x` <shreddit-error-overlay class="bg-black flex items-center justify-center absolute inset-0"></shreddit-error-overlay> `}setPausedState(){this.setAttr(t.h9.PAUSED),this.setAttr(t.h9.PLAYING,!1),this.hideLoadingSpinner()}setAttr(t,e=!0){!1===e?this.removeAttribute(t):this.setAttribute(t,!0===e?"":e)}render(){return e.x` <slot name="loading-spinner"></slot> ${this.gif?this.renderGifControls():e.x` ${this.renderPosterPlayButton()} ${this.renderCaptionOverlay()} ${this.renderErrorOverlay()} ${this.renderRecommendationOverlay()} ${this.renderControls()} `} `}};Dl.styles=[Tl,t.t],t._([t.n()],Dl.prototype,"videoElement",void 0),t._([t.n()],Dl.prototype,"mediaActionsController",void 0),t._([t.n({type:Boolean})],Dl.prototype,"autoplay",void 0),t._([t.n({type:Boolean})],Dl.prototype,"autoplayPref",void 0),t._([t.n({type:Boolean})],Dl.prototype,"gif",void 0),t._([t.n({type:Boolean})],Dl.prototype,"hideControls",void 0),t._([t.n({type:Boolean})],Dl.prototype,"hideFullscreenButton",void 0),t._([t.n({type:Boolean,attribute:"hide-autoplay-toggle"})],Dl.prototype,"hideAutoplayToggle",void 0),t._([t.n({type:Boolean})],Dl.prototype,"isMobile",void 0),t._([t.n({type:Boolean})],Dl.prototype,"isLoggedInUser",void 0),t._([t.n({type:String,attribute:"caption-url"})],Dl.prototype,"captionUrl",void 0),t._([t.n({type:String})],Dl.prototype,"preview",void 0),t._([t.n()],Dl.prototype,"qualityLevels",void 0),t._([t.n()],Dl.prototype,"currentQualityLevelIndex",void 0),t._([t.n()],Dl.prototype,"postId",void 0),t._([t.n()],Dl.prototype,"subredditId",void 0),t._([t.n({type:Boolean})],Dl.prototype,"hideGifIcon",void 0),t._([t.n({type:String})],Dl.prototype,"rootSelector",void 0),t._([t.a2(".control-bar")],Dl.prototype,"controlBar",void 0),t._([t.a2("shreddit-current-time")],Dl.prototype,"currentTimeElement",void 0),t._([t.a2("shreddit-progress-bar")],Dl.prototype,"progressBar",void 0),t._([t.a2("shreddit-video-settings")],Dl.prototype,"videoSettings",void 0),t._([t.a2("shreddit-caption-overlay")],Dl.prototype,"captionOverlay",void 0),t._([t.a2(".caption-button")],Dl.prototype,"captionButton",void 0),t._([t.a2("shreddit-error-overlay")],Dl.prototype,"errorOverlay",void 0),Dl=t._([t.e("shreddit-media-ui")],Dl);let wl=class extends e.s{constructor(){super(...arguments),this.debugLogs=[]}log(t,e){this.debugLogs.push({key:t,value:e}),this.requestUpdate()}render(){return e.x` <div class="flex flex-col bg-black-opacity-80 text-white p-sm"> <h3>Debug info</h3> <div class="grid grid-cols-[1fr_4fr] gap-xs" data-testid="debug-logs"> ${this.debugLogs.map((t=>e.x` <div>${t.key}</div> <div>${t.value}</div> `))} </div> </div> `}};wl.styles=[t.t,e.a`:host{position:absolute;top:0;left:0;right:0;bottom:50px;max-height:100%;overflow-y:auto}`],t._([t.n({type:Array})],wl.prototype,"debugLogs",void 0),wl=t._([t.e("shreddit-player-debug-overlay")],wl),(({country:e,_setCookie:i=t.N})=>{const s=t.kZ;if(!e||!t.aO({country:e,name:s}))return;i({name:s,value:function(){const t=document.createElement("video"),e=[];""!==t.canPlayType('video/mp4; codecs="avc1.42E01E"')&&e.push(Vo.AVC);""!==t.canPlayType('video/webm; codecs="vp9"')&&e.push(Vo.VP9);return e}().join(","),options:t.Q,country:e})})({country:document.querySelector("shreddit-app")?.getAttribute("country")??void 0});const Pl="shreddit-player";let xl=class extends e.s{constructor(){super(...arguments),this.playbackId=t.ab(),this.subSessionId=t.ab(),this.navigationSessionId=t.ab(),this.videoElement=document.createElement("video"),this.initialized=!1,this.rootSelector=Pl,this.hasHadPlayAttempt=!1,this.playCount=0,this._disconnected=!1,this.errorControllerLegacy=new p(this),this.errorControllerNew=new T(this),this.hlsController=new ro(this),this.mediaActionsController=new fo(this),this.mediaSyncController=new po(this),this.mediaVisibilityController=new Eo(this),this.packagedMediaController=new So(this),this.telemetryController=new Oo(this),this.adController=new u(this),this.userIdleController=new No(this),this.volumeController=new Bo(this),this.gestureController=new S(this),this.mediaHotkeyController=new go(this),this.pageController=new bo(this),this.src="",this.autoplay=!1,this.autoplayPref=!1,this.hideAutoplayToggle=!1,this.gif=!1,this.loop=!1,this.hideControls=!1,this.hideFullscreenButton=!1,this.isMobile=!1,this.isBot=!1,this.poster="",this.isLoggedInUser=!1,this.singlePlayback=!1,this.playOutOfViewport=!1,this.objectFit="contain",this.shouldRoundBackground=!1,this.errorImprovements=!1,this.idleAutoplay=!1,this.syncPerf=!1,this.hideGifIcon=!1,this.debug=!1,this.qualityLevels=[],this.currentQualityLevelIndex=-1}connectedCallback(){super.connectedCallback(),this.videoElement.poster=this.poster,this._disconnected&&this.reconnect()}disconnectedCallback(){this.stop(),this._disconnected=!0,this.initialized=!1,super.disconnectedCallback()}firstUpdated(){this.syncPerf||this.volumeController.initializeVolume()}reconnect(){this.adController.fromReconnect=!0,this.autoplay||this.mediaUI?.setPausedState(),this._disconnected=!1}get isMp4(){return this.packagedMediaController.hasPackagedMedia}get isHls(){return this.hlsController.isHlsStream&&!this.isMp4}get errorController(){return this.errorImprovements?this.errorControllerNew:this.errorControllerLegacy}shouldUseFakePosterImage(){return this.gif&&!this.autoplay&&!this.poster}initializeVideoElement(){if(this.initialized)return;this.initialized=!0,this.isMp4&&this.packagedMediaController.initialize(),this.isMp4||this.isHls||(this.videoElement.src=this.src),this._restoreVideoTime(),this.videoElement.playsInline=!0;this.shouldUseFakePosterImage()?(this.videoElement.preload=t.kV.AUTO,this.videoElement.src=this.videoElement.src.concat("#t=.01")):this.videoElement.preload=t.kV.NONE,this.videoElement.tabIndex=-1,this.videoElement.setAttribute("aria-label",String(Ko.videoPlayerLabel())),this.videoElement.style.objectFit=this.objectFit,this.shouldRoundBackground&&this.videoElement.classList.add("rounded-4"),this.stoppedState=void 0}async play(t=!1){return this.mediaActionsController.play(t)}async load(e=t.kV.AUTO){return this.mediaActionsController.load(e)}pause(t){return this.mediaActionsController.pause(t)}stop(){this.mediaActionsController.stop()}updateSubSession(){this.subSessionId=t.ab(),this.hlsController.updateCmcdSessionId(this.subSessionId),this.subSessionInstructionTime=void 0,this.subSessionPlayStartTime=void 0,this.subSessionPlayingStartTime=void 0}hideRecommendationOverlay(){this.mediaUI?.recommendationOverlayController?.hideRecommendationOverlay()}_restoreVideoTime(){!this.videoElement.currentTime&&this.stoppedState?.currentTime&&(this.videoElement.currentTime=this.stoppedState?.currentTime)}render(){return e.x` ${this.videoElement} <shreddit-media-ui class="pointer-events-none" .videoElement="${this.videoElement}" .mediaActionsController="${this.mediaActionsController}" .qualityLevels="${this.qualityLevels}" .currentQualityLevelIndex="${this.currentQualityLevelIndex}" .postId="${this.postId}" .subredditId="${this.subredditId}" .rootSelector="${this.rootSelector}" ?autoplay="${this.autoplay}" ?autoplayPref="${this.autoplayPref}" ?hide-autoplay-toggle="${this.hideAutoplayToggle}" ?gif="${this.gif}" ?hideControls="${this.hideControls}" ?hideFullscreenButton="${this.hideFullscreenButton}" ?isLoggedInUser="${this.isLoggedInUser}" ?isMobile="${this.isMobile}" caption-url="${this.captionUrl}" preview="${this.preview}" ?hideGifIcon="${this.hideGifIcon}"> <slot name="recommendation-overlay" slot="recommendation-overlay"></slot> <slot name="loading-spinner" slot="loading-spinner"></slot> </shreddit-media-ui> ${this.debug?e.x`<shreddit-player-debug-overlay></shreddit-player-debug-overlay>`:e.A} `}};return xl.styles=[e.a`:host{display:block;position:relative;height:100%;width:100%;max-height:100%;max-width:100%}video{height:100%;width:100%;background:#000;outline:0}`,t.t],t._([t.n()],xl.prototype,"src",void 0),t._([t.n({type:Boolean,reflect:!0})],xl.prototype,"autoplay",void 0),t._([t.n({type:Boolean,attribute:"autoplay-pref"})],xl.prototype,"autoplayPref",void 0),t._([t.n({type:Boolean,attribute:"hide-autoplay-toggle"})],xl.prototype,"hideAutoplayToggle",void 0),t._([t.n({type:Boolean})],xl.prototype,"gif",void 0),t._([t.n({type:Boolean,attribute:"loop"})],xl.prototype,"loop",void 0),t._([t.n({type:Number,attribute:"loop-limit"})],xl.prototype,"loopLimit",void 0),t._([t.n({type:Boolean,attribute:"hide-controls"})],xl.prototype,"hideControls",void 0),t._([t.n({type:Boolean,attribute:"hide-fullscreen-button"})],xl.prototype,"hideFullscreenButton",void 0),t._([t.n({type:Boolean,attribute:"is-mobile"})],xl.prototype,"isMobile",void 0),t._([t.n({type:Boolean,attribute:"is-bot"})],xl.prototype,"isBot",void 0),t._([t.n({type:String})],xl.prototype,"poster",void 0),t._([t.n({type:String,attribute:"post-id"})],xl.prototype,"postId",void 0),t._([t.n({type:String,attribute:"comment-id"})],xl.prototype,"commentId",void 0),t._([t.n({type:String})],xl.prototype,"preview",void 0),t._([t.n({type:Boolean,attribute:"is-logged-in-user"})],xl.prototype,"isLoggedInUser",void 0),t._([t.n({type:Boolean,attribute:"single-playback"})],xl.prototype,"singlePlayback",void 0),t._([t.n({type:Boolean,attribute:"play-out-of-viewport"})],xl.prototype,"playOutOfViewport",void 0),t._([t.n({type:String,attribute:"object-fit"})],xl.prototype,"objectFit",void 0),t._([t.n({type:Boolean,attribute:"should-round-background"})],xl.prototype,"shouldRoundBackground",void 0),t._([t.n({type:String,attribute:"packaged-media-json"})],xl.prototype,"packagedMediaJSON",void 0),t._([t.n({type:String,attribute:"packaged-auth-token",reflect:!0})],xl.prototype,"packagedAuthToken",void 0),t._([t.n({type:String,attribute:"packaged-auth-expires-at",reflect:!0})],xl.prototype,"packagedAuthExpiresAt",void 0),t._([t.n({type:String,attribute:"streaming-auth-token",reflect:!0})],xl.prototype,"streamingAuthToken",void 0),t._([t.n({type:String,attribute:"streaming-auth-expires-at",reflect:!0})],xl.prototype,"streamingAuthExpiresAt",void 0),t._([t.n({type:String,attribute:"caption-url"})],xl.prototype,"captionUrl",void 0),t._([t.n({attribute:"media-origin"})],xl.prototype,"mediaOrigin",void 0),t._([t.n({attribute:"player-type"})],xl.prototype,"playerType",void 0),t._([t.n({attribute:"post-created-at"})],xl.prototype,"postCreatedAt",void 0),t._([t.n({attribute:"post-domain"})],xl.prototype,"postDomain",void 0),t._([t.n({type:Boolean,attribute:"post-nsfw"})],xl.prototype,"postNsfw",void 0),t._([t.n({type:Boolean,attribute:"post-promoted"})],xl.prototype,"postPromoted",void 0),t._([t.n({type:Boolean,attribute:"post-spoiler"})],xl.prototype,"postSpoiler",void 0),t._([t.n({type:Number,attribute:"post-score"})],xl.prototype,"postScore",void 0),t._([t.n({attribute:"post-type"})],xl.prototype,"postType",void 0),t._([t.n({attribute:"subreddit-name"})],xl.prototype,"subredditName",void 0),t._([t.n({attribute:"subreddit-id"})],xl.prototype,"subredditId",void 0),t._([t.n({type:Boolean,attribute:"error-improvements"})],xl.prototype,"errorImprovements",void 0),t._([t.n({type:Boolean,attribute:"idle-autoplay"})],xl.prototype,"idleAutoplay",void 0),t._([t.n({type:Boolean,attribute:"sync-perf"})],xl.prototype,"syncPerf",void 0),t._([t.n({type:Boolean,attribute:"hide-gif-icon"})],xl.prototype,"hideGifIcon",void 0),t._([t.n({type:Boolean,attribute:"debug"})],xl.prototype,"debug",void 0),t._([t.h()],xl.prototype,"qualityLevels",void 0),t._([t.h()],xl.prototype,"currentQualityLevelIndex",void 0),t._([t.a2("shreddit-media-ui")],xl.prototype,"mediaUI",void 0),t._([t.a2("shreddit-player-debug-overlay")],xl.prototype,"debugOverlay",void 0),xl=t._([t.e(Pl)],xl),{SELECTOR:t.f7,TAG_NAMES:t.bw,get ShredditPlayer(){return xl},setUiStrings:t=>{Ko=t}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("ClaQym8zez",["Dw4vb8Yfbm","5r73EsgItq","Cv4mWnWE30","B-zFJtiar6"],(async(t,e,o,i)=>{let a=class extends e.s{constructor(){super(...arguments),this.position="bottom",this.mouseEnterDelay=750,this.triggerEvent="hover",this.appearance="neutral",this.emitter=i.n(this),this._timeoutID=null,this._popperController=new o.P(this,{position:this.position,variantFlipOrder:{start:"s",middle:"m",end:"e"},referenceElementKey:"referenceElement",popperElementKey:"_tooltip"}),this._eventUsedMap=new WeakMap,this.updated=t=>{t.has("position")&&this._popperController.updateOptions({position:this.position})},this.handleDocumentClick=t=>{if(!(t.target instanceof HTMLElement)||this.hidden)return;if(t.target.closest(this.tagName.toLowerCase())===this)return;this._eventUsedMap.has(t)||this.close()},this.handleEscape=t=>{"Escape"===t.key&&this.close()},this.addListenersWhileOpened=()=>{document.addEventListener("click",this.handleDocumentClick),document.addEventListener("keydown",this.handleEscape)},this.cleanupListenersWhileOpened=()=>{document.removeEventListener("click",this.handleDocumentClick),document.removeEventListener("keydown",this.handleEscape)}}get referenceElement(){return this.triggers[0]??this}static get styles(){return[e.a`:host{display:inline-block;position:relative;color:var(--tooltip-content)}:host([appearance=neutral]){--tooltip-background:var(--color-tooltip-bg-neutral);--tooltip-content:var(--color-tooltip-text-neutral)}:host([appearance=inverted]){--tooltip-background:var(--color-tooltip-bg-inverted);--tooltip-content:var(--color-tooltip-text-inverted)}:host([appearance=primary]){--tooltip-background:var(--color-tooltip-bg-primary);--tooltip-content:var(--color-tooltip-text-primary)}#faceplate-tooltip{font:var(--font-12-16-semibold);background-color:var(--tooltip-background);color:var(--tooltip-content);border-radius:.25rem;box-shadow:var(--boxshadow-tooltip);justify-content:center;align-items:center;padding:.5rem;display:inline-flex;width:max-content;isolation:isolate;z-index:var(--faceplate-tooltip-z-index,1)}article{display:flex;gap:.375rem}#faceplate-tooltip::after{display:block;content:'';width:8px;height:8px;position:absolute;background-color:var(--tooltip-background)}#faceplate-tooltip[position=bottom-end]::after,#faceplate-tooltip[position=bottom-start]::after,#faceplate-tooltip[position=top-end]::after,#faceplate-tooltip[position=top-start]::after{--max-arrow-x-travel-tooltip:calc(var(--tooltip-width, 2rem) - 1rem);--max-arrow-x-travel-target:calc(var(--target-width, 1rem) / 2);--max-arrow-x-distance:max(
            min(var(--max-arrow-x-travel-target), var(--max-arrow-x-travel-tooltip)),
            0.5rem
          )}#faceplate-tooltip[position=bottom-start]::after,#faceplate-tooltip[position=top-start]::after{inset-inline-start:var(--max-arrow-x-distance)}#faceplate-tooltip[position=bottom-end]::after,#faceplate-tooltip[position=top-end]::after{inset-inline-end:var(--max-arrow-x-distance)}#faceplate-tooltip[position=left-end]::after,#faceplate-tooltip[position=left-start]::after,#faceplate-tooltip[position=right-end]::after,#faceplate-tooltip[position=right-start]::after{--max-arrow-y-travel-tooltip:calc(var(--tooltip-height, 2rem) - 1rem);--max-arrow-y-travel-target:calc(var(--target-height, 2rem) / 2);--max-arrow-y-distance:max(
            min(var(--max-arrow-y-travel-target), var(--max-arrow-y-travel-tooltip)),
            0.5rem
          )}#faceplate-tooltip[position=left-start]::after,#faceplate-tooltip[position=right-start]::after{top:var(--max-arrow-y-distance)}#faceplate-tooltip[position=left-end]::after,#faceplate-tooltip[position=right-end]::after{bottom:var(--max-arrow-y-distance)}#faceplate-tooltip[position|=bottom]::after{top:0;transform:translateY(-50%) rotate(45deg);box-shadow:-1px -1px 2px rgba(0,0,0,.05)}#faceplate-tooltip[position|=top]::after{bottom:0;transform:translateY(50%) rotate(45deg);box-shadow:1px 1px 2px rgba(0,0,0,.05)}#faceplate-tooltip[position|=right]::after{inset-inline-start:0;transform:translateX(-38%) rotate(45deg);box-shadow:-2px 0 2px rgba(0,0,0,.05)}#faceplate-tooltip[position|=left]::after{inset-inline-end:0;transform:translateX(38%) rotate(45deg);box-shadow:0 -2px 2px rgba(0,0,0,.05)}#faceplate-tooltip[position^=auto]::after{display:none}`,o.P.defaultPopperContentStyles]}get hidden(){return"closed"===this._popperController.currentState.state}connectedCallback(){super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback(),this.cleanupListenersWhileOpened()}updateCustomProperties(){if("faceplate-tooltip"!==this.tagName.toLocaleLowerCase())return;const{clientHeight:t=null,clientWidth:e=null}=this.referenceElement,{clientHeight:o=null,clientWidth:i=null}=this._tooltip;t&&e&&o&&i&&(this.style.setProperty("--target-width",`${Math.round(e)}px`),this.style.setProperty("--target-height",`${Math.round(t)}px`),this.style.setProperty("--tooltip-width",`${Math.round(i)}px`),this.style.setProperty("--tooltip-height",`${Math.round(o)}px`))}show(){this.emitter.dispatch("open"),this.updateCustomProperties(),this._popperController.open().then((()=>{this.hidden||(this.addListenersWhileOpened(),this.emitter.dispatch("opened"))}))}close(){return this.cleanupListenersWhileOpened(),this.emitter.dispatch("close"),this._popperController.close().then((()=>{this.hidden&&this.emitter.dispatch("closed")}))}handleClick(t){this._eventUsedMap.set(t,!0),"click"===this.triggerEvent&&(this.hidden?this.show():this.close())}handleMouseenter(){"hover"===this.triggerEvent&&(this.cleanupTooltips(),this._timeoutID=window.setTimeout((()=>{this.querySelector(":focus, :hover")&&this.show()}),this.mouseEnterDelay))}handleMouseleave(){this.close(),this.cleanupTooltips()}cleanupTooltips(){this._timeoutID&&(window.clearTimeout(this._timeoutID),this._timeoutID=null)}render(){const t=this._popperController.actualPosition||this.position;return e.x` <slot name="trigger" aria-describedby="faceplate-tooltip" faceplate-popper-trigger @click="${this.handleClick}" @mouseenter="${this.handleMouseenter}" @mouseleave="${this.handleMouseleave}" @focusin="${this.handleMouseenter}" @focusout="${this.handleMouseleave}"></slot> <article id="faceplate-tooltip" role="tooltip" position="${t}" faceplate-popper-content> <slot class="icon" name="icon"></slot> <span> <slot></slot> </span> </article> `}};return t._([t.n({type:String})],a.prototype,"position",void 0),t._([t.n({type:Number,attribute:"enter-delay"})],a.prototype,"mouseEnterDelay",void 0),t._([t.n({type:String,attribute:"trigger-event"})],a.prototype,"triggerEvent",void 0),t._([t.n({type:String,reflect:!0})],a.prototype,"appearance",void 0),t._([t.aC({slot:"trigger",flatten:!0})],a.prototype,"triggers",void 0),t._([t.aC({slot:"icon",flatten:!0})],a.prototype,"icons",void 0),t._([t.a2("#faceplate-tooltip")],a.prototype,"_tooltip",void 0),a=t._([t.e("faceplate-tooltip")],a),{get FaceplateTooltip(){return a}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("Cn5Dm3JnwH",["Dw4vb8Yfbm"],(async t=>{const{svg:a}=t.a();return{s:t.m(a`<path d="M10 2.8A7.2 7.2 0 112.8 10 7.208 7.208 0 0110 2.8zM10 1a9 9 0 100 18 9 9 0 000-18zm4 8.1H6v1.8h8V9.1z"></path>`,"0 0 20 20","subtract-circle")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("CnDGunUlBx",["Dw4vb8Yfbm"],(async e=>{const t=new WeakMap;function i(e){const i=document.querySelector(e);if(!i)return Promise.reject(`lazy script "${e}" cannot be found`);const s=t.get(i);if(s)return s;if(!i.nonce)return Promise.reject('loadLazyScriptWithNonce should only be used to load scripts with "nonce"s');const n=i?.getAttribute("data-src");if(!n)return Promise.reject('loadLazyScriptWithNonce expects a script tag with a "data-src" attribute');const o=document.querySelector(`script[src="${n}"]`);if(o)return Promise.resolve(o);const r=new Promise(((e,t)=>{const s=document.createElement("script");s.nonce=i.nonce,s.onload=function(){e(s)},s.onerror=function(e){t(e?.toString())},s.src=n,s.dataset.lazy="true",document.body.appendChild(s)}));return t.set(i,r),r}var s;class n{constructor(e,t){this.host=e,this.uxTypes=t,this.host.addController(this)}static initialize(){return this.initializePromise||(this.initializePromise=this._initialize()),this.initializePromise}static async _initialize(){try{await i(`script#${e.b7}`)}catch(e){return void window.Sentry?.captureException?.(e)}try{window.google.accounts.id.initialize({client_id:CLIENT_CONFIG.GOOGLE_SSO_CLIENT_ID,callback:this.onGoogleCredentialResponse,itp_support:!0,auto_select:!0,cancel_on_tap_outside:!1,use_fedcm_for_prompt:!0})}catch(e){window.Sentry?.captureException?.(e)}}static registerListener(e,t){for(const i of e){const e=this.listenersByUX[i];e.includes(t)||e.push(t)}}static deregisterListener(e,t){for(const i of e){const e=this.listenersByUX[i],s=e.indexOf(t);s>-1&&e.splice(s,1)}}static parseCredentialResponse(e){const t=e?.credential;if(!t)throw new Error("No credential in response");try{const e=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(atob(e).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join(""));return JSON.parse(i)}catch(e){throw new Error("Error decoding and parsing JWT")}}initialize(){return this.uxTypes&&this.host.onGoogleCredentialResponse&&s.registerListener(this.uxTypes,this.host.onGoogleCredentialResponse),s.initialize()}hostDisconnected(){this.uxTypes&&this.host.onGoogleCredentialResponse&&s.deregisterListener(this.uxTypes,this.host.onGoogleCredentialResponse)}}return s=n,n.ButtonUX=["btn","btn_confirm","btn_add_session","btn_confirm_add_session","fedcm_button"],n.OneTapUX=["auto","user","user_1tap","user_2tap","fedcm_auto","fedcm","itp"],n.listenersByUX=[...s.ButtonUX,...s.OneTapUX].reduce(((e,t)=>(e[t]=[],e)),{}),n.onGoogleCredentialResponse=e=>{const t=s.listenersByUX[e.select_by];if(t)for(const i of t)i(e)},{G:n,l:i}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("CpZ44pmnxI",["Dw4vb8Yfbm","5r73EsgItq","FQGvCwaizg","B-zFJtiar6"],(async(t,e,i,n)=>{function s(t){if(i.i(t)&&(t.checked=t.hasAttribute("checked")),i.a(t))t.formResetCallback&&t.formResetCallback();else if(t instanceof HTMLInputElement)t.value=t.getAttribute("value")||"";else if(t instanceof HTMLTextAreaElement)t.value=t.textContent||"";else if(i.b(t))for(const e of t.options)e.selected=e.hasAttribute("selected");else t instanceof HTMLOutputElement&&(t.value=t.defaultValue)}const a=(t,e=0)=>{if(6!==e)return t instanceof HTMLInputElement||t instanceof HTMLButtonElement?t:t?a(t.parentElement,e+1):void 0};function o(e){let i;document.activeElement&&document.activeElement!==document.body&&(i=t.dN(document.activeElement)),!i&&e&&e.target instanceof Element&&(i=function(t){var e;for(const i of null!==(e=t.composedPath())&&void 0!==e?e:[])if((i instanceof HTMLInputElement||i instanceof HTMLButtonElement)&&"submit"===i.type)return i}(e));const n=i instanceof HTMLButtonElement||i instanceof HTMLInputElement;if(i&&e&&!n&&(i=a(i.parentElement)),i)return(i instanceof HTMLInputElement||i instanceof HTMLButtonElement)&&"submit"===i.type?i:void 0}function r(t){return t instanceof HTMLElement&&Object.prototype.hasOwnProperty.call(t.dataset,"faceplateConstraint")}function l(e,i,n){return t.c("faceplate-alert",{level:t.a5.error,message:t.dS("Form submission failed"),meta:null==e?void 0:e.toString(),sourceElement:i,cause:n})}const d={[t.dO.UrlEncoded]:t.dP,[t.dO.JSON]:n.b7,[t.dO.FormData]:t=>t};let c=class extends e.s{constructor(){super(...arguments),this.accept="text/vnd.reddit.partial+html, application/json",this.enctype=t.dO.UrlEncoded,this.action="",this.disabled=!1,this.method=t.bi.Post,this.target="",this.partialMode=t.P.Append,this.novalidate=!1,this.validationTrigger="focusout",this._events=new t.E(this),this.formSubmissionInProgress=!1,this.rulesDidChange=!1,this.focusedInputForValiditySinceLastSubmit=!1,this._shouldRebuildElements=!0,this._elements={},this._validationObserverCount=0,this._asyncInputOperations=0,this.requester=t.dQ,this.encoders=d,this._handleInput=this._events.define("input",(()=>{this._shouldRebuildElements=!0})),this._handleFormSubmit=this._events.define("submit",(t=>{const e=t.target;if(!(e&&e instanceof HTMLFormElement))return;t.preventDefault();const i=o(t);this.submit(e.action,void 0,i)})),this._handleClick=this._events.define("click",(t=>{const e=o(t);e&&(t.preventDefault(),this.submit(this.action,void 0,e))})),this._handleFocusIn=this._events.define("focusin",(t=>{if(i.d(t.target)&&r(t.target))if(this.formSubmissionInProgress){const e=this;t.target.addEventListener("input",(function t(i){var n;e.validateElementAgainstRules(i.target)&&(null===(n=i.target)||void 0===n||n.removeEventListener("input",t))}))}else t.target.setCustomValidity("")})),this.configureValidation=()=>this.addEventListener(this.validationTrigger,(t=>{i.d(t.target)&&(r(t.target)&&this.validateElementAgainstRules(t.target),i.F in t.target.constructor&&t.target.syncInputValidity(),this.notifyObservers(t.target))})),this._handleFaceplateAlert=this._events.define("faceplate-alert",(e=>{const{level:i,name:n,message:s}=e.detail;i===t.a5.error&&n&&s&&this.invalidateFieldWithMessage(n,s)&&(e.target.remove(),e.stopPropagation())})),this.register=t=>{this.dispatchEvent(new CustomEvent("_faceplate-register-input",{detail:{target:t}}))},this._handleRegister=this._events.define("_faceplate-register-input",(t=>{var e;t.stopImmediatePropagation(),t.detail.register&&(null===(e=t.detail)||void 0===e||e.register(this)),this._shouldRebuildElements=!0;const{target:i}=t.detail;i.syncInputValidity(!1),this.notifyObservers(i)}))}updated(t){t.has("validationTrigger")&&(t.get("validationTrigger")&&this.removeEventListener(t.get("validationTrigger"),this.configureValidation),this.configureValidation())}get canSubmit(){return!(this.disabled||this.formSubmissionInProgress||this._asyncInputOperations>0)}get elements(){if(this._shouldRebuildElements){this._elements={};for(const t of this.recognizedInputs()){const{name:e}=t;if(e)if(e in this._elements){const n=this._elements[e];let s;Array.isArray(n)?(s=n,n.push(t)):(s=[n,t],s.value=i.e(n)&&n.checked?n.value:"",this._elements[e]=s),i.e(t)&&t.checked&&(s.value=t.value)}else this._elements[t.name]=t}this._shouldRebuildElements=!1}return this._elements}static get styles(){return e.a`:host{display:block;margin-bottom:1rem}`}render(){return e.x` <slot></slot> `}addEventListener(t,e,i){super.addEventListener(t,e,i),"_faceplate-validation-change"===t&&(this._validationObserverCount+=1)}removeEventListener(t,e,i){super.removeEventListener(t,e,i),"_faceplate-validation-change"===t&&(this._validationObserverCount-=1)}async disableUntil(t){this._asyncInputOperations+=1;try{await t}finally{this._asyncInputOperations-=1}}notifyObservers(e){if(this._validationObserverCount){const i=t.dR("_faceplate-validation-change",{bubbles:!0,cancelable:!1,composed:!1,detail:{input:e,message:e.validationMessage,name:e.name}});this.dispatchEvent(i)}}invalidateFieldWithMessage(t,e){const n=this.querySelector(`[name="${t}"]`);return!!i.d(n)&&(n.setCustomValidity(e),n.setAttribute("faceplate-dirty",""),this.notifyObservers(n),e&&n.addEventListener("input",(function t(){n.setCustomValidity(""),n.removeEventListener("input",t)})),e&&!this.focusedInputForValiditySinceLastSubmit&&(this.focusedInputForValiditySinceLastSubmit=!0,this.reportFieldValidity(n)),!0)}reportFieldValidity(e){const i=e.reportValidity();if(!i&&null===e.offsetParent){const i=t.c("faceplate-alert",{level:t.a5.error,message:t.dS("Validation error on hidden input"),meta:`"${e.name}": ${e.validationMessage}`,sourceElement:this.tagName,cause:"faceplate-form-input-validation-failure"});this.dispatchEvent(i)}return i}get targetElement(){return this.target&&document.querySelector(this.target)||this}get isValid(){let t=!0;const e=o(),n=!(this.novalidate||e&&e.hasAttribute("formnovalidate"));for(const e of this.recognizedInputs())if(i.d(e)){if(e.disabled)continue;if(e.matches(":disabled"))continue;if(n&&(this.validateElementAgainstRules(e),!e.checkValidity())){t=!1;break}}return t}async submit(e=this.action,i,n){var s,a,o,r;if(!this.canSubmit)return;this.formSubmissionInProgress=!0,this.focusedInputForValiditySinceLastSubmit=!1;try{const h=t.c("faceplate-submit");if(this.dispatchEvent(h),h.defaultPrevented)return;const p=this.buildRequest(i,n);if(!p)return;if("dialog"===p.method){const t=this.closest("faceplate-dialog");if(!t)throw new Error("Unable to find parent faceplate-dialog element to close with form submission");return t.close(p.body)}let f=this.enctype;if(n&&n.hasAttribute("formenctype")&&(f=n.getAttribute("formenctype")),"log"===p.method){const t=this.encoders[f];return console.log(t?t(p.body):p.body)}n&&n.hasAttribute("formaction")&&(e=n.getAttribute("formaction"));const m={enctype:f,encoders:this.encoders,credentials:this.credentials};try{for(var d,c=!0,u=t.dT(this.requester(e,p,m));!(s=(d=await u.next()).done);){r=d.value,c=!1;try{const t=r;if("faceplate-error"===t.type){const e=l(t.detail,this.tagName,"faceplate-form-fetch-failure");this.dispatchEvent(e);break}if(this.dispatchEvent(t),"faceplate-response"===t.type){await this.handleResponse(t.detail.response);break}}finally{c=!0}}}catch(t){a={error:t}}finally{try{c||s||!(o=u.return)||await o.call(u)}finally{if(a)throw a.error}}}catch(t){const e=l(t,this.tagName,"faceplate-form-submission-uncaught-error");this.dispatchEvent(e)}finally{return void(this.formSubmissionInProgress=!1)}}validateElementAgainstRules(e){var n;if(!r(e))return!0;if(this.rulesDidChange){const e=t.c("faceplate-form-constraints-changed");this.dispatchEvent(e),this.rulesDidChange=!1}e.setCustomValidity("");const s=i.f.getRegisteredElements(this);if(!s)return!0;const a=null===(n=e.dataset.faceplateConstraint)||void 0===n?void 0:n.split(" ");if(!a||!a.length)return!0;for(const t of a){const i=s.get(t);if(!i){console.warn(`Skipping validation against unknown rule "${t}"`);continue}const n=e.value;if(null!==n&&!i.validate(n))return e.setCustomValidity(i.message),!1}return!0}*elementsIterator(){yield*this.recognizedInputs()}recognizedInputs(){let t=new Set;for(const e of[...this.querySelectorAll("*")].filter(i.d))t.add(e);const e=this.querySelectorAll("output");for(let i=0;i<e.length;i++)t.add(e[i]);const n=i.g.getRegisteredElements(this);return n&&(t=new Set([...t,...n])),t}reset(){for(const t of this.recognizedInputs())s(t)}buildRequest(e,n){const s=new FormData;!n&&arguments.length<3&&(n=o());const a=!(this.novalidate||n&&n.hasAttribute("formnovalidate"));for(const t of this.recognizedInputs())if(i.d(t)){if(t.disabled)continue;if(t.matches(":disabled"))continue;if(a&&(this.validateElementAgainstRules(t),!this.reportFieldValidity(t)))return null;if(i.i(t)&&!t.checked)continue;const{name:e,value:n}=t;if(null===n)continue;if(n instanceof FormData){for(const t of n)s.append(t[0],t[1]);continue}if(!e)continue;if(i.b(t)&&t.multiple)for(const i of t.options)i.selected&&s.append(e,i.value);else if(t instanceof HTMLInputElement&&"file"===t.type){const i=t.files;if(i)for(const t of i)s.append(e,t)}else s.append(e,n)}if(e)for(const t of e)s.append(t.name,t.value);let r=this.method;return n&&(n.name&&n.value&&s.append(n.name,n.value),n.hasAttribute("formmethod")&&(r=t.dU(n.getAttribute("formmethod")))),{body:s,method:r.toLowerCase(),headers:{Accept:this.accept}}}async handleResponse(e){const i=t.dV(e);if("text/vnd.reddit.partial+html"===i){const i=await e.text(),n=this.targetElement;t.aT(i,n,this.partialMode)}else if("application/json"===i&&e.status>=400){const i=await e.json();if("object"==typeof(n=i)&&n&&Object.prototype.hasOwnProperty.call(n,"title")&&Object.prototype.hasOwnProperty.call(n,"message")){const n=t.c("faceplate-alert",{level:t.a5.error,name:i.title,message:t.dS("Form responded with error"),meta:i.message,sourceElement:this.tagName,cause:`faceplate-form-response-error-${e.status}`});this.dispatchEvent(n)}}else"text/html"===i&&e.redirected&&(window.location.href=e.url);var n}};return t._([t.n({type:String})],c.prototype,"accept",void 0),t._([t.n({type:String})],c.prototype,"enctype",void 0),t._([t.n({type:String})],c.prototype,"action",void 0),t._([t.n({type:Boolean,reflect:!0})],c.prototype,"disabled",void 0),t._([t.n({converter:t.dU,reflect:!0})],c.prototype,"method",void 0),t._([t.n({type:String})],c.prototype,"target",void 0),t._([t.n({type:String,attribute:"partial-mode"})],c.prototype,"partialMode",void 0),t._([t.n({type:String})],c.prototype,"novalidate",void 0),t._([t.n({type:String})],c.prototype,"credentials",void 0),t._([t.n({type:String,attribute:"validation-trigger"})],c.prototype,"validationTrigger",void 0),c=t._([t.e("faceplate-form")],c),i.r(c),{get F(){return c}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("CqGTWb5M_i",["Dw4vb8Yfbm"],(async a=>{const{svg:m}=a.a();return{i:a.m(m`<path d="M10 2.8c3.97 0 7.2 3.23 7.2 7.2s-3.23 7.2-7.2 7.2-7.2-3.23-7.2-7.2S6.03 2.8 10 2.8zM10 1a9 9 0 10.001 18.001A9 9 0 0010 1zm-.57 6.16c-.17-.1-.31-.24-.41-.41-.1-.17-.15-.36-.15-.57 0-.21.05-.4.15-.57.1-.17.24-.31.41-.41.17-.1.36-.15.57-.15.21 0 .4.05.57.15.17.1.31.24.41.41.1.17.15.36.15.57 0 .21-.05.4-.15.57-.1.17-.24.31-.41.41-.17.1-.36.15-.57.15-.21 0-.4-.05-.57-.15zm1.5 7.68H9.07v-6.3h1.86v6.3z"></path>`,"0 0 20 20","info")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./pA9dwrnd0r.js",import.meta.url,"pA9dwrnd0r");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./CspnAIpcFE.js",import.meta.url,"CspnAIpcFE");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./BX2z6Mar1p.js",import.meta.url,"BX2z6Mar1p");SML.di("./CsrbxKoUKW.js",import.meta.url,"CsrbxKoUKW");SML.di("./gvWVn4JBWB.js",import.meta.url,"gvWVn4JBWB");SML.di("./CCBTR4TAfR.js",import.meta.url,"CCBTR4TAfR");SML.di("./CQrDBXK-hm.js",import.meta.url,"CQrDBXK-hm");SML.di("./Py9rIF7r2a.js",import.meta.url,"Py9rIF7r2a");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./D1ScrvIqaY.js",import.meta.url,"D1ScrvIqaY");SML.di("./CxA9E_GW4X.js",import.meta.url,"CxA9E_GW4X");SML.di("./CMwg6atOpj.js",import.meta.url,"CMwg6atOpj");SML.di("./ClaQym8zez.js",import.meta.url,"ClaQym8zez");
SML.dm("Cs7sMcuNEu",["Dw4vb8Yfbm","pA9dwrnd0r","xrDbp1ee_h","5r73EsgItq","B-zFJtiar6","CsrbxKoUKW","gvWVn4JBWB","CCBTR4TAfR","CQrDBXK-hm","Py9rIF7r2a","BwcMg3lXAs","D1ScrvIqaY","CspnAIpcFE","BX2z6Mar1p","CxA9E_GW4X","CMwg6atOpj","ClaQym8zez"],(async(e,t,n,r,a,i,s,o,m,l,c,h)=>{let d=window.location,u=class extends r.s{constructor(){super(...arguments),this.commentId="",this.parentCommentPermalink="",this.postPermalink="",this.isInModQueue=!1,this.onLinkClick=(t,n)=>{this.isInModQueue&&(t.stopPropagation(),t.preventDefault(),e.p?.(e.T.ModQueuePdpLinkClick,{isFullDiscussionLink:n,parentCommentPermalink:this.parentCommentPermalink,postPermalink:this.postPermalink}))}}static get styles(){return[e.t,e.a0(".single-comment-thread-toolbar {\n  align-items: center;\n  display: flex;\n  flex-flow: row nowrap;\n  font: var(--font-title-h6);\n  justify-content: space-between;\n  padding: 0.5rem 1rem;\n}\n")]}firstUpdated(){this.updateComplete.then((()=>{if(this.isInModQueue)return;"1"===new URLSearchParams(d.search).get("draft")||t.s("auto")}))}handleSeeFullDiscussionLink(t){this.onLinkClick(t,!0);const r=document.querySelector("shreddit-post");r&&e.i(this,n.v(r))}render(){if(!this.commentId)return;const e=this.isInModQueue?"View parent comment":"Single comment thread",t="no-underline hover:no-underline visited:no-underline text-primary";return r.x` <div> <div class="single-comment-thread-toolbar text-neutral-content-weak"> ${this.parentCommentPermalink?r.x` <a href="${this.parentCommentPermalink}" class="${t}" @click="${this.onLinkClick}"> ${e} </a> `:r.x` <span>${e}</span> `} <span class="flex-1 h-px mx-xs bg-tone-4" data-id="line"></span> <a href="${this.postPermalink}" class="${t}" @click="${this.handleSeeFullDiscussionLink}"> ${"See full discussion"} </a> </div> </div> `;}};e._([e.n({type:String,attribute:"comment-id"})],u.prototype,"commentId",void 0),e._([e.n({type:String,attribute:"parent-comment-permalink"})],u.prototype,"parentCommentPermalink",void 0),e._([e.n({type:String,attribute:"post-permalink"})],u.prototype,"postPermalink",void 0),e._([e.n({type:Boolean,attribute:"is-in-modqueue"})],u.prototype,"isInModQueue",void 0),u=e._([e.e("shreddit-comments-page-tools")],u);let p=class extends r.s{constructor(){super(...arguments),this.postId="",this.isTruncated=!1,this.ui="mobile",this.pubsub=new e.u(this),this._searchDynamicIdCacheController=new o.S(this,e.ea.PdpCommentHighlightedSearchTerm),this._visibilityDetails=null,this.depthUpdated=null,this.handleCommentCreated=({parentThingId:t,body:n})=>{this.postId===t&&n&&this.querySelector("#next-comment")?.after(...e.bk(n))}}static get styles(){return[e.t,e.a0(":host {\n  display: block;\n  background-color: var(--shreddit-content-background);\n  padding-bottom: var(--spacer-xs);\n}\n")]}get visibilityDetails(){return null===this._visibilityDetails&&null===this.depthUpdated&&(this.depthUpdated=new Promise((e=>{requestAnimationFrame((()=>{const t=this.getVisibilityDetails();this._visibilityDetails=t,e(t)}))}))),this._visibilityDetails}getVisibilityDetails({containerWidth:e}={}){const t=this.querySelector(":scope > shreddit-comment"),n=t?.depth??0;e??(e=this.getBoundingClientRect().width);const r="mobile"===this.ui?232:320,a="mobile"===this.ui?18:32,i=this.maxDepth||("mobile"===this.ui?4:10),s=Math.floor((e-r)/a),o=Math.max(1,Math.min(s,i)),m=o+n,l=this.querySelector(":scope shreddit-comment[is-chosen-mq-comment]"),c=l?.depth??0,h=Math.max(n,c-o+1);return l?{maxVisibleDepth:h+o,minVisibleDepth:h}:{maxVisibleDepth:m}}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.CommentCreated,this.handleCommentCreated),this.resizeObserver=new ResizeObserver(a.D((e=>{let t=0;for(const n of e){const e=n.contentBoxSize.at(0)?.inlineSize;if(e){t=e;break}}if(0===t)return;const n=this.getVisibilityDetails({containerWidth:t});if(this._visibilityDetails?.maxVisibleDepth!==n.maxVisibleDepth||this._visibilityDetails?.minVisibleDepth!==n.minVisibleDepth){this._visibilityDetails=n,this.depthUpdated=Promise.resolve(n);for(const e of this.querySelectorAll("shreddit-comment"))e.setVisibility(n.maxVisibleDepth,n.minVisibleDepth)}}),128,!0)),this.resizeObserver.observe(this,{box:"content-box"})}disconnectedCallback(){super.disconnectedCallback(),this.resizeObserver?.unobserve(this),this.resizeObserver?.disconnect()}showAllComments(){e.p(e.T.TriggerCommentBlockingAuth,{source:s.C.Button}),this.isTruncated=!1,e.i(this,a.be())}renderShredtopViewMoreCommentsButton(t){return e.o({attributes:{type:"button",className:"ms-sm xs:ms-0 font-semibold mt-md",onclick:t},appearance:"brand",shape:"pill",leadingIcon:i.c({size:r.I.Medium}),size:e.q.Small,children:"View more comments"});}renderTruncatedExpandButton(){return this.renderShredtopViewMoreCommentsButton(this.showAllComments)}renderContent(){return function(e,t){const n="Comments Section";return e` <section class="flex flex-col px-md xs:px-0 gap-md relative" aria-label="${"Comments"}"> <h1 class="absolute -top-full -start-full w-px h-px overflow-hidden" aria-label="${n}"> ${n} </h1> ${e`<slot></slot>`} ${t?"":e`<slot name="truncated"></slot>`} </section> `;}(r.x,this.isTruncated);}renderExpandButton(){return this.isTruncated?this.renderTruncatedExpandButton():""}render(){return r.x` ${this.renderContent()} ${this.renderExpandButton()} `}};e._([e.n({type:String,attribute:"post-id"})],p.prototype,"postId",void 0),e._([e.n({type:Boolean})],p.prototype,"isTruncated",void 0),e._([e.n({type:String,attribute:"ui"})],p.prototype,"ui",void 0),e._([e.n({type:Number,attribute:"max-depth"})],p.prototype,"maxDepth",void 0),p=e._([e.e("shreddit-comment-tree")],p);let k=class extends r.s{constructor(){super(),this.target="",this.path="",this.isMobile=!1,this.isEntityFilterEnabled=!1,this.isSearchActive=!1,this.amaCommentTab=null,this.commentSearch=null,this.commentSort=null,this.pubsub=new e.u(this),this.replaceComments=async({sort:t="",filter:n="",entityFilterId:r=""})=>{t!==this.getCurrentSort()&&this.updateLocation({sort:t});const a=new URL(`${location.origin}${this.path}`);t&&a.searchParams.set(m.a.Sort,t.toLowerCase()),n&&a.searchParams.set(m.a.Filter,n.toLowerCase()),r&&a.searchParams.set(m.a.EntityFilterId,r),a.searchParams.set(m.a.InlineRefresh,"true");const i=a.toString().substring(location.origin.length);this.replaceContentController.loadAndReplaceContent({src:i,target:this.target,afterSuccess:()=>e.co(this,{message:"The comments are sorted successfully",options:{priority:e.S.assertive}}),afterFailure:()=>this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.error,cause:"uncategorized",message:"Failed to load the comments."}))})},this.handleSortEvent=async t=>{this.replaceComments({sort:t.detail.selected?.toLowerCase(),filter:this.getCurrentFilter()}),this.pubsub.publish(e.T.CommentSort,{sort:t.detail.selected});const n=this.querySelector("rpl-filter-chip[selected]"),r=this.allChip?.assignedElements()?.[0];n?.removeAttribute("selected"),r?.setAttribute("selected","")},this.handleAmaTabClick=e=>{const t=e.target?.closest("button")?.getAttribute("value");if(t){if(e instanceof KeyboardEvent&&"Enter"!==e.key)return;this.replaceComments({filter:t,sort:this.getCurrentSort()}),e.preventDefault()}},this.replaceContentController=new l.R,this.handleCommentSearchToggle=e=>{const t=e.detail.isHidden;this.isSearchActive=t;const n=this.querySelector("search-dynamic-id-cache-controller");n?.classList.toggle("min-w-full",t),this.classList.toggle("w-full",t)}}updateLocation({sort:e}){const t=new URL(location.href);t.searchParams.set(m.a.Sort,e.toLowerCase()),history.replaceState({},"",t.toString())}getCurrentFilter(){return this.querySelector("[faceplate-tab-selected]")?.getAttribute("value")?.toLowerCase()||""}getCurrentSort(){return new URLSearchParams(location.search).get(m.a.Sort)||""}connectedCallback(){super.connectedCallback(),this.commentSearch=this.querySelector('[slot="comment-search"]'),this.amaCommentTab=this.querySelector('[slot="ama-comment-tab"]'),this.commentSort=this.querySelector('[slot="comment-sort"]')}renderDivider(){return this.isEntityFilterEnabled&&!this.isSearchActive?r.x`<hr class="border-neutral-border-weak my-0 mx-2xs p-0 h-xl border-[0.5px]">`:r.A}renderSortbar(){const t=e.Z({flex:!0,"xs:ml-auto":!!this.amaCommentTab,hidden:this.isSearchActive});return this.commentSort?r.x`<slot name="comment-sort" class="${t}"></slot>`:r.A}renderSearchToggle(){return this.commentSearch?r.x`<slot name="comment-search"></slot>`:r.A}renderAMATab(){const t=e.Z({flex:!0,hidden:this.isSearchActive});return this.amaCommentTab?r.x` <slot name="ama-comment-tab" @click="${this.handleAmaTabClick}" @keydown="${this.handleAmaTabClick}" class="${t}"></slot> `:r.A}renderToolbar(){const t=e.Z({"toolbar-container relative bg-neutral-background flex gap-xs items-center":!0,"flex-wrap":!this.isEntityFilterEnabled,"flex-1":this.isSearchActive});return r.x` ${this.renderAMATab()} <div class="${t}"> ${this.renderSortbar()} ${this.renderSearchToggle()} ${this.renderDivider()} </div> `}renderDesktop(e){return r.x` <div class="${e}">${this.renderToolbar()}</div> `}renderMobile(e){return r.x` <div class="${e}">${this.renderToolbar()}</div> `}render(){const t=e.Z({"flex gap-xs outer-container items-center flex-wrap ":!0,"w-full":!this.isMobile||this.isSearchActive,"justify-between w-full":Boolean(this.amaCommentTab)});return r.x` <div class="flex gap-xs w-full" @comment-sort="${this.handleSortEvent}" @pdp-comment-search-toggle="${this.handleCommentSearchToggle}"> ${this.isMobile?this.renderMobile(t):this.renderDesktop(t)} </div> `}};k.styles=[e.t,r.a`.hide-scrollbar{-ms-overflow-style:none;scrollbar-width:none}`],e._([e.n({type:String})],k.prototype,"target",void 0),e._([e.n({type:String})],k.prototype,"path",void 0),e._([e.n({type:Boolean,attribute:"is-mobile"})],k.prototype,"isMobile",void 0),e._([e.a2(".all-chip")],k.prototype,"allChip",void 0),e._([e.n({type:Boolean,attribute:"entity-filter-enabled"})],k.prototype,"isEntityFilterEnabled",void 0),e._([e.h()],k.prototype,"isSearchActive",void 0),k=e._([e.e("shreddit-comments-sort-dropdown")],k);const b="expand-pdp-comment-search-button";let T=class extends r.s{constructor(){super(...arguments),this.target="",this.path="",this.showOnLoad=!1,this.initialValue="",this.isEntityFilterEnabled=!1,this.open=this.showOnLoad,this.commentSearchActive=this.showOnLoad,this.focusSearchInput=()=>{this.open||(this.open=!0),this.searchInput?.innerInput?.focus()},this.resetSearchInput=()=>{this.handleClear(),this.open=!1,h.S.update(e.ea.PdpCommentSearch),this.commentSearchActive=!1,this.expandSearchButton?.focus()},this.replaceContentController=new l.R,this.handlePdpCommentSearch=e.ao((async()=>{const t=this.searchInput?.value??"";if(t){this.commentSearchActive=!0;const n={conversationId:h.a.get(e.ea.PdpCommentSearch),cursor:{},impressionId:h.S.getUUID(),pane:e.eb.Comments,query:t,scope:{type:e.aa.PDP,path:this.path}};this.addSearchParamsToUrl(n);const r=new URLSearchParams({...e.ec(n)});e.i(this,e.b({source:"search",action:"click",noun:"full_search_button"},this.searchTelemetryData));const a=document.createElement("span");a.id=this.target,this.replaceContentController.loadAndReplaceContent({src:`/svc/shreddit${this.path}pdp-comment-search-results?${r.toString()}`,target:this.target,wrapPartialElement:e=>(a.appendChild(e),a)})}}),300),this.handleKeyDown=t=>{h.S.update(e.ea.PdpCommentSearch),"Enter"===t.key&&t.target===this.searchInput&&this.handlePdpCommentSearch(),"Escape"===t.key&&t.target===this.searchInput&&(t.stopPropagation(),this.commentSearchActive?this.searchInput?.blur():this.resetSearchInput())},this.handleClear=()=>{this.searchInput?.value&&(this.searchInput.value="")},this.searchCommentText=()=>"Search Comments"}hideElementsVisibility(t){this.dispatchEvent(e.c("pdp-comment-search-toggle",{isHidden:t}))}connectedCallback(){super.connectedCallback(),this.commentSearchActive=this.showOnLoad,this.open=this.showOnLoad}get searchTelemetryData(){const t=this.searchInput?.value??"";return{action_info:{page_type:e.au.PostDetail},search:{conversation_id:h.a.get(e.ea.PdpCommentSearch),impression_id:h.S.get(e.ea.PdpCommentSearch),query:t,query_id:h.b.get({query:t,scope:{type:e.aa.PDP,path:this.path}},e.ea.PdpCommentSearch),origin_element:e.ed.CommentSearchBar,origin_page_type:e.au.PostDetail}}}addSearchParamsToUrl(t){const n=location.href,r=new URL(n);r.searchParams.set(e.cn.Query,t.query),r.searchParams.set(e.cn.Pane,e.eb.Comments),r.searchParams.set(e.cn.ConversationId,t.conversationId??h.a.get(e.ea.PdpCommentSearch)),r.searchParams.set(e.cn.ImpressionId,t.impressionId??h.S.getUUID());const a=r.toString();a!==n&&history.replaceState({},"",a)}updated(e){if(e.has("open")){const t=!e.get("open")&&this.open,n=e.get("open")&&!this.open;t?this.focusSearchInput():n&&this.expandSearchButton?.focus()}this.hideElementsVisibility(this.commentSearchActive||this.open)}renderSearchButton(){const t={"aria-controls":"pdp-comment-search-form","aria-expanded":`${this.open}`,id:b,onclick:this.focusSearchInput,type:"button"},n={appearance:"bordered",screenReaderContent:"Expand comment search"};return this.isEntityFilterEnabled?e.o({attributes:{...t,className:""+(this.open?"hidden":"")},leadingIcon:l.s({size:r.I.Small}),size:e.q.Small,...n}):e.o({attributes:{...t,className:"border-neutral-border-weak hover:border-neutral-content-weak text-secondary-weak font-normal "+(this.open?"hidden":"")},children:r.x`<span class="flex pr-xs">${this.searchCommentText()}</span>`,leadingIcon:r.x`<span class="flex pl-xs">${l.s({size:r.I.Small})}</span>`,...n})}render(){return r.x`<div class="block" data-faceplate-tracking-context="${JSON.stringify(this.searchTelemetryData)}"> <faceplate-tracker source="search" action="click" noun="search_bar"> ${this.renderSearchButton()} </faceplate-tracker> <form class="flex w-full ${e.Z({hidden:!this.open})}" id="pdp-comment-search-form" @submit="${this.handlePdpCommentSearch}"> <faceplate-search-input class="text-secondary-plain m-0 rounded-full outline outline-1 outline-neutral-border-weak flex-grow focus:outline-neutral-content-weak" placeholder="${this.searchCommentText()}" enterkeyhint="search" @keydown="${this.handleKeyDown}" @focus="${()=>{this.open=!0}}" value="${this.initialValue}"> ${e.o({attributes:{id:"search-input-clear-button",slot:"clearIcon",type:"button",onclick:this.handleClear},appearance:"plain",size:e.q.Small,screenReaderContent:"Clear search",leadingIcon:c.c({size:r.I.Small})})}</faceplate-search-input> ${e.o({appearance:"plain",attributes:{className:"ml-xs"+(this.commentSearchActive?" hidden":""),id:"cancel-pdp-comment-search-button",onclick:this.resetSearchInput,type:"button"},children:"Cancel"})} </form> </div>`;}};T.styles=[e.t],e._([e.n({type:String})],T.prototype,"target",void 0),e._([e.n({type:String})],T.prototype,"path",void 0),e._([e.n({attribute:"show-on-load",type:Boolean})],T.prototype,"showOnLoad",void 0),e._([e.n({type:String,attribute:"initial-value"})],T.prototype,"initialValue",void 0),e._([e.n({type:Boolean,attribute:"entity-filter-enabled"})],T.prototype,"isEntityFilterEnabled",void 0),e._([e.a2(`#${b}`)],T.prototype,"expandSearchButton",void 0),e._([e.a2("faceplate-search-input")],T.prototype,"searchInput",void 0),e._([e.h()],T.prototype,"open",void 0),e._([e.h()],T.prototype,"commentSearchActive",void 0),T=e._([e.e("pdp-comment-search-input")],T);let S=class extends r.s{connectedCallback(){const e=this.getFullUrl();e.includes(":~:text=")?this.goToCommentWithTextFragment(e):this.goToCommentWithId(),super.connectedCallback()}goToCommentWithId(){const e=window.location.hash;if(!e)return;const t=e.substring(1);if(!t)return;const n=`t1_${t}-comment-rtjson-content`,r=document.getElementById(n);if(!r)return;const a=document.querySelector(`shreddit-comment[thingid="t1_${t}"]`);if(!a)return;r.style.fontWeight="900";const i=a.getBoundingClientRect(),s=a.offsetHeight,o=i.top+window.pageYOffset-s/2;o>window.innerHeight&&window.scrollTo({top:o,behavior:"smooth"})}goToCommentWithTextFragment(e){document.fragmentDirective&&this.setWindowHref(e)}getFullUrl(){const e=performance.getEntriesByType("navigation");return e.length>0?e[0].name:window.location.href}setWindowHref(e){window.location.href=e}render(){return r.x``}};S=e._([e.e("comment-url-fragment-manager")],S)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./2dYGY2J66F.js",import.meta.url,"2dYGY2J66F");SML.di("./Cn5Dm3JnwH.js",import.meta.url,"Cn5Dm3JnwH");SML.di("./DgW4ULLwQ1.js",import.meta.url,"DgW4ULLwQ1");SML.di("./Bypt3-pSP2.js",import.meta.url,"Bypt3-pSP2");SML.di("./D14t1nj-sI.js",import.meta.url,"D14t1nj-sI");SML.di("./CQrDBXK-hm.js",import.meta.url,"CQrDBXK-hm");SML.di("./gvWVn4JBWB.js",import.meta.url,"gvWVn4JBWB");SML.di("./DmeLdLooOj.js",import.meta.url,"DmeLdLooOj");SML.di("./pA9dwrnd0r.js",import.meta.url,"pA9dwrnd0r");SML.di("./DLXAqLxSut.js",import.meta.url,"DLXAqLxSut");SML.di("./Cl1pMDH2OX.js",import.meta.url,"Cl1pMDH2OX");SML.di("./DQQjPN-OEj.js",import.meta.url,"DQQjPN-OEj");SML.di("./CZLMnmUH44.js",import.meta.url,"CZLMnmUH44");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./CEs3hLX56z.js",import.meta.url,"CEs3hLX56z");SML.di("./B6Ai7g9fbR.js",import.meta.url,"B6Ai7g9fbR");SML.di("./BXUgRcxEAi.js",import.meta.url,"BXUgRcxEAi");SML.di("./w2XkRJ2mzc.js",import.meta.url,"w2XkRJ2mzc");SML.di("./h4Pa0OJr_5.js",import.meta.url,"h4Pa0OJr_5");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./DFh5Z0Dv0L.js",import.meta.url,"DFh5Z0Dv0L");
SML.dm("CspnAIpcFE",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6","2dYGY2J66F","Cn5Dm3JnwH","D14t1nj-sI","CQrDBXK-hm","gvWVn4JBWB","pA9dwrnd0r","DLXAqLxSut","DgW4ULLwQ1","Bypt3-pSP2","DmeLdLooOj","Cl1pMDH2OX","DQQjPN-OEj","CZLMnmUH44","xrDbp1ee_h","CEs3hLX56z","B6Ai7g9fbR","BXUgRcxEAi","w2XkRJ2mzc","h4Pa0OJr_5","BIzQFHISzm","DFh5Z0Dv0L"],(async(e,t,o,i,r,n,s,a,d,l)=>{function h(e,t){const{html:i}=e,r=function(e){const t={bg:"",border:""};if(e.isSctReplacementEnabled&&e.isCurrentPermalink)return{bg:"bg-neutral-background-highlighted-strong",border:"border-0 border-s border-solid border-neutral-background-gilded"};if(e.isPdpSeekerM1LO)return t;if(e.isHighlighted)return{bg:"bg-orangered-500 bg-opacity-[0.07]",border:"border-0 border-s border-solid border-global-orangered"};if(m(e))return{bg:"bg-yellow-200 bg-opacity-[0.07]",border:"border-0 border-s border-solid border-global-gold"};return t}(e),n=`Thread for ${e.author}'s comment`,s=e.ariaLabel||n;return i` <details role="article" ?open="${!e.collapsed}" @toggle="${e.handleToggle}" aria-label="${s}" tabindex="0"> <summary class="${o.j("grid grid-cols-[24px_minmax(0,1fr)]",!e.isPdpSeekerM1LO&&"xs:grid-cols-[32px_minmax(0,1fr)]",c(e)?"mt-[1px]":"")}" @click="${e.handleSummaryClick}" aria-label="${`Metadata for ${e.author}'s comment`}"> ${e.collapsed?e.uncollapseButton:i`<div class="relative"> ${c(e)?i` <div class="absolute top-[2px] start-[16px] end-0 h-full ${r.bg} pointer-events-none"></div>`:""} ${i`<slot name="commentAvatar"></slot>`} </div>`} <div class="flex relative ${c(e)?`${r.bg} rounded-tr-[0.5rem] mt-[2px] mb-[-2px]`:""}"> ${i`<slot name="commentMeta" @click="${e.handleCommentMetaSlotClick}" id="comment-meta"></slot>`} </div> </summary> <div class="${o.j("grid grid-cols-[24px_1fr] relative",!e.isPdpSeekerM1LO&&"xs:grid-cols-[32px_1fr]")}"> ${function(e){if(!e.hasMoreLink&&!e.hasRenderedComments)return"";const t=e.isPdpSeekerM1LO?"xs:w-lg":"xs:w-xl";return e.html` <div class="absolute top-0 start-0 bottom-0 w-lg ${t} flex justify-center items-center z-0 cursor-pointer group mb-sm" @mouseenter="${e.onThreadLineMouseEnter}" @mouseleave="${e.onThreadLineMouseLeave}" @click="${e.handleToggle}" aria-hidden="true"> <div data-testid="main-thread-line" class="w-[1px] h-full group-hover:bg-tone-2 ${e.isThreadLineHovered?"bg-tone-2":"bg-tone-4"}"></div> </div> `}(e)} <div class="contents"> <div class="${c(e)?"relative pointer-events-none":""}"> ${c(e)?i`<div class="absolute h-full w-[11.5px] xs:w-[15.5px] end-0 ${r.bg} ${r.border}"></div>`:""} </div> <div class="min-w-0 ${c(e)?r.bg:""}"> ${i`<slot @click="${e.handleContentSlotClick}"></slot>`} ${i`<slot name="comment-edit"></slot>`} ${function(e){if(e.isCommentDeleted||e.isInEditMode)return"";return e.html` <div class="relative"> ${e.html`<slot name="comment"></slot>`} </div> `}(e)} </div> </div> <div class="contents"> ${function(e){return"at-fold"!==e.currentTreePosition&&e.hasRenderedComments}(e)?e.collapseButton:i`<div></div>`} <div class="min-w-0 ${c(e)?`rounded-ee-[0.5rem] relative pe-sm pb-2xs mb-[1px] ${r.bg}`:""}"> ${c(e)?i` <div class="absolute top-0 start-[-12.5px] w-[11.5px] xs:start-[-16.5px] xs:w-[15.5px] h-full pointer-events-none ${r.bg} ${r.border} ${e.isSctReplacementEnabled&&e.isCurrentPermalink?"rounded-bl-[0.5rem]":""}"></div> `:""} ${i`<slot name="actionRow"></slot>`} ${i`<slot name="awardsRow"></slot>`} </div> </div> <div class="contents"> <div></div> <div class="min-w-0">${i`<slot name="next-reply"></slot>`}</div> </div> <div id="comment-children" class="contents ${e.isThreadLineHovered?"[&>.threadline>*]:border-tone-2":"[&>.threadline>*]:border-tone-4"}"> ${function(e){const{html:t,currentTreePosition:o,hasMoreLink:i,hasRenderedComments:r}=e;if(!i&&!r)return t``;if("at-fold"!==o)return t``;return t` ${u(e,{isLastRenderedNode:!0,isComment:!1})} ${t`<slot name="more-comments-permalink"></slot>`} `}(e)} ${t} </div> </div> <ac-call trigger="init" delay="10000" target="closest(shreddit-comment)" method="maybeScheduleReloadPolling"></ac-call> </details> `;}function m(e){return e.awardCount>0}function c(e){return e.isSctReplacementEnabled?e.isCurrentPermalink:!e.isPdpSeekerM1LO&&(e.isHighlighted||m(e))}function u(e,{isLastRenderedNode:t,isComment:o}){const i="box-border h-md border-0 border-tone-4 border-solid border-b-[1px] "+(t?"cursor-pointer":""),r=`${i} w-[calc(50%+0.5px)] border-s-[1px] rounded-es-[12px]`,n=`${i} w-xs absolute end-[-8px]`;return e.html` <div class="threadline flex justify-end align-start relative${t?" bg-neutral-background":" pointer-events-none"}" aria-hidden="true"> <div @mouseenter="${t?e.onThreadLineMouseEnter:void 0}" @mouseleave="${t?e.onThreadLineMouseLeave:void 0}" @click="${t?e.handleToggle:void 0}" class="${r}" data-testid="branch-line"></div> ${o?"":e.html`<div @mouseenter="${t?e.onThreadLineMouseEnter:void 0}" @mouseleave="${t?e.onThreadLineMouseLeave:void 0}" @click="${t?e.handleToggle:void 0}" class="${n}"></div>`} </div> `}var p;!function(e){e.TEXT="text",e.IMAGE="image",e.GIPHY="giphy",e.VIDEO="video"}(p||(p={})),SML.di("./0L2Tupqo3g.js",import.meta.url,"0L2Tupqo3g"),SML.di("./C2AqOgl1ck.js",import.meta.url,"C2AqOgl1ck"),SML.di("./BXVjrD3g4A.js",import.meta.url,"BXVjrD3g4A");const g=["post_detail/click/collapse_comment","post_detail/click/expand_comment","post_detail/click/reply_comment","post_detail/click/upvote_comment","post_detail/click/downvote_comment","post_detail/click/comment_image","comment/click/load_more_comments","comment/consume/comment","comment/consume/collapsed_comment","comment/view/comment","comment/view/collapsed_comment","comment/click/report","comment/click/ignore_reports","comment/click/restore_reports"],T=["FACEPLATE-IMG",...e.bw,"IMG"],v='div[slot="comment"]',b="none",E="text-neutral-content-strong bg-neutral-background overflow-visible";let y=class extends t.s{get _rplHovercards(){return this.querySelectorAll('[slot="commentAvatar"] rpl-hovercard > div:not([slot="content"]), [slot="commentMeta"] rpl-hovercard > div:not([slot="content"])')}getProps(){return{ariaLabel:this.ariaLabel,author:this.author,awardCount:this.awardCount,collapsed:this.collapsed,currentTreePosition:this.currentTreePosition,collapseButton:this.renderCollapseButton(),handleCommentMetaSlotClick:this.handleCommentMetaSlotClick,handleContentSlotClick:this.handleContentSlotClick,handleSummaryClick:this.handleSummaryClick,handleToggle:this.handleToggle,hasMoreLink:this.hasMoreLink,hasRenderedComments:this.hasRenderedComments,html:t.x,isCommentDeleted:this.isCommentDeleted,isHighlighted:this.isHighlighted,isInEditMode:this.isInEditMode,isPdpSeekerM1LO:this.isPdpSeekerM1LO,isThreadLineHovered:this.isThreadLineHovered,onThreadLineMouseEnter:this.onThreadLineMouseEnter,onThreadLineMouseLeave:this.onThreadLineMouseLeave,thingId:this.thingId,uncollapseButton:this.renderUncollapseButton(),withHotkeys:this.withHotkeys,isSctReplacementEnabled:this.isSctReplacementEnabled,isCurrentPermalink:this.isCurrentPermalink}}static get styles(){return[e.t,e.a0(":host {\n  display: block;\n}\n:host([is-chosen-mq-comment]) slot[name='comment']::slotted(*) {\n  background-color: var(--color-neutral-background-selected);\n  padding-block: 8px;\n  margin-bottom: 4px;\n}\ndetails {\n  position: relative;\n}\ndetails > summary {\n  list-style: none;\n  padding-bottom: 2px;\n}\ndetails > summary:focus {\n  outline: none;\n}\ndetails > summary::-webkit-details-marker {\n  display: none;\n}\n.summary-flex {\n  display: flex;\n  margin-right: 0;\n  flex-direction: row;\n  align-items: center;\n}\nsummary > *,\n.summary-flex > * {\n  white-space: nowrap;\n}\nsummary > *,\n.summary-flex > * {\n  white-space: nowrap;\n}\n.contents {\n  padding-left: 1.75rem;\n  line-height: 1.0625rem;\n}\n:host([updateAnimation~='light']) {\n  animation: realtimeFade 3s;\n  animation-timing-function: ease-out;\n}\n:host([updateAnimation~='dark']) {\n  animation: realtimeFadeNight 3s;\n  animation-timing-function: ease-out;\n}\n@keyframes realtimeFade {\n  from {\n    background-color: #fff2bd;\n    border: 1px solid #dbaf00;\n  }\n  to {\n    background-color: #f0f5f9;\n    border: 1px solid transparent;\n  }\n}\n@keyframes realtimeFadeNight {\n  from {\n    background-color: #665505;\n    border: 1px solid #382d03;\n  }\n  to {\n    background-color: #030303;\n    border: 1px solid #343536;\n  }\n}\n")]}constructor(){super(),this.thingId="",this.avatar="",this.author="",this.parentId="",this.postId="",this.score="",this.awardCount=0,this.isAuthorDeleted=!1,this.isCommentDeleted=!1,this.isInEditMode=!1,this.depth=0,this.permalink="",this.parentPermalink="",this.isUserOP=!1,this.isHighlighted=!1,this.reloadUrl="",this.isCurrentPermalink=!1,this.contentType=p.TEXT,this.isTranslatable=!1,this.isTranslationFetched=!1,this.isCommentTranslated=!1,this.translationExperience="",this.previousActionsFeature=!1,this.isSctReplacementEnabled=!1,this.collapsed=!1,this.isChosenMqComment=!1,this.updateAnimation=void 0,this.ariaLabel=null,this.isPdpSeekerM1=!1,this.isPdpSeekerM1LO=!1,this.withHotkeys=!1,this.recordTTCI=!1,this.replyPermalink="",this.updateState=void 0,this.observer=null,this.targetElement=null,this.consumeTimeoutId=void 0,this._outboundLinkTrackingController=new s.O(this,(()=>({pageType:e.H(),postId:this.postId,commentId:this.thingId}))),this.pubsub=new e.u(this),this._events=new e.E(this),this._awardController=new n.A(this,{getThingId:()=>this.thingId,onAward:()=>this.awardCount++}),this.currentTreePosition=null,this.handleHovercardTriggerClick=e=>{e.metaKey||e.preventDefault()},this.onHotkeysFocus=e=>{this.shadowRoot?.querySelector("details")?.focus(e)},this.handleObserverIntersection=t=>{t.forEach((t=>{if(t.isIntersecting){if(this.isTranslatable&&[e.b3.ENImmersive,e.b3.UXUpdate].includes(this.translationExperience)){const t=document.querySelector(`shreddit-post[id*="${this.postId}"]`);l.o.comment(this,{id:this.thingId,parent_id:this.parentId,post_id:this.postId,score:parseInt(this.score,10)||void 0,type:"comment",created_timestamp:e.cN(this.created),content_type:this.contentType,translation_state:this.isCommentTranslated,translation_language:t?.translationLanguage},this.translationExperience)}const t={comment_id:this.thingId,comment_parent_id:this.parentId,comment_depth:this.depth,comment_content_type:this.contentType};this.entityFilterId&&(t.entity_filter_id=this.entityFilterId),this.dispatchEvent(e.c("comments-viewed-event",{detail:t})),this.consumeTimeoutId=setTimeout((()=>{this.dispatchEvent(e.c("comments-consumed-event",{detail:t}))}),o.am)}else clearTimeout(this.consumeTimeoutId)}))},this.handleCommentEvents=t=>{if(!(e=>g.includes(e.SAN))(t))return;const o=t.detail;o.comment?.id||(o.comment={...o.comment,id:this.thingId,parent_id:this.parentId,post_id:this.postId,score:parseInt(this.score,10)||void 0,type:"comment",created_timestamp:e.cN(this.created),content_type:this.contentType===p.TEXT?void 0:this.contentType},"comment/click/report"===e.bb(o)&&(o.thingId=this.thingId,o.permalink=this.permalink))},this.handleSummaryClick=e=>{e.fromCommentMeta&&"A"!==e.target.tagName&&!e.target.closest("a")&&e.preventDefault()},this.handleCommentMetaSlotClick=e=>{e.fromCommentMeta="commentMeta"!==e.target.slot},this.handleMoreButtonClick=t=>{this.pubsub.publish(e.T.TriggerCommentBlockingAuth,{source:a.C.Button}),e.i(this,o.bu());const i=t.currentTarget;i?.addEventListener("faceplate-response",(()=>{const e=new MutationObserver((t=>{t.some((e=>Array.from(e.removedNodes).some((e=>e===i))))&&(this.updateChildren(),e.disconnect())}));e.observe(this,{childList:!0})}))},this.handleContentSlotClick=t=>{if(t.target&&this.contentType!==p.TEXT){const i=t.target.tagName;T.includes(i)&&e.i(this,o.bv())}},this.handleReload=e=>{e.stopPropagation(),this.reload()},this.handleCommentCreated=({parentThingId:t,body:o})=>{if(t!==this.thingId)return;if(!o)return;const i=e.bk(o).find((e=>"shreddit-comment"===e.tagName.toLowerCase()));i&&(i.setAttribute("slot","children"),i.setAttribute("depth",(this.depth+1).toString()),i.removeAttribute("class"),this.append(i),this.updateChildren())},this.convertCommentToDeleted=({commentId:e})=>{this.thingId===e&&(this.hideCommentActionRow(),this.hideOpIcon(),this.replaceCommentAuthorWithDeletedText(),this.hideCommentContent())},this.hideOpIcon=()=>{const e=this.querySelector('div[slot="commentMeta"] > span > .comment-op-icon-js');e&&(e.style.display=b)},this.hideCommentActionRow=()=>{const e=this.querySelector("shreddit-comment-action-row");e&&(e.style.display=b)},this.replaceCommentAuthorWithDeletedText=()=>{const e=this.querySelector('div[slot="commentMeta"] .author-name-meta');e&&e.replaceWith(this.getDeletedAuthorHTML())},this.hideCommentContent=()=>{const e=this.querySelector(v);e&&(e.style.display=b)},this.hasRenderedComments=!1,this.hasMoreLink=!1,this._children=null,this.unsubscribeFaceplateRequestListeners=[],this.isThreadLineHovered=!1,this.onThreadLineMouseEnter=()=>{this.isThreadLineHovered=!0,this.requestUpdate()},this.onThreadLineMouseLeave=()=>{this.isThreadLineHovered=!1,this.requestUpdate()},this.addEventListener("faceplate-track",this.handleCommentEvents),this.addEventListener("reload-shreddit-comment",this.handleReload),this._events.define("click",(e=>{const t=e.composedPath().find((e=>e.hasAttribute?.("data-more-comments-partial-id")));t&&t.querySelectorAll("icon-load").forEach((e=>e.classList.add("animate-spin")))}))}get hasAwardedTreatment(){return this.awardCount>0}get isCommentHighlighted(){return this.isSctReplacementEnabled?this.isCurrentPermalink:this.isHighlighted||this.hasAwardedTreatment}getReplyPermalink(){const e=new URL(location.origin+this.permalink);return e.searchParams.set("reply",this.thingId),e.searchParams.set(s.a.ForceLegacySCT,"1"),e.href.substring(e.origin.length)}setVisibility(e=Number.POSITIVE_INFINITY,t){const o=this.querySelector("shreddit-comment[is-chosen-mq-comment]")||this.closest("shreddit-comment[is-chosen-mq-comment]"),i=e-(this.depth+1);this.replyPermalink=0===i?this.getReplyPermalink():"";const r=!!o&&"number"==typeof t&&this.depth>=e&&this.depth<=t,n=this.currentTreePosition;this.currentTreePosition=o&&"number"==typeof t?!r&&this.depth<t?"hidden-above-fold":this.depth<e-1?"above-fold":this.depth===e-1?"at-fold":"below-fold":i>0?"above-fold":0===i?"at-fold":"below-fold",null!==n&&n===this.currentTreePosition||(this.style.display="below-fold"===this.currentTreePosition?"none":"",this.ariaHidden="below-fold"===this.currentTreePosition?"true":"false",this.updateChildren())}async setInitialVisibility(){customElements.get("shreddit-comment-tree")||(await window.customElements.whenDefined("shreddit-comment-tree"));const e=this.closest("shreddit-comment-tree");let t=e?.visibilityDetails;null===t&&e?.depthUpdated&&(t=await e.depthUpdated),this.setVisibility(t?.maxVisibleDepth,t?.minVisibleDepth)}connectedCallback(){super.connectedCallback(),this.initObserver(),this.setInitialVisibility(),this.isUserOP&&this.pubsub.subscribe(e.T.CommentDeleted,this.convertCommentToDeleted),this.pubsub.subscribe(e.T.CommentCreated,this.handleCommentCreated),this.addEventListener(o.b0,this.resetToReadMode),this.addEventListener(o.bw,this.resetToReadMode),this.addEventListener("comment-animation-trigger",this.handleTriggerAnimation),this._rplHovercards?.forEach((e=>{e.addEventListener("click",this.handleHovercardTriggerClick)})),this.recordTTCI&&e.fI()&&requestAnimationFrame((()=>{const t=e.fJ(performance.now());t&&e.i(this,t)}))}async scrollToFocusedComment(){this.updateComplete.then((async()=>{await requestAnimationFrame((()=>{d.a((()=>{window.dispatchEvent(e.c(d.E))}));const t=document.querySelector("nav")?.offsetHeight??0,o=document.getElementById("pdp-seeker-mweb-return-to-results")?.offsetHeight??0,i=document.querySelector("shreddit-comments-page-tools, comment-body-header"),r=this.querySelector('[slot="actionRow"]');if(!r||!i)return;const n=r.getBoundingClientRect().bottom,s=i.getBoundingClientRect().top;Math.abs(n-s)<window.innerHeight-(t+o)?d.s("instant"):r.scrollIntoView({behavior:"instant",block:"center"})}))}))}firstUpdated(){this.querySelector(v)?.addEventListener("click",this.handleContentSlotClick),this.isChosenMqComment&&this.updateComplete.then((()=>{setTimeout((()=>{const e=document.getElementById("mod-queue-pdp-panel");if(!e)return;const t=this.getBoundingClientRect().top-48-window.innerHeight/2,o=document.getElementsByTagName("shreddit-comment-tree")[0]||this;e?.scrollTop>o?.getBoundingClientRect().top||e.scrollTo({top:t,behavior:"auto"})}),200)})),this.isSctReplacementEnabled&&this.isCurrentPermalink&&this.updateComplete.then((()=>this.scrollToFocusedComment()))}disconnectedCallback(){super.disconnectedCallback(),this.disconnectObserver(),this.clearConsumeTimeout(),this.removeEventListener(o.b0,this.resetToReadMode),this.removeEventListener(o.bw,this.resetToReadMode),this.removeEventListener("comment-animation-trigger",this.handleTriggerAnimation),this._rplHovercards?.forEach((e=>{e.removeEventListener("click",this.handleHovercardTriggerClick)}))}get shredditComposer(){return this.querySelector("shreddit-composer")}get shareButton(){return this.querySelector("[slot=actionRow]")?.querySelector("shreddit-comment-share-button")}get overlowMenuItemProps(){return this.querySelector("shreddit-overflow-menu")?.getMenuItemProps()}get commentActionRow(){return this.querySelector("shreddit-comment-action-row")}handleTriggerAnimation(e){this.updateState=e.detail,this.triggerRealtimeUpdateAnimation()}triggerRealtimeUpdateAnimation(){const t=e.ae();this.updateAnimation=t?"dark":"light",this.updateState=void 0,setTimeout((()=>{this.updateAnimation=void 0}),3e3)}clearConsumeTimeout(){this.consumeTimeoutId&&(clearTimeout(this.consumeTimeoutId),this.consumeTimeoutId=void 0)}maybeScheduleReloadPolling(){this.reloadPollingIntervalMs&&this.reloadPollingDurationMs&&this.reloadPollingDurationMs>0&&this.reload()}async reload({richTextMedia:t,includeTranslation:i}={}){if(!this.reloadUrl||!this.parentNode)return!1;const r=new URL(location.origin+this.reloadUrl);t&&r.searchParams.set("richTextMedia",t),i&&r.searchParams.set("includeTranslation","true"),this.reloadPollingDurationMs&&this.reloadPollingIntervalMs&&r.searchParams.set(o.bx,(this.reloadPollingDurationMs-(this.reloadPollingIntervalMs+100)).toString()),this.slot&&r.searchParams.set("slot",this.slot);const n=this.parentNode,s=document.createElement("faceplate-partial");s.setAttribute("loading",e.y.Programmatic),s.setAttribute("src",r.href.substring(r.origin.length)),s.setAttribute("slot","children");const a=this.slot;s.slot=a,n.insertBefore(s,this),this.slot="";const d=this.querySelector('[slot="actionRow"]'),l="SHREDDIT-COMMENT-ACTION-ROW"===d?.tagName?d:d?.querySelector("shreddit-comment-action-row"),h=l?.isCommentComposerActive??!1;s.appendChild(this);const m=this.querySelectorAll(":scope > [slot^=children]");e.fK(s),await s.load();const c=n.querySelector(`shreddit-comment[thingid=${this.thingId}]`);if(!0===h&&null!=d){const e=c?.querySelector('[slot="actionRow"]');e?.replaceWith(d)}if(m.length>0){for(const e of m)c?.appendChild(e);c&&(c.slot=a,c.updateChildren())}return!0}initObserver(){this.targetElement=this.querySelector('div[slot="comment"]'),this.targetElement&&(this.observer=new IntersectionObserver(this.handleObserverIntersection,{root:null,threshold:.5}),this.observer.observe(this.targetElement))}addTranslationToggledObserver(e){this.targetElement=this.querySelector(e),this.targetElement&&this.observer&&this.observer.observe(this.targetElement)}disconnectObserver(){this.observer&&(this.clearConsumeTimeout(),this.observer.disconnect())}handleToggle(e){!e.target.open!==this.collapsed&&this.handleCollapse()}handleCollapse(){this.collapsed=!this.collapsed,e.i(this,this.collapsed?o.by():o.bz())}resetToReadMode(){this.removeAttribute("edit-mode"),this.querySelector("shreddit-comment-action-row")?.classList.remove("hidden");let t=`${o.bA}?commentId=${this.thingId}`;this.isCommentTranslated&&(t=e.cb(t,"isTranslated","true"));const i=e.fL("faceplate-partial",{id:`comment-${this.thingId}-edit-partial`,src:t,loading:e.y.Programmatic}),r=e.fL("faceplate-shimmer",{class:"h-[100px] w-full hidden",shape:"pill"});i.appendChild(r),this.querySelector(`[slot="comment-${this.thingId}-edit"]`)?.replaceWith(i)}renderCollapseButton(){const n=o.j("flex justify-center self-start py-[2px] bg-neutral-background relative",this.isPdpSeekerM1?"mt-[2px]":"mt-[6px]");return t.x` <div class="${n}"> ${e.o({appearance:"plain",attributes:{onclick:this.handleCollapse,className:o.j(E,this.isCommentHighlighted?"!w-md h-md relative z-1":"w-md h-md"),"aria-expanded":this.collapsed?"false":"true","aria-label":"Toggle Comment Thread","aria-controls":"comment-children"},leadingIcon:this.collapsed?i.a({size:t.I.Small}):r.s({size:t.I.Small}),size:e.q.Small})} </div> `}renderUncollapseButton(){return t.x` <div class="flex justify-center"> ${e.o({appearance:"plain",attributes:{onclick:this.handleCollapse,className:o.j(E,"w-lg xs:w-xl h-xl xs:h-[40px]")},leadingIcon:i.a({size:t.I.Small}),size:e.q.Small})} </div> `}getDeletedAuthorHTML(){const e=document.createElement("div");e.classList.add("flex","flex-row","items-center","overflow-hidden");const t=document.createElement("faceplate-tracker");t.setAttribute("source","post_detail"),t.setAttribute("action","click"),t.setAttribute("noun","comment_deleted_author"),t.classList.add("contents");const i=document.createElement("span");return i.classList.add("truncate","font-bold","hover:no-underline"),i.classList.add("text-neutral-content-strong","text-12"),i.innerText=o.x(),t.appendChild(i),e.appendChild(t),e}renderCommentBody(){return this.isCommentDeleted||this.isInEditMode?"":t.x` <div class="relative"> <slot name="comment"></slot> </div> `}renderChildren(e,{forceUpdate:t}={}){if(this._children&&!t)return"above-fold"===this.currentTreePosition||"hidden-above-fold"===this.currentTreePosition?this._children:[];const o=Array.from(this.querySelectorAll(':scope > [slot^="children"]'));if(this.hasRenderedComments=o.some((e=>"shreddit-comment"===e.tagName.toLowerCase())),this.hasMoreLink=o.some((e=>"shreddit-comment"!==e.tagName.toLowerCase())),"above-fold"!==this.currentTreePosition&&"hidden-above-fold"!==this.currentTreePosition)return[];this.unsubscribeFaceplateRequestListeners.forEach((e=>e())),this.unsubscribeFaceplateRequestListeners=[];const i=[];this._children=[];for(let e=0;e<o.length;e++){const t=o[e],r="shreddit-comment"===t.tagName.toLowerCase(),n="faceplate-partial"===t.tagName.toLowerCase();i.push(r);const s=`children-${this.thingId}-${e}`;t.slot=s,n&&(t.addEventListener("faceplate-request",this.handleMoreButtonClick),this.unsubscribeFaceplateRequestListeners.push((()=>{t.removeEventListener("faceplate-request",this.handleMoreButtonClick)})))}return this._children=function(e,t){const{html:o,currentTreePosition:i}=e;if("above-fold"!==i&&"hidden-above-fold"!==i)return[];const r=[];for(let i=0;i<t.length;i++){const n=i===t.length-1,s=t[i],a=`children-${e.thingId}-${i}`;r.push(u(e,{isLastRenderedNode:n,isComment:s})),r.push(o`<slot name="${a}"></slot>`)}return r}(e,i),this._children}updateChildren(){this.renderChildren(this.getProps(),{forceUpdate:!0}),this.requestUpdate()}render(){const e=this.renderChildren(this.getProps());return"hidden-above-fold"===this.currentTreePosition?e:h(this.getProps(),e)}};return e._([e.n({type:String})],y.prototype,"thingId",void 0),e._([e.n({type:String})],y.prototype,"avatar",void 0),e._([e.n({type:String})],y.prototype,"author",void 0),e._([e.n({type:String})],y.prototype,"created",void 0),e._([e.n({type:String})],y.prototype,"parentId",void 0),e._([e.n({type:String})],y.prototype,"postId",void 0),e._([e.n({type:String})],y.prototype,"score",void 0),e._([e.n({type:Number,attribute:"award-count",reflect:!0})],y.prototype,"awardCount",void 0),e._([e.n({type:Boolean,attribute:"is-author-deleted"})],y.prototype,"isAuthorDeleted",void 0),e._([e.n({type:Boolean,attribute:"is-comment-deleted"})],y.prototype,"isCommentDeleted",void 0),e._([e.n({type:Boolean,attribute:"edit-mode"})],y.prototype,"isInEditMode",void 0),e._([e.n({type:Number})],y.prototype,"depth",void 0),e._([e.n({type:String})],y.prototype,"permalink",void 0),e._([e.n({type:String,attribute:"parent-permalink"})],y.prototype,"parentPermalink",void 0),e._([e.n({type:Boolean,attribute:"is-user-op"})],y.prototype,"isUserOP",void 0),e._([e.n({type:Boolean,attribute:"is-highlighted"})],y.prototype,"isHighlighted",void 0),e._([e.n({type:String,attribute:"reload-url"})],y.prototype,"reloadUrl",void 0),e._([e.n({type:Boolean,attribute:"is-current-permalink"})],y.prototype,"isCurrentPermalink",void 0),e._([e.n({type:String,attribute:"content-type"})],y.prototype,"contentType",void 0),e._([e.n({type:Boolean,attribute:"is-translatable"})],y.prototype,"isTranslatable",void 0),e._([e.n({type:Boolean,attribute:"is-translation-fetched"})],y.prototype,"isTranslationFetched",void 0),e._([e.n({type:Boolean,attribute:"is-comment-translated",reflect:!0})],y.prototype,"isCommentTranslated",void 0),e._([e.n({type:String,attribute:"translation-experience"})],y.prototype,"translationExperience",void 0),e._([e.n({type:String,attribute:"moderation-verdict"})],y.prototype,"moderationVerdict",void 0),e._([e.n({type:Boolean,attribute:"previous-actions-feature"})],y.prototype,"previousActionsFeature",void 0),e._([e.n({type:Boolean,attribute:"sct-replacement-enabled"})],y.prototype,"isSctReplacementEnabled",void 0),e._([e.n({type:Number,attribute:"reload-polling-interval-ms"})],y.prototype,"reloadPollingIntervalMs",void 0),e._([e.n({type:Number,attribute:"reload-polling-duration-ms"})],y.prototype,"reloadPollingDurationMs",void 0),e._([e.n({type:Boolean,reflect:!0})],y.prototype,"collapsed",void 0),e._([e.n({type:Boolean,attribute:"is-chosen-mq-comment"})],y.prototype,"isChosenMqComment",void 0),e._([e.n({type:String,reflect:!0})],y.prototype,"updateAnimation",void 0),e._([e.n({type:String})],y.prototype,"ariaLabel",void 0),e._([e.n({type:String,attribute:"entity-filter-id",reflect:!0})],y.prototype,"entityFilterId",void 0),e._([e.n({type:Boolean,attribute:"is-pdp-seeker-m1"})],y.prototype,"isPdpSeekerM1",void 0),e._([e.n({type:Boolean,attribute:"is-pdp-seeker-m1-lo"})],y.prototype,"isPdpSeekerM1LO",void 0),e._([e.n({type:Boolean,attribute:"with-hotkeys"})],y.prototype,"withHotkeys",void 0),e._([e.n({type:Boolean,attribute:"record-ttci"})],y.prototype,"recordTTCI",void 0),e._([e.n({type:String,attribute:"reply-permalink",reflect:!0})],y.prototype,"replyPermalink",void 0),e._([e.h()],y.prototype,"updateState",void 0),y=e._([e.e("shreddit-comment")],y),{get C(){return p}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("CsrbxKoUKW",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,n)=>{const{svg:t}=e.a(),l=e.m(t`<path d="M10 13.7a.897.897 0 01-.636-.264l-4.6-4.6a.9.9 0 111.272-1.273L10 11.526l3.964-3.963a.9.9 0 011.272 1.273l-4.6 4.6A.897.897 0 0110 13.7z"></path>`,"0 0 20 20","caret-down");return{c:l,d:({selected:t,selectedIcon:a,size:s=e.q.Medium,unselectedIcon:i,...c})=>{const{html:r}=e.a();return e.h3({...c,attributes:{...c.attributes},size:s,selected:t,leadingIcon:t?a:i,trailingIcon:r`<span class="inline-flex dropdown-icon ${c.children&&"ml-2xs"}"> ${l({size:s===e.q.Small?n.I.Small:n.I.Medium})} </span>`,dropdown:!0})},f:function(e){return null!=e}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./CsrbxKoUKW.js",import.meta.url,"CsrbxKoUKW");SML.di("./0hqgxSo9Jy.js",import.meta.url,"0hqgxSo9Jy");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./CwJMtJ-bLN.js",import.meta.url,"CwJMtJ-bLN");SML.di("./COCf9Sdqlx.js",import.meta.url,"COCf9Sdqlx");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");
SML.dm("CtaRzYFrol",["Dw4vb8Yfbm","5r73EsgItq","CsrbxKoUKW","0hqgxSo9Jy","D_g7f2Ewyi","CwJMtJ-bLN","COCf9Sdqlx","BYzqEZ3uv3","eY7T41bKac","tO6bKRQro7","Cv4mWnWE30","B-zFJtiar6","Bu440t6XLo","BeFppRYbzE"],(async(e,t,r,a,o,s,i)=>{const n=t.s;var d,l;!function(e){e.ICON="icon",e.TEXT="text",e.ICON_AND_TEXT="icon_and_text"}(d||(d={}));class p extends n{constructor(){super(...arguments),this.withoutTooltip=!1,this.dropdownHeaderText="",this.selectedItemDisplayType=d.TEXT,this.disabled=!1,this.isEntityFilterEnabled=!1,this.useStrongTextColor=!1,this.isDropdownOpen=!1,this.onDropdownClose=()=>{this.isDropdownOpen=!1,this.tooltip?.hide?.()},this.onDropdownOpen=()=>{this.isDropdownOpen=!0},this.onClickDropdownItem=e=>{this.onSelectDropdownItem(e)},this.onKeyUpDropdownItem=e=>{"Enter"===e.key&&(this.onSelectDropdownItem(e),this.dropdownMenu?.close())},this.renderDropdownMenu=(o,s,i)=>{const n=this.isEntityFilterEnabled?e.o({appearance:"bordered",attributes:{"aria-expanded":this.isDropdownOpen?"true":"false","aria-label":this.buttonAriaLabel||this.getAriaLabel(s),id:this.triggerId,disabled:this.disabled},selected:this.isDropdownOpen,size:e.q.Small,leadingIcon:a.f({size:t.I.Small})}):r.d({appearance:"plain",attributes:{"aria-expanded":this.isDropdownOpen?"true":"false","aria-label":this.buttonAriaLabel||this.getAriaLabel(s),className:this.disabled?"":this.useStrongTextColor?"text-neutral-content":"text-neutral-content-weak",id:this.triggerId,disabled:this.disabled},children:o,selected:this.isDropdownOpen,size:e.q.Small}),d=t.x` <faceplate-tracker class="block" source="${this.telemetrySource}" action="click" noun="sorting"> ${n} </faceplate-tracker>`;return t.x`<faceplate-dropdown-menu class="nd:hidden" .onopen="${this.onDropdownOpen}" .onclose="${this.onDropdownClose}" ?disabled="${this.disabled}"> ${this.withoutTooltip?d:this.wrapWithTooltip(d)} <faceplate-menu slot="menu" class="overflow-y-auto max-h-[50vh]" hidden @keyup="${this.onKeyUpDropdownItem}" @click="${this.onClickDropdownItem}"> ${this.dropdownHeaderText?t.x`<div class="font-semibold m-md mb-xs">${this.dropdownHeaderText}</div>`:""} ${i} </faceplate-menu> </faceplate-dropdown-menu>`}}static get styles(){return[e.t]}connectedCallback(){super.connectedCallback(),this.mutationObserver=new MutationObserver((e=>{e.forEach((e=>{const t=e.target;"FACEPLATE-MENU"===t.nodeName&&t.hasAttribute("hidden")&&this.isDropdownOpen&&this.onDropdownClose()}))})),this.mutationObserver.observe(this.shadowRoot,{attributes:!0,attributeFilter:["hidden"],childList:!1,characterData:!1,subtree:!0})}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect()}fireOffSortEvents(t,r){var a,o;r&&(this.sortEvent&&this.dispatchEvent(e.c(this.sortEvent,{selected:r,event:t})),this.telemetrySource&&e.i(this,(a=this.telemetrySource,o=r.toLowerCase(),e.b({source:a,action:"click",noun:o}))))}wrapWithTooltip(e){return t.x` <rpl-tooltip class="nd:hidden block" appearance="inverted" trigger="hover focus-visible" aria-label="${this.dropdownHeaderText}"> ${e} <slot slot="content" name="tooltip-content"></slot> </rpl-tooltip> `}getAriaLabel(e){return e?`${this.dropdownHeaderText}: ${e}`:this.dropdownHeaderText;}}e._([e.a2("rpl-tooltip")],p.prototype,"tooltip",void 0),e._([e.a2("faceplate-dropdown-menu")],p.prototype,"dropdownMenu",void 0),e._([e.a2("faceplate-tracker button")],p.prototype,"menuButton",void 0),e._([e.n({type:Boolean,attribute:"without-tooltip"})],p.prototype,"withoutTooltip",void 0),e._([e.n({type:String,attribute:"header-text"})],p.prototype,"dropdownHeaderText",void 0),e._([e.n({type:String,attribute:"button-aria-label"})],p.prototype,"buttonAriaLabel",void 0),e._([e.n({type:String,attribute:"selected-item-display-type"})],p.prototype,"selectedItemDisplayType",void 0),e._([e.n({type:String,attribute:"sort-event"})],p.prototype,"sortEvent",void 0),e._([e.n({type:String,attribute:"telemetry-source"})],p.prototype,"telemetrySource",void 0),e._([e.n({type:String,attribute:"trigger-id"})],p.prototype,"triggerId",void 0),e._([e.n({type:Boolean})],p.prototype,"disabled",void 0),e._([e.n({type:Boolean,attribute:"entity-filter-enabled"})],p.prototype,"isEntityFilterEnabled",void 0),e._([e.n({type:Boolean,attribute:"use-strong-text-color"})],p.prototype,"useStrongTextColor",void 0),e._([e.h()],p.prototype,"isDropdownOpen",void 0),function(e){e.ICON="icon",e.TEXT="text",e.ICON_AND_TEXT="icon_and_text"}(l||(l={}));let u=class extends p{constructor(){super(...arguments),this.setCurrentlySelectedItem=e=>{if(!e)return;const{innerText:r}=e;if(this.currentlySelectedItemLabel=r,this.selectedItemDisplayType===l.TEXT)this.currentlySelectedItem=r;else{const a=(this.querySelector('[slot="selected-item-icon-override"]')??e).querySelector("svg"),o=a?.getAttribute("icon-name")?.includes("fill");if(!a||o)return;const s=t.x`${a}`;this.selectedItemDisplayType===l.ICON?this.currentlySelectedItem=s:this.currentlySelectedItem=t.x`<span class="flex"><span class="flex items-center mr-xs">${s}</span><span>${r}</span></span>`}},this.toggleSelectedItemUI=e=>{const t=this.querySelector("li[rpl-selected]"),r=t?.querySelector('[role="menuitem"]');t?.removeAttribute("rpl-selected"),r?.setAttribute("aria-selected","false");const a=e?.querySelector('[role="menuitem"]');if(e?.setAttribute("rpl-selected",""),a?.setAttribute("aria-selected","true"),a&&r){const e=r?.className;r.className=a.className,a.className=e}},this.silentlySelectItemByValue=e=>{const t=this.querySelector(`[value="${e}"]`);if(t){const e=t?.querySelector("li");this.setCurrentlySelectedItem(e),this.toggleSelectedItemUI(e)}},this.onSelectDropdownItem=e=>{const t=e.target,r=t?.closest("li");this.setCurrentlySelectedItem(r),this.toggleSelectedItemUI(r);const a=t?.closest("data")?.getAttribute("value")||void 0;this.fireOffSortEvents(e,a)}}connectedCallback(){super.connectedCallback(),requestAnimationFrame((()=>{const e=this.querySelector('[slot="selected-item"]');this.setCurrentlySelectedItem(e)}))}render(){return this.renderDropdownMenu(this.currentlySelectedItem,this.currentlySelectedItemLabel,t.x` <slot name="dropdown-items"></slot>`)}};e._([e.h()],u.prototype,"currentlySelectedItem",void 0),u=e._([e.e("shreddit-sort-dropdown")],u);const{svg:h}=e.a(),c=e.m(h`<path d="M15.22 8.6c-.6-3.51-2.68-6.21-4.76-7.47a.912.912 0 00-.93 0C7.59 2.3 5.37 4.89 4.76 8.61c-2.77 2.65-4.02 4.46-3.57 7.32.17 1.08 1.14 1.9 2.27 1.9h3.18c.61.72 1.53 1.17 2.51 1.17h1.71c.98 0 1.9-.44 2.51-1.17h3.18c1.12 0 2.1-.82 2.27-1.9.45-2.87-.8-4.67-3.59-7.33h-.01zM2.97 15.65c-.24-1.53.15-2.65 1.66-4.33.1 1.83.55 3.45 1.06 4.71H3.46c-.24 0-.45-.17-.49-.38zm6.18 1.55c-.57 0-1.09-.32-1.33-.81-.64-1.31-1.41-3.37-1.41-5.78 0-3.71 1.84-6.34 3.6-7.63 1.81 1.35 3.6 4.16 3.6 7.63 0 2.41-.77 4.47-1.41 5.78-.24.49-.77.81-1.33.81H9.15zm7.88-1.55c-.03.21-.25.38-.49.38h-2.23c.51-1.26.96-2.88 1.06-4.71 1.51 1.69 1.9 2.8 1.66 4.33z"></path><path d="M10 8.35c-.91 0-1.65.74-1.65 1.65 0 .91.74 1.65 1.65 1.65.91 0 1.65-.74 1.65-1.65 0-.91-.74-1.65-1.65-1.65z"></path>`,"0 0 20 20","best"),{svg:N}=e.a(),m=e.m(N`<path d="M17.1 11.03h-3.3V8.98h1.17a1.328 1.328 0 00.94-2.27l-5.27-5.28c-.34-.34-.94-.34-1.27 0L4.09 6.71c-.38.38-.49.95-.29 1.45.21.5.69.82 1.23.82H6.2v2.05H2.9a1.9 1.9 0 00-1.9 1.9v2.6c0 1.82 1.48 3.3 3.3 3.3h11.4c1.82 0 3.3-1.48 3.3-3.3v-2.6a1.9 1.9 0 00-1.9-1.9zM10 3.34l3.83 3.84H12v7.85c0 1.1-.9 2-2 2s-2-.9-2-2V7.18H6.17L10 3.34zM2.8 15.52v-2.6c0-.06.04-.1.1-.1h3.3v2.2c0 .74.22 1.42.58 2H4.3c-.83 0-1.5-.67-1.5-1.5zm14.4 0c0 .83-.67 1.5-1.5 1.5h-2.48c.36-.58.58-1.26.58-2v-2.2h3.3c.05 0 .1.04.1.1v2.6z"></path>`,"0 0 20 20","top"),{svg:g}=e.a(),T=e.m(g`<path d="M18.366 12.282a1.25 1.25 0 00-1.16-.775h-2.352V9.663c0-.637-.203-1.244-.546-1.747.04-.064.085-.126.114-.198a1.252 1.252 0 00-.271-1.368L8.498.697a.663.663 0 00-.938 0L1.907 6.35a1.25 1.25 0 00-.271 1.368c.194.471.65.775 1.16.775h2.352v1.844c0 .643.214 1.252.563 1.758-.042.065-.102.114-.132.188a1.252 1.252 0 00.27 1.368l5.654 5.653a.663.663 0 00.938 0l5.653-5.653c.36-.36.467-.897.27-1.368h.002zM4.11 6.693l3.919-3.919 3.919 3.92H9.11v3.756a1.083 1.083 0 01-2.163 0V6.693H4.11zm7.863 10.533l-3.92-3.919h2.838V9.55a1.083 1.083 0 012.163 0v3.757h2.838l-3.92 3.92z"></path>`,"0 0 20 20","controversial",!0),{svg:v}=e.a(),I=e.m(v`<path d="M14.7 3.8c.83 0 1.5.67 1.5 1.5v9.4c0 .83-.67 1.5-1.5 1.5H5.3c-.83 0-1.5-.67-1.5-1.5V5.3c0-.83.67-1.5 1.5-1.5h9.4zm0-1.8H5.3C3.48 2 2 3.48 2 5.3v9.4C2 16.52 3.48 18 5.3 18h9.4c1.82 0 3.3-1.48 3.3-3.3V5.3C18 3.48 16.52 2 14.7 2zm-1.3 3.1c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm-6.82 0c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm6.82 6.82c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm-6.82 0c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zM10 8.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z"></path>`,"0 0 20 20","dice"),{svg:S}=e.a(),R=e.m(S`<path d="M17.536 2.465a5.006 5.006 0 00-7.072 0 4.98 4.98 0 00-1.458 3.503 1.934 1.934 0 00-.437-.023 1.903 1.903 0 00-1.388.759l-5.457 7.319c-.925 1.24-.806 2.87.288 3.965a3.015 3.015 0 002.14.908c.631 0 1.268-.205 1.826-.621l7.317-5.457a1.9 1.9 0 00.761-1.386 1.892 1.892 0 00-.022-.44 4.982 4.982 0 003.502-1.458 5.006 5.006 0 000-7.07zm-5.316 8.91l-7.318 5.457c-.633.474-1.249.25-1.617-.117-.366-.366-.589-.983-.117-1.616l5.457-7.32.15-.01L9.867 8.86l-2.162 2.162 1.273 1.272 2.162-2.162 1.091 1.09-.01.152zm4.043-3.112c-1.209 1.209-3.316 1.209-4.525 0a3.204 3.204 0 010-4.525 3.18 3.18 0 012.263-.938c.855 0 1.658.333 2.263.938a3.204 3.204 0 010 4.525z"></path>`,"0 0 20 20","author"),{svg:E}=e.a(),k=e.m(E`<path d="M10 19c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9zm0-16.2c-3.97 0-7.2 3.23-7.2 7.2s3.23 7.2 7.2 7.2 7.2-3.23 7.2-7.2-3.23-7.2-7.2-7.2z"></path><path d="M10 14.5c-2.48 0-4.5-2.02-4.5-4.5S7.52 5.5 10 5.5s4.5 2.02 4.5 4.5-2.02 4.5-4.5 4.5zm0-7.2c-1.49 0-2.7 1.21-2.7 2.7 0 1.49 1.21 2.7 2.7 2.7 1.49 0 2.7-1.21 2.7-2.7 0-1.49-1.21-2.7-2.7-2.7z"></path>`,"0 0 20 20","live"),b=(t,r)=>{switch(t){case e.gZ.Top:return r===e.gZ.Top?"Top (Default)":"Top";case e.gZ.New:return r===e.gZ.New?"New (Default)":"New";case e.gZ.Controversial:return r===e.gZ.Controversial?"Controversial (Default)":"Controversial";case e.gZ.Old:return r===e.gZ.Old?"Old (Default)":"Old";case e.gZ.Random:return r===e.gZ.Random?"Random (Default)":"Random";case e.gZ.Qa:return r===e.gZ.Qa?"Q&A (Default)":"Q&A";case e.gZ.Live:return r===e.gZ.Live?"Live (Default)":"Live";default:return "Best";}},f=t=>{switch(t){case e.gZ.Confidence:return c();case e.gZ.Top:return m();case e.gZ.New:return s.n();case e.gZ.Controversial:return T();case e.gZ.Old:return i.a();case e.gZ.Random:return I();case e.gZ.Qa:return R();case e.gZ.Live:return k();default:return c()}},D=[e.gZ.Blank,e.gZ.Random,e.gZ.Live],L=[e.gZ.Confidence,e.gZ.Top,e.gZ.New,e.gZ.Controversial,e.gZ.Old,e.gZ.Random,e.gZ.Qa,e.gZ.Live,e.gZ.Blank];let O=class extends p{constructor(){super(...arguments),this.currentSort=e.gZ.Confidence,this.suggestedSort=void 0,this.postId="",this.subredditId="",this.disableOptions=D.join(","),this.onSelectDropdownItem=(e,t)=>{t&&(this.currentSort=t,this.fireOffSortEvents(e,t))},this.setSuggestedSort=async t=>{const r=t?e.gZ.Blank:this.currentSort,{data:a}=await e.Y({operation:e.O.SetSuggestedSort,variables:{input:{sort:r,subredditId:this.subredditId,postId:`t3_${this.postId}`}}});if(a?.setSuggestedSort?.ok){if(this.suggestedSort=r,this.telemetrySource){const a=t?"clear_suggested_sort":"set_suggested_sort";e.i(this,e.b({source:this.telemetrySource,action:"click",noun:a},{action_info:{reason:r,page_type:e.au.PostDetail}}))}const a=t?"Suggested sort has been cleared":"Suggested sort has been set";this.dispatchFaceplateAlertEvent(e.a5.success,a)}else{const r=t?"There was an error clearing the suggested sort":"There was an error setting the suggested sort";this.dispatchFaceplateAlertEvent(e.a5.error,r)}},this.renderSuggestedSortOptions=()=>this.isCurrentSuggestedSort?e.o({appearance:"plain",attributes:{onclick:()=>this.setSuggestedSort(!0),className:"text-12 font-semi bold"},size:e.q.Small,children:"Clear default sort"}):t.x` <rpl-tooltip appearance="inverted" class="nd:hidden">${e.o({appearance:"plain",attributes:{onclick:()=>this.setSuggestedSort(),className:"text-12 font-semi bold"},size:e.q.Small,children:"Set as Default"})}<span slot="content">${"Set as the default sort for this post for all visitors"}</span></rpl-tooltip>`,this.renderDropdownItems=()=>t.x`${(({html:e,listItemRenderer:t,selectedSort:r,suggestedCommentSort:a,disableOptions:o,onclick:s})=>Object.values(L).map((i=>o.includes(i)?e``:e` <data value="${i}"> ${t({label:b(i,a),selected:i===r,leadingIcon:f(i),attributes:{role:"menuitem",onclick:e=>s&&s(e,i)}})} </data> `)))({html:t.x,listItemRenderer:o.l,selectedSort:this.currentSort,suggestedCommentSort:this.suggestedSort,disableOptions:this.disableOptions.split(","),onclick:(e,t)=>this.onSelectDropdownItem(e,t)})}`}get isCurrentSuggestedSort(){return!(!this.suggestedSort||this.suggestedSort===e.gZ.Blank)&&this.currentSort===this.suggestedSort}dispatchFaceplateAlertEvent(t,r){const a=e.c("faceplate-alert",{level:t,message:r});this.dispatchEvent(a)}render(){const r=b(this.currentSort,this.suggestedSort);return t.x`<div class="flex items-center justify-between"> ${this.renderDropdownMenu(r,r,this.renderDropdownItems())}${this.currentSort===e.gZ.Confidence||this.currentSort===e.gZ.Blank?"":this.renderSuggestedSortOptions()} </div>`}};return e._([e.n({type:String,attribute:"sort"})],O.prototype,"currentSort",void 0),e._([e.n({type:String,attribute:"suggested-sort"})],O.prototype,"suggestedSort",void 0),e._([e.n({type:String,attribute:"post-id"})],O.prototype,"postId",void 0),e._([e.n({type:String,attribute:"subreddit-id"})],O.prototype,"subredditId",void 0),e._([e.n({type:String,attribute:"disable-options"})],O.prototype,"disableOptions",void 0),O=e._([e.e("shreddit-sort-dropdown-with-suggested")],O),{get ShredditSortDropdown(){return u},get ShredditSortDropdownWithSuggested(){return O}}}));
SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("Cv4mWnWE30",["5r73EsgItq","Dw4vb8Yfbm"],(async(t,e)=>{const i={variantFlipOrder:{start:"sme",middle:"mse",end:"ems"},positionFlipOrder:{top:"tbrl",right:"rltb",bottom:"btrl",left:"lrbt"},position:"bottom",margin:8,padding:0},n=(t,e,n)=>{const{container:o,margin:s,padding:r,position:l,variantFlipOrder:a,positionFlipOrder:p}={container:document.documentElement.getBoundingClientRect(),...i,...n},{left:c,top:h}=e.style;e.style.left="0",e.style.top="0";const u=t.getBoundingClientRect(),d=e.getBoundingClientRect(),m={t:u.top-d.height-s,b:u.bottom+s,r:u.right+s,l:u.left-d.width-s},f={vs:u.left,vm:u.left+u.width/2+-d.width/2,ve:u.left+u.width-d.width,hs:u.top,hm:u.bottom-u.height/2-d.height/2,he:u.bottom-d.height},[g,E="middle"]=l.split("-"),_=p[g],b=a[E],{top:y,left:v,bottom:w,right:S}=o;for(const t of _){const i="t"===t||"b"===t,n=m[t],[o,s]=i?["top","left"]:["left","top"],[l,a]=i?[d.height,d.width]:[d.width,d.height],[p,c]=i?[w,S]:[S,w],[h,u]=i?[y,v]:[v,y];if(!(n<h||n+l+r>p))for(const l of b){const p=f[(i?"v":"h")+l];if(!(p<u||p+a+r>c))return e.style[s]=p-d[s]+"px",e.style[o]=n-d[o]+"px",t+l}}return e.style.left=c,e.style.top=h,null};function o(t,e=50,i={leading:!0,trailing:!0}){i={leading:!0,trailing:!0,...i};let n,o,s,r=null,l=0;const a=function(){l=i.leading?Date.now():0,r=null,s=t.apply(n,o),r||(n=o=null)};return function(...p){const c=Date.now();l||!1!==i.leading||(l=c);const h=e-(c-l);return n=this,o=p,h<=0||h>e?(r&&(clearTimeout(r),r=null),l=c,s=t.apply(n,p),r||(n=o=null)):r||!1===i.trailing||(r=setTimeout(a,h)),s}}const s=["button","link","menuitem","tab","checkbox","combobox","gridcell","application","treeitem"];class r{set popperTrigger(t){this._popperTrigger=t}get popperTrigger(){if(this._popperTrigger)return this._popperTrigger;let t=this.host.shadowRoot?.querySelector("slot[faceplate-popper-trigger]")?.assignedElements()?.[0]??null;let e=0;const i=t=>t instanceof HTMLButtonElement||t instanceof HTMLAnchorElement||s.includes(t?.getAttribute("role")??"");if(i(t))return t;for(;t&&e<5;){if(t=t?.assignedElements?t?.assignedElements()?.[0]??null:t?.children[0]??null,i(t))return t;e++}return null}get popperContent(){return this.host.shadowRoot?.querySelector("[faceplate-popper-content]")?.querySelector("slot")?.assignedElements()?.[0]??null}constructor(t,{containerElement:i=document.documentElement,scrollContainerElement:n=e.hb().scrollContainerElement(),allowCloseByEvent:s=!0,...r}){this.status="closed",this._containerSize=null,this.containerSizeChanged=t=>{if(!this._containerSize)return!0;const e=this._containerSize;return Object.keys(t).some((i=>e[i]!==t[i]))},this.updateAriaStates=async(t=!1)=>{const e="open"===this.currentState.state,i="tooltip"===this.host.shadowRoot?.querySelector("[faceplate-popper-content]")?.getAttribute("role"),n="dialog"===this.host.shadowRoot?.querySelector("[faceplate-popper-content]")?.getAttribute("role"),o=this.popperTrigger,s=this.popperContent,r=!this._options.manualTriggerFocus&&!t&&!n&&"function"==typeof o?.focus;i||(t&&(o?.setAttribute("aria-haspopup",n?"dialog":"true"),s?.setAttribute("hidden","")),e?(s?.removeAttribute("hidden"),this.currentState.animationFinished&&await this.currentState.animationFinished,s?.openMenu?.()):(s?.setAttribute("hidden",""),s?.closeMenu?.(),r&&o?.focus()),o?.setAttribute("aria-expanded",`${e}`))},this.referenceInViewport=o((()=>{const{reference:t=null,containerElement:e=document.documentElement}=this._options;if("open"!==this.status)return!1;if(!t)return!1;const i=t.getBoundingClientRect();return i.top>=0&&i.left>=0&&i.bottom<=(window.innerHeight||e.clientHeight)&&i.right<=(window.innerWidth||e.clientWidth)}),80),this.isOffscreenBottom=o((t=>{const e=t.popper?.getBoundingClientRect(),i=this._options.reference?.getBoundingClientRect();return!!e&&window.innerHeight-(i.bottom+e.height)<16}),80),this.getPosition=t=>{const e=t.position??"bottom";return"open"===this.status?e:this.popper&&this.isOffscreenBottom(t)&&e?.includes("bottom")?e.replace("bottom","top"):t.position},this.reposition=()=>{this.referenceInViewport()?this.updatePopper():this.close()},this.open=async()=>{if(this.popper){if("open"===this.status)return Promise.resolve(null)}else this.initialize();this.popperContent?.removeAttribute("hidden"),this.updateOptions({});const t=this.showElement(this._options.popper,!0);return this.setStatus("open",t),t?.finished??Promise.resolve(null)},this.close=async t=>{if(t&&!this._options.allowCloseByEvent)return Promise.resolve(null);if(t&&(t.preventDefault(),t.stopPropagation()),"open"!==this.status)return Promise.resolve(null);const e=this.hideElement(this._options.popper,!0);return this.setStatus("closed",e),e?.finished??Promise.resolve(null)},this.toggle=async t=>"open"!==this.status?this.open():this.close(t),this.updatePopper=t=>{if(!this.popper)return null;const e=this.actualPosition;let i=null;try{i=this.popper.update(t)}catch(t){return null}const n=a(i);return n!==e&&(this.setActualPosition(n),this.host.requestUpdate()),i},this.setStatus=(t,e)=>{this.status=t,this.statusAnimation=e,this.statusAnimation?.finished.then((()=>{this.updateAriaStates()}))},this.setActualPosition=t=>{this.actualPosition=t},this.handleContainerResize=o((()=>{if("open"!==this.status)return;const t=(this._options.containerElement??document.documentElement).getBoundingClientRect();this.containerSizeChanged(t)&&(this._containerSize=t,this.updatePopper({...this._options,container:t}))}),80),this.getKeyframes=(t,e="show",i)=>{try{return new KeyframeEffect(t,[{visibility:"hidden",opacity:"0"},{visibility:"visible",opacity:"1"}],{fill:"both",direction:"show"===e?"normal":"reverse",duration:i,easing:"ease-in-out"})}catch(i){return()=>{"show"===e?(t.style.visibility="visible",t.style.opacity="1"):(t.style.visibility="hidden",t.style.opacity="0")}}},(this.host=t).addController(this),this._options={...r,containerElement:i,scrollContainerElement:n,allowCloseByEvent:s},this.actualPosition=this._options.position||null}async hostConnected(){await this.host.updateComplete,this.updateAriaStates(!0)}initialize(){this._containerSize=(this._options.containerElement??document.documentElement).getBoundingClientRect(),this.popper=((t,e,i)=>{const o="object"!=typeof t||t instanceof HTMLElement?{reference:t,popper:e,...i}:t;return{update(t=o){const{reference:e,popper:i}=Object.assign(o,t);if(!i||!e)throw new Error("Popper- or reference-element missing.");return n(e,i,o)}}})({...this._options,container:this._containerSize}),this.resizeObserver=new ResizeObserver(this.handleContainerResize),this._options.containerElement&&this.resizeObserver.observe(this._options.containerElement);(this._options.scrollContainerElement??window).addEventListener("scroll",this.reposition),this.replaceElement(void 0,this._options.popper)}hostDisconnected(){this._options.containerElement&&this.resizeObserver?.unobserve(this._options.containerElement);(this._options.scrollContainerElement??window).removeEventListener("scroll",this.reposition)}getOptions(){return this._options}updateOptions({...t}){const e={...this._options,...t},i={...e};this.popper&&(this._containerSize=(e.containerElement??document.documentElement).getBoundingClientRect(),i.container=this._containerSize);const n=i.popperElementKey||"popperElement";!i.popper&&n in this.host&&(i.popper=this.host[n]);const o=i.referenceElementKey||"popperReferenceElement";!i.reference&&o in this.host&&(i.reference=this.host[o]),i.popper!==this._options.popper&&this.replaceElement(this._options.popper,i.popper),i.containerElement!==this._options.containerElement&&(this._options.containerElement&&(this.resizeObserver?.unobserve(this._options.containerElement),this._options.containerElement.removeEventListener("faceplate-close",this.close)),i.containerElement&&(this.resizeObserver?.observe(i.containerElement),i.containerElement.addEventListener("faceplate-close",this.close))),this._options=i,this.updatePopper({...this._options,position:this.getPosition(i)})}get currentState(){return{state:this.status,animationFinished:this.statusAnimation?.finished.then((()=>{}))??Promise.resolve()}}showElement(t,e=!0){if(t)return t.style.display="",this.updatePopper(),l(this.getKeyframes(t,"show",e?150:0))}hideElement(t,e="open"===this.status){if(!t)return;if("closed"===this.status)return void(t.style.display="none");const i=l(this.getKeyframes(t,"hide",e?150:0));return i?.finished.catch((()=>{})).then((()=>{"closed"===this.status&&(t.style.display="none"),i?.cancel()})),i}replaceElement(t,e){t&&(this.hideElement(t,!1),t.removeEventListener("faceplate-close",this.close)),e&&("open"===this.status?this.showElement(e,!1):this.hideElement(e,!1),e.addEventListener("faceplate-close",this.close))}}r.defaultPopperContentStyles=t.a`[faceplate-popper-content]{position:fixed;visibility:hidden;opacity:0}`;const l=t=>{if("function"==typeof t)return t();if(!t.target)return;t.target.getAnimations().forEach((t=>t.cancel()));const e=new Animation(t);return e.play(),e},a=t=>{if(!t)return null;const[e,i]=t,n=e?{t:"top",b:"bottom",l:"left",r:"right"}[e]:null,o=i?{s:"start",m:"middle",e:"end"}[i]:null;return n&&o?`${n}-${o}`:null},p="moderator";return{P:r,Q:"pageNumber",U:"user-flair-assign-modal",a:()=>e.b({source:p,action:"click",noun:"assign_flair_dialog"}),b:t=>e.b({source:p,action:"click",noun:"username_input"},{action_info:t}),c:()=>e.b({source:p,action:"click",noun:"assigned_flair_edit_save"}),d:()=>e.b({source:p,action:"click",noun:"assign_flair_confirm"}),e:()=>e.b({source:p,action:"click",noun:"remove_assigned_userflair_confirm"}),f:()=>e.b({source:p,action:"click",noun:"table_pagination"}),g:()=>e.b({source:p,action:"click",noun:"user_search"}),h:()=>e.b({source:p,action:"click",noun:"assigned_flair_edit_dialog"}),i:"user-flair__user-delete",j:"user-flair__user-edit",k:"user-flair__user-delete-modal",l:"pageSize",m:"before",n:"after",o:"query",r:()=>e.b({source:p,action:"click",noun:"remove_assigned_userflair_dialog"})}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("CwJMtJ-bLN",["Dw4vb8Yfbm"],(async a=>{const{svg:t}=a.a();return{n:a.m(t`<path d="M10 10.9H4.68V9.1H9.1V4.68h1.8V10c0 .5-.4.9-.9.9z"></path><path d="M13.3 16.39c-.99.51-2.11.81-3.3.81-3.97 0-7.2-3.23-7.2-7.2S6.03 2.8 10 2.8c3.22 0 5.96 2.13 6.87 5.06.05.02.11.03.16.05.33.14.63.33.88.58l1.07 1.07C18.75 4.8 14.82 1 10 1s-9 4.03-9 9a9 9 0 009 9c1.17 0 2.28-.23 3.3-.63v-1.98z"></path><path d="M19.64 12.76l-3-3a.915.915 0 00-1.27 0l-3 3a.9.9 0 000 1.27.9.9 0 001.27 0l1.46-1.46v6.03c0 .5.4.9.9.9s.9-.4.9-.9v-6.03l1.46 1.46c.18.18.41.26.64.26.23 0 .46-.09.64-.26a.9.9 0 000-1.27z"></path>`,"0 0 20 20","new",!0)}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("CxA9E_GW4X",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,t)=>{let s=class extends t.s{constructor(){super(),this.label="",this.loadingCounter=0,this._events=new e.E(this),this._events.define("faceplate-request",(()=>this.loadingCounter++)),this._events.define("faceplate-response",(()=>this.loadingCounter--))}get busy(){return this.loadingCounter>0}render(){return t.x`<div aria-labelledby="${this.label}" aria-busy="${this.busy}" role="feed"> <slot></slot> </div>`}};return e._([e.n()],s.prototype,"label",void 0),e._([e.h()],s.prototype,"loadingCounter",void 0),s=e._([e.e("reddit-feed")],s),{get R(){return s}}}));
SML.dm("Cy0QTNmAAP",[],(async()=>{var n;!function(n){n.Collapsed="0",n.Expanded="1"}(n||(n={}));const e={[n.Collapsed]:"flex-nav-collapsed",[n.Expanded]:"flex-nav-expanded"},t=Object.values(n);return{F:{LeftSidebarContainer:"left-sidebar-container",ContainerDiv:"flex-left-nav-container",ContentsDiv:"flex-left-nav-contents",ButtonsContainer:"flex-nav-buttons",ExpandButton:"flex-nav-expand-button",CollapseButton:"flex-nav-collapse-button",SubgridContainer:"subgrid-container"},a:"hui_flex_nav_expanded_state",get b(){return n},c:e,i:n=>!!n&&t.includes(n)}}));

SML.di("./DjACS3kR0A.js",import.meta.url,"DjACS3kR0A");SML.di("./ClaQym8zez.js",import.meta.url,"ClaQym8zez");SML.di("./Can0MElxF6.js",import.meta.url,"Can0MElxF6");SML.di("./DKYHmsTM9-.js",import.meta.url,"DKYHmsTM9-");SML.di("./B0yh4uRZhO.js",import.meta.url,"B0yh4uRZhO");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./CT64J_9lkK.js",import.meta.url,"CT64J_9lkK");SML.di("./RXNEUFNiHt.js",import.meta.url,"RXNEUFNiHt");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./BHQvZGlXFT.js",import.meta.url,"BHQvZGlXFT");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");SML.di("./7mROGt_umO.js",import.meta.url,"7mROGt_umO");SML.di("./DZO4dWmzHb.js",import.meta.url,"DZO4dWmzHb");SML.di("./DfOK659qrU.js",import.meta.url,"DfOK659qrU");SML.di("./DOqOHj9jA9.js",import.meta.url,"DOqOHj9jA9");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./BRjrtOukap.js",import.meta.url,"BRjrtOukap");SML.di("./CZ0Z5XJFvV.js",import.meta.url,"CZ0Z5XJFvV");
SML.dm("CyD3mXtKcU",["Dw4vb8Yfbm","DjACS3kR0A","ClaQym8zez","Can0MElxF6","DKYHmsTM9-","B0yh4uRZhO","CT64J_9lkK","RXNEUFNiHt","5r73EsgItq","Cv4mWnWE30","B-zFJtiar6","BHQvZGlXFT","tO6bKRQro7","Bu440t6XLo","BeFppRYbzE","7mROGt_umO","DZO4dWmzHb","DfOK659qrU","DOqOHj9jA9","jWC3N3n7Al","FQGvCwaizg","BRjrtOukap","CZ0Z5XJFvV"],(async E=>{E.g()&&(SML.di("./BWv2j8jrjX.js",import.meta.url,"BWv2j8jrjX").then((function(E){return E.f})),SML.di("./DOxctwiKdK.js",import.meta.url,"DOxctwiKdK"),SML.di("./CKlFqjmQl_.js",import.meta.url,"CKlFqjmQl_"),SML.di("./C99-X0hsbT.js",import.meta.url,"C99-X0hsbT"),SML.di("./Dqa8X_Unuu.js",import.meta.url,"Dqa8X_Unuu"))}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("CzmIuH4u_q",["Dw4vb8Yfbm"],(async a=>{const{svg:c}=a.a();return{a:a.m(c`<path d="M18.75 14.536l-2.414-3.581A6.947 6.947 0 0017 8c0-3.86-3.14-7-6.999-7-3.859 0-6.999 3.14-6.999 7 0 1.057.242 2.056.664 2.955l-2.414 3.581c-.289.428-.33.962-.109 1.429.22.467.658.776 1.173.826l1.575.151.758 1.494a1.435 1.435 0 001.297.795c.482 0 .926-.234 1.198-.639l2.437-3.612c.14.008.28.021.423.021.143 0 .282-.013.423-.021l2.437 3.612c.272.405.716.639 1.198.639.031 0 .062 0 .094-.003a1.435 1.435 0 001.203-.791l.758-1.495 1.576-.151c.514-.05.952-.358 1.172-.826a1.434 1.434 0 00-.109-1.429h-.006zM10 2.8A5.205 5.205 0 0115.2 8c0 2.867-2.333 5.2-5.2 5.2A5.205 5.205 0 014.801 8c0-2.867 2.332-5.2 5.2-5.2zM5.982 17.09l-.937-1.846-1.974-.189 1.66-2.462a7.02 7.02 0 002.936 1.999L5.982 17.09zm10.947-2.035l-1.974.189-.937 1.846-1.685-2.499a7.013 7.013 0 002.936-1.999l1.66 2.462v.001z"></path>`,"0 0 20 20","award")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./D-ibjVaztZ.js",import.meta.url,"D-ibjVaztZ");SML.di("./B7VtDPc4tA.js",import.meta.url,"B7VtDPc4tA");SML.di("./Dm3xIDznQh.js",import.meta.url,"Dm3xIDznQh");SML.di("./5KlNO8qI18.js",import.meta.url,"5KlNO8qI18");SML.di("./Hw1PFKH8z9.js",import.meta.url,"Hw1PFKH8z9");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./CG8L8PJoXS.js",import.meta.url,"CG8L8PJoXS");
SML.dm("CzwD205thW",["Dw4vb8Yfbm","5r73EsgItq","D_g7f2Ewyi","D-ibjVaztZ","B7VtDPc4tA","Dm3xIDznQh","5KlNO8qI18","Hw1PFKH8z9","CG8L8PJoXS","BYzqEZ3uv3"],(async(e,i,t,a,o,s,r,n,l)=>{const h="share-menu-template",p="share-menu-copy-link-option",u="share-menu-crosspost-option",c="share-menu-embed-option",d="share-dropdown-menu",k=({source:i,noun:t})=>e.b({source:i||"share",action:"click",noun:t}),m=({source:e}={})=>k({source:e,noun:"share_crosspost"}),S=({source:e}={})=>k({source:e,noun:"share_profile_crosspost"}),T=()=>e.b({source:"comment",action:"click",noun:"share_as_post"},{action_info:{reason:"share_sheet"}}),E=Symbol("mixins/with-share");const I=(e,i,t)=>{const a=["click","keydown"],o=e.querySelector(`.${i}`);for(const e of a)o?.addEventListener(e,t)};return {C:"comment-share-menu-template",E:c,S:h,W:function(b){if(e.di(b,E))return b;const N=b;class C extends N{constructor(){super(...arguments),this.permalink="",this.sourceId="",this.source=void 0,this.isCrosspostable=!1,this.isEmbeddable=!1,this.disabled=!1,this.isDesktopViewport=!1,this.hideButtonText=!1,this.hideButtonIcon=!1,this.shouldAllowPropagation=!1,this.shareMenuFeatureName=e.aK,this.shareMenuTemplateId=h,this.translationLanguage="",this.isShareMenuInitiated=!1,this.showPostAssignModal=t.s,this.isShareDropdownOpened=!1,this.activateShareMenuFeature=()=>{const i={};return this.isCrosspostable&&(i.isCrosspostable=!0,this.sourceId&&(i.postId=this.sourceId)),this.isEmbeddable&&(i.isEmbeddable=!0),e.r({name:this.shareMenuFeatureName,queryParams:i,renderMode:e.P.Contents})},this.isAllowedEvent=e=>!e||(e instanceof PointerEvent||e instanceof MouseEvent||["Enter"," "].includes(e.key)),this.handleMobileShareClick=async e=>{this.isAllowedEvent(e)&&(await this._copyLink())},this.handleDesktopShareClick=async e=>{if(!this.isAllowedEvent(e))return;if(this.isShareMenuInitiated)return;let i=!1;try{i=Boolean(await this.activateShareMenuFeature())}catch(i){return void this.handleCopyLinkClick(e)}const t=document.querySelector(`#${this.shareMenuTemplateId}`)?.content;if(!t)return void this.handleCopyLinkClick(e);const a=this.getShareDropdownMenus();a?.length&&(a.forEach((e=>{if(e.querySelector("faceplate-menu"))return;const a=t.cloneNode(!0);e.appendChild(a),I(e,p,this.handleCopyLinkClick),I(e,u,this.handleCrosspostClick),I(e,c,this.handleEmbedClick),I(e,"klp-copy-link",this.handleKlpCopyLinkClick),I(e,"share-menu-profile-crosspost-option",this.handleProfileCrosspostClick),i&&e.show?.()})),i&&this.handleShareDropdownOpen(),this.isShareMenuInitiated=!0)},this.handleShareDropdownOpen=()=>{this.isShareDropdownOpened||(this.isShareDropdownOpened=!0,e.i(this,(({source:i}={})=>e.b({source:i||"share",action:"view",noun:"custom_share_sheet"}))({source:this.source})))},this.handleShareDropdownClose=()=>{this.isShareDropdownOpened=!1,e.i(this,(({source:i}={})=>e.b({source:i||"share",action:"dismiss",noun:"custom_share_sheet"}))({source:this.source}))},this.getShareDropdownMenus=()=>{const e=this.shadowRoot?.querySelectorAll(`.${d}`);if(e?.length)return e;const i=this.querySelectorAll(`faceplate-dropdown-menu.${d}`);if(i?.length)return i;const t=this.querySelectorAll("slot");for(const e of t){const i=e.assignedElements?.();if(i?.length){const e=Array.from(i).find((e=>e.classList?.contains(d)||e.querySelector(`.${d}`)));if(e)return[e.classList?.contains(d)?e:e.querySelector(`.${d}`)]}}},this.closeShareMenu=()=>{this.getShareDropdownMenus()?.forEach((e=>e.close?.()))},this.handleCopyLinkClick=async i=>{this.shouldAllowPropagation||i?.stopPropagation(),this.isAllowedEvent(i)&&(e.i(this,(({source:e}={})=>k({source:e,noun:"copy_link"}))({source:this.source})),this.closeShareMenu(),await this._copyLink())},this.handleKlpCopyLinkClick=async e=>{this.isAllowedEvent(e)&&(this.closeShareMenu(),await this._copyLink())},this.handleKlpNotUsefulClick=e=>{this.isAllowedEvent(e)&&this._notUseful()},this.handleKlpUsefulClick=e=>{this.isAllowedEvent(e)&&this._useful()},this.handleCrosspostClick=i=>{const t=l.d(this.sourceId)?T:m;this._handlePostComposerClick(i,`${e.dp.CrosspostSourceId}=${this.sourceId}`,t)},this.handleProfileCrosspostClick=async i=>{(await this.showPostAssignModal(this.sourceId))||this._handlePostComposerClick(i,`${e.dp.CrosspostSourceId}=${this.sourceId}&${e.dp.CrosspostTarget}=profile`,S)},this.handleEmbedClick=i=>{i.stopPropagation(),this.isAllowedEvent(i)&&(e.i(this,(({source:e}={})=>k({source:e,noun:"embed"}))({source:this.source})),this.closeShareMenu(),window.open(`https://publish.reddit.com/embed?url=https://www.reddit.com${this.permalink}`,"RedditEmbed"))},this._handlePostComposerClick=(i,t,a)=>{i.stopPropagation(),this.isAllowedEvent(i)&&(e.i(this,a({source:this.source})),this.closeShareMenu(),window.open(`/submit?${t}`,"_blank"))},this._copyLink=async()=>{if(!this.permalink||!location.origin)return;const i={url:this._buildShareUrl(location.origin,this.permalink)};if(n.S.Clipboard===(await n.s(i,this.isDesktopViewport))){const i=e.c("faceplate-alert",{level:e.a5.success,message:"Link copied"});this.dispatchEvent(i)}},this._notUseful=()=>{const i=e.c("faceplate-alert",{level:e.a5.notice,message:"Thanks for letting us know"});this.dispatchEvent(i)},this._useful=()=>{const i=e.c("faceplate-alert",{level:e.a5.notice,message:"Thanks for letting us know"});this.dispatchEvent(i)},this._buildShareUrl=(e,i)=>{const t=i.includes("?"),a=i.includes("tl=");return e+i+this._getShareQueryParams({source:this.source,term:"1",permalinkHasQuery:t,permalinkHasTlQuery:a})},this._getShareQueryParams=({permalinkHasQuery:e=!1,permalinkHasTlQuery:i=!1,source:t="share",term:a})=>{const o=this._getShareUTMParams({source:t,term:a}),s=i?"":this._getShareTranslationLanguageQueryParams();return e?`&${o}${s}`:`?${o}${s}`},this._getShareTranslationLanguageQueryParams=()=>this.translationLanguage?`&share_tl=${this.translationLanguage}`:"",this._getShareUTMParams=({source:i="share",term:t})=>{const a=e.bc();return`utm_source=${i}&utm_medium=${a}&utm_name=${a}css&utm_term=${t}&utm_content=share_button`},this.renderShareDropdown=({handleShareClick:t,size:s=e.q.Small,appearance:n="plain",attributes:l={},shareButtonText:h})=>{const p=h||"Share",u="link"===n;return i.x` <faceplate-dropdown-menu class="${d} relative ${u?"inline":""}" position="bottom-start" .onopen="${this.isDesktopViewport?this.handleShareDropdownOpen:void 0}" .onclose="${this.isDesktopViewport?this.handleShareDropdownClose:void 0}"> ${u?a.a({attributes:{onclick:t,onkeydown:t,...l},children:this.hideButtonText?void 0:p,suppressVisitedStyle:!0}):o.c({size:s,appearance:n,attributes:{type:"button",onclick:t,onkeydown:t,...l},leadingIcon:this.hideButtonIcon?void 0:r.s({size:o.I[s],attributes:{className:"icon-share","aria-hidden":"true"}}),screenReaderContent:this.hideButtonText?p:void 0,children:this.hideButtonText?void 0:p})} </faceplate-dropdown-menu>`},this.renderOnlyShareButton=({handleShareClick:t,size:a=e.q.Small,appearance:r="plain",attributes:n={},showFullButtons:l=!1})=>{const h="Copy link",p="link"===r;return i.x` ${p?i.A:o.c({size:a,appearance:r,attributes:{type:"button",onclick:t,onkeydown:t,...n,className:`${n.className} relative`,"aria-label":h},children:i.x` <span class="justify-center ${l?"flex s:hidden":"flex"}">${s.l({size:i.I.Small})}</span> <span class="${l?"hidden s:flex":"hidden"}"> ${h} </span> `})}`},this.renderOnlyShareMenuItem=({handleShareClick:e,menuSize:i=t.L.Medium})=>{const a="Copy link";return t.l({leadingIcon:s.l(),label:a,size:i,onClick:e})}}}return C[E]=!0,e._([e.n({type:String})],C.prototype,"permalink",void 0),e._([e.n({type:String,attribute:"source-id"})],C.prototype,"sourceId",void 0),e._([e.n({type:String,attribute:"source"})],C.prototype,"source",void 0),e._([e.n({type:Boolean,attribute:"is-crosspostable"})],C.prototype,"isCrosspostable",void 0),e._([e.n({type:Boolean,attribute:"is-embeddable"})],C.prototype,"isEmbeddable",void 0),e._([e.n({type:Boolean})],C.prototype,"disabled",void 0),e._([e.n({type:Boolean,attribute:"is-desktop-viewport"})],C.prototype,"isDesktopViewport",void 0),e._([e.n({type:Boolean,attribute:"hide-button-text"})],C.prototype,"hideButtonText",void 0),e._([e.n({type:Boolean,attribute:"hide-button-icon"})],C.prototype,"hideButtonIcon",void 0),e._([e.n({type:Boolean,attribute:"should-allow-propagation"})],C.prototype,"shouldAllowPropagation",void 0),e._([e.n({type:String,attribute:"share-menu-feature-name"})],C.prototype,"shareMenuFeatureName",void 0),e._([e.n({type:String,attribute:"share-menu-template-id"})],C.prototype,"shareMenuTemplateId",void 0),e._([e.n({type:String,attribute:"translation-language"})],C.prototype,"translationLanguage",void 0),C},a:d,b:p,c:u};}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("D-ibjVaztZ",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,n)=>{var t,a;!function(e){e.Regular="regular",e.Semibold="semibold"}(t||(t={})),function(e){e.Small="sm",e.Medium="md",e.Large="lg"}(a||(a={})),a.Small,n.I.ExtraSmall,a.Medium,n.I.Small,a.Large,n.I.Medium;const r={sm:"text-caption-1",md:"text-body-2",lg:"text-body-1"},i={always:"underline",hover:"hover:underline",none:"no-underline hover:no-underline"},o={primary:"",secondary:"text-secondary-plain hover:text-secondary-plain-hover no-visited visited:text-secondary-plain","plain-weak":"text-secondary-plain-weak hover:text-secondary-plain-hover no-visited visited:text-secondary-plain-weak",media:"text-media-onbackground no-visited visited:text-media-onbackground",inverted:"text-inverted-secondary-plain hover:text-inverted-secondary-plain-hover no-visited visited:text-neutral-background-weak"};return{get A(){return a},a:({attributes:n,children:t,fontWeight:a="regular",size:d,suppressVisitedStyle:l=!1,underline:s="hover",visited:c,appearance:m="primary",trailingIcon:u})=>{const{html:p,createElement:v}=e.a(),g=p`${t}${u?p`<span class="ms-2xs align-middle">${u}</span>`:""}`,y=`${n?.className||""} a cursor-pointer\n  ${m?o[m]:""}\n  ${d?r[d]:""}\n  ${"semibold"===a?"font-semibold":""}\n  ${l?"no-visited":""}\n  ${s?i[s]:""}\n  ${c?"visited":""}`;return v("a",{...n,rpl:!0,className:y},g)},get b(){return t},t:({toggled:n,appearance:t="favorite",filledIcon:a,outlineIcon:r,...i})=>e.o({...i,appearance:"bordered"===t&&n?"secondaryToggled":`${t}${n?"Toggled":""}`,leadingIcon:n?a:r})}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./DQQjPN-OEj.js",import.meta.url,"DQQjPN-OEj");
SML.dm("D14t1nj-sI",["Dw4vb8Yfbm","DQQjPN-OEj"],(async(i,e)=>{class t{constructor(e){this.isActivatingExplainer=!1,this.handleExplainerClosed=({explainerId:i,dismissed:e})=>{this.resolver&&this.resolver.explainerId===i&&(this.resolver.resolve({dismissed:e}),this.resolver=void 0)},(this.host=e).addController(this),this.pubsub=new i.u(this.host)}hostConnected(){this.pubsub.subscribe(i.T.ExplainerClosed,this.handleExplainerClosed,!1)}getExplainerDialogByExplainerId(i){return document.querySelector(`[dialog-id=explainer-dialog][data-explainer-id="${i}"]`)}async showExplainer({explainerExperience:e,explainerId:a,explainerVariantId:r,correlationId:n}){if(this.isActivatingExplainer||t.activatedExplainers.has(a))return{dismissed:!1};try{this.isActivatingExplainer=!0,await i.r({name:i.aV,routeParams:{explainerId:a},queryParams:{...null!=e&&{explainerExperience:e},...null!=r&&{explainerVariantId:r},...null!=n&&{correlationId:n}},renderMode:i.P.Contents});if(!this.getExplainerDialogByExplainerId(a))throw new Error(`Explainer dialog for explainer ID \`${a}\` not found after activation`);t.activatedExplainers.add(a)}catch(i){window.Sentry?.captureError?.(i)}finally{this.isActivatingExplainer=!1}return t.activatedExplainers.has(a)?new Promise((i=>this.resolver={explainerId:a,resolve:i})):{dismissed:!1}}}t.activatedExplainers=new Set;return{A:class{constructor(e,a){this.isActivatingDialog=!1,this.handleAwardContent=({thingId:i,award:e})=>{i===this.getThingId()&&this.onAward?.(e)},(this.host=e).addController(this),this.pubsub=new i.u(this.host),this.explainerController=new t(this.host),this.getThingId=a.getThingId,this.getAwardsPromoConfig=a.getAwardsPromoConfig,this.onAward=a.onAward}hostConnected(){this.onAward&&this.pubsub.subscribe(i.T.AwardContent,this.handleAwardContent,!1)}async activateDialog(){if(!this.isActivatingDialog)try{this.isActivatingDialog=!0;const{experience:t,variantId:a,id:r,type:n}=this.getAwardsPromoConfig?.()??{},s=t&&a&&r&&n===i.aW.EducationalModule?await this.explainerController.showExplainer({explainerExperience:t,explainerVariantId:a,explainerId:r,correlationId:e.a.getCorrelationId()}):void 0;s?.dismissed||await i.r({name:i.aX,routeParams:{thingId:this.getThingId()},renderMode:i.P.Contents})}finally{this.isActivatingDialog=!1}}}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("D1DY-avSiT",["Dw4vb8Yfbm","5r73EsgItq","Bu440t6XLo","BeFppRYbzE","B-zFJtiar6"],(async(r,o,a,t)=>{class e extends a.T{constructor(){super(...arguments),this.variant="plain",this.placement=t.P.Bottom,this.disabled=!1,this.label="",this.distance=8,this.animationNames={show:"coachmark.show",hide:"coachmark.hide",denyClose:"coachmark.denyClose",overlayShow:"coachmark.overlay.show",overlayHide:"coachmark.overlay.hide"}}connectedCallback(){super.connectedCallback(),this.addEventListener("rpl-coachmark-card:close-button-clicked",this.hide)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("rpl-coachmark-card:close-button-clicked",this.hide)}render(){return o.x` <rpl-popper ?active="${this.open}" strategy="${this.hoist?"fixed":"absolute"}" .anchor="${this.anchor}" flip shift arrow safe-area distance="${this.distance}" skidding="${this.skidding}" placement="${r.ad(this.placement)}" exportparts="
          popup:popper--popup,
          arrow:popper--arrow
        " class="${r.Z({coachmark:!0,"coachmark--open":this.open})}" ${r.a4(this.popperRef)}> <slot slot="anchor" ${r.a4(this.defaultSlotRef)}></slot> <slot name="content" ${r.a4(this.bodyRef)} ${r.a4(this.contentSlotRef)}></slot> </rpl-popper> `}}r._([r.n({type:String,reflect:!0})],e.prototype,"variant",void 0),r._([r.n({type:String,reflect:!0})],e.prototype,"placement",void 0),r._([r.n({type:Boolean,reflect:!0})],e.prototype,"disabled",void 0),r._([r.n({type:String,reflect:!0})],e.prototype,"label",void 0),r._([r.n()],e.prototype,"anchor",void 0);var p=o.a`${r.a7}:host{--transition-duration:250ms;display:contents}:host,:host([appearance=neutral]){--rpl-coachmark-background-color:var(--color-neutral-background);--rpl-coachmark-color:var(--color-neutral-content-strong)}:host([appearance=inverted]){--rpl-coachmark-background-color:var(--color-inverted-neutral-background);--rpl-coachmark-color:var(--color-inverted-neutral-content-strong)}.coachmark{--arrow-size:var(--rpl-coachmark-arrow-size, 4px);--arrow-color:var(--rpl-coachmark-background-color)}rpl-popper{--arrow-size:8px}rpl-popper[placement^=top]::part(arrow){box-shadow:1px 1px 2px rgba(0,0,0,.05)}rpl-popper[placement^=bottom]::part(arrow){box-shadow:-1px -1px 2px rgba(0,0,0,.05)}rpl-popper[placement^=left]::part(arrow){box-shadow:0 -2px 2px rgba(0,0,0,.05)}rpl-popper[placement^=right]::part(arrow){box-shadow:-2px 0 2px rgba(0,0,0,.05)}rpl-popper::part(popup){z-index:var(--rpl-z-index-tooltip,var(--faceplate-tooltip-z-index,1))}rpl-popper[placement^=top]::part(popup){transform-origin:bottom}rpl-popper[placement^=bottom]::part(popup){transform-origin:top}rpl-popper[placement^=left]::part(popup){transform-origin:right}rpl-popper[placement^=right]::part(popup){transform-origin:left}`;let c=class extends e{};return c.styles=p,c=r._([r.e("rpl-coachmark")],c),{get RPLCoachmark(){return c}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("D1ScrvIqaY",["Dw4vb8Yfbm"],(async t=>{class e{constructor(t){this.shouldOverrideId=!1,this.activeIds={},this.update=t=>this.set(t),this.reset=()=>this.clear(),this.getKey=t}get(...t){const e=this.getKey(...t);return this.activeIds[e]?this.activeIds[e]:this.generate(e)}set(t,e){return e?(this.activeIds[t]=e,this.activeIds[t]):this.generate(t)}clear(t){t?delete this.activeIds[t]:this.activeIds={}}getUUID(){return this.shouldOverrideId?"id":t.ab()}generate(t){return this.activeIds[t]=this.getUUID(),this.activeIds[t]}}const s=t=>t,i=new e(((e,s)=>`${s}-${function(e){let s=`[q:${e.query}]`;return e.scope.type!==t.aa.GLOBAL&&(s=`${s}--[scope:${e.scope.type}-${e.scope.path}]`),e.sort&&(s=`${s}--[sort:${e.sort}]`),e.time&&(s=`${s}--[time:${e.time}]`),e.pane&&(s=`${s}--[pane:${e.pane}]`),s}(e)}`));return{S:new e(s),a:new e(s),b:i}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("D1at8fJtPv",["Dw4vb8Yfbm"],(async a=>{const{svg:c}=a.a();return{n:a.m(c`<path d="M2.919 3.21a.9.9 0 10-1.273 1.272l1.627 1.627A6.902 6.902 0 003 8v3.184c0 .38-.087.762-.251 1.105l-.927 1.932A1.103 1.103 0 002.82 15.8h3.26A4.007 4.007 0 0010 19a4 4 0 003.69-2.473l1.955 1.955a.897.897 0 001.274 0 .898.898 0 000-1.272l-14-14zm7.08 13.99c-.93 0-1.721-.583-2.042-1.4h4.087A2.197 2.197 0 0110 17.2zm8.114-1.914a1.098 1.098 0 01-.274.286L5.193 2.925A6.966 6.966 0 0110 1c3.859 0 7 3.14 7 7v3.184c0 .38.087.762.25 1.105l.926 1.929c.165.348.14.746-.063 1.068z"></path>`,"0 0 20 20","notifications-off-fill")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./CK4gRenw1f.js",import.meta.url,"CK4gRenw1f");SML.di("./CwJMtJ-bLN.js",import.meta.url,"CwJMtJ-bLN");SML.di("./C17omQ_RhR.js",import.meta.url,"C17omQ_RhR");SML.di("./Dh8G_lEIvS.js",import.meta.url,"Dh8G_lEIvS");
SML.dm("D1uy_H277V",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6","CK4gRenw1f","CwJMtJ-bLN","C17omQ_RhR","Dh8G_lEIvS"],(async(e,t,s,i)=>{let o=class extends t.s{constructor(){super(...arguments),this.isModNotesRailClientSourceLoaded=!1,this.isPDP=!1,this.isModRecruitingPage=!1,this.pubsub=new e.u(this),this.openModNoteRail=async e=>{const t=document.getElementById(i.d);try{const s=this.querySelector(`faceplate-partial[name="${i.e}"]`),o=this.querySelector(`shreddit-async-loader[name="${i.e}"]`);if(!s||!o)return;this.classList.remove("hidden"),s.classList.add("hidden"),t?.classList.remove("hidden");let l=i.f;for(const t in e){const s=e[t];l=l.replace(`/:${t}`,s?`/${s}`:"")}s.src=l;const d=document.querySelector(".right-sidebar");this.isModRecruitingPage&&d&&(d.classList.remove("hidden"),d.classList.add("s:block")),this.isModNotesRailClientSourceLoaded?await s.load():(await Promise.allSettled([o.load(),s.load()]),this.isModNotesRailClientSourceLoaded=!0),t?.classList.add("hidden"),s.classList.remove("hidden")}catch(e){}this.onScrollHandlerThrottled()},this.onScrollHandler=()=>{const e=this.getBoundingClientRect();this.style.height=`calc(100vh - ${e.top}px - ${this.isPDP?"16px":"0"}16px - 1px)`},this.onScrollHandlerThrottled=s.D(this.onScrollHandler,200,!0),this.handleCloseClick=()=>{this.classList.add("hidden"),e.p(e.T.ModNotesRailClose);const t=document.querySelector(".right-sidebar");this.isModRecruitingPage&&t&&(t.classList.add("hidden"),t.classList.remove("s:block"))},this.handleEscape=e=>{"Escape"===e.key&&this.handleCloseClick()}}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.ModNotesRailOpen,this.openModNoteRail,!1),this.pubsub.subscribe(e.T.ModNotesRailForceClose,this.handleCloseClick,!1),document.addEventListener("scroll",this.onScrollHandlerThrottled),document.addEventListener("keydown",this.handleEscape)}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("scroll",this.onScrollHandlerThrottled),document.removeEventListener("keydown",this.handleEscape)}handleCloseKeyboardEnter(e){"Enter"===e.key&&this.handleCloseClick()}render(){return t.x` <slot></slot> <div class="absolute top-md right-md z-10" @click="${this.handleCloseClick}" @keyup="${this.handleCloseKeyboardEnter}"> ${e.o({leadingIcon:e.al({size:t.I.Small}),size:e.q.Small,attributes:{className:"opacity-80 button-media"}})} </div> `}};o.styles=[e.t,t.a`:host{display:block}`],e._([e.h()],o.prototype,"isModNotesRailClientSourceLoaded",void 0),e._([e.n({type:Boolean,attribute:"is-pdp"})],o.prototype,"isPDP",void 0),e._([e.n({type:Boolean,attribute:"mod-recruiting-page"})],o.prototype,"isModRecruitingPage",void 0),o=e._([e.e("mod-notes-rail-closer")],o)}));
SML.di("./BD-GSnPdCo.js",import.meta.url,"BD-GSnPdCo");SML.di("./uwcDasYs3h.js",import.meta.url,"uwcDasYs3h");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./DMVINMWPkT.js",import.meta.url,"DMVINMWPkT");SML.di("./DZO4dWmzHb.js",import.meta.url,"DZO4dWmzHb");SML.di("./nn12FiJf-M.js",import.meta.url,"nn12FiJf-M");SML.di("./C_DxBjcqSi.js",import.meta.url,"C_DxBjcqSi");SML.di("./D80UqjFrqa.js",import.meta.url,"D80UqjFrqa");SML.di("./BHQvZGlXFT.js",import.meta.url,"BHQvZGlXFT");SML.di("./DfmRUMqhhU.js",import.meta.url,"DfmRUMqhhU");SML.di("./BgnwQeogVz.js",import.meta.url,"BgnwQeogVz");SML.di("./BLIiwX-G4B.js",import.meta.url,"BLIiwX-G4B");SML.di("./BPE-aUEF5w.js",import.meta.url,"BPE-aUEF5w");SML.di("./iewwAXEto0.js",import.meta.url,"iewwAXEto0");SML.di("./BM4eKBOTt3.js",import.meta.url,"BM4eKBOTt3");SML.di("./DI4O_MlG8-.js",import.meta.url,"DI4O_MlG8-");SML.di("./CNVxoLjPZD.js",import.meta.url,"CNVxoLjPZD");SML.di("./7c7cPPCf-9.js",import.meta.url,"7c7cPPCf-9");SML.di("./BAPJODHRV4.js",import.meta.url,"BAPJODHRV4");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./h4Pa0OJr_5.js",import.meta.url,"h4Pa0OJr_5");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./CfalWt2tl8.js",import.meta.url,"CfalWt2tl8");SML.di("./ygbiiDqLof.js",import.meta.url,"ygbiiDqLof");SML.di("./D1at8fJtPv.js",import.meta.url,"D1at8fJtPv");SML.di("./BLbwpJ0bjx.js",import.meta.url,"BLbwpJ0bjx");SML.di("./_Hk1tm1ODt.js",import.meta.url,"_Hk1tm1ODt");SML.di("./kS-PCwPq_X.js",import.meta.url,"kS-PCwPq_X");SML.di("./Chd9fEZKZ6.js",import.meta.url,"Chd9fEZKZ6");SML.di("./HzkRsiDxC9.js",import.meta.url,"HzkRsiDxC9");SML.di("./BDs3iC2vQ1.js",import.meta.url,"BDs3iC2vQ1");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");SML.di("./DKYHmsTM9-.js",import.meta.url,"DKYHmsTM9-");SML.di("./DgW4ULLwQ1.js",import.meta.url,"DgW4ULLwQ1");SML.di("./Bk8sRXhdir.js",import.meta.url,"Bk8sRXhdir");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");SML.di("./BWUv70NGv2.js",import.meta.url,"BWUv70NGv2");SML.di("./BaxkLfaoug.js",import.meta.url,"BaxkLfaoug");SML.di("./ClaQym8zez.js",import.meta.url,"ClaQym8zez");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("D80UqjFrqa",["Dw4vb8Yfbm"],(async e=>{var _,n,t;function E({subredditId:e,subredditName:_}){return{id:e,name:_}}function i({isEnabled:_}){return{page_type:e.H(),reason:_?"on":"off"}}!function(e){e.MODERATOR="moderator",e.COMMUNITY_GUIDE="community_guide"}(_||(_={})),function(e){e.VIEW="view",e.CLICK="click"}(n||(n={})),function(e){e.GUIDE_TOGGLE="community_guide_toggle",e.SHOW_ON_JOIN_TOGGLE="show_on_join_toggle",e.HEADER_LAYOUT_EDIT="header_layout_edit",e.HEADER_BANNER_EDIT="header_banner_edit",e.WELCOME_MESSAGE_EDIT="welcome_message_edit",e.USER_FLAIR_EDIT="user_flair_edit",e.COMMUNITY_RESOURCES_EDIT="community_resources_edit",e.COMMUNITY_RESOURCE_LINK="resource_link",e.GUIDE="guide",e.CLOSE="close",e.OPEN="open"}(t||(t={}));const r=(_,n,t)=>r=>e.b({source:_,action:n,noun:t},{action_info:i(r),subreddit:E(r)});const o=r(_.MODERATOR,n.CLICK,t.GUIDE_TOGGLE),u=r(_.MODERATOR,n.CLICK,t.SHOW_ON_JOIN_TOGGLE);return{get A(){return n},get N(){return t},get S(){return _},a:u,c:o,g:function(e,_){return JSON.stringify({subreddit:{id:e,name:_}})}}}));
SML.di("./Cquj4gqZDa.js",import.meta.url,"Cquj4gqZDa");SML.di("./czusePl2ag.js",import.meta.url,"czusePl2ag");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("DCbB57ubLb",[],(async()=>{var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e,...t){const n=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",e);for(const e of t)r.append("v",e);throw n.search=r.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function n(e,...t){const n=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",e);for(const e of t)r.append("v",e);n.search=r.toString(),console.warn(`Minified Lexical warning #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const r="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,o=r&&"documentMode"in document?document.documentMode:null,i=r&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),s=r&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),l=!(!r||!("InputEvent"in window)||o)&&"getTargetRanges"in new window.InputEvent("input"),a=r&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),c=r&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,u=r&&/Android/.test(navigator.userAgent),d=r&&/^(?=.*Chrome).*/i.test(navigator.userAgent),g=r&&u&&d,f=r&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&i&&!d;function h(...e){const t=[];for(const n of e)if(n&&"string"==typeof n)for(const[e]of n.matchAll(/\S+/g))t.push(e);return t}const p=0,m=1,_=2,y=1,b=2,S=3,C=4,x=5,v=6,w=a||c||f?"":"",k="\n\n",T=s?"":w,N={bold:1,capitalize:1024,code:16,highlight:128,italic:2,lowercase:256,strikethrough:4,subscript:32,superscript:64,underline:8,uppercase:512},E={directionless:1,unmergeable:2},A={center:2,end:6,justify:4,left:1,right:3,start:5},F={[b]:"center",[v]:"end",[C]:"justify",[y]:"left",[S]:"right",[x]:"start"},O={normal:0,segmented:2,token:1},P={[p]:"normal",[_]:"segmented",[m]:"token"},R="$config";function M(e,t,n,r,o,i){let s=e.getFirstChild();for(;null!==s;){const e=s.__key;s.__parent===t&&(Lr(s)&&M(s,e,n,r,o,i),n.has(e)||i.delete(e),o.push(e)),s=s.getNextSibling()}}let L=!1,D=0;function I(e){D=e.timeStamp}function K(e,t,n){const r="BR"===e.nodeName,o=t.__lexicalLineBreak;return o&&(e===o||r&&e.previousSibling===o)||r&&void 0!==Ao(e,n)}function z(e,t,n){const r=mi(ai(n));let o=null,i=null;null!==r&&r.anchorNode===e&&(o=r.anchorOffset,i=r.focusOffset);const s=e.nodeValue;null!==s&&Wo(t,s,o,i,!1)}function $(e,t,n){if(Dn(e)){const t=e.anchor.getNode();if(t.is(n)&&e.format!==t.getFormat())return!1}return yo(t)&&n.isAttached()}function B(e,t,n,r){for(let o=e;o&&!Fi(o);o=oi(o)){const e=Ao(o,t);if(void 0!==e){const t=No(e,n);if(t)return Kr(t)||!yi(o)?void 0:[o,t]}else if(o===r)return[r,Mo(n)]}}function W(e,t,n){L=!0;const r=performance.now()-D>100;try{Or(e,(()=>{const o=Qn()||function(e){return e.getEditorState().read((()=>{const e=Qn();return null!==e?e.clone():null}))}(e),i=new Map,l=e.getRootElement(),a=e._editorState,c=e._blockCursorElement;let u=!1,d="";for(let n=0;n<t.length;n++){const g=t[n],f=g.type,h=g.target,p=B(h,e,a,l);if(!p)continue;const[m,_]=p;if("characterData"===f)r&&Tn(_)&&yo(h)&&$(o,h,_)&&z(h,_,e);else if("childList"===f){u=!0;const t=g.addedNodes;for(let n=0;n<t.length;n++){const r=t[n],o=Eo(r),i=r.parentNode;if(null!=i&&r!==c&&null===o&&!K(r,i,e)){if(s){const e=(yi(r)?r.innerText:null)||r.nodeValue;e&&(d+=e)}i.removeChild(r)}}const n=g.removedNodes,r=n.length;if(r>0){let t=0;for(let o=0;o<r;o++){const r=n[o];(K(r,h,e)||c===r)&&(h.appendChild(r),t++)}r!==t&&i.set(m,_)}}}if(i.size>0)for(const[t,n]of i)n.reconcileObservedMutation(t,e);const g=n.takeRecords();if(g.length>0){for(let t=0;t<g.length;t++){const n=g[t],r=n.addedNodes,o=n.target;for(let t=0;t<r.length;t++){const n=r[t],i=n.parentNode;null==i||"BR"!==n.nodeName||K(n,o,e)||i.removeChild(n)}}n.takeRecords()}null!==o&&(u&&Lo(o),s&&ei(e)&&o.insertRawText(d))}))}finally{L=!1}}function U(e){const t=e._observer;null!==t&&W(e,t.takeRecords(),t)}function H(e){!function(e){0===D&&ai(e).addEventListener("textInput",I,!0)}(e),e._observer=new MutationObserver(((t,n)=>{W(e,t,n)}))}function J(e){const t=new Map,n=new Set;for(let r="function"==typeof e?e:e.replace;r.prototype&&void 0!==r.prototype.getType;r=Object.getPrototypeOf(r)){const{ownNodeConfig:e}=Pi(r);if(e&&e.stateConfigs)for(const r of e.stateConfigs){let e;"stateConfig"in r?(e=r.stateConfig,r.flat&&n.add(e.key)):e=r,t.set(e.key,e)}}return{flatKeys:n,sharedConfigMap:t}}let j=class e{node;knownState;unknownState;sharedNodeState;size;constructor(e,t,n=void 0,r=new Map,o=void 0){this.node=e,this.sharedNodeState=t,this.unknownState=n,this.knownState=r;const{sharedConfigMap:i}=this.sharedNodeState,s=void 0!==o?o:function(e,t,n){let r=n.size;if(t)for(const o in t){const t=e.get(o);t&&n.has(t)||r++}return r}(i,n,r);this.size=s}getValue(e){const t=this.knownState.get(e);if(void 0!==t)return t;this.sharedNodeState.sharedConfigMap.set(e.key,e);let n=e.defaultValue;if(this.unknownState&&e.key in this.unknownState){const t=this.unknownState[e.key];void 0!==t&&(n=e.parse(t)),this.updateFromKnown(e,n)}return n}getInternalState(){return[this.unknownState,this.knownState]}toJSON(){const e={...this.unknownState},t={};for(const[t,n]of this.knownState)t.isEqual(n,t.defaultValue)?delete e[t.key]:e[t.key]=t.unparse(n);for(const n of this.sharedNodeState.flatKeys)n in e&&(t[n]=e[n],delete e[n]);return V(e)&&(t.$=e),t}getWritable(t){if(this.node===t)return this;const{sharedNodeState:n,unknownState:r}=this,o=new Map(this.knownState);return new e(t,n,function(e,t,n){let r;if(n)for(const[o,i]of Object.entries(n)){const n=e.get(o);n?t.has(n)||t.set(n,n.parse(i)):(r=r||{},r[o]=i)}return r}(n.sharedConfigMap,o,r),o,this.size)}updateFromKnown(e,t){const n=e.key;this.sharedNodeState.sharedConfigMap.set(n,e);const{knownState:r,unknownState:o}=this;r.has(e)||o&&n in o||(o&&(delete o[n],this.unknownState=V(o)),this.size++),r.set(e,t)}updateFromUnknown(e,t){const n=this.sharedNodeState.sharedConfigMap.get(e);n?this.updateFromKnown(n,n.parse(t)):(this.unknownState=this.unknownState||{},e in this.unknownState||this.size++,this.unknownState[e]=t)}updateFromJSON(e){const{knownState:t}=this;for(const e of t.keys())t.set(e,e.defaultValue);if(this.size=t.size,this.unknownState=void 0,e)for(const[t,n]of Object.entries(e))this.updateFromUnknown(t,n)}};function Y(e){return e.__state?e.__state.sharedNodeState:so(wi(),e.getType()).sharedNodeState}function V(e){if(e)for(const t in e)return e}function G(e,t,n){for(const[r,o]of t.knownState){if(e.has(r.key))continue;e.add(r.key);const t=n?n.getValue(r):r.defaultValue;if(t!==o&&!r.isEqual(t,o))return!0}return!1}function q(e,t,n){const{unknownState:r}=t,o=n?n.unknownState:void 0;if(r)for(const[t,n]of Object.entries(r))if(!e.has(t)&&(e.add(t),n!==(o?o[t]:void 0)))return!0;return!1}function Z(e,t){const n=e.__state;return n&&n.node===e?n.getWritable(t):n}function X(e,t){const n=e.__mode,r=e.__format,o=e.__style,i=t.__mode,s=t.__format,l=t.__style,a=e.__state,c=t.__state;return(null===n||n===i)&&(null===r||r===s)&&(null===o||o===l)&&(null===e.__state||a===c||function(e,t){if(e===t)return!0;if(e&&t&&e.size!==t.size)return!1;const n=new Set;return!(e&&G(n,e,t)||t&&G(n,t,e)||e&&q(n,e,t)||t&&q(n,t,e))}(a,c))}function Q(e,t){const n=e.mergeWithSibling(t),r=br()._normalizedNodes;return r.add(e.__key),r.add(t.__key),n}function ee(e){let t,n,r=e;if(""!==r.__text||!r.isSimpleText()||r.isUnmergeable()){for(;null!==(t=r.getPreviousSibling())&&Tn(t)&&t.isSimpleText()&&!t.isUnmergeable();){if(""!==t.__text){if(X(t,r)){r=Q(t,r);break}break}t.remove()}for(;null!==(n=r.getNextSibling())&&Tn(n)&&n.isSimpleText()&&!n.isUnmergeable();){if(""!==n.__text){if(X(r,n)){r=Q(r,n);break}break}n.remove()}}else r.remove()}function te(e){return ne(e.anchor),ne(e.focus),e}function ne(e){for(;"element"===e.type;){const t=e.getNode(),n=e.offset;let r,o;if(n===t.getChildrenSize()?(r=t.getChildAtIndex(n-1),o=!0):(r=t.getChildAtIndex(n),o=!1),Tn(r)){e.set(r.__key,o?r.getTextContentSize():0,"text",!0);break}if(!Lr(r))break;e.set(r.__key,o?r.getChildrenSize():0,"element",!0)}}let re,oe,ie,se,le,ae,ce,ue,de,ge,fe="",he=null,pe="",me="",_e=!1,ye=!1;function be(e,t){const n=ce.get(e);if(null!==t){const n=Le(e);n.parentNode===t&&t.removeChild(n)}if(ue.has(e)||oe._keyToDOMMap.delete(e),Lr(n)){const e=Oe(n,ce);Se(e,0,e.length-1,null)}void 0!==n&&Zo(ge,ie,se,n,"destroyed")}function Se(e,t,n,r){let o=t;for(;o<=n;++o){const t=e[o];void 0!==t&&be(t,r)}}function Ce(e,t){e.setProperty("text-align",t)}const xe="40px";function ve(e,t){const n=re.theme.indent;if("string"==typeof n){const r=e.classList.contains(n);t>0&&!r?e.classList.add(n):t<1&&r&&e.classList.remove(n)}const r=getComputedStyle(e).getPropertyValue("--lexical-indent-base-value")||xe;e.style.setProperty("padding-inline-start",0===t?"":`calc(${t} * ${r})`)}function we(e,t){const n=e.style;0===t?Ce(n,""):1===t?Ce(n,"left"):2===t?Ce(n,"center"):3===t?Ce(n,"right"):4===t?Ce(n,"justify"):5===t?Ce(n,"start"):6===t&&Ce(n,"end")}function ke(e,t){const n=function(e){const t=e.__dir;if(null!==t)return t;if($r(e))return null;const n=e.getParentOrThrow();return $r(n)&&null===n.__dir?"auto":null}(t);null!==n?e.dir=n:e.removeAttribute("dir")}function Te(e,n){const r=ue.get(e);void 0===r&&t(60);const o=r.createDOM(re,oe);if(function(e,t,n){const r=n._keyToDOMMap;(function(e,t,n){e[`__lexicalKey_${t._key}`]=n})(t,n,e),r.set(e,t)}(e,o,oe),Tn(r)?o.setAttribute("data-lexical-text","true"):Kr(r)&&o.setAttribute("data-lexical-decorator","true"),Lr(r)){const e=r.__indent,t=r.__size;if(ke(o,r),0!==e&&ve(o,e),0!==t){const e=t-1;Ne(Oe(r,ue),r,0,e,r.getDOMSlot(o))}const n=r.__format;0!==n&&we(o,n),r.isInline()||Ae(null,r,o),ni(r)&&(fe+=k,me+=k)}else{const t=r.getTextContent();if(Kr(r)){const t=r.decorate(oe,re);null!==t&&Re(e,t),o.contentEditable="false"}fe+=t,me+=t}return null!==n&&n.insertChild(o),Zo(ge,ie,se,r,"created"),o}function Ne(e,t,n,r,o){const i=fe;fe="";let s=n;for(;s<=r;++s){Te(e[s],o);const t=ue.get(e[s]);null!==t&&Tn(t)&&(null===he&&(he=t.getFormat()),""===pe&&(pe=t.getStyle()))}ni(t)&&(fe+=k),o.element.__lexicalTextContent=fe,fe=i+fe}function Ee(e,t){if(e){const n=e.__last;if(n){const e=t.get(n);if(e)return an(e)?"line-break":Kr(e)&&e.isInline()?"decorator":null}return"empty"}return null}function Ae(e,t,n){const r=Ee(e,ce),o=Ee(t,ue);r!==o&&t.getDOMSlot(n).setManagedLineBreak(o)}function Fe(e,n,r){var o;he=null,pe="",function(e,n,r){const o=fe,i=e.__size,s=n.__size;fe="";const l=r.element;if(1===i&&1===s){const t=e.__first,r=n.__first;if(t===r)Pe(t,l);else{const e=Le(t),n=Te(r,null);try{l.replaceChild(n,e)}catch(o){if("object"==typeof o&&null!=o){const i=`${o.toString()} Parent: ${l.tagName}, new child: {tag: ${n.tagName} key: ${r}}, old child: {tag: ${e.tagName}, key: ${t}}.`;throw new Error(i)}throw o}be(t,null)}const i=ue.get(r);Tn(i)&&(null===he&&(he=i.getFormat()),""===pe&&(pe=i.getStyle()))}else{const o=Oe(e,ce),a=Oe(n,ue);if(o.length!==i&&t(227),a.length!==s&&t(228),0===i)0!==s&&Ne(a,n,0,s-1,r);else if(0===s){if(0!==i){const e=null==r.after&&null==r.before&&null==r.element.__lexicalLineBreak;Se(o,0,i-1,e?null:l),e&&(l.textContent="")}}else!function(e,t,n,r,o,i){const s=r-1,l=o-1;let a,c,u=i.getFirstChild(),d=0,g=0;for(;d<=s&&g<=l;){const e=t[d],r=n[g];if(e===r)u=Me(Pe(r,i.element)),d++,g++;else{void 0===a&&(a=new Set(t)),void 0===c&&(c=new Set(n));const o=c.has(e),s=a.has(r);if(o)if(s){const e=ri(oe,r);e===u?u=Me(Pe(r,i.element)):(i.withBefore(u).insertChild(e),Pe(r,i.element)),d++,g++}else Te(r,i.withBefore(u)),g++;else u=Me(Le(e)),be(e,i.element),d++}const o=ue.get(r);null!==o&&Tn(o)&&(null===he&&(he=o.getFormat()),""===pe&&(pe=o.getStyle()))}const f=d>s,h=g>l;if(f&&!h){const t=n[l+1],r=void 0===t?null:oe.getElementByKey(t);Ne(n,e,g,l,i.withBefore(r))}else h&&!f&&Se(t,d,s,i.element)}(n,o,a,i,s,r)}ni(n)&&(fe+=k),l.__lexicalTextContent=fe,fe=o+fe}(e,n,n.getDOMSlot(r)),o=n,null==he||he===o.__textFormat||ye||o.setTextFormat(he),function(e){""===pe||pe===e.__textStyle||ye||e.setTextStyle(pe)}(n)}function Oe(e,n){const r=[];let o=e.__first;for(;null!==o;){const e=n.get(o);void 0===e&&t(101),r.push(o),o=e.__next}return r}function Pe(e,n){const r=ce.get(e);let o=ue.get(e);void 0!==r&&void 0!==o||t(61);const i=_e||ae.has(e)||le.has(e),s=ri(oe,e);if(r===o&&!i){if(Lr(r)){const e=s.__lexicalTextContent;void 0!==e&&(fe+=e,me+=e)}else{const e=r.getTextContent();me+=e,fe+=e}return s}if(r!==o&&i&&Zo(ge,ie,se,o,"updated"),o.updateDOM(r,s,re)){const r=Te(e,null);return null===n&&t(62),n.replaceChild(r,s),be(e,null),r}if(Lr(r)&&Lr(o)){const e=o.__indent;(_e||e!==r.__indent)&&ve(s,e);const t=o.__format;if((_e||t!==r.__format)&&we(s,t),i&&(Fe(r,o,s),$r(o)||o.isInline()||Ae(r,o,s)),ni(o)&&(fe+=k,me+=k),(_e||o.__dir!==r.__dir)&&(ke(s,o),$r(o)&&!_e))for(const e of o.getChildren())Lr(e)&&ke(ri(oe,e.getKey()),e)}else{const t=o.getTextContent();if(Kr(o)){const t=o.decorate(oe,re);null!==t&&Re(e,t)}fe+=t,me+=t}if(!ye&&$r(o)&&o.__cachedText!==me){const e=o.getWritable();e.__cachedText=me,o=e}return s}function Re(e,t){let n=oe._pendingDecorators;const r=oe._decorators;if(null===n){if(r[e]===t)return;n=Oo(oe)}n[e]=t}function Me(e){let t=e.nextSibling;return null!==t&&t===oe._blockCursorElement&&(t=t.nextSibling),t}function Le(e){const n=de.get(e);return void 0===n&&t(75,e),n}function De(e){return{type:e}}const Ie=De("SELECTION_CHANGE_COMMAND"),Ke=De("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND"),ze=De("CLICK_COMMAND"),$e=De("DELETE_CHARACTER_COMMAND"),Be=De("INSERT_LINE_BREAK_COMMAND"),We=De("INSERT_PARAGRAPH_COMMAND"),Ue=De("CONTROLLED_TEXT_INSERTION_COMMAND"),He=De("PASTE_COMMAND"),Je=De("REMOVE_TEXT_COMMAND"),je=De("DELETE_WORD_COMMAND"),Ye=De("DELETE_LINE_COMMAND"),Ve=De("FORMAT_TEXT_COMMAND"),Ge=De("UNDO_COMMAND"),qe=De("REDO_COMMAND"),Ze=De("KEYDOWN_COMMAND"),Xe=De("KEY_ARROW_RIGHT_COMMAND"),Qe=De("MOVE_TO_END"),et=De("KEY_ARROW_LEFT_COMMAND"),tt=De("MOVE_TO_START"),nt=De("KEY_ARROW_UP_COMMAND"),rt=De("KEY_ARROW_DOWN_COMMAND"),ot=De("KEY_ENTER_COMMAND"),it=De("KEY_SPACE_COMMAND"),st=De("KEY_BACKSPACE_COMMAND"),lt=De("KEY_ESCAPE_COMMAND"),at=De("KEY_DELETE_COMMAND"),ct=De("KEY_TAB_COMMAND"),ut=De("INSERT_TAB_COMMAND"),dt=De("INDENT_CONTENT_COMMAND"),gt=De("OUTDENT_CONTENT_COMMAND"),ft=De("DROP_COMMAND"),ht=De("FORMAT_ELEMENT_COMMAND"),pt=De("DRAGSTART_COMMAND"),mt=De("DRAGOVER_COMMAND"),_t=De("DRAGEND_COMMAND"),yt=De("COPY_COMMAND"),bt=De("CUT_COMMAND"),St=De("SELECT_ALL_COMMAND"),Ct=De("CLEAR_EDITOR_COMMAND"),xt=De("CLEAR_HISTORY_COMMAND"),vt=De("CAN_REDO_COMMAND"),wt=De("CAN_UNDO_COMMAND"),kt=De("FOCUS_COMMAND"),Tt=De("BLUR_COMMAND"),Nt=De("KEY_MODIFIER_COMMAND"),Et=Object.freeze({}),At=[["keydown",function(e,t){if(!(Ft=e.timeStamp,Ot=e.key,t.isComposing()||ti(t,Ze,e)||null==e.key)){if(zt&&Vo(e))return Or(t,(()=>{Gt(t,$t)})),zt=!1,void($t="");if(function(e){return Jo(e,"ArrowRight",{shiftKey:"any"})}(e))ti(t,Xe,e);else if(function(e){return Jo(e,"ArrowRight",jo)}(e))ti(t,Qe,e);else if(function(e){return Jo(e,"ArrowLeft",{shiftKey:"any"})}(e))ti(t,et,e);else if(function(e){return Jo(e,"ArrowLeft",jo)}(e))ti(t,tt,e);else if(function(e){return Jo(e,"ArrowUp",{altKey:"any",shiftKey:"any"})}(e))ti(t,nt,e);else if(function(e){return Jo(e,"ArrowDown",{altKey:"any",shiftKey:"any"})}(e))ti(t,rt,e);else if(function(e){return Jo(e,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any",shiftKey:!0})}(e))It=!0,ti(t,ot,e);else if(function(e){return" "===e.key}(e))ti(t,it,e);else if(function(e){return i&&Jo(e,"o",{ctrlKey:!0})}(e))e.preventDefault(),It=!0,ti(t,Be,!0);else if(function(e){return Jo(e,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any"})}(e))It=!1,ti(t,ot,e);else if(function(e){return Jo(e,"Backspace",{shiftKey:"any"})||i&&Jo(e,"h",{ctrlKey:!0})}(e))Vo(e)?ti(t,st,e):(e.preventDefault(),ti(t,$e,!0));else if(function(e){return"Escape"===e.key}(e))ti(t,lt,e);else if(function(e){return Jo(e,"Delete",{})||i&&Jo(e,"d",{ctrlKey:!0})}(e))!function(e){return"Delete"===e.key}(e)?(e.preventDefault(),ti(t,$e,!1)):ti(t,at,e);else if(function(e){return Jo(e,"Backspace",Yo)}(e))e.preventDefault(),ti(t,je,!0);else if(function(e){return Jo(e,"Delete",Yo)}(e))e.preventDefault(),ti(t,je,!1);else if(function(e){return i&&Jo(e,"Backspace",{metaKey:!0})}(e))e.preventDefault(),ti(t,Ye,!0);else if(function(e){return i&&(Jo(e,"Delete",{metaKey:!0})||Jo(e,"k",{ctrlKey:!0}))}(e))e.preventDefault(),ti(t,Ye,!1);else if(function(e){return Jo(e,"b",jo)}(e))e.preventDefault(),ti(t,Ve,"bold");else if(function(e){return Jo(e,"u",jo)}(e))e.preventDefault(),ti(t,Ve,"underline");else if(function(e){return Jo(e,"i",jo)}(e))e.preventDefault(),ti(t,Ve,"italic");else if(function(e){return Jo(e,"Tab",{shiftKey:"any"})}(e))ti(t,ct,e);else if(function(e){return Jo(e,"z",jo)}(e))e.preventDefault(),ti(t,Ge,void 0);else if(function(e){return i?Jo(e,"z",{metaKey:!0,shiftKey:!0}):Jo(e,"y",{ctrlKey:!0})||Jo(e,"z",{ctrlKey:!0,shiftKey:!0})}(e))e.preventDefault(),ti(t,qe,void 0);else{const n=t._editorState._selection;null===n||Dn(n)?Go(e)&&(e.preventDefault(),ti(t,St,e)):function(e){return Jo(e,"c",jo)}(e)?(e.preventDefault(),ti(t,yt,e)):function(e){return Jo(e,"x",jo)}(e)?(e.preventDefault(),ti(t,bt,e)):Go(e)&&(e.preventDefault(),ti(t,St,e))}(function(e){return e.ctrlKey||e.shiftKey||e.altKey||e.metaKey})(e)&&ti(t,Nt,e)}}],["pointerdown",function(e,t){const n=e.target,r=e.pointerType;bi(n)&&"touch"!==r&&"pen"!==r&&0===e.button&&Or(t,(()=>{co(n)||(Dt=!0)}))}],["compositionstart",function(e,t){Or(t,(()=>{const n=Qn();if(Dn(n)&&!t.isComposing()){const r=n.anchor,o=n.anchor.getNode();ko(r.key),(e.timeStamp<Ft+30||"element"===r.type||!n.isCollapsed()||o.getFormat()!==n.format||Tn(o)&&o.getStyle()!==n.style)&&ti(t,Ue,T)}}))}],["compositionend",function(e,t){s?Kt=!0:c||!a&&!f?Or(t,(()=>{Gt(t,e.data)})):(zt=!0,$t=e.data)}],["input",function(e,t){e.stopPropagation(),Or(t,(()=>{if(yi(e.target)&&co(e.target))return;const n=Qn(),r=e.data,o=Vt(e);if(null!=r&&Dn(n)&&Ut(n,o,r,e.timeStamp,!1)){Kt&&(Gt(t,r),Kt=!1);const o=n.anchor.getNode(),i=mi(ai(t));if(null===i)return;const u=n.isBackward(),d=u?n.anchor.offset:n.focus.offset,g=u?n.focus.offset:n.anchor.offset;l&&!n.isCollapsed()&&Tn(o)&&null!==i.anchorNode&&o.getTextContent().slice(0,d)+r+o.getTextContent().slice(d+g)===$o(i.anchorNode)||ti(t,Ue,r);const h=r.length;s&&h>1&&"insertCompositionText"===e.inputType&&!t.isComposing()&&(n.anchor.offset-=h),a||c||f||!t.isComposing()||(Ft=0,ko(null))}else Bo(!1,t,null!==r?r:void 0),Kt&&(Gt(t,r||void 0),Kt=!1);!function(){mr();U(br())}()}),{event:e}),Rt=null}],["click",function(e,t){Or(t,(()=>{const n=Qn(),r=mi(ai(t)),o=er();if(r)if(Dn(n)){const t=n.anchor,i=t.getNode();if("element"===t.type&&0===t.offset&&n.isCollapsed()&&!$r(i)&&1===Ro().getChildrenSize()&&i.getTopLevelElementOrThrow().isEmpty()&&null!==o&&n.is(o))r.removeAllRanges(),n.dirty=!0;else if(3===e.detail&&!n.isCollapsed()&&i!==n.focus.getNode()){const e=Ri(i,(e=>Lr(e)&&!e.isInline()));Lr(e)&&e.select(0)}}else if("touch"===e.pointerType||"pen"===e.pointerType){const n=r.anchorNode;(yi(n)||yo(n))&&Lo(Xn(o,r,t,e))}ti(t,ze,e)}))}],["cut",Et],["copy",Et],["dragstart",Et],["dragover",Et],["dragend",Et],["paste",Et],["focus",Et],["blur",Et],["drop",Et]];l&&At.push(["beforeinput",(e,n)=>function(e,n){const r=e.inputType,o=Vt(e);"deleteCompositionText"===r||s&&ei(n)||"insertCompositionText"!==r&&Or(n,(()=>{const i=Qn();if("deleteContentBackward"===r){if(null===i){const e=er();if(!Dn(e))return;Lo(e.clone())}if(Dn(i)){const r=i.anchor.key===i.focus.key;if(s=e.timeStamp,"MediaLast"===Ot&&s<Ft+30&&n.isComposing()&&r){if(ko(null),Ft=0,setTimeout((()=>{Or(n,(()=>{ko(null)}))}),30),Dn(i)){const e=i.anchor.getNode();e.markDirty(),Tn(e)||t(142),Yt(i,e)}}else{ko(null),e.preventDefault();const t=i.anchor.getNode(),o=t.getTextContent(),s=t.canInsertTextAfter(),l=0===i.anchor.offset&&i.focus.offset===o.length;let a=g&&r&&!l&&s;if(a&&i.isCollapsed()&&(a=!Kr(Qo(i.anchor,!0))),!a){ti(n,$e,!0);const e=Qn();g&&Dn(e)&&e.isCollapsed()&&(Bt=e,setTimeout((()=>Bt=null)))}}return}}var s;if(!Dn(i))return;const l=e.data;null!==Rt&&Bo(!1,n,Rt),i.dirty&&null===Rt||!i.isCollapsed()||$r(i.anchor.getNode())||null===o||i.applyDOMRange(o),Rt=null;const a=i.anchor,u=i.focus,d=a.getNode(),f=u.getNode();if("insertText"!==r&&"insertTranspose"!==r)switch(e.preventDefault(),r){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":ti(n,Ue,e);break;case"insertFromComposition":ko(null),ti(n,Ue,e);break;case"insertLineBreak":ko(null),ti(n,Be,!1);break;case"insertParagraph":ko(null),It&&!c?(It=!1,ti(n,Be,!1)):ti(n,We,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":ti(n,He,e);break;case"deleteByComposition":(function(e,t){return e!==t||Lr(e)||Lr(t)||!mo(e)||!mo(t)})(d,f)&&ti(n,Je,e);break;case"deleteByDrag":case"deleteByCut":ti(n,Je,e);break;case"deleteContent":ti(n,$e,!1);break;case"deleteWordBackward":ti(n,je,!0);break;case"deleteWordForward":ti(n,je,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":ti(n,Ye,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":ti(n,Ye,!1);break;case"formatStrikeThrough":ti(n,Ve,"strikethrough");break;case"formatBold":ti(n,Ve,"bold");break;case"formatItalic":ti(n,Ve,"italic");break;case"formatUnderline":ti(n,Ve,"underline");break;case"historyUndo":ti(n,Ge,void 0);break;case"historyRedo":ti(n,qe,void 0)}else{if("\n"===l)e.preventDefault(),ti(n,Be,!1);else if(l===k)e.preventDefault(),ti(n,We,void 0);else if(null==l&&e.dataTransfer){const t=e.dataTransfer.getData("text/plain");e.preventDefault(),i.insertRawText(t)}else null!=l&&Ut(i,o,l,e.timeStamp,!0)?(e.preventDefault(),ti(n,Ue,l)):Rt=l;Pt=e.timeStamp}}))}(e,n)]);let Ft=0,Ot=null,Pt=0,Rt=null;const Mt=new WeakMap;let Lt=!1,Dt=!1,It=!1,Kt=!1,zt=!1,$t="",Bt=null,Wt=[0,"",0,"root",0];function Ut(e,t,n,r,o){const i=e.anchor,s=e.focus,a=i.getNode(),c=br(),u=mi(ai(c)),d=null!==u?u.anchorNode:null,g=i.key,f=c.getElementByKey(g),h=n.length;return g!==s.key||!Tn(a)||(!o&&(!l||Pt<r+50)||a.isDirty()&&h<2||Io(n))&&i.offset!==s.offset&&!a.isComposing()||_o(a)||a.isDirty()&&h>1||(o||!l)&&null!==f&&!a.isComposing()&&d!==bo(f)||null!==u&&null!==t&&(!t.collapsed||t.startContainer!==u.anchorNode||t.startOffset!==u.anchorOffset)||a.getFormat()!==e.format||a.getStyle()!==e.style||function(e,t){if(t.isSegmented())return!0;if(!e.isCollapsed())return!1;const n=e.anchor.offset,r=t.getParentOrThrow(),o=mo(t);return 0===n?!t.canInsertTextBefore()||!r.canInsertTextBefore()&&!t.isComposing()||o||function(e){const t=e.getPreviousSibling();return(Tn(t)||Lr(t)&&t.isInline())&&!t.canInsertTextAfter()}(t):n===t.getTextContentSize()&&(!t.canInsertTextAfter()||!r.canInsertTextAfter()&&!t.isComposing()||o)}(e,a)}function Ht(e,t){return yo(e)&&null!==e.nodeValue&&0!==t&&t!==e.nodeValue.length}function Jt(e,n,r){const{anchorNode:o,anchorOffset:i,focusNode:s,focusOffset:l}=e;Lt&&(Lt=!1,Ht(o,i)&&Ht(s,l)&&!Bt)||Or(n,(()=>{if(!r)return void Lo(null);if(!go(n,o,s))return;let a=Qn();if(Bt&&Dn(a)&&a.isCollapsed()){const e=a.anchor,t=Bt.anchor;(e.key===t.key&&e.offset===t.offset+1||1===e.offset&&t.getNode().is(e.getNode().getPreviousSibling()))&&(a=Bt.clone(),Lo(a))}if(Bt=null,Dn(a)){const r=a.anchor,o=r.getNode();if(a.isCollapsed()){"Range"===e.type&&e.anchorNode===e.focusNode&&(a.dirty=!0);const i=ai(n).event,s=i?i.timeStamp:performance.now(),[l,c,u,d,g]=Wt,f=Ro(),h=!1===n.isComposing()&&""===f.getTextContent();if(s<g+200&&r.offset===u&&r.key===d)jt(a,l,c);else if("text"===r.type)Tn(o)||t(141),Yt(a,o);else if("element"===r.type&&!h){Lr(o)||t(259);const e=r.getNode();e.isEmpty()?function(e,t){jt(e,t.getTextFormat(),t.getTextStyle())}(a,e):jt(a,0,"")}}else{const e=r.key,t=a.focus.key,n=a.getNodes(),o=n.length,s=a.isBackward(),c=s?l:i,u=s?i:l,d=s?t:e,g=s?e:t;let f=2047,h=!1;for(let e=0;e<o;e++){const t=n[e],r=t.getTextContentSize();if(Tn(t)&&0!==r&&!(0===e&&t.__key===d&&c===r||e===o-1&&t.__key===g&&0===u)&&(h=!0,f&=t.getFormat(),0===f))break}a.format=h?f:0}}ti(n,Ie,void 0)}))}function jt(e,t,n){e.format===t&&e.style===n||(e.format=t,e.style=n,e.dirty=!0)}function Yt(e,t){jt(e,t.getFormat(),t.getStyle())}function Vt(e){if(!e.getTargetRanges)return null;const t=e.getTargetRanges();return 0===t.length?null:t[0]}function Gt(e,t){const n=e._compositionKey;if(ko(null),null!==n&&null!=t){if(""===t){const t=No(n),r=bo(e.getElementByKey(n));return void(null!==r&&null!==r.nodeValue&&Tn(t)&&Wo(t,r.nodeValue,null,null,!0))}if("\n"===t[t.length-1]){const t=Qn();if(Dn(t)){const n=t.focus;return t.anchor.set(n.key,n.offset,n.type),void ti(e,ot,null)}}}Bo(!0,e,t)}function qt(e){let t=e.__lexicalEventHandles;return void 0===t&&(t=[],e.__lexicalEventHandles=t),t}const Zt=new Map;function Xt(e){const t=function(e){const t=li(e);return t?t.getSelection():null}(e.target);if(null===t)return;const n=ho(t.anchorNode);if(null===n)return;Dt&&(Dt=!1,Or(n,(()=>{const r=er(),o=t.anchorNode;(yi(o)||yo(o))&&Lo(Xn(r,t,n,e))})));const r=Ko(n),o=r[r.length-1],i=o._key,s=Zt.get(i),l=s||o;l!==n&&Jt(t,l,!1),Jt(t,n,!0),n!==o?Zt.set(i,n):s&&Zt.delete(i)}function Qt(e){e._lexicalHandled=!0}function en(e){return!0===e._lexicalHandled}function tn(e){const n=e.ownerDocument,r=Mt.get(n);if(void 0===r)return;const o=r-1;o>=0||t(164),Mt.set(n,o),0===o&&n.removeEventListener("selectionchange",Xt);const i=po(e);fo(i)?(function(e){if(null!==e._parentEditor){const t=Ko(e),n=t[t.length-1]._key;Zt.get(n)===e&&Zt.delete(n)}else Zt.delete(e._key)}(i),e.__lexicalEditor=null):i&&t(198);const s=qt(e);for(let e=0;e<s.length;e++)s[e]();e.__lexicalEventHandles=[]}function nn(e,t,n){mr();const r=e.__key,o=e.getParent();if(null===o)return;const i=function(e){const t=Qn();if(!Dn(t)||!Lr(e))return t;const{anchor:n,focus:r}=t,o=n.getNode(),i=r.getNode();return si(o,e)&&n.set(e.__key,0,"element"),si(i,e)&&r.set(e.__key,0,"element"),t}(e);let s=!1;if(Dn(i)&&t){const t=i.anchor,n=i.focus;t.key===r&&(rr(t,e,o,e.getPreviousSibling(),e.getNextSibling()),s=!0),n.key===r&&(rr(n,e,o,e.getPreviousSibling(),e.getNextSibling()),s=!0)}else Kn(i)&&t&&e.isSelected()&&e.selectPrevious();if(Dn(i)&&t&&!s){const t=e.getIndexWithinParent();vo(e),tr(i,o,t,-1)}else vo(e);n||ui(o)||o.canBeEmpty()||!o.isEmpty()||nn(o,t),t&&i&&$r(o)&&o.isEmpty()&&o.selectEnd()}class rn{__type;__key;__parent;__prev;__next;__state;static getType(){const{ownNodeType:e}=Pi(this);return void 0===e&&t(64,this.name),e}static clone(e){t(65,this.name)}$config(){return{}}config(e,t){const n=t.extends||Object.getPrototypeOf(this.constructor);return Object.assign(t,{extends:n,type:e}),{[e]:t}}afterCloneFrom(e){this.__key===e.__key?(this.__parent=e.__parent,this.__next=e.__next,this.__prev=e.__prev,this.__state=e.__state):e.__state&&(this.__state=e.__state.getWritable(this))}static importDOM;constructor(e){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,Object.defineProperty(this,"__state",{configurable:!0,enumerable:!1,value:void 0,writable:!0}),xo(this,e)}getType(){return this.__type}isInline(){t(137,this.constructor.name)}isAttached(){let e=this.__key;for(;null!==e;){if("root"===e)return!0;const t=No(e);if(null===t)break;e=t.__parent}return!1}isSelected(e){const t=e||Qn();if(null==t)return!1;const n=t.getNodes().some((e=>e.__key===this.__key));if(Tn(this))return n;if(Dn(t)&&"element"===t.anchor.type&&"element"===t.focus.type){if(t.isCollapsed())return!1;const e=this.getParent();if(Kr(this)&&this.isInline()&&e){const n=t.isBackward()?t.focus:t.anchor;if(e.is(n.getNode())&&n.offset===e.getChildrenSize()&&this.is(e.getLastChild()))return!1}}return n}getKey(){return this.__key}getIndexWithinParent(){const e=this.getParent();if(null===e)return-1;let t=e.getFirstChild(),n=0;for(;null!==t;){if(this.is(t))return n;n++,t=t.getNextSibling()}return-1}getParent(){const e=this.getLatest().__parent;return null===e?null:No(e)}getParentOrThrow(){const e=this.getParent();return null===e&&t(66,this.__key),e}getTopLevelElement(){let e=this;for(;null!==e;){const n=e.getParent();if(ui(n))return Lr(e)||e===this&&Kr(e)||t(194),e;e=n}return null}getTopLevelElementOrThrow(){const e=this.getTopLevelElement();return null===e&&t(67,this.__key),e}getParents(){const e=[];let t=this.getParent();for(;null!==t;)e.push(t),t=t.getParent();return e}getParentKeys(){const e=[];let t=this.getParent();for(;null!==t;)e.push(t.__key),t=t.getParent();return e}getPreviousSibling(){const e=this.getLatest().__prev;return null===e?null:No(e)}getPreviousSiblings(){const e=[],t=this.getParent();if(null===t)return e;let n=t.getFirstChild();for(;null!==n&&!n.is(this);)e.push(n),n=n.getNextSibling();return e}getNextSibling(){const e=this.getLatest().__next;return null===e?null:No(e)}getNextSiblings(){const e=[];let t=this.getNextSibling();for(;null!==t;)e.push(t),t=t.getNextSibling();return e}getCommonAncestor(e){const t=Lr(this)?this:this.getParent(),n=Lr(e)?e:e.getParent(),r=t&&n?us(t,n):null;return r?r.commonAncestor:null}is(e){return null!=e&&this.__key===e.__key}isBefore(e){const n=us(this,e);return null!==n&&("descendant"===n.type||("branch"===n.type?-1===ls(n):("same"!==n.type&&"ancestor"!==n.type&&t(279),!1)))}isParentOf(e){const t=us(this,e);return null!==t&&"ancestor"===t.type}getNodesBetween(e){const n=this.isBefore(e),r=[],o=new Set;let i=this;for(;null!==i;){const s=i.__key;if(o.has(s)||(o.add(s),r.push(i)),i===e)break;const l=Lr(i)?n?i.getFirstChild():i.getLastChild():null;if(null!==l){i=l;continue}const a=n?i.getNextSibling():i.getPreviousSibling();if(null!==a){i=a;continue}const c=i.getParentOrThrow();if(o.has(c.__key)||r.push(c),c===e)break;let u=null,d=c;do{if(null===d&&t(68),u=n?d.getNextSibling():d.getPreviousSibling(),d=d.getParent(),null===d)break;null!==u||o.has(d.__key)||r.push(d)}while(null===u);i=u}return n||r.reverse(),r}isDirty(){const e=br()._dirtyLeaves;return null!==e&&e.has(this.__key)}getLatest(){const e=No(this.__key);return null===e&&t(113),e}getWritable(){mr();const e=yr(),t=br(),n=e._nodeMap,r=this.__key,o=this.getLatest(),i=t._cloneNotNeeded,s=Qn();if(null!==s&&s.setCachedNodes(null),i.has(r))return wo(o),o;const l=Ei(o);return i.add(r),wo(l),n.set(r,l),l}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(e,n){t(70)}updateDOM(e,n,r){t(71)}exportDOM(e){return{element:this.createDOM(e._config,e)}}exportJSON(){const e=this.__state?this.__state.toJSON():void 0;return{type:this.__type,version:1,...e}}static importJSON(e){t(18,this.name)}updateFromJSON(e){return function(e,t){const n=e.getWritable(),r=t.$;let o=r;for(const e of Y(n).flatKeys)e in t&&(void 0!==o&&o!==r||(o={...r}),o[e]=t[e]);return(n.__state||o)&&function(e){const t=e.getWritable(),n=t.__state?t.__state.getWritable(t):new j(t,Y(t));return t.__state=n,n}(e).updateFromJSON(o),n}(this,e)}static transform(){return null}remove(e){nn(this,!0,e)}replace(e,n){mr();let r=Qn();null!==r&&(r=r.clone()),fi(this,e);const o=this.getLatest(),i=this.__key,s=e.__key,l=e.getWritable(),a=this.getParentOrThrow().getWritable(),c=a.__size;vo(l);const u=o.getPreviousSibling(),d=o.getNextSibling(),g=o.__prev,f=o.__next,h=o.__parent;if(nn(o,!1,!0),null===u?a.__first=s:u.getWritable().__next=s,l.__prev=g,null===d?a.__last=s:d.getWritable().__prev=s,l.__next=f,l.__parent=h,a.__size=c,n&&(Lr(this)&&Lr(l)||t(139),this.getChildren().forEach((e=>{l.append(e)}))),Dn(r)){Lo(r);const e=r.anchor,t=r.focus;e.key===i&&Mn(e,l),t.key===i&&Mn(t,l)}return To()===i&&ko(s),l}insertAfter(e,t=!0){mr(),fi(this,e);const n=this.getWritable(),r=e.getWritable(),o=r.getParent(),i=Qn();let s=!1,l=!1;if(null!==o){const t=e.getIndexWithinParent();if(vo(r),Dn(i)){const e=o.__key,n=i.anchor,r=i.focus;s="element"===n.type&&n.key===e&&n.offset===t+1,l="element"===r.type&&r.key===e&&r.offset===t+1}}const a=this.getNextSibling(),c=this.getParentOrThrow().getWritable(),u=r.__key,d=n.__next;if(null===a?c.__last=u:a.getWritable().__prev=u,c.__size++,n.__next=u,r.__next=d,r.__prev=n.__key,r.__parent=n.__parent,t&&Dn(i)){const e=this.getIndexWithinParent();tr(i,c,e+1);const t=c.__key;s&&i.anchor.set(t,e+2,"element"),l&&i.focus.set(t,e+2,"element")}return e}insertBefore(e,t=!0){mr(),fi(this,e);const n=this.getWritable(),r=e.getWritable(),o=r.__key;vo(r);const i=this.getPreviousSibling(),s=this.getParentOrThrow().getWritable(),l=n.__prev,a=this.getIndexWithinParent();null===i?s.__first=o:i.getWritable().__next=o,s.__size++,n.__prev=o,r.__prev=l,r.__next=n.__key,r.__parent=n.__parent;const c=Qn();return t&&Dn(c)&&tr(c,this.getParentOrThrow(),a),e}isParentRequired(){return!1}createParentElementNode(){return Qr()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(e,t){mr();const n=this.getPreviousSibling(),r=this.getParentOrThrow();if(null===n)return r.select(0,0);if(Lr(n))return n.select();if(!Tn(n)){const e=n.getIndexWithinParent()+1;return r.select(e,e)}return n.select(e,t)}selectNext(e,t){mr();const n=this.getNextSibling(),r=this.getParentOrThrow();if(null===n)return r.select();if(Lr(n))return n.select(0,0);if(!Tn(n)){const e=n.getIndexWithinParent();return r.select(e,e)}return n.select(e,t)}markDirty(){this.getWritable()}reconcileObservedMutation(e,t){this.markDirty()}}class on extends rn{static getType(){return"linebreak"}static clone(e){return new on(e.__key)}constructor(e){super(e)}getTextContent(){return"\n"}createDOM(){return document.createElement("br")}updateDOM(){return!1}isInline(){return!0}static importDOM(){return{br:e=>function(e){const t=e.parentElement;if(null!==t&&xi(t)){const n=t.firstChild;if(n===e||n.nextSibling===e&&cn(n)){const n=t.lastChild;if(n===e||n.previousSibling===e&&cn(n))return!0}}return!1}(e)||function(e){const t=e.parentElement;if(null!==t&&xi(t)){const n=t.firstChild;if(n===e||n.nextSibling===e&&cn(n))return!1;const r=t.lastChild;if(r===e||r.previousSibling===e&&cn(r))return!0}return!1}(e)?null:{conversion:sn,priority:0}}}static importJSON(e){return ln().updateFromJSON(e)}}function sn(e){return{node:ln()}}function ln(){return gi(new on)}function an(e){return e instanceof on}function cn(e){return yo(e)&&/^( |\t|\r?\n)+$/.test(e.textContent||"")}function un(e,t){return 16&t?"code":128&t?"mark":32&t?"sub":64&t?"sup":null}function dn(e,t){return 1&t?"strong":2&t?"em":"span"}function gn(e,t,n,r,o){const i=r.classList;let s=qo(o,"base");void 0!==s&&i.add(...s),s=qo(o,"underlineStrikethrough");let l=!1;const a=8&t&&4&t;void 0!==s&&(8&n&&4&n?(l=!0,a||i.add(...s)):a&&i.remove(...s));for(const e in N){const r=N[e];if(s=qo(o,e),void 0!==s)if(n&r){if(l&&("underline"===e||"strikethrough"===e)){t&r&&i.remove(...s);continue}t&r&&(!a||"underline"!==e)&&"strikethrough"!==e||i.add(...s)}else t&r&&i.remove(...s)}}function fn(e,t,n){const r=t.firstChild,o=n.isComposing(),i=e+(o?w:"");if(null==r)t.textContent=i;else{const e=r.nodeValue;if(e!==i)if(o||s){const[t,n,o]=function(e,t){const n=e.length,r=t.length;let o=0,i=0;for(;o<n&&o<r&&e[o]===t[o];)o++;for(;i+o<n&&i+o<r&&e[n-i-1]===t[r-i-1];)i++;return[o,n-o-i,t.slice(o,r-i)]}(e,i);0!==n&&r.deleteData(t,n),r.insertData(t,o)}else r.nodeValue=i}}function hn(e,t,n,r,o,i){fn(o,e,t);const s=i.theme.text;void 0!==s&&gn(0,0,r,e,s)}function pn(e,t){const n=document.createElement(t);return n.appendChild(e),n}class mn extends rn{__text;__format;__style;__mode;__detail;static getType(){return"text"}static clone(e){return new mn(e.__text,e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__text=e.__text,this.__format=e.__format,this.__style=e.__style,this.__mode=e.__mode,this.__detail=e.__detail}constructor(e="",t){super(t),this.__text=e,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const e=this.getLatest();return P[e.__mode]}getStyle(){return this.getLatest().__style}isToken(){return 1===this.getLatest().__mode}isComposing(){return this.__key===To()}isSegmented(){return 2===this.getLatest().__mode}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(e){const t=N[e];return!!(this.getFormat()&t)}isSimpleText(){return"text"===this.__type&&0===this.__mode}getTextContent(){return this.getLatest().__text}getFormatFlags(e,t){return So(this.getLatest().__format,e,t)}canHaveFormat(){return!0}isInline(){return!0}createDOM(e,t){const n=this.__format,r=un(0,n),o=dn(0,n),i=null===r?o:r,s=document.createElement(i);let l=s;this.hasFormat("code")&&s.setAttribute("spellcheck","false"),null!==r&&(l=document.createElement(o),s.appendChild(l)),hn(l,this,0,n,this.__text,e);const a=this.__style;return""!==a&&(s.style.cssText=a),s}updateDOM(e,n,r){const o=this.__text,i=e.__format,s=this.__format,l=un(0,i),a=un(0,s),c=dn(0,i),u=dn(0,s);if((null===l?c:l)!==(null===a?u:a))return!0;if(l===a&&c!==u){const e=n.firstChild;null==e&&t(48);const i=document.createElement(u);return hn(i,this,0,s,o,r),n.replaceChild(i,e),!1}let d=n;null!==a&&null!==l&&(d=n.firstChild,null==d&&t(49)),fn(o,d,this);const g=r.theme.text;void 0!==g&&i!==s&&gn(0,i,s,d,g);const f=e.__style,h=this.__style;return f!==h&&(n.style.cssText=h),!1}static importDOM(){return{"#text":()=>({conversion:Cn,priority:0}),b:()=>({conversion:yn,priority:0}),code:()=>({conversion:wn,priority:0}),em:()=>({conversion:wn,priority:0}),i:()=>({conversion:wn,priority:0}),mark:()=>({conversion:wn,priority:0}),s:()=>({conversion:wn,priority:0}),span:()=>({conversion:_n,priority:0}),strong:()=>({conversion:wn,priority:0}),sub:()=>({conversion:wn,priority:0}),sup:()=>({conversion:wn,priority:0}),u:()=>({conversion:wn,priority:0})}}static importJSON(e){return kn().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setTextContent(e.text).setFormat(e.format).setDetail(e.detail).setMode(e.mode).setStyle(e.style)}exportDOM(e){let{element:n}=super.exportDOM(e);return yi(n)||t(132),n.style.whiteSpace="pre-wrap",this.hasFormat("lowercase")?n.style.textTransform="lowercase":this.hasFormat("uppercase")?n.style.textTransform="uppercase":this.hasFormat("capitalize")&&(n.style.textTransform="capitalize"),this.hasFormat("bold")&&(n=pn(n,"b")),this.hasFormat("italic")&&(n=pn(n,"i")),this.hasFormat("strikethrough")&&(n=pn(n,"s")),this.hasFormat("underline")&&(n=pn(n,"u")),{element:n}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(e,t){}setFormat(e){const t=this.getWritable();return t.__format="string"==typeof e?N[e]:e,t}setDetail(e){const t=this.getWritable();return t.__detail="string"==typeof e?E[e]:e,t}setStyle(e){const t=this.getWritable();return t.__style=e,t}toggleFormat(e){const t=So(this.getFormat(),e,null);return this.setFormat(t)}toggleDirectionless(){const e=this.getWritable();return e.__detail^=1,e}toggleUnmergeable(){const e=this.getWritable();return e.__detail^=2,e}setMode(e){const t=O[e];if(this.__mode===t)return this;const n=this.getWritable();return n.__mode=t,n}setTextContent(e){if(this.__text===e)return this;const t=this.getWritable();return t.__text=e,t}select(e,t){mr();let n=e,r=t;const o=Qn(),i=this.getTextContent(),s=this.__key;if("string"==typeof i){const e=i.length;void 0===n&&(n=e),void 0===r&&(r=e)}else n=0,r=0;if(!Dn(o))return Gn(s,n,s,r,"text","text");{const e=To();e!==o.anchor.key&&e!==o.focus.key||ko(s),o.setTextNodeRange(this,n,this,r)}return o}selectStart(){return this.select(0,0)}selectEnd(){const e=this.getTextContentSize();return this.select(e,e)}spliceText(e,t,n,r){const o=this.getWritable(),i=o.__text,s=n.length;let l=e;l<0&&(l=s+l,l<0&&(l=0));const a=Qn();if(r&&Dn(a)){const t=e+s;a.setTextNodeRange(o,t,o,t)}const c=i.slice(0,l)+n+i.slice(l+t);return o.__text=c,o}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...e){mr();const t=this.getLatest(),n=t.getTextContent();if(""===n)return[];const r=t.__key,o=To(),i=n.length;e.sort(((e,t)=>e-t)),e.push(i);const s=[],l=e.length;for(let t=0,r=0;t<i&&r<=l;r++){const o=e[r];o>t&&(s.push(n.slice(t,o)),t=o)}const a=s.length;if(1===a)return[t];const c=s[0],u=t.getParent();let d;const g=t.getFormat(),f=t.getStyle(),h=t.__detail;let p=!1,m=null,_=null;const y=Qn();if(Dn(y)){const[e,t]=y.isBackward()?[y.focus,y.anchor]:[y.anchor,y.focus];"text"===e.type&&e.key===r&&(m=e),"text"===t.type&&t.key===r&&(_=t)}t.isSegmented()?(d=kn(c),d.__format=g,d.__style=f,d.__detail=h,d.__state=Z(t,d),p=!0):d=t.setTextContent(c);const b=[d];for(let e=1;e<a;e++){const n=kn(s[e]);n.__format=g,n.__style=f,n.__detail=h,n.__state=Z(t,n);const i=n.__key;o===r&&ko(i),b.push(n)}const S=m?m.offset:null,C=_?_.offset:null;let x=0;for(const e of b){if(!m&&!_)break;const t=x+e.getTextContentSize();if(null!==m&&null!==S&&S<=t&&S>=x&&(m.set(e.getKey(),S-x,"text"),S<t&&(m=null)),null!==_&&null!==C&&C<=t&&C>=x){_.set(e.getKey(),C-x,"text");break}x=t}if(null!==u){!function(e){const t=e.getPreviousSibling(),n=e.getNextSibling();null!==t&&wo(t),null!==n&&wo(n)}(this);const e=u.getWritable(),t=this.getIndexWithinParent();p?(e.splice(t,0,b),this.remove()):e.splice(t,1,b),Dn(y)&&tr(y,u,t,a-1)}return b}mergeWithSibling(e){const n=e===this.getPreviousSibling();n||e===this.getNextSibling()||t(50);const r=this.__key,o=e.__key,i=this.__text,s=i.length;To()===o&&ko(r);const l=Qn();if(Dn(l)){const t=l.anchor,i=l.focus;null!==t&&t.key===o&&or(t,n,r,e,s),null!==i&&i.key===o&&or(i,n,r,e,s)}const a=e.__text,c=n?a+i:i+a;this.setTextContent(c);const u=this.getWritable();return e.remove(),u}isTextEntity(){return!1}}function _n(e){return{forChild:Nn(e.style),node:null}}function yn(e){const t=e,n="normal"===t.style.fontWeight;return{forChild:Nn(t.style,n?void 0:"bold"),node:null}}const bn=new WeakMap;function Sn(e){if(!yi(e))return!1;if("PRE"===e.nodeName)return!0;const t=e.style.whiteSpace;return"string"==typeof t&&t.startsWith("pre")}function Cn(e){const n=e;null===e.parentElement&&t(129);let r=n.textContent||"";if(null!==function(e){let t,n=e.parentNode;const r=[e];for(;null!==n&&void 0===(t=bn.get(n))&&!Sn(n);)r.push(n),n=n.parentNode;const o=void 0===t?n:t;for(let e=0;e<r.length;e++)bn.set(r[e],o);return o}(n)){const e=r.split(/(\r?\n|\t)/),t=[],n=e.length;for(let r=0;r<n;r++){const n=e[r];"\n"===n||"\r\n"===n?t.push(ln()):"\t"===n?t.push(An()):""!==n&&t.push(kn(n))}return{node:t}}if(r=r.replace(/\r/g,"").replace(/[ \t\n]+/g," "),""===r)return{node:null};if(" "===r[0]){let e=n,t=!0;for(;null!==e&&null!==(e=xn(e,!1));){const n=e.textContent||"";if(n.length>0){/[ \t\n]$/.test(n)&&(r=r.slice(1)),t=!1;break}}t&&(r=r.slice(1))}if(" "===r[r.length-1]){let e=n,t=!0;for(;null!==e&&null!==(e=xn(e,!0));)if((e.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){t=!1;break}t&&(r=r.slice(0,r.length-1))}return""===r?{node:null}:{node:kn(r)}}function xn(e,t){let n=e;for(;;){let e;for(;null===(e=t?n.nextSibling:n.previousSibling);){const e=n.parentElement;if(null===e)return null;n=e}if(n=e,yi(n)){const e=n.style.display;if(""===e&&!Ci(n)||""!==e&&!e.startsWith("inline"))return null}let r=n;for(;null!==(r=t?n.firstChild:n.lastChild);)n=r;if(yo(n))return n;if("BR"===n.nodeName)return null}}const vn={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function wn(e){const t=vn[e.nodeName.toLowerCase()];return void 0===t?{node:null}:{forChild:Nn(e.style,t),node:null}}function kn(e=""){return gi(new mn(e))}function Tn(e){return e instanceof mn}function Nn(e,t){const n=e.fontWeight,r=e.textDecoration.split(" "),o="700"===n||"bold"===n,i=r.includes("line-through"),s="italic"===e.fontStyle,l=r.includes("underline"),a=e.verticalAlign;return e=>Tn(e)?(o&&!e.hasFormat("bold")&&e.toggleFormat("bold"),i&&!e.hasFormat("strikethrough")&&e.toggleFormat("strikethrough"),s&&!e.hasFormat("italic")&&e.toggleFormat("italic"),l&&!e.hasFormat("underline")&&e.toggleFormat("underline"),"sub"!==a||e.hasFormat("subscript")||e.toggleFormat("subscript"),"super"!==a||e.hasFormat("superscript")||e.toggleFormat("superscript"),t&&!e.hasFormat(t)&&e.toggleFormat(t),e):e}class En extends mn{static getType(){return"tab"}static clone(e){return new En(e.__key)}constructor(e){super("\t",e),this.__detail=2}static importDOM(){return null}createDOM(e){const t=super.createDOM(e),n=qo(e.theme,"tab");return void 0!==n&&t.classList.add(...n),t}static importJSON(e){return An().updateFromJSON(e)}setTextContent(e){return"\t"!==e&&""!==e&&n(126),super.setTextContent("\t")}spliceText(e,n,r,o){return""===r&&0===n||"\t"===r&&1===n||t(286),this}setDetail(e){return 2!==e&&t(127),this}setMode(e){return"normal"!==e&&t(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function An(){return gi(new En)}function Fn(e){return e instanceof En}class On{key;offset;type;_selection;constructor(e,t,n){this._selection=null,this.key=e,this.offset=t,this.type=n}is(e){return this.key===e.key&&this.offset===e.offset&&this.type===e.type}isBefore(e){return this.key===e.key?this.offset<e.offset:ss(Ss(ds(this,"next")),Ss(ds(e,"next")))<0}getNode(){const e=No(this.key);return null===e&&t(20),e}set(e,t,n,r){const o=this._selection,i=this.key;r&&this.key===e&&this.offset===t&&this.type===n||(this.key=e,this.offset=t,this.type=n,pr()||(To()===i&&ko(e),null!==o&&(o.setCachedNodes(null),o.dirty=!0)))}}function Pn(e,t,n){return new On(e,t,n)}function Rn(e,t){let n=t.__key,r=e.offset,o="element";if(Tn(t)){o="text";const e=t.getTextContentSize();r>e&&(r=e)}else if(!Lr(t)){const e=t.getNextSibling();if(Tn(e))n=e.__key,r=0,o="text";else{const e=t.getParent();e&&(n=e.__key,r=t.getIndexWithinParent()+1)}}e.set(n,r,o)}function Mn(e,t){if(Lr(t)){const n=t.getLastDescendant();Lr(n)||Tn(n)?Rn(e,n):Rn(e,t)}else Rn(e,t)}class Ln{_nodes;_cachedNodes;dirty;constructor(e){this._cachedNodes=null,this._nodes=e,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){if(!Kn(e))return!1;const t=this._nodes,n=e._nodes;return t.size===n.size&&Array.from(t).every((e=>n.has(e)))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(e){this.dirty=!0,this._nodes.add(e),this._cachedNodes=null}delete(e){this.dirty=!0,this._nodes.delete(e),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(e){return this._nodes.has(e)}clone(){return new Ln(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(e){}insertText(){}insertNodes(e){const t=this.getNodes(),n=t.length,r=t[n-1];let o;if(Tn(r))o=r.select();else{const e=r.getIndexWithinParent()+1;o=r.getParentOrThrow().select(e,e)}o.insertNodes(e);for(let e=0;e<n;e++)t[e].remove()}getNodes(){const e=this._cachedNodes;if(null!==e)return e;const t=this._nodes,n=[];for(const e of t){const t=No(e);null!==t&&n.push(t)}return pr()||(this._cachedNodes=n),n}getTextContent(){const e=this.getNodes();let t="";for(let n=0;n<e.length;n++)t+=e[n].getTextContent();return t}deleteNodes(){const e=this.getNodes();if((Qn()||er())===this&&e[0]){const t=Vi(e[0],"next");fs(os(t,t))}for(const t of e)t.remove()}}function Dn(e){return e instanceof In}class In{format;style;anchor;focus;_cachedNodes;dirty;constructor(e,t,n,r){this.anchor=e,this.focus=t,e._selection=this,t._selection=this,this._cachedNodes=null,this.format=n,this.style=r,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){return!!Dn(e)&&this.anchor.is(e.anchor)&&this.focus.is(e.focus)&&this.format===e.format&&this.style===e.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const e=this._cachedNodes;if(null!==e)return e;const t=function(e){const t=[],[n,r]=e.getTextSlices();n&&t.push(n.caret.origin);const o=new Set,i=new Set;for(const n of e)if(Hi(n)){const{origin:e}=n;0===t.length?o.add(e):(i.add(e),t.push(e))}else{const{origin:e}=n;Lr(e)&&i.has(e)||t.push(e)}if(r&&t.push(r.caret.origin),Ui(e.focus)&&Lr(e.focus.origin)&&null===e.focus.getNodeAtCaret())for(let n=Xi(e.focus.origin,"previous");Hi(n)&&o.has(n.origin)&&!n.origin.isEmpty()&&n.origin.is(t[t.length-1]);n=Qi(n))o.delete(n.origin),t.pop();for(;t.length>1;){const e=t[t.length-1];if(!Lr(e)||i.has(e)||e.isEmpty()||o.has(e))break;t.pop()}if(0===t.length&&e.isCollapsed()){const n=Ss(e.anchor),r=Ss(e.anchor.getFlipped()),o=e=>Wi(e)?e.origin:e.getNodeAtCaret(),i=o(n)||o(r)||(e.anchor.getNodeAtCaret()?n.origin:r.origin);t.push(i)}return t}(vs(ps(this),"next"));return pr()||(this._cachedNodes=t),t}setTextNodeRange(e,t,n,r){this.anchor.set(e.__key,t,"text"),this.focus.set(n.__key,r,"text")}getTextContent(){const e=this.getNodes();if(0===e.length)return"";const t=e[0],n=e[e.length-1],r=this.anchor,o=this.focus,i=r.isBefore(o),[s,l]=$n(this);let a="",c=!0;for(let u=0;u<e.length;u++){const d=e[u];if(Lr(d)&&!d.isInline())c||(a+="\n"),c=!d.isEmpty();else if(c=!1,Tn(d)){let e=d.getTextContent();d===t?d===n?"element"===r.type&&"element"===o.type&&o.offset!==r.offset||(e=s<l?e.slice(s,l):e.slice(l,s)):e=i?e.slice(s):e.slice(l):d===n&&(e=i?e.slice(0,l):e.slice(0,s)),a+=e}else!Kr(d)&&!an(d)||d===n&&this.isCollapsed()||(a+=d.getTextContent())}return a}applyDOMRange(e){const t=br(),n=t.getEditorState()._selection,r=Yn(e.startContainer,e.startOffset,e.endContainer,e.endOffset,t,n);if(null===r)return;const[o,i]=r;this.anchor.set(o.key,o.offset,o.type,!0),this.focus.set(i.key,i.offset,i.type,!0),te(this)}clone(){const e=this.anchor,t=this.focus;return new In(Pn(e.key,e.offset,e.type),Pn(t.key,t.offset,t.type),this.format,this.style)}toggleFormat(e){this.format=So(this.format,e,null),this.dirty=!0}setFormat(e){this.format=e,this.dirty=!0}setStyle(e){this.style=e,this.dirty=!0}hasFormat(e){const t=N[e];return!!(this.format&t)}insertRawText(e){const t=e.split(/(\r?\n|\t)/),n=[],r=t.length;for(let e=0;e<r;e++){const r=t[e];"\n"===r||"\r\n"===r?n.push(ln()):"\t"===r?n.push(An()):n.push(kn(r))}this.insertNodes(n)}insertText(e){const n=this.anchor,r=this.focus,o=this.format,i=this.style;let s=n,l=r;!this.isCollapsed()&&r.isBefore(n)&&(s=r,l=n),"element"===s.type&&function(e,t,n,r){const o=e.getNode(),i=o.getChildAtIndex(e.offset),s=kn();if(s.setFormat(n),s.setStyle(r),eo(i))i.splice(0,0,[s]);else{const e=$r(o)?Qr().append(s):s;null===i?o.append(e):i.insertBefore(e)}e.is(t)&&t.set(s.__key,0,"text"),e.set(s.__key,0,"text")}(s,l,o,i),"element"===l.type&&gs(l,Ss(ds(l,"next")));const a=s.offset;let c=l.offset;const u=this.getNodes(),d=u.length;let g=u[0];Tn(g)||t(26);const f=g.getTextContent().length,h=g.getParentOrThrow();let p=u[d-1];if(1===d&&"element"===l.type&&(c=f,l.set(s.key,c,"text")),this.isCollapsed()&&a===f&&(_o(g)||!g.canInsertTextAfter()||!h.canInsertTextAfter()&&null===g.getNextSibling())){let t=g.getNextSibling();if(Tn(t)&&t.canInsertTextBefore()&&!_o(t)||(t=kn(),t.setFormat(o),t.setStyle(i),h.canInsertTextAfter()?g.insertAfter(t):h.insertAfter(t)),t.select(0,0),g=t,""!==e)return void this.insertText(e)}else if(this.isCollapsed()&&0===a&&(_o(g)||!g.canInsertTextBefore()||!h.canInsertTextBefore()&&null===g.getPreviousSibling())){let t=g.getPreviousSibling();if(Tn(t)&&!_o(t)||(t=kn(),t.setFormat(o),h.canInsertTextBefore()?g.insertBefore(t):h.insertBefore(t)),t.select(),g=t,""!==e)return void this.insertText(e)}else if(g.isSegmented()&&a!==f){const e=kn(g.getTextContent());e.setFormat(o),g.replace(e),g=e}else if(!this.isCollapsed()&&""!==e){const t=p.getParent();if(!h.canInsertTextBefore()||!h.canInsertTextAfter()||Lr(t)&&(!t.canInsertTextBefore()||!t.canInsertTextAfter()))return this.insertText(""),jn(this.anchor,this.focus,null),void this.insertText(e)}if(1===d){if(mo(g)){const t=kn(e);return t.select(),void g.replace(t)}const t=g.getFormat(),n=g.getStyle();if(a!==c||t===o&&n===i){if(Fn(g)){const t=kn(e);return t.setFormat(o),t.setStyle(i),t.select(),void g.replace(t)}}else{if(""!==g.getTextContent()){const t=kn(e);if(t.setFormat(o),t.setStyle(i),t.select(),0===a)g.insertBefore(t,!1);else{const[e]=g.splitText(a);e.insertAfter(t,!1)}return void(t.isComposing()&&"text"===this.anchor.type&&(this.anchor.offset-=e.length))}g.setFormat(o),g.setStyle(i)}const r=c-a;g=g.spliceText(a,r,e,!0),""===g.getTextContent()?g.remove():"text"===this.anchor.type&&(g.isComposing()?this.anchor.offset-=e.length:(this.format=t,this.style=n))}else{const t=new Set([...g.getParentKeys(),...p.getParentKeys()]),n=Lr(g)?g:g.getParentOrThrow();let r=Lr(p)?p:p.getParentOrThrow(),o=p;if(!n.is(r)&&r.isInline())do{o=r,r=r.getParentOrThrow()}while(r.isInline());if("text"===l.type&&(0!==c||""===p.getTextContent())||"element"===l.type&&p.getIndexWithinParent()<c)if(Tn(p)&&!mo(p)&&c!==p.getTextContentSize()){if(p.isSegmented()){const e=kn(p.getTextContent());p.replace(e),p=e}$r(l.getNode())||"text"!==l.type||(p=p.spliceText(0,c,"")),t.add(p.__key)}else{const e=p.getParentOrThrow();e.canBeEmpty()||1!==e.getChildrenSize()?p.remove():e.remove()}else t.add(p.__key);const i=r.getChildren(),s=new Set(u),h=n.is(r),m=n.isInline()&&null===g.getNextSibling()?n:g;for(let e=i.length-1;e>=0;e--){const t=i[e];if(t.is(g)||Lr(t)&&t.isParentOf(g))break;t.isAttached()&&(!s.has(t)||t.is(o)?h||m.insertAfter(t,!1):t.remove())}if(!h){let e=r,n=null;for(;null!==e;){const r=e.getChildren(),o=r.length;(0===o||r[o-1].is(n))&&(t.delete(e.__key),n=e),e=e.getParent()}}if(mo(g))if(a===f)g.select();else{const t=kn(e);t.select(),g.replace(t)}else g=g.spliceText(a,f-a,e,!0),""===g.getTextContent()?g.remove():g.isComposing()&&"text"===this.anchor.type&&(this.anchor.offset-=e.length);for(let e=1;e<d;e++){const n=u[e],r=n.__key;t.has(r)||n.remove()}}}removeText(){const e=Qn()===this;hs(this,bs(ps(this))),e&&Qn()!==this&&Lo(this)}formatText(e,t=null){if(this.isCollapsed())return this.toggleFormat(e),void ko(null);const n=this.getNodes(),r=[];for(const e of n)Tn(e)&&r.push(e);const o=t=>{n.forEach((n=>{if(Lr(n)){const r=n.getFormatFlags(e,t);n.setTextFormat(r)}}))},i=r.length;if(0===i)return this.toggleFormat(e),ko(null),void o(t);const s=this.anchor,l=this.focus,a=this.isBackward(),c=a?l:s,u=a?s:l;let d=0,g=r[0],f="element"===c.type?0:c.offset;if("text"===c.type&&f===g.getTextContentSize()&&(d=1,g=r[1],f=0),null==g)return;const h=g.getFormatFlags(e,t);o(h);const p=i-1;let m=r[p];const _="text"===u.type?u.offset:m.getTextContentSize();if(g.is(m)){if(f===_)return;if(_o(g)||0===f&&_===g.getTextContentSize())g.setFormat(h);else{const e=g.splitText(f,_),t=0===f?e[0]:e[1];t.setFormat(h),"text"===c.type&&c.set(t.__key,0,"text"),"text"===u.type&&u.set(t.__key,_-f,"text")}return void(this.format=h)}0===f||_o(g)||([,g]=g.splitText(f),f=0),g.setFormat(h);const y=m.getFormatFlags(e,h);_>0&&(_===m.getTextContentSize()||_o(m)||([m]=m.splitText(_)),m.setFormat(y));for(let t=d+1;t<p;t++){const n=r[t],o=n.getFormatFlags(e,y);n.setFormat(o)}"text"===c.type&&c.set(g.__key,f,"text"),"text"===u.type&&u.set(m.__key,_,"text"),this.format=h|y}insertNodes(e){if(0===e.length)return;if(this.isCollapsed()||this.removeText(),"root"===this.anchor.key){this.insertParagraph();const n=Qn();return Dn(n)||t(134),n.insertNodes(e)}const n=(this.isBackward()?this.focus:this.anchor).getNode(),r=Ri(n,vi),o=e[e.length-1];if(Lr(r)&&"__language"in r){if("__language"in e[0])this.insertText(e[0].getTextContent());else{const t=sr(this);r.splice(t,0,e),o.selectEnd()}return}if(!e.some((e=>(Lr(e)||Kr(e))&&!e.isInline()))){Lr(r)||t(211,n.constructor.name,n.getType());const i=sr(this);return r.splice(i,0,e),void o.selectEnd()}const i=function(e){const t=Qr();let n=null;for(let r=0;r<e.length;r++){const o=e[r],i=an(o);if(i||Kr(o)&&o.isInline()||Lr(o)&&o.isInline()||Tn(o)||o.isParentRequired()){if(null===n&&(n=o.createParentElementNode(),t.append(n),i))continue;null!==n&&n.append(o)}else t.append(o),n=null}return t}(e),s=i.getLastDescendant(),l=i.getChildren(),a=Lr(r)&&r.isEmpty()?null:this.insertParagraph(),c=l[l.length-1];let u=l[0];var d;Lr(d=u)&&vi(d)&&!d.isEmpty()&&Lr(r)&&(!r.isEmpty()||r.canMergeWhenEmpty())&&(Lr(r)||t(211,n.constructor.name,n.getType()),r.append(...u.getChildren()),u=l[1]),u&&(null===r&&t(212,n.constructor.name,n.getType()),function(e,n){const r=n.getParentOrThrow().getLastChild();let o=n;const i=[n];for(;o!==r;)o.getNextSibling()||t(140),o=o.getNextSibling(),i.push(o);let s=e;for(const e of i)s=s.insertAfter(e)}(r,u));const g=Ri(s,vi);a&&Lr(g)&&(a.canMergeWhenEmpty()||vi(c))&&(g.append(...a.getChildren()),a.remove()),Lr(r)&&r.isEmpty()&&r.remove(),s.selectEnd();const f=Lr(r)?r.getLastChild():null;an(f)&&g!==r&&f.remove()}insertParagraph(){if("root"===this.anchor.key){const e=Qr();return Ro().splice(this.anchor.offset,0,[e]),e.select(),e}const e=sr(this),n=Ri(this.anchor.getNode(),vi);Lr(n)||t(213);const r=n.getChildAtIndex(e),o=r?[r,...r.getNextSiblings()]:[],i=n.insertNewAfter(this,!1);return i?(i.append(...o),i.selectStart(),i):null}insertLineBreak(e){const t=ln();if(this.insertNodes([t]),e){const e=t.getParentOrThrow(),n=t.getIndexWithinParent();e.select(n,n)}}extract(){const e=[...this.getNodes()],t=e.length;let n=e[0],r=e[t-1];const[o,i]=$n(this),s=this.isBackward(),[l,a]=s?[this.focus,this.anchor]:[this.anchor,this.focus],[c,u]=s?[i,o]:[o,i];if(0===t)return[];if(1===t){if(Tn(n)&&!this.isCollapsed()){const e=n.splitText(c,u),t=0===c?e[0]:e[1];return t?(l.set(t.getKey(),0,"text"),a.set(t.getKey(),t.getTextContentSize(),"text"),[t]):[]}return[n]}if(Tn(n)&&(c===n.getTextContentSize()?e.shift():0!==c&&([,n]=n.splitText(c),e[0]=n,l.set(n.getKey(),0,"text"))),Tn(r)){const t=r.getTextContent().length;0===u?e.pop():u!==t&&([r]=r.splitText(u),e[e.length-1]=r,a.set(r.getKey(),r.getTextContentSize(),"text"))}return e}modify(e,t,n){if(ar(this,e,t,n))return;const r="move"===e,o=br(),i=mi(ai(o));if(!i)return;const s=o._blockCursorElement,l=o._rootElement,a=this.focus.getNode();if(null===l||null===s||!Lr(a)||a.isInline()||a.canBeEmpty()||pi(s,o,l),this.dirty){let e=ri(o,this.anchor.key),t=ri(o,this.focus.key);"text"===this.anchor.type&&(e=bo(e)),"text"===this.focus.type&&(t=bo(t)),e&&t&&ir(i,e,this.anchor.offset,t,this.focus.offset)}if(function(e,t,n,r){e.modify(t,n,r)}(i,e,t?"backward":"forward",n),i.rangeCount>0){const e=i.getRangeAt(0),n=this.anchor.getNode(),o=$r(n)?n:function(e){let t=e.getParentOrThrow();for(;null!==t;){if(ui(t))return t;t=t.getParentOrThrow()}return t}(n);if(this.applyDOMRange(e),this.dirty=!0,!r){const n=this.getNodes(),r=[];let s=!1;for(let e=0;e<n.length;e++){const t=n[e];si(t,o)?r.push(t):s=!0}if(s&&r.length>0)if(t){const e=r[0];Lr(e)?e.selectStart():e.getParentOrThrow().selectStart()}else{const e=r[r.length-1];Lr(e)?e.selectEnd():e.getParentOrThrow().selectEnd()}i.anchorNode===e.startContainer&&i.anchorOffset===e.startOffset||function(e){const t=e.focus,n=e.anchor,r=n.key,o=n.offset,i=n.type;n.set(t.key,t.offset,t.type,!0),t.set(r,o,i,!0)}(this)}}"lineboundary"===n&&ar(this,e,t,n,"decorators")}forwardDeletion(e,t,n){if(!n&&("element"===e.type&&Lr(t)&&e.offset===t.getChildrenSize()||"text"===e.type&&e.offset===t.getTextContentSize())){const e=t.getParent(),n=t.getNextSibling()||(null===e?null:e.getNextSibling());if(Lr(n)&&n.isShadowRoot())return!0}return!1}deleteCharacter(e){const t=this.isCollapsed();if(this.isCollapsed()){const t=this.anchor;let n=t.getNode();if(this.forwardDeletion(t,n,e))return;const r=ns(ds(t,e?"previous":"next"));if(r.getTextSlices().every((e=>null===e||0===e.distance))){let e={type:"initial"};for(const t of r.iterNodeCarets("shadowRoot"))if(Hi(t))if(t.origin.isInline());else{if(t.origin.isShadowRoot()){if("merge-block"===e.type)break;if(Lr(r.anchor.origin)&&r.anchor.origin.isEmpty()){const e=Ss(t);hs(this,os(e,e)),r.anchor.origin.remove()}return}"merge-next-block"!==e.type&&"merge-block"!==e.type||(e={block:e.block,caret:t,type:"merge-block"})}else{if("merge-block"===e.type)break;if(Ui(t)){if(Lr(t.origin)){if(t.origin.isInline()){if(!t.origin.isParentOf(r.anchor.origin))break}else e={block:t.origin,type:"merge-next-block"};continue}if(Kr(t.origin)){if(t.origin.isIsolated());else if("merge-next-block"===e.type&&(t.origin.isKeyboardSelectable()||!t.origin.isInline())&&Lr(r.anchor.origin)&&r.anchor.origin.isEmpty()){r.anchor.origin.remove();const e=Zn();e.add(t.origin.getKey()),Lo(e)}else t.origin.remove();return}break}}if("merge-block"===e.type){const{caret:t,block:n}=e;return hs(this,os(!t.origin.isEmpty()&&n.isEmpty()?ms(Vi(n,t.direction)):r.anchor,t)),this.removeText()}}const o=this.focus;if(this.modify("extend",e,"character"),this.isCollapsed()){if(e&&0===t.offset&&Bn(this,t.getNode()))return}else{const r="text"===o.type?o.getNode():null;if(n="text"===t.type?t.getNode():null,null!==r&&r.isSegmented()){const t=o.offset,i=r.getTextContentSize();if(r.is(n)||e&&t!==i||!e&&0!==t)return void Un(r,e,t)}else if(null!==n&&n.isSegmented()){const o=t.offset,i=n.getTextContentSize();if(n.is(r)||e&&0!==o||!e&&o!==i)return void Un(n,e,o)}!function(e,t){const n=e.anchor,r=e.focus,o=n.getNode();if(o===r.getNode()&&"text"===n.type&&"text"===r.type){const e=n.offset,i=r.offset,s=e<i,l=s?e:i,a=s?i:e,c=a-1;l!==c&&function(e){return!(Io(e)||Wn(e))}(o.getTextContent().slice(l,a))&&(t?r.set(r.key,c,r.type):n.set(n.key,c,n.type))}}(this,e)}}if(this.removeText(),e&&!t&&this.isCollapsed()&&"element"===this.anchor.type&&0===this.anchor.offset){const e=this.anchor.getNode();e.isEmpty()&&$r(e.getParent())&&null===e.getPreviousSibling()&&Bn(this,e)}}deleteLine(e){this.isCollapsed()&&this.modify("extend",e,"lineboundary"),this.isCollapsed()?this.deleteCharacter(e):this.removeText()}deleteWord(e){if(this.isCollapsed()){const t=this.anchor,n=t.getNode();if(this.forwardDeletion(t,n,e))return;this.modify("extend",e,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function Kn(e){return e instanceof Ln}function zn(e){const t=e.offset;if("text"===e.type)return t;const n=e.getNode();return t===n.getChildrenSize()?n.getTextContent().length:0}function $n(e){const t=e.getStartEndPoints();if(null===t)return[0,0];const[n,r]=t;return"element"===n.type&&"element"===r.type&&n.key===r.key&&n.offset===r.offset?[0,0]:[zn(n),zn(r)]}function Bn(e,t){for(let n=t;n;n=n.getParent()){if(Lr(n)){if(n.collapseAtStart(e))return!0;if(ui(n))break}if(n.getPreviousSibling())break}return!1}const Wn=(()=>{try{const e=new RegExp("\\p{Emoji}","u"),t=e.test.bind(e);if(t("")&&t("#")&&t(""))return t}catch(e){}return()=>!1})();function Un(e,t,n){const r=e,o=r.getTextContent().split(/(?=\s)/g),i=o.length;let s=0,l=0;for(let e=0;e<i;e++){const r=e===i-1;if(l=s,s+=o[e].length,t&&s===n||s>n||r){o.splice(e,1),r&&(l=void 0);break}}const a=o.join("").trim();""===a?r.remove():(r.setTextContent(a),r.select(l,l))}function Hn(e,n,r,o){let i,s=n;if(yi(e)){let l=!1;const a=e.childNodes,c=a.length,u=o._blockCursorElement;s===c&&(l=!0,s=c-1);let d=a[s],g=!1;if(d===u)d=a[s+1],g=!0;else if(null!==u){const t=u.parentNode;e===t&&n>Array.prototype.indexOf.call(t.children,u)&&s--}if(i=Do(d),Tn(i))s=qi(i,l?"next":"previous");else{let a=Do(e);if(null===a)return null;if(Lr(a)){const c=o.getElementByKey(a.getKey());null===c&&t(214);const u=a.getDOMSlot(c);[a,s]=u.resolveChildIndex(a,c,e,n),Lr(a)||t(215),l&&s>=a.getChildrenSize()&&(s=Math.max(0,a.getChildrenSize()-1));let d=a.getChildAtIndex(s);if(Lr(d)&&function(e,t,n){const r=e.getParent();return null===n||null===r||!r.canBeEmpty()||r!==n.getNode()}(d,0,r)){const e=l?d.getLastDescendant():d.getFirstDescendant();null===e?a=d:(d=e,a=Lr(d)?d:d.getParentOrThrow()),s=0}Tn(d)?(i=d,a=null,s=qi(d,l?"next":"previous")):d!==a&&l&&!g&&(Lr(a)||t(216),s=Math.min(a.getChildrenSize(),s+1))}else{const t=a.getIndexWithinParent();s=0===n&&Kr(a)&&Do(e)===a?t:t+1,a=a.getParentOrThrow()}if(Lr(a))return Pn(a.__key,s,"element")}}else i=Do(e);return Tn(i)?Pn(i.__key,qi(i,s,"clamp"),"text"):null}function Jn(e,t,n){const r=e.offset,o=e.getNode();if(0===r){const r=o.getPreviousSibling(),i=o.getParent();if(t){if((n||!t)&&null===r&&Lr(i)&&i.isInline()){const t=i.getPreviousSibling();Tn(t)&&e.set(t.__key,t.getTextContent().length,"text")}}else Lr(r)&&!n&&r.isInline()?e.set(r.__key,r.getChildrenSize(),"element"):Tn(r)&&e.set(r.__key,r.getTextContent().length,"text")}else if(r===o.getTextContent().length){const r=o.getNextSibling(),i=o.getParent();if(t&&Lr(r)&&r.isInline())e.set(r.__key,0,"element");else if((n||t)&&null===r&&Lr(i)&&i.isInline()&&!i.canInsertTextAfter()){const t=i.getNextSibling();Tn(t)&&e.set(t.__key,0,"text")}}}function jn(e,t,n){if("text"===e.type&&"text"===t.type){const r=e.isBefore(t),o=e.is(t);Jn(e,r,o),Jn(t,!r,o),o&&t.set(e.key,e.offset,e.type);const i=br();if(i.isComposing()&&i._compositionKey!==e.key&&Dn(n)){const r=n.anchor,o=n.focus;e.set(r.key,r.offset,r.type,!0),t.set(o.key,o.offset,o.type,!0)}}}function Yn(e,t,n,r,o,i){if(null===e||null===n||!go(o,e,n))return null;const s=Hn(e,t,Dn(i)?i.anchor:null,o);if(null===s)return null;const l=Hn(n,r,Dn(i)?i.focus:null,o);if(null===l)return null;if("element"===s.type&&"element"===l.type){const t=Do(e),r=Do(n);if(Kr(t)&&Kr(r))return null}return jn(s,l,i),[s,l]}function Vn(e){return Lr(e)&&!e.isInline()}function Gn(e,t,n,r,o,i){const s=yr(),l=new In(Pn(e,t,o),Pn(n,r,i),0,"");return l.dirty=!0,s._selection=l,l}function qn(){const e=Pn("root",0,"element"),t=Pn("root",0,"element");return new In(e,t,0,"")}function Zn(){return new Ln(new Set)}function Xn(e,t,n,r){const o=n._window;if(null===o)return null;const i=r||o.event,s=i?i.type:void 0,l="selectionchange"===s,a=!L&&(l||"beforeinput"===s||"compositionstart"===s||"compositionend"===s||"click"===s&&i&&3===i.detail||"drop"===s||void 0===s);let c,u,d,g;if(Dn(e)&&!a)return e.clone();if(null===t)return null;if(c=t.anchorNode,u=t.focusNode,d=t.anchorOffset,g=t.focusOffset,l&&Dn(e)&&!go(n,c,u))return e.clone();const f=Yn(c,d,u,g,n,e);if(null===f)return null;const[h,p]=f;return new In(h,p,Dn(e)?e.format:0,Dn(e)?e.style:"")}function Qn(){return yr()._selection}function er(){return br()._editorState._selection}function tr(e,t,n,r=1){const o=e.anchor,i=e.focus,s=o.getNode(),l=i.getNode();if(!t.is(s)&&!t.is(l))return;const a=t.__key;if(e.isCollapsed()){const t=o.offset;if(n<=t&&r>0||n<t&&r<0){const n=Math.max(0,t+r);o.set(a,n,"element"),i.set(a,n,"element"),nr(e)}}else{const s=e.isBackward(),l=s?i:o,c=l.getNode(),u=s?o:i,d=u.getNode();if(t.is(c)){const e=l.offset;(n<=e&&r>0||n<e&&r<0)&&l.set(a,Math.max(0,e+r),"element")}if(t.is(d)){const e=u.offset;(n<=e&&r>0||n<e&&r<0)&&u.set(a,Math.max(0,e+r),"element")}}nr(e)}function nr(e){const t=e.anchor,n=t.offset,r=e.focus,o=r.offset,i=t.getNode(),s=r.getNode();if(e.isCollapsed()){if(!Lr(i))return;const e=i.getChildrenSize(),o=n>=e,s=o?i.getChildAtIndex(e-1):i.getChildAtIndex(n);if(Tn(s)){let e=0;o&&(e=s.getTextContentSize()),t.set(s.__key,e,"text"),r.set(s.__key,e,"text")}}else{if(Lr(i)){const e=i.getChildrenSize(),r=n>=e,o=r?i.getChildAtIndex(e-1):i.getChildAtIndex(n);if(Tn(o)){let e=0;r&&(e=o.getTextContentSize()),t.set(o.__key,e,"text")}}if(Lr(s)){const e=s.getChildrenSize(),t=o>=e,n=t?s.getChildAtIndex(e-1):s.getChildAtIndex(o);if(Tn(n)){let e=0;t&&(e=n.getTextContentSize()),r.set(n.__key,e,"text")}}}}function rr(e,t,n,r,o){let i=null,s=0,l=null;null!==r?(i=r.__key,Tn(r)?(s=r.getTextContentSize(),l="text"):Lr(r)&&(s=r.getChildrenSize(),l="element")):null!==o&&(i=o.__key,Tn(o)?l="text":Lr(o)&&(l="element")),null!==i&&null!==l?e.set(i,s,l):(s=t.getIndexWithinParent(),-1===s&&(s=n.getChildrenSize()),e.set(n.__key,s,"element"))}function or(e,t,n,r,o){"text"===e.type?e.set(n,e.offset+(t?0:o),"text"):e.offset>r.getIndexWithinParent()&&e.set(e.key,e.offset-1,"element")}function ir(e,t,n,r,o){try{e.setBaseAndExtent(t,n,r,o)}catch(e){}}function sr(e){let n=e;e.isCollapsed()||n.removeText();const r=Qn();Dn(r)&&(n=r),Dn(n)||t(161);const o=n.anchor;let i=o.getNode(),s=o.offset;for(;!vi(i);){const e=i;if([i,s]=lr(i,s),e.is(i))break}return s}function lr(e,t){const n=e.getParent();if(!n){const e=Qr();return Ro().append(e),e.select(),[Ro(),0]}if(Tn(e)){const r=e.splitText(t);if(0===r.length)return[n,e.getIndexWithinParent()];const o=0===t?0:1;return[n,r[0].getIndexWithinParent()+o]}if(!Lr(e)||0===t)return[n,e.getIndexWithinParent()];const r=e.getChildAtIndex(t);if(r){const n=new In(Pn(e.__key,t,"element"),Pn(e.__key,t,"element"),0,""),o=e.insertNewAfter(n);o&&o.append(r,...r.getNextSiblings())}return[n,e.getIndexWithinParent()+1]}function ar(e,t,n,r,o="decorators-and-blocks"){if("move"===t&&"character"===r&&!e.isCollapsed()){const[t,r]=n===e.isBackward()?[e.focus,e.anchor]:[e.anchor,e.focus];return r.set(t.key,t.offset,t.type),!0}const i=ds(e.focus,n?"previous":"next"),s="lineboundary"===r,l="move"===t;let a=i,c="decorators-and-blocks"===o;if(!Cs(a)){for(const e of a){c=!1;const{origin:t}=e;if(!Kr(t)||t.isIsolated()||(a=e,!s||!t.isInline()))break}if(c)for(const e of ns(i).iterNodeCarets("extend"===t?"shadowRoot":"root")){if(Hi(e))e.origin.isInline()||(a=e);else{if(Lr(e.origin))continue;Kr(e.origin)&&!e.origin.isInline()&&(a=e)}break}}if(a===i)return!1;if(l&&!s&&Kr(a.origin)&&a.origin.isKeyboardSelectable()){const e=Zn();return e.add(a.origin.getKey()),Lo(e),!0}return a=Ss(a),l&&gs(e.anchor,a),gs(e.focus,a),c||!s}let cr=null,ur=null,dr=!1,gr=!1,fr=0;const hr={characterData:!0,childList:!0,subtree:!0};function pr(){return dr||null!==cr&&cr._readOnly}function mr(){dr&&t(13)}function _r(){fr>99&&t(14)}function yr(){return null===cr&&t(195,Sr()),cr}function br(){return null===ur&&t(196,Sr()),ur}function Sr(){let e=0;const t=new Set,n=no.version;if("undefined"!=typeof window)for(const r of document.querySelectorAll("[contenteditable]")){const o=po(r);if(fo(o))e++;else if(o){let e=String(o.constructor.version||"<0.17.1");e===n&&(e+=" (separately built, likely a bundler configuration issue)"),t.add(e)}}let r=` Detected on the page: ${e} compatible editor(s) with version ${n}`;return t.size&&(r+=` and incompatible editors with versions ${Array.from(t).join(", ")}`),r}function Cr(e,t,n){const r=t.__type,o=so(e,r);let i=n.get(r);void 0===i&&(i=Array.from(o.transforms),n.set(r,i));const s=i.length;for(let e=0;e<s&&(i[e](t),t.isAttached());e++);}function xr(e,t){return void 0!==e&&e.__key!==t&&e.isAttached()}function vr(e,t){if(!t)return;const n=e._updateTags;let r=t;Array.isArray(t)||(r=[t]);for(const e of r)n.add(e)}function wr(e){return kr(e,br()._nodes)}function kr(e,n){const r=e.type,o=n.get(r);void 0===o&&t(17,r);const i=o.klass;e.type!==i.getType()&&t(18,i.name);const s=i.importJSON(e),l=e.children;if(Lr(s)&&Array.isArray(l))for(let e=0;e<l.length;e++){const t=kr(l[e],n);s.append(t)}return s}function Tr(e,t,n){const r=cr,o=dr,i=ur;cr=t,dr=!0,ur=e;try{return n()}finally{cr=r,dr=o,ur=i}}function Nr(e,t){const n=e._pendingEditorState,r=e._rootElement,o=e._headless||null===r;if(null===n)return;const i=e._editorState,s=i._selection,l=n._selection,a=0!==e._dirtyType,c=cr,u=dr,d=ur,g=e._updating,f=e._observer;let p=null;if(e._pendingEditorState=null,e._editorState=n,!o&&a&&null!==f){ur=e,cr=n,dr=!1,e._updating=!0;try{const t=e._dirtyType,r=e._dirtyElements,o=e._dirtyLeaves;f.disconnect(),p=function(e,t,n,r,o,i){fe="",me="",_e=2===r,oe=n,re=n._config,ie=n._nodes,se=oe._listeners.mutation,le=o,ae=i,ce=e._nodeMap,ue=t._nodeMap,ye=t._readOnly,de=new Map(n._keyToDOMMap);const s=new Map;return ge=s,Pe("root",null),oe=void 0,ie=void 0,le=void 0,ae=void 0,ce=void 0,ue=void 0,re=void 0,de=void 0,ge=void 0,s}(i,n,e,t,r,o)}catch(t){if(t instanceof Error&&e._onError(t),gr)throw t;return to(e,null,r,n),H(e),e._dirtyType=2,gr=!0,Nr(e,i),void(gr=!1)}finally{f.observe(r,hr),e._updating=g,cr=c,dr=u,ur=d}}n._readOnly||(n._readOnly=!0);const m=e._dirtyLeaves,_=e._dirtyElements,y=e._normalizedNodes,b=e._updateTags,S=e._deferred;a&&(e._dirtyType=0,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements=new Map,e._normalizedNodes=new Set,e._updateTags=new Set),function(e,t){const n=e._decorators;let r=e._pendingDecorators||n;const o=t._nodeMap;let i;for(i in r)o.has(i)||(r===n&&(r=Oo(e)),delete r[i])}(e,n);const C=o?null:mi(ai(e));if(e._editable&&null!==C&&(a||null===l||l.dirty)&&null!==r&&!b.has(Gr)){ur=e,cr=n;try{if(null!==f&&f.disconnect(),a||null===l||l.dirty){const t=e._blockCursorElement;null!==t&&pi(t,e,r),function(e,t,n,r,o,i){const s=r.anchorNode,l=r.focusNode,a=r.anchorOffset,c=r.focusOffset,u=document.activeElement;if(o.has(Yr)&&u!==i||null!==u&&uo(u))return;if(!Dn(t))return void(null!==e&&go(n,s,l)&&r.removeAllRanges());const d=t.anchor,g=t.focus,f=d.key,h=g.key,p=ri(n,f),m=ri(n,h),_=d.offset,y=g.offset,b=t.format,S=t.style,C=t.isCollapsed();let x=p,v=m,w=!1;if("text"===d.type){x=bo(p);const e=d.getNode();w=e.getFormat()!==b||e.getStyle()!==S}else Dn(e)&&"text"===e.anchor.type&&(w=!0);var k,T,N,E,A;if("text"===g.type&&(v=bo(m)),null!==x&&null!==v&&(C&&(null===e||w||Dn(e)&&(e.format!==b||e.style!==S))&&(k=b,T=S,N=_,E=f,A=performance.now(),Wt=[k,T,N,E,A]),a!==_||c!==y||s!==x||l!==v||"Range"===r.type&&C||(null!==u&&i.contains(u)||i.focus({preventScroll:!0}),"element"===d.type))){if(ir(r,x,_,v,y),!o.has(Vr)&&t.isCollapsed()&&null!==i&&i===document.activeElement){const e=Dn(t)&&"element"===t.anchor.type?x.childNodes[_]||null:r.rangeCount>0?r.getRangeAt(0):null;if(null!==e){let t;if(e instanceof Text){const n=document.createRange();n.selectNode(e),t=n.getBoundingClientRect()}else t=e.getBoundingClientRect();!function(e,t,n){const r=ii(n),o=li(r);if(null===r||null===o)return;let{top:i,bottom:s}=t,l=0,a=0,c=n;for(;null!==c;){const t=c===r.body;if(t)l=0,a=ai(e).innerHeight;else{const e=c.getBoundingClientRect();l=e.top,a=e.bottom}let n=0;if(i<l?n=-(l-i):s>a&&(n=s-a),0!==n)if(t)o.scrollBy(0,n);else{const e=c.scrollTop;c.scrollTop+=n;const t=c.scrollTop-e;i-=t,s-=t}if(t)break;c=oi(c)}}(n,t,i)}}Lt=!0}}(s,l,e,C,b,r)}!function(e,t,n){let r=e._blockCursorElement;if(Dn(n)&&n.isCollapsed()&&"element"===n.anchor.type&&t.contains(document.activeElement)){const o=n.anchor,i=o.getNode(),s=o.offset;let l=!1,a=null;if(s===i.getChildrenSize())hi(i.getChildAtIndex(s-1))&&(l=!0);else{const t=i.getChildAtIndex(s);if(null!==t&&hi(t)){const n=t.getPreviousSibling();(null===n||hi(n))&&(l=!0,a=e.getElementByKey(t.__key))}}if(l){const n=e.getElementByKey(i.__key);return null===r&&(e._blockCursorElement=r=function(e){const t=e.theme,n=document.createElement("div");n.contentEditable="false",n.setAttribute("data-lexical-cursor","true");let r=t.blockCursor;if(void 0!==r){if("string"==typeof r){const e=h(r);r=t.blockCursor=e}void 0!==r&&n.classList.add(...r)}return n}(e._config)),t.style.caretColor="transparent",void(null===a?n.appendChild(r):n.insertBefore(r,a))}}null!==r&&pi(r,e,t)}(e,r,l)}finally{null!==f&&f.observe(r,hr),ur=d,cr=c}}null!==p&&function(e,t,n,r,o){const i=Array.from(e._listeners.mutation),s=i.length;for(let e=0;e<s;e++){const[s,l]=i[e];for(const e of l){const i=t.get(e);void 0!==i&&s(i,{dirtyLeaves:r,prevEditorState:o,updateTags:n})}}}(e,p,b,m,i),Dn(l)||null===l||null!==s&&s.is(l)||e.dispatchCommand(Ie,void 0);const x=e._pendingDecorators;null!==x&&(e._decorators=x,e._pendingDecorators=null,Er("decorator",e,!0,x)),function(e,t,n){const r=Po(t),o=Po(n);r!==o&&Er("textcontent",e,!0,o)}(e,t||i,n),Er("update",e,!0,{dirtyElements:_,dirtyLeaves:m,editorState:n,mutatedNodes:p,normalizedNodes:y,prevEditorState:t||i,tags:b}),function(e,t){if(e._deferred=[],0!==t.length){const n=e._updating;e._updating=!0;try{for(let e=0;e<t.length;e++)t[e]()}finally{e._updating=n}}}(e,S),function(e){const t=e._updates;if(0!==t.length){const n=t.shift();if(n){const[t,r]=n;Fr(e,t,r)}}}(e)}function Er(e,t,n,...r){const o=t._updating;t._updating=n;try{const n=Array.from(t._listeners[e]);for(let e=0;e<n.length;e++)n[e].apply(null,r)}finally{t._updating=o}}function Ar(e,n){const r=e._updates;let o=n||!1;for(;0!==r.length;){const n=r.shift();if(n){const[r,i]=n,s=e._pendingEditorState;let l;void 0!==i&&(l=i.onUpdate,i.skipTransforms&&(o=!0),i.discrete&&(null===s&&t(191),s._flushSync=!0),l&&e._deferred.push(l),vr(e,i.tag)),null==s?Fr(e,r,i):r()}}return o}function Fr(e,n,r){const o=e._updateTags;let i,s=!1,l=!1;void 0!==r&&(i=r.onUpdate,vr(e,r.tag),s=r.skipTransforms||!1,l=r.discrete||!1),i&&e._deferred.push(i);const a=e._editorState;let c=e._pendingEditorState,u=!1;(null===c||c._readOnly)&&(c=e._pendingEditorState=Br(c||a),u=!0),c._flushSync=l;const d=cr,g=dr,f=ur,h=e._updating;cr=c,dr=!1,e._updating=!0,ur=e;const p=e._headless||null===e.getRootElement();oo(null);try{u&&(p?null!==a._selection&&(c._selection=a._selection.clone()):c._selection=function(e,t){const n=e.getEditorState()._selection,r=mi(ai(e));return Dn(n)||null==n?Xn(n,r,e,t):n.clone()}(e,r&&r.event||null));const o=e._compositionKey;n(),s=Ar(e,s),function(e,t){const n=t.getEditorState()._selection,r=e._selection;if(Dn(r)){const e=r.anchor,t=r.focus;let o;if("text"===e.type&&(o=e.getNode(),o.selectionTransform(n,r)),"text"===t.type){const e=t.getNode();o!==e&&e.selectionTransform(n,r)}}}(c,e),0!==e._dirtyType&&(s?function(e,t){const n=t._dirtyLeaves,r=e._nodeMap;for(const e of n){const t=r.get(e);Tn(t)&&t.isAttached()&&t.isSimpleText()&&!t.isUnmergeable()&&ee(t)}}(c,e):function(e,t){const n=t._dirtyLeaves,r=t._dirtyElements,o=e._nodeMap,i=To(),s=new Map;let l=n,a=l.size,c=r,u=c.size;for(;a>0||u>0;){if(a>0){t._dirtyLeaves=new Set;for(const e of l){const r=o.get(e);Tn(r)&&r.isAttached()&&r.isSimpleText()&&!r.isUnmergeable()&&ee(r),void 0!==r&&xr(r,i)&&Cr(t,r,s),n.add(e)}if(l=t._dirtyLeaves,a=l.size,a>0){fr++;continue}}t._dirtyLeaves=new Set,t._dirtyElements=new Map,c.delete("root")&&c.set("root",!0);for(const e of c){const n=e[0],l=e[1];if(r.set(n,l),!l)continue;const a=o.get(n);void 0!==a&&xr(a,i)&&Cr(t,a,s)}l=t._dirtyLeaves,a=l.size,c=t._dirtyElements,u=c.size,fr++}t._dirtyLeaves=n,t._dirtyElements=r}(c,e),Ar(e),function(e,t,n,r){const o=e._nodeMap,i=t._nodeMap,s=[];for(const[e]of r){const t=i.get(e);void 0!==t&&(t.isAttached()||(Lr(t)&&M(t,e,o,i,s,r),o.has(e)||r.delete(e),s.push(e)))}for(const e of s)i.delete(e);for(const e of n){const t=i.get(e);void 0===t||t.isAttached()||(o.has(e)||n.delete(e),i.delete(e))}}(a,c,e._dirtyLeaves,e._dirtyElements)),o!==e._compositionKey&&(c._flushSync=!0);const i=c._selection;if(Dn(i)){const e=c._nodeMap,n=i.anchor.key,r=i.focus.key;void 0!==e.get(n)&&void 0!==e.get(r)||t(19)}else Kn(i)&&0===i._nodes.size&&(c._selection=null)}catch(t){return t instanceof Error&&e._onError(t),e._pendingEditorState=a,e._dirtyType=2,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),void Nr(e)}finally{cr=d,dr=g,ur=f,e._updating=h,fr=0}const m=0!==e._dirtyType||e._deferred.length>0||function(e,t){const n=t.getEditorState()._selection,r=e._selection;if(null!==r){if(r.dirty||!r.is(n))return!0}else if(null!==n)return!0;return!1}(c,e);m?c._flushSync?(c._flushSync=!1,Nr(e)):u&&ao((()=>{Nr(e)})):(c._flushSync=!1,u&&(o.clear(),e._deferred=[],e._pendingEditorState=null))}function Or(e,t,n){ur===e&&void 0===n?t():Fr(e,t,n)}class Pr{element;before;after;constructor(e,t,n){this.element=e,this.before=t||null,this.after=n||null}withBefore(e){return new Pr(this.element,e,this.after)}withAfter(e){return new Pr(this.element,this.before,e)}withElement(e){return this.element===e?this:new Pr(e,this.before,this.after)}insertChild(e){const n=this.before||this.getManagedLineBreak();return null!==n&&n.parentElement!==this.element&&t(222),this.element.insertBefore(e,n),this}removeChild(e){return e.parentElement!==this.element&&t(223),this.element.removeChild(e),this}replaceChild(e,n){return n.parentElement!==this.element&&t(224),this.element.replaceChild(e,n),this}getFirstChild(){const e=this.after?this.after.nextSibling:this.element.firstChild;return e===this.before||e===this.getManagedLineBreak()?null:e}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(e){if(null===e)this.removeManagedLineBreak();else{const t="decorator"===e&&(f||c||a);this.insertManagedLineBreak(t)}}removeManagedLineBreak(){const e=this.getManagedLineBreak();if(e){const t=this.element,n="IMG"===e.nodeName?e.nextSibling:null;n&&t.removeChild(n),t.removeChild(e),t.__lexicalLineBreak=void 0}}insertManagedLineBreak(e){const t=this.getManagedLineBreak();if(t){if(e===("IMG"===t.nodeName))return;this.removeManagedLineBreak()}const n=this.element,r=this.before,o=document.createElement("br");if(n.insertBefore(o,r),e){const e=document.createElement("img");e.setAttribute("data-lexical-linebreak","true"),e.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",e.alt="",n.insertBefore(e,o),n.__lexicalLineBreak=e}else n.__lexicalLineBreak=o}getFirstChildOffset(){let e=0;for(let t=this.after;null!==t;t=t.previousSibling)e++;return e}resolveChildIndex(e,t,n,r){if(n===this.element){const t=this.getFirstChildOffset();return[e,Math.min(t+e.getChildrenSize(),Math.max(t,r))]}const o=Rr(t,n);o.push(r);const i=Rr(t,this.element);let s=e.getIndexWithinParent();for(let e=0;e<i.length;e++){const t=o[e],n=i[e];if(void 0===t||t<n)break;if(t>n){s+=1;break}}return[e.getParentOrThrow(),s]}}function Rr(e,n){const r=[];let o=n;for(;o!==e&&null!==o;o=o.parentNode){let e=0;for(let t=o.previousSibling;null!==t;t=t.previousSibling)e++;r.push(e)}return o!==e&&t(225),r.reverse()}class Mr extends rn{__first;__last;__size;__format;__style;__indent;__dir;__textFormat;__textStyle;constructor(e){super(e),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(e){super.afterCloneFrom(e),this.__key===e.__key&&(this.__first=e.__first,this.__last=e.__last,this.__size=e.__size),this.__indent=e.__indent,this.__format=e.__format,this.__style=e.__style,this.__dir=e.__dir,this.__textFormat=e.__textFormat,this.__textStyle=e.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const e=this.getFormat();return F[e]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const e=[];let t=this.getFirstChild();for(;null!==t;)e.push(t),t=t.getNextSibling();return e}getChildrenKeys(){const e=[];let t=this.getFirstChild();for(;null!==t;)e.push(t.__key),t=t.getNextSibling();return e}getChildrenSize(){return this.getLatest().__size}isEmpty(){return 0===this.getChildrenSize()}isDirty(){const e=br()._dirtyElements;return null!==e&&e.has(this.__key)}isLastChild(){const e=this.getLatest(),t=this.getParentOrThrow().getLastChild();return null!==t&&t.is(e)}getAllTextNodes(){const e=[];let t=this.getFirstChild();for(;null!==t;){if(Tn(t)&&e.push(t),Lr(t)){const n=t.getAllTextNodes();e.push(...n)}t=t.getNextSibling()}return e}getFirstDescendant(){let e=this.getFirstChild();for(;Lr(e);){const t=e.getFirstChild();if(null===t)break;e=t}return e}getLastDescendant(){let e=this.getLastChild();for(;Lr(e);){const t=e.getLastChild();if(null===t)break;e=t}return e}getDescendantByIndex(e){const t=this.getChildren(),n=t.length;if(e>=n){const e=t[n-1];return Lr(e)&&e.getLastDescendant()||e||null}const r=t[e];return Lr(r)&&r.getFirstDescendant()||r||null}getFirstChild(){const e=this.getLatest().__first;return null===e?null:No(e)}getFirstChildOrThrow(){const e=this.getFirstChild();return null===e&&t(45,this.__key),e}getLastChild(){const e=this.getLatest().__last;return null===e?null:No(e)}getLastChildOrThrow(){const e=this.getLastChild();return null===e&&t(96,this.__key),e}getChildAtIndex(e){const t=this.getChildrenSize();let n,r;if(e<t/2){for(n=this.getFirstChild(),r=0;null!==n&&r<=e;){if(r===e)return n;n=n.getNextSibling(),r++}return null}for(n=this.getLastChild(),r=t-1;null!==n&&r>=e;){if(r===e)return n;n=n.getPreviousSibling(),r--}return null}getTextContent(){let e="";const t=this.getChildren(),n=t.length;for(let r=0;r<n;r++){const o=t[r];e+=o.getTextContent(),Lr(o)&&r!==n-1&&!o.isInline()&&(e+=k)}return e}getTextContentSize(){let e=0;const t=this.getChildren(),n=t.length;for(let r=0;r<n;r++){const o=t[r];e+=o.getTextContentSize(),Lr(o)&&r!==n-1&&!o.isInline()&&(e+=2)}return e}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(e){if(""!==e){const t=A[e];return!!(this.getFormat()&t)}return!1}hasTextFormat(e){const t=N[e];return!!(this.getTextFormat()&t)}getFormatFlags(e,t){return So(this.getLatest().__textFormat,e,t)}getTextStyle(){return this.getLatest().__textStyle}select(e,t){mr();const n=Qn();let r=e,o=t;const i=this.getChildrenSize();if(!this.canBeEmpty())if(0===e&&0===t){const e=this.getFirstChild();if(Tn(e)||Lr(e))return e.select(0,0)}else if(!(void 0!==e&&e!==i||void 0!==t&&t!==i)){const e=this.getLastChild();if(Tn(e)||Lr(e))return e.select()}void 0===r&&(r=i),void 0===o&&(o=i);const s=this.__key;return Dn(n)?(n.anchor.set(s,r,"element"),n.focus.set(s,o,"element"),n.dirty=!0,n):Gn(s,r,s,o,"element","element")}selectStart(){const e=this.getFirstDescendant();return e?e.selectStart():this.select()}selectEnd(){const e=this.getLastDescendant();return e?e.selectEnd():this.select()}clear(){const e=this.getWritable();return this.getChildren().forEach((e=>e.remove())),e}append(...e){return this.splice(this.getChildrenSize(),0,e)}setDirection(e){const t=this.getWritable();return t.__dir=e,t}setFormat(e){return this.getWritable().__format=""!==e?A[e]:0,this}setStyle(e){return this.getWritable().__style=e||"",this}setTextFormat(e){const t=this.getWritable();return t.__textFormat=e,t}setTextStyle(e){const t=this.getWritable();return t.__textStyle=e,t}setIndent(e){return this.getWritable().__indent=e,this}splice(e,n,r){const o=r.length,i=this.getChildrenSize(),s=this.getWritable();e+n<=i||t(226,String(e),String(n),String(i));const l=s.__key,a=[],c=[],u=this.getChildAtIndex(e+n);let d=null,g=i-n+o;if(0!==e)if(e===i)d=this.getLastChild();else{const t=this.getChildAtIndex(e);null!==t&&(d=t.getPreviousSibling())}if(n>0){let e=null===d?this.getFirstChild():d.getNextSibling();for(let r=0;r<n;r++){null===e&&t(100);const n=e.getNextSibling(),r=e.__key;vo(e.getWritable()),c.push(r),e=n}}let f=d;for(let e=0;e<o;e++){const n=r[e];null!==f&&n.is(f)&&(d=f=f.getPreviousSibling());const o=n.getWritable();o.__parent===l&&g--,vo(o);const i=n.__key;if(null===f)s.__first=i,o.__prev=null;else{const e=f.getWritable();e.__next=i,o.__prev=e.__key}n.__key===l&&t(76),o.__parent=l,a.push(i),f=n}if(e+n===i)null!==f&&(f.getWritable().__next=null,s.__last=f.__key);else if(null!==u){const e=u.getWritable();if(null!==f){const t=f.getWritable();e.__prev=f.__key,t.__next=u.__key}else e.__prev=null}if(s.__size=g,c.length){const e=Qn();if(Dn(e)){const t=new Set(c),n=new Set(a),{anchor:r,focus:o}=e;Dr(r,t,n)&&rr(r,r.getNode(),this,d,u),Dr(o,t,n)&&rr(o,o.getNode(),this,d,u),0!==g||this.canBeEmpty()||ui(this)||this.remove()}}return s}getDOMSlot(e){return new Pr(e)}exportDOM(e){const{element:t}=super.exportDOM(e);if(yi(t)){const e=this.getIndent();e>0&&(t.style.paddingInlineStart=40*e+"px");const n=this.getDirection();n&&(t.dir=n)}return{element:t}}exportJSON(){const e={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},t=this.getTextFormat(),n=this.getTextStyle();return 0!==t&&(e.textFormat=t),""!==n&&(e.textStyle=n),e}updateFromJSON(e){return super.updateFromJSON(e).setFormat(e.format).setIndent(e.indent).setDirection(e.direction).setTextFormat(e.textFormat||0).setTextStyle(e.textStyle||"")}insertNewAfter(e,t){return null}canIndent(){return!0}collapseAtStart(e){return!1}excludeFromCopy(e){return!1}canReplaceWith(e){return!0}canInsertAfter(e){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(e){return!1}extractWithChild(e,t,n){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(e,t){const n=this.getDOMSlot(e);let r=n.getFirstChild();for(let e=this.getFirstChild();e;e=e.getNextSibling()){const o=t.getElementByKey(e.getKey());null!==o&&(null==r?(n.insertChild(o),r=o):r!==o&&n.replaceChild(o,r),r=r.nextSibling)}}}function Lr(e){return e instanceof Mr}function Dr(e,t,n){let r=e.getNode();for(;r;){const e=r.__key;if(t.has(e)&&!n.has(e))return!0;r=r.getParent()}return!1}class Ir extends rn{decorate(e,t){return null}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function Kr(e){return e instanceof Ir}class zr extends Mr{__cachedText;static getType(){return"root"}static clone(){return new zr}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){t(51)}getTextContent(){const e=this.__cachedText;return!pr()&&0!==br()._dirtyType||null===e?super.getTextContent():e}remove(){t(52)}replace(e){t(53)}insertBefore(e){t(54)}insertAfter(e){t(55)}updateDOM(e,t){return!1}splice(e,n,r){for(const e of r)Lr(e)||Kr(e)||t(282);return super.splice(e,n,r)}static importJSON(e){return Ro().updateFromJSON(e)}collapseAtStart(){return!0}}function $r(e){return e instanceof zr}function Br(e){return new Hr(new Map(e._nodeMap))}function Wr(){return new Hr(new Map([["root",new zr]]))}function Ur(e){const n=e.exportJSON(),r=e.constructor;if(n.type!==r.getType()&&t(130,r.name),Lr(e)){const o=n.children;Array.isArray(o)||t(59,r.name);const i=e.getChildren();for(let e=0;e<i.length;e++){const t=Ur(i[e]);o.push(t)}}return n}class Hr{_nodeMap;_selection;_flushSync;_readOnly;constructor(e,t){this._nodeMap=e,this._selection=t||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return 1===this._nodeMap.size&&null===this._selection}read(e,t){return Tr(t&&t.editor||null,this,e)}clone(e){const t=new Hr(this._nodeMap,void 0===e?this._selection:e);return t._readOnly=!0,t}toJSON(){return Tr(null,this,(()=>({root:Ur(Ro())})))}}const Jr="historic",jr="history-merge",Yr="collaboration",Vr="skip-scroll-into-view",Gr="skip-dom-selection";class qr extends Mr{static getType(){return"artificial"}createDOM(e){return document.createElement("div")}}class Zr extends Mr{static getType(){return"paragraph"}static clone(e){return new Zr(e.__key)}createDOM(e){const t=document.createElement("p"),n=qo(e.theme,"paragraph");return void 0!==n&&t.classList.add(...n),t}updateDOM(e,t,n){return!1}static importDOM(){return{p:e=>({conversion:Xr,priority:0})}}exportDOM(e){const{element:t}=super.exportDOM(e);if(yi(t)){this.isEmpty()&&t.append(document.createElement("br"));const e=this.getFormatType();e&&(t.style.textAlign=e)}return{element:t}}static importJSON(e){return Qr().updateFromJSON(e)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(e,t){const n=Qr();n.setTextFormat(e.format),n.setTextStyle(e.style);const r=this.getDirection();return n.setDirection(r),n.setFormat(this.getFormatType()),n.setStyle(this.getStyle()),this.insertAfter(n,t),n}collapseAtStart(){const e=this.getChildren();if(0===e.length||Tn(e[0])&&""===e[0].getTextContent().trim()){if(null!==this.getNextSibling())return this.selectNext(),this.remove(),!0;if(null!==this.getPreviousSibling())return this.selectPrevious(),this.remove(),!0}return!1}}function Xr(e){const t=Qr();return e.style&&(t.setFormat(e.style.textAlign),Ai(e,t)),{node:t}}function Qr(){return gi(new Zr)}function eo(e){return e instanceof Zr}function to(e,t,n,r){const o=e._keyToDOMMap;o.clear(),e._editorState=Wr(),e._pendingEditorState=r,e._compositionKey=null,e._dirtyType=0,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),e._normalizedNodes=new Set,e._updateTags=new Set,e._updates=[],e._blockCursorElement=null;const i=e._observer;null!==i&&(i.disconnect(),e._observer=null),null!==t&&(t.textContent=""),null!==n&&(n.textContent="",o.set("root",n))}class no{static version;_headless;_parentEditor;_rootElement;_editorState;_pendingEditorState;_compositionKey;_deferred;_keyToDOMMap;_updates;_updating;_listeners;_commands;_nodes;_decorators;_pendingDecorators;_config;_dirtyType;_cloneNotNeeded;_dirtyLeaves;_dirtyElements;_normalizedNodes;_updateTags;_observer;_key;_onError;_htmlConversions;_window;_editable;_blockCursorElement;_createEditorArgs;constructor(e,t,n,r,o,i,s,l){this._createEditorArgs=l,this._parentEditor=t,this._rootElement=null,this._editorState=e,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=r,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=0,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=zo(),this._onError=o,this._htmlConversions=i,this._editable=s,this._headless=null!==t&&t._headless,this._window=null,this._blockCursorElement=null}isComposing(){return null!=this._compositionKey}registerUpdateListener(e){const t=this._listeners.update;return t.add(e),()=>{t.delete(e)}}registerEditableListener(e){const t=this._listeners.editable;return t.add(e),()=>{t.delete(e)}}registerDecoratorListener(e){const t=this._listeners.decorator;return t.add(e),()=>{t.delete(e)}}registerTextContentListener(e){const t=this._listeners.textcontent;return t.add(e),()=>{t.delete(e)}}registerRootListener(e){const t=this._listeners.root;return e(this._rootElement,null),t.add(e),()=>{e(null,this._rootElement),t.delete(e)}}registerCommand(e,n,r){void 0===r&&t(35);const o=this._commands;o.has(e)||o.set(e,[new Set,new Set,new Set,new Set,new Set]);const i=o.get(e);void 0===i&&t(36,String(e));const s=i[r];return s.add(n),()=>{s.delete(n),i.every((e=>0===e.size))&&o.delete(e)}}registerMutationListener(e,t,n){const r=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(e)).klass,o=this._listeners.mutation;let i=o.get(t);void 0===i&&(i=new Set,o.set(t,i)),i.add(r);const s=n&&n.skipInitialization;return void 0!==s&&s||this.initializeMutationListener(t,r),()=>{i.delete(r),0===i.size&&o.delete(t)}}getRegisteredNode(e){const n=this._nodes.get(e.getType());return void 0===n&&t(37,e.name),n}resolveRegisteredNodeAfterReplacements(e){for(;e.replaceWithKlass;)e=this.getRegisteredNode(e.replaceWithKlass);return e}initializeMutationListener(e,t){const n=this._editorState,r=Ni(n).get(t.getType());if(!r)return;const o=new Map;for(const e of r.keys())o.set(e,"created");o.size>0&&e(o,{dirtyLeaves:new Set,prevEditorState:n,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(e,t){const n=this.getRegisteredNode(e);return n.transforms.add(t),n}registerNodeTransform(e,t){const n=this.registerNodeTransformToKlass(e,t),r=[n],o=n.replaceWithKlass;if(null!=o){const e=this.registerNodeTransformToKlass(o,t);r.push(e)}return function(e,t){const n=Ni(e.getEditorState()),r=[];for(const e of t){const t=n.get(e);t&&r.push(t)}0!==r.length&&e.update((()=>{for(const e of r)for(const t of e.keys()){const e=No(t);e&&e.markDirty()}}),null===e._pendingEditorState?{tag:jr}:void 0)}(this,r.map((e=>e.klass.getType()))),()=>{r.forEach((e=>e.transforms.delete(t)))}}hasNode(e){return this._nodes.has(e.getType())}hasNodes(e){return e.every(this.hasNode.bind(this))}dispatchCommand(e,t){return ti(this,e,t)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(e){const t=this._rootElement;if(e!==t){const n=qo(this._config.theme,"root"),r=this._pendingEditorState||this._editorState;if(this._rootElement=e,to(this,t,e,r),null!==t&&(this._config.disableEvents||tn(t),null!=n&&t.classList.remove(...n)),null!==e){const t=li(e),r=e.style;r.userSelect="text",r.whiteSpace="pre-wrap",r.wordBreak="break-word",e.setAttribute("data-lexical-editor","true"),this._window=t,this._dirtyType=2,H(this),this._updateTags.add(jr),Nr(this),this._config.disableEvents||function(e,t){const n=e.ownerDocument,r=Mt.get(n);(void 0===r||r<1)&&n.addEventListener("selectionchange",Xt),Mt.set(n,(r||0)+1),e.__lexicalEditor=t;const o=qt(e);for(let n=0;n<At.length;n++){const[r,i]=At[n],s="function"==typeof i?e=>{en(e)||(Qt(e),(t.isEditable()||"click"===r)&&i(e,t))}:e=>{if(en(e))return;Qt(e);const n=t.isEditable();switch(r){case"cut":return n&&ti(t,bt,e);case"copy":return ti(t,yt,e);case"paste":return n&&ti(t,He,e);case"dragstart":return n&&ti(t,pt,e);case"dragover":return n&&ti(t,mt,e);case"dragend":return n&&ti(t,_t,e);case"focus":return n&&ti(t,kt,e);case"blur":return n&&ti(t,Tt,e);case"drop":return n&&ti(t,ft,e)}};e.addEventListener(r,s),o.push((()=>{e.removeEventListener(r,s)}))}}(e,this),null!=n&&e.classList.add(...n)}else this._window=null,this._updateTags.add(jr),Nr(this);Er("root",this,!1,e,t)}}getElementByKey(e){return this._keyToDOMMap.get(e)||null}getEditorState(){return this._editorState}setEditorState(e,n){e.isEmpty()&&t(38);let r=e;r._readOnly&&(r=Br(e),r._selection=e._selection?e._selection.clone():null),U(this);const o=this._pendingEditorState,i=this._updateTags,s=void 0!==n?n.tag:null;null===o||o.isEmpty()||(null!=s&&i.add(s),Nr(this)),this._pendingEditorState=r,this._dirtyType=2,this._dirtyElements.set("root",!1),this._compositionKey=null,null!=s&&i.add(s),this._updating||Nr(this)}parseEditorState(e,t){return function(e,t,n){const r=Wr(),o=cr,i=dr,s=ur,l=t._dirtyElements,a=t._dirtyLeaves,c=t._cloneNotNeeded,u=t._dirtyType;t._dirtyElements=new Map,t._dirtyLeaves=new Set,t._cloneNotNeeded=new Set,t._dirtyType=0,cr=r,dr=!1,ur=t,oo(null);try{const o=t._nodes;kr(e.root,o),n&&n(),r._readOnly=!0}catch(e){e instanceof Error&&t._onError(e)}finally{t._dirtyElements=l,t._dirtyLeaves=a,t._cloneNotNeeded=c,t._dirtyType=u,cr=o,dr=i,ur=s}return r}("string"==typeof e?JSON.parse(e):e,this,t)}read(e){return Nr(this),this.getEditorState().read(e,{editor:this})}update(e,t){!function(e,t,n){e._updating?e._updates.push([t,n]):Fr(e,t,n)}(this,e,t)}focus(e,t={}){const n=this._rootElement;null!==n&&(n.setAttribute("autocapitalize","off"),Or(this,(()=>{const r=Qn(),o=Ro();null!==r?r.dirty||Lo(r.clone()):0!==o.getChildrenSize()&&("rootStart"===t.defaultSelection?o.selectStart():o.selectEnd()),function(e){mr(),br()._updateTags.add(e)}("focus"),function(e){mr(),br()._deferred.push(e)}((()=>{n.removeAttribute("autocapitalize"),e&&e()}))})),null===this._pendingEditorState&&n.removeAttribute("autocapitalize"))}blur(){const e=this._rootElement;null!==e&&e.blur();const t=mi(this._window);null!==t&&t.removeAllRanges()}isEditable(){return this._editable}setEditable(e){this._editable!==e&&(this._editable=e,Er("editable",this,!0,e))}toJSON(){return{editorState:this._editorState.toJSON()}}}no.version="0.36.1+prod.esm";let ro=null;function oo(e){ro=e}let io=1;function so(e,n){const r=lo(e,n);return void 0===r&&t(30,n),r}function lo(e,t){return e._nodes.get(t)}const ao="function"==typeof queueMicrotask?queueMicrotask:e=>{Promise.resolve().then(e)};function co(e){return Kr(Fo(e))}function uo(e){const t=document.activeElement;if(!yi(t))return!1;const n=t.nodeName;return Kr(Fo(e))&&("INPUT"===n||"TEXTAREA"===n||"true"===t.contentEditable&&null==po(t))}function go(e,t,n){const r=e.getRootElement();try{return null!==r&&r.contains(t)&&r.contains(n)&&null!==t&&!uo(t)&&ho(t)===e}catch(e){return!1}}function fo(e){return e instanceof no}function ho(e){let t=e;for(;null!=t;){const e=po(t);if(fo(e))return e;t=oi(t)}return null}function po(e){return e?e.__lexicalEditor:null}function mo(e){return Fn(e)||e.isToken()}function _o(e){return mo(e)||e.isSegmented()}function yo(e){return bi(e)&&3===e.nodeType}function bo(e){let t=e;for(;null!=t;){if(yo(t))return t;t=t.firstChild}return null}function So(e,t,n){const r=N[t];if(null!==n&&(e&r)==(n&r))return e;let o=e^r;return"subscript"===t?o&=-65:"superscript"===t?o&=-33:"lowercase"===t?(o&=-513,o&=-1025):"uppercase"===t?(o&=-257,o&=-1025):"capitalize"===t&&(o&=-257,o&=-513),o}function Co(e){return Tn(e)||an(e)||Kr(e)}function xo(e,t){const n=function(){const e=ro;return ro=null,e}();if(null!=(t=t||n&&n.__key))return void(e.__key=t);mr(),_r();const r=br(),o=yr(),i=""+io++;o._nodeMap.set(i,e),Lr(e)?r._dirtyElements.set(i,!0):r._dirtyLeaves.add(i),r._cloneNotNeeded.add(i),r._dirtyType=1,e.__key=i}function vo(e){const t=e.getParent();if(null!==t){const n=e.getWritable(),r=t.getWritable(),o=e.getPreviousSibling(),i=e.getNextSibling(),s=null!==i?i.__key:null,l=null!==o?o.__key:null,a=null!==o?o.getWritable():null,c=null!==i?i.getWritable():null;null===o&&(r.__first=s),null===i&&(r.__last=l),null!==a&&(a.__next=s),null!==c&&(c.__prev=l),n.__prev=null,n.__next=null,n.__parent=null,r.__size--}}function wo(e){_r();const t=e.getLatest(),n=t.__parent,r=yr(),o=br(),i=r._nodeMap,s=o._dirtyElements;null!==n&&function(e,t,n){let r=e;for(;null!==r;){if(n.has(r))return;const e=t.get(r);if(void 0===e)break;n.set(r,!1),r=e.__parent}}(n,i,s);const l=t.__key;o._dirtyType=1,Lr(e)?s.set(l,!0):o._dirtyLeaves.add(l)}function ko(e){mr();const t=br(),n=t._compositionKey;if(e!==n){if(t._compositionKey=e,null!==n){const e=No(n);null!==e&&e.getWritable()}if(null!==e){const t=No(e);null!==t&&t.getWritable()}}}function To(){return pr()?null:br()._compositionKey}function No(e,t){const n=(t||yr())._nodeMap.get(e);return void 0===n?null:n}function Eo(e,t){const n=Ao(e,br());return void 0!==n?No(n,t):null}function Ao(e,t){return e[`__lexicalKey_${t._key}`]}function Fo(e,t){let n=e;for(;null!=n;){const e=Eo(n,t);if(null!==e)return e;n=oi(n)}return null}function Oo(e){const t=e._decorators,n=Object.assign({},t);return e._pendingDecorators=n,n}function Po(e){return e.read((()=>Ro().getTextContent()))}function Ro(){return Mo(yr())}function Mo(e){return e._nodeMap.get("root")}function Lo(e){mr();const t=yr();null!==e&&(e.dirty=!0,e.setCachedNodes(null)),t._selection=e}function Do(e){const t=br(),n=function(e,t){let n=e;for(;null!=n;){const e=Ao(n,t);if(void 0!==e)return e;n=oi(n)}return null}(e,t);return null===n?e===t.getRootElement()?No("root"):null:No(n)}function Io(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(e)}function Ko(e){const t=[];let n=e;for(;null!==n;)t.push(n),n=n._parentEditor;return t}function zo(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function $o(e){return yo(e)?e.nodeValue:null}function Bo(e,t,n){const r=mi(ai(t));if(null===r)return;const o=r.anchorNode;let{anchorOffset:i,focusOffset:s}=r;if(null!==o){let t=$o(o);const r=Fo(o);if(null!==t&&Tn(r)){if(t===w&&n){const e=n.length;t=n,i=e,s=e}null!==t&&Wo(r,t,i,s,e)}}}function Wo(e,t,n,r,o){let i=e;if(i.isAttached()&&(o||!i.isDirty())){const s=i.isComposing();let l=t;(s||o)&&t[t.length-1]===w&&(l=t.slice(0,-1));const u=i.getTextContent();if(o||l!==u){if(""===l){if(ko(null),a||c||f)i.remove();else{const e=br();setTimeout((()=>{e.update((()=>{i.isAttached()&&i.remove()}))}),20)}return}const t=i.getParent(),o=er(),u=i.getTextContentSize(),d=To(),g=i.getKey();if(i.isToken()||null!==d&&g===d&&!s||Dn(o)&&(null!==t&&!t.canInsertTextBefore()&&0===o.anchor.offset||o.anchor.key===e.__key&&0===o.anchor.offset&&!i.canInsertTextBefore()&&!s||o.focus.key===e.__key&&o.focus.offset===u&&!i.canInsertTextAfter()&&!s))return void i.markDirty();const h=Qn();if(!Dn(h)||null===n||null===r)return void Uo(i,l,h);if(h.setTextNodeRange(i,n,i,r),i.isSegmented()){const e=kn(i.getTextContent());i.replace(e),i=e}Uo(i,l,h)}}}function Uo(e,t,n){if(e.setTextContent(t),Dn(n)){const t=e.getKey();for(const r of["anchor","focus"]){const o=n[r];"text"===o.type&&o.key===t&&(o.offset=qi(e,o.offset,"clamp"))}}}function Ho(e,t,n){const r=t[n]||!1;return"any"===r||r===e[n]}function Jo(e,t,n){return function(e,t){return Ho(e,t,"altKey")&&Ho(e,t,"ctrlKey")&&Ho(e,t,"shiftKey")&&Ho(e,t,"metaKey")}(e,n)&&e.key.toLowerCase()===t.toLowerCase()}const jo={ctrlKey:!i,metaKey:i},Yo={altKey:i,ctrlKey:!i};function Vo(e){return"Backspace"===e.key}function Go(e){return Jo(e,"a",jo)}function qo(e,t){void 0===e.__lexicalClassNameCache&&(e.__lexicalClassNameCache={});const n=e.__lexicalClassNameCache,r=n[t];if(void 0!==r)return r;const o=e[t];if("string"==typeof o){const e=h(o);return n[t]=e,e}return o}function Zo(e,n,r,o,i){if(0===r.size)return;const s=o.__type,l=o.__key,a=n.get(s);void 0===a&&t(33,s);const c=a.klass;let u=e.get(c);void 0===u&&(u=new Map,e.set(c,u));const d=u.get(l),g="destroyed"===d&&"created"===i;(void 0===d||g)&&u.set(l,g?"updated":i)}function Xo(e,t,n){const r=e.getParent();let o=n,i=e;return null!==r&&(t&&0===n?(o=i.getIndexWithinParent(),i=r):t||n!==i.getChildrenSize()||(o=i.getIndexWithinParent()+1,i=r)),i.getChildAtIndex(t?o-1:o)}function Qo(e,t){const n=e.offset;if("element"===e.type)return Xo(e.getNode(),t,n);{const r=e.getNode();if(t&&0===n||!t&&n===r.getTextContentSize()){const e=t?r.getPreviousSibling():r.getNextSibling();return null===e?Xo(r.getParentOrThrow(),t,r.getIndexWithinParent()+(t?0:1)):e}}return null}function ei(e){const t=ai(e).event,n=t&&t.inputType;return"insertFromPaste"===n||"insertFromPasteAsQuotation"===n}function ti(e,t,n){return function(e,t,n){const r=Ko(e);for(let o=4;o>=0;o--)for(let i=0;i<r.length;i++){const s=r[i],l=s._commands.get(t);if(void 0!==l){const t=l[o];if(void 0!==t){const r=Array.from(t),o=r.length;let i=!1;if(Or(s,(()=>{for(let t=0;t<o;t++)if(r[t](n,e))return void(i=!0)})),i)return i}}}return!1}(e,t,n)}function ni(e){return!$r(e)&&!e.isLastChild()&&!e.isInline()}function ri(e,n){const r=e._keyToDOMMap.get(n);return void 0===r&&t(75,n),r}function oi(e){const t=e.assignedSlot||e.parentElement;return Si(t)?t.host:t}function ii(e){return function(e){return bi(e)&&9===e.nodeType}(e)?e:yi(e)?e.ownerDocument:null}function si(e,t){let n=e.getParent();for(;null!==n;){if(n.is(t))return!0;n=n.getParent()}return!1}function li(e){const t=ii(e);return t?t.defaultView:null}function ai(e){const n=e._window;return null===n&&t(78),n}function ci(e){return Lr(e)&&e.isInline()||Kr(e)&&e.isInline()}function ui(e){return $r(e)||Lr(e)&&e.isShadowRoot()}function di(e){const t=e.constructor.clone(e);return xo(t,null),t.afterCloneFrom(e),t}function gi(e){const n=br(),r=e.getType(),o=lo(n,r);void 0===o&&t(200,e.constructor.name,r);const{replace:i,replaceWithKlass:s}=o;if(null!==i){const n=i(e),o=n.constructor;return null!==s?n instanceof s||t(201,s.name,s.getType(),o.name,o.getType(),e.constructor.name,r):n instanceof e.constructor&&o!==e.constructor||t(202,o.name,o.getType(),e.constructor.name,r),n.__key===e.__key&&t(203,e.constructor.name,r,o.name,o.getType()),n}return e}function fi(e,n){!$r(e.getParent())||Lr(n)||Kr(n)||t(99)}function hi(e){return(Kr(e)||Lr(e)&&!e.canBeEmpty())&&!e.isInline()}function pi(e,t,n){n.style.removeProperty("caret-color"),t._blockCursorElement=null;const r=e.parentElement;null!==r&&r.removeChild(e)}function mi(e){return r?(e||window).getSelection():null}function _i(e){return yi(e)&&"A"===e.tagName}function yi(e){return bi(e)&&1===e.nodeType}function bi(e){return"object"==typeof e&&null!==e&&"nodeType"in e&&"number"==typeof e.nodeType}function Si(e){return bi(e)&&11===e.nodeType}function Ci(e){const t=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|mark|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return null!==e.nodeName.match(t)}function xi(e){const t=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return null!==e.nodeName.match(t)}function vi(e){if(Kr(e)&&!e.isInline())return!0;if(!Lr(e)||ui(e))return!1;const t=e.getFirstChild(),n=null===t||an(t)||Tn(t)||t.isInline();return!e.isInline()&&!1!==e.canBeEmpty()&&n}function wi(){return br()}const ki=new WeakMap,Ti=new Map;function Ni(e){if(!e._readOnly&&e.isEmpty())return Ti;e._readOnly||t(192);let n=ki.get(e);return n||(n=function(e){const t=new Map;for(const[n,r]of e._nodeMap){const e=r.__type;let o=t.get(e);o||(o=new Map,t.set(e,o)),o.set(n,r)}return t}(e),ki.set(e,n)),n}function Ei(e){const t=e.constructor.clone(e);return t.afterCloneFrom(e),t}function Ai(e,t){const n=parseInt(e.style.paddingInlineStart,10)||0,r=Math.round(n/40);t.setIndent(r)}function Fi(e){return!0===e.__lexicalUnmanaged}function Oi(e,t){return function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(e,t)&&e[t]!==rn[t]}function Pi(e){const n=R in e.prototype?e.prototype[R]():void 0,r=function(e){if(!(e===rn||e.prototype instanceof rn)){let n="<unknown>",r="<unknown>";try{n=e.getType()}catch(e){}try{no.version&&(r=JSON.parse(no.version))}catch(e){}t(290,e.name,n,r)}return e===Ir||e===Mr||e===rn}(e),o=!r&&Oi(e,"getType")?e.getType():void 0;let i,s=o;if(n)if(o)i=n[o];else for(const[e,t]of Object.entries(n))s=e,i=t;if(!r&&s&&(Oi(e,"getType")||(e.getType=()=>s),Oi(e,"clone")||(e.clone=t=>(oo(t),new e)),Oi(e,"importJSON")||(e.importJSON=i&&i.$importJSON||(t=>(new e).updateFromJSON(t))),!Oi(e,"importDOM")&&i)){const{importDOM:t}=i;t&&(e.importDOM=()=>t)}return{ownNodeConfig:i,ownNodeType:s}}const Ri=(e,t)=>{let n=e;for(;null!=n&&!$r(n);){if(t(n))return n;n=n.getParent()}return null},Mi={next:"previous",previous:"next"};class Li{origin;constructor(e){this.origin=e}[Symbol.iterator](){return is({hasNext:Ui,initial:this.getAdjacentCaret(),map:e=>e,step:e=>e.getAdjacentCaret()})}getAdjacentCaret(){return Vi(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return Vi(this.origin,this.direction)}remove(){const e=this.getNodeAtCaret();return e&&e.remove(),this}replaceOrInsert(e,t){const n=this.getNodeAtCaret();return e.is(this.origin)||e.is(n)||(null===n?this.insert(e):n.replace(e,t)),this}splice(e,n,r="next"){const o=r===this.direction?n:Array.from(n).reverse();let i=this;const s=this.getParentAtCaret(),l=new Map;for(let t=i.getAdjacentCaret();null!==t&&l.size<e;t=t.getAdjacentCaret()){const e=t.origin.getWritable();l.set(e.getKey(),e)}for(const e of o){if(l.size>0){const n=i.getNodeAtCaret();if(n)if(l.delete(n.getKey()),l.delete(e.getKey()),n.is(e)||i.origin.is(e));else{const t=e.getParent();t&&t.is(s)&&e.remove(),n.replace(e)}else null===n&&t(263,Array.from(l).join(" "))}else i.insert(e);i=Vi(e,this.direction)}for(const e of l.values())e.remove();return this}}class Di extends Li{type="child";getLatest(){const e=this.origin.getLatest();return e===this.origin?this:Xi(e,this.direction)}getParentCaret(e="root"){return Vi(zi(this.getParentAtCaret(),e),this.direction)}getFlipped(){const e=Ki(this.direction);return Vi(this.getNodeAtCaret(),e)||Xi(this.origin,e)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(e){return e instanceof Di&&this.direction===e.direction&&this.origin.is(e.origin)}isSamePointCaret(e){return this.isSameNodeCaret(e)}}const Ii={root:$r,shadowRoot:ui};function Ki(e){return Mi[e]}function zi(e,t="root"){return Ii[t](e)?null:e}class $i extends Li{type="sibling";getLatest(){const e=this.origin.getLatest();return e===this.origin?this:Vi(e,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return Lr(this.origin)?Xi(this.origin,this.direction):null}getParentCaret(e="root"){return Vi(zi(this.getParentAtCaret(),e),this.direction)}getFlipped(){const e=Ki(this.direction);return Vi(this.getNodeAtCaret(),e)||Xi(this.origin.getParentOrThrow(),e)}isSamePointCaret(e){return e instanceof $i&&this.direction===e.direction&&this.origin.is(e.origin)}isSameNodeCaret(e){return(e instanceof $i||e instanceof Bi)&&this.direction===e.direction&&this.origin.is(e.origin)}}class Bi extends Li{type="text";offset;constructor(e,t){super(e),this.offset=t}getLatest(){const e=this.origin.getLatest();return e===this.origin?this:Gi(e,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(e="root"){return Vi(zi(this.getParentAtCaret(),e),this.direction)}getFlipped(){return Gi(this.origin,Ki(this.direction),this.offset)}isSamePointCaret(e){return e instanceof Bi&&this.direction===e.direction&&this.origin.is(e.origin)&&this.offset===e.offset}isSameNodeCaret(e){return(e instanceof $i||e instanceof Bi)&&this.direction===e.direction&&this.origin.is(e.origin)}getSiblingCaret(){return Vi(this.origin,this.direction)}}function Wi(e){return e instanceof Bi}function Ui(e){return e instanceof $i}function Hi(e){return e instanceof Di}const Ji={next:class extends Bi{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends Bi{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},ji={next:class extends $i{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends $i{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},Yi={next:class extends Di{direction="next";getNodeAtCaret(){return this.origin.getFirstChild()}insert(e){return this.origin.splice(0,0,[e]),this}},previous:class extends Di{direction="previous";getNodeAtCaret(){return this.origin.getLastChild()}insert(e){return this.origin.splice(this.origin.getChildrenSize(),0,[e]),this}}};function Vi(e,t){return e?new ji[t](e):null}function Gi(e,t,n){return e?new Ji[t](e,qi(e,n)):null}function qi(e,t,r="error"){const o=e.getTextContentSize();let i="next"===t?o:"previous"===t?0:t;return(i<0||i>o)&&("clamp"!==r&&n(284,String(t),String(o),e.getKey()),i=i<0?0:o),i}function Zi(e,t){return new ts(e,t)}function Xi(e,t){return Lr(e)?new Yi[t](e):null}function Qi(e){return e&&function(e){return e&&e.getChildCaret()||e}(e.getAdjacentCaret())}class es{type="node-caret-range";direction;anchor;focus;constructor(e,t,n){this.anchor=e,this.focus=t,this.direction=n}getLatest(){const e=this.anchor.getLatest(),t=this.focus.getLatest();return e===this.anchor&&t===this.focus?this:new es(e,t,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const e=e=>{const t=this[e].getLatest();return Wi(t)?function(e,t){const{direction:n,origin:r}=e;return Zi(e,qi(r,"focus"===t?Ki(n):n)-e.offset)}(t,e):null},t=e("anchor"),n=e("focus");if(t&&n){const{caret:e}=t,{caret:r}=n;if(e.isSameNodeCaret(r))return[Zi(e,r.offset-e.offset),null]}return[t,n]}iterNodeCarets(e="root"){const t=Wi(this.anchor)?this.anchor.getSiblingCaret():this.anchor.getLatest(),n=this.focus.getLatest(),r=Wi(n),o=t=>t.isSameNodeCaret(n)?null:Qi(t)||t.getParentCaret(e);return is({hasNext:e=>null!==e&&!(r&&n.isSameNodeCaret(e)),initial:t.isSameNodeCaret(n)?null:o(t),map:e=>e,step:o})}[Symbol.iterator](){return this.iterNodeCarets("root")}}class ts{type="slice";caret;distance;constructor(e,t){this.caret=e,this.distance=t}getSliceIndices(){const{distance:e,caret:{offset:t}}=this,n=t+e;return n<t?[n,t]:[t,n]}getTextContent(){const[e,t]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(e,t)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:e,direction:t}}=this,[n,r]=this.getSliceIndices(),o=e.getTextContent();return Gi(e.setTextContent(o.slice(0,n)+o.slice(r)),t,n)}}function ns(e){return os(e,Vi(Ro(),e.direction))}function rs(e){return os(e,e)}function os(e,n){return e.direction!==n.direction&&t(265),new es(e,n,e.direction)}function is(e){const{initial:t,hasNext:n,step:r,map:o}=e;let i=t;return{[Symbol.iterator](){return this},next(){if(!n(i))return{done:!0,value:void 0};const e={done:!1,value:o(i)};return i=r(i),e}}}function ss(e,n){const r=us(e.origin,n.origin);switch(null===r&&t(275,e.origin.getKey(),n.origin.getKey()),r.type){case"same":{const t="text"===e.type,r="text"===n.type;return t&&r?function(e,t){return Math.sign(e-t)}(e.offset,n.offset):e.type===n.type?0:t?-1:r?1:"child"===e.type?-1:1}case"ancestor":return"child"===e.type?-1:1;case"descendant":return"child"===n.type?1:-1;case"branch":return ls(r)}}function ls(e){const{a:t,b:n}=e,r=t.__key,o=n.__key;let i=t,s=n;for(;i&&s;i=i.getNextSibling(),s=s.getNextSibling()){if(i.__key===o)return-1;if(s.__key===r)return 1}return null===i?1:-1}function as(e,t){return t.is(e)}function cs(e){return Lr(e)?[e.getLatest(),null]:[e.getParent(),e.getLatest()]}function us(e,n){if(e.is(n))return{commonAncestor:e,type:"same"};const r=new Map;for(let[t,n]=cs(e);t;n=t,t=t.getParent())r.set(t,n);for(let[o,i]=cs(n);o;i=o,o=o.getParent()){const s=r.get(o);if(void 0!==s)return null===s?(as(e,o)||t(276),{commonAncestor:o,type:"ancestor"}):null===i?(as(n,o)||t(277),{commonAncestor:o,type:"descendant"}):((Lr(s)||as(e,s))&&(Lr(i)||as(n,i))&&o.is(s.getParent())&&o.is(i.getParent())||t(278),{a:s,b:i,commonAncestor:o,type:"branch"})}return null}function ds(e,n){const{type:r,key:o,offset:i}=e,s=function(e){const n=No(e);return null===n&&t(63,e),n}(e.key);return"text"===r?(Tn(s)||t(266,s.getType(),o),Gi(s,n,i)):(Lr(s)||t(267,s.getType(),o),function(e,t,n){let r=Xi(e,"next");for(let e=0;e<t;e++){const e=r.getAdjacentCaret();if(null===e)break;r=e}return xs(r,n)}(s,e.offset,n))}function gs(e,n){const{origin:r,direction:o}=n,i="next"===o;Wi(n)?e.set(r.getKey(),n.offset,"text"):Ui(n)?Tn(r)?e.set(r.getKey(),qi(r,o),"text"):e.set(r.getParentOrThrow().getKey(),r.getIndexWithinParent()+(i?1:0),"element"):(Hi(n)&&Lr(r)||t(268),e.set(r.getKey(),i?0:r.getChildrenSize(),"element"))}function fs(e){const t=Qn(),n=Dn(t)?t:qn();return hs(n,e),Lo(n),n}function hs(e,t){gs(e.anchor,t.anchor),gs(e.focus,t.focus)}function ps(e){const{anchor:t,focus:n}=e,r=ds(t,"next"),o=ds(n,"next"),i=ss(r,o)<=0?"next":"previous";return os(xs(r,i),xs(o,i))}function ms(e){const{direction:t,origin:n}=e,r=Vi(n,Ki(t)).getNodeAtCaret();return r?Vi(r,t):Xi(n.getParentOrThrow(),t)}function _s(e,t="root"){const n=[e];for(let r=Hi(e)?e.getParentCaret(t):e.getSiblingCaret();null!==r;r=r.getParentCaret(t))n.push(ms(r));return n}function ys(e){return!!e&&e.origin.isAttached()}function bs(e,n="removeEmptySlices"){if(e.isCollapsed())return e;const r="root",o="next";let i=n;const s=vs(e,o),l=_s(s.anchor,r),a=_s(s.focus.getFlipped(),r),c=new Set,u=[];for(const e of s.iterNodeCarets(r))if(Hi(e))c.add(e.origin.getKey());else if(Ui(e)){const{origin:t}=e;Lr(t)&&!c.has(t.getKey())||u.push(t)}for(const e of u)e.remove();for(const e of s.getTextSlices()){if(!e)continue;const{origin:t}=e.caret,n=t.getTextContentSize(),r=ms(Vi(t,o)),s=t.getMode();if(Math.abs(e.distance)===n&&"removeEmptySlices"===i||"token"===s&&0!==e.distance)r.remove();else if(0!==e.distance){i="removeEmptySlices";let t=e.removeTextSlice();const n=e.caret.origin;if("segmented"===s){const e=t.origin,n=kn(e.getTextContent()).setStyle(e.getStyle()).setFormat(e.getFormat());r.replaceOrInsert(n),t=Gi(n,o,t.offset)}n.is(l[0].origin)&&(l[0]=t),n.is(a[0].origin)&&(a[0]=t.getFlipped())}}let d,g;for(const e of l)if(ys(e)){d=Ss(e);break}for(const e of a)if(ys(e)){g=Ss(e);break}const f=function(e,t,n){if(!e||!t)return null;const r=e.getParentAtCaret(),o=t.getParentAtCaret();if(!r||!o)return null;const i=r.getParents().reverse();i.push(r);const s=o.getParents().reverse();s.push(o);const l=Math.min(i.length,s.length);let a;for(a=0;a<l&&i[a]===s[a];a++);const c=(e,t)=>{let n;for(let r=a;r<e.length;r++){const o=e[r];if(ui(o))return;!n&&t(o)&&(n=o)}return n},u=c(i,vi),d=u&&c(s,(e=>n.has(e.getKey())&&vi(e)));return u&&d?[u,d]:null}(d,g,c);if(f){const[e,t]=f;Xi(e,"previous").splice(0,t.getChildren()),t.remove()}const h=[d,g,...l,...a].find(ys);if(h)return rs(xs(Ss(h),e.direction));t(269,JSON.stringify(l.map((e=>e.origin.__key))))}function Ss(e){const t=function(e){let t=e;for(;Hi(t);){const e=Qi(t);if(!Hi(e))break;t=e}return t}(e.getLatest()),{direction:n}=t;if(Tn(t.origin))return Wi(t)?t:Gi(t.origin,n,n);const r=t.getAdjacentCaret();return Ui(r)&&Tn(r.origin)?Gi(r.origin,n,Ki(n)):t}function Cs(e){return Wi(e)&&e.offset!==qi(e.origin,e.direction)}function xs(e,t){return e.direction===t?e:e.getFlipped()}function vs(e,t){return e.direction===t?e:os(xs(e.focus,t),xs(e.anchor,t))}function ws(e){const{origin:n,offset:r,direction:o}=e;if(r===qi(n,o))return e.getSiblingCaret();if(r===qi(n,Ki(o)))return ms(e.getSiblingCaret());const[i]=n.splitText(r);return Tn(i)||t(281),xs(Vi(i,"next"),o)}function ks(e,t){return!0}function Ts(e,{$copyElementNode:t=di,$splitTextPointCaretNext:n=ws,rootMode:r="shadowRoot",$shouldSplit:o=ks}={}){if(Wi(e))return n(e);const i=e.getParentCaret(r);if(i){const{origin:n}=i;if(Hi(e)&&(!n.canBeEmpty()||!o(n,"first")))return ms(i);const r=function(e){const t=[];for(let n=e.getAdjacentCaret();n;n=n.getAdjacentCaret())t.push(n.origin);return t}(e);(r.length>0||n.canBeEmpty()&&o(n,"last"))&&i.insert(t(n).splice(0,0,r))}return i}const Ns=new Map;function Es(e){const t={};if(!e)return t;const n=e.split(";");for(const e of n)if(""!==e){const[n,r]=e.split(/:([^]+)/);n&&r&&(t[n.trim()]=r.trim())}return t}function As(e){let t=Ns.get(e);return void 0===t&&(t=Es(e),Ns.set(e,t)),t}function Fs(e){const t=wi().getElementByKey(e.getKey());if(null===t)return null;const n=t.ownerDocument.defaultView;return null===n?null:n.getComputedStyle(t)}function Os(e){return Fs($r(e)?e:e.getParentOrThrow())}function Ps(e){const t=Os(e);return null!==t&&"rtl"===t.direction}function Rs(e,t){const n=e.getStartEndPoints();if(t.isSelected(e)&&!_o(t)&&null!==n){const[r,o]=n,i=e.isBackward(),s=r.getNode(),l=o.getNode(),a=t.is(s),c=t.is(l);if(a||c){const[n,r]=$n(e),o=s.is(l),a=t.is(i?l:s),c=t.is(i?s:l);let u,d=0;o?(d=n>r?r:n,u=n>r?n:r):a?(d=i?r:n,u=void 0):c&&(d=0,u=i?n:r),t.__text=t.__text.slice(d,u)}}return t}function Ms(e){const t=e.getStyle(),n=Es(t);Ns.set(t,n)}function Ls(e,t){const n=e.getFormatType(),r=e.getIndent();n!==t.getFormatType()&&t.setFormat(n),r!==t.getIndent()&&t.setIndent(r)}function Ds(e){const t=Is(e);return null!==t&&"vertical-rl"===t.writingMode}function Is(e){const t=e.anchor.getNode();return Lr(t)?Fs(t):Os(t)}function Ks(e,t){let n=Ds(e)?!t:t;zs(e)&&(n=!n);const r=ds(e.focus,n?"previous":"next");if(Cs(r))return!1;for(const e of ns(r)){if(Hi(e))return!e.origin.isInline();if(!Lr(e.origin)){if(Kr(e.origin))return!0;break}}return!1}function zs(e){const t=Is(e);return null!==t&&"rtl"===t.direction}function $s(e,t,n){const r=zs(e);let o;o=Ds(e)||r?!n:n,function(e,t,n,r){e.modify(t?"extend":"move",n,r)}(e,t,o,"character")}function Bs(e,...t){const n=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",e);for(const e of t)r.append("v",e);throw n.search=r.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const Ws="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,Us=Ws&&"documentMode"in document?document.documentMode:null;function Hs(...e){const t=[];for(const n of e)if(n&&"string"==typeof n)for(const[e]of n.matchAll(/\S+/g))t.push(e);return t}function Js(...e){return()=>{for(let t=e.length-1;t>=0;t--)e[t]();e.length=0}}function js(e,...t){const n=Hs(...t);n.length>0&&e.classList.add(...n)}function Ys(e,...t){const n=Hs(...t);n.length>0&&e.classList.remove(...n)}function Vs(e){return e?e.getAdjacentCaret():null}function Gs(e,t){let n=e;for(;null!=n;){if(n instanceof t)return n;n=n.getParent()}return null}function qs(e,t){return null!==e&&Object.getPrototypeOf(e).constructor.name===t.name}function Zs(e,t){const n=[],r=Array.from(e).reverse();for(let e=r.pop();void 0!==e;e=r.pop())if(t(e))n.push(e);else if(Lr(e))for(const t of Xs(e))r.push(t);return n}function Xs(e){return function(e){return is({hasNext:Ui,initial:e.getAdjacentCaret(),map:e=>e.origin.getLatest(),step:e=>e.getAdjacentCaret()})}(Xi(e,"previous"))}Ws&&"InputEvent"in window&&!Us&&new window.InputEvent("input");var Qs={},el={get exports(){return Qs},set exports(e){Qs=e}};function tl(e,t){for(const n of e.childNodes){if(yi(n)&&n.tagName===t)return!0;tl(n,t)}return!1}!function(t){var n=function(e){var t=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,n=0,r={},o={manual:e.Prism&&e.Prism.manual,disableWorkerMessageHandler:e.Prism&&e.Prism.disableWorkerMessageHandler,util:{encode:function e(t){return t instanceof i?new i(t.type,e(t.content),t.alias):Array.isArray(t)?t.map(e):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).slice(8,-1)},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++n}),e.__id},clone:function e(t,n){var r,i;switch(n=n||{},o.util.type(t)){case"Object":if(i=o.util.objId(t),n[i])return n[i];for(var s in r={},n[i]=r,t)t.hasOwnProperty(s)&&(r[s]=e(t[s],n));return r;case"Array":return i=o.util.objId(t),n[i]?n[i]:(r=[],n[i]=r,t.forEach((function(t,o){r[o]=e(t,n)})),r);default:return t}},getLanguage:function(e){for(;e;){var n=t.exec(e.className);if(n)return n[1].toLowerCase();e=e.parentElement}return"none"},setLanguage:function(e,n){e.className=e.className.replace(RegExp(t,"gi"),""),e.classList.add("language-"+n)},currentScript:function(){if("undefined"==typeof document)return null;if(document.currentScript&&"SCRIPT"===document.currentScript.tagName)return document.currentScript;try{throw new Error}catch(r){var e=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(r.stack)||[])[1];if(e){var t=document.getElementsByTagName("script");for(var n in t)if(t[n].src==e)return t[n]}return null}},isActive:function(e,t,n){for(var r="no-"+t;e;){var o=e.classList;if(o.contains(t))return!0;if(o.contains(r))return!1;e=e.parentElement}return!!n}},languages:{plain:r,plaintext:r,text:r,txt:r,extend:function(e,t){var n=o.util.clone(o.languages[e]);for(var r in t)n[r]=t[r];return n},insertBefore:function(e,t,n,r){var i=(r=r||o.languages)[e],s={};for(var l in i)if(i.hasOwnProperty(l)){if(l==t)for(var a in n)n.hasOwnProperty(a)&&(s[a]=n[a]);n.hasOwnProperty(l)||(s[l]=i[l])}var c=r[e];return r[e]=s,o.languages.DFS(o.languages,(function(t,n){n===c&&t!=e&&(this[t]=s)})),s},DFS:function e(t,n,r,i){i=i||{};var s=o.util.objId;for(var l in t)if(t.hasOwnProperty(l)){n.call(t,l,t[l],r||l);var a=t[l],c=o.util.type(a);"Object"!==c||i[s(a)]?"Array"!==c||i[s(a)]||(i[s(a)]=!0,e(a,n,l,i)):(i[s(a)]=!0,e(a,n,null,i))}}},plugins:{},highlightAll:function(e,t){o.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,n){var r={callback:n,container:e,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",r),r.elements=Array.prototype.slice.apply(r.container.querySelectorAll(r.selector)),o.hooks.run("before-all-elements-highlight",r);for(var i,s=0;i=r.elements[s++];)o.highlightElement(i,!0===t,r.callback)},highlightElement:function(t,n,r){var i=o.util.getLanguage(t),s=o.languages[i];o.util.setLanguage(t,i);var l=t.parentElement;l&&"pre"===l.nodeName.toLowerCase()&&o.util.setLanguage(l,i);var a={element:t,language:i,grammar:s,code:t.textContent};function c(e){a.highlightedCode=e,o.hooks.run("before-insert",a),a.element.innerHTML=a.highlightedCode,o.hooks.run("after-highlight",a),o.hooks.run("complete",a),r&&r.call(a.element)}if(o.hooks.run("before-sanity-check",a),(l=a.element.parentElement)&&"pre"===l.nodeName.toLowerCase()&&!l.hasAttribute("tabindex")&&l.setAttribute("tabindex","0"),!a.code)return o.hooks.run("complete",a),void(r&&r.call(a.element));if(o.hooks.run("before-highlight",a),a.grammar)if(n&&e.Worker){var u=new Worker(o.filename);u.onmessage=function(e){c(e.data)},u.postMessage(JSON.stringify({language:a.language,code:a.code,immediateClose:!0}))}else c(o.highlight(a.code,a.grammar,a.language));else c(o.util.encode(a.code))},highlight:function(e,t,n){var r={code:e,grammar:t,language:n};if(o.hooks.run("before-tokenize",r),!r.grammar)throw new Error('The language "'+r.language+'" has no grammar.');return r.tokens=o.tokenize(r.code,r.grammar),o.hooks.run("after-tokenize",r),i.stringify(o.util.encode(r.tokens),r.language)},tokenize:function(e,t){var n=t.rest;if(n){for(var r in n)t[r]=n[r];delete t.rest}var o=new a;return c(o,o.head,e),l(e,o,t,o.head,0),function(e){var t=[],n=e.head.next;for(;n!==e.tail;)t.push(n.value),n=n.next;return t}(o)},hooks:{all:{},add:function(e,t){var n=o.hooks.all;n[e]=n[e]||[],n[e].push(t)},run:function(e,t){var n=o.hooks.all[e];if(n&&n.length)for(var r,i=0;r=n[i++];)r(t)}},Token:i};function i(e,t,n,r){this.type=e,this.content=t,this.alias=n,this.length=0|(r||"").length}function s(e,t,n,r){e.lastIndex=t;var o=e.exec(n);if(o&&r&&o[1]){var i=o[1].length;o.index+=i,o[0]=o[0].slice(i)}return o}function l(e,t,n,r,a,d){for(var g in n)if(n.hasOwnProperty(g)&&n[g]){var f=n[g];f=Array.isArray(f)?f:[f];for(var h=0;h<f.length;++h){if(d&&d.cause==g+","+h)return;var p=f[h],m=p.inside,_=!!p.lookbehind,y=!!p.greedy,b=p.alias;if(y&&!p.pattern.global){var S=p.pattern.toString().match(/[imsuy]*$/)[0];p.pattern=RegExp(p.pattern.source,S+"g")}for(var C=p.pattern||p,x=r.next,v=a;x!==t.tail&&!(d&&v>=d.reach);v+=x.value.length,x=x.next){var w=x.value;if(t.length>e.length)return;if(!(w instanceof i)){var k,T=1;if(y){if(!(k=s(C,v,e,_))||k.index>=e.length)break;var N=k.index,E=k.index+k[0].length,A=v;for(A+=x.value.length;N>=A;)A+=(x=x.next).value.length;if(v=A-=x.value.length,x.value instanceof i)continue;for(var F=x;F!==t.tail&&(A<E||"string"==typeof F.value);F=F.next)T++,A+=F.value.length;T--,w=e.slice(v,A),k.index-=v}else if(!(k=s(C,0,w,_)))continue;N=k.index;var O=k[0],P=w.slice(0,N),R=w.slice(N+O.length),M=v+w.length;d&&M>d.reach&&(d.reach=M);var L=x.prev;if(P&&(L=c(t,L,P),v+=P.length),u(t,L,T),x=c(t,L,new i(g,m?o.tokenize(O,m):O,b,O)),R&&c(t,x,R),T>1){var D={cause:g+","+h,reach:M};l(e,t,n,x.prev,v,D),d&&D.reach>d.reach&&(d.reach=D.reach)}}}}}}function a(){var e={value:null,prev:null,next:null},t={value:null,prev:e,next:null};e.next=t,this.head=e,this.tail=t,this.length=0}function c(e,t,n){var r=t.next,o={value:n,prev:t,next:r};return t.next=o,r.prev=o,e.length++,o}function u(e,t,n){for(var r=t.next,o=0;o<n&&r!==e.tail;o++)r=r.next;t.next=r,r.prev=t,e.length-=o}if(e.Prism=o,i.stringify=function e(t,n){if("string"==typeof t)return t;if(Array.isArray(t)){var r="";return t.forEach((function(t){r+=e(t,n)})),r}var i={type:t.type,content:e(t.content,n),tag:"span",classes:["token",t.type],attributes:{},language:n},s=t.alias;s&&(Array.isArray(s)?Array.prototype.push.apply(i.classes,s):i.classes.push(s)),o.hooks.run("wrap",i);var l="";for(var a in i.attributes)l+=" "+a+'="'+(i.attributes[a]||"").replace(/"/g,"&quot;")+'"';return"<"+i.tag+' class="'+i.classes.join(" ")+'"'+l+">"+i.content+"</"+i.tag+">"},!e.document)return e.addEventListener?(o.disableWorkerMessageHandler||e.addEventListener("message",(function(t){var n=JSON.parse(t.data),r=n.language,i=n.code,s=n.immediateClose;e.postMessage(o.highlight(i,o.languages[r],r)),s&&e.close()}),!1),o):o;var d=o.util.currentScript();function g(){o.manual||o.highlightAll()}if(d&&(o.filename=d.src,d.hasAttribute("data-manual")&&(o.manual=!0)),!o.manual){var f=document.readyState;"loading"===f||"interactive"===f&&d&&d.defer?document.addEventListener("DOMContentLoaded",g):window.requestAnimationFrame?window.requestAnimationFrame(g):window.setTimeout(g,16)}return o}("undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{});t.exports&&(t.exports=n),void 0!==e&&(e.Prism=n),n.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},n.languages.markup.tag.inside["attr-value"].inside.entity=n.languages.markup.entity,n.languages.markup.doctype.inside["internal-subset"].inside=n.languages.markup,n.hooks.add("wrap",(function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))})),Object.defineProperty(n.languages.markup.tag,"addInlined",{value:function(e,t){var r={};r["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:n.languages[t]},r.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:r}};o["language-"+t]={pattern:/[\s\S]+/,inside:n.languages[t]};var i={};i[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,(function(){return e})),"i"),lookbehind:!0,greedy:!0,inside:o},n.languages.insertBefore("markup","cdata",i)}}),Object.defineProperty(n.languages.markup.tag,"addAttribute",{value:function(e,t){n.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:n.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.xml=n.languages.extend("markup",{}),n.languages.ssml=n.languages.xml,n.languages.atom=n.languages.xml,n.languages.rss=n.languages.xml,function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|"+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var n=e.languages.markup;n&&(n.tag.addInlined("style","css"),n.tag.addAttribute("style","css"))}(n),n.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend("clike",{"class-name":[n.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),n.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,n.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:n.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:n.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:n.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:n.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:n.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),n.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:n.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),n.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),n.languages.markup&&(n.languages.markup.tag.addInlined("script","javascript"),n.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),n.languages.js=n.languages.javascript,function(){if(void 0!==n&&"undefined"!=typeof document){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var e={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},t="data-src-status",r="loading",o="loaded",i="pre[data-src]:not(["+t+'="'+o+'"]):not(['+t+'="'+r+'"])';n.hooks.add("before-highlightall",(function(e){e.selector+=", "+i})),n.hooks.add("before-sanity-check",(function(s){var l=s.element;if(l.matches(i)){s.code="",l.setAttribute(t,r);var a=l.appendChild(document.createElement("CODE"));a.textContent="Loading";var c=l.getAttribute("data-src"),u=s.language;if("none"===u){var d=(/\.(\w+)$/.exec(c)||[,"none"])[1];u=e[d]||d}n.util.setLanguage(a,u),n.util.setLanguage(l,u);var g=n.plugins.autoloader;g&&g.loadLanguages(u),function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.onreadystatechange=function(){4==r.readyState&&(r.status<400&&r.responseText?t(r.responseText):r.status>=400?n(" Error "+r.status+" while fetching file: "+r.statusText):n(" Error: File does not exist or is empty"))},r.send(null)}(c,(function(e){l.setAttribute(t,o);var r=function(e){var t=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(e||"");if(t){var n=Number(t[1]),r=t[2],o=t[3];return r?o?[n,Number(o)]:[n,void 0]:[n,n]}}(l.getAttribute("data-range"));if(r){var i=e.split(/\r\n?|\n/g),s=r[0],c=null==r[1]?i.length:r[1];s<0&&(s+=i.length),s=Math.max(0,Math.min(s-1,i.length)),c<0&&(c+=i.length),c=Math.max(0,Math.min(c,i.length)),e=i.slice(s,c).join("\n"),l.hasAttribute("data-start")||l.setAttribute("data-start",String(s+1))}a.textContent=e,n.highlightElement(a)}),(function(e){l.setAttribute(t,"failed"),a.textContent=e}))}})),n.plugins.fileHighlight={highlight:function(e){for(var t,r=(e||document).querySelectorAll(i),o=0;t=r[o++];)n.highlightElement(t)}};var s=!1;n.fileHighlight=function(){s||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),s=!0),n.plugins.fileHighlight.highlight.apply(this,arguments)}}}()}(el),Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),Prism.languages.js=Prism.languages.javascript,Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity,Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup,Prism.hooks.add("wrap",(function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))})),Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(e,t){var n={};n["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[t]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var r={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};r["language-"+t]={pattern:/[\s\S]+/,inside:Prism.languages[t]};var o={};o[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,(function(){return e})),"i"),lookbehind:!0,greedy:!0,inside:r},Prism.languages.insertBefore("markup","cdata",o)}}),Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(e,t){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:Prism.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),Prism.languages.html=Prism.languages.markup,Prism.languages.mathml=Prism.languages.markup,Prism.languages.svg=Prism.languages.markup,Prism.languages.xml=Prism.languages.extend("markup",{}),Prism.languages.ssml=Prism.languages.xml,Prism.languages.atom=Prism.languages.xml,Prism.languages.rss=Prism.languages.xml,function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function n(e){return e=e.replace(/<inner>/g,(function(){return t})),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+e+")")}var r=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,o=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,(function(){return r})),i=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+o+i+"(?:"+o+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+o+i+")(?:"+o+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(r),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+o+")"+i+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+o+"$"),inside:{"table-header":{pattern:RegExp(r),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:n(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:n(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:n(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:n(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach((function(t){["url","bold","italic","strike","code-snippet"].forEach((function(n){t!==n&&(e.languages.markdown[t].inside.content.inside[n]=e.languages.markdown[n])}))})),e.hooks.add("after-tokenize",(function(e){"markdown"!==e.language&&"md"!==e.language||function e(t){if(t&&"string"!=typeof t)for(var n=0,r=t.length;n<r;n++){var o=t[n];if("code"===o.type){var i=o.content[1],s=o.content[3];if(i&&s&&"code-language"===i.type&&"code-block"===s.type&&"string"==typeof i.content){var l=i.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp"),a="language-"+(l=(/[a-z][\w-]*/i.exec(l)||[""])[0].toLowerCase());s.alias?"string"==typeof s.alias?s.alias=[s.alias,a]:s.alias.push(a):s.alias=[a]}}else e(o.content)}}(e.tokens)})),e.hooks.add("wrap",(function(t){if("code-block"===t.type){for(var n="",r=0,o=t.classes.length;r<o;r++){var i=t.classes[r],c=/language-(.+)/.exec(i);if(c){n=c[1];break}}var u,d,g=e.languages[n];if(g)t.content=e.highlight((u=t.content,d=(d=u.replace(s,"")).replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,(function(e,t){var n;if("#"===(t=t.toLowerCase())[0])return n="x"===t[1]?parseInt(t.slice(2),16):Number(t.slice(1)),a(n);var r=l[t];return r||e})),d),g,n);else if(n&&"none"!==n&&e.plugins.autoloader){var f="md-"+(new Date).valueOf()+"-"+Math.floor(1e16*Math.random());t.attributes.id=f,e.plugins.autoloader.loadLanguages(n,(function(){var t=document.getElementById(f);t&&(t.innerHTML=e.highlight(t.textContent,e.languages[n],n))}))}}}));var s=RegExp(e.languages.markup.tag.pattern.source,"gi"),l={amp:"&",lt:"<",gt:">",quot:'"'},a=String.fromCodePoint||String.fromCharCode;e.languages.md=e.languages.markdown}(Prism),Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/}),Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}}),Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}}),Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/}),delete Prism.languages.c.boolean,function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|"+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var n=e.languages.markup;n&&(n.tag.addInlined("style","css"),n.tag.addAttribute("style","css"))}(Prism),Prism.languages.objectivec=Prism.languages.extend("c",{string:{pattern:/@?"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},keyword:/\b(?:asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|in|inline|int|long|register|return|self|short|signed|sizeof|static|struct|super|switch|typedef|typeof|union|unsigned|void|volatile|while)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/}),delete Prism.languages.objectivec["class-name"],Prism.languages.objc=Prism.languages.objectivec,Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/},function(e){var t=e.languages.powershell={comment:[{pattern:/(^|[^`])<#[\s\S]*?#>/,lookbehind:!0},{pattern:/(^|[^`])#.*/,lookbehind:!0}],string:[{pattern:/"(?:`[\s\S]|[^`"])*"/,greedy:!0,inside:null},{pattern:/'(?:[^']|'')*'/,greedy:!0}],namespace:/\[[a-z](?:\[(?:\[[^\]]*\]|[^\[\]])*\]|[^\[\]])*\]/i,boolean:/\$(?:false|true)\b/i,variable:/\$\w+\b/,function:[/\b(?:Add|Approve|Assert|Backup|Block|Checkpoint|Clear|Close|Compare|Complete|Compress|Confirm|Connect|Convert|ConvertFrom|ConvertTo|Copy|Debug|Deny|Disable|Disconnect|Dismount|Edit|Enable|Enter|Exit|Expand|Export|Find|ForEach|Format|Get|Grant|Group|Hide|Import|Initialize|Install|Invoke|Join|Limit|Lock|Measure|Merge|Move|New|Open|Optimize|Out|Ping|Pop|Protect|Publish|Push|Read|Receive|Redo|Register|Remove|Rename|Repair|Request|Reset|Resize|Resolve|Restart|Restore|Resume|Revoke|Save|Search|Select|Send|Set|Show|Skip|Sort|Split|Start|Step|Stop|Submit|Suspend|Switch|Sync|Tee|Test|Trace|Unblock|Undo|Uninstall|Unlock|Unprotect|Unpublish|Unregister|Update|Use|Wait|Watch|Where|Write)-[a-z]+\b/i,/\b(?:ac|cat|chdir|clc|cli|clp|clv|compare|copy|cp|cpi|cpp|cvpa|dbp|del|diff|dir|ebp|echo|epal|epcsv|epsn|erase|fc|fl|ft|fw|gal|gbp|gc|gci|gcs|gdr|gi|gl|gm|gp|gps|group|gsv|gu|gv|gwmi|iex|ii|ipal|ipcsv|ipsn|irm|iwmi|iwr|kill|lp|ls|measure|mi|mount|move|mp|mv|nal|ndr|ni|nv|ogv|popd|ps|pushd|pwd|rbp|rd|rdr|ren|ri|rm|rmdir|rni|rnp|rp|rv|rvpa|rwmi|sal|saps|sasv|sbp|sc|select|set|shcm|si|sl|sleep|sls|sort|sp|spps|spsv|start|sv|swmi|tee|trcm|type|write)\b/i],keyword:/\b(?:Begin|Break|Catch|Class|Continue|Data|Define|Do|DynamicParam|Else|ElseIf|End|Exit|Filter|Finally|For|ForEach|From|Function|If|InlineScript|Parallel|Param|Process|Return|Sequence|Switch|Throw|Trap|Try|Until|Using|Var|While|Workflow)\b/i,operator:{pattern:/(^|\W)(?:!|-(?:b?(?:and|x?or)|as|(?:Not)?(?:Contains|In|Like|Match)|eq|ge|gt|is(?:Not)?|Join|le|lt|ne|not|Replace|sh[lr])\b|-[-=]?|\+[+=]?|[*\/%]=?)/i,lookbehind:!0},punctuation:/[|{}[\];(),.]/};t.string[0].inside={function:{pattern:/(^|[^`])\$\((?:\$\([^\r\n()]*\)|(?!\$\()[^\r\n)])*\)/,lookbehind:!0,inside:t},boolean:t.boolean,variable:t.variable}}(Prism),Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python,function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,n=0;n<2;n++)t=t.replace(/<self>/g,(function(){return t}));t=t.replace(/<self>/g,(function(){return/[^\s\S]/.source})),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string}(Prism),Prism.languages.swift={comment:{pattern:/(^|[^\\:])(?:\/\/.*|\/\*(?:[^/*]|\/(?!\*)|\*(?!\/)|\/\*(?:[^*]|\*(?!\/))*\*\/)*\*\/)/,lookbehind:!0,greedy:!0},"string-literal":[{pattern:RegExp(/(^|[^"#])/.source+"(?:"+/"(?:\\(?:\((?:[^()]|\([^()]*\))*\)|\r\n|[^(])|[^\\\r\n"])*"/.source+"|"+/"""(?:\\(?:\((?:[^()]|\([^()]*\))*\)|[^(])|[^\\"]|"(?!""))*"""/.source+")"+/(?!["#])/.source),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\\($/,alias:"punctuation"},punctuation:/\\(?=[\r\n])/,string:/[\s\S]+/}},{pattern:RegExp(/(^|[^"#])(#+)/.source+"(?:"+/"(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|\r\n|[^#])|[^\\\r\n])*?"/.source+"|"+/"""(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|[^#])|[^\\])*?"""/.source+")\\2"),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\#+\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\#+\($/,alias:"punctuation"},string:/[\s\S]+/}}],directive:{pattern:RegExp(/#/.source+"(?:"+/(?:elseif|if)\b/.source+"(?:[ \t]*"+/(?:![ \t]*)?(?:\b\w+\b(?:[ \t]*\((?:[^()]|\([^()]*\))*\))?|\((?:[^()]|\([^()]*\))*\))(?:[ \t]*(?:&&|\|\|))?/.source+")+|"+/(?:else|endif)\b/.source+")"),alias:"property",inside:{"directive-name":/^#\w+/,boolean:/\b(?:false|true)\b/,number:/\b\d+(?:\.\d+)*\b/,operator:/!|&&|\|\||[<>]=?/,punctuation:/[(),]/}},literal:{pattern:/#(?:colorLiteral|column|dsohandle|file(?:ID|Literal|Path)?|function|imageLiteral|line)\b/,alias:"constant"},"other-directive":{pattern:/#\w+\b/,alias:"property"},attribute:{pattern:/@\w+/,alias:"atrule"},"function-definition":{pattern:/(\bfunc\s+)\w+/,lookbehind:!0,alias:"function"},label:{pattern:/\b(break|continue)\s+\w+|\b[a-zA-Z_]\w*(?=\s*:\s*(?:for|repeat|while)\b)/,lookbehind:!0,alias:"important"},keyword:/\b(?:Any|Protocol|Self|Type|actor|as|assignment|associatedtype|associativity|async|await|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic|else|enum|extension|fallthrough|fileprivate|final|for|func|get|guard|higherThan|if|import|in|indirect|infix|init|inout|internal|is|isolated|lazy|left|let|lowerThan|mutating|none|nonisolated|nonmutating|open|operator|optional|override|postfix|precedencegroup|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|set|some|static|struct|subscript|super|switch|throw|throws|try|typealias|unowned|unsafe|var|weak|where|while|willSet)\b/,boolean:/\b(?:false|true)\b/,nil:{pattern:/\bnil\b/,alias:"constant"},"short-argument":/\$\d+\b/,omit:{pattern:/\b_\b/,alias:"keyword"},number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,"class-name":/\b[A-Z](?:[A-Z_\d]*[a-z]\w*)?\b/,function:/\b[a-z_]\w*(?=\s*\()/i,constant:/\b(?:[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,operator:/[-+*/%=!<>&|^~?]+|\.[.\-+*/%=!<>&|^~?]+/,punctuation:/[{}[\]();,.:\\]/},Prism.languages.swift["string-literal"].forEach((function(e){e.inside.interpolation.inside=Prism.languages.swift})),function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript}(Prism),function(e){var t=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,n=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,r={pattern:RegExp(/(^|[^\w.])/.source+n+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};e.languages.java=e.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[r,{pattern:RegExp(/(^|[^\w.])/.source+n+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:r.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+n+/[A-Z]\w*\b/.source),lookbehind:!0,inside:r.inside}],keyword:t,function:[e.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),e.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),e.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":r,keyword:t,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+n+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:r.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+n+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:r.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,(function(){return t.source}))),lookbehind:!0,inside:{punctuation:/\./}}})}(Prism),function(e){var t=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,n=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,(function(){return t.source}));e.languages.cpp=e.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,(function(){return t.source}))),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:t,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),e.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,(function(){return n}))+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),e.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e.languages.cpp}}}}),e.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),e.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:e.languages.extend("cpp",{})}}),e.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},e.languages.cpp["base-clause"])}(Prism);const nl="data-language",rl="data-highlight-language",ol="data-theme";let il=class e extends Mr{__language;__theme;__isSyntaxHighlightSupported;static getType(){return"code"}static clone(t){return new e(t.__language,t.__key)}constructor(e,t){super(t),this.__language=e||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(e){super.afterCloneFrom(e),this.__language=e.__language,this.__theme=e.__theme,this.__isSyntaxHighlightSupported=e.__isSyntaxHighlightSupported}createDOM(e){const t=document.createElement("code");js(t,e.theme.code),t.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(t.setAttribute(nl,n),this.getIsSyntaxHighlightSupported()&&t.setAttribute(rl,n));const r=this.getTheme();r&&t.setAttribute(ol,r);const o=this.getStyle();return o&&t.setAttribute("style",o),t}updateDOM(e,t,n){const r=this.__language,o=e.__language;r?r!==o&&t.setAttribute(nl,r):o&&t.removeAttribute(nl);const i=this.__isSyntaxHighlightSupported;e.__isSyntaxHighlightSupported&&o?i&&r?r!==o&&t.setAttribute(rl,r):t.removeAttribute(rl):i&&r&&t.setAttribute(rl,r);const s=this.__theme,l=e.__theme;s?s!==l&&t.setAttribute(ol,s):l&&t.removeAttribute(ol);const a=this.__style,c=e.__style;return a?a!==c&&t.setAttribute("style",a):c&&t.removeAttribute("style"),!1}exportDOM(e){const t=document.createElement("pre");js(t,e._config.theme.code),t.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(t.setAttribute(nl,n),this.getIsSyntaxHighlightSupported()&&t.setAttribute(rl,n));const r=this.getTheme();r&&t.setAttribute(ol,r);const o=this.getStyle();return o&&t.setAttribute("style",o),{element:t}}static importDOM(){return{code:e=>null!=e.textContent&&(/\r?\n/.test(e.textContent)||tl(e,"BR"))?{conversion:al,priority:1}:null,div:()=>({conversion:cl,priority:1}),pre:()=>({conversion:al,priority:0}),table:e=>fl(e)?{conversion:ul,priority:3}:null,td:e=>{const t=e,n=t.closest("table");return t.classList.contains("js-file-line")||n&&fl(n)?{conversion:dl,priority:3}:null},tr:e=>{const t=e.closest("table");return t&&fl(t)?{conversion:dl,priority:3}:null}}}static importJSON(e){return sl().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setLanguage(e.language).setTheme(e.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(e,t=!0){const n=this.getChildren(),r=n.length;if(r>=2&&"\n"===n[r-1].getTextContent()&&"\n"===n[r-2].getTextContent()&&e.isCollapsed()&&e.anchor.key===this.__key&&e.anchor.offset===r){n[r-1].remove(),n[r-2].remove();const e=Qr();return this.insertAfter(e,t),e}const{anchor:o,focus:i}=e,s=(o.isBefore(i)?o:i).getNode();if(Tn(s)){let e=function(e){return function(e,t){let n=e;for(let r=Vi(e,t);r&&(_l(r.origin)||Fn(r.origin));r=Vs(r))n=r.origin;return n}(e,"previous")}(s);const t=[];for(;;)if(Fn(e))t.push(An()),e=e.getNextSibling();else{if(!_l(e))break;{let n=0;const r=e.getTextContent(),o=e.getTextContentSize();for(;n<o&&" "===r[n];)n++;if(0!==n&&t.push(ml(" ".repeat(n))),n!==o)break;e=e.getNextSibling()}}const n=s.splitText(o.offset)[0],r=0===o.offset?0:1,i=n.getIndexWithinParent()+r,l=s.getParentOrThrow(),a=[ln(),...t];l.splice(i,0,a);const c=t[t.length-1];c?c.select():0===o.offset?n.selectPrevious():n.getNextSibling().selectNext(0,0)}if(ll(s)){const{offset:t}=e.anchor;s.splice(t,0,[ln()]),s.select(t+1,t+1)}return null}canIndent(){return!1}collapseAtStart(){const e=Qr();return this.getChildren().forEach((t=>e.append(t))),this.replace(e),!0}setLanguage(e){const t=this.getWritable();return t.__language=e||void 0,t}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(e){const t=this.getWritable();return t.__isSyntaxHighlightSupported=e,t}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(e){const t=this.getWritable();return t.__theme=e||void 0,t}getTheme(){return this.getLatest().__theme}};function sl(e,t){return function(e){const t=wi();return mr(),new(t.resolveRegisteredNodeAfterReplacements(t.getRegisteredNode(e)).klass)}(il).setLanguage(e).setTheme(t)}function ll(e){return e instanceof il}function al(e){return{node:sl(e.getAttribute(nl))}}function cl(e){const t=e,n=gl(t);return n||function(e){let t=e.parentElement;for(;null!==t;){if(gl(t))return!0;t=t.parentElement}return!1}(t)?{node:n?sl():null}:{node:null}}function ul(){return{node:sl()}}function dl(){return{node:null}}function gl(e){return null!==e.style.fontFamily.match("monospace")}function fl(e){return e.classList.contains("js-file-line-container")}let hl=class e extends mn{__highlightType;constructor(e="",t,n){super(e,n),this.__highlightType=t}static getType(){return"code-highlight"}static clone(t){return new e(t.__text,t.__highlightType||void 0,t.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(e){const t=this.getWritable();return t.__highlightType=e||void 0,t}canHaveFormat(){return!1}createDOM(e){const t=super.createDOM(e);return js(t,pl(e.theme,this.__highlightType)),t}updateDOM(e,t,n){const r=super.updateDOM(e,t,n),o=pl(n.theme,e.__highlightType),i=pl(n.theme,this.__highlightType);return o!==i&&(o&&Ys(t,o),i&&js(t,i)),r}static importJSON(e){return ml().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHighlightType(e.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(e){return this}isParentRequired(){return!0}createParentElementNode(){return sl()}};function pl(e,t){return t&&e&&e.codeHighlight&&e.codeHighlight[t]}function ml(e="",t){return gi(new hl(e,t))}function _l(e){return e instanceof hl}function yl(e,...t){const n=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",e);for(const e of t)r.append("v",e);throw n.search=r.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function bl(e){let t=e.getParent();Ul(t)||yl(40);let n=t;for(;null!==n;)n=n.getParent(),Ul(n)&&(t=n);return t}function Sl(e){let t=[];const n=e.getChildren().filter(Dl);for(let e=0;e<n.length;e++){const r=n[e],o=r.getFirstChild();Ul(o)?t=t.concat(Sl(o)):t.push(r)}return t}function Cl(e){return Dl(e)&&Ul(e.getFirstChild())}function xl(e){return Ll().append(e)}function vl(e,t){return Dl(e)&&(0===t.length||1===t.length&&e.is(t[0])&&0===e.getChildrenSize())}function wl(e){const t=Qn();if(null!==t){let n=t.getNodes();if(Dn(t)){const r=t.getStartEndPoints();null===r&&yl(143);const[o]=r,i=o.getNode(),s=i.getParent();if(ui(i)){const e=i.getFirstChild();if(e)n=e.selectStart().getNodes();else{const e=Qr();i.append(e),n=e.select().getNodes()}}else if(vl(i,n)){const t=Wl(e);if(ui(s)){i.replace(t);const e=Ll();Lr(i)&&(e.setFormat(i.getFormatType()),e.setIndent(i.getIndent())),t.append(e)}else if(Dl(i)){const e=i.getParentOrThrow();kl(t,e.getChildren()),e.replace(t)}return}}const r=new Set;for(let t=0;t<n.length;t++){const o=n[t];if(Lr(o)&&o.isEmpty()&&!Dl(o)&&!r.has(o.getKey())){Tl(o,e);continue}let i=Co(o)?o.getParent():Dl(o)&&o.isEmpty()?o:null;for(;null!=i;){const t=i.getKey();if(Ul(i)){if(!r.has(t)){const n=Wl(e);kl(n,i.getChildren()),i.replace(n),r.add(t)}break}{const n=i.getParent();if(ui(n)&&!r.has(t)){r.add(t),Tl(i,e);break}i=n}}}}}function kl(e,t){e.splice(e.getChildrenSize(),0,t)}function Tl(e,t){if(Ul(e))return e;const n=e.getPreviousSibling(),r=e.getNextSibling(),o=Ll();let i;if(kl(o,e.getChildren()),Ul(n)&&t===n.getListType())n.append(o),Ul(r)&&t===r.getListType()&&(kl(n,r.getChildren()),r.remove()),i=n;else if(Ul(r)&&t===r.getListType())r.getFirstChildOrThrow().insertBefore(o),i=r;else{const n=Wl(t);n.append(o),e.replace(n),i=n}return o.setFormat(e.getFormatType()),o.setIndent(e.getIndent()),e.remove(),i}function Nl(e,t){const n=e.getLastChild(),r=t.getFirstChild();n&&r&&Cl(n)&&Cl(r)&&(Nl(n.getFirstChild(),r.getFirstChild()),r.remove());const o=t.getChildren();o.length>0&&e.append(...o),t.remove()}function El(){const e=Qn();if(Dn(e)){const t=new Set,n=e.getNodes(),r=e.anchor.getNode();if(vl(r,n))t.add(bl(r));else for(let e=0;e<n.length;e++){const r=n[e];if(Co(r)){const e=Gs(r,Pl);null!=e&&t.add(bl(e))}}for(const n of t){let t=n;const r=Sl(n);for(const n of r){const r=Qr().setTextStyle(e.style).setTextFormat(e.format);kl(r,n.getChildren()),t.insertAfter(r),t=r,n.__key===e.anchor.key&&gs(e.anchor,Ss(Xi(r,"next"))),n.__key===e.focus.key&&gs(e.focus,Ss(Xi(r,"next"))),n.remove()}n.remove()}}}function Al(e){const t=new Set;if(Cl(e)||t.has(e.getKey()))return;const n=e.getParent(),r=e.getNextSibling(),o=e.getPreviousSibling();if(Cl(r)&&Cl(o)){const n=o.getFirstChild();if(Ul(n)){n.append(e);const o=r.getFirstChild();Ul(o)&&(kl(n,o.getChildren()),r.remove(),t.add(r.getKey()))}}else if(Cl(r)){const t=r.getFirstChild();if(Ul(t)){const n=t.getFirstChild();null!==n&&n.insertBefore(e)}}else if(Cl(o)){const t=o.getFirstChild();Ul(t)&&t.append(e)}else if(Ul(n)){const t=Ll().setTextFormat(e.getTextFormat()).setTextStyle(e.getTextStyle()),i=Wl(n.getListType()).setTextFormat(n.getTextFormat()).setTextStyle(n.getTextStyle());t.append(i),i.append(e),o?o.insertAfter(t):r?r.insertBefore(t):n.append(t)}}function Fl(e){if(Cl(e))return;const t=e.getParent(),n=t?t.getParent():void 0;if(Ul(n?n.getParent():void 0)&&Dl(n)&&Ul(t)){const r=t?t.getFirstChild():void 0,o=t?t.getLastChild():void 0;if(e.is(r))n.insertBefore(e),t.isEmpty()&&n.remove();else if(e.is(o))n.insertAfter(e),t.isEmpty()&&n.remove();else{const r=t.getListType(),o=Ll(),i=Wl(r);o.append(i),e.getPreviousSiblings().forEach((e=>i.append(e)));const s=Ll(),l=Wl(r);s.append(l),kl(l,e.getNextSiblings()),n.insertBefore(o),n.insertAfter(s),n.replace(e)}}}function Ol(...e){const t=[];for(const n of e)if(n&&"string"==typeof n)for(const[e]of n.matchAll(/\S+/g))t.push(e);return t}!function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach((function(n){var r=t[n],o=[];/^\w+$/.test(n)||o.push(/\w+/.exec(n)[0]),"diff"===n&&o.push("bold"),e.languages.diff[n]={pattern:RegExp("^(?:["+r+"].*(?:\r\n?|\n|(?![\\s\\S])))+","m"),alias:o,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}})),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})}(Prism);let Pl=class extends Mr{__value;__checked;$config(){return this.config("listitem",{$transform:e=>{if(null==e.__checked)return;const t=e.getParent();Ul(t)&&"check"!==t.getListType()&&null!=e.getChecked()&&e.setChecked(void 0)},extends:Mr,importDOM:{li:()=>({conversion:Rl,priority:0})}})}constructor(e=1,t=void 0,n){super(n),this.__value=void 0===e?1:e,this.__checked=t}afterCloneFrom(e){super.afterCloneFrom(e),this.__value=e.__value,this.__checked=e.__checked}createDOM(e){const t=document.createElement("li");return this.updateListItemDOM(null,t,e),t}updateListItemDOM(e,t,n){!function(e,t,n){const r=t.getParent();!Ul(r)||"check"!==r.getListType()||Ul(t.getFirstChild())?(e.removeAttribute("role"),e.removeAttribute("tabIndex"),e.removeAttribute("aria-checked")):(e.setAttribute("role","checkbox"),e.setAttribute("tabIndex","-1"),n&&t.__checked===n.__checked||e.setAttribute("aria-checked",t.getChecked()?"true":"false"))}(t,this,e),t.value=this.__value,function(e,t,n){const r=[],o=[],i=t.list,s=i?i.listitem:void 0;let l;if(i&&i.nested&&(l=i.nested.listitem),void 0!==s&&r.push(...Ol(s)),i){const e=n.getParent(),t=Ul(e)&&"check"===e.getListType(),s=n.getChecked();t&&!s||o.push(i.listitemUnchecked),t&&s||o.push(i.listitemChecked),t&&r.push(s?i.listitemChecked:i.listitemUnchecked)}if(void 0!==l){const e=Ol(l);n.getChildren().some((e=>Ul(e)))?r.push(...e):o.push(...e)}o.length>0&&Ys(e,...o),r.length>0&&js(e,...r)}(t,n.theme,this);const r=e?e.__style:"",o=this.__style;r!==o&&(""===o?t.removeAttribute("style"):t.style.cssText=o),function(e,t,n){const r=As(t.__textStyle);for(const t in r)e.style.setProperty(`--listitem-marker-${t}`,r[t]);if(n)for(const t in As(n.__textStyle))t in r||e.style.removeProperty(`--listitem-marker-${t}`)}(t,this,e)}updateDOM(e,t,n){const r=t;return this.updateListItemDOM(e,r,n),!1}updateFromJSON(e){return super.updateFromJSON(e).setValue(e.value).setChecked(e.checked)}exportDOM(e){const t=this.createDOM(e._config),n=this.getFormatType();n&&(t.style.textAlign=n);const r=this.getDirection();return r&&(t.dir=r),{element:t}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),value:this.getValue()}}append(...e){for(let t=0;t<e.length;t++){const n=e[t];if(Lr(n)&&this.canMergeWith(n)){const e=n.getChildren();this.append(...e),n.remove()}else super.append(n)}return this}replace(e,t){if(Dl(e))return super.replace(e);this.setIndent(0);const n=this.getParentOrThrow();if(!Ul(n))return e;if(n.__first===this.getKey())n.insertBefore(e);else if(n.__last===this.getKey())n.insertAfter(e);else{const t=Wl(n.getListType());let r=this.getNextSibling();for(;r;){const e=r;r=r.getNextSibling(),t.append(e)}n.insertAfter(e),e.insertAfter(t)}return t&&(Lr(e)||yl(139),this.getChildren().forEach((t=>{e.append(t)}))),this.remove(),0===n.getChildrenSize()&&n.remove(),e}insertAfter(e,t=!0){const n=this.getParentOrThrow();if(Ul(n)||yl(39),Dl(e))return super.insertAfter(e,t);const r=this.getNextSiblings();if(n.insertAfter(e,t),0!==r.length){const o=Wl(n.getListType());r.forEach((e=>o.append(e))),e.insertAfter(o,t)}return e}remove(e){const t=this.getPreviousSibling(),n=this.getNextSibling();super.remove(e),t&&n&&Cl(t)&&Cl(n)&&(Nl(t.getFirstChild(),n.getFirstChild()),n.remove())}insertNewAfter(e,t=!0){const n=Ll().updateFromJSON(this.exportJSON()).setChecked(!this.getChecked()&&void 0);return this.insertAfter(n,t),n}collapseAtStart(e){const t=Qr();this.getChildren().forEach((e=>t.append(e)));const n=this.getParentOrThrow(),r=n.getParentOrThrow(),o=Dl(r);if(1===n.getChildrenSize())if(o)n.remove(),r.select();else{n.insertBefore(t),n.remove();const r=e.anchor,o=e.focus,i=t.getKey();"element"===r.type&&r.getNode().is(this)&&r.set(i,r.offset,"element"),"element"===o.type&&o.getNode().is(this)&&o.set(i,o.offset,"element")}else n.insertBefore(t),this.remove();return!0}getValue(){return this.getLatest().__value}setValue(e){const t=this.getWritable();return t.__value=e,t}getChecked(){const e=this.getLatest();let t;const n=this.getParent();return Ul(n)&&(t=n.getListType()),"check"===t?Boolean(e.__checked):void 0}setChecked(e){const t=this.getWritable();return t.__checked=e,t}toggleChecked(){const e=this.getWritable();return e.setChecked(!e.__checked)}getIndent(){const e=this.getParent();if(null===e||!this.isAttached())return this.getLatest().__indent;let t=e.getParentOrThrow(),n=0;for(;Dl(t);)t=t.getParentOrThrow().getParentOrThrow(),n++;return n}setIndent(e){"number"!=typeof e&&yl(117),(e=Math.floor(e))>=0||yl(199);let t=this.getIndent();for(;t!==e;)t<e?(Al(this),t++):(Fl(this),t--);return this}canInsertAfter(e){return Dl(e)}canReplaceWith(e){return Dl(e)}canMergeWith(e){return Dl(e)||eo(e)}extractWithChild(e,t){if(!Dn(t))return!1;const n=t.anchor.getNode(),r=t.focus.getNode();return this.isParentOf(n)&&this.isParentOf(r)&&this.getTextContent().length===t.getTextContent().length}isParentRequired(){return!0}createParentElementNode(){return Wl("bullet")}canMergeWhenEmpty(){return!0}};function Rl(e){if(e.classList.contains("task-list-item"))for(const t of e.children)if("INPUT"===t.tagName)return Ml(t);const t=e.getAttribute("aria-checked");return{node:Ll("true"===t||"false"!==t&&void 0)}}function Ml(e){return"checkbox"!==e.getAttribute("type")?{node:null}:{node:Ll(e.hasAttribute("checked"))}}function Ll(e){return gi(new Pl(void 0,e))}function Dl(e){return e instanceof Pl}class Il extends Mr{__tag;__start;__listType;$config(){return this.config("list",{$transform:e=>{!function(e){const t=e.getNextSibling();Ul(t)&&e.getListType()===t.getListType()&&Nl(e,t)}(e),function(e){const t="check"!==e.getListType();let n=e.getStart();for(const r of e.getChildren())Dl(r)&&(r.getValue()!==n&&r.setValue(n),t&&null!=r.getLatest().__checked&&r.setChecked(void 0),Ul(r.getFirstChild())||n++)}(e)},extends:Mr,importDOM:{ol:()=>({conversion:$l,priority:0}),ul:()=>({conversion:$l,priority:0})}})}constructor(e="number",t=1,n){super(n);const r=Bl[e]||e;this.__listType=r,this.__tag="number"===r?"ol":"ul",this.__start=t}afterCloneFrom(e){super.afterCloneFrom(e),this.__listType=e.__listType,this.__tag=e.__tag,this.__start=e.__start}getTag(){return this.getLatest().__tag}setListType(e){const t=this.getWritable();return t.__listType=e,t.__tag="number"===e?"ol":"ul",t}getListType(){return this.getLatest().__listType}getStart(){return this.getLatest().__start}setStart(e){const t=this.getWritable();return t.__start=e,t}createDOM(e,t){const n=this.__tag,r=document.createElement(n);return 1!==this.__start&&r.setAttribute("start",String(this.__start)),r.__lexicalListType=this.__listType,Kl(r,e.theme,this),r}updateDOM(e,t,n){return e.__tag!==this.__tag||e.__listType!==this.__listType||(Kl(t,n.theme,this),!1)}updateFromJSON(e){return super.updateFromJSON(e).setListType(e.listType).setStart(e.start)}exportDOM(e){const t=this.createDOM(e._config,e);return yi(t)&&(1!==this.__start&&t.setAttribute("start",String(this.__start)),"check"===this.__listType&&t.setAttribute("__lexicalListType","check")),{element:t}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag()}}canBeEmpty(){return!1}canIndent(){return!1}splice(e,t,n){let r=n;for(let e=0;e<n.length;e++){const t=n[e];Dl(t)||(r===n&&(r=[...n]),r[e]=Ll().append(!Lr(t)||Ul(t)||t.isInline()?t:kn(t.getTextContent())))}return super.splice(e,t,r)}extractWithChild(e){return Dl(e)}}function Kl(e,t,n){const r=[],o=[],i=t.list;if(void 0!==i){const e=i[`${n.__tag}Depth`]||[],t=function(e){let t=1,n=e.getParent();for(;null!=n;){if(Dl(n)){const e=n.getParent();if(Ul(e)){t++,n=e.getParent();continue}yl(40)}return t}return t}(n)-1,s=t%e.length,l=e[s],a=i[n.__tag];let c;const u=i.nested,d=i.checklist;if(void 0!==u&&u.list&&(c=u.list),void 0!==a&&r.push(a),void 0!==d&&"check"===n.__listType&&r.push(d),void 0!==l){r.push(...Ol(l));for(let t=0;t<e.length;t++)t!==s&&o.push(n.__tag+t)}if(void 0!==c){const e=Ol(c);t>1?r.push(...e):o.push(...e)}}o.length>0&&Ys(e,...o),r.length>0&&js(e,...r)}function zl(e){const t=[];for(let n=0;n<e.length;n++){const r=e[n];if(Dl(r)){t.push(r);const e=r.getChildren();e.length>1&&e.forEach((e=>{Ul(e)&&t.push(xl(e))}))}else t.push(xl(r))}return t}function $l(e){const t=e.nodeName.toLowerCase();let n=null;return"ol"===t?n=Wl("number",e.start):"ul"===t&&(n=function(e){if("check"===e.getAttribute("__lexicallisttype")||e.classList.contains("contains-task-list"))return!0;for(const t of e.childNodes)if(yi(t)&&t.hasAttribute("aria-checked"))return!0;return!1}(e)?Wl("check"):Wl("bullet")),{after:zl,node:n}}const Bl={ol:"number",ul:"bullet"};function Wl(e="number",t=1){return gi(new Il(e,t))}function Ul(e){return e instanceof Il}const Hl=De("INSERT_UNORDERED_LIST_COMMAND"),Jl=De("INSERT_ORDERED_LIST_COMMAND"),jl=De("REMOVE_LIST_COMMAND");function Yl(e,t){const n=t.body?t.body.childNodes:[];let r=[];const o=[];for(let t=0;t<n.length;t++){const i=n[t];if(!ql.has(i.nodeName)){const t=Zl(i,e,o,!1);null!==t&&(r=r.concat(t))}}return function(e){for(const t of e)t.getNextSibling()instanceof qr&&t.insertAfter(ln());for(const t of e){const e=t.getChildren();for(const n of e)t.insertBefore(n);t.remove()}}(o),r}function Vl(e,t){if("undefined"==typeof document||"undefined"==typeof window&&void 0===global.window)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const n=document.createElement("div"),r=Ro().getChildren();for(let o=0;o<r.length;o++)Gl(e,r[o],n,t);return n.innerHTML}function Gl(e,t,n,r=null){let o=null===r||t.isSelected(r);const i=Lr(t)&&t.excludeFromCopy("html");let s=t;if(null!==r){let e=Ei(t);e=Tn(e)&&null!==r?Rs(r,e):e,s=e}const l=Lr(s)?s.getChildren():[],a=lo(e,s.getType());let c;c=a&&void 0!==a.exportDOM?a.exportDOM(e,s):s.exportDOM(e);const{element:u,after:d}=c;if(!u)return!1;const g=document.createDocumentFragment();for(let n=0;n<l.length;n++){const i=l[n],s=Gl(e,i,g,r);!o&&Lr(t)&&s&&t.extractWithChild(i,r,"html")&&(o=!0)}if(o&&!i){if((yi(u)||Si(u))&&u.append(g),n.append(u),d){const e=d.call(s,u);e&&(Si(u)?u.replaceChildren(e):u.replaceWith(e))}}else n.append(g);return o}const ql=new Set(["STYLE","SCRIPT"]);function Zl(e,t,n,r,o=new Map,i){let s=[];if(ql.has(e.nodeName))return s;let l=null;const a=function(e,t){const{nodeName:n}=e,r=t._htmlConversions.get(n.toLowerCase());let o=null;if(void 0!==r)for(const t of r){const n=t(e);null!==n&&(null===o||(o.priority||0)<=(n.priority||0))&&(o=n)}return null!==o?o.conversion:null}(e,t),c=a?a(e):null;let u=null;if(null!==c){u=c.after;const t=c.node;if(l=Array.isArray(t)?t[t.length-1]:t,null!==l){for(const[,e]of o)if(l=e(l,i),!l)break;l&&s.push(...Array.isArray(t)?t:[l])}null!=c.forChild&&o.set(e.nodeName,c.forChild)}const d=e.childNodes;let g=[];const f=(null==l||!ui(l))&&(null!=l&&Vn(l)||r);for(let e=0;e<d.length;e++)g.push(...Zl(d[e],t,n,f,new Map(o),l));return null!=u&&(g=u(g)),xi(e)&&(g=function(e,t,n){const r=e.style.textAlign,o=[];let i=[];for(let e=0;e<t.length;e++){const s=t[e];if(Vn(s))r&&!s.getFormat()&&s.setFormat(r),o.push(s);else if(i.push(s),e===t.length-1||e<t.length-1&&Vn(t[e+1])){const e=n();e.setFormat(r),e.append(...i),o.push(e),i=[]}}return o}(e,g,f?()=>{const e=new qr;return n.push(e),e}:Qr)),null==l?g.length>0?s=s.concat(g):xi(e)&&function(e){return null!=e.nextSibling&&null!=e.previousSibling&&(Ci(e.nextSibling)&&Ci(e.previousSibling))}(e)&&(s=s.concat(ln())):Lr(l)&&l.append(...g),s}function Xl(e,...t){const n=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",e);for(const e of t)r.append("v",e);throw n.search=r.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function Ql(e,t,n){const r=e.getData("application/x-lexical-editor");if(r)try{const e=JSON.parse(r);if(e.namespace===n._config.namespace&&Array.isArray(e.nodes))return ea(n,na(e.nodes),t)}catch(e){}const o=e.getData("text/html"),i=e.getData("text/plain");if(o&&i!==o)try{return ea(n,Yl(n,(new DOMParser).parseFromString(function(e){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy("lexical",{createHTML:e=>e}).createHTML(e):e}(o),"text/html")),t)}catch(e){}const s=i||e.getData("text/uri-list");if(null!=s)if(Dn(t)){const e=s.split(/(\r?\n|\t)/);""===e[e.length-1]&&e.pop();for(let t=0;t<e.length;t++){const n=Qn();if(Dn(n)){const r=e[t];"\n"===r||"\r\n"===r?n.insertParagraph():"\t"===r?n.insertNodes([An()]):n.insertText(r)}}}else t.insertRawText(s)}function ea(e,t,n){e.dispatchCommand(Ke,{nodes:t,selection:n})||(n.insertNodes(t),function(e){if(Dn(e)&&e.isCollapsed()){let t=null;const n=ds(e.anchor,"previous");if(n)if(Wi(n))t=n.origin;else{const e=os(n,Xi(Ro(),"next").getFlipped());for(const n of e){if(Tn(n.origin)){t=n.origin;break}if(Lr(n.origin)&&!n.origin.isInline())break}}if(t&&Tn(t)){const n=t.getFormat(),r=t.getStyle();e.format===n&&e.style===r||(e.format=n,e.style=r,e.dirty=!0)}}}(n))}function ta(e,t,n,r=[]){let o=null===t||n.isSelected(t);const i=Lr(n)&&n.excludeFromCopy("html");let s=n;if(null!==t){let e=Ei(n);e=Tn(e)&&null!==t?Rs(t,e):e,s=e}const l=Lr(s)?s.getChildren():[],a=function(e){const t=e.exportJSON(),n=e.constructor;if(t.type!==n.getType()&&Xl(58,n.name),Lr(e)){const e=t.children;Array.isArray(e)||Xl(59,n.name)}return t}(s);if(Tn(s)){const e=s.__text;e.length>0?a.text=e:o=!1}for(let r=0;r<l.length;r++){const i=l[r],s=ta(e,t,i,a.children);!o&&Lr(n)&&s&&n.extractWithChild(i,t,"clone")&&(o=!0)}if(o&&!i)r.push(a);else if(Array.isArray(a.children))for(let e=0;e<a.children.length;e++){const t=a.children[e];r.push(t)}return o}function na(e){const t=[];for(let n=0;n<e.length;n++){const r=wr(e[n]);Tn(r)&&Ms(r),t.push(r)}return t}let ra=null;async function oa(e,t,n){if(null!==ra)return!1;if(null!==t)return new Promise(((r,o)=>{e.update((()=>{r(ia(e,t,n))}))}));const r=e.getRootElement(),o=e._window||window,i=o.document,s=mi(o);if(null===r||null===s)return!1;const l=i.createElement("span");l.style.cssText="position: fixed; top: -1000px;",l.append(i.createTextNode("#")),r.append(l);const a=new Range;return a.setStart(l,0),a.setEnd(l,1),s.removeAllRanges(),s.addRange(a),new Promise(((t,r)=>{const s=e.registerCommand(yt,(r=>(qs(r,ClipboardEvent)&&(s(),null!==ra&&(o.clearTimeout(ra),ra=null),t(ia(e,r,n))),!0)),4);ra=o.setTimeout((()=>{s(),ra=null,t(!1)}),50),i.execCommand("copy"),l.remove()}))}function ia(e,t,n){if(void 0===n){const t=mi(e._window);if(!t)return!1;const r=t.anchorNode,o=t.focusNode;if(null!==r&&null!==o&&!go(e,r,o))return!1;const i=Qn();if(null===i)return!1;n=la(i)}t.preventDefault();const r=t.clipboardData;return null!==r&&(function(e,t){for(const[n]of sa)void 0===t[n]&&e.setData(n,"");for(const n in t){const r=t[n];void 0!==r&&e.setData(n,r)}}(r,n),!0)}const sa=[["text/html",function(e,t=Qn()){return null==t&&Xl(166),Dn(t)&&t.isCollapsed()||0===t.getNodes().length?"":Vl(e,t)}],["application/x-lexical-editor",function(e,t=Qn()){return null==t&&Xl(166),Dn(t)&&t.isCollapsed()||0===t.getNodes().length?null:JSON.stringify(function(e,t){const n=[],r=Ro().getChildren();for(let o=0;o<r.length;o++)ta(e,t,r[o],n);return{namespace:e._config.namespace,nodes:n}}(e,t))}]];function la(e=Qn()){const t={"text/plain":e?e.getTextContent():""};if(e){const n=wi();for(const[r,o]of sa){const i=o(n,e);null!==i&&(t[r]=i)}}return t}function aa(e,t){if(void 0!==document.caretRangeFromPoint){const n=document.caretRangeFromPoint(e,t);return null===n?null:{node:n.startContainer,offset:n.startOffset}}if("undefined"!==document.caretPositionFromPoint){const n=document.caretPositionFromPoint(e,t);return null===n?null:{node:n.offsetNode,offset:n.offset}}return null}const ca="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,ua=ca&&"documentMode"in document?document.documentMode:null,da=ca&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),ga=!(!ca||!("InputEvent"in window)||ua)&&"getTargetRanges"in new window.InputEvent("input"),fa=ca&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),ha=ca&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,pa=ca&&/^(?=.*Chrome).*/i.test(navigator.userAgent),ma=ca&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&da&&!pa,_a=De("DRAG_DROP_PASTE_FILE");let ya=class e extends Mr{static getType(){return"quote"}static clone(t){return new e(t.__key)}createDOM(e){const t=document.createElement("blockquote");return js(t,e.theme.quote),t}updateDOM(e,t){return!1}static importDOM(){return{blockquote:e=>({conversion:va,priority:0})}}exportDOM(e){const{element:t}=super.exportDOM(e);if(yi(t)){this.isEmpty()&&t.append(document.createElement("br"));const e=this.getFormatType();e&&(t.style.textAlign=e);const n=this.getDirection();n&&(t.dir=n)}return{element:t}}static importJSON(e){return ba().updateFromJSON(e)}insertNewAfter(e,t){const n=Qr(),r=this.getDirection();return n.setDirection(r),this.insertAfter(n,t),n}collapseAtStart(){const e=Qr();return this.getChildren().forEach((t=>e.append(t))),this.replace(e),!0}canMergeWhenEmpty(){return!0}};function ba(){return gi(new ya)}let Sa=class e extends Mr{__tag;static getType(){return"heading"}static clone(t){return new e(t.__tag,t.__key)}constructor(e,t){super(t),this.__tag=e}getTag(){return this.__tag}setTag(e){const t=this.getWritable();return this.__tag=e,t}createDOM(e){const t=this.__tag,n=document.createElement(t),r=e.theme.heading;if(void 0!==r){js(n,r[t])}return n}updateDOM(e,t,n){return e.__tag!==this.__tag}static importDOM(){return{h1:e=>({conversion:xa,priority:0}),h2:e=>({conversion:xa,priority:0}),h3:e=>({conversion:xa,priority:0}),h4:e=>({conversion:xa,priority:0}),h5:e=>({conversion:xa,priority:0}),h6:e=>({conversion:xa,priority:0}),p:e=>{const t=e.firstChild;return null!==t&&Ca(t)?{conversion:()=>({node:null}),priority:3}:null},span:e=>Ca(e)?{conversion:e=>({node:wa("h1")}),priority:3}:null}}exportDOM(e){const{element:t}=super.exportDOM(e);if(yi(t)){this.isEmpty()&&t.append(document.createElement("br"));const e=this.getFormatType();e&&(t.style.textAlign=e);const n=this.getDirection();n&&(t.dir=n)}return{element:t}}static importJSON(e){return wa(e.tag).updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setTag(e.tag)}exportJSON(){return{...super.exportJSON(),tag:this.getTag()}}insertNewAfter(e,t=!0){const n=e?e.anchor.offset:0,r=this.getLastDescendant(),o=!r||e&&e.anchor.key===r.getKey()&&n===r.getTextContentSize()||!e?Qr():wa(this.getTag()),i=this.getDirection();if(o.setDirection(i),this.insertAfter(o,t),0===n&&!this.isEmpty()&&e){const e=Qr();e.select(),this.replace(e,!0)}return o}collapseAtStart(){const e=this.isEmpty()?Qr():wa(this.getTag());return this.getChildren().forEach((t=>e.append(t))),this.replace(e),!0}extractWithChild(){return!0}};function Ca(e){return"span"===e.nodeName.toLowerCase()&&"26pt"===e.style.fontSize}function xa(e){const t=e.nodeName.toLowerCase();let n=null;return"h1"!==t&&"h2"!==t&&"h3"!==t&&"h4"!==t&&"h5"!==t&&"h6"!==t||(n=wa(t),null!==e.style&&(Ai(e,n),n.setFormat(e.style.textAlign))),{node:n}}function va(e){const t=ba();return null!==e.style&&(t.setFormat(e.style.textAlign),Ai(e,t)),{node:t}}function wa(e="h1"){return gi(new Sa(e))}function ka(e){let t=null;if(qs(e,DragEvent)?t=e.dataTransfer:qs(e,ClipboardEvent)&&(t=e.clipboardData),null===t)return[!1,[],!1];const n=t.types,r=n.includes("Files"),o=n.includes("text/html")||n.includes("text/plain");return[r,Array.from(t.files),o]}function Ta(e){const t=Qn();if(!Dn(t))return!1;const n=new Set,r=t.getNodes();for(let t=0;t<r.length;t++){const o=r[t],i=o.getKey();if(n.has(i))continue;const s=Ri(o,(e=>Lr(e)&&!e.isInline()));if(null===s)continue;const l=s.getKey();s.canIndent()&&!n.has(l)&&(n.add(l),e(s))}return n.size>0}function Na(e){return Kr(Fo(e))}function Ea(e){for(const t of["lowercase","uppercase","capitalize"])e.hasFormat(t)&&e.toggleFormat(t)}const Aa=/^(\d+(?:\.\d+)?)px$/,Fa={BOTH:3,COLUMN:2,NO_STATUS:0,ROW:1};class Oa extends Mr{__colSpan;__rowSpan;__headerState;__width;__backgroundColor;__verticalAlign;static getType(){return"tablecell"}static clone(e){return new Oa(e.__headerState,e.__colSpan,e.__width,e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__rowSpan=e.__rowSpan,this.__backgroundColor=e.__backgroundColor,this.__verticalAlign=e.__verticalAlign}static importDOM(){return{td:e=>({conversion:Ra,priority:0}),th:e=>({conversion:Ra,priority:0})}}static importJSON(e){return Ma().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHeaderStyles(e.headerState).setColSpan(e.colSpan||1).setRowSpan(e.rowSpan||1).setWidth(e.width||void 0).setBackgroundColor(e.backgroundColor||null).setVerticalAlign(e.verticalAlign||void 0)}constructor(e=Fa.NO_STATUS,t=1,n,r){super(r),this.__colSpan=t,this.__rowSpan=1,this.__headerState=e,this.__width=n,this.__backgroundColor=null,this.__verticalAlign=void 0}createDOM(e){const t=document.createElement(this.getTag());return this.__width&&(t.style.width=`${this.__width}px`),this.__colSpan>1&&(t.colSpan=this.__colSpan),this.__rowSpan>1&&(t.rowSpan=this.__rowSpan),null!==this.__backgroundColor&&(t.style.backgroundColor=this.__backgroundColor),Pa(this.__verticalAlign)&&(t.style.verticalAlign=this.__verticalAlign),js(t,e.theme.tableCell,this.hasHeader()&&e.theme.tableCellHeader),t}exportDOM(e){const t=super.exportDOM(e);if(yi(t.element)){const e=t.element;e.setAttribute("data-temporary-table-cell-lexical-key",this.getKey()),e.style.border="1px solid black",this.__colSpan>1&&(e.colSpan=this.__colSpan),this.__rowSpan>1&&(e.rowSpan=this.__rowSpan),e.style.width=`${this.getWidth()||75}px`,e.style.verticalAlign=this.getVerticalAlign()||"top",e.style.textAlign="start",null===this.__backgroundColor&&this.hasHeader()&&(e.style.backgroundColor="#f2f3f5")}return t}exportJSON(){return{...super.exportJSON(),...Pa(this.__verticalAlign)&&{verticalAlign:this.__verticalAlign},backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,width:this.getWidth()}}getColSpan(){return this.getLatest().__colSpan}setColSpan(e){const t=this.getWritable();return t.__colSpan=e,t}getRowSpan(){return this.getLatest().__rowSpan}setRowSpan(e){const t=this.getWritable();return t.__rowSpan=e,t}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(e,t=Fa.BOTH){const n=this.getWritable();return n.__headerState=e&t|n.__headerState&~t,n}getHeaderStyles(){return this.getLatest().__headerState}setWidth(e){const t=this.getWritable();return t.__width=e,t}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(e){const t=this.getWritable();return t.__backgroundColor=e,t}getVerticalAlign(){return this.getLatest().__verticalAlign}setVerticalAlign(e){const t=this.getWritable();return t.__verticalAlign=e||void 0,t}toggleHeaderStyle(e){const t=this.getWritable();return(t.__headerState&e)===e?t.__headerState-=e:t.__headerState+=e,t}hasHeaderState(e){return(this.getHeaderStyles()&e)===e}hasHeader(){return this.getLatest().__headerState!==Fa.NO_STATUS}updateDOM(e){return e.__headerState!==this.__headerState||e.__width!==this.__width||e.__colSpan!==this.__colSpan||e.__rowSpan!==this.__rowSpan||e.__backgroundColor!==this.__backgroundColor||e.__verticalAlign!==this.__verticalAlign}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}}function Pa(e){return"middle"===e||"bottom"===e}function Ra(e){const t=e,n=e.nodeName.toLowerCase();let r;Aa.test(t.style.width)&&(r=parseFloat(t.style.width));const o=Ma("th"===n?Fa.ROW:Fa.NO_STATUS,t.colSpan,r);o.__rowSpan=t.rowSpan;const i=t.style.backgroundColor;""!==i&&(o.__backgroundColor=i);const s=t.style.verticalAlign;Pa(s)&&(o.__verticalAlign=s);const l=t.style,a=(l&&l.textDecoration||"").split(" "),c="700"===l.fontWeight||"bold"===l.fontWeight,u=a.includes("line-through"),d="italic"===l.fontStyle,g=a.includes("underline");return{after:e=>{const t=[];let n=null;const r=()=>{if(n){const e=n.getFirstChild();an(e)&&1===n.getChildrenSize()&&e.remove()}};for(const o of e)ci(o)||Tn(o)||an(o)?(Tn(o)&&(c&&o.toggleFormat("bold"),u&&o.toggleFormat("strikethrough"),d&&o.toggleFormat("italic"),g&&o.toggleFormat("underline")),n?n.append(o):(n=Qr().append(o),t.push(n))):(t.push(o),r(),n=null);return r(),0===t.length&&t.push(Qr()),t},node:o}}function Ma(e=Fa.NO_STATUS,t=1,n){return gi(new Oa(e,t,n))}function La(e){return e instanceof Oa}const Da=De("INSERT_TABLE_COMMAND");function Ia(e,...t){const n=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",e);for(const e of t)r.append("v",e);throw n.search=r.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}class Ka extends Mr{__height;static getType(){return"tablerow"}static clone(e){return new Ka(e.__height,e.__key)}static importDOM(){return{tr:e=>({conversion:za,priority:0})}}static importJSON(e){return $a().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHeight(e.height)}constructor(e,t){super(t),this.__height=e}exportJSON(){const e=this.getHeight();return{...super.exportJSON(),...void 0===e?void 0:{height:e}}}createDOM(e){const t=document.createElement("tr");return this.__height&&(t.style.height=`${this.__height}px`),js(t,e.theme.tableRow),t}extractWithChild(e,t,n){return"html"===n}isShadowRoot(){return!0}setHeight(e){const t=this.getWritable();return t.__height=e,t}getHeight(){return this.getLatest().__height}updateDOM(e){return e.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}}function za(e){const t=e;let n;return Aa.test(t.style.height)&&(n=parseFloat(t.style.height)),{after:e=>Zs(e,La),node:$a(n)}}function $a(e){return gi(new Ka(e))}function Ba(e){return e instanceof Ka}const Wa="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,Ua=Wa&&"documentMode"in document?document.documentMode:null,Ha=Wa&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent);function Ja(e){const t=Ri(e,(e=>Ba(e)));if(Ba(t))return t;throw new Error("Expected table cell to be inside of table row.")}function ja(e){const t=Ri(e,(e=>qc(e)));if(qc(t))return t;throw new Error("Expected table cell to be inside of table.")}Wa&&"InputEvent"in window&&!Ua&&new window.InputEvent("input");const Ya=(e,t)=>e===Fa.BOTH||e===t?t:Fa.NO_STATUS;function Va(e,t=!0){const[,,n]=rc(e),[r,o]=tc(n,e,e),i=r[0].length,{startRow:s}=o;let l=null;if(t){const t=s+e.__rowSpan-1,o=r[t],a=$a();for(let e=0;e<i;e++){const{cell:n,startRow:r}=o[e];if(r+n.__rowSpan-1<=t){const t=o[e].cell.__headerState,n=Ya(t,Fa.COLUMN);a.append(Ma(n).append(Qr()))}else n.setRowSpan(n.__rowSpan+1)}const c=n.getChildAtIndex(t);Ba(c)||Ia(256),c.insertAfter(a),l=a}else{const e=s,t=r[e],o=$a();for(let n=0;n<i;n++){const{cell:r,startRow:i}=t[n];if(i===e){const e=t[n].cell.__headerState,r=Ya(e,Fa.COLUMN);o.append(Ma(r).append(Qr()))}else r.setRowSpan(r.__rowSpan+1)}const a=n.getChildAtIndex(e);Ba(a)||Ia(257),a.insertBefore(o),l=o}return l}function Ga(e,t=!0,n=!0){const[,,r]=rc(e),[o,i]=tc(r,e,e),s=o.length,{startColumn:l}=i,a=t?l+e.__colSpan-1:l-1,c=r.getFirstChild();Ba(c)||Ia(120);let u=null;function d(e=Fa.NO_STATUS){const t=Ma(e).append(Qr());return null===u&&(u=t),t}let g=c;e:for(let e=0;e<s;e++){if(0!==e){const e=g.getNextSibling();Ba(e)||Ia(121),g=e}const t=o[e],n=t[a<0?0:a].cell.__headerState,r=Ya(n,Fa.ROW);if(a<0){Za(g,d(r));continue}const{cell:i,startColumn:s,startRow:l}=t[a];if(s+i.__colSpan-1<=a){let n=i,o=l,s=a;for(;o!==e&&n.__rowSpan>1;){if(s-=i.__colSpan,!(s>=0)){g.append(d(r));continue e}{const{cell:e,startRow:r}=t[s];n=e,o=r}}n.insertAfter(d(r))}else i.setColSpan(i.__colSpan+1)}null!==u&&n&&qa(u);const f=r.getColWidths();if(f){const e=[...f],t=a<0?0:a,n=e[t];e.splice(t,0,n),r.setColWidths(e)}return u}function qa(e){const t=e.getFirstDescendant();null==t?e.selectStart():t.getParentOrThrow().selectStart()}function Za(e,t){const n=e.getFirstChild();null!==n?n.insertBefore(t):e.append(t)}function Xa(e){if(0===e.length)return null;const t=ja(e[0]),[n]=nc(t,null,null);let r=1/0,o=-1/0,i=1/0,s=-1/0;const l=new Set;for(const t of n)for(const n of t){if(!n||!n.cell)continue;const t=n.cell.getKey();if(!l.has(t)&&e.some((e=>e.is(n.cell)))){l.add(t);const e=n.startRow,a=n.startColumn,c=n.cell.__rowSpan||1,u=n.cell.__colSpan||1;r=Math.min(r,e),o=Math.max(o,e+c-1),i=Math.min(i,a),s=Math.max(s,a+u-1)}}if(r===1/0||i===1/0)return null;const a=o-r+1,c=s-i+1,u=n[r][i];if(!u.cell)return null;const d=u.cell;d.setColSpan(c),d.setRowSpan(a);const g=new Set([d.getKey()]);for(let e=r;e<=o;e++)for(let t=i;t<=s;t++){const r=n[e][t];if(!r.cell)continue;const o=r.cell,i=o.getKey();g.has(i)||(g.add(i),Qa(o)||d.append(...o.getChildren()),o.remove())}return 0===d.getChildrenSize()&&d.append(Qr()),d}function Qa(e){if(1!==e.getChildrenSize())return!1;const t=e.getFirstChildOrThrow();return!(!eo(t)||!t.isEmpty())}function ec(e){const[t,n,r]=rc(e),o=t.__colSpan,i=t.__rowSpan;if(1===o&&1===i)return;const[s,l]=tc(r,t,t),{startColumn:a,startRow:c}=l,u=t.__headerState&Fa.COLUMN,d=Array.from({length:o},((e,t)=>{let n=u;for(let e=0;0!==n&&e<s.length;e++)n&=s[e][t+a].cell.__headerState;return n})),g=t.__headerState&Fa.ROW,f=Array.from({length:i},((e,t)=>{let n=g;for(let e=0;0!==n&&e<s[0].length;e++)n&=s[t+c][e].cell.__headerState;return n}));if(o>1){for(let e=1;e<o;e++)t.insertAfter(Ma(d[e]|f[0]).append(Qr()));t.setColSpan(1)}if(i>1){let e;for(let t=1;t<i;t++){const r=c+t,i=s[r];e=(e||n).getNextSibling(),Ba(e)||Ia(125);let l=null;for(let e=0;e<a;e++){const t=i[e],n=t.cell;t.startRow===r&&(l=n),n.__colSpan>1&&(e+=n.__colSpan-1)}if(null===l)for(let n=o-1;n>=0;n--)Za(e,Ma(d[n]|f[t]).append(Qr()));else for(let e=o-1;e>=0;e--)l.insertAfter(Ma(d[e]|f[t]).append(Qr()))}t.setRowSpan(1)}}function tc(e,t,n){const[r,o,i]=nc(e,t,n);return null===o&&Ia(207),null===i&&Ia(208),[r,o,i]}function nc(e,t,n){const r=[];let o=null,i=null;function s(e){let t=r[e];return void 0===t&&(r[e]=t=[]),t}const l=e.getChildren();for(let e=0;e<l.length;e++){const r=l[e];Ba(r)||Ia(209);const a=s(e);for(let c=r.getFirstChild(),u=0;null!=c;c=c.getNextSibling()){for(La(c)||Ia(147);void 0!==a[u];)u++;const r={cell:c,startColumn:u,startRow:e},{__rowSpan:d,__colSpan:g}=c;for(let t=0;t<d&&!(e+t>=l.length);t++){const n=s(e+t);for(let e=0;e<g;e++)n[u+e]=r}null!==t&&null===o&&t.is(c)&&(o=r),null!==n&&null===i&&n.is(c)&&(i=r)}}return[r,o,i]}function rc(e){let t;if(e instanceof Oa)t=e;else if("__type"in e){const n=Ri(e,La);La(n)||Ia(148),t=n}else{const n=Ri(e.getNode(),La);La(n)||Ia(148),t=n}const n=t.getParent();Ba(n)||Ia(149);const r=n.getParent();return qc(r)||Ia(210),[t,n,r]}function oc(e,t,n){let r,o=Math.min(t.startColumn,n.startColumn),i=Math.min(t.startRow,n.startRow),s=Math.max(t.startColumn+t.cell.__colSpan-1,n.startColumn+n.cell.__colSpan-1),l=Math.max(t.startRow+t.cell.__rowSpan-1,n.startRow+n.cell.__rowSpan-1);do{r=!1;for(let t=0;t<e.length;t++)for(let n=0;n<e[0].length;n++){const a=e[t][n];if(!a)continue;const c=a.startColumn+a.cell.__colSpan-1,u=a.startRow+a.cell.__rowSpan-1,d=a.startColumn<=s&&c>=o,g=a.startRow<=l&&u>=i;if(d&&g){const e=Math.min(o,a.startColumn),t=Math.max(s,c),n=Math.min(i,a.startRow),d=Math.max(l,u);e===o&&t===s&&n===i&&d===l||(o=e,s=t,i=n,l=d,r=!0)}}}while(r);return{maxColumn:s,maxRow:l,minColumn:o,minRow:i}}function ic(e){const[t,,n]=rc(e),r=n.getChildren(),o=r.length,i=r[0].getChildren().length,s=new Array(o);for(let e=0;e<o;e++)s[e]=new Array(i);for(let e=0;e<o;e++){const n=r[e].getChildren();let o=0;for(let r=0;r<n.length;r++){for(;s[e][o];)o++;const i=n[r],l=i.__rowSpan||1,a=i.__colSpan||1;for(let t=0;t<l;t++)for(let n=0;n<a;n++)s[e+t][o+n]=i;if(t===i)return{colSpan:a,columnIndex:o,rowIndex:e,rowSpan:l};o+=a}}return null}function sc(e){const[[t,n,r,o],[i,s,l,a]]=["anchor","focus"].map((t=>{const n=e[t].getNode(),r=Ri(n,La);La(r)||Ia(238,t,n.getKey(),n.getType());const o=r.getParent();Ba(o)||Ia(239,t);const i=o.getParent();return qc(i)||Ia(240,t),[n,r,o,i]}));return o.is(a)||Ia(241),{anchorCell:n,anchorNode:t,anchorRow:r,anchorTable:o,focusCell:s,focusNode:i,focusRow:l,focusTable:a}}class lc{tableKey;anchor;focus;_cachedNodes;dirty;constructor(e,t,n){this.anchor=t,this.focus=n,t._selection=this,n._selection=this,this._cachedNodes=null,this.dirty=!1,this.tableKey=e}getStartEndPoints(){return[this.anchor,this.focus]}isValid(){return"root"!==this.tableKey&&"root"!==this.anchor.key&&"element"===this.anchor.type&&"root"!==this.focus.key&&"element"===this.focus.type}isBackward(){return this.focus.isBefore(this.anchor)}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){return ac(e)&&this.tableKey===e.tableKey&&this.anchor.is(e.anchor)&&this.focus.is(e.focus)}set(e,t,n){this.dirty=this.dirty||e!==this.tableKey||t!==this.anchor.key||n!==this.focus.key,this.tableKey=e,this.anchor.key=t,this.focus.key=n,this._cachedNodes=null}clone(){return new lc(this.tableKey,Pn(this.anchor.key,this.anchor.offset,this.anchor.type),Pn(this.focus.key,this.focus.offset,this.focus.type))}isCollapsed(){return!1}extract(){return this.getNodes()}insertRawText(e){}insertText(){}hasFormat(e){let t=0;this.getNodes().filter(La).forEach((e=>{const n=e.getFirstChild();eo(n)&&(t|=n.getTextFormat())}));return!!(t&N[e])}insertNodes(e){const t=this.focus.getNode();Lr(t)||Ia(151),te(t.select(0,t.getChildrenSize())).insertNodes(e)}getShape(){const{anchorCell:e,focusCell:t}=sc(this),n=ic(e);null===n&&Ia(153);const r=ic(t);null===r&&Ia(155);const o=Math.min(n.columnIndex,r.columnIndex),i=Math.max(n.columnIndex+n.colSpan-1,r.columnIndex+r.colSpan-1),s=Math.min(n.rowIndex,r.rowIndex),l=Math.max(n.rowIndex+n.rowSpan-1,r.rowIndex+r.rowSpan-1);return{fromX:Math.min(o,i),fromY:Math.min(s,l),toX:Math.max(o,i),toY:Math.max(s,l)}}getNodes(){if(!this.isValid())return[];const e=this._cachedNodes;if(null!==e)return e;const{anchorTable:t,anchorCell:n,focusCell:r}=sc(this),o=r.getParents()[1];if(o!==t){if(t.isParentOf(r)){const e=o.getParent();null==e&&Ia(159),this.set(this.tableKey,r.getKey(),e.getKey())}else{const e=t.getParent();null==e&&Ia(158),this.set(this.tableKey,e.getKey(),r.getKey())}return this.getNodes()}const[i,s,l]=tc(t,n,r),{minColumn:a,maxColumn:c,minRow:u,maxRow:d}=oc(i,s,l),g=new Map([[t.getKey(),t]]);let f=null;for(let e=u;e<=d;e++)for(let t=a;t<=c;t++){const{cell:n}=i[e][t],r=n.getParent();Ba(r)||Ia(160),r!==f&&(g.set(r.getKey(),r),f=r),g.has(n.getKey())||uc(n,(e=>{g.set(e.getKey(),e)}))}const h=Array.from(g.values());return pr()||(this._cachedNodes=h),h}getTextContent(){const e=this.getNodes().filter((e=>La(e)));let t="";for(let n=0;n<e.length;n++){const r=e[n],o=r.__parent,i=(e[n+1]||{}).__parent;t+=r.getTextContent()+(i!==o?"\n":"\t")}return t}}function ac(e){return e instanceof lc}function cc(){const e=Pn("root",0,"element"),t=Pn("root",0,"element");return new lc("root",e,t)}function uc(e,t){const n=[[e]];for(let e=n.at(-1);void 0!==e&&n.length>0;e=n.at(-1)){const r=e.pop();void 0===r?n.pop():!1!==t(r)&&Lr(r)&&n.push(r.getChildren())}}class dc{focusX;focusY;listenersToRemove;table;isHighlightingCells;anchorX;anchorY;tableNodeKey;anchorCell;focusCell;anchorCellNodeKey;focusCellNodeKey;editor;tableSelection;hasHijackedSelectionStyles;isSelecting;pointerType;shouldCheckSelection;abortController;listenerOptions;nextFocus;constructor(e,t){this.isHighlightingCells=!1,this.anchorX=-1,this.anchorY=-1,this.focusX=-1,this.focusY=-1,this.listenersToRemove=new Set,this.tableNodeKey=t,this.editor=e,this.table={columns:0,domRows:[],rows:0},this.tableSelection=null,this.anchorCellNodeKey=null,this.focusCellNodeKey=null,this.anchorCell=null,this.focusCell=null,this.hasHijackedSelectionStyles=!1,this.isSelecting=!1,this.pointerType=null,this.shouldCheckSelection=!1,this.abortController=new AbortController,this.listenerOptions={signal:this.abortController.signal},this.nextFocus=null,this.trackTable()}getTable(){return this.table}removeListeners(){this.abortController.abort("removeListeners"),Array.from(this.listenersToRemove).forEach((e=>e())),this.listenersToRemove.clear()}$lookup(){return function(e,t=wi()){const n=No(e);qc(n)||Ia(231,e);const r=hc(n,t.getElementByKey(e));return null===r&&Ia(232,e),{tableElement:r,tableNode:n}}(this.tableNodeKey,this.editor)}trackTable(){const e=new MutationObserver((e=>{this.editor.getEditorState().read((()=>{let t=!1;for(let n=0;n<e.length;n++){const r=e[n].target.nodeName;if("TABLE"===r||"TBODY"===r||"THEAD"===r||"TR"===r){t=!0;break}}if(!t)return;const{tableNode:n,tableElement:r}=this.$lookup();this.table=vc(n,r)}),{editor:this.editor})}));this.editor.getEditorState().read((()=>{const{tableNode:t,tableElement:n}=this.$lookup();this.table=vc(t,n),e.observe(n,{attributes:!0,childList:!0,subtree:!0})}),{editor:this.editor})}$clearHighlight(){const e=this.editor;this.isHighlightingCells=!1,this.anchorX=-1,this.anchorY=-1,this.focusX=-1,this.focusY=-1,this.tableSelection=null,this.anchorCellNodeKey=null,this.focusCellNodeKey=null,this.anchorCell=null,this.focusCell=null,this.hasHijackedSelectionStyles=!1,this.$enableHighlightStyle();const{tableNode:t,tableElement:n}=this.$lookup();wc(e,vc(t,n),null),null!==Qn()&&(Lo(null),e.dispatchCommand(Ie,void 0))}$enableHighlightStyle(){const e=this.editor,{tableElement:t}=this.$lookup();Ys(t,e._config.theme.tableSelection),t.classList.remove("disable-selection"),this.hasHijackedSelectionStyles=!1}$disableHighlightStyle(){const{tableElement:e}=this.$lookup();js(e,this.editor._config.theme.tableSelection),this.hasHijackedSelectionStyles=!0}$updateTableTableSelection(e){if(null!==e){e.tableKey!==this.tableNodeKey&&Ia(233,e.tableKey,this.tableNodeKey);const t=this.editor;this.tableSelection=e,this.isHighlightingCells=!0,this.$disableHighlightStyle(),this.updateDOMSelection(),wc(t,this.table,this.tableSelection)}else this.$clearHighlight()}setShouldCheckSelection(){this.shouldCheckSelection=!0}getAndClearShouldCheckSelection(){return!!this.shouldCheckSelection&&(this.shouldCheckSelection=!1,!0)}setNextFocus(e){this.nextFocus=e}getAndClearNextFocus(){const{nextFocus:e}=this;return null!==e&&(this.nextFocus=null),e}updateDOMSelection(){if(null!==this.anchorCell&&null!==this.focusCell){const e=mi(this.editor._window);e&&e.rangeCount>0&&e.removeAllRanges()}}$setFocusCellForSelection(e,t=!1){const n=this.editor,{tableNode:r}=this.$lookup(),o=e.x,i=e.y;if(this.focusCell=e,this.isHighlightingCells||this.anchorX===o&&this.anchorY===i&&!t){if(o===this.focusX&&i===this.focusY)return!1}else this.isHighlightingCells=!0,this.$disableHighlightStyle();if(this.focusX=o,this.focusY=i,this.isHighlightingCells){const t=Uc(r,e.elem);if(null!=this.tableSelection&&null!=this.anchorCellNodeKey&&null!==t)return this.focusCellNodeKey=t.getKey(),this.tableSelection=function(e,t,n){e.getKey(),t.getKey(),n.getKey();const r=Qn(),o=ac(r)?r.clone():cc();return o.set(e.getKey(),t.getKey(),n.getKey()),o}(r,this.$getAnchorTableCellOrThrow(),t),Lo(this.tableSelection),n.dispatchCommand(Ie,void 0),wc(n,this.table,this.tableSelection),!0}return!1}$getAnchorTableCell(){return this.anchorCellNodeKey?No(this.anchorCellNodeKey):null}$getAnchorTableCellOrThrow(){const e=this.$getAnchorTableCell();return null===e&&Ia(234),e}$getFocusTableCell(){return this.focusCellNodeKey?No(this.focusCellNodeKey):null}$getFocusTableCellOrThrow(){const e=this.$getFocusTableCell();return null===e&&Ia(235),e}$setAnchorCellForSelection(e){this.isHighlightingCells=!1,this.anchorCell=e,this.anchorX=e.x,this.anchorY=e.y;const{tableNode:t}=this.$lookup(),n=Uc(t,e.elem);if(null!==n){const e=n.getKey();this.tableSelection=null!=this.tableSelection?this.tableSelection.clone():cc(),this.anchorCellNodeKey=e}}$formatCells(e){const t=Qn();ac(t)||Ia(236);const n=qn(),r=n.anchor,o=n.focus,i=t.getNodes().filter(La);i.length>0||Ia(237);const s=i[0].getFirstChild(),l=eo(s)?s.getFormatFlags(e,null):null;i.forEach((t=>{r.set(t.getKey(),0,"element"),o.set(t.getKey(),t.getChildrenSize(),"element"),n.formatText(e,l)})),Lo(t),this.editor.dispatchCommand(Ie,void 0)}$clearText(){const{editor:e}=this,t=No(this.tableNodeKey);if(!qc(t))throw new Error("Expected TableNode.");const n=Qn();ac(n)||Ia(253);const r=n.getNodes().filter(La),o=t.getFirstChild(),i=t.getLastChild();if(r.length>0&&null!==o&&null!==i&&Ba(o)&&Ba(i)&&r[0]===o.getFirstChild()&&r[r.length-1]===i.getLastChild()){t.selectPrevious();const n=t.getParent();return t.remove(),void($r(n)&&n.isEmpty()&&e.dispatchCommand(We,void 0))}r.forEach((e=>{if(Lr(e)){const t=Qr(),n=kn();t.append(n),e.append(t),e.getChildren().forEach((e=>{e!==t&&e.remove()}))}})),wc(e,this.table,null),Lo(null),e.dispatchCommand(Ie,void 0)}}const gc="__lexicalTableSelection";function fc(e){return yi(e)&&"TABLE"===e.nodeName}function hc(e,t){if(!t)return t;const n=fc(t)?t:e.getDOMSlot(t).element;return"TABLE"!==n.nodeName&&Ia(245,t.nodeName),n}function pc(e){return e._window}function mc(e,t){for(let n=t,r=null;null!==n;n=n.getParent()){if(e.is(n))return r;La(n)&&(r=n)}return null}const _c=[[rt,"down"],[nt,"up"],[et,"backward"],[Xe,"forward"]],yc=[je,Ye,$e],bc=[st,at];function Sc(e){return e[gc]||null}function Cc(e){let t=e;for(;null!=t;){const e=t.nodeName;if("TD"===e||"TH"===e){const e=t._cell;return void 0===e?null:e}t=t.parentNode}return null}function xc(e,t){if(!e.contains(t))return null;let n=null;for(let r=t;null!=r;r=r.parentNode){if(r===e)return n;const t=r.nodeName;"TD"!==t&&"TH"!==t||(n=r._cell||null)}return null}function vc(e,t){const n=[],r={columns:0,domRows:n,rows:0};let o=hc(e,t).querySelector("tr"),i=0,s=0;for(n.length=0;null!=o;){const e=o.nodeName;if("TD"===e||"TH"===e){const e={elem:o,hasBackgroundColor:""!==o.style.backgroundColor,highlighted:!1,x:i,y:s};o._cell=e;let t=n[s];void 0===t&&(t=n[s]=[]),t[i]=e}else{const e=o.firstChild;if(null!=e){o=e;continue}}const t=o.nextSibling;if(null!=t){i++,o=t;continue}const r=o.parentNode;if(null!=r){const e=r.nextSibling;if(null==e)break;s++,i=0,o=e}}return r.columns=i+1,r.rows=s+1,r}function wc(e,t,n){const r=new Set(n?n.getNodes():[]);kc(t,((t,n)=>{const o=t.elem;r.has(n)?(t.highlighted=!0,Rc(e,t)):(t.highlighted=!1,Mc(e,t),o.getAttribute("style")||o.removeAttribute("style"))}))}function kc(e,t){const{domRows:n}=e;for(let e=0;e<n.length;e++){const r=n[e];if(r)for(let n=0;n<r.length;n++){const o=r[n];if(!o)continue;const i=Fo(o.elem);null!==i&&t(o,i,{x:n,y:e})}}}function Tc(e,t){t.$disableHighlightStyle(),kc(t.table,(t=>{t.highlighted=!0,Rc(e,t)}))}const Nc=(e,t,n,r,o)=>{const i="forward"===o;switch(o){case"backward":case"forward":return n!==(i?e.table.columns-1:0)?Pc(t.getCellNodeFromCordsOrThrow(n+(i?1:-1),r,e.table),i):r!==(i?e.table.rows-1:0)?Pc(t.getCellNodeFromCordsOrThrow(i?0:e.table.columns-1,r+(i?1:-1),e.table),i):i?t.selectNext():t.selectPrevious(),!0;case"up":return 0!==r?Pc(t.getCellNodeFromCordsOrThrow(n,r-1,e.table),!1):t.selectPrevious(),!0;case"down":return r!==e.table.rows-1?Pc(t.getCellNodeFromCordsOrThrow(n,r+1,e.table),!0):t.selectNext(),!0;default:return!1}};function Ec(e,t){let n,r;if(t.startColumn===e.minColumn)n="minColumn";else{if(t.startColumn+t.cell.__colSpan-1!==e.maxColumn)return null;n="maxColumn"}if(t.startRow===e.minRow)r="minRow";else{if(t.startRow+t.cell.__rowSpan-1!==e.maxRow)return null;r="maxRow"}return[n,r]}function Ac([e,t]){return["minColumn"===e?"maxColumn":"minColumn","minRow"===t?"maxRow":"minRow"]}function Fc(e,t,[n,r]){const o=t[r],i=e[o];void 0===i&&Ia(250,r,String(o));const s=t[n],l=i[s];return void 0===l&&Ia(250,n,String(s)),l}function Oc(e,t){if(Dn(e)||ac(e)){const n=t.isParentOf(e.anchor.getNode()),r=t.isParentOf(e.focus.getNode());return n&&r}return!1}function Pc(e,t){t?e.selectStart():e.selectEnd()}function Rc(e,t){const n=t.elem,r=e._config.theme;La(Fo(n))||Ia(131),js(n,r.tableCellSelected)}function Mc(e,t){const n=t.elem;La(Fo(n))||Ia(131);Ys(n,e._config.theme.tableCellSelected)}function Lc(e){const t=Ri(e,La);return La(t)?t:null}function Dc(e){const t=Ri(e,qc);return qc(t)?t:null}function Ic(e,t,n,r,o,i,s){const l=ds(n.focus,o?"previous":"next");if(Cs(l))return!1;let a=l;for(const e of ns(l).iterNodeCarets("shadowRoot")){if(!Ui(e)||!Lr(e.origin))return!1;a=e}const c=a.getParentAtCaret();if(!La(c))return!1;const u=c,d=function(e){for(const t of ns(e).iterNodeCarets("root")){const{origin:n}=t;if(La(n)){if(Hi(t))return Xi(n,e.direction)}else if(!Ba(n))break}return null}(Vi(u,a.direction)),g=Ri(u,qc);if(!g||!g.is(i))return!1;const f=e.getElementByKey(u.getKey()),h=Cc(f);if(!f||!h)return!1;const p=function(e,t){const n=e.getElementByKey(t.getKey());return null===n&&Ia(230),vc(t,n)}(e,g);if(s.table=p,d)if("extend"===r){const t=Cc(e.getElementByKey(d.origin.getKey()));if(!t)return!1;s.$setAnchorCellForSelection(h),s.$setFocusCellForSelection(t,!0)}else{const e=Ss(d);gs(n.anchor,e),gs(n.focus,e)}else if("extend"===r)s.$setAnchorCellForSelection(h),s.$setFocusCellForSelection(h,!0);else{const e=function(e){const t=Qi(e);return Hi(t)?Ss(t):e}(Vi(g,l.direction));gs(n.anchor,e),gs(n.focus,e)}return zc(t),!0}function Kc(e,t,n,r,o){if(("up"===n||"down"===n)&&function(e){const t=e.getRootElement();return!!t&&(t.hasAttribute("aria-controls")&&"typeahead-menu"===t.getAttribute("aria-controls"))}(e))return!1;const i=Qn();if(!Oc(i,r)){if(Dn(i)){if("backward"===n){if(i.focus.offset>0)return!1;const e=function(e){for(let t=e,n=e;null!==n;t=n,n=n.getParent())if(Lr(n)){if(n!==t&&n.getFirstChild()!==t)return null;if(!n.isInline())return n}return null}(i.focus.getNode());if(!e)return!1;const n=e.getPreviousSibling();return!!qc(n)&&(zc(t),t.shiftKey?i.focus.set(n.getParentOrThrow().getKey(),n.getIndexWithinParent(),"element"):n.selectEnd(),!0)}if(t.shiftKey&&("up"===n||"down"===n)){const e=i.focus.getNode();if(!i.isCollapsed()&&("up"===n&&!i.isBackward()||"down"===n&&i.isBackward())){let o=Ri(e,(e=>qc(e)));if(La(o)&&(o=Ri(o,qc)),o!==r)return!1;if(!o)return!1;const s="down"===n?o.getNextSibling():o.getPreviousSibling();if(!s)return!1;let l=0;"up"===n&&Lr(s)&&(l=s.getChildrenSize());let a=s;if("up"===n&&Lr(s)){a=s.getLastChild()||s,l=Tn(a)?a.getTextContentSize():0}const c=i.clone();return c.focus.set(a.getKey(),l,Tn(a)?"text":"element"),Lo(c),zc(t),!0}if(ui(e)){const e="up"===n?i.getNodes()[i.getNodes().length-1]:i.getNodes()[0];if(e&&null!==mc(r,e)){const e=r.getFirstDescendant(),t=r.getLastDescendant();if(!e||!t)return!1;const[n]=rc(e),[i]=rc(t),s=r.getCordsFromCellNode(n,o.table),l=r.getCordsFromCellNode(i,o.table),a=r.getDOMCellFromCordsOrThrow(s.x,s.y,o.table),c=r.getDOMCellFromCordsOrThrow(l.x,l.y,o.table);return o.$setAnchorCellForSelection(a),o.$setFocusCellForSelection(c,!0),!0}return!1}{let r=Ri(e,(e=>Lr(e)&&!e.isInline()));if(La(r)&&(r=Ri(r,qc)),!r)return!1;const s="down"===n?r.getNextSibling():r.getPreviousSibling();if(qc(s)&&o.tableNodeKey===s.getKey()){const e=s.getFirstDescendant(),r=s.getLastDescendant();if(!e||!r)return!1;const[o]=rc(e),[l]=rc(r),a=i.clone();return a.focus.set(("up"===n?o:l).getKey(),"up"===n?0:l.getChildrenSize(),"element"),zc(t),Lo(a),!0}}}}return"down"===n&&jc(e)&&o.setShouldCheckSelection(),!1}if(Dn(i)){if("backward"===n||"forward"===n)return Ic(e,t,i,t.shiftKey?"extend":"move","backward"===n,r,o);if(i.isCollapsed()){const{anchor:s,focus:l}=i,a=Ri(s.getNode(),La),c=Ri(l.getNode(),La);if(!La(a)||!a.is(c))return!1;const u=Dc(a);if(u!==r&&null!=u){const r=hc(u,e.getElementByKey(u.getKey()));if(null!=r)return o.table=vc(u,r),Kc(e,t,n,u,o)}const d=e.getElementByKey(a.__key),g=e.getElementByKey(s.key);if(null==g||null==d)return!1;let f;if("element"===s.type)f=g.getBoundingClientRect();else{const t=mi(pc(e));if(null===t||0===t.rangeCount)return!1;f=t.getRangeAt(0).getBoundingClientRect()}const h="up"===n?a.getFirstChild():a.getLastChild();if(null==h)return!1;const p=e.getElementByKey(h.__key);if(null==p)return!1;const m=p.getBoundingClientRect();if("up"===n?m.top>f.top-f.height:f.bottom+f.height>m.bottom){zc(t);const e=r.getCordsFromCellNode(a,o.table);if(!t.shiftKey)return Nc(o,r,e.x,e.y,n);{const t=r.getDOMCellFromCordsOrThrow(e.x,e.y,o.table);o.$setAnchorCellForSelection(t),o.$setFocusCellForSelection(t,!0)}return!0}}}else if(ac(i)){const{anchor:s,focus:l}=i,a=Ri(s.getNode(),La),c=Ri(l.getNode(),La),[u]=i.getNodes();qc(u)||Ia(251);const d=hc(u,e.getElementByKey(u.getKey()));if(!La(a)||!La(c)||!qc(u)||null==d)return!1;o.$updateTableTableSelection(i);const g=vc(u,d),f=r.getCordsFromCellNode(a,g),h=r.getDOMCellFromCordsOrThrow(f.x,f.y,g);if(o.$setAnchorCellForSelection(h),zc(t),t.shiftKey){const[e,t,i]=tc(r,a,c);return function(e,t,n,r,o){const i=oc(t,n,r),s=function(e,t){const{minColumn:n,maxColumn:r,minRow:o,maxRow:i}=t;let s=1,l=1,a=1,c=1;const u=e[o],d=e[i];for(let e=n;e<=r;e++)s=Math.max(s,u[e].cell.__rowSpan),c=Math.max(c,d[e].cell.__rowSpan);for(let t=o;t<=i;t++)l=Math.max(l,e[t][n].cell.__colSpan),a=Math.max(a,e[t][r].cell.__colSpan);return{bottomSpan:c,leftSpan:l,rightSpan:a,topSpan:s}}(t,i),{topSpan:l,leftSpan:a,bottomSpan:c,rightSpan:u}=s,d=function(e,t){const n=Ec(e,t);return null===n&&Ia(249,t.cell.getKey()),n}(i,n),[g,f]=Ac(d);let h=i[g],p=i[f];"forward"===o?h+="maxColumn"===g?1:a:"backward"===o?h-="minColumn"===g?1:u:"down"===o?p+="maxRow"===f?1:l:"up"===o&&(p-="minRow"===f?1:c);const m=t[p];if(void 0===m)return!1;const _=m[h];if(void 0===_)return!1;const[y,b]=function(e,t,n){const r=oc(e,t,n),o=Ec(r,t);if(o)return[Fc(e,r,o),Fc(e,r,Ac(o))];const i=Ec(r,n);if(i)return[Fc(e,r,Ac(i)),Fc(e,r,i)];const s=["minColumn","minRow"];return[Fc(e,r,s),Fc(e,r,Ac(s))]}(t,n,_),S=Wc(e,y.cell),C=Wc(e,b.cell);return e.$setAnchorCellForSelection(S),e.$setFocusCellForSelection(C,!0),!0}(o,e,t,i,n)}return c.selectEnd(),!0}return!1}function zc(e){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation()}function $c(e,t,n){const r=Qr();"first"===e?t.insertBefore(r):t.insertAfter(r),r.append(...n||[]),r.selectEnd()}function Bc(e,t,n){const r=n.getParent();if(!r)return;const o=mi(pc(e));if(!o)return;const i=o.anchorNode,s=e.getElementByKey(r.getKey()),l=hc(n,e.getElementByKey(n.getKey()));if(!i||!s||!l||!s.contains(i)||l.contains(i))return;const a=Ri(t.anchor.getNode(),(e=>La(e)));if(!a)return;const c=Ri(a,(e=>qc(e)));if(!qc(c)||!c.is(n))return;const[u,d]=tc(n,a,a),g=u[0][0],f=u[u.length-1][u[0].length-1],{startRow:h,startColumn:p}=d,m=h===g.startRow&&p===g.startColumn,_=h===f.startRow&&p===f.startColumn;return m?"first":_?"last":void 0}function Wc(e,t){const{tableNode:n}=e.$lookup(),r=n.getCordsFromCellNode(t,e.table);return n.getDOMCellFromCordsOrThrow(r.x,r.y,e.table)}function Uc(e,t,n){return mc(e,Fo(t,n))}function Hc(e,t,n){if(!t.theme.tableAlignment)return;const r=[],o=[];for(const e of["center","right"]){const i=t.theme.tableAlignment[e];i&&(e===n?o:r).push(i)}Ys(e,...r),js(e,...o)}const Jc=new WeakSet;function jc(e=wi()){return Jc.has(e)}class Yc extends Mr{__rowStriping;__frozenColumnCount;__frozenRowCount;__colWidths;static getType(){return"table"}getColWidths(){return this.getLatest().__colWidths}setColWidths(e){const t=this.getWritable();return t.__colWidths=e,t}static clone(e){return new Yc(e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__colWidths=e.__colWidths,this.__rowStriping=e.__rowStriping,this.__frozenColumnCount=e.__frozenColumnCount,this.__frozenRowCount=e.__frozenRowCount}static importDOM(){return{table:e=>({conversion:Vc,priority:1})}}static importJSON(e){return Gc().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setRowStriping(e.rowStriping||!1).setFrozenColumns(e.frozenColumnCount||0).setFrozenRows(e.frozenRowCount||0).setColWidths(e.colWidths)}constructor(e){super(e),this.__rowStriping=!1,this.__frozenColumnCount=0,this.__frozenRowCount=0}exportJSON(){return{...super.exportJSON(),colWidths:this.getColWidths(),frozenColumnCount:this.__frozenColumnCount?this.__frozenColumnCount:void 0,frozenRowCount:this.__frozenRowCount?this.__frozenRowCount:void 0,rowStriping:this.__rowStriping?this.__rowStriping:void 0}}extractWithChild(e,t,n){return"html"===n}getDOMSlot(e){const t=fc(e)?e:e.querySelector("table");return fc(t)||Ia(229),super.getDOMSlot(e).withElement(t).withAfter(t.querySelector("colgroup"))}createDOM(e,t){const n=document.createElement("table");this.__style&&(n.style.cssText=this.__style);const r=document.createElement("colgroup");if(n.appendChild(r),function(e){e.__lexicalUnmanaged=!0}(r),js(n,e.theme.table),this.updateTableElement(null,n,e),jc(t)){const t=document.createElement("div"),r=e.theme.tableScrollableWrapper;return r?js(t,r):t.style.cssText="overflow-x: auto;",t.appendChild(n),this.updateTableWrapper(null,t,n,e),t}return n}updateTableWrapper(e,t,n,r){this.__frozenColumnCount!==(e?e.__frozenColumnCount:0)&&function(e,t,n,r){r>0?(js(e,n.theme.tableFrozenColumn),t.setAttribute("data-lexical-frozen-column","true")):(Ys(e,n.theme.tableFrozenColumn),t.removeAttribute("data-lexical-frozen-column"))}(t,n,r,this.__frozenColumnCount),this.__frozenRowCount!==(e?e.__frozenRowCount:0)&&function(e,t,n,r){r>0?(js(e,n.theme.tableFrozenRow),t.setAttribute("data-lexical-frozen-row","true")):(Ys(e,n.theme.tableFrozenRow),t.removeAttribute("data-lexical-frozen-row"))}(t,n,r,this.__frozenRowCount)}updateTableElement(e,t,n){this.__style!==(e?e.__style:"")&&(t.style.cssText=this.__style),this.__rowStriping!==(!!e&&e.__rowStriping)&&function(e,t,n){n?(js(e,t.theme.tableRowStriping),e.setAttribute("data-lexical-row-striping","true")):(Ys(e,t.theme.tableRowStriping),e.removeAttribute("data-lexical-row-striping"))}(t,n,this.__rowStriping),function(e,t,n,r){const o=e.querySelector("colgroup");if(!o)return;const i=[];for(let e=0;e<n;e++){const t=document.createElement("col"),n=r&&r[e];n&&(t.style.width=`${n}px`),i.push(t)}o.replaceChildren(...i)}(t,0,this.getColumnCount(),this.getColWidths()),Hc(t,n,this.getFormatType())}updateDOM(e,t,n){const r=this.getDOMSlot(t).element;return t===r===jc()||(yi(o=t)&&"DIV"===o.nodeName&&this.updateTableWrapper(e,t,r,n),this.updateTableElement(e,r,n),!1);var o}exportDOM(e){const t=super.exportDOM(e),{element:n}=t;return{after:n=>{if(t.after&&(n=t.after(n)),!fc(n)&&yi(n)&&(n=n.querySelector("table")),!fc(n))return null;Hc(n,e._config,this.getFormatType());const[r]=nc(this,null,null),o=new Map;for(const e of r)for(const t of e){const e=t.cell.getKey();o.has(e)||o.set(e,{colSpan:t.cell.getColSpan(),startColumn:t.startColumn})}const i=new Set;for(const e of n.querySelectorAll(":scope > tr > [data-temporary-table-cell-lexical-key]")){const t=e.getAttribute("data-temporary-table-cell-lexical-key");if(t){const n=o.get(t);if(e.removeAttribute("data-temporary-table-cell-lexical-key"),n){o.delete(t);for(let e=0;e<n.colSpan;e++)i.add(e+n.startColumn)}}}const s=n.querySelector(":scope > colgroup");if(s){const e=Array.from(n.querySelectorAll(":scope > colgroup > col")).filter(((e,t)=>i.has(t)));s.replaceChildren(...e)}const l=n.querySelectorAll(":scope > tr");if(l.length>0){const e=document.createElement("tbody");for(const t of l)e.appendChild(t);n.append(e)}return n},element:!fc(n)&&yi(n)?n.querySelector("table"):n}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(e,t){const{rows:n,domRows:r}=t;for(let t=0;t<n;t++){const n=r[t];if(null!=n)for(let r=0;r<n.length;r++){const o=n[r];if(null==o)continue;const{elem:i}=o,s=Uc(this,i);if(null!==s&&e.is(s))return{x:r,y:t}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(e,t,n){const{domRows:r}=n,o=r[t];if(null==o)return null;const i=o[e<o.length?e:o.length-1];return null==i?null:i}getDOMCellFromCordsOrThrow(e,t,n){const r=this.getDOMCellFromCords(e,t,n);if(!r)throw new Error("Cell not found at cords.");return r}getCellNodeFromCords(e,t,n){const r=this.getDOMCellFromCords(e,t,n);if(null==r)return null;const o=Fo(r.elem);return La(o)?o:null}getCellNodeFromCordsOrThrow(e,t,n){const r=this.getCellNodeFromCords(e,t,n);if(!r)throw new Error("Node at cords not TableCellNode.");return r}getRowStriping(){return Boolean(this.getLatest().__rowStriping)}setRowStriping(e){const t=this.getWritable();return t.__rowStriping=e,t}setFrozenColumns(e){const t=this.getWritable();return t.__frozenColumnCount=e,t}getFrozenColumns(){return this.getLatest().__frozenColumnCount}setFrozenRows(e){const t=this.getWritable();return t.__frozenRowCount=e,t}getFrozenRows(){return this.getLatest().__frozenRowCount}canSelectBefore(){return!0}canIndent(){return!1}getColumnCount(){const e=this.getFirstChild();if(!e)return 0;let t=0;return e.getChildren().forEach((e=>{La(e)&&(t+=e.getColSpan())})),t}}function Vc(e){const t=Gc();e.hasAttribute("data-lexical-row-striping")&&t.setRowStriping(!0),e.hasAttribute("data-lexical-frozen-column")&&t.setFrozenColumns(1),e.hasAttribute("data-lexical-frozen-row")&&t.setFrozenRows(1);const n=e.querySelector(":scope > colgroup");if(n){let e=[];for(const t of n.querySelectorAll(":scope > col")){let n=t.style.width||"";if(!Aa.test(n)&&(n=t.getAttribute("width")||"",!/^\d+$/.test(n))){e=void 0;break}e.push(parseFloat(n))}e&&t.setColWidths(e)}return{after:e=>Zs(e,Ba),node:t}}function Gc(){return gi(new Yc)}function qc(e){return e instanceof Yc}const Zc=new Set(["http:","https:","mailto:","sms:","tel:"]);class Xc extends Mr{__url;__target;__rel;__title;static getType(){return"link"}static clone(e){return new Xc(e.__url,{rel:e.__rel,target:e.__target,title:e.__title},e.__key)}constructor(e="",t={},n){super(n);const{target:r=null,rel:o=null,title:i=null}=t;this.__url=e,this.__target=r,this.__rel=o,this.__title=i}createDOM(e){const t=document.createElement("a");return this.updateLinkDOM(null,t,e),js(t,e.theme.link),t}updateLinkDOM(e,t,n){if(_i(t)){e&&e.__url===this.__url||(t.href=this.sanitizeUrl(this.__url));for(const n of["target","rel","title"]){const r=`__${n}`,o=this[r];e&&e[r]===o||(o?t[n]=o:t.removeAttribute(n))}}}updateDOM(e,t,n){return this.updateLinkDOM(e,t,n),!1}static importDOM(){return{a:e=>({conversion:Qc,priority:1})}}static importJSON(e){return eu().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setURL(e.url).setRel(e.rel||null).setTarget(e.target||null).setTitle(e.title||null)}sanitizeUrl(e){e=lu(e);try{const t=new URL(lu(e));if(!Zc.has(t.protocol))return"about:blank"}catch(t){return e}return e}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(e){const t=this.getWritable();return t.__url=e,t}getTarget(){return this.getLatest().__target}setTarget(e){const t=this.getWritable();return t.__target=e,t}getRel(){return this.getLatest().__rel}setRel(e){const t=this.getWritable();return t.__rel=e,t}getTitle(){return this.getLatest().__title}setTitle(e){const t=this.getWritable();return t.__title=e,t}insertNewAfter(e,t=!0){const n=eu(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(n,t),n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(e,t,n){if(!Dn(t))return!1;const r=t.anchor.getNode(),o=t.focus.getNode();return this.isParentOf(r)&&this.isParentOf(o)&&t.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function Qc(e){let t=null;if(_i(e)){const n=e.textContent;(null!==n&&""!==n||e.children.length>0)&&(t=eu(e.getAttribute("href")||"",{rel:e.getAttribute("rel"),target:e.getAttribute("target"),title:e.getAttribute("title")}))}return{node:t}}function eu(e="",t){return gi(new Xc(e,t))}function tu(e){return e instanceof Xc}class nu extends Xc{__isUnlinked;constructor(e="",t={},n){super(e,t,n),this.__isUnlinked=void 0!==t.isUnlinked&&null!==t.isUnlinked&&t.isUnlinked}static getType(){return"autolink"}static clone(e){return new nu(e.__url,{isUnlinked:e.__isUnlinked,rel:e.__rel,target:e.__target,title:e.__title},e.__key)}getIsUnlinked(){return this.__isUnlinked}setIsUnlinked(e){const t=this.getWritable();return t.__isUnlinked=e,t}createDOM(e){return this.__isUnlinked?document.createElement("span"):super.createDOM(e)}updateDOM(e,t,n){return super.updateDOM(e,t,n)||e.__isUnlinked!==this.__isUnlinked}static importJSON(e){return ru().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setIsUnlinked(e.isUnlinked||!1)}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),isUnlinked:this.__isUnlinked}}insertNewAfter(e,t=!0){const n=this.getParentOrThrow().insertNewAfter(e,t);if(Lr(n)){const e=ru(this.__url,{isUnlinked:this.__isUnlinked,rel:this.__rel,target:this.__target,title:this.__title});return n.append(e),e}return null}}function ru(e="",t){return gi(new nu(e,t))}function ou(e){return e instanceof nu}function iu(e,t){if("element"===e.type){const n=e.getNode();return Lr(n)||function(e,...t){const n=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",e);for(const e of t)r.append("v",e);throw n.search=r.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(252),n.getChildren()[e.offset+t]||null}return null}const su=/^\+?[0-9\s()-]{5,}$/;function lu(e){return e.match(/^[a-z][a-z0-9+.-]*:/i)||e.match(/^[/#.]/)?e:e.includes("@")?`mailto:${e}`:su.test(e)?`tel:${e}`:`https://${e}`}function au(e,t=!0){if(e)return!1;let n=Ro().getTextContent();return t&&(n=n.trim()),""===n}function cu(e,...t){const n=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",e);for(const e of t)r.append("v",e);throw n.search=r.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function uu(e,t){let n=Date.now(),r=0;return(o,i,s,l,a,c)=>{const u=Date.now();if(c.has(Jr))return r=0,n=u,2;const d=function(e,t,n,r,o){if(null===e||0===n.size&&0===r.size&&!o)return 0;const i=t._selection,s=e._selection;if(o)return 1;if(!(Dn(i)&&Dn(s)&&s.isCollapsed()&&i.isCollapsed()))return 0;const l=function(e,t,n){const r=e._nodeMap,o=[];for(const e of t){const t=r.get(e);void 0!==t&&o.push(t)}for(const[e,t]of n){if(!t)continue;const n=r.get(e);void 0===n||$r(n)||o.push(n)}return o}(t,n,r);if(0===l.length)return 0;if(l.length>1){const n=t._nodeMap,r=n.get(i.anchor.key),o=n.get(s.anchor.key);return r&&o&&!e._nodeMap.has(r.__key)&&Tn(r)&&1===r.__text.length&&1===i.anchor.offset?2:0}const a=l[0],c=e._nodeMap.get(a.__key);if(!Tn(c)||!Tn(a)||c.__mode!==a.__mode)return 0;const u=c.__text,d=a.__text;if(u===d)return 0;const g=i.anchor,f=s.anchor;if(g.key!==f.key||"text"!==g.type)return 0;const h=g.offset,p=f.offset,m=d.length-u.length;return 1===m&&p===h-1?2:-1===m&&p===h+1?3:-1===m&&p===h?4:0}(o,i,l,a,e.isComposing()),g=(()=>{const g=null===s||s.editor===e,f=c.has("history-push");if(!f&&g&&c.has(jr))return 0;if(null===o)return 1;const h=i._selection;if(!(l.size>0||a.size>0))return null!==h?0:2;const p="number"==typeof t?t:t.peek();return!1===f&&0!==d&&d===r&&u<n+p&&g||1===l.size&&function(e,t,n){const r=t._nodeMap.get(e),o=n._nodeMap.get(e),i=t._selection,s=n._selection;return!(Dn(i)&&Dn(s)&&"element"===i.anchor.type&&"element"===i.focus.type&&"text"===s.anchor.type&&"text"===s.focus.type||!Tn(r)||!Tn(o)||r.__parent!==o.__parent)&&JSON.stringify(t.read((()=>r.exportJSON())))===JSON.stringify(n.read((()=>o.exportJSON())))}(Array.from(l)[0],o,i)?0:1})();return n=u,r=d,g}}function du(e){e.undoStack=[],e.redoStack=[],e.current=null}return{get $(){return il},A:nu,B:ht,C:Il,D:ct,E:Qn,F:Zr,G:Ri,H:gt,I:Qr,J:4,K:eo,L:ut,M:ot,N:dt,O:0,P:function(e,t,n){const r=uu(e,n),o=Js(e.registerCommand(Ge,(()=>(function(e,t){const n=t.redoStack,r=t.undoStack;if(0!==r.length){const o=t.current,i=r.pop();null!==o&&(n.push(o),e.dispatchCommand(vt,!0)),0===r.length&&e.dispatchCommand(wt,!1),t.current=i||null,i&&i.editor.setEditorState(i.editorState,{tag:Jr})}}(e,t),!0)),0),e.registerCommand(qe,(()=>(function(e,t){const n=t.redoStack,r=t.undoStack;if(0!==n.length){const o=t.current;null!==o&&(r.push(o),e.dispatchCommand(wt,!0));const i=n.pop();0===n.length&&e.dispatchCommand(vt,!1),t.current=i||null,i&&i.editor.setEditorState(i.editorState,{tag:Jr})}}(e,t),!0)),0),e.registerCommand(Ct,(()=>(du(t),!1)),0),e.registerCommand(xt,(()=>(du(t),e.dispatchCommand(vt,!1),e.dispatchCommand(wt,!1),!0)),0),e.registerUpdateListener((({editorState:n,prevEditorState:o,dirtyLeaves:i,dirtyElements:s,tags:l})=>{const a=t.current,c=t.redoStack,u=t.undoStack,d=null===a?null:a.editorState;if(null!==a&&n===d)return;const g=r(o,n,a,i,s,l);if(1===g)0!==c.length&&(t.redoStack=[],e.dispatchCommand(vt,!1)),null!==a&&(u.push({...a}),e.dispatchCommand(wt,!0));else if(2===g)return;t.current={editor:e,editorState:n}})));return o},Q:function(){return{current:null,redoStack:[],undoStack:[]}},R:2,S:No,T:qn,U:function(e){const t=e.getType(),n=yr();if(n._readOnly){const e=Ni(n).get(t);return e?Array.from(e.values()):[]}const r=n._nodeMap,o=[];for(const[,n]of r)n instanceof e&&n.__type===t&&n.isAttached()&&o.push(n);return o},V:function(e){if(!au(e,!1))return!1;const t=Ro().getChildren(),n=t.length;if(n>1)return!1;for(let e=0;e<n;e++){const n=t[e];if(Kr(n))return!1;if(Lr(n)){if(!eo(n))return!1;if(0!==n.__indent)return!1;const t=n.getChildren(),r=t.length;for(let n=0;n<r;n++){if(!Tn(t[e]))return!1}}}return!0},W:mt,X:Tt,Y:Ie,Z:kn,_:ac,a:rt,a$:at,get a0(){return Sa},a1:on,get a2(){return hl},get a3(){return ya},a4:He,a5:function(e,t,n=Ls){if(null===e)return;const r=e.getStartEndPoints(),o=new Map;let i=null;if(r){const[e,t]=r;i=qn(),i.anchor.set(e.key,e.offset,e.type),i.focus.set(t.key,t.offset,t.type);const n=Ri(e.getNode(),vi),s=Ri(t.getNode(),vi);Lr(n)&&o.set(n.getKey(),n),Lr(s)&&o.set(s.getKey(),s)}for(const t of e.getNodes())if(Lr(t)&&vi(t))o.set(t.getKey(),t);else if(null===r){const e=Ri(t,vi);Lr(e)&&o.set(e.getKey(),e)}for(const[e,r]of o){const o=t();n(r,o),r.replace(o,!0),i&&(e===i.anchor.key&&i.anchor.set(o.getKey(),i.anchor.offset,i.anchor.type),e===i.focus.key&&i.focus.set(o.getKey(),i.focus.offset,i.focus.type))}i&&e.is(Qn())&&Lo(i)},a6:function(e){return e instanceof ya},a7:ba,a8:sl,a9:qc,aA:function(){const e=Qn();Dn(e)||ac(e)||Ia(188);const t=e.anchor.getNode(),n=e.focus.getNode(),[r,,o]=rc(t),[i]=rc(n),[s,l,a]=tc(o,r,i),{startColumn:c}=l,{startRow:u,startColumn:d}=a,g=Math.min(c,d),f=Math.max(c+r.__colSpan-1,d+i.__colSpan-1),h=f-g+1;if(s[0].length===f-g+1)return o.selectPrevious(),void o.remove();const p=s.length;for(let e=0;e<p;e++)for(let t=g;t<=f;t++){const{cell:n,startColumn:r}=s[e][t];if(r<g){if(t===g){const e=g-r;n.setColSpan(n.__colSpan-Math.min(h,n.__colSpan-e))}}else if(r+n.__colSpan-1>f){if(t===f){const e=f-r+1;n.setColSpan(n.__colSpan-e)}}else n.remove()}const m=s[u],_=c>d?m[c+r.__colSpan]:m[d+i.__colSpan];if(void 0!==_){const{cell:e}=_;qa(e)}else{const e=d<c?m[d-1]:m[c-1],{cell:t}=e;qa(t)}const y=o.getColWidths();if(y){const e=[...y];e.splice(g,h),o.setColWidths(e)}},get aB(){return Pl},aC:zr,aD:function(e,t={}){let n;if(e&&"object"==typeof e){const{url:r,...o}=e;n=r,t={...o,...t}}else n=e;const{target:r,title:o}=t,i=void 0===t.rel?"noreferrer":t.rel,s=Qn();if(null===s||!Dn(s)&&!Kn(s))return;if(Kn(s)){const e=s.getNodes();if(0===e.length)return;return void e.forEach((e=>{if(null===n){const t=Ri(e,(e=>!ou(e)&&tu(e)));t&&(t.insertBefore(e),0===t.getChildren().length&&t.remove())}else{const t=Ri(e,(e=>!ou(e)&&tu(e)));if(t)t.setURL(n),void 0!==r&&t.setTarget(r),void 0!==i&&t.setRel(i);else{const t=eu(n,{rel:i,target:r});e.insertBefore(t),t.append(e)}}}))}const l=s.extract();if(null===n)return void l.forEach((e=>{const t=Ri(e,(e=>!ou(e)&&tu(e)));if(t){const e=t.getChildren();for(let n=0;n<e.length;n++)t.insertBefore(e[n]);t.remove()}}));const a=new Set,c=e=>{a.has(e.getKey())||(a.add(e.getKey()),e.setURL(n),void 0!==r&&e.setTarget(r),void 0!==i&&e.setRel(i),void 0!==o&&e.setTitle(o))};if(1===l.length){const e=l[0],t=Ri(e,tu);if(null!==t)return c(t)}!function(e){const t=Qn();if(!Dn(t))return e();const n=te(t),r=n.isBackward(),o=iu(n.anchor,r?-1:0),i=iu(n.focus,r?0:-1);if(e(),o||i){const e=Qn();if(Dn(e)){const t=e.clone();if(o){const e=o.getParent();e&&t.anchor.set(e.getKey(),o.getIndexWithinParent()+(r?1:0),"element")}if(i){const e=i.getParent();e&&t.focus.set(e.getKey(),i.getIndexWithinParent()+(r?0:1),"element")}Lo(te(t))}}}((()=>{let e=null;for(const t of l){if(!t.isAttached())continue;const s=Ri(t,tu);if(s){c(s);continue}if(Lr(t)){if(!t.isInline())continue;if(tu(t)){if(!(ou(t)||null!==e&&e.getParentOrThrow().isParentOf(t))){c(t),e=t;continue}for(const e of t.getChildren())t.insertBefore(e);t.remove();continue}}const l=t.getPreviousSibling();tu(l)&&l.is(e)?l.append(t):(e=eu(n,{rel:i,target:r,title:o}),t.insertAfter(e),e.append(t))}}))},aE:jl,aF:Hl,aG:function(){const e=Qn();if(!Dn(e)||!e.isCollapsed())return!1;const t=e.anchor.getNode();if(!Dl(t)||0!==t.getChildrenSize())return!1;const n=bl(t),r=t.getParent();Ul(r)||yl(40);const o=r.getParent();let i;if(ui(o))i=Qr(),n.insertAfter(i);else{if(!Dl(o))return!1;i=Ll(),o.insertAfter(i)}i.setTextStyle(e.style).setTextFormat(e.format).select();const s=t.getNextSiblings();if(s.length>0){const e=Wl(r.getListType());if(Dl(i)){const t=Ll();t.append(e),i.insertAfter(t)}else i.insertAfter(e);e.append(...s)}return function(e){let t=e;for(;null==t.getNextSibling()&&null==t.getPreviousSibling();){const e=t.getParent();if(null==e||!Dl(e)&&!Ul(e))break;t=e}t.remove()}(t),!0},aH:El,aI:wl,aJ:Jl,aK:function(e){e.update((()=>El()))},aL:function(e,t){e.update((()=>wl(t)))},aM:kt,aN:xt,aO:au,aP:Ir,aQ:gi,aR:ka,aS:na,aT:Yl,aU:Vn,aV:Kr,aW:function(e){ms(Vi(e,"next")).splice(1,e.getChildren())},aX:Dl,aY:lt,aZ:Kn,a_:Zn,aa:wa,ab:function(e){return e instanceof Sa},ac:et,ad:Xe,ae:st,af:Gs,ag:function(e){if("text"===e.type)return e.offset===e.getNode().getTextContentSize();const t=e.getNode();return Lr(t)||function(e,...t){const n=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",e);for(const e of t)r.append("v",e);throw n.search=r.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(177),e.offset===t.getChildrenSize()},ah:tu,ai:Da,aj:Ka,ak:Oa,al:Fa,am:function(e){const t=Ri(e,(e=>La(e)));return La(t)?t:null},an:ja,ao:function(e){return Ja(e).getChildren().findIndex((t=>t.is(e)))},ap:Ja,aq:La,ar:3,as:function(e,t,n=!0){const r=Gc();for(let o=0;o<e;o++){const e=$a();for(let r=0;r<t;r++){let t=Fa.NO_STATUS;"object"==typeof n?(0===o&&n.rows&&(t|=Fa.ROW),0===r&&n.columns&&(t|=Fa.COLUMN)):n&&(0===o&&(t|=Fa.ROW),0===r&&(t|=Fa.COLUMN));const i=Ma(t),s=Qr();s.append(kn()),i.append(s),e.append(i)}r.append(e)}return r},at:function(e){const t=Qn()||er();let n;if(Dn(t))n=ds(t.focus,"next");else{if(null!=t){const e=t.getNodes(),r=e[e.length-1];r&&(n=Vi(r,"next"))}n=n||Xi(Ro(),"previous").getFlipped().insert(Qr())}const r=function(e,t,n){let r=xs(t,"next");for(let e=r;e;e=Ts(e,n))r=e;return Wi(r)&&Bs(283),r.insert(e.isInline()?Qr().append(e):e),xs(Vi(e.getLatest(),"next"),t.direction)}(e,n),o=Qi(r);return fs(rs(Hi(o)?Ss(o):r)),e.getLatest()},au:function(e,t,n,r){const o=n.getRootElement(),i=pc(n);null!==o&&null!==i||Ia(246);const s=new dc(n,e.getKey()),l=hc(e,t);!function(e,t){null!==Sc(e)&&Ia(205),e[gc]=t}(l,s),s.listenersToRemove.add((()=>function(e,t){Sc(e)===t&&delete e[gc]}(l,s)));const a=t=>{if(s.pointerType=t.pointerType,0!==t.button||!bi(t.target)||!i)return;const r=Cc(t.target);null!==r&&n.update((()=>{const n=er();if(Ha&&t.shiftKey&&Oc(n,e)&&(Dn(n)||ac(n))){const o=n.anchor.getNode(),i=mc(e,n.anchor.getNode());i?(s.$setAnchorCellForSelection(Wc(s,i)),s.$setFocusCellForSelection(r),zc(t)):(e.isBefore(o)?e.selectStart():e.selectEnd()).anchor.set(n.anchor.key,n.anchor.offset,n.anchor.type)}else"touch"!==t.pointerType&&s.$setAnchorCellForSelection(r)})),(()=>{if(s.isSelecting)return;const e=()=>{s.isSelecting=!1,i.removeEventListener("pointerup",e),i.removeEventListener("pointermove",t)},t=r=>{if(!(e=>!(1&~e.buttons))(r)&&s.isSelecting)return s.isSelecting=!1,i.removeEventListener("pointerup",e),void i.removeEventListener("pointermove",t);if(!bi(r.target))return;let o=null;const a=!(Ha||l.contains(r.target));if(a)o=xc(l,r.target);else for(const e of document.elementsFromPoint(r.clientX,r.clientY))if(o=xc(l,e),o)break;!o||null!==s.focusCell&&o.elem===s.focusCell.elem||(s.setNextFocus({focusCell:o,override:a}),n.dispatchCommand(Ie,void 0))};s.isSelecting=!0,i.addEventListener("pointerup",e,s.listenerOptions),i.addEventListener("pointermove",t,s.listenerOptions)})()};l.addEventListener("pointerdown",a,s.listenerOptions),s.listenersToRemove.add((()=>{l.removeEventListener("pointerdown",a)}));const c=e=>{e.detail>=3&&bi(e.target)&&null!==Cc(e.target)&&e.preventDefault()};l.addEventListener("mousedown",c,s.listenerOptions),s.listenersToRemove.add((()=>{l.removeEventListener("mousedown",c)}));const u=e=>{const t=e.target;0===e.button&&bi(t)&&n.update((()=>{const e=Qn();ac(e)&&e.tableKey===s.tableNodeKey&&o.contains(t)&&s.$clearHighlight()}))};i.addEventListener("pointerdown",u,s.listenerOptions),s.listenersToRemove.add((()=>{i.removeEventListener("pointerdown",u)}));for(const[t,r]of _c)s.listenersToRemove.add(n.registerCommand(t,(t=>Kc(n,t,r,e,s)),3));s.listenersToRemove.add(n.registerCommand(lt,(t=>{const n=Qn();if(ac(n)){const r=mc(e,n.focus.getNode());if(null!==r)return zc(t),r.selectEnd(),!0}return!1}),3));const d=t=>()=>{const n=Qn();if(!Oc(n,e))return!1;if(ac(n))return s.$clearText(),!0;if(Dn(n)){if(!La(mc(e,n.anchor.getNode())))return!1;const r=n.anchor.getNode(),o=n.focus.getNode(),i=e.isParentOf(r),l=e.isParentOf(o);if(i&&!l||l&&!i)return s.$clearText(),!0;const a=Ri(n.anchor.getNode(),(e=>Lr(e))),c=a&&Ri(a,(e=>Lr(e)&&La(e.getParent())));if(!Lr(c)||!Lr(a))return!1;if(t===Ye&&null===c.getPreviousSibling())return!0}return!1};for(const e of yc)s.listenersToRemove.add(n.registerCommand(e,d(e),4));const g=t=>{const n=Qn();if(!ac(n)&&!Dn(n))return!1;const r=e.isParentOf(n.anchor.getNode());if(r!==e.isParentOf(n.focus.getNode())){const t=r?"anchor":"focus",o=r?"focus":"anchor",{key:i,offset:s,type:l}=n[o];return e[n[t].isBefore(n[o])?"selectPrevious":"selectNext"]()[o].set(i,s,l),!1}return!!Oc(n,e)&&!!ac(n)&&(t&&(t.preventDefault(),t.stopPropagation()),s.$clearText(),!0)};for(const e of bc)s.listenersToRemove.add(n.registerCommand(e,g,4));return s.listenersToRemove.add(n.registerCommand(bt,(e=>{const t=Qn();if(t){if(!ac(t)&&!Dn(t))return!1;oa(n,qs(e,ClipboardEvent)?e:null,la(t));const r=g(e);return Dn(t)?(t.removeText(),!0):r}return!1}),4)),s.listenersToRemove.add(n.registerCommand(Ve,(t=>{const n=Qn();if(!Oc(n,e))return!1;if(ac(n))return s.$formatCells(t),!0;if(Dn(n)){const e=Ri(n.anchor.getNode(),(e=>La(e)));if(!La(e))return!1}return!1}),4)),s.listenersToRemove.add(n.registerCommand(ht,(t=>{const n=Qn();if(!ac(n)||!Oc(n,e))return!1;const r=n.anchor.getNode(),o=n.focus.getNode();if(!La(r)||!La(o))return!1;if(function(e,t){if(ac(e)){const n=e.anchor.getNode(),r=e.focus.getNode();if(t&&n&&r){const[e]=tc(t,n,r);return n.getKey()===e[0][0].cell.getKey()&&r.getKey()===e[e.length-1].at(-1).cell.getKey()}}return!1}(n,e))return e.setFormat(t),!0;const[i,s,l]=tc(e,r,o),a=Math.max(s.startRow+s.cell.__rowSpan-1,l.startRow+l.cell.__rowSpan-1),c=Math.max(s.startColumn+s.cell.__colSpan-1,l.startColumn+l.cell.__colSpan-1),u=Math.min(s.startRow,l.startRow),d=Math.min(s.startColumn,l.startColumn),g=new Set;for(let e=u;e<=a;e++)for(let n=d;n<=c;n++){const r=i[e][n].cell;if(g.has(r))continue;g.add(r),r.setFormat(t);const o=r.getChildren();for(let e=0;e<o.length;e++){const n=o[e];Lr(n)&&!n.isInline()&&n.setFormat(t)}}return!0}),4)),s.listenersToRemove.add(n.registerCommand(Ue,(t=>{const r=Qn();if(!Oc(r,e))return!1;if(ac(r))return s.$clearHighlight(),!1;if(Dn(r)){const o=Ri(r.anchor.getNode(),(e=>La(e)));if(!La(o))return!1;if("string"==typeof t){const o=Bc(n,r,e);if(o)return $c(o,e,[kn(t)]),!0}}return!1}),4)),s.listenersToRemove.add(n.registerCommand(ct,(t=>{const n=Qn();if(!Dn(n)||!n.isCollapsed()||!Oc(n,e))return!1;const r=Lc(n.anchor.getNode());return!(null===r||!e.is(Dc(r))||(zc(t),function(e,t){const n="next"===t?"getNextSibling":"getPreviousSibling",r="next"===t?"getFirstChild":"getLastChild",o=e[n]();if(Lr(o))return o.selectEnd();const i=Ri(e,Ba);null===i&&Ia(247);for(let e=i[n]();Ba(e);e=e[n]()){const t=e[r]();if(Lr(t))return t.selectEnd()}const s=Ri(i,qc);null===s&&Ia(248),"next"===t?s.selectNext():s.selectPrevious()}(r,t.shiftKey?"previous":"next"),0))}),4)),s.listenersToRemove.add(n.registerCommand(kt,(t=>e.isSelected()),3)),s.listenersToRemove.add(n.registerCommand(Ke,((e,t)=>{if(n!==t)return!1;const{nodes:r,selection:o}=e,i=o.getStartEndPoints(),s=ac(o),l=Dn(o)&&null!==Ri(o.anchor.getNode(),(e=>La(e)))&&null!==Ri(o.focus.getNode(),(e=>La(e)))||s;if(1!==r.length||!qc(r[0])||!l||null===i)return!1;const[a,c]=i,[u,d,g]=rc(a),f=Ri(c.getNode(),(e=>La(e)));if(!(La(u)&&La(f)&&Ba(d)&&qc(g)))return!1;const h=r[0],[p,m,_]=tc(g,u,f),[y]=nc(h,null,null),b=p.length,S=b>0?p[0].length:0;let C=m.startRow,x=m.startColumn,v=y.length,w=v>0?y[0].length:0;if(s){const e=oc(p,m,_),t=e.maxRow-e.minRow+1,n=e.maxColumn-e.minColumn+1;C=e.minRow,x=e.minColumn,v=Math.min(v,t),w=Math.min(w,n)}let k=!1;const T=Math.min(b,C+v)-1,N=Math.min(S,x+w)-1,E=new Set;for(let e=C;e<=T;e++)for(let t=x;t<=N;t++){const n=p[e][t];E.has(n.cell.getKey())||1===n.cell.__rowSpan&&1===n.cell.__colSpan||(ec(n.cell),E.add(n.cell.getKey()),k=!0)}let[A]=nc(g.getWritable(),null,null);const F=v-b+C;for(let e=0;e<F;e++)Va(A[b-1][0].cell);const O=w-S+x;for(let e=0;e<O;e++)Ga(A[0][S-1].cell,!0,!1);[A]=nc(g.getWritable(),null,null);for(let e=C;e<C+v;e++)for(let t=x;t<x+w;t++){const n=e-C,r=t-x,o=y[n][r];if(o.startRow!==n||o.startColumn!==r)continue;const i=o.cell;if(1!==i.__rowSpan||1!==i.__colSpan){const n=[],r=Math.min(e+i.__rowSpan,C+v)-1,o=Math.min(t+i.__colSpan,x+w)-1;for(let i=e;i<=r;i++)for(let e=t;e<=o;e++){const t=A[i][e];n.push(t.cell)}Xa(n),k=!0}const{cell:s}=A[e][t],l=s.getChildren();i.getChildren().forEach((e=>{Tn(e)?(Qr().append(e),s.append(e)):s.append(e)})),l.forEach((e=>e.remove()))}if(s&&k){const[e]=nc(g.getWritable(),null,null);e[m.startRow][m.startColumn].cell.selectEnd()}return!0}),4)),s.listenersToRemove.add(n.registerCommand(Ie,(()=>{const t=Qn(),r=er(),o=s.getAndClearNextFocus();if(null!==o){const{focusCell:n}=o;if(ac(t)&&t.tableKey===s.tableNodeKey)return(n.x!==s.focusX||n.y!==s.focusY)&&(s.$setFocusCellForSelection(n),!0);if(n!==s.anchorCell&&Oc(t,e))return s.$setFocusCellForSelection(n),!0}if(s.getAndClearShouldCheckSelection()&&Dn(r)&&Dn(t)&&t.isCollapsed()){const n=t.anchor.getNode(),r=e.getFirstChild(),o=Lc(n);if(null!==o&&Ba(r)){const t=r.getFirstChild();if(La(t)&&e.is(Ri(o,(n=>n.is(e)||n.is(t)))))return t.selectStart(),!0}}if(Dn(t)){const{anchor:o,focus:i}=t,l=o.getNode(),a=i.getNode(),c=Lc(l),u=Lc(a),d=!(!c||!e.is(Dc(c))),g=!(!u||!e.is(Dc(u))),f=d!==g,h=d&&g,p=t.isBackward();if(f){const r=t.clone();if(g){const[t]=tc(e,u,u),n=t[0][0].cell,o=t[t.length-1].at(-1).cell;r.focus.set(p?n.getKey():o.getKey(),p?n.getChildrenSize():o.getChildrenSize(),"element")}else if(d){const[t]=tc(e,c,c),n=t[0][0].cell,o=t[t.length-1].at(-1).cell;r.anchor.set(p?o.getKey():n.getKey(),p?o.getChildrenSize():0,"element")}Lo(r),Tc(n,s)}else if(h&&(c.is(u)||(s.$setAnchorCellForSelection(Wc(s,c)),s.$setFocusCellForSelection(Wc(s,u),!0)),"touch"===s.pointerType&&s.isSelecting&&t.isCollapsed()&&Dn(r)&&r.isCollapsed())){const e=Lc(r.anchor.getNode());e&&!e.is(u)&&(s.$setAnchorCellForSelection(Wc(s,e)),s.$setFocusCellForSelection(Wc(s,u),!0),s.pointerType=null)}}else if(t&&ac(t)&&t.is(r)&&t.tableKey===e.getKey()){const r=mi(i);if(r&&r.anchorNode&&r.focusNode){const o=Fo(r.focusNode),i=o&&!e.isParentOf(o),s=Fo(r.anchorNode),l=s&&e.isParentOf(s);if(i&&l&&r.rangeCount>0){const o=function(e,t){return Xn(null,e,t,null)}(r,n);o&&(o.anchor.set(e.getKey(),t.isBackward()?e.getChildrenSize():0,"element"),r.removeAllRanges(),Lo(o))}}}return t&&!t.is(r)&&(ac(t)||ac(r))&&s.tableSelection&&!s.tableSelection.is(r)?(ac(t)&&t.tableKey===s.tableNodeKey?s.$updateTableTableSelection(t):!ac(t)&&ac(r)&&r.tableKey===s.tableNodeKey&&s.$updateTableTableSelection(null),!1):(s.hasHijackedSelectionStyles&&!e.isSelected()?function(e,t){t.$enableHighlightStyle(),kc(t.table,(t=>{const n=t.elem;t.highlighted=!1,Mc(e,t),n.getAttribute("style")||n.removeAttribute("style")}))}(n,s):!s.hasHijackedSelectionStyles&&e.isSelected()&&Tc(n,s),!1)}),4)),s.listenersToRemove.add(n.registerCommand(We,(()=>{const t=Qn();if(!Dn(t)||!t.isCollapsed()||!Oc(t,e))return!1;const r=Bc(n,t,e);return!!r&&($c(r,e),!0)}),4)),s},av:Fo,aw:function(e){const t=Ja(e);return ja(t).getChildren().findIndex((e=>e.is(t)))},ax:function(e=!0){const t=Qn();Dn(t)||ac(t)||Ia(188);const n=t.anchor.getNode(),r=t.focus.getNode(),[o]=rc(n),[i,,s]=rc(r),[,l,a]=tc(s,i,o),{startRow:c}=a,{startRow:u}=l;return e?Va(c+o.__rowSpan>u+i.__rowSpan?o:i,!0):Va(u<c?i:o,!1)},ay:function(){const e=Qn();Dn(e)||ac(e)||Ia(188);const[t,n]=e.isBackward()?[e.focus.getNode(),e.anchor.getNode()]:[e.anchor.getNode(),e.focus.getNode()],[r,,o]=rc(t),[i]=rc(n),[s,l,a]=tc(o,r,i),{startRow:c}=l,{startRow:u}=a,d=u+i.__rowSpan-1;if(s.length===d-c+1)return void o.remove();const g=s[0].length,f=s[d+1],h=o.getChildAtIndex(d+1);for(let e=d;e>=c;e--){for(let t=g-1;t>=0;t--){const{cell:n,startRow:r,startColumn:o}=s[e][t];if(o===t){if(r<c||r+n.__rowSpan-1>d){const e=Math.max(r,c),t=Math.min(n.__rowSpan+r-1,d),o=e<=t?t-e+1:0;n.setRowSpan(n.__rowSpan-o)}if(r>=c&&r+n.__rowSpan-1>d&&e===d){null===h&&Ia(122);let r=null;for(let n=0;n<t;n++){const t=f[n],o=t.cell;t.startRow===e+1&&(r=o),o.__colSpan>1&&(n+=o.__colSpan-1)}null===r?Za(h,n):r.insertAfter(n)}}}const t=o.getChildAtIndex(e);Ba(t)||Ia(206,String(e)),t.remove()}if(void 0!==f){const{cell:e}=f[0];qa(e)}else{const e=s[c-1],{cell:t}=e[0];qa(t)}},az:function(e=!0){const t=Qn();Dn(t)||ac(t)||Ia(188);const n=t.anchor.getNode(),r=t.focus.getNode(),[o]=rc(n),[i,,s]=rc(r),[,l,a]=tc(s,i,o),{startColumn:c}=a,{startColumn:u}=l;return e?Ga(c+o.__colSpan>u+i.__colSpan?o:i,!0):Ga(u<c?i:o,!1)},b:Ro,b0:jr,b1:Mr,b2:nt,b3:En,b4:Ll,b5:Wl,b6:ln,b7:Gc,b8:Ma,b9:$a,ba:function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e},c:Vl,d:function(e){const t=e||{},n=ur,r=t.theme||{},o=void 0===e?n:t.parentEditor||null,i=t.disableEvents||!1,s=Wr(),l=t.namespace||(null!==o?o._config.namespace:zo()),a=t.editorState,c=[zr,mn,on,En,Zr,qr,...t.nodes||[]],{onError:u,html:d}=t,g=void 0===t.editable||t.editable;let f;if(void 0===e&&null!==n)f=n._nodes;else{f=new Map;for(let e=0;e<c.length;e++){let t=c[e],n=null,r=null;if("function"!=typeof t){const e=t;t=e.replace,n=e.with,r=e.withKlass||null}const{ownNodeConfig:o}=Pi(t),i=t.getType(),s=t.transform(),l=new Set;o&&o.$transform&&l.add(o.$transform),null!==s&&l.add(s),f.set(i,{exportDOM:d&&d.export?d.export.get(t):void 0,klass:t,replace:n,replaceWithKlass:r,sharedNodeState:J(c[e]),transforms:l})}}const h=new no(s,o,f,{disableEvents:i,namespace:l,theme:r},u||console.error,function(e,t){const n=new Map,r=new Set,o=e=>{Object.keys(e).forEach((t=>{let r=n.get(t);void 0===r&&(r=[],n.set(t,r)),r.push(e[t])}))};return e.forEach((e=>{const t=e.klass.importDOM;if(null==t||r.has(t))return;r.add(t);const n=t.call(e.klass);null!==n&&o(n)})),t&&o(t),n}(f,d?d.import:void 0),g,e);return void 0!==a&&(h._pendingEditorState=a,h._dirtyType=2),h},e:function(e){return Js(e.registerCommand(ze,(e=>{const t=Qn();return!!Kn(t)&&(t.clear(),!0)}),0),e.registerCommand($e,(e=>{const t=Qn();return Dn(t)?(t.deleteCharacter(e),!0):!!Kn(t)&&(t.deleteNodes(),!0)}),0),e.registerCommand(je,(e=>{const t=Qn();return!!Dn(t)&&(t.deleteWord(e),!0)}),0),e.registerCommand(Ye,(e=>{const t=Qn();return!!Dn(t)&&(t.deleteLine(e),!0)}),0),e.registerCommand(Ue,(t=>{const n=Qn();if("string"==typeof t)null!==n&&n.insertText(t);else{if(null===n)return!1;const r=t.dataTransfer;if(null!=r)Ql(r,n,e);else if(Dn(n)){const e=t.data;return e&&n.insertText(e),!0}}return!0}),0),e.registerCommand(Je,(()=>{const e=Qn();return!!Dn(e)&&(e.removeText(),!0)}),0),e.registerCommand(Ve,(e=>{const t=Qn();return!!Dn(t)&&(t.formatText(e),!0)}),0),e.registerCommand(ht,(e=>{const t=Qn();if(!Dn(t)&&!Kn(t))return!1;const n=t.getNodes();for(const t of n){const n=Ri(t,(e=>Lr(e)&&!e.isInline()));null!==n&&n.setFormat(e)}return!0}),0),e.registerCommand(Be,(e=>{const t=Qn();return!!Dn(t)&&(t.insertLineBreak(e),!0)}),0),e.registerCommand(We,(()=>{const e=Qn();return!!Dn(e)&&(e.insertParagraph(),!0)}),0),e.registerCommand(ut,(()=>(function(e){let t=Qn()||er();null===t&&(t=Ro().selectEnd()),t.insertNodes(e)}([An()]),!0)),0),e.registerCommand(dt,(()=>Ta((e=>{const t=e.getIndent();e.setIndent(t+1)}))),0),e.registerCommand(gt,(()=>Ta((e=>{const t=e.getIndent();t>0&&e.setIndent(Math.max(0,t-1))}))),0),e.registerCommand(nt,(e=>{const t=Qn();if(Kn(t)){const e=t.getNodes();if(e.length>0)return e[0].selectPrevious(),!0}else if(Dn(t)){const n=Qo(t.focus,!0);if(!e.shiftKey&&Kr(n)&&!n.isIsolated()&&!n.isInline())return n.selectPrevious(),e.preventDefault(),!0}return!1}),0),e.registerCommand(rt,(e=>{const t=Qn();if(Kn(t)){const e=t.getNodes();if(e.length>0)return e[0].selectNext(0,0),!0}else if(Dn(t)){if(function(e){const t=e.focus;return"root"===t.key&&t.offset===Ro().getChildrenSize()}(t))return e.preventDefault(),!0;const n=Qo(t.focus,!1);if(!e.shiftKey&&Kr(n)&&!n.isIsolated()&&!n.isInline())return n.selectNext(),e.preventDefault(),!0}return!1}),0),e.registerCommand(et,(e=>{const t=Qn();if(Kn(t)){const n=t.getNodes();if(n.length>0)return e.preventDefault(),Ps(n[0])?n[0].selectNext(0,0):n[0].selectPrevious(),!0}if(!Dn(t))return!1;if(Ks(t,!0)){const n=e.shiftKey;return e.preventDefault(),$s(t,n,!0),!0}return!1}),0),e.registerCommand(Xe,(e=>{const t=Qn();if(Kn(t)){const n=t.getNodes();if(n.length>0)return e.preventDefault(),Ps(n[0])?n[0].selectPrevious():n[0].selectNext(0,0),!0}if(!Dn(t))return!1;const n=e.shiftKey;return!!Ks(t,!1)&&(e.preventDefault(),$s(t,n,!1),!0)}),0),e.registerCommand(st,(t=>{if(Na(t.target))return!1;const n=Qn();if(Dn(n)){if(function(e){if(!e.isCollapsed())return!1;const{anchor:t}=e;if(0!==t.offset)return!1;const n=t.getNode();if($r(n))return!1;const r=function(e){const t=Ri(e,(e=>Lr(e)&&!e.isInline()));return Lr(t)||Bs(4,e.__key),t}(n);return r.getIndent()>0&&(r.is(n)||n.is(r.getFirstDescendant()))}(n))return t.preventDefault(),e.dispatchCommand(gt,void 0);if(ha&&"ko-KR"===navigator.language)return!1}else if(!Kn(n))return!1;return t.preventDefault(),e.dispatchCommand($e,!0)}),0),e.registerCommand(at,(t=>{if(Na(t.target))return!1;const n=Qn();return!(!Dn(n)&&!Kn(n))&&(t.preventDefault(),e.dispatchCommand($e,!1))}),0),e.registerCommand(ot,(t=>{const n=Qn();if(!Dn(n))return!1;if(Ea(n),null!==t){if((ha||fa||ma)&&ga)return!1;if(t.preventDefault(),t.shiftKey)return e.dispatchCommand(Be,!1)}return e.dispatchCommand(We,void 0)}),0),e.registerCommand(lt,(()=>!!Dn(Qn())&&(e.blur(),!0)),0),e.registerCommand(ft,(t=>{const[,n]=ka(t);if(n.length>0){const r=aa(t.clientX,t.clientY);if(null!==r){const{offset:t,node:o}=r,i=Fo(o);if(null!==i){const e=qn();if(Tn(i))e.anchor.set(i.getKey(),t,"text"),e.focus.set(i.getKey(),t,"text");else{const t=i.getParentOrThrow().getKey(),n=i.getIndexWithinParent()+1;e.anchor.set(t,n,"element"),e.focus.set(t,n,"element")}Lo(te(e))}e.dispatchCommand(_a,n)}return t.preventDefault(),!0}return!!Dn(Qn())}),0),e.registerCommand(pt,(e=>{const[t]=ka(e),n=Qn();return!(t&&!Dn(n))}),0),e.registerCommand(mt,(e=>{const[t]=ka(e),n=Qn();if(t&&!Dn(n))return!1;const r=aa(e.clientX,e.clientY);if(null!==r){Kr(Fo(r.node))&&e.preventDefault()}return!0}),0),e.registerCommand(St,(()=>(function(e){const t=Ro();if(Dn(e)){const t=e.anchor,n=e.focus,r=t.getNode().getTopLevelElementOrThrow().getParentOrThrow();return t.set(r.getKey(),0,"element"),n.set(r.getKey(),r.getChildrenSize(),"element"),te(e),e}{const e=t.select(0,t.getChildrenSize());Lo(te(e))}}(),!0)),0),e.registerCommand(yt,(t=>(oa(e,qs(t,ClipboardEvent)?t:null),!0)),0),e.registerCommand(bt,(t=>(async function(e,t){await oa(t,qs(e,ClipboardEvent)?e:null),t.update((()=>{const e=Qn();Dn(e)?e.removeText():Kn(e)&&e.getNodes().forEach((e=>e.remove()))}))}(t,e),!0)),0),e.registerCommand(He,(t=>{const[,n,r]=ka(t);return n.length>0&&!r?(e.dispatchCommand(_a,n),!0):(!bi(t.target)||!uo(t.target))&&(null!==Qn()&&(function(e,t){e.preventDefault(),t.update((()=>{const n=Qn(),r=qs(e,InputEvent)||qs(e,KeyboardEvent)?null:e.clipboardData;null!=r&&null!==n&&Ql(r,n,t)}),{tag:"paste"})}(t,e),!0))}),0),e.registerCommand(it,(e=>{const t=Qn();return Dn(t)&&Ea(t),!1}),0),e.registerCommand(ct,(e=>{const t=Qn();return Dn(t)&&Ea(t),!1}),0))},f:Be,g:Lr,h:We,i:Ve,j:mn,k:pt,l:Lo,get m(){return e},n:function(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){if(this instanceof e){var n=[null];return n.push.apply(n,arguments),new(Function.bind.apply(t,n))}return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})})),n},o:Xc,p:an,q:Ul,r:ll,s:1,t:Js,u:Dn,v:function(e,t,n,r){const o=e=>e instanceof n,i=e=>{const t=kn(e.getTextContent());t.setFormat(e.getFormat()),e.replace(t)};return[e.registerNodeTransform(mn,(e=>{if(!e.isSimpleText())return;let n,s=e.getPreviousSibling(),l=e.getTextContent(),a=e;if(Tn(s)){const n=s.getTextContent(),r=t(n+l);if(o(s)){if(null===r||0!==(e=>e.getLatest().__mode)(s))return void i(s);{const t=r.end-n.length;if(t>0){const r=n+l.slice(0,t);if(s.select(),s.setTextContent(r),t===l.length)e.remove();else{const n=l.slice(t);e.setTextContent(n)}return}}}else if(null===r||r.start<n.length)return}let c=0;for(;;){n=t(l);let e,u=null===n?"":l.slice(n.end);if(l=u,""===u){const e=a.getNextSibling();if(Tn(e)){u=a.getTextContent()+e.getTextContent();const n=t(u);if(null===n)return void(o(e)?i(e):e.markDirty());if(0!==n.start)return}}if(null===n)return;if(0===n.start&&Tn(s)&&s.isTextEntity()){c+=n.end;continue}0===n.start?[e,a]=a.splitText(n.end):[,e,a]=a.splitText(n.start+c,n.end+c),void 0===e&&cu(165,"nodeToReplace");const d=r(e);if(d.setFormat(e.getFormat()),e.replace(d),null==a)return;c=0,s=d}})),e.registerNodeTransform(n,(e=>{const n=e.getTextContent(),r=t(n);if(null===r||0!==r.start)return void i(e);if(n.length>r.end)return void e.splitText(r.end);const s=e.getPreviousSibling();Tn(s)&&s.isTextEntity()&&(i(s),i(e));const l=e.getNextSibling();Tn(l)&&l.isTextEntity()&&(i(l),o(e)&&i(e))}))]},w:Tn,x:$r,y:Yc,z:ft}}));

SML.dm("DFBfgTBypk",[],(async()=>{var e;!function(e){e.ListingBelow="listing-below",e.PostQuerySearch="post-query-search"}(e||(e={}));var t;!function(e){e.Related="related",e.Recent="recent"}(t||(t={}));return{get P(){return t},S:"variant_1",get a(){return e},b:"tabId",c:"variant_2"}}));

SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("DFh5Z0Dv0L",["Dw4vb8Yfbm"],(async a=>{const{svg:l}=a.a();return{s:a.m(l`<path d="M17.998 11.502a2.16 2.16 0 010-3.004l.134-.14a1.56 1.56 0 00.229-1.863L17.215 4.51a1.56 1.56 0 00-1.731-.734l-.19.047a2.157 2.157 0 01-2.598-1.502l-.052-.183a1.56 1.56 0 00-1.501-1.133h-2.29c-.698 0-1.31.463-1.502 1.134l-.051.18a2.161 2.161 0 01-2.603 1.504l-.185-.046a1.561 1.561 0 00-1.731.734L1.636 6.495a1.561 1.561 0 00.23 1.866l.13.135a2.162 2.162 0 010 3.007l-.132.137a1.56 1.56 0 00-.23 1.864l1.147 1.985a1.56 1.56 0 001.73.734l.186-.046A2.162 2.162 0 017.3 17.682l.05.179a1.561 1.561 0 001.502 1.134h2.29c.698 0 1.31-.463 1.502-1.134l.052-.182a2.159 2.159 0 012.6-1.503l.188.047a1.56 1.56 0 001.73-.734l1.146-1.984a1.561 1.561 0 00-.23-1.866l-.133-.137zm-8 .498c-1.103 0-2-.897-2-2s.897-2 2-2 2 .897 2 2-.897 2-2 2z"></path>`,"0 0 20 20","settings-fill")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("DG4aPYnXvr",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,t)=>{let r=class extends t.s{constructor(){super(...arguments),this.overlayId="",this._registered=!1}static get styles(){return[e.t,e.a0(":host {\n  position: relative;\n  z-index: 100;\n}\n")]}async connectedCallback(){super.connectedCallback(),this._registered||(this._registered=!0,await this.updateComplete,this.registerWithOverlayManager())}disconnectedCallback(){super.disconnectedCallback(),this._registered=!1,this.unregisterFromOverlayManager()}registerWithOverlayManager(){this.dispatchEvent(e.c("register-overlay-display",{display:this}))}unregisterFromOverlayManager(){this.dispatchEvent(e.c("unregister-overlay-display",{display:this}))}displayOverlay(e,t){this.overlayId=e,this.overlayProperties=t}renderTemplate(){if(!this.overlayId)return"";const t=this.querySelector(`template[slot=${this.overlayId}]`);return t instanceof HTMLTemplateElement?e.a1(t):""}dismissOverlay(){this.overlayId=""}render(){return this.renderTemplate()||""}};e._([e.n({type:String,attribute:"overlay-id"})],r.prototype,"overlayId",void 0),e._([e.n({type:Object})],r.prototype,"overlayProperties",void 0),r=e._([e.e("shreddit-overlay-display")],r)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");
SML.dm("DHw9yEcfFd",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6","BeFppRYbzE"],(async(e,t,o,i)=>{const a=new WeakSet;function n(e,t,o){e&&e.value&&(e.value[t]=o)}class s extends e.R{constructor(){super(...arguments),this.contentSlotRef=e.a3(),this.defaultSlotRef=e.a3(),this.hovercardBodyRef=e.a3(),this.popperRef=e.a3(),this.anchorElement=null,this.interactionController=new o.X(this,{isInteractedWith:e=>e.open,hoverDelayStart:t=>e.c4(getComputedStyle(t).getPropertyValue("--show-delay")),hoverDelayEnd:t=>e.c4(getComputedStyle(t).getPropertyValue("--hide-delay")),delayOpenOnFocus:!0}),this.placement=i.P.Top,this.disabled=!1,this.distance=4,this.open=!1,this.skidding=0,this.trigger="hover focus",this.hoist=!1,this.noAnimate=!1,this.arrow=!1,this.eventUsedMap=new WeakMap,this.handleDocumentKeyDown=e=>{"Escape"===e.key&&(e.stopPropagation(),this.hide(),this.defaultSlotRef.value&&this.focusFirstTabbableElement(this.defaultSlotRef.value))},this.handleDocumentClick=e=>{if(!(e.target instanceof HTMLElement)||this.hidden)return;this.eventUsedMap.has(e)||o.Y(this,e.target)||this.hide()},this.handleLegacyHovercardOpen=e=>{e.target!==this&&this.open&&this.hide()}}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("keydown",this.handleDocumentKeyDown),document.removeEventListener("click",this.handleDocumentClick),document.removeEventListener("faceplate-hovercard:open",this.handleLegacyHovercardOpen)}willUpdate(e){e.has("open")&&this.hasUpdated&&this.handleOpenChange(),e.has("disabled")&&this.handleDisabledChange(),(e.has("content")||e.has("distance")||e.has("hoist")||e.has("placement")||e.has("skidding"))&&this.handleOptionsChange()}firstUpdated(){this.hovercardBodyRef.value&&(this.hovercardBodyRef.value.hidden=!0),this.open&&this.popperRef.value&&this.handleOpenChange()}startInteraction(e,t){this.eventUsedMap.has(e)||(this.interactionController.interactionTrigger=t,this.eventUsedMap.set(e,!0),this.show())}finishInteraction(e){this.eventUsedMap.set(e,!0),this.hide()}focusFirstTabbableElement(t){const o=e.cR(t)[0];o&&"focus"in o&&"function"==typeof o.focus&&(o.addEventListener("focusin",(e=>{this.eventUsedMap.set(e,!0)}),{once:!0,capture:!0}),o.focus({preventScroll:!0}))}focusFirstTabbableBodyElement(e){return this.focusFirstTabbableElement(e)}async handleOpenChange(){if(!this.disabled&&this.contentSlotRef.value&&this.hovercardBodyRef.value&&this.popperRef.value)if(this.open){this.emitter.dispatch("show"),this.dispatchEvent(new CustomEvent("faceplate-hovercard:open",{bubbles:!0}));const t=(async(t,o="faceplate-partial")=>{const i=o.toLowerCase(),n=e.cQ((e=>e.tagName.toLowerCase()===i&&(e=>"loading"in e&&"load"in e&&"function"==typeof e?.load)(e)),t);return(await Promise.all(n.map((async e=>!e||a.has(e)||"programmatic"!==e.loading?Promise.resolve(!1):(a.add(e),e.load().then((()=>!0))))))).filter(Boolean).length>0})(this.contentSlotRef.value);document.addEventListener("keydown",this.handleDocumentKeyDown),document.addEventListener("click",this.handleDocumentClick),document.addEventListener("faceplate-hovercard:open",this.handleLegacyHovercardOpen),await e.c5(this.hovercardBodyRef.value),n(this.hovercardBodyRef,"hidden",!1),n(this.popperRef,"active",!0),this.updateAnchorElementAria();const{keyframes:o,options:i}=e.c6(this,"hovercard.show");await e.c7(this.popperRef.value?.popup,o,i),this.popperRef.value?.reposition(),await t,!this.hovercardBodyRef.value||"focus"!==this.interactionController.interactionTrigger&&"click"!==this.interactionController.interactionTrigger||this.focusFirstTabbableBodyElement(this.hovercardBodyRef.value),this.emitter.dispatch("after-show")}else{this.emitter.dispatch("hide"),document.removeEventListener("keydown",this.handleDocumentKeyDown),document.removeEventListener("click",this.handleDocumentClick),document.removeEventListener("faceplate-hovercard:open",this.handleLegacyHovercardOpen),await e.c5(this.hovercardBodyRef.value);const{keyframes:t,options:o}=e.c6(this,"hovercard.hide");await e.c7(this.popperRef.value?.popup,t,o),n(this.popperRef,"active",!1),n(this.hovercardBodyRef,"hidden",!0),this.updateAnchorElementAria(),this.emitter.dispatch("after-hide")}}async handleOptionsChange(){this.hasUpdated&&this.popperRef.value&&(await this.updateComplete,this.popperRef.value?.reposition())}handleAnchorSlotChange(){this.defaultSlotRef.value&&(this.anchorElement=e.cQ((e=>e instanceof HTMLButtonElement||e instanceof HTMLAnchorElement||["button","link","menuitem","tab","checkbox","combobox","gridcell","application","treeitem"].includes(e?.getAttribute("role")??"")),this.defaultSlotRef.value)[0]??null,this.updateAnchorElementAria())}updateAnchorElementAria(){this.anchorElement?.setAttribute("aria-haspopup","dialog"),this.anchorElement?.setAttribute("aria-expanded",this.open?"true":"false")}handleDisabledChange(){this.disabled&&this.open&&this.hide()}async show(){if(!this.open)return this.open=!0,e.c8(this,this.emitter.eventId("after-show"))}async hide(){if(this.open)return this.open=!1,e.c8(this,this.emitter.eventId("after-hide"))}render(){return t.x` <rpl-popper part="popper" exportparts="
          popup:popper--popup,
          arrow:popper--arrow
        " class="${e.Z({hovercard:!0,"hovercard--open":this.open})}" placement="${this.placement}" distance="${this.distance}" skidding="${this.skidding}" strategy="${this.hoist?"fixed":"absolute"}" flip shift safe-area ?arrow="${this.arrow}" @mouseenter="${this.interactionController.handleMouseEnter}" @mouseleave="${this.interactionController.handleMouseLeave}" @mousedown="${this.interactionController.handleMouseDown}" @mouseup="${this.interactionController.handleMouseUp}" @focusin="${this.interactionController.handleFocus}" @focusout="${this.interactionController.handleBlur}" @click="${e=>this.eventUsedMap.set(e,!0)}" ${e.a4(this.popperRef)}> <slot slot="anchor" aria-describedby="hovercard" @click="${this.interactionController.handleClick}" ${e.a4(this.defaultSlotRef)} @slotchange="${this.handleAnchorSlotChange}"></slot> <div part="body" id="hovercard" class="hovercard-body" role="dialog" aria-live="${this.open?"polite":"off"}" ${e.a4(this.hovercardBodyRef)}> <slot name="content" ${e.a4(this.contentSlotRef)}></slot> </div> </rpl-popper> `}}return e._([e.n()],s.prototype,"placement",void 0),e._([e.n({type:Boolean,reflect:!0})],s.prototype,"disabled",void 0),e._([e.n({type:Number})],s.prototype,"distance",void 0),e._([e.n({type:Boolean,reflect:!0})],s.prototype,"open",void 0),e._([e.n({type:Number})],s.prototype,"skidding",void 0),e._([e.n()],s.prototype,"trigger",void 0),e._([e.n({type:Boolean})],s.prototype,"hoist",void 0),e._([e.n({type:Boolean,attribute:"no-animate"})],s.prototype,"noAnimate",void 0),e._([e.n({type:Boolean})],s.prototype,"arrow",void 0),e.c3("hovercard.show",{keyframes:[{opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:150,easing:"ease"}}),e.c3("hovercard.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.8}],options:{duration:150,easing:"ease"}}),{H:s}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("DI4O_MlG8-",["Dw4vb8Yfbm"],(async s=>{const{svg:t}=s.a();return{s:s.m(t`<path d="M19.08 8.47C17.28 5.11 13.8 3.03 10 3.03S2.72 5.11.92 8.47c-.51.96-.51 2.1 0 3.06 1.8 3.36 5.28 5.44 9.08 5.44s7.28-2.09 9.08-5.44c.51-.96.51-2.1 0-3.06zM10 13.25c-1.79 0-3.25-1.46-3.25-3.25S8.21 6.75 10 6.75s3.25 1.46 3.25 3.25-1.46 3.25-3.25 3.25z"></path>`,"0 0 20 20","show-fill")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./Cy0QTNmAAP.js",import.meta.url,"Cy0QTNmAAP");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("DIddQxTrh3",["Dw4vb8Yfbm","B-zFJtiar6","Cy0QTNmAAP","5r73EsgItq"],(async(t,e,n,i)=>{let s=class extends t.R{constructor(){super(...arguments),this.isHovered=!1,this.hoverDelayStart=150,this.hoverDelayEnd=150,this.preventNextAnimations=!1,this.containerElement=null,this.contentsElement=null,this.expandButton=null,this.collapseButton=null,this.gridTransitionPromise=null,this.gridTransitioning=!1,this.trigger="hover",this.interactionController=new e.X(this,{hoverDelayStart:()=>this.hoverDelayStart,hoverDelayEnd:()=>this.hoverDelayEnd,isInteractedWith:t=>t.isHovered}),this.noAnimate=!1,this.parentGridSelector=".grid-container",this.hotkeysController=new t.cx(this),this.handleSlotChange=t=>{const e=document.getElementById(n.F.ContainerDiv),i=document.getElementById(n.F.ContentsDiv),s=document.getElementById(n.F.ExpandButton),a=document.getElementById(n.F.CollapseButton);i&&this.contentsElement!==i&&(this.contentsElement?.removeEventListener("mouseenter",this.interactionController.handleMouseEnter),i.addEventListener("mouseenter",this.interactionController.handleMouseEnter),this.contentsElement=i,this.isExpanded||(this.contentsVisibility=!1)),e&&this.containerElement!==e&&(this.containerElement=e),a&&a!==this.collapseButton&&(this.collapseButton?.removeEventListener("click",this.toggleState),this.collapseButton=a,a.addEventListener("click",this.toggleState)),s&&s!==this.expandButton&&(this.expandButton?.removeEventListener("click",this.toggleState),this.expandButton?.removeEventListener("keydown",this.handleExpandKeydown),this.expandButton=s,s.addEventListener("click",this.toggleState),s.addEventListener("mouseover",this.handleExpandButtonMouseOver),s.addEventListener("keydown",this.handleExpandKeydown))},this.handleExpandKeydown=async t=>{if("Tab"!==t.key)return;t.preventDefault();const e=document.querySelector("reddit-skip-to-sidebar")?.shadowRoot?.querySelector("a");if(e)return this.emitter.dispatch("focus-delegate",{detail:{el:e}}),e.focus();const n=document.getElementById("shreddit-skip-link");n instanceof HTMLElement&&(this.emitter.dispatch("focus-delegate",{detail:{el:n}}),n.focus())},this.handleExpandButtonMouseOver=t=>{this.isHovered?this.interactionController.handleMouseEnter(t):t.stopImmediatePropagation()},this.toggleStateViaHotkey=()=>{this.toggleState(void 0,{viaHotkey:!0})},this.toggleState=(e,i)=>{const s=document.querySelector(this.parentGridSelector);var a,l;void 0!==this.country&&void 0!==this.expanded&&s&&(this.emitTrackingEvent(this.isExpanded?"collapse":"expand",i),this.expanded=this.isExpanded?n.b.Collapsed:n.b.Expanded,s instanceof HTMLElement&&(this.gridTransitioning=!0,this.gridTransitionPromise=this.preventNextAnimations?r():o(s).then((()=>{this.gridTransitioning=!1})),s.classList.remove(...Object.values(n.c)),s.classList.add(n.c[this.expanded])),a=this.expanded,l=this.country,t.N({name:n.a,value:a,country:l}))}}get isExpanded(){return this.expanded===n.b.Expanded}set contentsVisibility(t){this.contentsElement&&(this.contentsElement.hidden=!t)}emitTrackingEvent(e,n){let i;n?.viaHotkey&&(i={action_info:{trigger_type:t.d3.HOTKEY}});const[s,a,o]={expand:["nav","click","open_community_nav"],collapse:["nav","click","close_community_nav"],hover:["nav","hover","open_community_nav"],unhover:["nav","hover","close_community_nav"]}[e];return t.i(this,{source:s,action:a,noun:o,...i})}async stopAnimations(){const e=[];this.containerElement&&e.push(t.c5(this.containerElement)),this.contentsElement&&e.push(t.c5(this.contentsElement)),await Promise.all(e)}async runAnimations(e,n){if(this.preventNextAnimations)return;const i=[],s=t.c6(this,`flex-left-nav-container.${e}-${n}`),a=t.c6(this,`flex-left-nav-contents.${e}-${n}`);this.containerElement&&i.push(t.c7(this.containerElement,s.keyframes,s.options)),this.contentsElement&&i.push(t.c7(this.contentsElement,a.keyframes,a.options)),await Promise.all(i)}async connectedCallback(){super.connectedCallback(),await this.syncFlexNavStateNoAnimate(),this.isExpanded||this.updateComplete.then((()=>this.contentsVisibility=!1)),this.addEventListener("mouseleave",this.interactionController.handleMouseLeave),this.hotkeysController.subscribe(t.cy.OPEN_NAVIGATION,this.toggleStateViaHotkey)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("mouseleave",this.interactionController.handleMouseLeave),this.hotkeysController.unsubscribe(t.cy.OPEN_NAVIGATION,this.toggleStateViaHotkey)}willUpdate(t){t.has("expanded")&&this.hasUpdated&&this.handleExpandedStateChanged(),super.willUpdate(t)}updated(){}focusContents(){this.isExpanded?this.collapseButton?.focus():this.expandButton?.focus()}async syncFlexNavStateNoAnimate(){const e=(()=>{const e=t.K.get(n.a);return n.i(e)?e:null})();null!==e&&this.expanded!==e&&(this.preventAnimationsForUpdate(),this.toggleState(),await this.updateComplete)}async preventAnimationsForUpdate(){this.preventNextAnimations=!0;const t=document.querySelector(this.parentGridSelector);t instanceof HTMLElement&&(t.style.transition="none"),this.setAttribute("skip-animation",""),await Promise.all([this.updateComplete,r()]),this.removeAttribute("skip-animation"),t instanceof HTMLElement&&(t.style.transition=""),this.preventNextAnimations=!1}async handleExpandedStateChanged(){this.emitter.dispatch(this.isExpanded?"expand":"collapse");const t=this.updateComplete,e=(this.isExpanded?this.collapseButton:this.expandButton)?.parentElement,n=(this.isExpanded?this.expandButton:this.collapseButton)?.parentElement;if(a(e)&&(e.disabled=!0),a(n)&&n.hide?.(),t.then((async()=>{this.focusContents()})),await this.stopAnimations(),this.isExpanded&&(this.contentsVisibility=!0),!this.isHovered&&this.containerElement){const t=this.isExpanded?"show":"hide";await this.runAnimations("expand",t)}else this.gridTransitioning&&this.gridTransitionPromise?.then((()=>{this.emitter.dispatch("after-grid-transition"),this.isHovered=!1,this.classList.remove("hovered")}));this.isExpanded||(this.contentsVisibility=!1),a(e)&&(e.disabled=!1),this.emitter.dispatch(this.isExpanded?"after-expand":"after-collapse")}async startInteraction(){this.isExpanded||this.isHovered||this.gridTransitioning||(this.emitTrackingEvent("hover"),this.emitter.dispatch("hover"),await this.stopAnimations(),this.classList.add("hover-started"),this.contentsVisibility=!0,this.isHovered=!0,await this.runAnimations("hover","show"),this.classList.remove("hover-started"),this.classList.add("hovered"),this.emitter.dispatch("after-hover"))}async finishInteraction(){!this.isExpanded&&this.isHovered&&(this.emitTrackingEvent("unhover"),this.emitter.dispatch("unhover"),await this.stopAnimations(),await this.runAnimations("hover","hide"),this.classList.remove("hovered"),this.isHovered=!1,this.contentsVisibility=!1,this.emitter.dispatch("after-unhover"))}render(){return i.x` <slot @slotchange="${this.handleSlotChange}"></slot> ${this.isExpanded?i.A:i.x`<div class="hoverable-target ${this.isHovered?"hovered":""}" @mouseenter="${this.interactionController.handleMouseEnter}"></div>`} `}};s.styles=i.a`:host(.hover-started),:host(.hovered){z-index:10!important;border-top:1px solid var(--color-neutral-border)!important}.hoverable-target{position:fixed;top:calc(var(--shreddit-header-height) + 72px);width:calc(var(--flex-nav-closed-size) + 16px);bottom:0;z-index:calc(var(--flex-nav-z-index) + 1)}.hoverable-target.hovered{z-index:calc(var(--flex-nav-z-index) - 1);top:var(--shreddit-header-height);width:calc(var(--flex-nav-expanded-size) + 16px)}`,t._([t.h()],s.prototype,"isHovered",void 0),t._([t.n({type:String,reflect:!0})],s.prototype,"expanded",void 0),t._([t.n({type:String})],s.prototype,"country",void 0),t._([t.n({type:Boolean})],s.prototype,"noAnimate",void 0),t._([t.n({type:String})],s.prototype,"parentGridSelector",void 0),s=t._([t.e("flex-left-nav-container")],s);const a=t=>"rpl-tooltip"===t?.tagName.toLowerCase(),o=(t,e=1200)=>{const n=t=>new Promise((n=>{t.addEventListener("transitionend",n),setTimeout(n,e)}));return Array.isArray(t)?Promise.all(t.map(n)):n(t)},r=()=>new Promise((t=>requestAnimationFrame(t)));return t.c3("flex-left-nav-container.expand-show",{keyframes:[{transform:"translateX(var(--closed-floating-translation))"},{transform:"translateX(var(--open-floating-translation))"}],options:{duration:250,easing:"cubic-bezier(0.65, 0, 0.35, 1)"}}),t.c3("flex-left-nav-container.expand-hide",{keyframes:[{transform:"translateX(var(--open-floating-translation))"},{transform:"translateX(var(--closed-floating-translation))"}],options:{duration:300,easing:"cubic-bezier(0.87, 0, 0.13, 1)"}}),t.c3("flex-left-nav-container.hover-show",{keyframes:[{boxShadow:"var(--left-nav-box-shadow-none)",transform:"translateX(var(--closed-floating-translation))"},{boxShadow:"var(--left-nav-box-shadow-hover)",transform:"translateX(var(--open-floating-translation))"}],options:{duration:250,easing:"cubic-bezier(0.65, 0, 0.35, 1)"}}),t.c3("flex-left-nav-container.hover-hide",{keyframes:[{boxShadow:"var(--left-nav-box-shadow-hover)",transform:"translateX(var(--open-floating-translation))"},{boxShadow:"var(--left-nav-box-shadow-none)",transform:"translateX(var(--closed-floating-translation))"}],options:{duration:300,easing:"cubic-bezier(0.87, 0, 0.13, 1)"}}),t.c3("flex-left-nav-contents.show",{keyframes:[{opacity:0},{opacity:1}],options:{duration:250,easing:"linear"}}),t.c3("flex-left-nav-contents.hide",{keyframes:[{opacity:1},{opacity:0}],options:{duration:300,easing:"linear"}}),{get F(){return s}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("DJSLRtH1XX",["Dw4vb8Yfbm"],(async a=>{const{svg:l}=a.a();return{s:a.m(l`<path d="M11.145 18.995h-2.29a1.56 1.56 0 01-1.501-1.134l-.051-.18a2.161 2.161 0 00-2.604-1.504l-.185.046a1.561 1.561 0 01-1.731-.734l-1.146-1.985a1.561 1.561 0 01.229-1.864l.132-.137a2.163 2.163 0 000-3.007l-.13-.135a1.561 1.561 0 01-.23-1.866L2.783 4.51a1.56 1.56 0 011.73-.734l.186.046a2.161 2.161 0 002.603-1.504l.05-.18a1.562 1.562 0 011.503-1.134h2.29c.697 0 1.31.463 1.5 1.133l.053.183a2.157 2.157 0 002.599 1.502l.189-.047a1.561 1.561 0 011.73.734l1.147 1.985a1.561 1.561 0 01-.23 1.864l-.133.14a2.162 2.162 0 000 3.004l.132.137c.485.5.578 1.262.23 1.866l-1.145 1.984a1.56 1.56 0 01-1.731.734l-.187-.047a2.16 2.16 0 00-2.601 1.503l-.052.182a1.562 1.562 0 01-1.502 1.134zm-2.11-1.8l1.933-.01a3.947 3.947 0 014.77-2.754l.01.002.967-1.672-.008-.007a3.943 3.943 0 010-5.508l.007-.007-.966-1.672-.01.002a3.945 3.945 0 01-4.771-2.754l-.003-.01-1.933.009A3.946 3.946 0 014.26 5.569l-.01-.002-.966 1.672.008.007a3.943 3.943 0 010 5.508l-.007.007.966 1.672.01-.002a3.947 3.947 0 014.77 2.754l.004.01zM10 13c-1.654 0-3-1.346-3-3s1.346-3 3-3 3 1.346 3 3-1.346 3-3 3zm0-4.2c-.661 0-1.2.539-1.2 1.2 0 .66.539 1.2 1.2 1.2.66 0 1.199-.54 1.199-1.2 0-.661-.538-1.2-1.2-1.2z"></path>`,"0 0 20 20","settings")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./BHQvZGlXFT.js",import.meta.url,"BHQvZGlXFT");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("DKYHmsTM9-",["Dw4vb8Yfbm","BHQvZGlXFT","5r73EsgItq"],(async(t,e,i)=>{let d=class extends i.s{constructor(){super(...arguments),this.subredditName="",this.pageId=e.E.Main,this.openModal=async()=>{await this._activateCommunityWidgetEditModalFeature();const t=document.querySelector(`community-widget-edit-modal#${e.C}`);t?.showModal({pageId:this.pageId,widgetId:this.widgetId})},this.onClick=()=>{this.openModal()},this.onKeyPress=t=>{"Enter"!==t.key&&"Space"!==t.key||this.openModal()}}static get styles(){return[t.t]}_activateCommunityWidgetEditModalFeature(){return t.r({name:t.I,routeParams:{subreddit:this.subredditName}})}render(){return i.x`<slot @click="${this.onClick}" @keypress="${this.onKeyPress}"></slot>`}};t._([t.n({type:String,attribute:"subreddit-name"})],d.prototype,"subredditName",void 0),t._([t.n({type:String,attribute:"page-id"})],d.prototype,"pageId",void 0),t._([t.n({type:String,attribute:"widget-id"})],d.prototype,"widgetId",void 0),d=t._([t.e("community-widget-edit-button")],d)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./CZLMnmUH44.js",import.meta.url,"CZLMnmUH44");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");
SML.dm("DLXAqLxSut",["Dw4vb8Yfbm","CZLMnmUH44","xrDbp1ee_h"],(async(e,t,n)=>{const a={get:()=>{if(!e.a8.isAvailable())return;const t=e.a8.getItem(e.a9.I18nPostTranslationBanner);return t?JSON.parse(t):void 0},set:t=>{e.a8.isAvailable()&&e.a8.setItem(e.a9.I18nPostTranslationBanner,JSON.stringify(t))},update:e=>{const t=a.get()||{};a.set({...t,...e})}},o="shreddit_mt_immersive_en",r="shreddit_mt_ux_update",s=new Set,i=t=>{if(s.has(t))return;s.add(t);const n=e.b4(t);return e.b5({experimentName:t,variant:n??"",experimentVersion:""})};return{P:a,i:function(){const e=window.location?.search??"";return new URLSearchParams(e).has("tl")},l:t=>{const{error:n,ids:a,element:o,componentName:r}=t,s=e.b({source:"translate_button",action:"error",noun:"app"},{action_info:{reason:n,type:r},setting:{value:a.toString(),values:a}});e.i(o,s)},o:{post:(t,a,s)=>{const m=s===e.b3.UXUpdate,d=s===e.b3.ENImmersive;if(!m&&!d)return;d&&i(o),m&&i(r);const l=n.j({archived:a?.archived,authorId:a?.authorId,createdTimestamp:a?.createdTimestamp,domain:a?.domain,id:a?.id??"",nsfw:a?.nsfw,promoted:a?.promoted,score:a?.score,spoiler:a?.spoiler,subredditId:a?.subredditId,subredditPrefixedName:a?.subredditPrefixedName,postTitle:a?.postTitle,postType:a?.postType,recommendationSource:a?.recommendationSource,commentCount:a?.commentCount,permalink:a?.permalink,postLanguage:a?.postLanguage,translationLanguage:a?.translationLanguage,isPostTranslated:a?.isPostTranslated});e.i(t,l)},comment:(n,a,s)=>{const m=s===e.b3.UXUpdate,d=s===e.b3.ENImmersive;if(!m&&!d)return;d&&i(o),m&&i(r);const l=t.b(a);e.i(n,l)}},s:({changedProperties:e,translationContextValue:t,overrideEnabled:n})=>{const a=e.get("translationContextValue")?.isTranslationActive,o=t.isTranslationActive;return e.has("translationContextValue")&&"boolean"==typeof a&&"boolean"==typeof o&&"boolean"==typeof n&&o!==n}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("DMVINMWPkT",["Dw4vb8Yfbm"],(async s=>{const{svg:a}=s.a();return{a:s.m(a`<path d="M17.1 9.1h-6.2V2.9c0-.5-.4-.9-.9-.9s-.9.4-.9.9v6.2H2.9c-.5 0-.9.4-.9.9s.4.9.9.9h6.2v6.2c0 .5.4.9.9.9s.9-.4.9-.9v-6.2h6.2c.5 0 .9-.4.9-.9s-.4-.9-.9-.9z"></path>`,"0 0 20 20","add")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");
SML.dm("DOqOHj9jA9",["Dw4vb8Yfbm","5r73EsgItq","jWC3N3n7Al"],(async(e,t,i)=>{const a={checkbox:()=>"This checkbox must be on",radio:()=>"This radio must have a selected option"};class o extends i.F{constructor(){super(...arguments),this.required=!1,this.name="",this.initialized=!1,this._events=new e.E(this),this.ariaRole="checkbox",this._checked=!1,this.ellipsis=!1,this._handleClick=this._events.define("click",(e=>{this.disabled||e.defaultPrevented||this.handleInteraction()})),this._handleKeydown=this._events.define("keydown",(e=>{this.disabled||e.defaultPrevented||"Space"===e.code&&(e.stopPropagation(),e.preventDefault(),this.handleInteraction())}))}get checked(){return this._checked}set checked(e){const t=this._checked;e!==t&&(this._internals.setFormValue(e?this.getAttribute("value")||"on":null),this._checked=e,e?this.setAttribute("aria-checked","true"):this.removeAttribute("aria-checked"),this.hasAttribute("required")&&!this.checked?this._internals.setValidity({valueMissing:!0},a[this.ariaRole]()):this._internals.setValidity(),this.requestUpdate("checked",t))}static get styles(){return[super.styles,t.a`:host(:not(faceplate-switch-input)){min-height:var(--size-md)}:host{display:flex;align-items:center;cursor:pointer}label{font:var(--font-14-20-regular);color:var(--color-neutral-content-strong);margin-left:var(--spacer-2xs);cursor:pointer}.icon{border:var(--line-md) solid transparent;height:var(--size-md);font-size:var(--size-md);flex-shrink:0}:host([checked]) .icon,:host([indeterminate]) .icon{display:inline-block;color:var(--color-primary-background)}:host(:hover) .icon{color:var(--color-primary-background-hover)}:host([faceplate-validity=invalid]) .icon{color:var(--color-danger-content);pointer-events:none}:host([aria-disabled=true]) .icon{color:var(--color-neutral-content-disabled);pointer-events:none}:host([ellipsis]) label{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host([required]) label::after{position:absolute;color:var(--color-danger-content);content:'*'}:host(:focus) .icon{border-color:var(--color-global-focus,transparent);outline:0}:host(:focus){outline:0}:host(:focus:not(:focus-visible)) .icon{border-color:transparent}`]}connectedCallback(){super.connectedCallback(),this.initialized||(this.initialized=!0,this.setAttribute("role",this.ariaRole),this.setAttribute("tabindex","0"))}formDisabledCallback(e){super.formDisabledCallback(e),e?this.removeAttribute("tabindex"):this.setAttribute("tabindex","0")}render(){return t.x` ${super.render()} <label> <slot></slot> </label> `}handleInteraction(){const e=new InputEvent("input",{bubbles:!0});this.dispatchEvent(e)}}return e._([e.n({type:Boolean})],o.prototype,"required",void 0),e._([e.n({type:String})],o.prototype,"name",void 0),e._([e.n({type:Boolean,reflect:!0})],o.prototype,"checked",null),e._([e.n({type:Boolean})],o.prototype,"ellipsis",void 0),{C:o}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("DQQjPN-OEj",["Dw4vb8Yfbm"],(async t=>{var r,e;class s{static get instance(){return t.d(r,r,"f",e)||t.f(r,r,new r,"f",e),t.d(r,r,"f",e)}getCorrelationId(){return this._correlationId}setCorrelationId(){return this._correlationId=crypto.randomUUID(),this._correlationId}getPostType(){return this._postType}setPostType(t){return this._postType=t,this._postType}}r=s,e={value:void 0};return{a:s.instance}}));
SML.dm("DS9WepT8W8",[],(async()=>{var e=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,t=/[\0-\x1F\x7F-\x9F]/,i=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,s=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/;function a(e){return Array.prototype.slice.call(arguments,1).forEach((function(t){t&&Object.keys(t).forEach((function(i){e[i]=t[i]}))})),e}function r(e){return Object.prototype.toString.call(e)}function o(e){return"[object Function]"===r(e)}function n(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const u={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};const c={"http:":{validate:function(e,t,i){const s=e.slice(t);return i.re.http||(i.re.http=new RegExp("^\\/\\/"+i.re.src_auth+i.re.src_host_port_strict+i.re.src_path,"i")),i.re.http.test(s)?s.match(i.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,i){const s=e.slice(t);return i.re.no_http||(i.re.no_http=new RegExp("^"+i.re.src_auth+"(?:localhost|(?:(?:"+i.re.src_domain+")\\.)+"+i.re.src_domain_root+")"+i.re.src_port+i.re.src_host_terminator+i.re.src_path,"i")),i.re.no_http.test(s)?t>=3&&":"===e[t-3]||t>=3&&"/"===e[t-3]?0:s.match(i.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,i){const s=e.slice(t);return i.re.mailto||(i.re.mailto=new RegExp("^"+i.re.src_email_name+"@"+i.re.src_host_strict,"i")),i.re.mailto.test(s)?s.match(i.re.mailto)[0].length:0}}},l="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function _(a){const u=a.re=function(a){const r={};a=a||{},r.src_Any=e.source,r.src_Cc=t.source,r.src_Z=s.source,r.src_P=i.source,r.src_ZPCc=[r.src_Z,r.src_P,r.src_Cc].join("|"),r.src_ZCc=[r.src_Z,r.src_Cc].join("|");const o="[><]";return r.src_pseudo_letter="(?:(?![><]|"+r.src_ZPCc+")"+r.src_Any+")",r.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",r.src_auth="(?:(?:(?!"+r.src_ZCc+"|[@/\\[\\]()]).)+@)?",r.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",r.src_host_terminator="(?=$|[><]|"+r.src_ZPCc+")(?!"+(a["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+r.src_ZPCc+"))",r.src_path="(?:[/?#](?:(?!"+r.src_ZCc+"|"+o+"|[()[\\]{}.,\"'?!\\-;]).|\\[(?:(?!"+r.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+r.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+r.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+r.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+r.src_ZCc+"|[']).)+\\'|\\'(?="+r.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+r.src_ZCc+"|[.]|$)|"+(a["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+r.src_ZCc+"|$)|;(?!"+r.src_ZCc+"|$)|\\!+(?!"+r.src_ZCc+"|[!]|$)|\\?(?!"+r.src_ZCc+"|[?]|$))+|\\/)?",r.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',r.src_xn="xn--[a-z0-9\\-]{1,59}",r.src_domain_root="(?:"+r.src_xn+"|"+r.src_pseudo_letter+"{1,63})",r.src_domain="(?:"+r.src_xn+"|(?:"+r.src_pseudo_letter+")|(?:"+r.src_pseudo_letter+"(?:-|"+r.src_pseudo_letter+"){0,61}"+r.src_pseudo_letter+"))",r.src_host="(?:(?:(?:(?:"+r.src_domain+")\\.)*"+r.src_domain+"))",r.tpl_host_fuzzy="(?:"+r.src_ip4+"|(?:(?:(?:"+r.src_domain+")\\.)+(?:%TLDS%)))",r.tpl_host_no_ip_fuzzy="(?:(?:(?:"+r.src_domain+")\\.)+(?:%TLDS%))",r.src_host_strict=r.src_host+r.src_host_terminator,r.tpl_host_fuzzy_strict=r.tpl_host_fuzzy+r.src_host_terminator,r.src_host_port_strict=r.src_host+r.src_port+r.src_host_terminator,r.tpl_host_port_fuzzy_strict=r.tpl_host_fuzzy+r.src_port+r.src_host_terminator,r.tpl_host_port_no_ip_fuzzy_strict=r.tpl_host_no_ip_fuzzy+r.src_port+r.src_host_terminator,r.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+r.src_ZPCc+"|>|$))",r.tpl_email_fuzzy='(^|[><]|"|\\(|'+r.src_ZCc+")("+r.src_email_name+"@"+r.tpl_host_fuzzy_strict+")",r.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+r.src_ZPCc+"))((?![$+<=>^`|])"+r.tpl_host_port_fuzzy_strict+r.src_path+")",r.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+r.src_ZPCc+"))((?![$+<=>^`|])"+r.tpl_host_port_no_ip_fuzzy_strict+r.src_path+")",r}(a.__opts__),c=a.__tlds__.slice();function l(e){return e.replace("%TLDS%",u.src_tlds)}a.onCompile(),a.__tlds_replaced__||c.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),c.push(u.src_xn),u.src_tlds=c.join("|"),u.email_fuzzy=RegExp(l(u.tpl_email_fuzzy),"i"),u.link_fuzzy=RegExp(l(u.tpl_link_fuzzy),"i"),u.link_no_ip_fuzzy=RegExp(l(u.tpl_link_no_ip_fuzzy),"i"),u.host_fuzzy_test=RegExp(l(u.tpl_host_fuzzy_test),"i");const _=[];function h(e,t){throw new Error('(LinkifyIt) Invalid schema "'+e+'": '+t)}a.__compiled__={},Object.keys(a.__schemas__).forEach((function(e){const t=a.__schemas__[e];if(null===t)return;const i={validate:null,link:null};if(a.__compiled__[e]=i,"[object Object]"===r(t))return!function(e){return"[object RegExp]"===r(e)}(t.validate)?o(t.validate)?i.validate=t.validate:h(e,t):i.validate=function(e){return function(t,i){const s=t.slice(i);return e.test(s)?s.match(e)[0].length:0}}(t.validate),void(o(t.normalize)?i.normalize=t.normalize:t.normalize?h(e,t):i.normalize=function(e,t){t.normalize(e)});!function(e){return"[object String]"===r(e)}(t)?h(e,t):_.push(e)})),_.forEach((function(e){a.__compiled__[a.__schemas__[e]]&&(a.__compiled__[e].validate=a.__compiled__[a.__schemas__[e]].validate,a.__compiled__[e].normalize=a.__compiled__[a.__schemas__[e]].normalize)})),a.__compiled__[""]={validate:null,normalize:function(e,t){t.normalize(e)}};const d=Object.keys(a.__compiled__).filter((function(e){return e.length>0&&a.__compiled__[e]})).map(n).join("|");a.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+u.src_ZPCc+"))("+d+")","i"),a.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+u.src_ZPCc+"))("+d+")","ig"),a.re.schema_at_start=RegExp("^"+a.re.schema_search.source,"i"),a.re.pretest=RegExp("("+a.re.schema_test.source+")|("+a.re.host_fuzzy_test.source+")|@","i"),function(e){e.__index__=-1,e.__text_cache__=""}(a)}function h(e,t){const i=e.__index__,s=e.__last_index__,a=e.__text_cache__.slice(i,s);this.schema=e.__schema__.toLowerCase(),this.index=i+t,this.lastIndex=s+t,this.raw=a,this.text=a,this.url=a}function d(e,t){const i=new h(e,t);return e.__compiled__[i.schema].normalize(i,e),i}function p(e,t){if(!(this instanceof p))return new p(e,t);var i;t||(i=e,Object.keys(i||{}).reduce((function(e,t){return e||u.hasOwnProperty(t)}),!1)&&(t=e,e={})),this.__opts__=a({},u,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=a({},c,e),this.__compiled__={},this.__tlds__=l,this.__tlds_replaced__=!1,this.re={},_(this)}p.prototype.add=function(e,t){return this.__schemas__[e]=t,_(this),this},p.prototype.set=function(e){return this.__opts__=a(this.__opts__,e),this},p.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;let t,i,s,a,r,o,n,u,c;if(this.re.schema_test.test(e))for(n=this.re.schema_search,n.lastIndex=0;null!==(t=n.exec(e));)if(a=this.testSchemaAt(e,t[2],n.lastIndex),a){this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+a;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(u=e.search(this.re.host_fuzzy_test),u>=0&&(this.__index__<0||u<this.__index__)&&null!==(i=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(r=i.index+i[1].length,(this.__index__<0||r<this.__index__)&&(this.__schema__="",this.__index__=r,this.__last_index__=i.index+i[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(c=e.indexOf("@"),c>=0&&null!==(s=e.match(this.re.email_fuzzy))&&(r=s.index+s[1].length,o=s.index+s[0].length,(this.__index__<0||r<this.__index__||r===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=r,this.__last_index__=o))),this.__index__>=0},p.prototype.pretest=function(e){return this.re.pretest.test(e)},p.prototype.testSchemaAt=function(e,t,i){return this.__compiled__[t.toLowerCase()]?this.__compiled__[t.toLowerCase()].validate(e,i,this):0},p.prototype.match=function(e){const t=[];let i=0;this.__index__>=0&&this.__text_cache__===e&&(t.push(d(this,i)),i=this.__last_index__);let s=i?e.slice(i):e;for(;this.test(s);)t.push(d(this,i)),s=s.slice(this.__last_index__),i+=this.__last_index__;return t.length?t:null},p.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;const t=this.re.schema_at_start.exec(e);if(!t)return null;const i=this.testSchemaAt(e,t[2],t[0].length);return i?(this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+i,d(this,0)):null},p.prototype.tlds=function(e,t){return e=Array.isArray(e)?e:[e],t?(this.__tlds__=this.__tlds__.concat(e).sort().filter((function(e,t,i){return e!==i[t-1]})).reverse(),_(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,_(this),this)},p.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),"mailto:"!==e.schema||/^mailto:/i.test(e.url)||(e.url="mailto:"+e.url)},p.prototype.onCompile=function(){};const m=/\s/,f=(e,t)=>(i,s)=>{if(s>e.length){const t=i[s-e.length-1];if(!t.match(m)){if("/"!==t)return 0;{const t=s-e.length-2;if(t>=0&&!i[t].match(m))return 0}}}const a=i.slice(s);return""===a&&"@"!==e||(t.test(a)?a?.match(t)[0].length??0:0)};var g,b;!function(e){e.All="all",e.Here="here"}(g||(g={})),function(e){e.subreddit="r/",e.subredditFull="/r/",e.profile="u/",e.profileFull="/u/",e.mention="@"}(b||(b={}));const D=new RegExp("^[A-Za-z0-9][A-Za-z0-9_]{0,20}\\b"),y=new RegExp("^[A-Za-z0-9_-]{0,20}"),F=new RegExp("^[A-Za-z0-9_-]{1,20}");b.subreddit;const x={subreddit:{prefix:b.subreddit,config:{validate:f(b.subreddit,D)}},profile:{prefix:b.profile,config:{validate:f(b.profile,y)}},mention:{prefix:b.mention,config:{validate:f(b.mention,F)}},subredditFullUrl:{prefix:b.subreddit,config:{validate:f(b.subreddit,D)}}},k={subredditFull:{prefix:b.subredditFull,config:x.subreddit.config},profileFull:{prefix:b.profileFull,config:x.profile.config}},z={...x,...k},v=["//","ftp:","http:","https:","mailto:"],w=["aaa","aarp","abarth","abb","abbott","abbvie","abc","able","abogado","abudhabi","ac","academy","accenture","accountant","accountants","aco","actor","ad","ads","adult","ae","aeg","aero","aetna","af","afl","africa","ag","agakhan","agency","ai","aig","airbus","airforce","airtel","akdn","al","alfaromeo","alibaba","alipay","allfinanz","allstate","ally","alsace","alstom","am","amazon","americanexpress","americanfamily","amex","amfam","amica","amsterdam","analytics","android","anquan","anz","ao","aol","apartments","app","apple","aq","aquarelle","ar","arab","aramco","archi","army","arpa","art","arte","as","asda","asia","associates","at","athleta","attorney","au","auction","audi","audible","audio","auspost","author","auto","autos","avianca","aw","aws","ax","axa","az","azure","ba","baby","baidu","banamex","bananarepublic","band","bank","bar","barcelona","barclaycard","barclays","barefoot","bargains","baseball","basketball","bauhaus","bayern","bb","bbc","bbt","bbva","bcg","bcn","bd","be","beats","beauty","beer","bentley","berlin","best","bestbuy","bet","bf","bg","bh","bharti","bi","bible","bid","bike","bing","bingo","bio","biz","bj","black","blackfriday","blockbuster","blog","bloomberg","blue","bm","bms","bmw","bn","bnpparibas","bo","boats","boehringer","bofa","bom","bond","boo","book","booking","bosch","bostik","boston","bot","boutique","box","br","bradesco","bridgestone","broadway","broker","brother","brussels","bs","bt","build","builders","business","buy","buzz","bv","bw","by","bz","bzh","ca","cab","cafe","cal","call","calvinklein","cam","camera","camp","canon","capetown","capital","capitalone","car","caravan","cards","care","career","careers","cars","casa","case","cash","casino","cat","catering","catholic","cba","cbn","cbre","cbs","cc","cd","center","ceo","cern","cf","cfa","cfd","cg","ch","chanel","channel","charity","chase","chat","cheap","chintai","christmas","chrome","church","ci","cipriani","circle","cisco","citadel","citi","citic","city","cityeats","ck","cl","claims","cleaning","click","clinic","clinique","clothing","cloud","club","clubmed","cm","cn","co","coach","codes","coffee","college","cologne","com","comcast","commbank","community","company","compare","computer","comsec","condos","construction","consulting","contact","contractors","cooking","cookingchannel","cool","coop","corsica","country","coupon","coupons","courses","cpa","cr","credit","creditcard","creditunion","cricket","crown","crs","cruise","cruises","cu","cuisinella","cv","cw","cx","cy","cymru","cyou","cz","dabur","dad","dance","data","date","dating","datsun","day","dclk","dds","de","deal","dealer","deals","degree","delivery","dell","deloitte","delta","democrat","dental","dentist","desi","design","dev","dhl","diamonds","diet","digital","direct","directory","discount","discover","dish","diy","dj","dk","dm","dnp","do","docs","doctor","dog","domains","dot","download","drive","dtv","dubai","dunlop","dupont","durban","dvag","dvr","dz","earth","eat","ec","eco","edeka","edu","education","ee","eg","email","emerck","energy","engineer","engineering","enterprises","epson","equipment","er","ericsson","erni","es","esq","estate","et","etisalat","eu","eurovision","eus","events","exchange","expert","exposed","express","extraspace","fage","fail","fairwinds","faith","family","fan","fans","farm","farmers","fashion","fast","fedex","feedback","ferrari","ferrero","fi","fiat","fidelity","fido","film","final","finance","financial","fire","firestone","firmdale","fish","fishing","fit","fitness","fj","fk","flickr","flights","flir","florist","flowers","fly","fm","fo","foo","food","foodnetwork","football","ford","forex","forsale","forum","foundation","fox","fr","free","fresenius","frl","frogans","frontdoor","frontier","ftr","fujitsu","fun","fund","furniture","futbol","fyi","ga","gal","gallery","gallo","gallup","game","games","gap","garden","gay","gb","gbiz","gd","gdn","ge","gea","gent","genting","george","gf","gg","ggee","gh","gi","gift","gifts","gives","giving","gl","glass","gle","global","globo","gm","gmail","gmbh","gmo","gmx","gn","godaddy","gold","goldpoint","golf","goo","goodyear","goog","google","gop","got","gov","gp","gq","gr","grainger","graphics","gratis","green","gripe","grocery","group","gs","gt","gu","guardian","gucci","guge","guide","guitars","guru","gw","gy","hair","hamburg","hangout","haus","hbo","hdfc","hdfcbank","health","healthcare","help","helsinki","here","hermes","hgtv","hiphop","hisamitsu","hitachi","hiv","hk","hkt","hm","hn","hockey","holdings","holiday","homedepot","homegoods","homes","homesense","honda","horse","hospital","host","hosting","hot","hoteles","hotels","hotmail","house","how","hr","hsbc","ht","hu","hughes","hyatt","hyundai","ibm","icbc","ice","icu","id","ie","ieee","ifm","ikano","il","im","imamat","imdb","immo","immobilien","in","inc","industries","infiniti","info","ing","ink","institute","insurance","insure","int","international","intuit","investments","io","ipiranga","iq","ir","irish","is","ismaili","ist","istanbul","it","itau","itv","jaguar","java","jcb","je","jeep","jetzt","jewelry","jio","jll","jm","jmp","jnj","jo","jobs","joburg","jot","joy","jp","jpmorgan","jprs","juegos","juniper","kaufen","kddi","ke","kerryhotels","kerrylogistics","kerryproperties","kfh","kg","kh","ki","kia","kids","kim","kinder","kindle","kitchen","kiwi","km","kn","koeln","komatsu","kosher","kp","kpmg","kpn","kr","krd","kred","kuokgroup","kw","ky","kyoto","kz","la","lacaixa","lamborghini","lamer","lancaster","lancia","land","landrover","lanxess","lasalle","lat","latino","latrobe","law","lawyer","lb","lc","lds","lease","leclerc","lefrak","legal","lego","lexus","lgbt","li","lidl","life","lifeinsurance","lifestyle","lighting","like","lilly","limited","limo","lincoln","link","lipsy","live","living","lk","llc","llp","loan","loans","locker","locus","lol","london","lotte","lotto","love","lpl","lplfinancial","lr","ls","lt","ltd","ltda","lu","lundbeck","luxe","luxury","lv","ly","ma","madrid","maif","maison","makeup","man","management","mango","map","market","marketing","markets","marriott","marshalls","maserati","mattel","mba","mc","mckinsey","md","me","med","media","meet","melbourne","meme","memorial","men","menu","merckmsd","mg","mh","miami","microsoft","mil","mini","mint","mit","mitsubishi","mk","ml","mlb","mls","mm","mma","mn","mo","mobi","mobile","moda","moe","moi","mom","monash","money","monster","mormon","mortgage","moscow","moto","motorcycles","mov","movie","mp","mq","mr","ms","msd","mt","mtn","mtr","mu","museum","music","mutual","mv","mw","mx","my","mz","na","nab","nagoya","name","natura","navy","nba","nc","ne","nec","net","netbank","netflix","network","neustar","new","news","next","nextdirect","nexus","nf","nfl","ng","ngo","nhk","ni","nico","nike","nikon","ninja","nissan","nissay","nl","no","nokia","northwesternmutual","norton","now","nowruz","nowtv","np","nr","nra","nrw","ntt","nu","nyc","nz","obi","observer","office","okinawa","olayan","olayangroup","oldnavy","ollo","om","omega","one","ong","onl","online","ooo","open","oracle","orange","org","organic","origins","osaka","otsuka","ott","ovh","pa","page","panasonic","paris","pars","partners","parts","party","passagens","pay","pccw","pe","pet","pf","pfizer","pg","ph","pharmacy","phd","philips","phone","photo","photography","photos","physio","pics","pictet","pictures","pid","pin","ping","pink","pioneer","pizza","pk","pl","place","play","playstation","plumbing","plus","pm","pn","pnc","pohl","poker","politie","porn","post","pr","pramerica","praxi","press","prime","pro","prod","productions","prof","progressive","promo","properties","property","protection","pru","prudential","ps","pt","pub","pw","pwc","py","qa","qpon","quebec","quest","racing","radio","re","read","realestate","realtor","realty","recipes","red","redstone","redumbrella","rehab","reise","reisen","reit","reliance","ren","rent","rentals","repair","report","republican","rest","restaurant","review","reviews","rexroth","rich","richardli","ricoh","ril","rio","rip","ro","rocher","rocks","rodeo","rogers","room","rs","rsvp","ru","rugby","ruhr","run","rw","rwe","ryukyu","sa","saarland","safe","safety","sakura","sale","salon","samsclub","samsung","sandvik","sandvikcoromant","sanofi","sap","sarl","sas","save","saxo","sb","sbi","sbs","sc","sca","scb","schaeffler","schmidt","scholarships","school","schule","schwarz","science","scot","sd","se","search","seat","secure","security","seek","select","sener","services","seven","sew","sex","sexy","sfr","sg","sh","shangrila","sharp","shaw","shell","shia","shiksha","shoes","shop","shopping","shouji","show","showtime","si","silk","sina","singles","site","sj","sk","ski","skin","sky","skype","sl","sling","sm","smart","smile","sn","sncf","so","soccer","social","softbank","software","sohu","solar","solutions","song","sony","soy","spa","space","sport","spot","sr","srl","ss","st","stada","staples","star","statebank","statefarm","stc","stcgroup","stockholm","storage","store","stream","studio","study","style","su","sucks","supplies","supply","support","surf","surgery","suzuki","sv","swatch","swiss","sx","sy","sydney","systems","sz","tab","taipei","talk","taobao","target","tatamotors","tatar","tattoo","tax","taxi","tc","tci","td","tdk","team","tech","technology","tel","temasek","tennis","teva","tf","tg","th","thd","theater","theatre","tiaa","tickets","tienda","tiffany","tips","tires","tirol","tj","tjmaxx","tjx","tk","tkmaxx","tl","tm","tmall","tn","to","today","tokyo","tools","top","toray","toshiba","total","tours","town","toyota","toys","tr","trade","trading","training","travel","travelchannel","travelers","travelersinsurance","trust","trv","tt","tube","tui","tunes","tushu","tv","tvs","tw","tz","ua","ubank","ubs","ug","uk","unicom","university","uno","uol","ups","us","uy","uz","va","vacations","vana","vanguard","vc","ve","vegas","ventures","verisign","vermgensberater","vermgensberatung","versicherung","vet","vg","vi","viajes","video","vig","viking","villas","vin","vip","virgin","visa","vision","viva","vivo","vlaanderen","vn","vodka","volkswagen","volvo","vote","voting","voto","voyage","vu","vuelos","wales","walmart","walter","wang","wanggou","watch","watches","weather","weatherchannel","webcam","weber","website","wed","wedding","weibo","weir","wf","whoswho","wien","wiki","williamhill","win","windows","wine","winners","wme","wolterskluwer","woodside","work","works","world","wow","ws","wtc","wtf","xbox","xerox","xfinity","xihuan","xin","xxx","xyz","yachts","yahoo","yamaxun","yandex","ye","yodobashi","yoga","yokohama","you","youtube","yt","yun","za","zappos","zara","zero","zip","zm","zone","zuerich","zw","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""];var E;!function(e){e.Prefix="{{",e.Suffix="}}",e.PrefixReplacement="{REDDIT_MACRO_START}",e.SuffixReplacement="{REDDIT_MACRO_END}"}(E||(E={}));const A=e=>e.replaceAll(E.Prefix,E.PrefixReplacement).replaceAll(E.Suffix,E.SuffixReplacement),C=e=>e.replaceAll(E.PrefixReplacement,E.Prefix).replaceAll(E.SuffixReplacement,E.Suffix),j=e=>{const t=C(e.raw);return{...e,lastIndex:e.index+t.length,raw:t,text:C(e.text),url:C(e.url)}},B=(new p).tlds(w).set({fuzzyIP:!0}),Z=(new p).tlds(w).set({fuzzyIP:!0,fuzzyLink:!0});var R;return{a:(R=new p,((e,t)=>(t.forEach((t=>e.add(t,null))),e))(R,v)).set({fuzzyLink:!1,fuzzyEmail:!1}).add(z.mention.prefix,z.mention.config).add(z.subreddit.prefix,z.subreddit.config).add(z.subredditFull.prefix,z.subreddit.config).add(z.profile.prefix,z.profile.config).add(z.profileFull.prefix,z.profile.config),b:e=>{const t=Z.match(A(e));return t&&1===t.length?t[0].text.search(/http/i)>0?null:j(t[0]):null},t:e=>{const t=A(e),i=B.match(t);if(i&&1===i.length&&0===i[0].index){const e=i[0];if(e.lastIndex===t.length)return j(e)}return null}}}));

SML.di("./Bk8sRXhdir.js",import.meta.url,"Bk8sRXhdir");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("DT9eLCODQW",["Dw4vb8Yfbm"],(async a=>{const{svg:c}=a.a();return{b:a.m(c`<path d="M8.962 10.1c2.316 0 4.2-1.884 4.2-4.2 0-2.314-1.884-4.2-4.2-4.2a4.205 4.205 0 00-4.2 4.2c0 1.14.46 2.173 1.2 2.93-2.634.988-4.501 3.288-4.93 6.33a3.265 3.265 0 00.772 2.6A3.309 3.309 0 004.3 18.9h5.136a6.757 6.757 0 01-.902-1.801H4.3a1.51 1.51 0 01-1.138-.52 1.449 1.449 0 01-.35-1.166C3.27 12.186 5.683 10.1 8.963 10.1zm-2.4-4.2a2.402 2.402 0 012.4-2.4c1.323 0 2.4 1.077 2.4 2.4a2.402 2.402 0 01-2.4 2.399 2.402 2.402 0 01-2.4-2.4zM15 10a5 5 0 100 10 5 5 0 000-10zm3.2 5a3.16 3.16 0 01-.404 1.524l-4.32-4.32a3.16 3.16 0 011.523-.404c1.765 0 3.2 1.435 3.2 3.2zm-6.4 0c0-.555.155-1.07.404-1.524l4.32 4.32A3.16 3.16 0 0115 18.2a3.204 3.204 0 01-3.2-3.2z"></path>`,"0 0 20 20","block")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./B0p6XlbwHt.js",import.meta.url,"B0p6XlbwHt");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Wt225_9ix9.js",import.meta.url,"Wt225_9ix9");
SML.dm("DTyYwWUJGO",["Dw4vb8Yfbm","B0p6XlbwHt","5r73EsgItq","Wt225_9ix9"],(async(e,a,t,i)=>{const n=e=>{if(!e)return!1;return e.getTime()+864e5>Date.now()},o=e=>{const a=new Date(e);return isNaN(a?.getTime?.())?null:a};let s=class extends t.s{constructor(){super(...arguments),this.subredditId="",this.prefixedSubredditName="",this.banner="",this.icon="",this.iconColor="",this.subredditDescription="",this.allowJoinRequests=!1,this.subredditType="restricted",this.isCommentingRestricted=!1,this.isPostingRestricted=!1,this.modMessageBody="",this.preventDefault=e=>{e.preventDefault()},this.hasPendingRequest=()=>n(this.lastJoinRequest),this.getStatusText=()=>{switch(!0){case"restricted"===this.subredditType&&this.isCommentingRestricted&&this.isPostingRestricted:return "This is a restricted community. Only approved members can contribute.";case"restricted"===this.subredditType&&this.isPostingRestricted:return "This is a restricted community. Only approved users can post, but you can still comment.";case"restricted"===this.subredditType&&this.isCommentingRestricted:return "This is a restricted community. Only approved users can comment, but you can still post.";case"private"===this.subredditType:default:return "This is a private community. Only approved members can view and contribute.";}},this.handleTextChange=e=>{this.modMessageBody=e.target.value},this.hide=()=>this.dialog?.hide(),this.showModal=()=>{var a;this.dialog?.showModal(),e.i(this,(a=this.subredditType,e.b({source:"content_gate",action:"view",noun:"modal"},{action_info:{setting_value:a}})))},this.requestClientGQL=e.Y,this.requestToJoin=async()=>{if(!this.modMessageBody||!this.subredditId)return;var a;e.i(this,(a=this.subredditType,e.b({source:"content_gate",action:"click",noun:"request_to_join"},{action_info:{setting_value:a}})));const{data:t,errors:i}=await this.requestClientGQL({operation:e.O.SendMessageToSubreddit,variables:{input:{body:this.modMessageBody,subject:"[join] Request to join",subredditId:this.subredditId}}});t.sendMessageToSubreddit.ok&&!i.length?(this.allowJoinRequests=!1,await this.requestClientGQL({operation:e.O.UpdateContributorRequestTimestamp,variables:{input:{subredditId:this.subredditId,requestDatetime:(new Date).toUTCString()}}}),this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.success,message:"Request to join has been sent"}))):this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.error,cause:"uncategorized",message:"Request to join failed to send"}))},this.renderTemplate=()=>t.x`<div class="relative max-w-lg w-100 rounded-md overflow-hidden"> <faceplate-img class="h-[88px] w-full object-cover bg-secondary-background" src="${this.banner}"></faceplate-img> <div class="relative flex items-end gap-sm pl-lg -top-[35px] -mb-[35px]"> ${this.icon?t.x`<img loading="lazy" src="${this.icon}" alt="" class="border-solid border-ui-modalbackground border-md w-[80px] aspect-square rounded-full overflow-hidden">`:i.c({size:t.I.ExtraLarge,attributes:{style:this.iconColor?`color: ${this.iconColor}`:void 0,className:"rounded-full w-[80px] h-[80px] border-neutral-background border-lg border-solid"}})} <h4 class="title text-18 font-bold mb-md bg-cover bg-no-repeat"> ${this.prefixedSubredditName} </h4> </div> ${this.open?t.A:e.o({appearance:"media",attributes:{className:"absolute top-md right-md ",onclick:this.hide},size:e.q.Small,leadingIcon:e.al({size:t.I.Small})})} <div class="flex flex-col justify-center px-md"> ${this.isPrivate&&this.subredditDescription?t.x`<p class="description text-14 mt-sm mb-0">${this.subredditDescription}</p>`:t.A} <p class="status-text text-14 mt-sm font-bold">${this.getStatusText()}</p> ${this.allowJoinRequests?t.x`<faceplate-textarea-input size="expanded" appearance="${a.a.SECONDARY}" class="mb-sm" name="textarea" faceplate-focusable required .value="${this.modMessageBody}" @input="${this.handleTextChange}"> <span slot="label">${"Request to join"}</span> </faceplate-textarea-input>`:t.A} </div> <div class="flex justify-end gap-md p-md pt-0"> ${this.isPrivate?e.o({appearance:"secondary",attributes:{onclick:()=>{return e.i(this,(a=this.subredditType,e.b({source:"content_gate",action:"click",noun:"go_to_homepage_button"},{action_info:{setting_value:a}})));var a},href:"/"},children:"Go To Homepage"}):e.o({appearance:"secondary",attributes:{onclick:()=>{return e.i(this,(a=this.subredditType,e.b({source:"content_gate",action:"click",noun:"go_to_community_button"},{action_info:{setting_value:a}})));var a},href:`/${this.prefixedSubredditName}`},children:"Go To Community"})} ${this.allowJoinRequests?e.o({appearance:"primary",attributes:{onclick:this.requestToJoin,disabled:!this.modMessageBody},size:e.q.Medium,children:"Send Request"}):e.o({appearance:"primary",attributes:{onclick:()=>{return e.i(this,(a=this.subredditType,e.b({source:"content_gate",action:"click",noun:"message_mods_button"},{action_info:{setting_value:a}})));var a},href:`/message/compose?to=${encodeURIComponent(this.prefixedSubredditName)}`},size:e.q.Medium,children:"Message Mods"})} </div> </div>`}get isPrivate(){return"private"===this.subredditType}getBgImagePath(){const a=this.isLoggedIn?"home":"popular",t=e.ae()?"dark":void 0,i=this.isDesktop?void 0:"mobile";return`${CLIENT_CONFIG.STATIC_BASE_URL}assets/feeds/${[a,t,i].filter(Boolean).join("-")}.jpg`}connectedCallback(){super.connectedCallback(),this.allowJoinRequests&&this.hasPendingRequest()&&(this.allowJoinRequests=!1),"private"===this.subredditType&&this.updateComplete.then((()=>{this?.dialog?.addEventListener("rpl-dialog:request-close",this.preventDefault),this?.dialog?.showModal()}))}disconnectedCallback(){super.disconnectedCallback(),"private"===this.subredditType&&this?.dialog?.removeEventListener("rpl-dialog:request-close",this.preventDefault),this?.dialog?.hide()}render(){return t.x`<rpl-dialog dialog-id="protected-community-modal" overlay-blur ?open="${this.open}" .litTemplateChildren="${this.renderTemplate()}"> </rpl-dialog>${"private"===this.subredditType&&this.open?t.x` <div class="blurred-bg h-screen-without-header w-100 bg-no-repeat bg-cover" style="background-image:url('${this.getBgImagePath()}')"> <div class="shade h-full w-full"></div> </div>`:t.A}`}};s.styles=[e.t],e._([e.n({type:String,attribute:"subreddit-id"})],s.prototype,"subredditId",void 0),e._([e.n({type:String,attribute:"prefixed-name"})],s.prototype,"prefixedSubredditName",void 0),e._([e.n({type:String,attribute:"banner"})],s.prototype,"banner",void 0),e._([e.n({type:String,attribute:"icon"})],s.prototype,"icon",void 0),e._([e.n({type:String,attribute:"icon-color"})],s.prototype,"iconColor",void 0),e._([e.n({type:String,attribute:"subreddit-description"})],s.prototype,"subredditDescription",void 0),e._([e.n({type:Boolean,attribute:"allow-join-requests",reflect:!0})],s.prototype,"allowJoinRequests",void 0),e._([e.n({type:String,attribute:"last-join-request",converter:{fromAttribute:o}})],s.prototype,"lastJoinRequest",void 0),e._([e.n({type:String,attribute:"subreddit-type"})],s.prototype,"subredditType",void 0),e._([e.n({type:Boolean,attribute:"is-commenting-restricted"})],s.prototype,"isCommentingRestricted",void 0),e._([e.n({type:Boolean,attribute:"is-posting-restricted"})],s.prototype,"isPostingRestricted",void 0),e._([e.n({type:Boolean})],s.prototype,"open",void 0),e._([e.n({type:Boolean})],s.prototype,"isLoggedIn",void 0),e._([e.n({type:Boolean})],s.prototype,"isDesktop",void 0),e._([e.h()],s.prototype,"modMessageBody",void 0),e._([e.a2("rpl-dialog")],s.prototype,"dialog",void 0),s=e._([e.e("protected-community-modal")],s);let r=class extends t.s{constructor(){super(...arguments),this.appearance="primary",this.size=e.q.Medium,this.unstyled=!1,this.hasPendingRequest=()=>n(this.lastJoinRequest),this.handleOpenModal=a=>{var t;this.hasPendingRequest()&&this.pendingLink||!this._modal||(a.preventDefault(),a.stopPropagation(),this._modal.showModal(),e.i(this,(t=this._modal.subredditType,e.b({source:"content_gate",action:"click",noun:"request_approval_button"},{action_info:{setting_value:t}}))))},this.handleKeydown=e=>{"Enter"!==e.key&&"Space"!==e.key||this.handleOpenModal(e)}}get _modal(){return document.querySelector("protected-community-modal")}render(){return this.unstyled?t.x`<slot @click="${this.handleOpenModal}" @keydown="${this.handleKeydown}" name="${e.ad(this.hasPendingRequest()?"pending-request":void 0)}"></slot>`:e.o({appearance:this.appearance,size:this.size,attributes:{href:this.hasPendingRequest()&&this.pendingLink?this.pendingLink:void 0,disabled:this.disabledWhenPending&&this.hasPendingRequest(),onclick:this.handleOpenModal},children:t.x`<slot name="${e.ad(this.hasPendingRequest()?"pending-request":void 0)}"></slot>`})}};r.styles=[e.t],e._([e.n({type:String})],r.prototype,"appearance",void 0),e._([e.n({type:String})],r.prototype,"size",void 0),e._([e.n({type:Boolean})],r.prototype,"unstyled",void 0),e._([e.n({type:Boolean,attribute:"disabled-when-pending"})],r.prototype,"disabledWhenPending",void 0),e._([e.n({type:String,attribute:"pending-link"})],r.prototype,"pendingLink",void 0),e._([e.n({type:String,attribute:"last-join-request",converter:{fromAttribute:o}})],r.prototype,"lastJoinRequest",void 0),r=e._([e.e("protected-community-modal-trigger")],r)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("DWhb02bbsY",["Dw4vb8Yfbm"],(async a=>{const{svg:t}=a.a();return{t:a.m(t`<path d="M19.016 17.572l-3.668-9.787a1.15 1.15 0 00-2.151 0L9.54 17.573a.964.964 0 001.81.66l.755-2.307h4.339l.763 2.31a.963.963 0 101.808-.664zm-6.32-3.3l1.576-4.5 1.59 4.5h-3.166zm-3.147-.608l.63-1.688a8.257 8.257 0 01-2.655-1.632 12.859 12.859 0 002.313-5.47h1.606a.9.9 0 000-1.8H7.2v-.761a.9.9 0 00-1.8 0v.761H1.16a.9.9 0 000 1.8h1.6a12.864 12.864 0 002.31 5.472 8.36 8.36 0 01-4.1 2.036.9.9 0 10.319 1.771 10.24 10.24 0 005.01-2.472c.948.86 2.051 1.532 3.25 1.98v.003zm-1.55-8.79a11.084 11.084 0 01-1.7 4.072 11.055 11.055 0 01-1.7-4.072H8z"></path>`,"0 0 20 20","translate")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("DXiBrmAMuC",["Dw4vb8Yfbm","5r73EsgItq"],(async(t,s)=>{const e=s.s,o=new DOMParser;let d=class extends e{constructor(){super(...arguments),this.userId="",this.subredditId="",this.pubsub=new t.u(this),this.onUpdateFlairEvent=({html:t,subredditId:s,userId:e,isEnabled:d})=>{if(this.userId===e&&this.subredditId===s){const s=t&&d,e=s?t:'<span class="hidden"></span>',i=o.parseFromString(e,"text/html").body.firstChild;if(i){const t=this.shadowRoot?.querySelector("slot"),e=t?.assignedElements({flatten:!0})[0];e?e.replaceWith(i):this.appendChild(i),s?this.showHost():this.hideHost()}}}}static get styles(){return s.a`:host{--display:flex;display:var(--display);overflow:hidden}`}onSlotChanged(t){const s=t.target?.assignedElements({flatten:!0});s?.some((t=>"SPAN"===t.nodeName&&t.classList.contains("hidden")))&&this.hideHost()}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(t.T.CommunityAuthorFlairUpdated,this.onUpdateFlairEvent)}hideHost(){(this.shadowRoot?.host).style.setProperty("--display","none")}showHost(){(this.shadowRoot?.host).style.setProperty("--display","flex")}render(){return s.x`<slot @slotchange="${this.onSlotChanged}"></slot>`}};t._([t.n()],d.prototype,"userId",void 0),t._([t.n()],d.prototype,"subredditId",void 0),d=t._([t.e("author-flair-event-handler")],d)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./ankOzFFj6Q.js",import.meta.url,"ankOzFFj6Q");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("DY8-AkxZ56",["Dw4vb8Yfbm","ankOzFFj6Q","5r73EsgItq"],(async(e,t,a)=>{const r=t=>{if(!e.a8.isAvailable())return!0;return e.a8.getItem(e.a9.DevvitGamesSectionFeaturedGameSlug)!==t};let s=class extends a.s{constructor(){super(...arguments),this.lastUpdated=0,this.inline=!1,this.isBadgeActive=!1,this.featuredGameSlug="",this.badgeAllowed=!1,this.appearance="badge",this._onGameBadgeWrapperClick=()=>{this.isBadgeActive=!1,this.dispatchEvent(e.c("games-section-badge-wrapper-click"))}}willUpdate(e){super.willUpdate(e),e.has("featuredGameSlug")&&(this.isBadgeActive=Boolean(this.featuredGameSlug)&&this.badgeAllowed&&r(this.featuredGameSlug))}render(){const e=this.inline,r="label"===this.appearance;return a.x` <div class="${e?"":"relative"}" @click="${this._onGameBadgeWrapperClick}" @keydown="${this._onGameBadgeWrapperClick}"> <slot></slot> ${this.isBadgeActive?r?a.x`<rpl-badge class="${e?"":"absolute -top-2xs end-xs"}" appearance="${t.R.Alert}"> ${"NEW"} </rpl-badge>`:a.x` <rpl-badge class="${e?"":"absolute top-xs end-xs"}" appearance="${t.R.Alert}"></rpl-badge>`:a.A} </div>`;}};return s.styles=[e.t],e._([e.n({attribute:"last-updated",type:Number})],s.prototype,"lastUpdated",void 0),e._([e.n({type:Boolean})],s.prototype,"inline",void 0),e._([e.n({type:Boolean})],s.prototype,"isBadgeActive",void 0),e._([e.n({attribute:"featured-game-slug",type:String})],s.prototype,"featuredGameSlug",void 0),e._([e.n({type:Boolean})],s.prototype,"badgeAllowed",void 0),e._([e.n({type:String})],s.prototype,"appearance",void 0),s=e._([e.e("games-section-badge-wrapper")],s),{s:r}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("DZ58bPdK5X",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,t)=>{let s=class extends t.s{constructor(){super(...arguments),this.pubsub=new e.u(this),this.handleToggleSidebar=e=>{e&&e.src?this.openSidebar(e.src):this.closeSidebar()}}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.NotificationToggleSidebar,this.handleToggleSidebar)}openSidebar(t){const s=document.getElementById("right-sidebar-container"),i=document.getElementById("notifications-right-sidebar-content");if(!s||!i)return;s.classList.remove("hidden"),s.classList.add("flex"),this.classList.remove("hidden"),i.replaceChildren();const n=e.fL("faceplate-partial",{id:"aggregated-notifications-partial",src:t,loading:e.y.Eager}),a=document.createElement("shreddit-loading");n.appendChild(a),i.appendChild(n),window.scrollTo({top:0,behavior:"smooth"})}closeSidebar(){const e=document.getElementById("right-sidebar-container");if(!e)return;e.classList.add("hidden"),this.classList.add("hidden");const t=document.getElementById("aggregated-inbox-content");t?.remove()}render(){return t.x`<slot></slot>`}};s=e._([e.e("notifications-sidebar-manager")],s);let i=class extends t.s{constructor(){super(...arguments),this.pubsub=new e.u(this),this.handleToggleSidebar=e=>{const t=document.querySelector(".main-container");t&&(e&&e.src?t.style.gridTemplateColumns="66% 32%":t.style.removeProperty("grid-template-columns"))}}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(e.T.NotificationToggleSidebar,this.handleToggleSidebar)}render(){return t.x` <div class="flex flex-col"><slot></slot></div>`}};i=e._([e.e("notifications-main-manager")],i)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("DZO4dWmzHb",["Dw4vb8Yfbm"],(async a=>{const{svg:t}=a.a();return{e:a.m(t`<path d="M14.016 3.8c.583 0 1.132.227 1.545.64.413.413.64.961.64 1.545a2.17 2.17 0 01-.64 1.545l-8.67 8.67-3.079-.01-.01-3.079 8.669-8.671c.413-.413.962-.64 1.545-.64zm0-1.8a3.97 3.97 0 00-2.817 1.167l-8.948 8.947a.858.858 0 00-.251.609l.014 4.408a.858.858 0 00.855.855L7.277 18h.003c.227 0 .446-.09.606-.251l8.947-8.947A3.985 3.985 0 0014.016 2z"></path>`,"0 0 20 20","edit")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("D_4HUCmNhm",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,t)=>{let r=class extends t.s{constructor(){super(...arguments),this.inputSelector=e.s.HeaderLarge}static get styles(){return[e.t]}get focusSearchInput(){return{[e.s.HeaderSmall]:document.querySelector(this.inputSelector)?.handleToggleSearchDialog,[e.s.HeaderLarge]:document.querySelector(this.inputSelector)?.focusSearchInput,[e.s.PdpCommentSearchInput]:document.querySelector(this.inputSelector)?.focusSearchInput,[e.s.SearchInputSmall]:document.querySelector(this.inputSelector)?.focusSearchInput}[this.inputSelector]}onClick(e){e.preventDefault(),e.stopPropagation(),this.focusSearchInput?.()}render(){return t.x`<a class="text-primary no-visited" href="#" @click="${this.onClick}"><slot></slot></a>`}};e._([e.n({attribute:"input-selector",type:String})],r.prototype,"inputSelector",void 0),r=e._([e.e("adjust-search-query-link")],r)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("D_6DXw1u0k",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6"],(async(e,a,t)=>{let r=class extends e.hI{constructor(){super(...arguments),this._fullscreenBlurEl=document.createElement("div"),this._appliedBlurFilter=null,this._blurElement=null,this.shouldContentScroll=!1,this.isFooterEmpty=!0,this.render=()=>{const t=a.x`<slot name="closeButton" class="${e.Z({floating:this.shouldContentScroll})}"></slot>`,r=a.x`<div id="header" class="${e.Z({"with-icon":this._titleGraphic.length>0})}"> <slot name="titleGraphic"></slot> <slot name="title"></slot> </div>`,n=a.x`<slot name="primaryButton" @slotchange="${this.calcFooterChildren}"></slot> <slot name="secondaryButton" @slotchange="${this.calcFooterChildren}"></slot> <slot name="tertiaryButton" @slotchange="${this.calcFooterChildren}"></slot>`;return a.x` ${e.cO(this.modal?"\n  <style>\n    :host {\n      top: 50%;\n      transform: translateY(-50%);\n      position: fixed;\n    }\n  </style>\n":"\n  <style>\n    :host {\n      position: absolute;\n    }\n  </style>\n")} <div id="wrapper" role="${e.ad(this.open?"dialog":void 0)}" aria-label="${e.ad(this.ariaLabel??void 0)}" aria-labelledby="${e.ad(null!=this.ariaLabel?void 0:"header-container")}" aria-modal="${e.ad(this.open&&this.modal?"true":void 0)}"> <div id="content"> ${t} <div id="header-container">${r}</div> <slot></slot> </div> <div id="footer" class="${e.Z({"sticky-footer":this.shouldContentScroll,empty:this.isFooterEmpty})}"> ${n} <slot name="footer" @slotchange="${this.calcFooterChildren}"></slot> </div> </div> `}}static get styles(){return a.a`${e.hI.styles}:host{--content-padding:var(--spacer-md);box-sizing:border-box;max-width:none;border-radius:var(--rem16);padding:0;overflow:hidden}#wrapper{display:flex;flex-direction:column;align-items:center;height:100%;position:relative;font-size:16px;box-sizing:border-box;max-height:inherit;min-height:inherit;overflow:hidden}slot[name=closeButton]{display:inline-flex;position:absolute;position:absolute;top:0;inset-inline-end:0;margin:var(--content-padding)}#header{display:flex;flex-direction:column;gap:var(--spacer-sm);align-items:center;text-align:start;width:100%;box-sizing:border-box}#header.with-icon{text-align:center;padding:0 var(--rem40)}slot[name=title]{font-size:var(--rem18);font-weight:700}slot:not([name]){display:flex;flex-grow:1;width:100%;padding:var(--spacer-xs) 0;font-size:var(--rem14)}#footer{display:flex;flex-direction:column;gap:var(--spacer-sm);width:100%;background:var(--color-ui-modalbackground);padding:var(--spacer-md);box-sizing:border-box}slot[name=tertiaryButton]{display:inline-flex;justify-content:center;font-size:14px}#footer.empty{display:none}@media (min-width:640px){#content{padding:var(--content-padding)}#header,#header.with-icon{flex-direction:row;padding-inline:0 var(--spacer-2xl)}#footer{flex-direction:row-reverse;align-items:center;justify-content:end}slot[name=tertiaryButton]{margin-inline-end:auto}slot[name=title]{text-align:start}}#content{height:100%;max-height:100%;width:100%;overflow:auto;position:relative;--content-padding:var(--spacer-md);padding:var(--content-padding);box-sizing:border-box;flex:1}.overflowing-content{max-height:100%;overflow-y:auto}.sticky-footer{box-shadow:var(--elevation-md)}slot[name=closeButton].floating{box-shadow:var(--elevation-sm);border-radius:999px}`}connectedCallback(){super.connectedCallback(),Object.assign(this._fullscreenBlurEl.style,{position:"fixed",top:"0",bottom:"0",right:"0",left:"0",backdropFilter:n(4)})}disconnectedCallback(){this._fullscreenBlurEl.remove(),e.hB.remove(this),this.resizeObserver?.disconnect()}firstUpdated(){this.resizeObserver=new ResizeObserver((()=>{this.measureShouldContentScroll()})),this.resizeObserver.observe(this.content)}calcFooterChildren(){this.isFooterEmpty=!(this._footerSlot?.length||this._primaryButtonSlot?.length||this._secondaryButtonSlot?.length||this._tertiaryButtonSlot?.length)}measureShouldContentScroll(){this.shouldContentScroll=Boolean(this.content?.scrollHeight&&this.content?.scrollHeight>this.content.offsetHeight)}showModal(a){if(e.hB.add(this),super.showModal(),null!=a?.blur){const e=!0===a.blur?4:Number(a.blur);this._appliedBlurFilter=n(e),a?.blurElement?(this._blurElement=a.blurElement,t=this._blurElement,r=this._appliedBlurFilter,t.style.filter=t.style.filter+" "+r):(Object.assign(this._fullscreenBlurEl.style,{backdropFilter:this._appliedBlurFilter}),document.body.append(this._fullscreenBlurEl))}var t,r}close(){this.open&&(super.close(),e.hB.remove(this),null!=this._blurElement&&null!=this._appliedBlurFilter?(!function(e,a){const t=e.style.filter.split(" ").filter(Boolean).reverse(),r=t.indexOf(a);if(-1===r)return;t.splice(r,1),e.style.filter=t.reverse().join(" ")}(this._blurElement,this._appliedBlurFilter),this._appliedBlurFilter=null,this._blurElement=null):this._fullscreenBlurEl.remove())}};function n(e){return`blur(${e}px)`}e._([e.h()],r.prototype,"shouldContentScroll",void 0),e._([e.l({slot:"titleGraphic"})],r.prototype,"_titleGraphic",void 0),e._([e.a2("#content")],r.prototype,"content",void 0),e._([e.a2("#footer")],r.prototype,"footer",void 0),e._([e.h()],r.prototype,"isFooterEmpty",void 0),e._([e.aC({slot:"footer",flatten:!0})],r.prototype,"_footerSlot",void 0),e._([e.aC({slot:"primaryButton",flatten:!0})],r.prototype,"_primaryButtonSlot",void 0),e._([e.aC({slot:"secondaryButton",flatten:!0})],r.prototype,"_secondaryButtonSlot",void 0),e._([e.aC({slot:"tertiaryButton",flatten:!0})],r.prototype,"_tertiaryButtonSlot",void 0),r=e._([e.e("faceplate-modal")],r);const o=()=>"Something went wrong saving the avatar.",i=()=>"Something went wrong while saving the banner.";function l(e){return e?.[0]?.message??"Something went wrong";}const s=e=>({error:e||"There was an error uploading the file."});async function d(a,r){const n=t.R.get(a.type);if(!n)throw new Error(`${a.type} files are not supported.`);try{const o=await async function(a){const t=await e.Y({operation:e.O.CreateSubredditStructuredStylesUploadLease,variables:{input:a}});if(t.errors?.length)throw new Error(l(t.errors));const r=t.data.createSubredditStructuredStylesUploadLease;if(r?.ok&&r.uploadLease)return{uploadLeaseUrl:r.uploadLease.uploadLeaseUrl,uploadLeaseHeaders:r.uploadLease.uploadLeaseHeaders};throw new Error(l(r?.errors))}({...r,filepath:a.name,mimetype:n}),i=await t.T(a,o);return i?{url:i}:s()}catch(e){return o=e.message,window.Sentry?.captureMessage?.(`Media file upload failed with error: ${o}`),s(e.message)}var o}return {C:class{constructor(){this.url=void 0}async makeGQLRequest(...a){return e.Y(...a)}async uploadMedia(...e){return d(...e)}async saveImage({subredditId:e,url:a,fileContent:t,uploadType:r,gqlOperation:n}){if(t)try{const n=await this.uploadMedia(t,{subredditId:e,imagetype:r});if(a=n.url?decodeURIComponent(n.url):a,n.error)return this.handleError(r);this.url=a}catch(e){return this.handleError(r)}try{await this.makeGQLRequest({operation:n,variables:{input:{subredditId:e,[this.getOperationArg(r)]:a??""}}})}catch(e){return this.handleError(r)}return null}async saveCommunityIcon(a,t,r){return this.saveImage({subredditId:a,url:t,fileContent:r,uploadType:e.hJ.CommunityIcon,gqlOperation:e.O.UpdateSubredditIcon})}async saveBanner(a,t,r){return this.saveImage({subredditId:a,url:t,fileContent:r,uploadType:e.hJ.BannerBackgroundImage,gqlOperation:e.O.UpdateSubredditBanner})}async saveMobileBanner(a,t,r){return this.saveImage({subredditId:a,url:t,fileContent:r,uploadType:e.hJ.MobileBannerImage,gqlOperation:e.O.UpdateSubredditBanner})}handleError(a){switch(a){case e.hJ.BannerBackgroundImage:return i();case e.hJ.MobileBannerImage:return "Something went wrong while saving the mobile banner.";case e.hJ.CommunityIcon:default:return o()}}getOperationArg(a){switch(a){case e.hJ.BannerBackgroundImage:return"bannerBackgroundImage";case e.hJ.MobileBannerImage:return"mobileBannerImage";case e.hJ.CommunityIcon:default:return"communityIcon"}}},E:i,get F(){return r},O:"mod-show-post-level-crowd-control-modal",a:o,u:d};}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("D_g7f2Ewyi",["Dw4vb8Yfbm"],(async e=>{var t;!function(e){e.Small="sm",e.Medium="md"}(t||(t={}));const n=e=>{let t;return"boolean"==typeof e&&(t=e?"true":"false"),t},a=a=>{const{anchorAttributes:s,appearance:l,description:c,disabled:o,href:d,innerClassName_DO_NOT_USE:p,label:u,leadingAvatar:x,leadingIcon:f,noXPadding:m=!1,onClick:y,selected:$,size:h=t.Medium,trailingSlot:b,attributes:g,suppressHoverStyles:v=!1}=a,k=!$&&a.hasTransparentBackground,{html:w,createElement:E,ifDefined:S}=e.a(),{role:j,tabindex:M}=g??{},I=Boolean(M??g?.onclick??a.onClick),N=I?parseInt(M??"0"):void 0,T=!v&&(null!=d||I),_=e=>{return t=e,T?t:"";var t},D=["flex justify-between relative",(m?"px-xs -mx-xs":"px-md")+" gap-[0.5rem]","danger"===l?$?"text-danger-content":`text-danger-content ${_("hover:text-danger-content-hover")}`:$?"text-secondary-onBackground":`text-secondary ${_("hover:text-secondary-hover")}`,`${k?"":$?`bg-neutral-background-selected ${_("hover:bg-neutral-background-selected")}`:`${_("active:bg-interactive-pressed")}`} ${_("hover:bg-neutral-background-hover")}`,`${_("hover:no-underline")}`,`${_("cursor-pointer")}`,o?"opacity-60 pointer-events-none":"",h===t.Medium?"py-xs":"py-2xs"," -outline-offset-1",p].join(" "),P=w` <span class="flex items-center gap-xs min-w-0 shrink"> ${f?w` <span class="flex shrink-0 items-center justify-center h-xl w-xl text-20 leading-4"> ${f} </span>`:void 0} ${x?w`<span class="flex shrink-0 items-center justify-center h-xl w-xl"> <span class="text-20 leading-4">${x}</span> </span>`:void 0} <span class="flex flex-col justify-center min-w-0 shrink py-[var(--rem6)]"> <span class="text-body-2">${u}</span> <span class="text-caption-1 text-secondary-weak">${c}</span> </span> </span> ${i(b)} `;return d?E("a",{...s,role:j,href:d,tabindex:N,onclick:y,className:`${D} ${s?.className?s.className:""} no-underline`,style:`padding-inline-end: ${r(a)}`},P):w`<div aria-disabled="${S(n(o)||g?.["aria-disabled"])}" aria-selected="${S(n($)||g?.["aria-selected"])}" role="${S(j)}" tabindex="${S(N)}" class="${D}" @click="${y}" @keydown="${e=>{"Enter"!==e.code&&"Space"!==e.code||!y||y(e)}}" style="padding-inline-end:${r(a)}"> ${P} </div>`};function r({trailingSlot:e}){if("object"!=typeof e||!("type"in e))return"16px";switch(e.type){case"iconButton":return"58px";case"switchInput":return"80px";default:return"16px"}}const s=t=>{if("object"!=typeof t||!("type"in t))return null;const{html:n}=e.a();return n`<div class="absolute top-1/2" style="inset-inline-end:${function(e){if("object"!=typeof e||!("type"in e))return"16px";switch(e.type){case"iconButton":return"10px";case"switchInput":return"8px";default:return"16px"}}(t)};transform:translateY(-50%)"> ${t.content} </div>`},i=t=>{if("object"==typeof t&&"type"in t)return null;const{html:n}=e.a();return n`<span class="flex items-center shrink-0"> <span class="flex items-center justify-center h-lg">${t}</span> </span>`};let l=e.r;return{get L(){return t},l:t=>{const{attributes:n,trailingSlot:r,selected:i,liRole:l}=t,{html:c,createElement:o}=e.a(),{role:d,tabindex:p,"aria-disabled":u,"aria-selected":x,...f}=n||{},m=c`${a(t)} ${s(r)}`;return o("li",{...f,className:`relative list-none mt-0 ${n?.className||""}`,rpl:!0,rplSelected:i,role:l||"presentation"},m)},s:async(t,{isEditMode:n=!1,preselectFlairId:a}={})=>{try{return await l({name:e.h4,renderMode:e.P.Contents,queryParams:{postId:t,isEditMode:n?"true":"false",...void 0!==a&&{preselectFlairId:a}}}),!0}catch{return!1}}}}));
SML.di("./ClaQym8zez.js",import.meta.url,"ClaQym8zez");SML.di("./wlDl99ww9T.js",import.meta.url,"wlDl99ww9T");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BLbwpJ0bjx.js",import.meta.url,"BLbwpJ0bjx");SML.di("./Chd9fEZKZ6.js",import.meta.url,"Chd9fEZKZ6");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./BOFc1KQJc-.js",import.meta.url,"BOFc1KQJc-");SML.di("./Z0tk4vmzIQ.js",import.meta.url,"Z0tk4vmzIQ");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");SML.di("./D-MP0EoIqA.js",import.meta.url,"D-MP0EoIqA");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");
SML.dm("Da2TshiLAy",["Dw4vb8Yfbm","5r73EsgItq","BLbwpJ0bjx","Chd9fEZKZ6","D_g7f2Ewyi","BOFc1KQJc-","Z0tk4vmzIQ","xrDbp1ee_h","ClaQym8zez","wlDl99ww9T","BYzqEZ3uv3","eY7T41bKac","D-MP0EoIqA","Cv4mWnWE30","B-zFJtiar6","C8QDHFSIkY"],(async(e,a,n,t,r,o,i,s)=>{const d=a.s;let u=class extends d{constructor(){super(...arguments),this.contentId="",this.isSnoozed=!1,this.reportReason="",this.pubsub=new e.u(this),this.onPostUpdateAction=e=>{if(e.postId!==this.contentId)return;const{action:a}=e;switch(a){case i.a.snoozeReporter:this.isSnoozed=!0;break;case i.a.unsnoozeReporter:this.isSnoozed=!1}},this.onCommentUpdateAction=e=>{if(e.commentId!==this.contentId)return;const{action:a}=e;switch(a){case o.C.snoozeReporter:this.isSnoozed=!0;break;case o.C.unsnoozeReporter:this.isSnoozed=!1}}}connectedCallback(){super.connectedCallback(),s.h(this.contentId)?this.pubsub.subscribe(e.T.PostUpdated,this.onPostUpdateAction):this.pubsub.subscribe(e.T.CommentUpdated,this.onCommentUpdateAction)}renderReportOverflowMenu(){const o="Snooze reporter",i="Pause reports from this user for 7 days",s="Un-snooze reporter",d="Receive reports from this user again";return a.x` <mod-dropdown-closer> <faceplate-dropdown-menu @click="${e=>e.stopPropagation()}" position="bottom-end"> ${e.o({appearance:"plain",size:e.q.ExtraSmall,children:t.o({size:a.I.ExtraSmall})})} <faceplate-menu slot="menu"> ${r.l({label:this.isSnoozed?s:o,description:this.isSnoozed?d:i,leadingIcon:n.n({size:a.I.Small}),onClick:this.toggleSnooze})} </faceplate-menu> </faceplate-dropdown-menu> </mod-dropdown-closer> `}sendTrackingEvent(a,n,t){const r=t?"snoozereports":"unsnoozereports",o=s.h(a)?"post":"comment",i=s.h(a)?a:null,d=s.h(a)?null:a,u=e.b({source:"moderator",action:r,noun:o},{...(i && {post:{id:i}}),...(d && {comment:{id:d}}),...(n && {action_info:{reason:n}})});e.i(this,u)}showToast({success:a,isSnoozed:n}){const t="Reports from these users will be paused",r="Reports from these users will be resumed",o="Failed to update reports",i=a?n?t:r:o,s=a?e.a5.info:e.a5.error,d=e.c("faceplate-alert",{level:s,message:i});this.dispatchEvent(d)}async updateReportState(a){try{const{data:n}=await e.Y({operation:e.O.UpdateReportState,variables:{input:{itemId:this.contentId,reportText:this.reportReason,isSnoozed:a}}});return n?.updateReport?.ok??!1}catch(e){return!1}}async toggleSnooze(a){const n=!this.isSnoozed;this.sendTrackingEvent(this.contentId,this.reportReason,n);const t=await this.updateReportState(n);t&&(n?s.h(this.contentId)?this.pubsub.publish(e.T.PostUpdated,{postId:this.contentId,action:i.a.snoozeReporter,value:!0}):this.pubsub.publish(e.T.CommentUpdated,{commentId:this.contentId,action:o.C.snoozeReporter,value:!0}):s.h(this.contentId)?this.pubsub.publish(e.T.PostUpdated,{postId:this.contentId,action:i.a.unsnoozeReporter,value:!0}):this.pubsub.publish(e.T.CommentUpdated,{commentId:this.contentId,action:o.C.unsnoozeReporter,value:!0})),this.showToast({success:t,isSnoozed:this.isSnoozed})}render(){const n={"flex items-center m-0 p-0":!0,"bg-secondary-background":this.isSnoozed};return a.x`<li class="${e.Z(n)}"> <slot name="${e.ad(this.isSnoozed?"snoozed":void 0)}" class="flex-auto block"></slot> ${this.renderReportOverflowMenu()} </li> `}};u.styles=[e.t],e._([e.n({type:String,attribute:"content-id"})],u.prototype,"contentId",void 0),e._([e.n({type:Boolean,attribute:"is-snoozed"})],u.prototype,"isSnoozed",void 0),e._([e.n({type:String,attribute:"report-reason"})],u.prototype,"reportReason",void 0),u=e._([e.e("user-report-summary")],u)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("DasPtA-dN5",["Dw4vb8Yfbm"],(async a=>{const{svg:l}=a.a();return{c:a.m(l`<path d="M18.035 7.667l-5.703-5.702a3.303 3.303 0 00-4.666 0L1.963 7.667a3.304 3.304 0 000 4.666l5.702 5.702A3.293 3.293 0 009.998 19c.844 0 1.69-.322 2.334-.965l5.701-5.702a3.304 3.304 0 00.002-4.666zm-6.982-2.456l-.25 6.058h-1.58l-.25-6.058h2.08zm-.007 8.988a1.157 1.157 0 01-.44.433 1.229 1.229 0 01-.614.157 1.196 1.196 0 01-1.041-.59 1.195 1.195 0 01-.161-.61 1.213 1.213 0 01.598-1.051c.184-.11.385-.165.604-.165a1.206 1.206 0 011.216 1.215c0 .223-.055.427-.162.611z"></path>`,"0 0 20 20","caution-fill")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("DbJ72GsAzT",["Dw4vb8Yfbm"],(async c=>{const{svg:m}=c.a();return{p:c.m(m`<path d="M10 1c-4.96 0-9 4.04-9 9s4.04 9 9 9 9-4.04 9-9-4.04-9-9-9zm0 4.5c1.52 0 2.75 1.23 2.75 2.75S11.52 11 10 11 7.25 9.77 7.25 8.25 8.48 5.5 10 5.5zm-4.97 9.69C5.91 13.31 7.8 12 10 12c2.2 0 4.09 1.31 4.97 3.19A7.153 7.153 0 0110 17.2c-1.93 0-3.68-.77-4.97-2.01z"></path>`,"0 0 20 20","profile-fill")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Chd9fEZKZ6.js",import.meta.url,"Chd9fEZKZ6");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./BhZAdnVq89.js",import.meta.url,"BhZAdnVq89");SML.di("./DdOxCDp7Tq.js",import.meta.url,"DdOxCDp7Tq");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");SML.di("./av6qvYZJJ7.js",import.meta.url,"av6qvYZJJ7");SML.di("./jFB0DOsi41.js",import.meta.url,"jFB0DOsi41");SML.di("./_C4HT6j0ig.js",import.meta.url,"_C4HT6j0ig");SML.di("./DflF56Kkuz.js",import.meta.url,"DflF56Kkuz");SML.di("./BYpE6FdcdE.js",import.meta.url,"BYpE6FdcdE");SML.di("./Dw4K28bgT7.js",import.meta.url,"Dw4K28bgT7");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./CdmJSaSHd8.js",import.meta.url,"CdmJSaSHd8");SML.di("./DJSLRtH1XX.js",import.meta.url,"DJSLRtH1XX");SML.di("./DT9eLCODQW.js",import.meta.url,"DT9eLCODQW");SML.di("./BLbwpJ0bjx.js",import.meta.url,"BLbwpJ0bjx");SML.di("./kS-PCwPq_X.js",import.meta.url,"kS-PCwPq_X");
SML.dm("Dc3SyJ2ZoZ",["Dw4vb8Yfbm","5r73EsgItq","Chd9fEZKZ6","D_g7f2Ewyi","BhZAdnVq89","DdOxCDp7Tq","Dw4K28bgT7","BwcMg3lXAs","CdmJSaSHd8","DJSLRtH1XX","DT9eLCODQW","BLbwpJ0bjx","kS-PCwPq_X","BYzqEZ3uv3","eY7T41bKac","av6qvYZJJ7","jFB0DOsi41","_C4HT6j0ig","DflF56Kkuz","BYpE6FdcdE"],(async(e,t,i,a,s,n,r,o,d,l,u,c,h)=>{const m=({notificationLevel:t,isEnablingUpdates:i})=>{if(i)switch(t){case e.iw.Off:case null:return e.iw.Low;case e.iw.Low:case e.iw.Frequent:default:return e.iw.Frequent}else switch(t){case e.iw.Frequent:return e.iw.Low;case e.iw.Low:default:return e.iw.Off}};let p=class extends t.s{constructor(){super(...arguments),this.messageType="",this.notificationLevel=null,this.notificationId="",this.userId="",this.userName="",this.postId="",this.commentId="",this.subredditId="",this.subredditName="",this.isHideEligible=!1,this.isToggleUpdateFromSubredditEligible=!1,this.isToggleNotificationUpdateEligible=!1,this.isToggleLowUpdateFromSubredditEligible=!1,this.shouldDecoupleInboxSettings=!1,this.isMobile=!1,this.isM2InboxExperiment=!1,this.followedKeywordId="",this.followedKeyword="",this.hideRemoveButton=!1,this.isAggregation=!1,this.groupType="",this.groupContentId="",this.isDialogOpened=!1,this.initialNotificationLevel=null,this.muteConfirmationModal=e.a3(),this.isNotificationLevelOff=()=>!this.notificationLevel||this.notificationLevel===e.iw.Off,this.getIsRead=()=>this.isM2InboxExperiment?!this.querySelector("rpl-inbox-row[selected]"):!this.closest("notification-item")?.querySelector(`.${n.u}`),this.shouldRenderHide=()=>this.isHideEligible&&this.isMobile,this.shouldRenderDisableUpdates=()=>this.isToggleNotificationUpdateEligible&&(this.postId||this.commentId),this.shouldRenderDisableUpdatesFromSubreddit=()=>this.subredditId&&this.isToggleUpdateFromSubredditEligible,this.shouldRenderBlockThisUser=()=>this.userId&&this.userName&&this.messageType&&[e.fw.ChatAcceptInvite,e.fw.ChatMessage,e.fw.ChatMessageReaction,e.fw.ChatRequest,e.fw.AwardReceived].includes(this.messageType),this.shouldRenderManageCommunityNotifications=()=>this.subredditId&&this.isToggleLowUpdateFromSubredditEligible,this.shouldRenderManageThisNotification=()=>this.shouldDecoupleInboxSettings&&this.messageType,this.shouldRenderRemoveKeywordAlert=()=>!(!this.followedKeyword||!this.followedKeywordId||this.messageType!==e.fw.KeywordFollow),this.shouldRenderTurnOffKeywordAlerts=()=>this.messageType===e.fw.KeywordFollow,this.shouldRenderMute=()=>!!this.subredditId,this.hideNotification=async()=>{try{const t=await e.Y({operation:e.O.DeleteInboxNotifications,variables:{input:{notificationIds:[this.notificationId],...(this.isAggregation ? {groupType:"post"===this.groupType?e.iV.GroupTypePost:e.iV.GroupTypeNone,groupContentId:this.groupContentId} : {})}}});if(t.data.deleteInboxNotifications?.ok)return this.showAlert({level:e.a5.notice,message:"Notification removed"}),void e.p(e.T.NotificationInboxNotificationHideEvent,{notificationId:this.notificationId});}catch(e){window.Sentry?.captureMessage(e)}this.showAlert({})},this.muteSubreddit=async(t=!0)=>{try{let i;if(t){const t=await e.Y({operation:e.O.UpdateSubredditMuteSettings,variables:{input:{subredditId:this.subredditId}}});i=t?.data?.updateSubredditMuteSettings?.ok}else{const t=await e.Y({operation:e.O.DeleteSubredditMuteSettings,variables:{input:{subredditId:this.subredditId}}});i=t?.data?.deleteSubredditMuteSettings?.ok}if(i)return void this.handleAlerts({actionInfoType:n.N.MuteSubreddit,isDo:t,doConfig:{message:"Community muted",undoOnClick:()=>this.muteSubreddit(!t)},undoConfig:{message:"Community unmuted."}});}catch(e){window.Sentry?.captureMessage(e)}this.showAlert({})},this.changeUpdatesFromSubreddit=async t=>{try{this.notificationLevel=t?this.initialNotificationLevel:e.iw.Off;const i=await e.Y({operation:e.O.UpdateSubredditNotificationSettings,variables:{input:{subredditId:this.subredditId,isUpdateFromSubredditEnabled:t,isSubredditUpdatesInterestingPostEnabled:!this.isNotificationLevelOff()}}});if(i.data.updateSubredditNotificationSettings?.ok)return void this.handleAlerts({actionInfoType:n.N.HideSubreddit,isDo:!t,doConfig:{message:"Success! You won't see updates from this subreddit in the future.",undoOnClick:()=>this.changeUpdatesFromSubreddit(!0)},undoConfig:{message:"Success! Hiding updates from this subreddit has been undone."}});}catch(e){window.Sentry?.captureMessage(e)}this.notificationLevel=t?e.iw.Off:this.initialNotificationLevel,this.showAlert({})},this.changeSeeLessFromSubreddit=async t=>{this.notificationLevel=m({isEnablingUpdates:t,notificationLevel:this.notificationLevel});try{const i=await e.Y({operation:e.O.UpdateSubredditNotificationSettings,variables:{input:{subredditId:this.subredditId,isUpdateFromSubredditEnabled:!this.isNotificationLevelOff(),isSubredditUpdatesInterestingPostEnabled:t}}});if(i.data.updateSubredditNotificationSettings?.ok)return void this.handleAlerts({actionInfoType:n.N.ManageCommunityNotifications,isDo:!t,doConfig:{message:"Success! You'll see less from this subreddit in the future.",undoOnClick:()=>this.changeSeeLessFromSubreddit(!0)},undoConfig:{message:"Success! Seeing less from this subreddit has been undone."}});}catch(e){window.Sentry?.captureMessage(e)}this.notificationLevel=m({isEnablingUpdates:!t,notificationLevel:this.notificationLevel}),this.showAlert({})},this.changeUpdatesOnThisPost=async t=>{try{const i=await e.Y({operation:e.O.UpdatePostSendRepliesState,variables:{input:{postId:this.postId,sendRepliesState:t?e.hs.Send:e.hs.DoNotSend}}});if(i.data.updatePostSendRepliesState?.ok)return void this.handleAlerts({actionInfoType:n.N.HideUpdates,isDo:!t,doConfig:{message:"Success! You won't see updates on this post in the future.",undoOnClick:()=>this.changeUpdatesOnThisPost(!0)},undoConfig:{message:"Success! Hiding updates has been undone."}});}catch(e){window.Sentry?.captureMessage(e)}this.showAlert({})},this.changeUpdatesOnThisComment=async t=>{try{const i=await e.Y({operation:e.O.UpdateCommentSendRepliesState,variables:{input:{commentId:this.commentId,sendRepliesState:t?e.hs.Send:e.hs.DoNotSend}}});if(i.data.updateCommentSendRepliesState?.ok)return void this.handleAlerts({actionInfoType:n.N.HideUpdates,isDo:!t,doConfig:{message:"Success! You won't see updates on this comment in the future.",undoOnClick:()=>this.changeUpdatesOnThisComment(!0)},undoConfig:{message:"Success! Hiding updates has been undone."}});}catch(e){window.Sentry?.captureMessage(e)}this.showAlert({})},this.changeUserBlockStatus=async t=>{try{const i=await e.Y({operation:e.O.UpdateRedditorBlockState,variables:{input:{redditorId:this.userId,blockState:t}}});if(i.data.updateRedditorBlockState?.ok)return void this.handleAlerts({actionInfoType:n.N.BlockUser,isDo:t===e.cI.Blocked,doConfig:{message:`u/${this.userName} is now blocked.`,undoOnClick:()=>this.changeUserBlockStatus(e.cI.None)},undoConfig:{message:`u/${this.userName} is now unblocked.`}});}catch(e){window.Sentry?.captureMessage(e)}this.showAlert({})},this.removeKeywordAlert=async()=>{if(this.followedKeywordId){try{const t=await e.Y({operation:e.O.UpdateFollowedKeywords,variables:{input:{keywords:[{keywordId:this.followedKeywordId,followState:e.h6.Unfollowed}]}}});if(t.data.updateFollowedKeywords?.ok)return void this.showAlert({level:e.a5.notice,message:"Success! You will no longer see updates for this keyword."});}catch(e){window.Sentry?.captureMessage(e)}this.showAlert({})}},this.turnOnKeywordAlerts=async()=>{try{const t=await e.Y({operation:e.O.UpdateInboxNotificationPreferences,variables:{input:{preferences:[{messageType:e.fw.KeywordFollow,isEnabled:!0}]}}});if(t.data.updateInboxNotificationPreferences?.ok)return void this.handleAlerts({actionInfoType:n.N.ManageNotification,isDo:!1,doConfig:{message:"Success! You wont see keyword alerts in the future.",undoOnClick:()=>this.turnOnKeywordAlerts()},undoConfig:{message:"Success! Keyword alerts have been turned back on."}});}catch(e){window.Sentry?.captureMessage(e)}this.showAlert({})},this.turnOffKeywordAlerts=async()=>{try{const t=await e.Y({operation:e.O.UpdateInboxNotificationPreferences,variables:{input:{preferences:[{messageType:e.fw.KeywordFollow,isEnabled:!1}]}}});if(t.data.updateInboxNotificationPreferences?.ok)return void this.handleAlerts({actionInfoType:n.N.ManageCommunityNotifications,isDo:!0,doConfig:{message:"Success! You wont see keyword alerts in the future.",undoOnClick:()=>this.turnOnKeywordAlerts()},undoConfig:{message:"Success! Keyword alerts have been turned back on."}});}catch(e){window.Sentry?.captureMessage(e)}this.showAlert({})},this.handleAlerts=({isDo:t,actionInfoType:i,doConfig:a,undoConfig:s})=>{t?this.showAlert({level:e.a5.notice,message:a.message,undoOnClick:a.undoOnClick,actionInfoType:i}):this.showAlert({level:e.a5.notice,message:s.message})},this.showAlert=({level:t=e.a5.error,message:i="Something went wrong",undoOnClick:a,actionInfoType:s})=>this.dispatchEvent(e.c("faceplate-alert",{level:t,message:i,cause:t===e.a5.error?e.cv.UncaughtError:void 0,namedContent:a&&s?{action:e.o({children:"Undo",attributes:{onclick:()=>{a(),e.i(this,n.j(this.getTrackClickOptionProperties(s)))}}})}:void 0})),this.renderHideThisNotification=()=>this.renderMenuElement({icon:r.d({size:t.I.Small}),label:"Hide",onClick:()=>(this.closeRplDialog(),e.i(this,n.k(this.getTrackClickOptionProperties(n.N.HideNotification))),this.hideNotification()),dataTestId:"hide-this-notification",hasRedirect:!1}),this.renderDisableUpdates=()=>this.renderMenuElement({icon:d.t({size:t.I.Small}),label:"Don't get updates on this",onClick:()=>(this.closeRplDialog(),e.i(this,n.k(this.getTrackClickOptionProperties(n.N.HideUpdates))),this.postId?this.changeUpdatesOnThisPost(!1):this.changeUpdatesOnThisComment(!1)),dataTestId:"block-updates-from-post-or-comment",hasRedirect:!1}),this.renderDisableUpdatesFromSubreddit=()=>this.renderMenuElement({icon:o.c({size:t.I.Small}),label:this.subredditName?`Turn off r/${this.subredditName} notifications`:"Disable updates from this community",onClick:()=>(this.closeRplDialog(),e.i(this,n.k(this.getTrackClickOptionProperties(n.N.HideSubreddit))),this.changeUpdatesFromSubreddit(!1)),dataTestId:"block-updates-from-subreddit",hasRedirect:!1}),this.renderBlockThisUser=()=>this.renderMenuElement({icon:u.b({size:t.I.Small}),label:"Block this user ",onClick:()=>(this.closeRplDialog(),e.i(this,n.k(this.getTrackClickOptionProperties(n.N.BlockUser))),this.changeUserBlockStatus(e.cI.Blocked)),dataTestId:"block-user",hasRedirect:!1}),this.renderManageCommunityNotifications=()=>this.renderMenuElement({icon:l.s({size:t.I.Small}),label:"Manage community notifications",onClick:()=>(this.closeRplDialog(),e.i(this,n.k(this.getTrackClickOptionProperties(n.N.ManageCommunityNotifications))),this.redirect("/settings/notifications?open_modal=COMMUNITY_NOTIFICATIONS"),Promise.resolve()),dataTestId:"see-less",hasRedirect:!1}),this.renderManageThisNotification=()=>this.renderMenuElement({icon:l.s({size:t.I.Small}),label:"Manage this notification",onClick:()=>(this.closeRplDialog(),e.i(this,n.k(this.getTrackClickOptionProperties(n.N.ManageNotification))),this.redirect(`/settings/notifications?open_modal=${this.messageType}`),Promise.resolve()),dataTestId:"manage-notification",hasRedirect:!0}),this.renderMute=()=>this.renderMenuElement({icon:h.v({size:t.I.Small}),label:"Mute this community",onClick:async()=>{this.closeRplDialog();const t=this.subredditName?`r/${this.subredditName}`:"this community";if(await(this.muteConfirmationModal.value?.confirm({title:`Mute ${t}?`,message:`You won't see posts from ${t} in your feeds or recommendations anymore.`})))return e.i(this,n.k(this.getTrackClickOptionProperties(n.N.MuteSubreddit))),this.muteSubreddit()},dataTestId:"mute-this-notification",hasRedirect:!1}),this.renderOverflowHorizontalBtn=()=>t.x` <faceplate-tracker source="${n.a}" action="click" noun="${n.g}" data-faceplate-tracking-context="${JSON.stringify(n.h(this.getTrackEventProperties()))}"> ${e.o({appearance:"plain",attributes:{type:"button","data-testid":"overflow-horizontal-button",slot:"menu","aria-label":"Open notification actions",onclick:()=>{this.openRplDialog()}},leadingIcon:i.o({size:t.I.Small}),size:e.q.Small})} </faceplate-tracker> `,this.renderRemoveKeywordAlert=i=>this.renderMenuElement({icon:c.n({size:t.I.Small}),label:`Remove "${i}" keyword alert`,onClick:()=>(e.i(this,n.k(this.getTrackClickOptionProperties(n.N.ManageNotification))),this.removeKeywordAlert()),dataTestId:"remove-keyword-alert",hasRedirect:!1}),this.renderTurnOffKeywordAlerts=()=>this.renderMenuElement({icon:l.s({size:t.I.Small}),label:"Turn off keyword alerts",onClick:()=>(e.i(this,n.k(this.getTrackClickOptionProperties(n.N.DisableNotificationType))),this.turnOffKeywordAlerts()),dataTestId:"turn-off-keyword-alerts",hasRedirect:!1}),this.renderRemoveBtn=()=>this.isM2InboxExperiment&&!this.isMobile&&this.isHideEligible?e.o({appearance:"plain",leadingIcon:r.d({size:t.I.Small}),size:e.q.Small,attributes:{"data-testid":"delete-notification","aria-label":"Delete",onclick:()=>(this.closeRplDialog(),e.i(this,n.k(this.getTrackClickOptionProperties(n.N.HideNotification))),this.hideNotification()),slot:"hover-actions"}}):t.A,this.closeRplDialog=()=>{this.isDialogOpened=!1},this.openRplDialog=()=>{this.isDialogOpened=!0},this.redirect=e=>{window.location.href=e},this.handleMenuItemKeydown=(e,t)=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),t())},this.renderMenuElement=({icon:e,label:i,onClick:n,dataTestId:r,hasRedirect:o})=>this.isM2InboxExperiment?t.x` <rpl-menu-item size="small" data-testid="${r}" @click="${n}" @keydown="${e=>this.handleMenuItemKeydown(e,n)}"> <div class="flex items-center gap-sm">${e} ${i}</div> </rpl-menu-item> `:a.l({onClick:n,label:i,trailingSlot:o?s.c():void 0,attributes:{role:"menuitem","data-testid":r}}),this.renderConfirmationModal=()=>t.x` <confirmation-modal ${e.a4(this.muteConfirmationModal)} dialog-id="mute-community-confirmation-${this.notificationId}" confirm-text="${"Yes, Mute"}" cancel-text="${"Cancel"}" confirm-button-appearance="primary"></confirmation-modal> `,this.onOpenMenu=()=>e.i(this,n.l(this.getTrackEventProperties())),this.getTrackClickOptionProperties=e=>({...this.getTrackEventProperties(),action_info_type:e}),this.getTrackEventProperties=()=>({notificationId:this.notificationId,notificationType:this.messageType,isViewed:!0,isClicked:this.getIsRead()})}render(){const i=[this.shouldRenderHide()?this.renderHideThisNotification():null,this.shouldRenderManageCommunityNotifications()?this.renderManageCommunityNotifications():null,this.shouldRenderDisableUpdates()?this.renderDisableUpdates():null,this.shouldRenderBlockThisUser()?this.renderBlockThisUser():null,this.shouldRenderDisableUpdatesFromSubreddit()?this.renderDisableUpdatesFromSubreddit():null,this.shouldRenderManageThisNotification()?this.renderManageThisNotification():null,this.shouldRenderRemoveKeywordAlert()?this.renderRemoveKeywordAlert(this.followedKeyword):null,this.shouldRenderTurnOffKeywordAlerts()?this.renderTurnOffKeywordAlerts():null,this.shouldRenderMute()?this.renderMute():null].filter(Boolean),a=t.x` <rpl-modal-card> <div slot="title"> ${"Options"} </div> <div slot="close-button"> ${e.o({appearance:"secondary",leadingIcon:e.al({size:t.I.Small}),size:e.q.Small,attributes:{style:"line-height: initial;",onclick:()=>{this.closeRplDialog()}}})} </div> <rpl-menu> ${i} </rpl-menu> </rpl-modal-card> `;return 0===i.length?t.A:t.x` <div class="flex gap-1"> ${this.renderConfirmationModal()} ${this.hideRemoveButton?t.A:this.renderRemoveBtn()} ${this.isM2InboxExperiment?this.isMobile?t.x`<div> ${this.renderOverflowHorizontalBtn()} <rpl-dialog-sheet dialog-id="dialog-notification-overflow-menu-${this.notificationId}" force-variant="bottom-sheet" .open="${this.isDialogOpened}" @rpl-dialog-sheet:after-hide="${()=>{this.isDialogOpened=!1}}" .litTemplateChildren="${a}"> </rpl-dialog-sheet> </div>`:t.x` <rpl-dropdown placement="bottom-end"> ${this.renderOverflowHorizontalBtn()} <rpl-menu slot="content"> ${i} </rpl-menu> </rpl-dropdown> `:t.x` <faceplate-dropdown-menu position="bottom-end"> ${this.renderOverflowHorizontalBtn()} <faceplate-menu slot="menu" class="block bg-neutral-background"> ${i} </faceplate-menu> </faceplate-dropdown-menu>`} </div> `}};p.styles=[e.t],e._([e.n({type:String,attribute:"message-type"})],p.prototype,"messageType",void 0),e._([e.n({type:String,attribute:"notification-level",reflect:!0})],p.prototype,"notificationLevel",void 0),e._([e.n({type:String,attribute:"notification-id"})],p.prototype,"notificationId",void 0),e._([e.n({type:String,attribute:"user-id"})],p.prototype,"userId",void 0),e._([e.n({type:String,attribute:"user-name"})],p.prototype,"userName",void 0),e._([e.n({type:String,attribute:"post-id"})],p.prototype,"postId",void 0),e._([e.n({type:String,attribute:"comment-id"})],p.prototype,"commentId",void 0),e._([e.n({type:String,attribute:"subreddit-id"})],p.prototype,"subredditId",void 0),e._([e.n({type:String,attribute:"subreddit-name"})],p.prototype,"subredditName",void 0),e._([e.n({type:Boolean,attribute:"is-hide-eligible"})],p.prototype,"isHideEligible",void 0),e._([e.n({type:Boolean,attribute:"is-toggle-update-from-subreddit-eligible"})],p.prototype,"isToggleUpdateFromSubredditEligible",void 0),e._([e.n({type:Boolean,attribute:"is-toggle-notification-update-eligible"})],p.prototype,"isToggleNotificationUpdateEligible",void 0),e._([e.n({type:Boolean,attribute:"is-toggle-low-update-from-subreddit-eligible"})],p.prototype,"isToggleLowUpdateFromSubredditEligible",void 0),e._([e.n({type:Boolean,attribute:"should-decouple-inbox-settings"})],p.prototype,"shouldDecoupleInboxSettings",void 0),e._([e.n({type:Boolean,attribute:"is-mobile"})],p.prototype,"isMobile",void 0),e._([e.n({type:Boolean,attribute:"is-m2-inbox-experiment"})],p.prototype,"isM2InboxExperiment",void 0),e._([e.n({type:String,attribute:"followed-keyword-id"})],p.prototype,"followedKeywordId",void 0),e._([e.n({type:String,attribute:"followed-keyword"})],p.prototype,"followedKeyword",void 0),e._([e.n({type:Boolean,attribute:"hide-remove-button"})],p.prototype,"hideRemoveButton",void 0),e._([e.n({type:Boolean,attribute:"is-aggregation"})],p.prototype,"isAggregation",void 0),e._([e.n({type:String,attribute:"group-type"})],p.prototype,"groupType",void 0),e._([e.n({type:String,attribute:"group-content-id"})],p.prototype,"groupContentId",void 0),e._([e.h()],p.prototype,"isDialogOpened",void 0),p=e._([e.e("notification-context-menu")],p);const k=new Set([e.fw.CommentReply,e.fw.PostReply,e.fw.UsernameMention]);function g(e,t,i){window.Sentry?.captureMessage?.(`Unexpected inbox mark as read error id: ${t}, type: ${i}, err: ${JSON.stringify(e)}`)}let b=class extends t.s{constructor(){super(...arguments),this.isViewed=!1,this.isDeletedPost=!1,this.isRemovedPost=!1,this.notificationId="",this.messageType="",this.hasLink="",this.isM2InboxExperiment=!1,this.notificationsFromMailroomOnly=!1,this.isAggregation=!1,this.isMobile=!1,this.isHidden=!1,this.observer=null,this.pubsub=new e.u(this),this.handleVisibilityChange=([{isIntersecting:t}])=>{t&&!this.isViewed&&(e.i(this,n.d(this.getTrackEventProperties())),this.isViewed=!0,this.observer?.disconnect())},this.hideIfIsSelf=({notificationId:e})=>{e===this.notificationId&&this.hide()},this.hide=()=>this.isHidden=!0,this.onClick=async t=>{(!this.hasLink||this.isDeletedPost||this.isRemovedPost||n.i(t))&&t.preventDefault();const i=!!t.target?.closest("notification-context-menu");return i||e.i(this,n.o({...this.getTrackEventProperties(),clickTarget:"notification"})),this.isDeletedPost?this.showAlert({message:"Sorry this post was deleted"}):this.isRemovedPost&&this.showAlert({message:"This content is no longer available"}),await this.fireReadEvent(),!(i||!this.isAggregation)&&this.handleOpenAggregatedInbox();},this.handleOpenAggregatedInbox=()=>{if(!this.groupContentId||!this.groupType)return!1;const t=n.p({contentId:this.groupContentId,type:this.groupType});return this.isMobile?(e.ep.assign(t),!1):(this.pubsub.publish(e.T.NotificationToggleSidebar,{contentId:this.groupContentId,type:this.groupType,src:t}),!1)},this.getUnreadChildElement=()=>this.isM2InboxExperiment?this.querySelector("rpl-inbox-row[selected]"):this.querySelector(`.${n.u}`),this.fireReadEvent=async()=>{this.getUnreadChildElement()&&(this.removeUnreadState(),await async function({id:t,type:i,groupType:a,groupContentId:s,notificationsFromMailroomOnly:n}){if(t)try{let r;k.has(i)&&!n?(r=await e.Y({operation:e.O.MarkPrivateMessageAsRead,variables:{input:{messageId:t}}}),g(r.data.markPrivateMessageAsRead?.errors,t,i)):(r=await e.Y({operation:e.O.MarkNotificationRead,variables:{input:{notificationId:t,...(a&&s ? {groupType:a.includes("post")?e.iV.GroupTypePost:e.iV.GroupTypeNone,groupContentId:s} : {})}}}),g(r.data.readNotificationLoggedIn?.errors,t,i))}catch(e){}}({id:this.notificationId,type:this.messageType,groupType:this.groupType,groupContentId:this.groupContentId,notificationsFromMailroomOnly:this.notificationsFromMailroomOnly}))},this.removeUnreadState=()=>{const e=this.getUnreadChildElement();e&&(this.isM2InboxExperiment?e.removeAttribute("selected"):e.classList.remove(n.u))},this.showAlert=({message:t})=>this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.warning,message:t})),this.getTrackEventProperties=()=>({notificationType:this.messageType,notificationId:this.notificationId,isViewed:this.isViewed,isClicked:!!this.getUnreadChildElement()})}connectedCallback(){super.connectedCallback(),this.observer=new IntersectionObserver(this.handleVisibilityChange,{root:document.querySelector(`[data-id="${n.e}"]`),threshold:.25}),this.observer.observe(this)}disconnectedCallback(){super.disconnectedCallback(),this.observer?.disconnect()}firstUpdated(){e.i(this,n.f(this.getTrackEventProperties())),this.querySelector("a")?.addEventListener("click",this.onClick),this.isM2InboxExperiment&&this.querySelector("rpl-inbox-row")?.addEventListener("click",this.onClick),this.pubsub.subscribe(e.T.NotificationInboxNotificationHideEvent,this.hideIfIsSelf),this.pubsub.subscribe(e.T.InboxReadAllEvent,this.removeUnreadState)}render(){return this.isHidden?t.A:t.x`<slot></slot>`}};b.styles=[e.t],e._([e.n({type:Boolean,attribute:"is-viewed",reflect:!0})],b.prototype,"isViewed",void 0),e._([e.n({type:Boolean,attribute:"is-deleted-post"})],b.prototype,"isDeletedPost",void 0),e._([e.n({type:Boolean,attribute:"is-removed-post"})],b.prototype,"isRemovedPost",void 0),e._([e.n({type:String,attribute:"notification-id"})],b.prototype,"notificationId",void 0),e._([e.n({type:String,attribute:"message-type"})],b.prototype,"messageType",void 0),e._([e.n({type:Boolean,attribute:"has-link"})],b.prototype,"hasLink",void 0),e._([e.n({type:Boolean,attribute:"is-m2-inbox-experiment"})],b.prototype,"isM2InboxExperiment",void 0),e._([e.n({type:Boolean,attribute:"notifications-from-mailroom-only"})],b.prototype,"notificationsFromMailroomOnly",void 0),e._([e.n({type:Boolean,attribute:"is-aggregation"})],b.prototype,"isAggregation",void 0),e._([e.n({type:Boolean,attribute:"is-mobile"})],b.prototype,"isMobile",void 0),e._([e.n({type:String,attribute:"group-content-id"})],b.prototype,"groupContentId",void 0),e._([e.n({type:String,attribute:"group-type"})],b.prototype,"groupType",void 0),e._([e.h()],b.prototype,"isHidden",void 0),b=e._([e.e("notification-item")],b)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("Dd6H0lWggE",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,t)=>{let n=class extends t.s{render(){return t.x` <slot @click="${this.interactionHandler}" @keydown="${this.interactionHandler}"></slot> `}interactionHandler(e){e instanceof KeyboardEvent&&"Enter"!==e.key||this.dispatchEvent(new Event("interactionEvent"))}};n=e._([e.e("shreddit-interactable-element")],n)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("DdOxCDp7Tq",["Dw4vb8Yfbm","B-zFJtiar6"],(async(i,n)=>{const o="inbox";var t;i.au.Inbox,i.au.MiniInbox,function(i){i.HideNotification="hide_notification",i.HideSubreddit="hide_subreddit",i.HideUpdates="hide_updates",i.ManageCommunityNotifications="manage_community_notifications",i.MuteSubreddit="mute_subreddit",i.ManageNotification="manage_notification",i.BlockUser="block_user",i.DisableNotificationType="disable_notification_type"}(t||(t={}));const e="inbox_notification",c="inbox_notification_overflow",a="overflow_option",d=({notificationType:i,notificationId:n,isViewed:o,isClicked:t,title:e,body:c})=>({notification:{type:i,title:e,body:c},inbox:{id:n,is_viewed:o,is_clicked:t},screen:{height:window.screen.height,width:window.screen.width}}),r=({notificationType:n,notificationId:t,isViewed:e,isClicked:c,action:a,noun:r,actionInfo:s,title:u,body:f})=>i.b({source:o,action:a,noun:r},{...d({notificationType:n,notificationId:t,isViewed:e,isClicked:c,title:u,body:f}),...s&&{action_info:s}}),s=({notificationType:i,notificationId:n,isViewed:o,isClicked:t,noun:e,action:c="click",action_info_type:a})=>r({action:c,noun:e,notificationType:i,notificationId:n,isViewed:o,isClicked:t,actionInfo:a?{type:a}:void 0});var u,f,l,p,_;!function(i){i.Popover="popover",i.Route="route"}(u||(u={})),function(i){i.NumNotifications="numNotifications",i.RenderType="renderType"}(f||(f={})),function(i){i.ContentId="contentId",i.Type="type"}(l||(l={})),function(i){i.CursorForNextPage="nextPageCursor",i.HasRenderedEarlierHeader="hasRenderedEarlierHeader"}(p||(p={})),function(i){i.CursorForNextPage="nextPageCursor"}(_||(_={}));const y=`/svc/shreddit/notifications-inbox-content/:${f.NumNotifications}/:${f.RenderType}`,m=`/svc/shreddit/aggregated-notifications-inbox-content/:${l.ContentId}/:${l.Type}`;n.e(y);const b=n.e(m);return{get N(){return t},a:o,b:({badgeCount:n})=>i.b({source:o,action:"click",noun:"mark_all_as_read"},{action_info:{type:n.toString()}}),c:"notification-count-element",d:i=>r({...i,noun:e,action:"view"}),e:"notification-container-element",f:i=>r({...i,noun:e,action:"receive"}),g:c,h:d,i:i=>Array.from(document.querySelectorAll('[data-id="notification-item-prevent-link"]')).some((n=>n.contains(i.target))),j:i=>s({...i,action:"undo",noun:a}),k:i=>s({...i,noun:a}),l:i=>s({...i,noun:c}),m:"mini-inbox-tooltip",n:"notification-dismissal-element",o:({notificationType:i,notificationId:n,isViewed:o,isClicked:t,clickTarget:c})=>r({action:"click",noun:e,notificationType:i,notificationId:n,isViewed:o,isClicked:t,actionInfo:{position:"cta"===c?2:1}}),p:({queryParams:i={},...n})=>{const o=b(n),t=new URLSearchParams(i).toString();return`${o}${t?"?":""}${t}`},u:"unread-notification"}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("Df3SFBpZLO",["Dw4vb8Yfbm"],(async a=>{const{svg:m}=a.a();return{s:a.m(m`<path d="M10 1a9 9 0 00-9 9 9 9 0 009 9 9 9 0 009-9 9 9 0 00-9-9zm0 16.2c-3.97 0-7.2-3.23-7.2-7.2S6.03 2.8 10 2.8s7.2 3.23 7.2 7.2-3.23 7.2-7.2 7.2zm-3-6.728a1.5 1.5 0 11.001-3.001A1.5 1.5 0 017 10.472zm7.5-1.5a1.5 1.5 0 11-3.001-.001 1.5 1.5 0 013.001.001zM10 15.15c-1.532 0-2.928-.687-3.736-1.836l1.473-1.035c.464.661 1.332 1.072 2.264 1.072.932 0 1.799-.411 2.264-1.072l1.473 1.035c-.808 1.15-2.205 1.836-3.736 1.836H10z"></path>`,"0 0 20 20","sentiment-good")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./DOqOHj9jA9.js",import.meta.url,"DOqOHj9jA9");SML.di("./BRjrtOukap.js",import.meta.url,"BRjrtOukap");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");
SML.dm("DfOK659qrU",["Dw4vb8Yfbm","5r73EsgItq","DOqOHj9jA9","BRjrtOukap","jWC3N3n7Al","FQGvCwaizg"],(async(a,r,e,t)=>{var o;!function(a){a.PRIMARY="primary",a.BRAND="brand"}(o||(o={}));const i={[o.PRIMARY]:"switch-input-primary",[o.BRAND]:"switch-input-brand"};var c;!function(a){a.ON="faceplate-switch-input:on",a.OFF="faceplate-switch-input:off"}(c||(c={}));let n=class extends e.C{constructor(){super(...arguments),this.appearance=o.PRIMARY}static get styles(){return[super.styles,r.a`.switch-input-primary{--checked-color-background-default:var(--color-switch-input-background-checked);--checked-color-background-hover:var(--color-switch-input-background-checked-hover)}.switch-input-brand{--checked-color-background-default:var(--color-brand-background);--checked-color-background-hover:var(--color-brand-background-hover)}.outer{background:var(--color-switch-input-background-default);border-radius:var(--radius-full);box-shadow:var(--elevation-switch-input-default-inset);height:var(--size-switch-input-h);vertical-align:middle;width:var(--size-switch-input-w);padding:var(--line-md);box-sizing:border-box;position:relative;display:flex;align-items:center;flex-shrink:0;transition:background-color .3s;contain:strict}.knob{--knob-size:calc(var(--size-switch-input-h) - (var(--line-md) * 2));--knob-size-active:calc((36 / 28) * var(--knob-size));--translate-checked:calc(
            var(--size-switch-input-w) - var(--knob-size) - (var(--line-md) * 2)
          );background:var(--color-global-white);border-radius:var(--radius-full);filter:drop-shadow(0 1px 4px rgba(0, 0, 0, .15));display:flex;align-items:center;justify-content:center;height:var(--knob-size);position:absolute;transform:translateX(0);transition-duration:.3s;transition-property:transform,width;width:var(--knob-size)}.knob:dir(rtl){--translate-checked:calc(
            -1 * (var(--size-switch-input-w) - var(--knob-size) - (var(--line-md) * 2))
          )}:host(:active:not([aria-disabled=true])) .knob{width:var(--knob-size-active)}:host([checked]) .knob{transform:translateX(var(--translate-checked))}:host([checked]:active:not([aria-disabled=true])) .knob{transform:translateX(calc(var(--translate-checked) - (var(--knob-size-active) - var(--knob-size))))}:host([checked]:active:not([aria-disabled=true])) .knob:dir(rtl){transform:translateX(calc(var(--translate-checked) + (var(--knob-size-active) - var(--knob-size))))}label{margin-inline-start:var(--spacer-xs)}:host([checked]) .outer{background:var(--checked-color-background-default)}:host([faceplate-validity=invalid]) .outer{background:var(--color-danger-content)}:host(:focus-visible) .outer{outline:1px auto var(--color-global-focus)}:host(:hover) .outer{background:var(--color-switch-input-background-default-hover)}:host([checked]:hover) .outer{background:var(--checked-color-background-hover)}:host([aria-disabled=true]){opacity:1}:host([aria-disabled=true]) .outer{background-color:var(--color-switch-input-background-disabled);box-shadow:none}:host([checked][aria-disabled=true]) .outer{background-color:var(--color-switch-input-background-checked-disabled);box-shadow:none}:host([aria-disabled=true][checked]:active) .outer{background:var(--color-switch-input-background-checked-disabled);box-shadow:none}:host([aria-disabled=true]) .knob{background-color:var(--color-switch-input-background-handle-disabled);box-shadow:none}:host([aria-disabled=true]) label{opacity:.5}svg{opacity:0;color:var(--color-global-black);transition:opacity .3s}:host([checked]) svg{opacity:1}`]}render(){return r.x` <span class="${i[this.appearance||o.PRIMARY]} outer"> <span class="knob"> ${t.c({attributes:{"aria-hidden":"true"},size:r.I.ExtraSmall})} </span> </span> ${super.render()} `}toggle(){this.checked=!this.checked,this.dispatchEvent(a.c(this.checked?c.ON:c.OFF)),super.handleInteraction()}handleInteraction(){this.toggle()}};return a._([a.n({type:String})],n.prototype,"appearance",void 0),n=a._([a.e("faceplate-switch-input")],n),{get F(){return n},get S(){return o}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./B0pL5bhFHV.js",import.meta.url,"B0pL5bhFHV");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");
SML.dm("DflF56Kkuz",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6","B0pL5bhFHV","BtqmVQuPYp"],(async(e,t,a,i)=>{var n=t.a`${e.a7}:host{display:contents}`;let l=class extends e.R{constructor(){super(...arguments),this.nonSyncedPropNames=["variant","litTemplateChildren","overlayBlur","dialogId","dialogClassName","blocking","disableCacheContents","noAnimate"],this.isTouchOnly=new a.cU(this,"(pointer: coarse)"),this.isLargeWidth=new a.cU(this,"(width >= 640px)"),this.dialogRef=e.a3(),this.panelRef=e.a3(),this.overlayRef=e.a3(),this.open=!1,this.overlayBlur=!0,this.dialogId="",this.dialogClassName="",this.label="",this.blocking=!1,this.noAnimate=!1,this.disableCacheContents=!1,this.openState="normal",this.dataPersistent=!1,this.expandable=!1,this.redispatchableEventNames=[]}setElementRef(t){(t instanceof e.iv||t instanceof i.R)&&(this.elementRef&&this.elementRef.removeEventListener(`${this.tagName.toLowerCase()}:internal-update`,this.handleInternalSync),this.elementRef=t,this.elementRef.addEventListener(`${this.tagName.toLowerCase()}:internal-update`,this.handleInternalSync))}get rplBottomSheet(){return this.elementRef instanceof i.R?this.elementRef:void 0}get rplDialog(){return this.elementRef instanceof e.iv?this.elementRef:void 0}get portalContainer(){if(!this.elementRef)throw new Error("[RPLDialogSheet]: The .portalContainer is not available until after the component has rendered.");return this.elementRef.portalContainer}get portalShadowRoot(){if(!this.elementRef)throw new Error("[RPLDialogSheet]: The .portalShadowRoot is not available until after the component has rendered.");return this.elementRef.portalShadowRoot}set litTemplateChildren(e){this._litTemplateChildren=e,this.elementRef&&e&&(this.elementRef.litTemplateChildren=e)}get litTemplateChildren(){return this._litTemplateChildren}async expand(){return this.rplBottomSheet?.expand()}async collapse(){return this.rplBottomSheet?.collapse()}async showModal(){return this.elementRef?.showModal()}checkFocus(){return this.elementRef?.checkFocus()}async show(){return this.elementRef?.show()}async hide(){return this.elementRef?.hide()}get currentVariant(){if(this.forceVariant)return this.forceVariant;const{isTouchOnly:e,isLargeWidth:t}=this;return e.matches&&!t.matches?"bottom-sheet":"dialog"}handleInternalSync(e){const t=e;t.stopImmediatePropagation();for(const e of t.detail)!this.nonSyncedPropNames.includes(e.key)&&e.key in this&&e.newValue!==this[e.key]&&(this[e.key]=e.newValue)}renderDialog(){return t.x`<rpl-dialog .eventNamespaceOverride="${this.tagName.toLowerCase()}" .dialogRef="${this.dialogRef}" .panelRef="${this.panelRef}" .overlayRef="${this.overlayRef}" .litTemplateChildren="${this.litTemplateChildren}" .open="${this.open}" .overlayBlur="${this.overlayBlur}" .dialogId="${this.dialogId}" .dialogClassName="${this.dialogClassName}" .label="${this.label}" .blocking="${this.blocking}" .disableCacheContents="${this.disableCacheContents}" .noAnimate="${this.noAnimate}" .dataPersistent="${this.dataPersistent}" .redispatchableEventNames="${this.redispatchableEventNames}" @rpl-dialog-sheet:internal-sync="${this.handleInternalSync}" ${e.a4(this.setElementRef)}> <slot></slot> </rpl-dialog>`}renderBottomSheet(){return t.x`<rpl-bottom-sheet .eventNamespaceOverride="${this.tagName.toLowerCase()}" .dialogRef="${this.dialogRef}" .panelRef="${this.panelRef}" .overlayRef="${this.overlayRef}" .litTemplateChildren="${this.litTemplateChildren}" .open="${this.open}" .overlayBlur="${this.overlayBlur}" .dialogId="${this.dialogId}" .dialogClassName="${this.dialogClassName}" .label="${this.label}" .blocking="${this.blocking}" .disableCacheContents="${this.disableCacheContents}" .noAnimate="${this.noAnimate}" .openState="${this.openState}" .dockable="${!1}" .expandable="${this.expandable}" .dataPersistent="${this.dataPersistent}" .redispatchableEventNames="${this.redispatchableEventNames}" @rpl-dialog-sheet:internal-sync="${this.handleInternalSync}" ${e.a4(this.setElementRef)}> <slot></slot> </rpl-bottom-sheet>`}render(){return"dialog"===this.currentVariant?this.renderDialog():this.renderBottomSheet()}};l.styles=n,e._([e.n({type:String,reflect:!0,attribute:"force-variant"})],l.prototype,"forceVariant",void 0),e._([e.n({type:Boolean,reflect:!0})],l.prototype,"open",void 0),e._([e.n({type:Boolean,reflect:!0,attribute:"overlay-blur"})],l.prototype,"overlayBlur",void 0),e._([e.n({reflect:!0,attribute:"dialog-id"})],l.prototype,"dialogId",void 0),e._([e.n({reflect:!0,attribute:"dialog-classname"})],l.prototype,"dialogClassName",void 0),e._([e.n({reflect:!0})],l.prototype,"label",void 0),e._([e.n({type:Boolean})],l.prototype,"blocking",void 0),e._([e.n({type:Boolean,attribute:"no-animate"})],l.prototype,"noAnimate",void 0),e._([e.n({type:Boolean,reflect:!0,attribute:"disable-cache-contents"})],l.prototype,"disableCacheContents",void 0),e._([e.n({type:String,reflect:!0,attribute:"open-state"})],l.prototype,"openState",void 0),e._([e.n({type:Boolean,reflect:!0,attribute:"data-persistent"})],l.prototype,"dataPersistent",void 0),e._([e.n({type:Boolean,reflect:!0})],l.prototype,"expandable",void 0),e._([e.n({attribute:"redispatchable-event-names",type:Array})],l.prototype,"redispatchableEventNames",void 0),e._([e.h()],l.prototype,"litTemplateChildren",null),l=e._([e.e("rpl-dialog-sheet")],l)}));
SML.di("./BgnwQeogVz.js",import.meta.url,"BgnwQeogVz");SML.di("./BLIiwX-G4B.js",import.meta.url,"BLIiwX-G4B");SML.di("./BPE-aUEF5w.js",import.meta.url,"BPE-aUEF5w");SML.di("./iewwAXEto0.js",import.meta.url,"iewwAXEto0");SML.di("./BM4eKBOTt3.js",import.meta.url,"BM4eKBOTt3");SML.di("./DI4O_MlG8-.js",import.meta.url,"DI4O_MlG8-");SML.di("./CNVxoLjPZD.js",import.meta.url,"CNVxoLjPZD");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("DfmRUMqhhU",["BgnwQeogVz","BLIiwX-G4B","BPE-aUEF5w","iewwAXEto0","BM4eKBOTt3","DI4O_MlG8-","CNVxoLjPZD","Dw4vb8Yfbm"],(async(e,a,n,i,t,o,r,s)=>({b:function(e,a){if(!e?.includes("r/"))return"/";let n=[e,a].filter(Boolean).join("/");return n.startsWith("/")||(n=`/${n}`),n.endsWith("/")||(n=`${n}/`),n},g:function({type:l,iconProps:u}){switch(l){case s.cU.Public:return {label:"Public",description:"Anyone can view, post, and comment to this community",icon:n.b(u),iconSelected:a.b(u)};case s.cU.Restricted:return {label:"Restricted",description:"Anyone can view, but only approved users can contribute",icon:r.s(u),iconSelected:o.s(u)};case s.cU.Private:return {label:"Private",description:"Only approved users can view and contribute",icon:t.l(u),iconSelected:i.l(u)};case s.cU.EmployeesOnly:return {label:"Employee-only",description:"Only employees can view and contribute",icon:e.a(u),iconSelected:e.b(u)};default:return null}},s:"subreddit_about"})));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./DOqOHj9jA9.js",import.meta.url,"DOqOHj9jA9");SML.di("./DoSzdRrY_z.js",import.meta.url,"DoSzdRrY_z");
SML.dm("DgFeZwOkXZ",["Dw4vb8Yfbm","5r73EsgItq","DOqOHj9jA9","DoSzdRrY_z"],(async(e,t,i,s)=>{const{svg:a}=e.a(),c=e.m(a`<path d="M14.7 2H5.3C3.48 2 2 3.48 2 5.3v9.4C2 16.52 3.48 18 5.3 18h9.4c1.82 0 3.3-1.48 3.3-3.3V5.3C18 3.48 16.52 2 14.7 2zm-.7 8.9H6V9.1h8v1.8z"></path>`,"0 0 20 20","checkbox-dismiss-fill");var n;!function(e){e.CHECKED="faceplate-checkbox-input:checked",e.UNCHECKED="faceplate-checkbox-input:unchecked"}(n||(n={}));let r=class extends i.C{constructor(){super(),this.indeterminate=!1,this.ariaRole="checkbox"}static get styles(){return[super.styles,t.a`:host(:focus-visible) svg{outline:1px auto var(--color-global-focus)}`]}handleInteraction(){this.checked=!this.checked,this.dispatchEvent(e.c(this.checked?n.CHECKED:n.UNCHECKED)),super.handleInteraction(),this.indeterminate&&(this.indeterminate=!1)}render(){return t.x` ${this.indeterminate?c({attributes:{className:"icon"},size:t.I.Small}):this.checked?s.c({attributes:{className:"icon"},size:t.I.Small}):s.a({attributes:{className:"icon"},size:t.I.Small})} ${super.render()} `}};e._([e.n({type:Boolean})],r.prototype,"indeterminate",void 0),r=e._([e.e("faceplate-checkbox-input")],r)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("DgW4ULLwQ1",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6"],(async(e,o,t)=>{let n=function(){try{return"1E4 bits"===new Intl.NumberFormat("en",{style:"unit",unit:"bit",unitDisplay:"long",notation:"scientific"}).format(1e4)}catch(e){return!1}}();const a=1e3,i=1e6,r=1e9;function c(e,o,c){if(n){const n=(null==c?void 0:c.options)||{notation:(null==c?void 0:c.short)?"compact":"standard"};return t.cV(o,n).format(e)}return($=e)>=99999999949?`${Math.floor($/r)}b`:$>=999999949&&$<99999999949?`${($/r).toFixed(1)}b`:$>=99999949&&$<999999949?`${Math.floor($/i)}m`:$>=999949&&$<99999949?`${($/i).toFixed(1)}m`:$>=99949&&$<999949?`${Math.floor($/a)}k`:$>=a&&$<99949?`${($/a).toFixed(1)}k`:String($);var $}let $=class extends o.s{constructor(){super(...arguments),this.number=0,this.locale="",this.pretty=!1}getLocale(){return this.locale||t.bJ()}createRenderRoot(){return this}render(){const e=this.formatOptions?{options:this.formatOptions}:{short:this.pretty};return c(this.number,this.getLocale(),e)}};return e._([e.n({type:Number})],$.prototype,"number",void 0),e._([e.n({type:String})],$.prototype,"locale",void 0),e._([e.n({type:Object})],$.prototype,"formatOptions",void 0),e._([e.n({type:Boolean})],$.prototype,"pretty",void 0),$=e._([e.e("faceplate-number")],$),{a:function(o,t=!1){return t||0!==o?e.cB({one:`Allows up to ${o} emoji`,other:`Allows up to ${o} emojis`,count:o}):"";},b:function(o,t=!1){return t||0!==o?e.cB({one:`${o} question left today.`,other:`${o} questions left today.`,count:o}):"";},c:function(o,t=!1){return t||0!==o?e.cB({one:`${o} question left this week.`,other:`${o} questions left this week.`,count:o}):"";},d:function(e){const{count:o,none:t,single:n,many:a}=e;return 0===o&&void 0!==t?t:1===o?n:a},f:c,p:function(o,t=!1){return t||0!==o?e.cB({one:`Allows text and up to ${o} emoji`,other:`Allows text and up to ${o} emojis`,count:o}):"";}};}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("DgpVuwRfb_",["Dw4vb8Yfbm","B-zFJtiar6","5r73EsgItq"],(async(e,t,i)=>{let a=class extends i.s{constructor(){super(...arguments),this.userId=null,this.isModerator=!1,this.isProgressToastFeatureActivated=!1,this.pubsub=new e.u(this),this.achievementNotificationSubscriptionController=new e.cP(this),this.onAchievementNotificationRecieved=async i=>{if(i&&"achievements"===i.gameID){this.isModerator&&this.pubsub.publish(e.T.ReloadModGuidanceAchievements);try{const i=await e.Y({operation:e.O.AchievementUnlockedNotifications,variables:{maxImageWidth:32}}),a=[],s=i.data.identity?.redditor.trophyCase?.notifications;s?.forEach((e=>{if(a.push(e.id),"StreakExtendedNotification"===e.__typename)this.activateProgressToast({open:!0,notificationType:t.cm.STREAK_EXTENDED,streakLength:e.length});else if("TrophyProgressedNotification"===e.__typename){const i=e.trophy;"AchievementImageTrophy"===i.__typename&&this.activateProgressToast({open:!0,notificationType:t.cm.TROPHY_PROGRESSED,numberCompleted:i.progress?.done,total:i.progress?.total,progressUnit:i.progress?.unit,imgSrc:i.lockedImage.url,achievementId:i.id})}else if("TrophyUnlockedNotification"===e.__typename){const i=e.trophy;"AchievementImageTrophy"!==i.__typename&&"AchievementRepeatableImageTrophy"!==i.__typename||this.activateProgressToast({open:!0,notificationType:t.cm.TROPHY_UNLOCKED,message:i.name,imgSrc:i.lockedImage.url,unlockedImgSrc:i.gridImage.url,achievementId:i.id})}})),a&&a.length>0&&this.deleteAchievementNotifications(a)}catch(e){window.Sentry?.captureError?.(e)}}},this._activateFeature=async t=>e.r(t)}async activateProgressToast(t){if(!this.getIsAchievementsUpdatesEnabled())return;const i=!!document.querySelector("achievement-progress-toast");if(!this.isProgressToastFeatureActivated&&!i)try{this.isProgressToastFeatureActivated=!0,await this._activateFeature({name:e.hv})}catch(e){this.isProgressToastFeatureActivated=!1}this.pubsub.publish(e.T.AchievementsProgressToast,t)}getIsAchievementsUpdatesEnabled(){try{if(!e.a8.isAvailable())return!0;const t=e.a8.getItem(`${e.a9.AchievementsUpdatesEnabled}-${this.userId}`);return null===t||JSON.parse(t)}catch(e){window.Sentry?.captureError?.(e)}return!0}async connectedCallback(){super.connectedCallback(),this.getIsAchievementsUpdatesEnabled()&&this.subscribeToAchievementNotifications(),e.a8.isAvailable()&&e.a8.getItem(e.a9.AchievementsStore)===`${this.userId}-${e.hw.Enrolled}`||this.enrollUserIntoAchievements()}async deleteAchievementNotifications(t){try{await e.Y({operation:e.O.DeleteAchievementNotifications,variables:{ids:t}})}catch(e){window.Sentry?.captureError?.(e)}}async enrollUserIntoAchievements(){try{const t=await e.Y({operation:e.O.EnrollInStreaks,variables:{input:{timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,gameId:"achievements"}}}),i=t.data?.enrollInGamification?.ok;if(!i)return;e.a8.isAvailable()&&e.a8.setItem(e.a9.AchievementsStore,`${this.userId}-${t.data?.enrollInGamification?.status||""}`)}catch(e){window.Sentry?.captureError?.(e)}}subscribeToAchievementNotifications(){try{this.achievementNotificationSubscriptionController.subscribe({query:{operationName:"SubscribeSubscription",query:"\n            subscription SubscribeSubscription($input: SubscribeInput!) {\n              subscribe(input: $input) {\n                ... on BasicMessage {\n                  data {\n                    ... on GamificationAccomplishmentsMessageData {\n                      gameID\n                    }\n                  }\n                }\n              }\n            }\n            ",variables:{input:{channel:{teamOwner:"I18N",category:"GAMIFICATION",userID:this.userId}}}},onData:async e=>{this.onAchievementNotificationRecieved(e?.data?.subscribe.data)}})}catch(e){window.Sentry?.captureError?.(e)}}render(){return i.x``}};a.styles=[e.t],e._([e.n({type:String,attribute:"user-id"})],a.prototype,"userId",void 0),e._([e.n({type:Boolean,attribute:"moderator"})],a.prototype,"isModerator",void 0),a=e._([e.e("achievement-events")],a)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("Dila08eR5d",["Dw4vb8Yfbm","5r73EsgItq"],(async(t,e)=>{let n;const s=new Uint8Array(16);function i(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(s)}var o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const r=[];for(let t=0;t<256;++t)r.push((t+256).toString(16).slice(1));function c(t,e=0){return(r[t[e+0]]+r[t[e+1]]+r[t[e+2]]+r[t[e+3]]+"-"+r[t[e+4]]+r[t[e+5]]+"-"+r[t[e+6]]+r[t[e+7]]+"-"+r[t[e+8]]+r[t[e+9]]+"-"+r[t[e+10]]+r[t[e+11]]+r[t[e+12]]+r[t[e+13]]+r[t[e+14]]+r[t[e+15]]).toLowerCase()}function a(t){if(!function(t){return"string"==typeof t&&o.test(t)}(t))throw TypeError("Invalid UUID");let e;const n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=255&e,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=255&e,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=255&e,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=255&e,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=255&e,n}function m(t,e,n){function s(t,s,i,o){var r;if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));const e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e}(t)),"string"==typeof s&&(s=a(s)),16!==(null===(r=s)||void 0===r?void 0:r.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let m=new Uint8Array(16+t.length);if(m.set(s),m.set(t,s.length),m=n(m),m[6]=15&m[6]|e,m[8]=63&m[8]|128,i){o=o||0;for(let t=0;t<16;++t)i[o+t]=m[t];return i}return c(m)}try{s.name=t}catch(t){}return s.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",s.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",s}function d(t){return 14+(t+64>>>9<<4)+1}function u(t,e){const n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function h(t,e,n,s,i,o){return u((r=u(u(e,t),u(s,o)))<<(c=i)|r>>>32-c,n);var r,c}function l(t,e,n,s,i,o,r){return h(e&n|~e&s,t,e,i,o,r)}function _(t,e,n,s,i,o,r){return h(e&s|n&~s,t,e,i,o,r)}function p(t,e,n,s,i,o,r){return h(e^n^s,t,e,i,o,r)}function w(t,e,n,s,i,o,r){return h(n^(e|~s),t,e,i,o,r)}m("v3",48,(function(t){if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t[n]=e.charCodeAt(n)}return function(t){const e=[],n=32*t.length,s="0123456789abcdef";for(let i=0;i<n;i+=8){const n=t[i>>5]>>>i%32&255,o=parseInt(s.charAt(n>>>4&15)+s.charAt(15&n),16);e.push(o)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[d(e)-1]=e;let n=1732584193,s=-271733879,i=-1732584194,o=271733878;for(let e=0;e<t.length;e+=16){const r=n,c=s,a=i,m=o;n=l(n,s,i,o,t[e],7,-680876936),o=l(o,n,s,i,t[e+1],12,-389564586),i=l(i,o,n,s,t[e+2],17,606105819),s=l(s,i,o,n,t[e+3],22,-1044525330),n=l(n,s,i,o,t[e+4],7,-176418897),o=l(o,n,s,i,t[e+5],12,1200080426),i=l(i,o,n,s,t[e+6],17,-1473231341),s=l(s,i,o,n,t[e+7],22,-45705983),n=l(n,s,i,o,t[e+8],7,1770035416),o=l(o,n,s,i,t[e+9],12,-1958414417),i=l(i,o,n,s,t[e+10],17,-42063),s=l(s,i,o,n,t[e+11],22,-1990404162),n=l(n,s,i,o,t[e+12],7,1804603682),o=l(o,n,s,i,t[e+13],12,-40341101),i=l(i,o,n,s,t[e+14],17,-1502002290),s=l(s,i,o,n,t[e+15],22,1236535329),n=_(n,s,i,o,t[e+1],5,-165796510),o=_(o,n,s,i,t[e+6],9,-1069501632),i=_(i,o,n,s,t[e+11],14,643717713),s=_(s,i,o,n,t[e],20,-373897302),n=_(n,s,i,o,t[e+5],5,-701558691),o=_(o,n,s,i,t[e+10],9,38016083),i=_(i,o,n,s,t[e+15],14,-660478335),s=_(s,i,o,n,t[e+4],20,-405537848),n=_(n,s,i,o,t[e+9],5,568446438),o=_(o,n,s,i,t[e+14],9,-1019803690),i=_(i,o,n,s,t[e+3],14,-187363961),s=_(s,i,o,n,t[e+8],20,1163531501),n=_(n,s,i,o,t[e+13],5,-1444681467),o=_(o,n,s,i,t[e+2],9,-51403784),i=_(i,o,n,s,t[e+7],14,1735328473),s=_(s,i,o,n,t[e+12],20,-1926607734),n=p(n,s,i,o,t[e+5],4,-378558),o=p(o,n,s,i,t[e+8],11,-2022574463),i=p(i,o,n,s,t[e+11],16,1839030562),s=p(s,i,o,n,t[e+14],23,-35309556),n=p(n,s,i,o,t[e+1],4,-1530992060),o=p(o,n,s,i,t[e+4],11,1272893353),i=p(i,o,n,s,t[e+7],16,-155497632),s=p(s,i,o,n,t[e+10],23,-1094730640),n=p(n,s,i,o,t[e+13],4,681279174),o=p(o,n,s,i,t[e],11,-358537222),i=p(i,o,n,s,t[e+3],16,-722521979),s=p(s,i,o,n,t[e+6],23,76029189),n=p(n,s,i,o,t[e+9],4,-640364487),o=p(o,n,s,i,t[e+12],11,-421815835),i=p(i,o,n,s,t[e+15],16,530742520),s=p(s,i,o,n,t[e+2],23,-995338651),n=w(n,s,i,o,t[e],6,-198630844),o=w(o,n,s,i,t[e+7],10,1126891415),i=w(i,o,n,s,t[e+14],15,-1416354905),s=w(s,i,o,n,t[e+5],21,-57434055),n=w(n,s,i,o,t[e+12],6,1700485571),o=w(o,n,s,i,t[e+3],10,-1894986606),i=w(i,o,n,s,t[e+10],15,-1051523),s=w(s,i,o,n,t[e+1],21,-2054922799),n=w(n,s,i,o,t[e+8],6,1873313359),o=w(o,n,s,i,t[e+15],10,-30611744),i=w(i,o,n,s,t[e+6],15,-1560198380),s=w(s,i,o,n,t[e+13],21,1309151649),n=w(n,s,i,o,t[e+4],6,-145523070),o=w(o,n,s,i,t[e+11],10,-1120210379),i=w(i,o,n,s,t[e+2],15,718787259),s=w(s,i,o,n,t[e+9],21,-343485551),n=u(n,r),s=u(s,c),i=u(i,a),o=u(o,m)}return[n,s,i,o]}(function(t){if(0===t.length)return[];const e=8*t.length,n=new Uint32Array(d(e));for(let s=0;s<e;s+=8)n[s>>5]|=(255&t[s/8])<<s%32;return n}(t),8*t.length))}));var f={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function v(t,e,n){if(f.randomUUID&&!t)return f.randomUUID();const s=(t=t||{}).random||(t.rng||i)();return s[6]=15&s[6]|64,s[8]=63&s[8]|128,c(s)}function y(t,e,n,s){switch(t){case 0:return e&n^~e&s;case 1:case 3:return e^n^s;case 2:return e&n^e&s^n&s}}function g(t,e){return t<<e|t>>>32-e}m("v5",80,(function(t){const e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);const s=t.length/4+2,i=Math.ceil(s/16),o=new Array(i);for(let e=0;e<i;++e){const n=new Uint32Array(16);for(let s=0;s<16;++s)n[s]=t[64*e+4*s]<<24|t[64*e+4*s+1]<<16|t[64*e+4*s+2]<<8|t[64*e+4*s+3];o[e]=n}o[i-1][14]=8*(t.length-1)/Math.pow(2,32),o[i-1][14]=Math.floor(o[i-1][14]),o[i-1][15]=8*(t.length-1)&4294967295;for(let t=0;t<i;++t){const s=new Uint32Array(80);for(let e=0;e<16;++e)s[e]=o[t][e];for(let t=16;t<80;++t)s[t]=g(s[t-3]^s[t-8]^s[t-14]^s[t-16],1);let i=n[0],r=n[1],c=n[2],a=n[3],m=n[4];for(let t=0;t<80;++t){const n=Math.floor(t/20),o=g(i,5)+y(n,r,c,a)+m+e[n]+s[t]>>>0;m=a,a=c,c=g(r,30)>>>0,r=i,i=o}n[0]=n[0]+i>>>0,n[1]=n[1]+r>>>0,n[2]=n[2]+c>>>0,n[3]=n[3]+a>>>0,n[4]=n[4]+m>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}));const b=e.s;let C=class extends b{constructor(){super(...arguments),this.totalComments=0,this.pubsub=new t.u(this),this.pageUnloaded=!1,this.initialViewStats={num_comments_viewed:0,comments_viewed_json:[],comments_viewed_list:[],num_comments_consumed:0,comments_consumed_json:[],comments_consumed_list:[]},this.view_stats=this.cloneObject(this.initialViewStats),this.viewedEntityFilterChips=new Set,this.correlation_id=v(),this.page_request_id=t.cr(),this.handleCommentCreated=()=>{this.totalComments+=1},this.handleVisibilityChange=t=>{t?(this.pageUnloaded=!1,this.resetViewStats()):this.pageUnloaded||this.flushEvents()},this.onBeforeUnload=()=>{this.pageUnloaded=!0,this.flushEvents()},this.flushEvents=()=>{const e=((e,n,s,i,o,r)=>{let c={};const a=t.gS("post"),m=n.slice(0,1e3);return c={correlation_id:o,view_stats:{num_comments_viewed:e,comments_viewed_json:JSON.stringify(m),comments_viewed_list:s},post:{...a,number_comments:i},action_info:{page_request_id:r}},t.b({source:"post",action:"view",noun:"comments"},c)})(this.view_stats.num_comments_viewed,this.view_stats.comments_viewed_json,this.view_stats.comments_viewed_list,this.totalComments,this.correlation_id,this.page_request_id);t.i(this,e);const n=((e,n,s,i,o,r)=>{let c={};const a=t.gS("post"),m=n.slice(0,1e3);return c={correlation_id:o,view_stats:{num_comments_consumed:e,comments_consumed_json:JSON.stringify(m),comments_consumed_list:s},post:{...a,number_comments:i},screen:{height:window?.screen.height,width:window?.screen.width},action_info:{page_request_id:r}},t.b({source:"post",action:"consume",noun:"comments"},c)})(this.view_stats.num_comments_consumed,this.view_stats.comments_consumed_json,this.view_stats.comments_consumed_list,this.totalComments,this.correlation_id,this.page_request_id);if(t.i(this,n),this.viewedEntityFilterChips.size){const e=((e,n,s)=>{let i={};return i={correlation_id:n,view_stats:{entity_ids:e},post:{...t.gS("post")},action_info:{page_request_id:s}},t.b({source:"post_detail",action:"view",noun:"comment_filter"},i)})(Array.from(this.viewedEntityFilterChips),this.correlation_id,this.page_request_id);t.i(this,e)}this.resetViewStats()},this.commentsViewedListener=t=>{this.updateCommentsViewedStats(t.detail)},this.commentsConsumedListener=t=>{this.updateCommentsConsumedStats(t.detail)},this.handleEntityFilterViewTracking=t=>{t.entity_id&&this.viewedEntityFilterChips.add(t.entity_id)}}cloneObject(t){return JSON.parse(JSON.stringify(t))}connectedCallback(){super.connectedCallback(),this.parentElement.addEventListener("comments-viewed-event",this.commentsViewedListener),this.parentElement.addEventListener("comments-consumed-event",this.commentsConsumedListener),this.pubsub.subscribe(t.T.EntityFilterView,this.handleEntityFilterViewTracking),this.pubsub.subscribe(t.T.CommentCreated,this.handleCommentCreated),t.aE.subscribe(this.onBeforeUnload,{unloadOnly:!0}),t.cp(this.handleVisibilityChange,{immediate:!0}),window.addEventListener("beforeRoute",this.flushEvents)}disconnectedCallback(){super.disconnectedCallback(),this.parentElement.removeEventListener("comments-viewed-event",this.commentsViewedListener),this.parentElement.removeEventListener("comments-consumed-event",this.commentsConsumedListener),t.aE.unsubscribe(this.onBeforeUnload),t.cq(this.handleVisibilityChange),window.removeEventListener("beforeRoute",this.flushEvents)}resetViewStats(){this.correlation_id=v(),this.view_stats=this.cloneObject(this.initialViewStats),this.viewedEntityFilterChips=new Set}includesComment(t,e){return t.some((t=>t.comment_id===e))}updateCommentsViewedStats(t){const e=t?.detail;this.includesComment(this.view_stats.comments_viewed_json,e.comment_id)||(this.view_stats.comments_viewed_json.push(e),this.view_stats.comments_viewed_list.push(e.comment_id),this.view_stats.num_comments_viewed=this.view_stats.comments_viewed_json.length)}updateCommentsConsumedStats(t){const e=t?.detail;this.includesComment(this.view_stats.comments_consumed_json,e.comment_id)||(this.view_stats.comments_consumed_json.push(e),this.view_stats.comments_consumed_list.push(e.comment_id),this.view_stats.num_comments_consumed=this.view_stats.comments_consumed_json.length)}};t._([t.n({type:Number,attribute:"total-comments"})],C.prototype,"totalComments",void 0),C=t._([t.e("shreddit-comment-tree-stats")],C)}));
SML.di("./JaGlTj3I-9.js",import.meta.url,"JaGlTj3I-9");
SML.dm("Dj7wutmAw0",["JaGlTj3I-9"],(async()=>{var e;return function(e){e.CommentHasCollectibleExpression="comment_has_collectible_expression",e.CommentHasVideo="comment_has_video",e.CommentHasProcessingVideo="comment_has_processing_video"}(e||(e={})),{get U(){return e},i:function({isLocked:e,isMod:o,isArchived:s,isUserBanned:n}){return e&&!o||s||n}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("DjACS3kR0A",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,t)=>{let n=class extends t.s{constructor(){super(...arguments),this.open=!1,this._eventsDefined=!1,this.updated=e=>{e.has("open")&&(this.open&&(this.details.open=!0),this._animator.open=this.open,this._summary.setAttribute("aria-expanded",this.open.toString()))},this._onClick=e=>{e.target&&this._summary?.contains(e.target)&&(e.preventDefault(),this.open=!this.open,this._animator.open=this.open)},this._onTransitionEnd=e=>{e.target&&this._animator?.contains(e.target)&&(this.details.open=this.open)}}get details(){return this.querySelector("details")}get _summary(){return this.details?this.details.querySelector("summary"):null}get _animator(){return this.querySelector("faceplate-auto-height-animator")}connectedCallback(){super.connectedCallback(),this._eventsDefined||(this.addEventListener("click",this._onClick),this.addEventListener("transitionend",this._onTransitionEnd),this._eventsDefined=!0),async function(){return new Promise((e=>{"loading"===document.readyState?document.addEventListener("readystatechange",(()=>{e(!0)}),{once:!0}):e(!0)}))}().then((()=>{null!=this.details&&null!=this._summary&&null!=this._animator&&(this.open=this.details.open)}))}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("click",this._onClick),this.removeEventListener("transitionend",this._onTransitionEnd),this._eventsDefined=!1}createRenderRoot(){return this}};e._([e.n({type:Boolean,reflect:!0})],n.prototype,"open",void 0),n=e._([e.e("faceplate-expandable-section-helper")],n);var i=Object.freeze({__proto__:null,get FaceplateExpandableSectionHelper(){return n}});return{get f(){return i}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("Dm3xIDznQh",["Dw4vb8Yfbm"],(async a=>{const{svg:l}=a.a();return{l:a.m(l`<path d="M14.088 11.843a.9.9 0 01-.637-1.536l1.97-1.971a2.66 2.66 0 000-3.757c-1.003-1.003-2.754-1.005-3.756 0L9.694 6.55A.9.9 0 118.42 5.278l1.97-1.971a4.427 4.427 0 013.152-1.306c1.19 0 2.31.463 3.152 1.305a4.463 4.463 0 010 6.303l-1.971 1.971a.897.897 0 01-.637.264v-.001zm-4.48 4.851l1.97-1.97a.9.9 0 10-1.273-1.272l-1.97 1.97c-1.003 1.004-2.755 1.002-3.757 0a2.66 2.66 0 010-3.757l1.97-1.971a.898.898 0 000-1.272.901.901 0 00-1.272 0l-1.971 1.971a4.463 4.463 0 000 6.303 4.43 4.43 0 003.152 1.305c1.19 0 2.31-.465 3.151-1.307zm-.747-4.282l3.55-3.55a.9.9 0 10-1.272-1.273l-3.551 3.55a.9.9 0 00.637 1.537.9.9 0 00.637-.263l-.001-.001z"></path>`,"0 0 20 20","link")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./CQrDBXK-hm.js",import.meta.url,"CQrDBXK-hm");
SML.dm("DmeLdLooOj",["Dw4vb8Yfbm","5r73EsgItq","CQrDBXK-hm"],(async(t,e,i)=>{const r="rpl-dialog-trigger:trigger-clicked",s=[];function n(t,e){const i=e.getBoundingClientRect();Object.assign(t.style,{position:"fixed",left:`${i.left}px`,height:`${i.height}px`})}function a(t){Object.assign(t.style,{position:"",left:"",height:"",opacity:"",transform:""})}let o=class extends(t.k(t.bL(e.s))){constructor(){super(...arguments),this.open=!1,this.dialogId="",this.triggerElement=null,this.entityDialogRootContainer=null,this.prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,this.shouldEnableNavPersistence=!1,this.handleAfterNavigation=()=>{this.open&&(window.removeEventListener("afterRoute",this.handleAfterNavigation),this.connectedCallback(),this.rightSidebar.classList.add("hidden"));const t=this.rightSidebar.classList.contains("hidden");!s.length&&t&&this.close(!1)},this.handleTriggerEvent=t=>{const e=t.detail;if(e.dialogId===this.dialogId&&!this.open&&!this.triggerElement)return this.triggerElement=e.triggerElement,this.show()}}connectedCallback(){super.connectedCallback(),document.addEventListener(r,this.handleTriggerEvent),this.rightSidebar=document.getElementById("right-sidebar-container"),this.entityDialogRootContainer=document.getElementById(i.R),this.rightSidebar?.parentElement||console.log("Missing right sidebar element. Please make sure right sidebar is rendered before trigger this overlay."),super.portalRoot=this.entityDialogRootContainer??document.body,this.prefersReducedMotion||(this.portalContainer.style.transition="opacity 120ms linear, transform 280ms cubic-bezier(0.54, 1.15, 1, 1)",this.rightSidebar.style.transition="opacity 80ms linear, transform 200ms cubic-bezier(0.54, 1.15, 1, 1)"),this.portalContainer.className="\n    rounded-4 w-[316px] min-w-[316px] xs:max-h-[calc(100vh-var(--shreddit-header-height)-32px)]\n    xs:sticky xs:top-[calc(var(--shreddit-header-height)+16px)] xs:overflow-hidden box-border\n    flex flex-col border border-solid border-neutral-border-weak shadow-neutral-border-weak shadow-[0px_1px_8px_0px] hidden xs:flex",this.shouldEnableNavPersistence&&window.addEventListener("afterRoute",this.handleAfterNavigation)}disconnectedCallback(){document.removeEventListener(r,this.handleTriggerEvent),super.disconnectedCallback(),this.shouldEnableNavPersistence&&!this.open&&window.removeEventListener("afterRoute",this.handleAfterNavigation)}closeAllOpenOverlays(){s.forEach((t=>t.close(!1)))}handleTransitionEnd(t){t?(this.rightSidebar.classList.add("hidden"),a(this.portalContainer)):(this.removePortal(),a(this.rightSidebar))}runAnimation(t){const e={opening:{portal:{start:{transform:"translateX(32px)",opacity:"0"},end:{transform:"translateX(0px)",opacity:"1"}},rightSidebar:{start:{transform:"translateX(0px)",opacity:"1"},end:{transform:"translateX(-16px)",opacity:"0"}}},closing:{portal:{start:{transform:"translateX(0px)",opacity:"1"},end:{transform:"translateX(32px)",opacity:"0"}},rightSidebar:{start:{transform:"translateX(-16px)",opacity:"0"},end:{transform:"translateX(0px)",opacity:"1"}}}},i=t?e.opening:e.closing;Object.assign(this.portalContainer.style,i.portal.start),Object.assign(this.rightSidebar.style,i.rightSidebar.start),requestAnimationFrame((()=>{Object.assign(this.portalContainer.style,i.portal.end),Object.assign(this.rightSidebar.style,i.rightSidebar.end)})),this.portalContainer.addEventListener("transitionend",(()=>this.handleTransitionEnd(t)),{once:!0})}show(){this.open=!0,this.triggerElement?.addOpenAttributes();const t=s.length>0;this.closeAllOpenOverlays(),s.push(this),n(this.portalContainer,this.rightSidebar),this.appendTemplateContentTo(this.portalContainer,{cache:!0}),this.attachPortal();this.prefersReducedMotion||t?this.handleTransitionEnd(!0):this.runAnimation(!0)}close(t=!0){this.open=!1,s.splice(s.indexOf(this),1),n(this.rightSidebar,this.portalContainer),this.rightSidebar.classList.remove("hidden");this.prefersReducedMotion||!t?this.handleTransitionEnd(!1):this.runAnimation(!1),this.triggerElement&&(this.triggerElement.removeOpenAttributes(),this.triggerElement=null)}userClose(){this.close(),this.dispatchEvent(new CustomEvent("shreddit-right-rail-overlay:user-closed"))}render(){return e.x` <div class="sticky top-0 bg-neutral-background z-10"> <div class="flex justify-between items-center"> <div class="flex justify-between py-md pl-md pr-0 items-center"> <slot name="header" class="font-semibold text-18 text-neutral-content-strong"></slot> </div> ${t.o({appearance:"secondary",attributes:{type:"button",onclick:()=>this.userClose(),className:"shrink-0 mx-sm mr-sm ml-xs"},size:t.q.Small,leadingIcon:t.al({size:e.I.Small})})} </div> <hr class="border-neutral-border-weak border-0 border-t mx-md my-0"> </div> <slot></slot> `}};o.styles=[t.t],t._([t.n({type:Boolean,reflect:!0})],o.prototype,"open",void 0),t._([t.n({type:String,reflect:!0,attribute:"dialog-id"})],o.prototype,"dialogId",void 0),t._([t.n({type:Boolean,attribute:"should-enable-nav-persistence"})],o.prototype,"shouldEnableNavPersistence",void 0),o=t._([t.e("shreddit-right-rail-overlay")],o)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("DnNITwgp90",["Dw4vb8Yfbm"],(async t=>{const{svg:e}=t.a();function a(t,e){t&&(t.setCustomValidity(""),t.removeAttribute("faceplate-validity")),e?.setMessage("")}async function i(t,e){t&&(await(t._internals.form?.updateComplete),t.value=""),a(t,e)}return{a:i,b:a,e:t.m(e`<path d="M11.21 13.5a1.21 1.21 0 11-2.42 0 1.21 1.21 0 012.42 0zM19 10c0-4.963-4.038-9-9-9s-9 4.037-9 9 4.038 9 9 9 9-4.037 9-9zm-1.801 0c0 3.97-3.229 7.2-7.199 7.2-3.97 0-7.199-3.23-7.199-7.2S6.03 2.8 10 2.8c3.97 0 7.199 3.23 7.199 7.2zm-6.441 1.24l.242-6H9l.242 6h1.516z"></path>`,"0 0 20 20","error"),m:async function(t,e){t?.removeAttribute("required"),i(t,e),t&&(await t.updateComplete,t.syncInputValidity(!1))},r:function(t){t&&(t.setCustomValidity(""),t.removeAttribute("faceplate-validity"),t.form?.notifyObservers(t))}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("DoSzdRrY_z",["Dw4vb8Yfbm"],(async c=>{const{svg:a}=c.a(),h=c.m(a`<path d="M14.7 18H5.3C3.48 18 2 16.52 2 14.7V5.3C2 3.48 3.48 2 5.3 2h9.4C16.52 2 18 3.48 18 5.3v9.4c0 1.82-1.48 3.3-3.3 3.3zM5.3 3.8c-.83 0-1.5.67-1.5 1.5v9.4c0 .83.67 1.5 1.5 1.5h9.4c.83 0 1.5-.67 1.5-1.5V5.3c0-.83-.67-1.5-1.5-1.5H5.3z"></path>`,"0 0 20 20","checkbox"),{svg:t}=c.a();return{a:h,c:c.m(t`<path d="M14.698 2h-9.4a3.304 3.304 0 00-3.3 3.3v9.4c0 1.82 1.48 3.301 3.3 3.301h9.4c1.82 0 3.3-1.48 3.3-3.301V5.3c0-1.819-1.48-3.3-3.3-3.3zM9.177 13.236a.899.899 0 01-1.274 0l-2.545-2.545 1.275-1.275 1.908 1.909L13.365 6.5l1.275 1.275-5.462 5.462-.001-.001z"></path>`,"0 0 20 20","checkbox-fill")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("DpoX9fLllS",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6"],(async(e,n,a)=>{const{svg:l}=e.a(),t=e.m(l`<path d="M10 1a9 9 0 10.001 18.001A9 9 0 0010 1zm3.94 11.66l-1.27 1.27-2.66-2.66-2.66 2.66-1.27-1.27L8.74 10 6.08 7.34l1.27-1.27 2.66 2.66 2.66-2.66 1.27 1.27L11.28 10l2.66 2.66z"></path>`,"0 0 20 20","clear-fill");return{a:({attributes:l,children:s,selected:i,leadingIcon:r,ariaControls:o,screenReaderContent:c,deleteButtonConfig:d})=>{const{html:m,ifDefined:p}=e.a();return m` <span class="inline-flex relative max-w-full" slot="${p(l?.slot)}"> ${e.h3({hideChildrenOverflow:!0,ariaControls:o,attributes:l,selected:i,size:e.q.Small,leadingIcon:r&&a.f({children:r,appearance:"icon",size:"2xs"}),children:m`<span class="${i?"inline-block me-[calc(var(--size-button-sm-h)-var(--rem10)-var(--button-border-width-default))]":""} overflow-hidden text-ellipsis">${s}</span>`,screenReaderContent:c})} ${i?m` <span style="${"transform: translateY(-50%);\nposition: absolute;\ninset-inline-end: 0;\ntop: 50%;\ntransform: translateY(-50%);\ndisplay: inline-flex;\n"}"> ${e.o({...d,appearance:"plain",size:e.q.Small,leadingIcon:t({size:n.I.Small})})} </span>`:void 0} </span> `},c:t}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./CIOo61duNV.js",import.meta.url,"CIOo61duNV");SML.di("./CpZ44pmnxI.js",import.meta.url,"CpZ44pmnxI");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./CF6nQkAyW-.js",import.meta.url,"CF6nQkAyW-");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("Dr5Tgf4HIv",["Dw4vb8Yfbm","CIOo61duNV","CpZ44pmnxI","FQGvCwaizg","CF6nQkAyW-","5r73EsgItq"],(async(e,t,i,a,r,s)=>{function l(e){return!!e&&"editable"in e.dataset}let o=class extends i.F{static get styles(){return[i.F.styles,s.a`:host{--styled-scrollbar-background:var(--color-neutral-background-weak)}:host([is-desktop]) slot[name=toggle]{display:none}:host([is-desktop]) .author:hover slot[name=toggle]{display:block}:host(:focus) slot[name=toggle]{display:block}`,e.t]}get flair(){return this.querySelector("div.flair")}get flairTemplateRadioButtons(){return this.querySelectorAll('faceplate-radio-input[name="flairTemplateId"]')}get flairTemplateRadioButton(){return this.querySelector(`faceplate-radio-input[name="flairTemplateId"][value="${this.templateId}"]`)}get clearFlairButton(){return this.querySelector("button.clear-flair")}get submitButton(){return this.querySelector('button[type="submit"]')}get flairEnabledCheckbox(){return this.querySelector('faceplate-checkbox-input[name="flairEnabled"]')}get editorPrompts(){return this.querySelectorAll('div[slot^="flair-edit-prompt-"]')}get editorPrompt(){return this.querySelector(`div[slot^="flair-edit-prompt-${this.templateId}"]`)}get editor(){return this.querySelector("flair-editor")}constructor(){super(),this.isDesktop=!1,this.isMod=!1,this.isOpen=!1,this.handleKeyDown=e=>{const t=e;"Enter"===t.key||" "===t.key?(t.preventDefault(),this.toggleSelector()):"Escape"===t.key&&this.isOpen&&(t.preventDefault(),this.isOpen=!1)},this.onInvalidFlairInput=()=>{this.enableDisableButtons(!1)},this.onValidFlairInput=()=>{this.enableDisableButtons(!0)},this.convertFormDataToGql=t=>{const{flairTemplateId:i,flairText:a,isOwnFlairEnabled:r}=this.currentUserFlairSetting||{},s=this.templateId||void 0,l=this.isMod||Boolean(this.flairEnabledCheckbox?.checked),o=this.isSelectedFlairTemplateEditable()?this.editor?.getFlairText():void 0;if(!s){const i={input:{subredditId:this.subredditId??"",userId:this.userId}};return JSON.stringify({operation:e.O.ClearUserFlair,variables:i,csrf_token:t.get("csrf_token")})}const n=o&&a!==o||i!==s,d=this.isMod||r!==l,u={subredditId:this.subredditId??"",isEnabled:l,flairTemplateId:s??null,text:o??null,shouldUpdateUserFlair:n,shouldUpdateUserFlairEnabledStatus:d,username:this.username??""};return JSON.stringify({operation:e.O.UpdateUserFlairAndEnabledStatus,variables:u,csrf_token:t.get("csrf_token")})},this.onFaceplateRequest=e=>{e.target===this&&this.enableDisableButtons(!1)},this.onFaceplateResponse=e=>{e.target===this&&this.handleFormResponse(e.detail.response)},this.handleFormResponse=async t=>{this.enableDisableButtons(!0);try{(await this.checkSuccessfulResponse(t))?(this.propagateCurrentFlair(),this.showSuccessToast(),this.isOpen=!1):this.showErrorToast(e.cv.QueryBadResponse)}catch(t){this.showErrorToast(e.bM(t))}},this.onFaceplateError=e=>{e.target===this&&this.enableDisableButtons(!0)},this.clearFlair=()=>{this.querySelectorAll('faceplate-radio-input[name="flairTemplateId"][checked]')?.forEach((e=>{e.checked=!1})),this.templateId=void 0,this.flair?.replaceChildren("")},this.clearFlairOnKeyDown=e=>{"Enter"!==e.key&&"Space"!==e.key||this.clearFlair()},this.selectFlairTemplate=e=>{if(!(e.target instanceof t.FaceplateRadioInput)||"string"!=typeof e.target.value)return;this.templateId=e.target.value;const i=l(e.target),a=i?this.editor?this.getEditableFlairContent(this.editor):null:this.getReadonlyFlairContent(e.target);a&&this.updateCurrentFlairDraft(a),i&&this.editor&&(this.editor.richtext=e.target.dataset.richtext,this.editor.text=e.target.dataset.text,this.editor.allowableContent=e.target.dataset.allowableContent?e.target.dataset.allowableContent:void 0,this.editor.maxEmojiCount=e.target.dataset.maxEmojiCount?parseInt(e.target.dataset.maxEmojiCount):void 0)},this.onEditorInput=e=>{if(!this.templateId)return;if(!this.isSelectedFlairTemplateEditable())return;if(!(e.target instanceof r.F))return;const t=this.getEditableFlairContent(e.target);t&&this.updateCurrentFlairDraft(t)},this.encoders={...this.encoders,"application/json":this.convertFormDataToGql}}connectedCallback(){this.clearFlairButton?.addEventListener("click",this.clearFlair),this.clearFlairButton?.addEventListener("keydown",this.clearFlairOnKeyDown),this.flairTemplateRadioButtons.forEach((e=>{e.addEventListener("input",this.selectFlairTemplate)})),this.editor?.addEventListener("input",this.onEditorInput),this.editor?.addEventListener("flair-input-valid",this.onValidFlairInput),this.editor?.addEventListener("flair-input-invalid",this.onInvalidFlairInput),this.addEventListener("faceplate-error",this.onFaceplateError),this.addEventListener("faceplate-request",this.onFaceplateRequest),this.addEventListener("faceplate-response",this.onFaceplateResponse),super.connectedCallback()}disconnectedCallback(){this.removeEventListener("keydown",this.handleKeyDown),this.clearFlairButton?.removeEventListener("click",this.clearFlair),this.clearFlairButton?.removeEventListener("keydown",this.clearFlairOnKeyDown),this.flairTemplateRadioButtons.forEach((e=>{e.removeEventListener("input",this.selectFlairTemplate)})),this.editor?.removeEventListener("input",this.onEditorInput),this.editor?.removeEventListener("flair-input-valid",this.onValidFlairInput),this.editor?.removeEventListener("flair-input-invalid",this.onInvalidFlairInput),this.removeEventListener("faceplate-error",this.onFaceplateError),this.removeEventListener("faceplate-request",this.onFaceplateRequest),this.removeEventListener("faceplate-response",this.onFaceplateResponse),super.disconnectedCallback()}enableDisableButtons(e){this.clearFlairButton&&(this.clearFlairButton.disabled=!e),this.submitButton&&(this.submitButton.disabled=!e)}async checkSuccessfulResponse(e){const t=(await e.json()).data;let i=!0;return t?.clearUserFlair&&(i=i&&t.clearUserFlair.ok),t?.updateUserFlair&&(i=i&&t.updateUserFlair.ok),t?.updateUserSubredditFlairEnabledStatus&&(i=i&&t.updateUserSubredditFlairEnabledStatus.ok),i}showErrorToast(t){this.showAlert("Something went wrong",e.a5.error,t)}showSuccessToast(){this.showAlert("User flair updated",e.a5.success)}showAlert(t,i,a){this.dispatchEvent(e.c("faceplate-alert",{level:i,message:t,cause:a}))}toggleSelector(){this.isOpen=!this.isOpen,this.setAttribute("aria-expanded",String(this.isOpen))}toggleSelectorOnKeyDown(e){"Enter"!==e.key&&"Space"!==e.key||this.toggleSelector()}getEditableFlairContent(e){const t=e.getFlairHtml();if(!t)return;const i=(new DOMParser).parseFromString(t,"text/html").body.querySelector("p");i?.querySelectorAll("img").forEach((e=>{e.classList.add("flair-image","m-0","h-md","w-md")}));const a=this.querySelector(`faceplate-radio-input[name="flairTemplateId"][value="${this.templateId}"]`)?.querySelector("data")?.cloneNode(!0);return a?.querySelector(".flair-content")?.replaceChildren(...Array.from(i?.childNodes||[])),Array.from(a?.childNodes||[])}getReadonlyFlairContent(e){const t=e.querySelector("data")?.childNodes;if(t)return Array.from(t).map((e=>e.cloneNode(!0)))}updateCurrentFlairDraft(e){this.flair?.replaceChildren(...e)}propagateCurrentFlair(){this.userId&&this.subredditId&&e.p(e.T.CommunityAuthorFlairUpdated,{userId:this.userId,subredditId:this.subredditId,html:this.flair?.innerHTML.trim()??"",isEnabled:Boolean(this.flairEnabledCheckbox?.checked)||this.isMod})}isSelectedFlairTemplateEditable(){return l(this.flairTemplateRadioButton)}render(){return s.x` <div class="author flex flex-row flex-nowrap items-center gap-xs" tabindex="0" role="button" aria-haspopup="true" aria-expanded="${this.isOpen}" @keydown="${this.handleKeyDown}"> <slot class="block overflow-hidden w-full"></slot> ${this.isOpen?"":s.x`<slot class="toggle" name="toggle" part="toggle-slot" @click="${this.toggleSelector}" @keydown="${this.toggleSelectorOnKeyDown}"></slot>`} </div> ${this.isOpen||this.isMod?s.x` <slot name="selector"></slot> <slot name="divider"></slot> ${this.isSelectedFlairTemplateEditable()?s.x`<slot name="flair-editor-label"></slot><slot name="flair-editor"></slot>`:""} <slot name="settings"></slot> <slot name="actions"></slot> `:""} `}};e._([e.n({type:Boolean,attribute:"is-desktop"})],o.prototype,"isDesktop",void 0),e._([e.n({type:String,attribute:"template-id"})],o.prototype,"templateId",void 0),e._([e.n({type:String,attribute:"user-id"})],o.prototype,"userId",void 0),e._([e.n({type:String,attribute:"subreddit-id"})],o.prototype,"subredditId",void 0),e._([e.n({type:String,attribute:"subreddit-name"})],o.prototype,"subredditName",void 0),e._([e.n({type:Object,attribute:"current-user-flair-setting"})],o.prototype,"currentUserFlairSetting",void 0),e._([e.n({type:String,attribute:"username"})],o.prototype,"username",void 0),e._([e.n({type:Boolean,attribute:"is-mod"})],o.prototype,"isMod",void 0),e._([e.h()],o.prototype,"isOpen",void 0),o=e._([e.e("community-author-flair")],o),a.r(o)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("DtjwywDamI",["Dw4vb8Yfbm"],(async c=>{const{svg:a}=c.a();return{c:c.m(a`<path d="M10 2.8c3.97 0 7.2 3.23 7.2 7.2s-3.23 7.2-7.2 7.2-7.2-3.23-7.2-7.2S6.03 2.8 10 2.8zM10 1a9 9 0 10.001 18.001A9 9 0 0010 1zm.9 8.63V4.68H9.1V10c0 .24.1.47.26.64l3.76 3.76 1.27-1.27-3.49-3.5z"></path>`,"0 0 20 20","clock")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./CpZ44pmnxI.js",import.meta.url,"CpZ44pmnxI");SML.di("./CQMf561ZyA.js",import.meta.url,"CQMf561ZyA");SML.di("./DflF56Kkuz.js",import.meta.url,"DflF56Kkuz");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./BwcUp7XlaC.js",import.meta.url,"BwcUp7XlaC");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./DnNITwgp90.js",import.meta.url,"DnNITwgp90");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");SML.di("./B0pL5bhFHV.js",import.meta.url,"B0pL5bhFHV");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");
SML.dm("Duj_M5gw-a",["Dw4vb8Yfbm","B-zFJtiar6","5r73EsgItq","BwcMg3lXAs","CpZ44pmnxI","CQMf561ZyA","DflF56Kkuz","FQGvCwaizg","BwcUp7XlaC","BIzQFHISzm","DnNITwgp90","jWC3N3n7Al","B0pL5bhFHV","BtqmVQuPYp"],(async(e,t,i,a)=>{var s,o,r,n;!function(e){e.AgeCollect="age-collect",e.AgeRestrict="age-restrict",e.AgeVerify="age-verify",e.AgeConfirm="age-confirm"}(s||(s={})),function(e){e.UNAVAILABLE_AGE="UNAVAILABLE_AGE",e.UNAVAILABLE_UNVERIFIED_AGE="UNAVAILABLE_UNVERIFIED_AGE",e.UNDER_VERIFIED_AGE="UNDER_VERIFIED_AGE",e.UNVERIFIED_AGE="UNVERIFIED_AGE",e.UNDERAGE="UNDERAGE"}(o||(o={})),function(e){e.BeginVerification="begin-verification"}(r||(r={})),function(e){e.BeginVerification="/svc/shreddit/age-verification/begin-verification"}(n||(n={}));const l="force_age_gating";let c=window.location,h=class extends i.s{constructor(){super(...arguments),this.page=s.AgeCollect,this.postSubmitBehavior="destination",this.successDestination="reload",this.isSettingsCollection=!1,this.gateType=e.fo.Content,this.countdown=new t.bp(this),this.pubsub=new e.u(this),this.onInputKeypress=e=>{"Enter"===e.key&&this.isValid?this.validateAge():isNaN(e.key)&&e.preventDefault()},this.onInput=()=>{this.clearErrorMessage(),this.saveButton.disabled=!this.isValid},this.redirectToAgeVerificationFlow=async()=>{if(this.withAgeVerification){this.submitButton.disabled=!0;try{const t=await fetch(n.BeginVerification,{body:JSON.stringify({completionUrl:this.getAgeVerificationCompletionUrl(),csrf_token:e.K.get("csrf_token")}),method:"POST"}),{data:i,error:a}=await t.json();if(!t.ok||!i?.continueUrl||a)throw new Error(`Failed to fetch age verification url from ${n.BeginVerification}`);c.href=i.continueUrl}catch(t){this.dispatchError("Something went wrong",e.bM(t)),this.submitButton.disabled=!1;const i=t;window.Sentry?.captureMessage?.(i.message)}}},this.submitAge=async()=>{try{const t=a.g(this.inputs);if(null===t)return;const i=await fetch(e.fp.UpdateBirthdate,{method:"POST",body:JSON.stringify({birthdate:t,csrf_token:e.K.get("csrf_token")})});if(i.ok){const{collection_status:a}=await i.json();if(a===e.fq.Underage)return void this.cancelAndRedirect();if(this.withAgeVerification&&a===e.fq.Unverified)return void this.redirectToAgeVerificationFlow();if("destination"===this.postSubmitBehavior)if("reload"===this.successDestination)this.reloadThePage();else{const e=new URL(this.successDestination);e.origin===c.origin&&(c.href=this.successDestination)}else"close"===this.postSubmitBehavior&&(this.pubsub.publish(e.T.AgeGateBirthdateSubmitted,{birthdate:t}),await(this.dialogSheet?.hide()),this.disableCollectionPage(),this.page=s.AgeCollect)}else this.dispatchError("Something went wrong",e.cv.FetchBadResponse)}catch(t){this.dispatchError("Something went wrong",e.bM(t))}},this.validateAge=()=>{const e=a.g(this.inputs);null===e?(this.saveButton.disabled=!0,this.setErrorMessage("Invalid birthdate")):(this.agePlaceholders.forEach((t=>{t.date=a.a(e)})),this.page=s.AgeConfirm)},this.dispatchError=(t,i,a=e.a5.error)=>{const s=e.c("faceplate-alert",{level:a,message:t});this.dispatchEvent(s)},this.updateCountdown=()=>{this.countdownText.textContent=this.countdown.secondsRemaining},this.cancelAndClose=()=>{this.page=s.AgeCollect,this.dialogSheet?.hide()},this.cancelAndRedirect=()=>{this.page=s.AgeRestrict,this.gateType!==e.fo.Platform&&(this.countdown.start(8e3),this.redirectTimeout=setTimeout(this.goHome,8e3))}}get dialogSheet(){return document.querySelector("#age-gate-interstitial")}get inputs(){return[this.querySelector('faceplate-text-input[name="year"]'),this.querySelector('faceplate-text-input[name="month"]'),this.querySelector('faceplate-text-input[name="day"]')].filter(Boolean)}get form(){return this.querySelector("faceplate-form")}get saveButton(){return this.querySelector("#age-gate-submit-btn")}get submitButton(){return this.querySelector(`[slot="${this.page}"] button[slot="primary-button"]`)}get isValid(){return Array.from(this.inputs).every((e=>e.value.length>0&&e.value.length<=(e.maxLength||4)))}get countdownText(){return this.querySelector("#age-restricted-countdown")}get agePlaceholders(){return this.querySelectorAll(".age-date-placeholder")}connectedCallback(){super.connectedCallback(),this.addEventListener("input",this.onInput),this.addEventListener("change",this.onInput),this.inputs?.forEach((e=>e.addEventListener("keypress",this.onInputKeypress))),this.page===s.AgeRestrict&&this.cancelAndRedirect()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("input",this.onInput),this.removeEventListener("change",this.onInput),this.inputs?.forEach((e=>e.removeEventListener("keypress",this.onInputKeypress))),clearTimeout(this.redirectTimeout)}updated(e){super.updated(e),this.countdown.active&&this.updateCountdown()}getAgeVerificationCompletionUrl(){let t=c.origin;t.includes("old.reddit.com")&&(t=t.replace("old.reddit.com","www.reddit.com"));const i=new URL(`${t}/partner/persona/return`),a="reload"===this.successDestination?c.href:this.successDestination,s=new URL(a);s.searchParams.delete(l),i.searchParams.set("destination",s.toString());const o=e.H();return o&&i.searchParams.set("page-type",o),i.searchParams.set("variant","age-verification"),i.toString()}disableCollectionPage(){this.inputs.forEach((e=>{e.disabled=!0})),this.saveButton&&(this.saveButton.disabled=!0)}reloadThePage(){const e=new URL(c.href);e.searchParams.delete(l),e.href===c.href?c.reload():c.href=e.href}goHome(){c.href="/"}setErrorMessage(e){const t=this.form;this.inputs.forEach(((i,a)=>{t?.invalidateFieldWithMessage(i.name,0===a?e:" ")}))}clearErrorMessage(){const e=this.form;this.inputs.forEach((t=>{t.checkValidity()||e?.invalidateFieldWithMessage(t.name,"")}))}render(){return i.x`<slot name="${this.page}"></slot>`}};h.styles=[e.t],e._([e.n({type:Boolean,attribute:"with-age-verification"})],h.prototype,"withAgeVerification",void 0),e._([e.n({type:String,reflect:!0})],h.prototype,"page",void 0),e._([e.n({type:String,attribute:"post-submit-behavior"})],h.prototype,"postSubmitBehavior",void 0),e._([e.n({type:String,attribute:"post-success-destination"})],h.prototype,"successDestination",void 0),e._([e.n({type:Boolean,attribute:"is-settings-collection"})],h.prototype,"isSettingsCollection",void 0),e._([e.n({type:String,attribute:"gate-type"})],h.prototype,"gateType",void 0),h=e._([e.e("age-gate-dialog")],h)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("Dw4K28bgT7",["Dw4vb8Yfbm","B-zFJtiar6"],(async(e,a)=>{const{svg:i}=e.a(),n=e.m(i`<path d="M15.2 15.7c0 .83-.67 1.5-1.5 1.5H6.3c-.83 0-1.5-.67-1.5-1.5V7.6H3v8.1C3 17.52 4.48 19 6.3 19h7.4c1.82 0 3.3-1.48 3.3-3.3V7.6h-1.8v8.1zM17.5 5.8c.5 0 .9-.4.9-.9S18 4 17.5 4h-3.63c-.15-1.68-1.55-3-3.27-3H9.4C7.68 1 6.28 2.32 6.13 4H2.5c-.5 0-.9.4-.9.9s.4.9.9.9h15zM7.93 4c.14-.68.75-1.2 1.47-1.2h1.2c.72 0 1.33.52 1.47 1.2H7.93z"></path>`,"0 0 20 20","delete");let o=a.ca({videoMinDimensionError:(e,a)=>`Videos must be at least ${e}x${a}`,videoMinRateError:e=>`Videos must have a bitrate of at least ${Math.floor(e)}KB/s`,videoCodecError:()=>"Unsupported video codec",videoIsTooShortError:a=>e.cB({one:`Videos must be at least ${a} second`,other:`Videos must be at least ${a} seconds`,count:a}),videoIsTooLongError:a=>e.cB({one:`Videos must be shorter than ${a} minute`,other:`Videos must be shorter than ${a} minutes`,count:a}),videoMaxSizeError:e=>`Videos must be ${e}GB or smaller`,videoMimetypeError:()=>"Upload an MP4 or MOV",imageMaxSizeError:e=>`Upload an image less than ${e}MB`,imageMaxSizeErrorKB:e=>`Upload an image less than ${e}KB`,gifMaxSizeError:e=>`Upload a GIF less than ${e}MB`,gifMaxSizeErrorKB:e=>`Upload a GIF less than${e}KB`,imageMaxDimensionError:(e,a)=>`Upload an image smaller than ${e}x${a}`,imageMinDimensionError:(e,a)=>`Upload an image at least ${e}x${a}`,imageOnlyGifsError:()=>"Upload a GIF",imageOnlyStaticImagesError:()=>"Upload a PNG, JPG, WEBP",imageStaticOrGifError:()=>"Upload a PNG, JPG, WEBP, or GIF",or:()=>"or ",imageTypeJoin:e=>`${r(e).reduce(((e,a,i,n)=>`${e}${t(i,n)}${$(i,n)}${a}`),"")}`,imageInvalidTypeErrorGeneric:()=>"Upload an image",imageInvalidTypeErrorSpecified:e=>`Upload a ${e}`});const r=e=>e.reduce(((e,i)=>{const n=a.R.get(i)||i;return e.includes(n)?e:[...e,n]}),[]),t=(e,a)=>e>0?a.length>2?", ":" ":"",$=(e,a)=>a.length>1&&e===a.length-1?o.or():"",d=["image/jpeg","image/png","image/webp"],s=["image/gif"],m=[...d,...s],u=1024,l=1048576,c=20971520,I=104857600,h=e=>e.split(",").map((e=>e.trim())),G=e=>{const a="accept"in e?e.accept:void 0,{allowStaticImages:i=!1,allowAnimatedImages:n=!1}="allowStaticImages"in e?e:{};return{accept:a,allowStaticImages:i,allowAnimatedImages:n}};function P(e){const{accept:a,allowStaticImages:i,allowAnimatedImages:n}=G(e);if(a&&a?.includes("image/*"))return o.imageInvalidTypeErrorGeneric();if(a){const e=h(a);return o.imageInvalidTypeErrorSpecified(o.imageTypeJoin(e))}return n&&!i?o.imageOnlyGifsError():i&&!n?o.imageOnlyStaticImagesError():o.imageStaticOrGifError(a)}function B(e){const a=[],{accept:i,allowStaticImages:n,allowAnimatedImages:o}=G(e);return i?h(i):(n&&a.push(...d),o&&a.push(...s),a)}return{S:m,a:B,d:n,g:async function(e){const a=URL.createObjectURL(e),{width:i,height:n}=await function(e){return new Promise(((a,i)=>{const n=new Image;n.onload=()=>{a({width:n.width,height:n.height})},n.onerror=e=>{i(e)},n.src=e}))}(a);return{src:a,type:e.type,size:e.size,width:i,height:n}},get u(){return o},v:function(e,a){const{width:i,height:n,type:r,size:t}=e,{minImageDimension:$,maxImageDimension:d,maxImageFileSize:s=c,maxGifFileSize:m=I}=a,{accept:h,allowStaticImages:N,allowAnimatedImages:k}=G(a),p=B(a);if(!(p.includes(r)||p.includes("image/*")&&r.startsWith("image/")))return{valid:!1,error:P(h?{accept:h}:{allowStaticImages:N,allowAnimatedImages:k}),reason:"INVALID_IMAGE_TYPE_ERROR"};if($&&(i<$||n<$))return{valid:!1,error:o.imageMinDimensionError($,$),reason:"IMAGE_MIN_DIMENSION_ERROR"};if(d&&(i>d||n>d))return{valid:!1,error:o.imageMaxDimensionError(d,d),reason:"IMAGE_MAX_DIMENSION_ERROR"};if("image/gif"===r&&t>m){return{valid:!1,error:Math.floor(m/l)<1?o.gifMaxSizeErrorKB(Math.floor(m/u)):o.gifMaxSizeError(Math.floor(m/l)),reason:"IMAGE_SIZE_LIMIT_EXCEEDED_ERROR"}}if(r.startsWith("image/")&&"image/gif"!==r&&t>s){return{valid:!1,error:Math.floor(s/l)<1?o.imageMaxSizeErrorKB(Math.floor(s/u)):o.imageMaxSizeError(Math.floor(s/l)),reason:"IMAGE_SIZE_LIMIT_EXCEEDED_ERROR"}}return{valid:!0,error:null}}}}));
SML.di("./Dc3SyJ2ZoZ.js",import.meta.url,"Dc3SyJ2ZoZ");SML.di("./C2HHHowe8h.js",import.meta.url,"C2HHHowe8h");SML.di("./DZ58bPdK5X.js",import.meta.url,"DZ58bPdK5X");SML.di("./8JyL8BkyKU.js",import.meta.url,"8JyL8BkyKU");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./RXNEUFNiHt.js",import.meta.url,"RXNEUFNiHt");SML.di("./CRzmHkIoo0.js",import.meta.url,"CRzmHkIoo0");SML.di("./Hy4GfUHxlh.js",import.meta.url,"Hy4GfUHxlh");SML.di("./CVNmbm37o6.js",import.meta.url,"CVNmbm37o6");SML.di("./C0cxgUZlQL.js",import.meta.url,"C0cxgUZlQL");SML.di("./DgW4ULLwQ1.js",import.meta.url,"DgW4ULLwQ1");SML.di("./BDidT9_yHr.js",import.meta.url,"BDidT9_yHr");SML.di("./C4w49Ew8DF.js",import.meta.url,"C4w49Ew8DF");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./C2AqOgl1ck.js",import.meta.url,"C2AqOgl1ck");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Chd9fEZKZ6.js",import.meta.url,"Chd9fEZKZ6");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./BhZAdnVq89.js",import.meta.url,"BhZAdnVq89");SML.di("./DdOxCDp7Tq.js",import.meta.url,"DdOxCDp7Tq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");SML.di("./av6qvYZJJ7.js",import.meta.url,"av6qvYZJJ7");SML.di("./jFB0DOsi41.js",import.meta.url,"jFB0DOsi41");SML.di("./BQbrDNllG4.js",import.meta.url,"BQbrDNllG4");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./DoSzdRrY_z.js",import.meta.url,"DoSzdRrY_z");SML.di("./_C4HT6j0ig.js",import.meta.url,"_C4HT6j0ig");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");SML.di("./DHw9yEcfFd.js",import.meta.url,"DHw9yEcfFd");SML.di("./DflF56Kkuz.js",import.meta.url,"DflF56Kkuz");SML.di("./B0pL5bhFHV.js",import.meta.url,"B0pL5bhFHV");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");SML.di("./BYpE6FdcdE.js",import.meta.url,"BYpE6FdcdE");SML.di("./Dw4K28bgT7.js",import.meta.url,"Dw4K28bgT7");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./CdmJSaSHd8.js",import.meta.url,"CdmJSaSHd8");SML.di("./DJSLRtH1XX.js",import.meta.url,"DJSLRtH1XX");SML.di("./DT9eLCODQW.js",import.meta.url,"DT9eLCODQW");SML.di("./BLbwpJ0bjx.js",import.meta.url,"BLbwpJ0bjx");SML.di("./kS-PCwPq_X.js",import.meta.url,"kS-PCwPq_X");SML.di("./D-ibjVaztZ.js",import.meta.url,"D-ibjVaztZ");SML.di("./YAFaZPh0hw.js",import.meta.url,"YAFaZPh0hw");SML.di("./KHcvarc_gp.js",import.meta.url,"KHcvarc_gp");SML.di("./B7VtDPc4tA.js",import.meta.url,"B7VtDPc4tA");SML.di("./CUIVPWsUpf.js",import.meta.url,"CUIVPWsUpf");SML.di("./CzmIuH4u_q.js",import.meta.url,"CzmIuH4u_q");SML.di("./D14t1nj-sI.js",import.meta.url,"D14t1nj-sI");SML.di("./DQQjPN-OEj.js",import.meta.url,"DQQjPN-OEj");SML.di("./CG8L8PJoXS.js",import.meta.url,"CG8L8PJoXS");SML.di("./Bv2UEnJP_M.js",import.meta.url,"Bv2UEnJP_M");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./CzwD205thW.js",import.meta.url,"CzwD205thW");SML.di("./Dm3xIDznQh.js",import.meta.url,"Dm3xIDznQh");SML.di("./5KlNO8qI18.js",import.meta.url,"5KlNO8qI18");SML.di("./Hw1PFKH8z9.js",import.meta.url,"Hw1PFKH8z9");SML.di("./Dj7wutmAw0.js",import.meta.url,"Dj7wutmAw0");SML.di("./JaGlTj3I-9.js",import.meta.url,"JaGlTj3I-9");SML.di("./BOFc1KQJc-.js",import.meta.url,"BOFc1KQJc-");SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");SML.di("./CQrDBXK-hm.js",import.meta.url,"CQrDBXK-hm");
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./E3QE3c4_Ye.js",import.meta.url,"E3QE3c4_Ye");SML.di("./DasPtA-dN5.js",import.meta.url,"DasPtA-dN5");
SML.dm("DyRz1vAoTm",["Dw4vb8Yfbm","5r73EsgItq","E3QE3c4_Ye","DasPtA-dN5"],(async(N,I,a,A)=>{const{svg:R}=N.a(),E=N.m(R`<path d="M17.046 6.97c.577-.333 1.05-.06 1.05.606v5.77c0 .822-.439 1.582-1.15 1.993l-4.998 2.886c-.578.334-1.05.061-1.05-.606v-4.097l2.475-1.428a.25.25 0 00.125-.216V9.02l3.548-2.049zm-9.649.49l2.475-1.429a.248.248 0 01.25 0l2.475 1.43 3.548-2.049c.577-.333.578-.879 0-1.212l-4.999-2.886a2.3 2.3 0 00-2.3 0L3.848 4.2a.7.7 0 000 1.212l3.55 2.048zm1.7 6.062l-2.475-1.428a.25.25 0 01-.125-.216V9.02L2.948 6.97a.7.7 0 00-1.05.606v5.772c0 .822.44 1.582 1.151 1.993l4.998 2.885c.577.333 1.05.06 1.05-.606v-4.098z"></path>`,"0 0 20 20","devvit-fill"),{svg:e}=N.a(),l=N.m(e`<path d="M18.748 13.149s-.296-2.342-.63-4.771C17.379 3 12.909 3 11.439 3h-3.32c-1.47 0-5.942 0-6.682 5.379-.333 2.423-.629 4.762-.63 4.766A3.412 3.412 0 004.186 17a3.402 3.402 0 003.24-2.352 1.083 1.083 0 011.031-.747h2.638c.471 0 .886.3 1.035.753a3.407 3.407 0 006.616-1.505h.003zM6.778 10.75a1.75 1.75 0 110-3.501 1.75 1.75 0 010 3.501zm5.5-2a1.25 1.25 0 110-2.5 1.25 1.25 0 010 2.5zm2 3.5a1.25 1.25 0 110-2.5 1.25 1.25 0 010 2.5z"></path>`,"0 0 20 20","game-controller-fill"),{svg:r}=N.a(),T=N.m(r`<path d="M8.312 9.202c.133.238.199.508.199.802 0 .296-.066.566-.199.802a1.483 1.483 0 01-.542.561 1.44 1.44 0 01-.748.204 1.4 1.4 0 01-.75-.207 1.501 1.501 0 01-.536-.565 1.64 1.64 0 01-.196-.797c0-.292.066-.562.198-.801.13-.236.311-.426.536-.564.229-.138.475-.205.748-.205.27 0 .521.069.748.205.228.137.409.327.542.566v-.001zM19 10c0 4.963-4.038 9-9 9s-9-4.037-9-9 4.038-9 9-9 9 4.037 9 9zm-8.951 0a2.946 2.946 0 00-1.488-2.601 3.03 3.03 0 00-1.532-.4c-.55 0-1.062.134-1.521.398a2.996 2.996 0 00-1.503 2.598c0 .55.137 1.061.405 1.518a2.97 2.97 0 001.098 1.088c.46.264.973.398 1.525.398.54 0 1.046-.129 1.503-.384.46-.256.83-.616 1.101-1.069.272-.453.411-.974.411-1.547l.001.001zm5.591 2.46l-.609-1.429-.157.166c-.112.12-.263.208-.46.272a1.855 1.855 0 01-1.452-.104 1.565 1.565 0 01-.599-.565 1.518 1.518 0 01-.22-.807c0-.298.074-.568.221-.801.149-.239.344-.42.595-.554.439-.232.966-.26 1.431-.09.195.072.354.168.476.284l.156.15.604-1.423-.109-.067a3.108 3.108 0 00-.852-.364c-.87-.227-1.755-.128-2.486.267a2.965 2.965 0 00-1.146 1.072 2.857 2.857 0 00-.426 1.527c0 .563.146 1.081.432 1.539.285.457.675.819 1.158 1.079.482.258 1.014.39 1.581.39.303 0 .61-.04.915-.118.304-.079.586-.198.839-.354l.109-.067-.001-.003z"></path>`,"0 0 20 20","original-fill"),{svg:P}=N.a(),O=N.m(P`<path d="M18.037 7.667l-5.703-5.702a3.303 3.303 0 00-4.667 0L1.965 7.667a3.304 3.304 0 000 4.666l5.701 5.702A3.291 3.291 0 0010 19a3.29 3.29 0 002.333-.965l5.703-5.702a3.304 3.304 0 000-4.666h.002zm-3.884 3.724l-2.05-1.186a.82.82 0 00-.416-.127.844.844 0 00-.845.843c0 .31.176.57.426.717l2.035 1.19a2.492 2.492 0 01-1.617.607 2.496 2.496 0 01-1.685-.662 2.496 2.496 0 01-1.685.662 2.491 2.491 0 01-1.618-.605l2.035-1.192a.835.835 0 00.425-.717.844.844 0 00-.842-.843.815.815 0 00-.419.127l-2.049 1.188a2.524 2.524 0 01-.047-.471c0-1.116.736-2.053 1.744-2.38a2.474 2.474 0 01-.058-.527 2.51 2.51 0 011.678-2.36l-.007 2.36a.845.845 0 001.687 0c0-.785-.009-1.574-.009-2.36a2.509 2.509 0 011.68 2.36c0 .18-.021.357-.059.528a2.507 2.507 0 011.743 2.38c0 .16-.018.317-.047.469v-.001z"></path>`,"0 0 20 20","quarantined-fill");var t;!function(N){N.APP="APP",N.GAME="GAME",N.NSFW="NSFW",N.ORIGINAL="ORIGINAL",N.SPOILER="SPOILER",N.QUARANTINED="QUARANTINED"}(t||(t={}));return {get C(){return t},c:({attributes:R,children:e,appearance:r})=>{const{html:P,createElement:L}=N.a(),i={size:I.I.Small,attributes:{className:"inline-block",style:"vertical-align: text-bottom"}},n={[t.APP]:{className:"text-ai-plain",icon:E(i)},[t.GAME]:{className:"text-ai-plain",icon:l(i)},[t.NSFW]:{className:"text-category-nsfw",icon:a.n(i)},[t.ORIGINAL]:{className:"text-primary",icon:T(i)},[t.SPOILER]:{className:"text-category-spoiler",icon:A.c(i)},[t.QUARANTINED]:{className:"text-warning-content",icon:O(i)}},s=P`<span class="inline-block" aria-hidden="true">${[n[r].icon]}</span> <span class="text-label-2 uppercase">${e}</span>`;return L("span",{...R,className:`flex items-center gap-2xs ${[n[r].className]}`,rpl:!0},s)},d:E,g:()=>({[t.NSFW]:{children:"NSFW",appearance:t.NSFW},[t.APP]:{children:"APP",appearance:t.APP},[t.GAME]:{children:"GAME",appearance:t.GAME},[t.SPOILER]:{children:"SPOILER",appearance:t.SPOILER},[t.QUARANTINED]:{children:"QUARANTINED",appearance:t.QUARANTINED},[t.ORIGINAL]:{children:"ORIGINAL",appearance:t.ORIGINAL}})};}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("E3QE3c4_Ye",["Dw4vb8Yfbm"],(async a=>{const{svg:c}=a.a();return{n:a.m(c`<path d="M12.823 10.928a.72.72 0 010 .799.844.844 0 01-.337.282c-.146.07-.304.105-.482.105a1.13 1.13 0 01-.479-.101.836.836 0 01-.343-.278.68.68 0 01-.125-.402.7.7 0 01.123-.405.852.852 0 01.335-.293c.144-.072.31-.11.49-.11.182 0 .346.038.486.11a.83.83 0 01.332.293zm-1.225-1.686c.12.066.257.1.406.1a.823.823 0 00.405-.1.733.733 0 00.385-.655.699.699 0 00-.103-.376.675.675 0 00-.283-.256.889.889 0 00-.403-.092.888.888 0 00-.404.092.698.698 0 00-.39.632.734.734 0 00.389.654h-.002zm6.437 3.09l-5.703 5.703A3.291 3.291 0 0110 19c-.844 0-1.69-.322-2.333-.965l-5.704-5.702a3.304 3.304 0 010-4.666l5.703-5.702a3.303 3.303 0 014.666 0l5.703 5.702a3.304 3.304 0 010 4.666zm-9.941-5.62L5.832 7.739l-.03.013v1.44l1.23-.545v4.64H8.57V6.71h-.475zm6.33 4.697c0-.333-.088-.642-.263-.917a1.996 1.996 0 00-.665-.638 1.86 1.86 0 00.615-1.382c0-.363-.097-.687-.286-.963a1.884 1.884 0 00-.766-.643 2.45 2.45 0 00-1.05-.227c-.377 0-.732.075-1.053.224a1.906 1.906 0 00-.774.64 1.65 1.65 0 00-.292.966c0 .279.059.545.175.79.107.227.255.426.44.595a1.974 1.974 0 00-.665.64 1.708 1.708 0 00.048 1.907c.209.296.502.533.87.704.367.17.784.257 1.24.257.45 0 .866-.085 1.232-.252a2.15 2.15 0 00.872-.7c.211-.298.319-.634.319-1l.003-.001z"></path>`,"0 0 20 20","nsfw-fill")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("FQGvCwaizg",["Dw4vb8Yfbm"],(async e=>{const t=e.h0(),n=function(){const e=new WeakMap;let t=!1;return{get isDirty(){return t},getRegistration:(e,t,n)=>({target:e,key:t,value:n}),register({target:n,key:r,value:o}){const s=e.get(n);if(s&&!s.has(r))s.set(r,o);else{if(s)throw new Error(`Cannot register value for key ${r}; something is already registered!`);e.set(n,new Map([[r,o]]))}t=!0},unregister({target:n,key:r,value:o}){const s=e.get(n);s&&s.get(r)===o&&(s.delete(r),t=!0)},getRegisteredElements(n){const r=e.get(n);return t=!1,r},unregisterAll(n){e.delete(n),t=!0}}}(),r=e.g$("FaceplateForm"),o=r.registerAncestorClass,s=r.connectToAncestor,i=Symbol.for("mixins/form-association");function c(e){return!!e&&i in e.constructor}function a(e){return!!e&&(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement||i in e.constructor)}const u=new Set(["checkbox","radio"]);function l(e){return a(e)&&u.has(e.type)||c(e)&&"checked"in e}const g=new Set(["radio"]);return{F:i,H:24,O:2592e6,a:c,b:function(e){return!!e&&(e instanceof HTMLSelectElement||i in e.constructor&&"options"in e)},c:s,d:a,e:function(e){return l(e)&&g.has(e.type)},f:n,g:t,i:l,r:o}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");
SML.dm("FbqiA6OBP5",["Dw4vb8Yfbm","xrDbp1ee_h"],(async(n,t)=>{const a=t=>n.b({source:"translate_button",action:"view",noun:"comment"},(({comment:t,post:a},e=!1)=>{const{thingId:o,parentId:s,postId:i,isCommentTranslated:r}=t,{postLanguage:u,isPostTranslated:d,subredditId:l,subredditPrefixedName:c}=a,b=e?"could not translate":r?n.bm:n.bn;return{comment:{id:o,parent_id:s,translation_language:t.translationLanguage,translation_state:r},post:{id:i||"",language:u,translation_language:a.translationLanguage,translation_state:d,subreddit_id:l,subreddit_name:c},action_info:{reason:b}}})(t));var e;!function(n){n.Dismiss="dismiss",n.UpdateSettings="update_settings"}(e||(e={}));const o=(t,a=!1)=>{const{id:e,name:o,isDescriptionsTranslated:s,nsfw:i,quarantined:r,translationLanguage:u}=t;return{subreddit:{id:e,name:o,quarantined:r,nsfw:i,translation_language:u,translation_state:s},action_info:{reason:a?"could not translate":s?n.bm:n.bn}}};return{a:a=>n.b({source:"translate_button",action:"dismiss",noun:"survey"},a?t.k({fields:t.l(a),post:a,postIsTranslated:!0}):{}),b:(a,e)=>{let o=e?t.k({fields:t.l(e),post:e,postIsTranslated:!0}):{};return o={...o,action_info:{...o?.action_info,reason:a}},n.b({source:"translate_button",action:"submit",noun:"survey"},o)},c:(t,e,o,s)=>{const i=a({comment:{isCommentTranslated:t.isCommentTranslated,parentId:t.parentId,postId:t.postId,thingId:t.thingId,translationLanguage:t.translationLanguage},post:{isPostTranslated:e.isPostTranslated,postId:t.postId,title:e.title,translationLanguage:t.translationLanguage}});return{...i,action_info:{...i.action_info,page_type:n.au.SearchResults,pane_name:n.bo[s],reason:o?n.bm:n.bn}}},d:(a,e,o)=>{const s=t.p({id:a.postId||"",postTitle:a.title,isTranslationOn:a.isPostTranslated,postLanguage:a.postLanguage,translationLanguage:a.translationLanguage,subredditId:a.subredditId,subredditPrefixedName:a.subredditPrefixedName},e);return{...s,action_info:{...s.action_info,page_type:n.au.SearchResults,pane_name:n.bo[o],reason:e?n.bm:n.bn}}},e:t=>n.b({source:"translate_button",action:"view",noun:"coachmark"},{action_info:{reason:t?n.bm:n.bn}}),f:t=>n.b({source:"translate_button",action:"view",noun:"toggle"},{action_info:{reason:t?n.bm:n.bn}}),g:t=>n.b({source:"translate_button",action:"click",noun:"coachmark"},{action_info:{reason:t||""}}),get h(){return e},i:t=>n.b({source:"translate_button",action:"click",noun:"nav"},{action_info:{reason:t?n.bm:n.bn}}),j:t=>n.b({source:"translate_button",action:"view",noun:"nav"},{action_info:{reason:t?n.bm:n.bn}}),p:a=>n.b({source:"translate_button",action:"view",noun:"survey"},a?t.k({fields:t.l(a),post:a,postIsTranslated:!0}):{}),t:(t,a,e)=>n.b({source:"translate_button",action:"view",noun:"community"},{...o(t),action_info:{...o(t).action_info,page_type:a,pane_name:n.bo[e]}})}}));
SML.di("./CW_r9jbopq.js",import.meta.url,"CW_r9jbopq");SML.di("./CZ0Z5XJFvV.js",import.meta.url,"CZ0Z5XJFvV");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("Hw1PFKH8z9",[],(async()=>{const t=t=>{let r=t.title??"";return t.text&&(r.length&&(r+="\n\n"),r+=t.text),t.url&&(r.length&&(r+="\n\n"),r+=t.url),r};var r;!function(t){t[t.NativeShare=0]="NativeShare",t[t.Clipboard=1]="Clipboard"}(r||(r={}));var a=async(a,e=!0,n=t)=>{if("function"==typeof window.navigator.share&&!e){try{await window.navigator.share(a)}catch(t){}return r.NativeShare}try{await navigator.clipboard.writeText(n(a))}catch(t){}return r.Clipboard};return{get S(){return r},get s(){return a}}}));

SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Chd9fEZKZ6.js",import.meta.url,"Chd9fEZKZ6");SML.di("./DdOxCDp7Tq.js",import.meta.url,"DdOxCDp7Tq");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");SML.di("./av6qvYZJJ7.js",import.meta.url,"av6qvYZJJ7");SML.di("./jFB0DOsi41.js",import.meta.url,"jFB0DOsi41");SML.di("./_C4HT6j0ig.js",import.meta.url,"_C4HT6j0ig");SML.di("./DflF56Kkuz.js",import.meta.url,"DflF56Kkuz");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./Dw4K28bgT7.js",import.meta.url,"Dw4K28bgT7");
SML.dm("Hy4GfUHxlh",["Dw4vb8Yfbm","5r73EsgItq","Chd9fEZKZ6","DdOxCDp7Tq","D_g7f2Ewyi","Dw4K28bgT7","BYzqEZ3uv3","eY7T41bKac","av6qvYZJJ7","jFB0DOsi41","_C4HT6j0ig","DflF56Kkuz"],(async(e,i,t,n,a,o)=>{var r;!function(e){e.NotificationInbox="NotificationInbox",e.AnnouncementFullPage="AnnouncementFullPage"}(r||(r={}));const s="ANNOUNCEMENT";let l=class extends i.s{constructor(){super(...arguments),this.authorId="",this.authorName="",this.shouldUseRpl=!1,this.isOptingOut=!1,this.handleOptOut=async()=>{if(!this.isOptingOut){this.isOptingOut=!0;try{if(!this.authorId)throw new Error("Turning off admin announcements requires an author id");if(!(await e.Y({operation:e.O.UpdateInboxAnnouncementOptOuts,variables:{input:{authorIds:[this.authorId],option:e.dX.AddOptOut}}})).data.updateInboxAnnouncementOptOuts.ok)throw new Error("Failed to turn off admin announcements");this.showSuccessToast()}catch{this.showErrorToast()}this.isOptingOut=!1}}}showSuccessToast(){this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.success,message:"Successfully turned off notifications from admin"}))}showErrorToast(){this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.error,cause:"uncategorized",message:"Failed turn off notifications from admin. Please try again."}))}render(){const e="Turn off notifications from this admin";return this.shouldUseRpl?i.x` <rpl-menu-item size="small" @click="${this.handleOptOut}" ?disabled="${this.isOptingOut}"> ${e} </rpl-menu-item>`:i.x` ${a.l({label:e,onClick:this.handleOptOut,disabled:this.isOptingOut})}`}};l.styles=[e.t],e._([e.n({type:String,attribute:"author-id"})],l.prototype,"authorId",void 0),e._([e.n({type:String,attribute:"author-name"})],l.prototype,"authorName",void 0),e._([e.n({type:Boolean,attribute:"should-use-rpl"})],l.prototype,"shouldUseRpl",void 0),e._([e.h()],l.prototype,"isOptingOut",void 0),l=e._([e.e("announcement-opt-out-list-item")],l);let d=class extends i.s{constructor(){super(...arguments),this.announcementId="",this.shouldUseRpl=!1,this.shouldUseRemoveIcon=!1,this.isHidingAnnouncement=!1,this.pubsub=new e.u(this),this.hideAnnouncement=async()=>{if(!this.isHidingAnnouncement){this.isHidingAnnouncement=!0;try{if(!this.announcementId)throw new Error("Hiding announcement requires an announcement id");if(!(await e.Y({operation:e.O.HideInboxAnnouncements,variables:{input:{ids:[this.announcementId]}}})).data.hideInboxAnnouncements.ok)throw new Error("Failed to hide announcement from notifications");this.showSuccessToast(),this.pubsub.publish(e.T.NotificationInboxNotificationHideEvent,{notificationId:this.announcementId})}catch{this.showErrorToast()}this.isHidingAnnouncement=!1}}}showSuccessToast(){this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.success,message:"Notification removed"}))}showErrorToast(){this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.error,cause:"uncategorized",message:"Failed to remove notification. Please try again."}))}render(){if(this.shouldUseRemoveIcon)return e.o({appearance:"plain",leadingIcon:o.d({size:i.I.Small}),size:e.q.Small,attributes:{"data-testid":"delete-notification",onclick:()=>{this.hideAnnouncement()},slot:"hover-actions"}});const t="Remove";return this.shouldUseRpl?i.x` <rpl-menu-item size="small" @click="${this.hideAnnouncement}" ?disabled="${this.isHidingAnnouncement}"> ${t} </rpl-menu-item> `:a.l({label:t,onClick:this.hideAnnouncement,disabled:this.isHidingAnnouncement})}};d.styles=[e.t],e._([e.n({type:String,attribute:"announcement-id"})],d.prototype,"announcementId",void 0),e._([e.n({type:Boolean,attribute:"should-use-rpl"})],d.prototype,"shouldUseRpl",void 0),e._([e.n({type:Boolean,attribute:"should-use-remove-icon"})],d.prototype,"shouldUseRemoveIcon",void 0),e._([e.h()],d.prototype,"isHidingAnnouncement",void 0),d=e._([e.e("announcement-remove-list-item")],d);let u=class extends i.s{constructor(){super(...arguments),this.permalink="",this.shouldUseRpl=!1,this.onCopyLink=async()=>{try{if(!this.permalink)throw new Error("Permalink needs to be set");await navigator.clipboard.writeText(`${window.location.origin}${this.permalink}`),this.showSuccessToast()}catch{this.showErrorToast()}}}showSuccessToast(){this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.success,message:"Link copied"}))}showErrorToast(){this.dispatchEvent(e.c("faceplate-alert",{level:e.a5.error,cause:"announcement-copy-link-fail",message:"Failed to copy link"}))}render(){const e="Copy link";return this.shouldUseRpl?i.x` <rpl-menu-item size="small" @click="${this.onCopyLink}"> ${e} </rpl-menu-item> `:a.l({label:e,onClick:this.onCopyLink})}};u.styles=[e.t],e._([e.n({type:String})],u.prototype,"permalink",void 0),e._([e.n({type:Boolean,attribute:"should-use-rpl"})],u.prototype,"shouldUseRpl",void 0),u=e._([e.e("announcement-share-list-item")],u);let c=class extends i.s{constructor(){super(...arguments),this.context=r.NotificationInbox,this.announcementId="",this.isDesktop=!1,this.isM2InboxExperiment=!1,this.shouldShowOptOutButton=!1,this.shouldShowHideButton=!1,this.subject="",this.authorName="",this.authorId="",this.isDialogOpened=!1,this.getHref=()=>`/notifications/a/${this.announcementId}`,this.getIsRead=()=>this.isM2InboxExperiment?!this.querySelector("rpl-inbox-row[selected]"):!this.closest("notification-announcement")?.querySelector(`.${n.u}`),this.getNotificationTelemetryData=()=>({type:s,title:this.subject,id:this.announcementId}),this.renderCopyLink=()=>i.x`<faceplate-tracker source="inbox" action="click" noun="overflow_option" data-faceplate-tracking-context="${JSON.stringify({notification:this.getNotificationTelemetryData(),action_info:{type:"copy_link",reason:this.authorName}})}"> <announcement-share-list-item permalink="${this.getHref()}" ?should-use-rpl="${this.isM2InboxExperiment}" data-testid="announcement-overflow-copy-link-item" @click="${this.onMenuItemClick}"> </announcement-share-list-item> </faceplate-tracker>`,this.renderHideButton=e=>i.x` <faceplate-tracker source="inbox" action="click" noun="overflow_option" data-faceplate-tracking-context="${JSON.stringify({notification:this.getNotificationTelemetryData(),action_info:{type:"hide_notification",reason:this.authorName}})}"> <announcement-remove-list-item announcement-id="${this.announcementId}" ?should-use-rpl="${this.isM2InboxExperiment}" ?should-use-remove-icon="${e}" data-testid="announcement-overflow-remove-item" @click="${this.onMenuItemClick}"> </announcement-remove-list-item> </faceplate-tracker> `,this.renderOptOutButton=()=>i.x`<faceplate-tracker source="inbox" action="click" noun="overflow_option" data-faceplate-tracking-context="${JSON.stringify({notification:this.getNotificationTelemetryData(),action_info:{type:"opt_out",reason:this.authorName}})}"><announcement-opt-out-list-item author-id="${this.authorId}" author-name="${this.authorName}" ?should-use-rpl="${this.isM2InboxExperiment}" data-testid="announcement-overflow-opt-out-item" @click="${this.onMenuItemClick}"></announcement-opt-out-list-item></faceplate-tracker>`,this.renderOverflowHorizontalBtn=()=>{const a=this.context===r.NotificationInbox,o=a?i.I.Small:i.I.ExtraSmall,l=a?e.q.Small:e.q.ExtraSmall;return i.x` <faceplate-tracker source="${n.a}" action="click" noun="${n.g}" data-faceplate-tracking-context="${JSON.stringify(n.h({notificationId:this.announcementId,notificationType:s,isViewed:!0,isClicked:this.getIsRead()}))}"> ${e.o({appearance:"plain",attributes:{type:"button",slot:"menu","aria-label":"Open announcement actions","data-testid":"overflow-horizontal-button",onclick:()=>{this.openRplDialog()}},leadingIcon:t.o({size:o}),size:l})} </faceplate-tracker> `;},this.renderRemoveBtn=()=>this.isM2InboxExperiment&&this.isDesktop&&this.shouldShowHideButton&&this.context===r.NotificationInbox?this.renderHideButton(!0):i.A,this.onMenuItemClick=()=>{this.isDesktop?this.shadowRoot?.querySelector("rpl-dropdown")?.hide():this.closeRplDialog()},this.closeRplDialog=()=>{this.isDialogOpened=!1},this.openRplDialog=()=>{this.isDialogOpened=!0}}render(){const t=[this.renderCopyLink(),this.shouldShowHideButton?this.renderHideButton():null,this.shouldShowOptOutButton?this.renderOptOutButton():null].filter(Boolean),n=i.x` <rpl-modal-card> <div slot="title"> ${"Options"} </div> <div slot="close-button"> ${e.o({appearance:"secondary",leadingIcon:e.al({size:i.I.Small}),size:e.q.Small,attributes:{style:"line-height: initial;",onclick:()=>{this.closeRplDialog()}}})} </div> <rpl-menu class="cursor-pointer"> ${t} </rpl-menu> </rpl-modal-card> `;return i.x` <div class="flex gap-1"> ${this.renderRemoveBtn()} ${this.isM2InboxExperiment?this.isDesktop?i.x` <rpl-dropdown placement="bottom-end"> ${this.renderOverflowHorizontalBtn()} <rpl-menu slot="content" class="cursor-pointer"> ${t} </rpl-menu> </rpl-dropdown> `:i.x` <div> ${this.renderOverflowHorizontalBtn()} <rpl-dialog-sheet dialog-id="dialog-announcement-overflow-menu-${this.announcementId}" force-variant="bottom-sheet" .open="${this.isDialogOpened}" @rpl-dialog-sheet:after-hide="${()=>{this.isDialogOpened=!1}}" .litTemplateChildren="${n}"> </rpl-dialog-sheet> </div> `:i.x` <faceplate-dropdown-menu position="bottom-end"> ${this.renderOverflowHorizontalBtn()} <faceplate-menu slot="menu" class="block bg-neutral-background" dropdown> ${t} </faceplate-menu> </faceplate-dropdown-menu> `} </div>`}};return c.styles=[e.t],e._([e.n({type:String})],c.prototype,"context",void 0),e._([e.n({type:String,attribute:"announcement-id"})],c.prototype,"announcementId",void 0),e._([e.n({type:Boolean,attribute:"is-desktop"})],c.prototype,"isDesktop",void 0),e._([e.n({type:Boolean,attribute:"is-m2-inbox-experiment"})],c.prototype,"isM2InboxExperiment",void 0),e._([e.n({type:Boolean,attribute:"should-show-opt-out"})],c.prototype,"shouldShowOptOutButton",void 0),e._([e.n({type:Boolean,attribute:"should-show-hide"})],c.prototype,"shouldShowHideButton",void 0),e._([e.n({type:String,attribute:"subject"})],c.prototype,"subject",void 0),e._([e.n({type:String,attribute:"author-name"})],c.prototype,"authorName",void 0),e._([e.n({type:String,attribute:"author-id"})],c.prototype,"authorId",void 0),e._([e.h()],c.prototype,"isDialogOpened",void 0),c=e._([e.e("announcement-overflow-menu")],c),{N:s}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("HzkRsiDxC9",["Dw4vb8Yfbm"],(async a=>{const t={[a.ax.Card]:{get description(){return "Card";}},[a.ax.Compact]:{get description(){return "Compact";}},[a.ax.Classic]:{get description(){return "Compact";}}};var o;return function(a){a.MANUAL="manual",a.AUTOMATIC="automatic"}(o||(o={})),{get B(){return o},C:"/svc/shreddit/:subredditName/community-highlights",F:t,P:"post-deletion-modal",S:"subreddit-right-rail__partial",a:"subreddit-mute-modal"}}));
SML.dm("JaGlTj3I-9",[],(async()=>{var e;!function(e){e[e.bold=1]="bold",e[e.italic=2]="italic",e[e.underline=4]="underline",e[e.strikethrough=8]="strikethrough",e[e.subscript=16]="subscript",e[e.superscript=32]="superscript",e[e.monospace=64]="monospace"}(e||(e={}));const r={LEFT:"L",RIGHT:"R",CENTER:"C"};return{A:"gif",B:"blockquote",C:"c/",E:"embed",get F(){return e},H:"hr",I:"img",L:"br",P:"par",R:"raw",S:"spoilertext",T:"table",U:"@",V:"video",a:"p/",b:"emoji",c:"code",d:"h",e:"li",f:"list",g:"u/",h:"r/",i:"link",j:"text",k:r,l:"L",m:"C",n:"R"}}));

SML.di("./DgW4ULLwQ1.js",import.meta.url,"DgW4ULLwQ1");SML.di("./Bypt3-pSP2.js",import.meta.url,"Bypt3-pSP2");SML.di("./CBbxnHsw2W.js",import.meta.url,"CBbxnHsw2W");SML.di("./Cl1pMDH2OX.js",import.meta.url,"Cl1pMDH2OX");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./CEs3hLX56z.js",import.meta.url,"CEs3hLX56z");SML.di("./B6Ai7g9fbR.js",import.meta.url,"B6Ai7g9fbR");SML.di("./pA9dwrnd0r.js",import.meta.url,"pA9dwrnd0r");SML.di("./BXUgRcxEAi.js",import.meta.url,"BXUgRcxEAi");SML.di("./w2XkRJ2mzc.js",import.meta.url,"w2XkRJ2mzc");SML.di("./h4Pa0OJr_5.js",import.meta.url,"h4Pa0OJr_5");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./DFh5Z0Dv0L.js",import.meta.url,"DFh5Z0Dv0L");
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B7VtDPc4tA.js",import.meta.url,"B7VtDPc4tA");
SML.dm("KHcvarc_gp",["Dw4vb8Yfbm","5r73EsgItq","B7VtDPc4tA"],(async(e,t,o)=>{var a;!function(e){e.Upvote="upvote",e.Downvote="downvote"}(a||(a={}));const r=(e,t)=>{if("post"===t){const t=e;return{ok:t.data?.updatePostVoteState?.ok,errors:t.data?.updatePostVoteState?.errors??t.errors,voteStateResult:t.data?.updatePostVoteState?.voteState}}const o=e;return{ok:o.data?.updateCommentVoteState?.ok,errors:o.data?.updateCommentVoteState?.errors,voteStateResult:o.data?.updateCommentVoteState?.voteState}},n=(t,o,a)=>"post"===o?{operation:e.O.UpdatePostVoteState,variables:{input:{postId:t,voteState:a}}}:{operation:e.O.UpdateCommentVoteState,variables:{input:{commentId:t,voteState:a}}};return {get V(){return a},a:({size:t})=>`flex mx-xs ${e.ap[t]}`,b:({size:o})=>({size:o===e.q.Small||o===e.q.ExtraSmall?t.I.Small:t.I.Medium}),c:({appearance:e,active:t})=>`group button flex justify-center aspect-square p-0 border-0 ${o.A[e]} ${!t&&"disabled:text-interactive-content-disabled"} ${t&&"secondary"===e?"":"button-plain"}  inline-flex items-center`,d:e=>{let t="bg-transparent text-global-white hover:text-global-white";switch(e){case a.Downvote:t+=" hover:bg-downvote-background-hover";break;case a.Upvote:t+=" hover:bg-upvote-background-hover"}return t},g:function(e,t){return!e&&t===a.Upvote||e===a.Downvote&&t===a.Downvote?1:!e&&t===a.Downvote||e===a.Upvote&&t===a.Upvote?-1:e===a.Downvote&&t===a.Upvote?2:e===a.Upvote&&t===a.Downvote?-2:0},o:async function(t,o,s){let i=e.b6.None;s&&(i=s===a.Upvote?e.b6.Up:e.b6.Down);const u=await e.Y(n(t,o,i)),{ok:l,errors:p,voteStateResult:v}=r(u,o);if(l){const t=v;if(t===e.b6.None)return;return t===e.b6.Up?a.Upvote:a.Downvote}if(p?.[0]){const e=p[0]?.message??"Something went wrong";throw new Error(e)}return s}};}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("KkXqW5RUm3",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,t)=>{const i=e=>e instanceof HTMLButtonElement||e instanceof HTMLAnchorElement||["button","link","menuitem","tab","checkbox","combobox","gridcell","application","treeitem"].includes(e?.getAttribute("role")??"");class n extends e.R{constructor(){super(...arguments),this._triggerElement=null,this.keydown=!1,this.dialogId="",this.noModal=!1,this.handleClick=()=>{this.keydown||this.sendActivatedEvent()},this.handleKeydown=e=>{"Enter"===e.key&&(this.keydown=!0)},this.handleKeyup=e=>{"Enter"===e.key&&!0===this.keydown&&(this.keydown=!1,this.sendActivatedEvent())},this.handleBlur=()=>{this.keydown=!1}}set triggerElement(t){const i=this._triggerElement?.getAttribute("aria-expanded")??!1,n=this._triggerElement,r=t;n&&(n?.removeAttribute("aria-haspopup"),n?.removeAttribute("aria-expanded"),n?.removeEventListener("click",this.handleClick),n?.removeEventListener("keydown",this.handleKeydown),n?.removeEventListener("keyup",this.handleKeyup),n?.addEventListener("blur",this.handleBlur)),r&&(this.action!==e.ij.Hide&&(r.setAttribute("aria-haspopup","dialog"),r.setAttribute("aria-expanded",`${i}`)),r.addEventListener("click",this.handleClick),r.addEventListener("keydown",this.handleKeydown),r.addEventListener("keyup",this.handleKeyup),r.addEventListener("blur",this.handleBlur),this._triggerElement=r)}get triggerElement(){return this._triggerElement}attributeChangedCallback(e,t,i){super.attributeChangedCallback(e,t,i),"action"===e&&(this.triggerElement=this._triggerElement)}addOpenAttributes(){this.triggerElement&&this.triggerElement.setAttribute("aria-expanded","true")}removeOpenAttributes(){this.triggerElement&&this.triggerElement.setAttribute("aria-expanded","false")}handleSlotChange(){this.triggerElement=((e,t=5)=>{let n=e??null,r=0;if(i(n))return n;for(;n&&r<t;){if(n=n?.assignedElements?n?.assignedElements()?.[0]??null:n?.children[0]??null,i(n))return n;r++}return null})(this.slottedElements?.[0]??null)}sendActivatedEvent(){if(this.triggerElement?.hasAttribute("disabled"))return;if(!this.dialogId)return void console.warn("No dialogId set on rpl-dialog-trigger, unable to trigger");const e={dialogId:this.dialogId,triggerElement:this,noModal:this.noModal,action:this.action};this.emitter.dispatch("trigger-clicked",{bubbles:!0,composed:!0,detail:e})}render(){return t.x`<slot @slotchange="${this.handleSlotChange}"></slot>`}}e._([e.n({type:String,reflect:!0,attribute:"dialog-id"})],n.prototype,"dialogId",void 0),e._([e.n({type:Boolean,reflect:!0,attribute:"no-modal"})],n.prototype,"noModal",void 0),e._([e.n({type:String,reflect:!0})],n.prototype,"action",void 0),e._([e.l()],n.prototype,"slottedElements",void 0);var r=t.a`:host{display:contents}`;let l=class extends n{};l.styles=r,l=e._([e.e("rpl-dialog-trigger")],l)}));
SML.di("./ZGR-_CKl0i.js",import.meta.url,"ZGR-_CKl0i");SML.di("./BlsZ37tN43.js",import.meta.url,"BlsZ37tN43");SML.di("./ChmOrWWjfU.js",import.meta.url,"ChmOrWWjfU");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BLrhRle6xP.js",import.meta.url,"BLrhRle6xP");SML.di("./BaxkLfaoug.js",import.meta.url,"BaxkLfaoug");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./ClaQym8zez.js",import.meta.url,"ClaQym8zez");
SML.dm("MBHVeWsxoa",["ZGR-_CKl0i","BlsZ37tN43","ChmOrWWjfU","Dw4vb8Yfbm","5r73EsgItq","BLrhRle6xP","BaxkLfaoug","Cv4mWnWE30","B-zFJtiar6","ClaQym8zez"],(async()=>{"enabled"!==window.CLIENT_EXPERIMENTS?.shreddit_system_theme&&SML.di("./DeqIcDJmKp.js",import.meta.url,"DeqIcDJmKp")}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("Py9rIF7r2a",["Dw4vb8Yfbm"],(async t=>{const{svg:e}=t.a(),a=t.m(e`<path d="M18.736 17.464l-3.483-3.483A7.961 7.961 0 0016.999 9 8 8 0 109 17a7.961 7.961 0 004.981-1.746l3.483 3.483a.9.9 0 101.272-1.273zM9 15.2A6.207 6.207 0 012.8 9c0-3.419 2.781-6.2 6.2-6.2s6.2 2.781 6.2 6.2-2.781 6.2-6.2 6.2z"></path>`,"0 0 20 20","search");return{R:class{constructor(){this.partial=null,this.loadAndReplaceContent=async({afterFailure:e,afterSuccess:a,wrapPartialElement:r=t=>t,src:n,target:i})=>{const s=document.createElement("faceplate-partial");s.setAttribute("loading",t.y.Programmatic),s.setAttribute("src",n),s.setAttribute("class","block min-h-screen xs:min-h-[20rem]");const c=document.createElement("shreddit-loading");s.appendChild(c);const l=this.partial??document.getElementById(i),o=`${l.getBoundingClientRect().height}px`;s.style.minHeight=o,l.insertAdjacentElement("beforebegin",r(s)),l.remove(),this.partial=s;try{const t=new Promise(((t,e)=>{const a=t=>{this.partial!==s&&(t.stopImmediatePropagation(),t.stopPropagation()),e()};s.addEventListener("faceplate-error",a,{once:!0}),s.addEventListener("faceplate-alert",a,{once:!0})}));await Promise.race([t,s.load()]),this.partial=null,a?.()}catch{if(this.partial!==s)return;e?.()}}}},s:a}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("Q1IJQIXJf2",["Dw4vb8Yfbm","xrDbp1ee_h","5r73EsgItq"],(async(e,t,s)=>{class n{constructor(e,t){this.hasPageUnloaded=!1,this.handleIntersectionObserverEnter=()=>{this.isPostInViewport||(this.isPostInViewport=!0,this.becameVisibleOnScreenTimestamp=Date.now())},this.handleIntersectionObserverLeave=()=>{const e=this.isPostInViewport;this.isPostInViewport=!1,e&&this.handleConsume()},this.handleDocumentVisibilityChange=e=>{this.isPostInViewport&&(e?(this.hasPageUnloaded=!1,this.becameVisibleOnScreenTimestamp=Date.now()):e||this.hasPageUnloaded||this.handleConsume())},this.onBeforeUnloadCallback=()=>{this.hasPageUnloaded=!0,this.isPostInViewport&&this.handleConsume()},this.elementToTrack=e,this.SAN=t}handleConsume(){this.becameVisibleOnScreenTimestamp&&Date.now()-this.becameVisibleOnScreenTimestamp>t.b&&e.i(this.elementToTrack,this.SAN)}}class o{constructor(e){this.host=e,this.postConsumeTrackingController=new n(e,{source:"post",action:"consume",noun:"post"}),this.host.addController(this)}hostConnected(){new e.ay(this.host,this.host,{rootMargin:"0px"}),this.host.addEventListener("faceplate-enter",this.postConsumeTrackingController.handleIntersectionObserverEnter),this.host.addEventListener("faceplate-leave",this.postConsumeTrackingController.handleIntersectionObserverLeave),e.aE.subscribe(this.postConsumeTrackingController.onBeforeUnloadCallback,{shouldBeCalledFirst:!0}),e.aF(this.postConsumeTrackingController.handleDocumentVisibilityChange,{immediate:!0})}hostDisconnected(){this.host.removeEventListener("faceplate-enter",this.postConsumeTrackingController.handleIntersectionObserverEnter),this.host.removeEventListener("faceplate-leave",this.postConsumeTrackingController.handleIntersectionObserverLeave),e.aE.unsubscribe(this.postConsumeTrackingController.onBeforeUnloadCallback),e.aG(this.postConsumeTrackingController.handleDocumentVisibilityChange)}}let i=class extends s.s{connectedCallback(){super.connectedCallback(),this.postConsumeTrackingController=new o(this)}disconnectedCallback(){super.disconnectedCallback(),this.postConsumeTrackingController&&e.B(this,this.postConsumeTrackingController)}render(){return s.x`<slot></slot>`}};return i=e._([e.e("post-consume-tracker")],i),{C:n}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./D_6DXw1u0k.js",import.meta.url,"D_6DXw1u0k");SML.di("./BWv2j8jrjX.js",import.meta.url,"BWv2j8jrjX");
SML.dm("QiHZigpyJA",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6","D_6DXw1u0k","BWv2j8jrjX"],(async(t,e,a,l)=>{let s=class extends e.s{constructor(){super(...arguments),this.isLoading=!0,this.isSubmittable=!1,this.postId="",this._windowEvents=new t.E(this,(()=>window)),this.handleOpenModalEvent=this._windowEvents.define(l.O,(async t=>{this.isSubmittable=!1,this.isLoading=!0,this.showModal(),await this.activateFormContentFeature(t.detail.postId),this.postId=t.detail.postId,this.isLoading=!1}))}get oldPostLevel(){return this.querySelector('[name="old-post-level"]')?.value}get oldIsFilterEnabled(){return"true"===this.querySelector('[name="old-is-filter-enabled"]')?.value}activateFormContentFeature(e){return t.r({name:t.hA,routeParams:{postId:e},renderMode:t.P.Contents})}showModal(){this.modal?.showModal()}closeModal(){this.modal?.close()}buildAlert(e){const l=e?t.a5.success:t.a5.error;return this.dispatchEvent(t.c("faceplate-alert",{level:l,message:a.bR(e)}))}async onSave(){const t=this.querySelector('[name="post-level"][checked]'),e=this.querySelector('[name="is-filter-enabled"]');t?.value&&e?(this.submitRequest(t.value,null!=e.value),this.emitV2Event(t.value,null!=e.value)):(this.buildAlert(!1),this.isSubmittable=!0)}async submitRequest(t,e){try{this.isSubmittable=!1;const a=await this.invokeGQL(t,e);this.inspectResp(a)}catch(t){this.buildAlert(!1),this.isSubmittable=!0}}invokeGQL(e,a){return t.Y({operation:t.O.UpdatePostLevelCrowdControlSettings,variables:{id:this.postId,level:e,filterIsEnabled:a,shouldIncludeUpdatePostCrowdControlFilter:a!==this.oldIsFilterEnabled,shouldIncludeUpdatePostCrowdControlLevel:e!==this.oldPostLevel}})}inspectResp(t){let e=!1;"updatePostCrowdControlFilter"in t.data&&"updatePostCrowdControlLevel"in t.data?t.data.updatePostCrowdControlFilter?.ok&&t.data.updatePostCrowdControlLevel?.ok&&(e=!0):"updatePostCrowdControlFilter"in t.data?t.data.updatePostCrowdControlFilter?.ok&&(e=!0):"updatePostCrowdControlLevel"in t.data&&t.data.updatePostCrowdControlLevel?.ok&&(e=!0),e?(this.buildAlert(!0),this.closeModal()):(this.buildAlert(!1),this.isSubmittable=!0)}isContentLoading(){return this.isLoading}emitV2Event(t,e){const a=this.querySelector('[name="subreddit-id"]'),l=this.querySelector('[name="subreddit-name"]'),s={id:a?.value||"",name:l?.value||""},o=this.querySelector('[name="author-id"]'),i={id:this.postId,author:{id:o?.value||""}};this.buildAndTrack("crowd_control_individual_post",i,s,{value:t,old_value:`${this.oldPostLevel}`}),this.buildAndTrack("crowd_control_individual_post_filter",i,s,{value:`${e}`,old_value:`${this.oldIsFilterEnabled}`})}buildAndTrack(e,a,l,s){const o={post:a,subreddit:l,setting:s},i=t.b({source:"post_mod_action_menu",action:"save",noun:e},o);t.i(this,i)}handleInput(){this.isSubmittable=!0}render(){return e.x` <faceplate-modal inFocusTrap class="max-w-md w-full"> <div slot="title"> ${"Adjust post crowd control"} </div> <div slot="closeButton"> ${t.o({appearance:"secondary",leadingIcon:t.al({size:e.I.Small}),size:t.q.Small,attributes:{type:"button",onclick:this.closeModal}})} </div> ${this.isLoading?e.x`<div class="w-full"> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-2/3 h-lg"></faceplate-shimmer> </div>`:e.x`<slot @input="${this.handleInput}"></slot>`} <div slot="primaryButton"> ${t.o({children:"Save",appearance:"primary",attributes:{type:"submit",onclick:this.onSave,disabled:!this.isSubmittable}})} </div> <div slot="secondaryButton"> ${t.o({children:"Cancel",appearance:"plain",attributes:{type:"button",onclick:this.closeModal}})} </div> </faceplate-modal> `;}};s.styles=[t.t],t._([t.h()],s.prototype,"isLoading",void 0),t._([t.h()],s.prototype,"isSubmittable",void 0),t._([t.h()],s.prototype,"postId",void 0),t._([t.a2("faceplate-modal")],s.prototype,"modal",void 0),s=t._([t.e("post-level-crowd-control-modal")],s)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("RXNEUFNiHt",["Dw4vb8Yfbm","B-zFJtiar6","5r73EsgItq"],(async(e,t)=>{class i extends HTMLElement{constructor(){super(),this.childAnchor=null,this.chatUrl=null,this.mobilePermalink=null,this.handleAnchorClick=async e=>{if(!this.chatUrl)return;if(e.preventDefault(),this.mobilePermalink){const e=new URL(this.mobilePermalink,window.location.href).searchParams.get("r"),i=document.querySelector(`faceplate-modal[name="${t.cR}"]`),r=i?.querySelector("a.app-link");if(r?.href){const t=new URL(r.href);e&&t.searchParams.set("r",e),t.searchParams.set("$android_deeplink_path",`reddit${this.mobilePermalink}`),t.searchParams.set("$deeplink_path",this.mobilePermalink),t.searchParams.set("$og_redirect",`${CLIENT_CONFIG.ORIGIN}${this.mobilePermalink}`),t.searchParams.set("base_url",this.mobilePermalink),r.setAttribute("href",t.toString())}return void this.dispatchEvent(new CustomEvent(t.cR,{bubbles:!0}))}let i=document.querySelector("reddit-chat-host");i||(await this.activateFeature(),i=document.querySelector("reddit-chat-host")),i.openChatUrl(this.chatUrl)}}async activateFeature(){try{await e.r({name:e.aB})}catch(t){if(!t.message?.endsWith(`${e.aB} not found`))throw t}}connectedCallback(){const e=this.querySelector(":scope > a, :scope > li > a"),i=e?.href;this.mobilePermalink=this.getAttribute("permalink");((e,i=!1)=>!!e&&(e.startsWith(t.aG)||e.startsWith(t.cQ)||i&&e.startsWith("/c/")))(i||this.mobilePermalink||void 0,!!this.mobilePermalink)&&(this.childAnchor=e,!i&&this.mobilePermalink?this.chatUrl=this.mobilePermalink:i&&i.startsWith(t.aG)?this.chatUrl="/"+i.replace(t.aG,""):i&&(this.chatUrl="/"+i.replace(t.cQ,"")),this.childAnchor?.addEventListener("click",this.handleAnchorClick))}disconnectedCallback(){this.childAnchor?.removeEventListener("click",this.handleAnchorClick)}}return customElements.define("reddit-chat-anchor",i),{a:e=>`${t.aG}room/${e}`,g:(e,i)=>`${t.aG}room/${e}/event/${i}`}}));
SML.di("./C0cxgUZlQL.js",import.meta.url,"C0cxgUZlQL");SML.di("./Bypt3-pSP2.js",import.meta.url,"Bypt3-pSP2");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");SML.di("./BWv2j8jrjX.js",import.meta.url,"BWv2j8jrjX");SML.di("./ClaQym8zez.js",import.meta.url,"ClaQym8zez");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./znAVeSwIf_.js",import.meta.url,"znAVeSwIf_");SML.di("./B5zjeOvyDF.js",import.meta.url,"B5zjeOvyDF");SML.di("./B0eUmh4x0D.js",import.meta.url,"B0eUmh4x0D");SML.di("./RXNEUFNiHt.js",import.meta.url,"RXNEUFNiHt");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./DMVINMWPkT.js",import.meta.url,"DMVINMWPkT");SML.di("./BOFc1KQJc-.js",import.meta.url,"BOFc1KQJc-");SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");SML.di("./Z0tk4vmzIQ.js",import.meta.url,"Z0tk4vmzIQ");SML.di("./C5bRok1J9n.js",import.meta.url,"C5bRok1J9n");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./B7VtDPc4tA.js",import.meta.url,"B7VtDPc4tA");SML.di("./CG8L8PJoXS.js",import.meta.url,"CG8L8PJoXS");SML.di("./DNuG1KLpV-.js",import.meta.url,"DNuG1KLpV-");SML.di("./O6qhDxcY8s.js",import.meta.url,"O6qhDxcY8s");SML.di("./Czk9z15SR1.js",import.meta.url,"Czk9z15SR1");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./Diz2FhHj1m.js",import.meta.url,"Diz2FhHj1m");SML.di("./CjgEd4y4FT.js",import.meta.url,"CjgEd4y4FT");SML.di("./CuOyDBsRWL.js",import.meta.url,"CuOyDBsRWL");SML.di("./iewwAXEto0.js",import.meta.url,"iewwAXEto0");SML.di("./BM4eKBOTt3.js",import.meta.url,"BM4eKBOTt3");SML.di("./DbZs5o3urT.js",import.meta.url,"DbZs5o3urT");SML.di("./C6UOB_RPC4.js",import.meta.url,"C6UOB_RPC4");SML.di("./C_bmnG8wYl.js",import.meta.url,"C_bmnG8wYl");SML.di("./Cisrc9cRpB.js",import.meta.url,"Cisrc9cRpB");SML.di("./B5l4afN3bV.js",import.meta.url,"B5l4afN3bV");SML.di("./ankOzFFj6Q.js",import.meta.url,"ankOzFFj6Q");SML.di("./i5-QpR8HYV.js",import.meta.url,"i5-QpR8HYV");SML.di("./D_6DXw1u0k.js",import.meta.url,"D_6DXw1u0k");SML.di("./BveDHcKZX5.js",import.meta.url,"BveDHcKZX5");SML.di("./Bb6e8s2O1k.js",import.meta.url,"Bb6e8s2O1k");SML.di("./CpZ44pmnxI.js",import.meta.url,"CpZ44pmnxI");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./CJnU84A1cL.js",import.meta.url,"CJnU84A1cL");SML.di("./CqGTWb5M_i.js",import.meta.url,"CqGTWb5M_i");SML.di("./CU8weQ2dDy.js",import.meta.url,"CU8weQ2dDy");SML.di("./YFXcK0ZyJl.js",import.meta.url,"YFXcK0ZyJl");SML.di("./BRjrtOukap.js",import.meta.url,"BRjrtOukap");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");SML.di("./BuM34fxA_u.js",import.meta.url,"BuM34fxA_u");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");SML.di("./CQMf561ZyA.js",import.meta.url,"CQMf561ZyA");SML.di("./BwcUp7XlaC.js",import.meta.url,"BwcUp7XlaC");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./DnNITwgp90.js",import.meta.url,"DnNITwgp90");SML.di("./DIrjWut_vd.js",import.meta.url,"DIrjWut_vd");SML.di("./D1DY-avSiT.js",import.meta.url,"D1DY-avSiT");SML.di("./BSYfFtBeKH.js",import.meta.url,"BSYfFtBeKH");SML.di("./Cn5JTNK6V3.js",import.meta.url,"Cn5JTNK6V3");SML.di("./wBWjBlz6KG.js",import.meta.url,"wBWjBlz6KG");SML.di("./kS-PCwPq_X.js",import.meta.url,"kS-PCwPq_X");SML.di("./CBbxnHsw2W.js",import.meta.url,"CBbxnHsw2W");SML.di("./B0p6XlbwHt.js",import.meta.url,"B0p6XlbwHt");SML.di("./CM4Yt4lwBK.js",import.meta.url,"CM4Yt4lwBK");SML.di("./CQrDBXK-hm.js",import.meta.url,"CQrDBXK-hm");SML.di("./CvmCFjWH38.js",import.meta.url,"CvmCFjWH38");SML.di("./DM1QcTS4ln.js",import.meta.url,"DM1QcTS4ln");SML.di("./Chd9fEZKZ6.js",import.meta.url,"Chd9fEZKZ6");SML.di("./DmecpYOCDL.js",import.meta.url,"DmecpYOCDL");SML.di("./Bk8sRXhdir.js",import.meta.url,"Bk8sRXhdir");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");SML.di("./q156d3D57c.js",import.meta.url,"q156d3D57c");SML.di("./D-MP0EoIqA.js",import.meta.url,"D-MP0EoIqA");SML.di("./Cy2cpc6ZDy.js",import.meta.url,"Cy2cpc6ZDy");SML.di("./CzwD205thW.js",import.meta.url,"CzwD205thW");SML.di("./D-ibjVaztZ.js",import.meta.url,"D-ibjVaztZ");SML.di("./Dm3xIDznQh.js",import.meta.url,"Dm3xIDznQh");SML.di("./5KlNO8qI18.js",import.meta.url,"5KlNO8qI18");SML.di("./Hw1PFKH8z9.js",import.meta.url,"Hw1PFKH8z9");SML.di("./Dc4r6aHTbv.js",import.meta.url,"Dc4r6aHTbv");SML.di("./DVCQM8tfVd.js",import.meta.url,"DVCQM8tfVd");SML.di("./E3QE3c4_Ye.js",import.meta.url,"E3QE3c4_Ye");SML.di("./C17omQ_RhR.js",import.meta.url,"C17omQ_RhR");SML.di("./DasPtA-dN5.js",import.meta.url,"DasPtA-dN5");SML.di("./Dh8G_lEIvS.js",import.meta.url,"Dh8G_lEIvS");
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("Wt225_9ix9",["Dw4vb8Yfbm","B-zFJtiar6"],(async(c,t)=>{const{svg:n}=c.a();function u(c,n){const u=t.u(c);return u?u.slice(0,n):[]}return{a:(c,n,a)=>{const e=u(n,a),r=new Map,i=[c,...e];for(;i.length&&r.size<a;){const c=i.shift();r.has(c.uuid)||r.set(c.uuid,c)}const o=Array.from(r.values());o.length===e.length&&o.every(((c,t)=>c.uuid===e[t].uuid))||t.r(n,o)},c:c.m(n`<path d="M11.977 13.79h-1.955l4.549-10.715a.81.81 0 00-.381-1.032C12.447 1.12 10.37.747 8.179 1.18c-3.612.716-6.471 3.68-7.059 7.316a9.01 9.01 0 0010.409 10.377c3.735-.616 6.741-3.635 7.347-7.371.453-2.8-.388-5.405-2.017-7.322a.505.505 0 00-.853.119l-4.029 9.49zM9.98 8.118a1.752 1.752 0 00-1.148.167 1.664 1.664 0 00-.651.596 1.703 1.703 0 00-.258.948v3.96H5.998V6.322h1.876v1.074h.035c.251-.344.567-.628.948-.851a2.55 2.55 0 011.311-.335c.172 0 .335.014.488.042.153.028.267.058.342.09l-.774 1.849a.766.766 0 00-.244-.073z"></path>`,"0 0 20 20","community-fill"),g:u,r:()=>c.b({source:"community_nav",action:"click",noun:"community_recent"})}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./KHcvarc_gp.js",import.meta.url,"KHcvarc_gp");SML.di("./B7VtDPc4tA.js",import.meta.url,"B7VtDPc4tA");SML.di("./CUIVPWsUpf.js",import.meta.url,"CUIVPWsUpf");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./DgW4ULLwQ1.js",import.meta.url,"DgW4ULLwQ1");SML.di("./CzmIuH4u_q.js",import.meta.url,"CzmIuH4u_q");SML.di("./D14t1nj-sI.js",import.meta.url,"D14t1nj-sI");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./CG8L8PJoXS.js",import.meta.url,"CG8L8PJoXS");SML.di("./DQQjPN-OEj.js",import.meta.url,"DQQjPN-OEj");SML.di("./Bv2UEnJP_M.js",import.meta.url,"Bv2UEnJP_M");
SML.dm("YAFaZPh0hw",["Dw4vb8Yfbm","KHcvarc_gp","B7VtDPc4tA","CUIVPWsUpf","5r73EsgItq","CzmIuH4u_q","D14t1nj-sI","B-zFJtiar6","CG8L8PJoXS","DQQjPN-OEj","Bv2UEnJP_M","DgW4ULLwQ1"],(async(t,e,n,o,a,r,i,s,c,u,l)=>{const d=(t,e)=>"secondary"===e?{upvote:"bg-action-upvote text-global-white border-action-upvote ",downvote:"bg-action-downvote text-global-white border-action-downvote "}[t]:"",h={secondary:"bg-interactive-background-disabled text-[color:var(--color-button-secondary-text-disabled)] border-transparent",plain:"bg-[color:var(--color-button-plain-background-disabled)] text-[color:var(--color-button-plain-text-disabled)] border-transparent",bordered:"","plain-weak":"text-interactive-content-disabled"},p=({voteType:t,appearance:e})=>null==t?h[e]:"opacity-40 text-global-white",{svg:m}=t.a(),v=t.m(m`<path d="M10 1a3.966 3.966 0 013.96 3.962V9.02h3.202c.706 0 1.335.42 1.605 1.073.27.652.122 1.396-.377 1.895l-7.754 7.759a.925.925 0 01-1.272 0l-7.754-7.76a1.734 1.734 0 01-.376-1.894c.27-.652.9-1.073 1.605-1.073h3.202V4.962A3.965 3.965 0 0110 1z"></path>`,"0 0 20 20","downvote-fill"),{svg:g}=t.a(),b=t.m(g`<path d="M10 1a3.966 3.966 0 013.96 3.962V9.02h3.202c.706 0 1.335.42 1.605 1.073.27.652.122 1.396-.377 1.895l-7.754 7.759a.925.925 0 01-1.272 0l-7.754-7.76a1.734 1.734 0 01-.376-1.894c.27-.652.9-1.073 1.605-1.073h3.202V4.962A3.965 3.965 0 0110 1zm7.01 9.82h-4.85V5.09c0-1.13-.81-2.163-1.934-2.278a2.163 2.163 0 00-2.386 2.15v5.859H2.989l7.01 7.016 7.012-7.016z"></path>`,"0 0 20 20","downvote");var $;!function(t){t.Upvote="upvote",t.Downvote="downvote"}($||($={}));const T=t=>`group button flex justify-center p-0 border-0 ${n.A[t]} inline-flex items-center`,I=({size:e})=>({attributes:{classname:"rpl-vote-button-icon"},size:e===t.q.Small||e===t.q.ExtraSmall?a.I.Small:a.I.Medium}),N=({size:e})=>`flex mx-xs ${t.ap[e]}`,{svg:w}=t.a(),f=t.m(w`<path d="M10 19a3.966 3.966 0 01-3.96-3.962V10.98H2.838a1.731 1.731 0 01-1.605-1.073 1.734 1.734 0 01.377-1.895L9.364.254a.925.925 0 011.272 0l7.754 7.759c.498.499.646 1.242.376 1.894-.27.652-.9 1.073-1.605 1.073h-3.202v4.058A3.965 3.965 0 019.999 19H10z"></path>`,"0 0 20 20","upvote-fill");function E(t,e){return t.tags?.includes(e)}l.A.Limited,l.A.Community,l.A.Free;let D=class extends a.s{constructor(){super(...arguments),this.size=t.q.Medium,this.disabled=!1,this.count=0,this.hasEnteredViewport=!1,this.awardController=new i.A(this,{getThingId:()=>this.thingId,onAward:t=>{this.count++,this.isAwardedByUser=!0,t&&(this.awardId=t.id,this.iconUrl=t.staticIcon.url,this.hasIconicAward||(this.hasIconicAward=function(t){return E(t,l.A.Iconic)}(t)),this.hasBrandedAward||(this.hasBrandedAward=function(t){return E(t,l.A.Branded)}(t)))}}),this.handleEnterViewport=()=>{this.hasEnteredViewport=!0,this.observerController&&(this.observerController=t.B(this,this.observerController))},this.handleClick=()=>{const e=u.a.setCorrelationId(),n=u.a.setPostType(this.postType);t.i(this,c.e({awardId:this.awardId,thingId:this.thingId,subredditId:this.subredditId,postId:this.postId,topAwardIconUrl:this.iconUrl,animatedAwardIconUrls:this.iconUrls,correlationId:e,position:this.feedIndex,postType:n,postScore:this.postScore,score:this.score,numberComments:this.commentCount})),this.awardController.activateDialog()}}connectedCallback(){super.connectedCallback(),this.observerController=t.dW(this,this,this.handleEnterViewport,{rootMargin:"0px"})}disconnectedCallback(){super.disconnectedCallback(),this.observerController&&(this.observerController=t.B(this,this.observerController))}renderGlow(){return a.x`<span class="glow" style="${t.ad(this.isAwardedByUser?"--fade-out: none":void 0)}"> ${Array.from({length:8}).map(((e,n)=>a.x`<span class="sunbeam" style="${t.a6({"--n":n})}"></span>`))} </span>`}renderStream(){if(s.N())return a.A;const{iconUrls:e}=this;if(!e)return a.A;const n=[1,-1,0,-1],o=Number(e[0]===this.iconUrl);return a.x`<span class="stream"> ${Array.from({length:16}).map(((r,i)=>a.x`<img style="${t.a6({"--n":i,"--offset":n[i%n.length]})}" src="${e[(i+o)%e.length]}" width="16" height="16" alt="">`))} </span>`}render(){if(!this.thingId)return a.A;const e=n.I[this.size],o=(this.hasIconicAward||this.hasBrandedAward)&&!this.noGoldenBorder;return n.c({appearance:this.appearance,attributes:{type:"button",className:s.j("overflow-visible",o&&"border-sm border-global-gold",this.buttonClass),disabled:this.disabled,onclick:this.handleClick,"aria-label":0===this.count?"Give award":t.cB({one:`Give award, ${this.count} award given`,other:`Give award, ${this.count} awards given`,count:this.count})},size:this.size,leadingIcon:this.iconUrl?a.x`<span class="${s.j("flex relative",this.disabled&&"opacity-25")}" aria-hidden="true"> ${this.hasEnteredViewport?this.renderGlow():a.A} ${this.hasEnteredViewport?this.renderStream():a.A} <img src="${this.iconUrl}" alt="" class="relative" width="${a.i[e]}" height="${a.i[e]}"> </span>`:r.a({attributes:{"aria-hidden":"true"},size:e}),children:this.count?a.x`<faceplate-number number="${this.count}" pretty aria-hidden="true"></faceplate-number>`:this.withInitialStateText?a.x`<span aria-hidden="true">${"Award"}</span>`:void 0});}};return D.styles=[t.t,t.a0("@keyframes fade-in {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n@keyframes rotate-clockwise {\n  0% {\n    transform: rotate(45deg);\n  }\n  100% {\n    transform: rotate(135deg);\n  }\n}\n@keyframes sunbeam-even {\n  0% {\n    transform: scaleX(1) scaleY(1);\n  }\n  50% {\n    transform: scaleX(1.2) scaleY(1.3);\n  }\n  100% {\n    transform: scaleX(1) scaleY(1);\n  }\n}\n@keyframes sunbeam-odd {\n  0% {\n    transform: scaleX(1.2) scaleY(1.3);\n  }\n  50% {\n    transform: scaleX(1) scaleY(1);\n  }\n  100% {\n    transform: scaleX(1.2) scaleY(1.3);\n  }\n}\n.glow {\n  display: block;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  width: 0;\n  height: 0;\n  perspective: 5em;\n  animation: 3s ease-out 1.5s both rotate-clockwise, 0.5s ease-in 1.5s backwards fade-in, var(--fade-out, 0.5s ease-out 5s reverse forwards fade-in);\n}\n.glow::before {\n  content: '';\n  display: block;\n  position: absolute;\n  left: -1em;\n  top: -1em;\n  background: radial-gradient(rgba(245, 214, 87, 0.9), rgba(245, 214, 87, 0) 50%);\n  width: 2em;\n  height: 2em;\n}\n.glow > .sunbeam {\n  display: block;\n  transform: rotate(calc(var(--n) * 45deg)) rotateX(-45deg);\n}\n.glow > .sunbeam::before {\n  content: '';\n  display: block;\n  background: no-repeat linear-gradient(rgba(245, 214, 87, 0.9), rgba(245, 214, 87, 0));\n  height: 1em;\n  width: 0.3em;\n  position: absolute;\n  transform: rotate(180deg) translateX(50%);\n  transform-origin: 50% 0px;\n  animation: 1.5s linear 1.5s 2 both sunbeam-even;\n  animation-composition: add;\n}\n.glow > .sunbeam:nth-child(odd)::before {\n  animation-name: sunbeam-odd;\n}\n"),t.a0("@keyframes stream {\n  0% {\n    transform: scale(0);\n  }\n  20% {\n    transform: scale(1);\n    opacity: 1;\n  }\n  100% {\n    offset-distance: 100%;\n    opacity: 0;\n  }\n}\n.stream {\n  pointer-events: none;\n  position: absolute;\n  bottom: calc(100px + 50%);\n  left: 50%;\n}\n.stream > img {\n  animation: 2s ease-in both stream;\n  animation-delay: calc(var(--n) * 0.2s);\n  offset-path: path('M2.5,100 q-5,-10,0,-20 t 0-20 0-20 0-20 0-20');\n  offset-rotate: 0deg;\n  position: absolute;\n  translate: calc(var(--offset) * 8px);\n}\n")],t._([t.n({type:String})],D.prototype,"appearance",void 0),t._([t.n({type:String})],D.prototype,"size",void 0),t._([t.n({type:String,attribute:"button-class"})],D.prototype,"buttonClass",void 0),t._([t.n({type:Boolean,reflect:!0})],D.prototype,"disabled",void 0),t._([t.n({type:Boolean,attribute:"no-golden-border"})],D.prototype,"noGoldenBorder",void 0),t._([t.n({type:Boolean,attribute:"with-initial-state-text"})],D.prototype,"withInitialStateText",void 0),t._([t.n({type:Boolean,attribute:"is-logged-in"})],D.prototype,"isLoggedIn",void 0),t._([t.n({type:Boolean,reflect:!0,attribute:"is-awarded-by-user"})],D.prototype,"isAwardedByUser",void 0),t._([t.n({type:String,attribute:"thing-id"})],D.prototype,"thingId",void 0),t._([t.n({type:Number,attribute:"feed-index"})],D.prototype,"feedIndex",void 0),t._([t.n({type:String,attribute:"subreddit-id"})],D.prototype,"subredditId",void 0),t._([t.n({type:String,attribute:"post-id"})],D.prototype,"postId",void 0),t._([t.n({type:String,attribute:"post-type"})],D.prototype,"postType",void 0),t._([t.n({type:Number,attribute:"post-score"})],D.prototype,"postScore",void 0),t._([t.n({type:Number})],D.prototype,"score",void 0),t._([t.n({type:Number,attribute:"comment-count"})],D.prototype,"commentCount",void 0),t._([t.n({type:Number,reflect:!0})],D.prototype,"count",void 0),t._([t.n({type:String,reflect:!0,attribute:"award-id"})],D.prototype,"awardId",void 0),t._([t.n({type:String,reflect:!0,attribute:"icon-url"})],D.prototype,"iconUrl",void 0),t._([t.n({type:Array,attribute:"icon-urls"})],D.prototype,"iconUrls",void 0),t._([t.n({type:Boolean,reflect:!0,attribute:"has-iconic-award"})],D.prototype,"hasIconicAward",void 0),t._([t.n({type:Boolean,reflect:!0,attribute:"has-branded-award"})],D.prototype,"hasBrandedAward",void 0),t._([t.h()],D.prototype,"hasEnteredViewport",void 0),D=t._([t.e("award-button")],D),{a:({attributes:e,voteType:o,upvoteButton:a,downvoteButton:r,size:i=t.q.Medium,appearance:s="plain"})=>{const{html:c,createElement:u}=t.a(),l=c`${a} ${(()=>{if("plain"===s)return"";const e=i===t.q.Small?"h-md":"h-[20px]";return c`<span class="rpl-vote-button-group-divider rounded-1 ms-[-2px] translate-x-px w-px ${e}"></span>`})()} ${r}`;return u("span",{...e,className:`\n      rpl-vote-button-group p-0 button-shell overflow-hidden font-semibold flex items-center cursor-auto\n      ${e?.className||""} \n      ${o??""}\n      ${n.g({size:i,appearance:s})}`,rpl:!0},l)},b:e=>{const{html:a,createElement:r}=t.a(),{appearance:i="plain",attributes:s,initialStateText:c,onClick:u,screenReaderContent:l,size:d=t.q.Medium,voteCount:h,voteType:p}=e,m=d===t.q.Small,v=p===$.Upvote,g=s?.href;return r(null!=g?"a":"button",{rpl:!0,upvote:!0,onclick:u,...s,className:`\n        ${s?.className||""}\n        rounded-none\n        ${m?"rounded-r-[8px]":"rounded-r-[12px]"}\n        ${T(i)}\n      `,style:`height: ${n.B[d]};`,"aria-pressed":v},a` <span class="${m?"ms-sm":"ms-md"} mr-[6px] ${N({size:d})}"> ${(v?f:o.u)(I({size:d}))} </span> ${l&&a`<faceplate-screen-reader-content> ${l||"Upvote"} </faceplate-screen-reader-content>`} ${null==h?c?a`<span class="rpl-vote-button-group-label ${"plain"===i?"pe-[3px]":"pe-[10px]"}">${c}</span>`:"":a`<span class="rpl-vote-button-group-label ${"plain"===i?"pe-[3px]":"pe-[10px]"}"> <faceplate-number number="${h}" pretty></faceplate-number> </span>`} `);},c:e=>{const{html:o,createElement:a}=t.a(),{appearance:r="plain",attributes:i,size:s=t.q.Medium,screenReaderContent:c,voteType:u,onClick:l}=e,d=s===t.q.Small,h=u===$.Downvote,p=i?.href;return a(null!=p?"a":"button",{rpl:!0,downvote:!0,...i,onclick:l,className:`\n        ${i?.className||""}\n        rounded-none\n        ${d?"rounded-l-[8px]":"rounded-l-[12px]"}\n        ${T(r)}\n      `,style:`height: ${n.B[s]};`,"aria-pressed":h},o`<span class="${d?"me-sm":"me-md"} ${"plain"===r?"ms-[3px]":"ms-xs"} ${N({size:s})}"> ${(h?v:b)(I({size:s}))} </span> ${c&&o`<faceplate-screen-reader-content> ${c||"Downvote"} </faceplate-screen-reader-content>`}`);},d:({attributes:o,size:a=t.q.Medium,appearance:r="plain",screenReaderContent:i,voteType:s,onClick:c})=>{const{html:u,createElement:l}=t.a(),d=null!=s,h=s===e.V.Downvote,p=e.c({appearance:r,active:d});return l("button",{rpl:!0,downvote:!0,...o,onclick:c,className:`${o?.className||""} ${p} ${{plain:h?"text-action-downvote":"hover:text-action-downvote focus-visible:text-action-downvote",secondary:d?e.d(s):"hover:text-action-downvote focus-visible:text-action-downvote",bordered:h?"text-action-downvote":"hover:text-action-downvote focus-visible:text-action-downvote","plain-weak":h?"text-action-downvote":"hover:text-action-downvote focus-visible:text-action-downvote"}[r]}`,style:`height: ${n.B[a]};`,"aria-pressed":h},u`<span class="${e.a({size:a})}"> ${(h?v:b)(e.b({size:a}))} </span> ${i&&u`<faceplate-screen-reader-content> ${i||"Downvote"} </faceplate-screen-reader-content>`}`);},e:b,u:({attributes:a,size:r=t.q.Medium,appearance:i="plain",screenReaderContent:s,voteType:c,onClick:u})=>{const{html:l,createElement:d}=t.a(),h=null!=c,p=c===e.V.Upvote,m=e.c({appearance:i,active:h});return d("button",{rpl:!0,upvote:!0,onclick:u,...a,className:`${a?.className||""} ${m} ${{plain:p?"text-action-upvote":"hover:text-action-upvote focus-visible:text-action-upvote",secondary:h?e.d(c):"hover:text-action-upvote focus-visible:text-action-upvote",bordered:p?"text-action-upvote":"hover:text-action-upvote focus-visible:text-action-upvote","plain-weak":p?"text-action-upvote":"hover:text-action-upvote focus-visible:text-action-upvote"}[i]}`,style:`height: ${n.B[r]};`,"aria-pressed":p},l`<span class="${e.a({size:r})}"> ${(p?f:o.u)(e.b({size:r}))} </span> ${s&&l`<faceplate-screen-reader-content> ${s||"Upvote"} </faceplate-screen-reader-content>`}`);},v:({attributes:e,voteCount:o,voteType:a,upvoteButton:r,downvoteButton:i,size:s=t.q.Medium,appearance:c="plain",initialStateText:u})=>{const{html:l,createElement:h}=t.a(),m=l`${r} ${null==o?u:l`<span> <faceplate-number number="${o}" pretty></faceplate-number> </span>`} ${i}`;return h("span",{...e,className:`${e?.className||""} ${a?d(a,c):""}\n      p-0 ${n.g({size:s,appearance:c,selected:!0})} button-shell overflow-visible font-semibold flex items-center cursor-auto ${e?.disabled?p({voteType:a,appearance:c}):""}`,rpl:!0},m)}};}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("YFXcK0ZyJl",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,t)=>{var i=t.a`${e.a7}a,button{background:0 0;border-radius:inherit;color:inherit;border:none;padding:0;margin:inherit;font:inherit;cursor:pointer;outline:inherit;display:inherit;width:inherit;height:inherit;text-decoration:none}a:focus-visible,button:focus-visible{outline:2px solid var(--color-global-focus)}`;class n extends e.R{constructor(){super(...arguments),this.disabled=!1,this.selected=!1}renderLeadingContent(){return t.x`<slot name="leading"></slot> `}renderTrailingContent(){return t.x`<slot name="trailing"></slot> `}handleDisabledLinkClick(e){this.disabled&&(e.preventDefault(),e.stopPropagation())}render(){const e=t.x`${this.renderLeadingContent()} <slot></slot> ${this.renderTrailingContent()}`;return this.href?t.x`<a href="${this.href}" aria-disabled="${this.disabled?"true":"false"}" aria-pressed="${this.selected}" @click="${this.handleDisabledLinkClick}">${e}</a>`:t.x`<button ?disabled="${this.disabled}" aria-pressed="${this.selected}"> ${e} </button>`}}n.styles=i,e._([e.n({type:Boolean})],n.prototype,"disabled",void 0),e._([e.n({type:Boolean,reflect:!0})],n.prototype,"selected",void 0),e._([e.n({type:String})],n.prototype,"href",void 0);var r=t.a`${e.a7}:host{display:inline-flex;border:1px solid transparent;cursor:pointer}.container{display:inherit;align-items:center}slot:not([name]){display:inline-flex;font:var(--font-caption-2);letter-spacing:var(--font-caption-2-kerning)}`;class s extends n{}return s.styles=[n.styles,r],{R:s}}));
SML.dm("Yp_OV6CjXa",[],(async()=>{var r,n;return function(r){r.Slot="slot",r.Wrap="wrap"}(r||(r={})),function(r){r.NSFW="nsfw",r.Spoiler="spoiler",r.NsfwAndSpoiler="nsfwAndSpoiler"}(n||(n={})),{get M(){return r},get R(){return n}}}));

SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("Z0tk4vmzIQ",["C8QDHFSIkY","Dw4vb8Yfbm"],(async(t,e)=>{var o;!function(t){t.follow="follow",t.hide="hide",t.save="save",t.delete="delete",t.markAsSpoiler="mark_as_spoiler",t.markAsNsfw="mark_as_nsfw",t.markAsCommercialCommunication="mark_as_commercial_communication",t.distinguishAsMod="distinguish_as_mod",t.distinguishAsAdmin="distinguish_as_admin",t.updatePostFlair="update_post_flair",t.lock="lock",t.sticky="sticky",t.addRemovalReason="add_removal_reason",t.edit="edit",t.editAma="edit_ama",t.updateContent="update_content",t.updateAmaTime="update_ama_time",t.updatePostBodyPending="update_post_body_pending",t.updatePostAmaTimePending="update_post_ama_time_pending",t.approve="approve",t.remove="remove",t.removeAsSpam="remove_as_spam",t.ignoreReports="ignore_reports",t.confirmRemoval="confirm_removal",t.updateSendReplies="update_send_replies",t.snoozeReporter="snooze_reporter",t.unsnoozeReporter="unsnooze_reporter",t.updateHighlightedPost="update_highlighted_post",t.approveOptimistic="approve_optimistic",t.removeOptimistic="remove_optimistic",t.removeAsSpamOptimistic="remove_as_spam_optimistic",t.confirmRemovalOptimistic="confirm_removal_optimistic",t.shareToModChat="share_to_mod_chat"}(o||(o={}));const i={isPostFollowed:o.follow,isPostHidden:o.hide,isPostSaved:o.save,isPostSpoiler:o.markAsSpoiler,isPostNsfw:o.markAsNsfw,isPostCommercialCommunication:o.markAsCommercialCommunication,isPostDistinguishedAsAdmin:o.distinguishAsAdmin,isPostStickied:void 0,isReceivingPostReplies:o.updateSendReplies,[t.M.Distinguish]:o.distinguishAsMod,[t.M.Undistinguish]:o.distinguishAsMod,[t.M.Lock]:o.lock,[t.M.Unlock]:o.lock,[t.M.Sticky]:o.sticky,[t.M.Unsticky]:o.sticky,[t.M.AddRemovalReason]:o.addRemovalReason,[t.M.ApproveContent]:o.approve,[t.M.RemoveContent]:o.remove,[t.M.RemoveContentAsSpam]:o.removeAsSpam,[t.M.ConfirmRemoval]:o.confirmRemoval,[t.M.IgnoreReports]:o.ignoreReports,[t.M.UnignoreReports]:o.ignoreReports,[t.M.SnoozeReporter]:o.snoozeReporter,[t.M.UnsnoozeReporter]:o.unsnoozeReporter,[t.M.RemoveHighlightedPost]:o.updateHighlightedPost,[t.A.Distinguish]:o.distinguishAsAdmin,[t.A.Undistinguish]:o.distinguishAsAdmin,[t.M.ApproveContentOptimistic]:o.approveOptimistic,[t.M.RemoveContentOptimistic]:o.removeOptimistic,[t.M.RemoveContentAsSpamOptimistic]:o.removeAsSpamOptimistic,[t.M.ConfirmRemovalOptimistic]:o.confirmRemovalOptimistic};o.hide,o.markAsSpoiler,o.markAsNsfw,o.markAsCommercialCommunication;var r;!function(t){t[t.Follow=5]="Follow",t[t.Edit=10]="Edit",t[t.Report=20]="Report",t[t.Save=30]="Save",t[t.TranslationSetting=35]="TranslationSetting",t[t.LanguageAndTranslations=40]="LanguageAndTranslations",t[t.Delete=70]="Delete",t[t.AdminDistinguish=80]="AdminDistinguish",t[t.BrandAffiliate=90]="BrandAffiliate",t[t.Notifs=100]="Notifs",t[t.Reply=110]="Reply",t[t.Award=120]="Award",t[t.Insights=130]="Insights",t[t.ShareAsPost=140]="ShareAsPost"}(r||(r={}));const a="429";function s(t){return t?.[0]?.message??"Something went wrong";}return{get C(){return r},E:"edit-ama",P:["isPostFollowed","isPostHidden","isPostSaved","isPostSpoiler","isPostNsfw","isPostCommercialCommunication","isPostDistinguishedAsAdmin","isPostStickied","isReceivingPostReplies"],R:a,S:i,get a(){return o},b:"post__click_unrsvp",c:"post__click_rsvp",d:"edit",e:async function(t){const o={input:t},{data:i,errors:r}=await e.Y({operation:e.O.DeletePost,variables:o});if(r?.length)throw new Error(s(r));const{deletePost:a}=i;if(!a?.ok)throw new Error(s(a?.errors))},f:"overflow__click_comments",g:"overflow__click_share",h:async function(t,o){const i={input:{postId:t,saveState:o?e.ht.None:e.ht.Saved}},{data:r,errors:a}=await e.Y({operation:e.O.UpdatePostSaveState,variables:i});if(a?.length)throw new Error(s(a));if(r?.updatePostSaveState?.ok)return!o;throw new Error(s(r?.updatePostSaveState?.errors))},i:async function(t,o){const i={input:{postId:t,followState:o?e.hu.Unfollowed:e.hu.Followed}},{data:r,errors:a}=await e.Y({operation:e.O.UpdatePostFollowState,variables:i});if(a?.length)throw new Error(s(a));if(r?.updatePostFollowState?.ok)return!o;throw new Error(s(r?.updatePostFollowState?.errors))},j:async function(t,o){const i={input:{postId:t,distinguishState:o?e.df.None:e.df.Distinguished,distinguishType:o?e.db.None:e.db.AdminDistinguished}},{data:r,errors:a}=await e.Y({operation:e.O.UpdatePostDistinguishedState,variables:i});if(a?.length)throw new Error(s(a));if(r?.updatePostDistinguishState?.ok)return r.updatePostDistinguishState.distinguishType===e.db.AdminDistinguished;throw new Error(s(r?.updatePostDistinguishState?.errors))},k:async function(t,o){const i={input:{postId:t,spoilerState:o?e.hq.None:e.hq.Spoiler}},{data:r,errors:a}=await e.Y({operation:e.O.UpdatePostSpoilerState,variables:i});if(a?.length)throw new Error(s(a));if(r?.updatePostSpoilerState?.ok)return r.updatePostSpoilerState.spoilerState===e.hq.Spoiler;throw new Error(s(r?.updatePostSpoilerState?.errors))},l:async function(t,o){const i={input:{postId:t,nsfwState:o?e.hr.None:e.hr.Nsfw}},{data:r,errors:a}=await e.Y({operation:e.O.UpdatePostNsfwState,variables:i});if(a?.length)throw new Error(s(a));if(r?.updatePostNsfwState?.ok)return r.updatePostNsfwState.nsfwState===e.hr.Nsfw;throw new Error(s(r?.updatePostNsfwState?.errors))},m:async function(t,o){const i={input:{thingId:t,commercialCommunicationState:!o}},{data:r,errors:a}=await e.Y({operation:e.O.UpdateCommercialCommunicationState,variables:i});if(a?.length)throw new Error(s(a));if(r?.updateCommercialCommunicationState?.ok)return!o;throw new Error(s(r?.updateCommercialCommunicationState?.errors))},n:async function(t,o){const i={postId:t,sendRepliesState:o?e.hs.DoNotSend:e.hs.Send},{data:r,errors:a}=await e.Y({operation:e.O.UpdatePostSendRepliesState,variables:{input:i}});if(a?.length)throw new Error(s(a));if(r?.updatePostSendRepliesState?.ok)return r.updatePostSendRepliesState?.sendRepliesState===e.hs.Send;throw new Error(s(r?.updatePostSendRepliesState?.errors))},o:async function(t,o){const i={input:{postId:t,hideState:o?e.hp.None:e.hp.Hidden}},{data:r,errors:a}=await e.Y({operation:e.O.UpdatePostHideState,variables:i});if(a?.length)throw new Error(s(a));if(r?.updatePostHideState?.ok)return r.updatePostHideState.hideState===e.hp.Hidden;throw new Error(s(r?.updatePostHideState?.errors))},p:async function(t){const o={input:t},{data:i,errors:r}=await e.Y({operation:e.O.UpdatePostStickyState,variables:o});if(r?.length)throw new Error(s(r));if(!i?.updatePostStickyState?.ok)throw new Error(s(i?.updatePostStickyState?.errors))},u:async function(t){const o={input:t},{data:i,errors:r}=await e.Y({operation:e.O.UpdateAdHideState,variables:o});if(r?.length)throw new Error(s(r));if(i?.updateAdHideState?.ok)return i.updateAdHideState.hideState===e.hp.Hidden;if(i?.updateAdHideState?.errors&&(i?.updateAdHideState?.errors[0]).code===a)throw new Error(a);throw new Error(s(i?.updateAdHideState?.errors))}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./BLrhRle6xP.js",import.meta.url,"BLrhRle6xP");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("ZGR-_CKl0i",["Dw4vb8Yfbm","BLrhRle6xP","5r73EsgItq"],(async(t,e,n)=>{let i=class extends n.s{constructor(){super(...arguments),this.appearance=e.B.ALERT,this.outline=!1,this.initialCount=0,this.badgeClassname="",this.count=0,this.pubsub=new t.u(this),this.setCount=({messageCount:t}={})=>{this.count=Number(t??0)},this.getCount=()=>this.count,this.prettifiedCount=()=>this.count>99?"99+":this.count}connectedCallback(){super.connectedCallback(),this.count=this.initialCount,this.setCountEvent&&this.pubsub.subscribe(this.setCountEvent,this.setCount)}render(){return this.count?n.x`${e.b({appearance:this.appearance,outline:this.outline,content:this.prettifiedCount().toString(),attributes:{className:this.badgeClassname}})}`:n.A}};i.styles=[t.t],t._([t.n({type:String})],i.prototype,"appearance",void 0),t._([t.n({type:Boolean})],i.prototype,"outline",void 0),t._([t.n({type:Number,attribute:"initial-count"})],i.prototype,"initialCount",void 0),t._([t.n({type:String,attribute:"badge-classname"})],i.prototype,"badgeClassname",void 0),t._([t.n({type:String,attribute:"set-count-event"})],i.prototype,"setCountEvent",void 0),t._([t.h()],i.prototype,"count",void 0),i=t._([t.e("dynamic-badge")],i)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");SML.di("./DHw9yEcfFd.js",import.meta.url,"DHw9yEcfFd");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("_C4HT6j0ig",["Dw4vb8Yfbm","BeFppRYbzE","DHw9yEcfFd","B-zFJtiar6","5r73EsgItq"],(async(e,t,r,o,a)=>{class n extends r.H{constructor(){super(...arguments),this.placement=t.P.Bottom,this.trigger="click"}connectedCallback(){super.connectedCallback(),this.addEventListener("rpl:menu-close",this.handleMenuClose),this.addEventListener("focusout",this.handleFocusOut)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("rpl:menu-close",this.handleMenuClose),this.removeEventListener("focusout",this.handleFocusOut)}focusFirstTabbableBodyElement(t){const r=e.cQ((e=>"rpl-menu"===e.tagName.toLowerCase()),t,{maximumMatches:1});if(0===r.length)return this.focusFirstTabbableElement(t);r[0].focusOnOpen()}updateAnchorElementAria(){this.anchorElement?.setAttribute("aria-haspopup","menu"),this.anchorElement?.setAttribute("aria-expanded",this.open?"true":"false")}handleMenuClose(e){e.stopPropagation(),this.hide(),setTimeout((()=>this.anchorElement?.focus()),0)}handleFocusOut(e){this.open&&e.relatedTarget instanceof Node&&!o.Y(this.contentSlotRef?.value,e.relatedTarget)&&this.hide()}}e._([e.n()],n.prototype,"placement",void 0);var s=a.a`${e.a7}:host{--max-width:20rem;--hide-delay:500ms;--show-delay:750ms;--rpl-dropdown-background-color:var(--color-neutral-background);display:contents}.hovercard{--arrow-color:var(--rpl-dropdown-background-color)}.hovercard::part(popup){z-index:var(--rpl-z-index-dropdown,var(--faceplate-dropdown-z-index,1))}.hovercard[placement^=top]::part(popup){transform-origin:bottom}.hovercard[placement^=bottom]::part(popup){transform-origin:top}.hovercard[placement^=left]::part(popup){transform-origin:right}.hovercard[placement^=right]::part(popup){transform-origin:left}.hovercard-body{display:flex;flex-direction:column;width:fit-content;justify-content:flex-start;align-items:flex-start;box-sizing:border-box;border-radius:1rem;box-shadow:var(--elevation-md);z-index:var(--rpl-z-index-dropdown,var(--faceplate-dropdown-z-index,1));background-color:var(--rpl-dropdown-background-color);padding:0}`;let l=class extends n{};l.styles=s,l=e._([e.e("rpl-dropdown")],l);var i=Object.freeze({__proto__:null,DropdownPlacement:t.P,get RPLDropdown(){return l}});return{get r(){return i}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("_Hk1tm1ODt",["Dw4vb8Yfbm"],(async a=>{const{svg:c}=a.a();return{n:a.m(c`<path d="M18.176 14.218l-.925-1.929a2.577 2.577 0 01-.25-1.105V8c0-3.86-3.142-7-7-7-3.86 0-7 3.14-7 7v3.184c0 .38-.088.762-.252 1.105l-.927 1.932A1.103 1.103 0 002.82 15.8h3.26A4.007 4.007 0 0010 19a4.008 4.008 0 003.918-3.2h3.26a1.1 1.1 0 00.934-.514 1.1 1.1 0 00.062-1.068h.002zM10 17.2c-.93 0-1.722-.583-2.043-1.4h4.087a2.197 2.197 0 01-2.043 1.4zM3.925 14l.447-.933c.28-.584.43-1.235.43-1.883V8c0-2.867 2.331-5.2 5.198-5.2A5.205 5.205 0 0115.2 8v3.184c0 .648.147 1.299.428 1.883l.447.933H3.925z"></path>`,"0 0 20 20","notifications")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./CM4Yt4lwBK.js",import.meta.url,"CM4Yt4lwBK");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./DflF56Kkuz.js",import.meta.url,"DflF56Kkuz");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./B0pL5bhFHV.js",import.meta.url,"B0pL5bhFHV");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");
SML.dm("afqfMOR1Oc",["Dw4vb8Yfbm","CM4Yt4lwBK","5r73EsgItq","DflF56Kkuz","B-zFJtiar6","B0pL5bhFHV","BtqmVQuPYp"],(async(s,t,a)=>{let i=class extends a.s{constructor(){super(...arguments),this.pubsub=new s.u(this),this.requestClientGQL=s.Y,this.isDesktop=!0,this.isDismiss=!1,this.subredditId="",this.authorId="",this._activateFeature=async t=>s.r(t),this.initSmartEscalations=async({thingId:t,removalReasonId:a,authorId:i,subredditId:e,removalReasonDisplayText:o})=>{this.subredditId=e,this.authorId=i,await this._activateFeature({name:s.hk,renderMode:s.P.Contents,queryParams:{thing_id:t,author_id:i,subreddit_id:e,is_moderator:!0,removal_reason_id:a,removal_reason_display_text:o,is_desktop:!!this.isDesktop}})},this.performAction=()=>{this.addRemovalReasonStatus===t.R.SUCCESS&&void 0!==this.smartEscalationsStatus&&(this.pubsub.publish(s.T.AddRemovalReasonClose),this.smartEscalationsStatus===t.S.READY&&this.openSmartEscalations(),this.addRemovalReasonStatus=void 0,this.smartEscalationsStatus=void 0)},this.updateRemovalReasonStatus=({status:s})=>{this.addRemovalReasonStatus=s},this.updateSmartEscalationStatus=({status:s})=>{this.smartEscalationsStatus=s},this.openSmartEscalations=async()=>{await(this.rplDialogSheet?.showModal())},this.closeSmartEscalations=async s=>{this.isDismiss=s?.isDismiss??!1,await(this.rplDialogSheet?.hide())},this.dismissSmartEscalations=async()=>{try{if(!this.isDismiss)return;const t={input:{subredditID:this.subredditId,userID:this.authorId}};this.requestClientGQL({operation:s.O.DismissSmartEscalation,variables:t})}finally{this.isDismiss&&(this.isDismiss=!1),this.subredditId="",this.authorId=""}}}get rplDialogSheet(){return this.querySelector("rpl-dialog-sheet")}get featureRoot(){return document.querySelector("#smart-escalations-content-modal rpl-modal-card")}updated(s){(s.has("addRemovalReasonStatus")||s.has("smartEscalationsStatus"))&&this.performAction()}connectedCallback(){super.connectedCallback(),this.pubsub.subscribe(s.T.SmartEscalationsInit,this.initSmartEscalations,!1),this.pubsub.subscribe(s.T.SmartEscalationsDismiss,this.dismissSmartEscalations,!1),this.pubsub.subscribe(s.T.SmartEscalationsClose,this.closeSmartEscalations,!1),this.pubsub.subscribe(s.T.SmartEscalationsOpen,this.openSmartEscalations,!1),this.pubsub.subscribe(s.T.RemovalReasonStatus,this.updateRemovalReasonStatus,!1),this.pubsub.subscribe(s.T.SmartEscalationsStatus,this.updateSmartEscalationStatus,!1)}render(){return a.x` <slot></slot>`}};s._([s.n({type:Boolean,attribute:"is-desktop"})],i.prototype,"isDesktop",void 0),s._([s.h()],i.prototype,"addRemovalReasonStatus",void 0),s._([s.h()],i.prototype,"smartEscalationsStatus",void 0),i=s._([s.e("smart-escalations-provider")],i)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("ankOzFFj6Q",["Dw4vb8Yfbm","5r73EsgItq"],(async(r,a)=>{const n={Neutral:"neutral",Success:"success",Warning:"warning",Danger:"danger",Alert:"alert",Plain:"plain",Disabled:"disabled"};class o extends r.R{constructor(){super(...arguments),this.appearance=n.Neutral,this.outline=!1,this._hasContent=!1}render(){return a.x`<span class="container"> <slot class="${r.Z({"with-content":this._hasContent,"without-content":!this._hasContent})}" @slotchange="${r=>{this._hasContent=!!r.target.assignedNodes().length}}"></slot> </span>`}}r._([r.n({type:String,reflect:!0})],o.prototype,"appearance",void 0),r._([r.n({type:Boolean})],o.prototype,"outline",void 0),r._([r.h()],o.prototype,"_hasContent",void 0);var e=a.a`${r.a7}:host{border-radius:var(--radius-full);display:inline-flex}.with-content{min-width:inherit;min-height:var(--size-md);display:inline-block}.without-content{width:inherit;height:var(--size-xs)}.container{font-weight:600;display:inline-block;text-align:center;padding:0 var(--spacer-2xs);min-width:var(--size-xs);min-height:var(--size-xs);font:var(--font-caption-2);letter-spacing:var(--font-caption-2-kerning)}:host([outline]){border:solid var(--line-md) var(--color-neutral-background)}:host([appearance=warning]){background:var(--color-warning-background);color:var(--color-neutral-background)}:host([appearance=alert]){background:var(--color-global-orangered);color:var(--color-primary-onBackground)}:host([appearance=danger]){background:var(--color-danger-background);color:var(--color-primary-onBackground)}:host([appearance=success]){background:var(--color-success-background);color:var(--color-primary-onBackground)}:host([appearance=neutral]){background:var(--color-neutral-content);color:var(--color-neutral-background)}:host([appearance=plain]){background:var(--color-neutral-background);color:var(--color-neutral-content)}:host([appearance=disabled]){background:var(--color-interactive-content-disabled);color:var(--color-neutral-background)}`;let t=class extends o{};return t.styles=e,t=r._([r.e("rpl-badge")],t),{R:n}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("av6qvYZJJ7",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6"],(async(e,t,n)=>{class s{hostConnected(){this.config.menuElement(this.host).role="menu"}constructor(t,s){this.host=t,this.config=s,this.handleMenuItemsSlotChange=()=>{const e=this.menuItems;let t=null;for(const s of e){n.Z(s)&&!t?(t=s,n._(s)):n.$(s)}if(t)return;const s=n.a0(e);s&&n._(s)},this.handleMousedown=e=>{const t=e.target;t&&this.config.isItem(t)&&!e.defaultPrevented&&this.setCurrentItem(t,this.menuItems)},this.handleKeydown=e=>{const t=e.code;if(e.defaultPrevented||!n.a1(t))return;const s=this.menuItems;if(!s.length)return;const l=n.a2(s);e.preventDefault();const o=this.getNextAction(l,s,t)();l&&l[0]!==o&&n.a3(l[0])},this.handleDeactivateItems=(e=!1)=>{for(const t of this.menuItems)n.a3(t),e&&"selected"in t&&(t.selected=!1)},this.handleFocusItem=e=>{n.a4(e)&&(this.handleDeactivateItems(),n.a5(e))},this.focusFirstItem=()=>{const e=this.menuItems;return n.a6(e)},this.getNextAction=(t,s,l)=>{const o=this.config.wrap(this.host),i=()=>n.a9(s,t,o),a=()=>n.aa(s,t,o);return{[e.cc.Up]:i,[e.cc.Left]:i,[e.cc.Down]:a,[e.cc.Right]:a,[e.cc.Home]:()=>n.a6(s),[e.cc.End]:()=>n.a8(s)}[l]},this.host.addController(this)}get menuItems(){return this.config.menuItemsSlot(this.host)?.assignedElements({flatten:!0}).filter(this.config.isItem)??[]}setCurrentItem(e,t){n.a7(t),n.a5(e)}handleItemSelected(e){n.a4(e)&&(this.handleDeactivateItems(!0),n.a5(e),"selected"in e&&(e.selected=!0))}focusOnOpen(){const e=this.menuItems;let t=null;for(const s of e){n.Z(s)&&s.selected&&!t?t=s:(n.a3(s),"selected"in s&&(s.selected=!1))}t??(t=e[0]??null),t&&n.a5(t)}}var l;class o extends(e.cd(e.R)){constructor(){super(...arguments),this[l]=!0,this.menuItemsSlot=e.a3(),this.menuController=new s(this,{menuElement:e=>e,isItem:e=>e instanceof Node&&n.ab(e),menuItemsSlot:e=>e.menuItemsSlot?.value??null,wrap:e=>e.wrap}),this.titleSlotted=!1,this.wrap=!0,this.label="",this.handleClickedItem=({detail:{item:e,type:t},defaultPrevented:s})=>{s||((t===n.ac.Radio&&!e.checked||t===n.ac.Checkbox)&&this.handleCheckedItem({item:e,type:t}),this.menuController.handleItemSelected(e))},this.handleCheckedItem=({item:e,type:t})=>{if("menuitemcheckbox"===t)return void(e.checked=!e.checked);if("menuitemradio"!==t)return;const n=e.group,s=this.menuController.menuItems;for(const t of s)"menuitemradio"===t.type&&t.group===n&&t!==e&&(t.checked=!1);e.checked=!0},this.handleSelectedItem=({detail:{item:e},defaultPrevented:t})=>{t||this.menuController.handleItemSelected(e)},this.handleTitleSlotChange=e=>{e.target instanceof HTMLSlotElement&&(this.titleSlotted=n.ad(e.target),this.headerHeight=e.target.clientHeight)}}focusFirstItem(){this.menuController.focusFirstItem()}focusOnOpen(){this.menuController.focusOnOpen()}render(){return t.x` <rpl-scrollbox part="scrollbox"> <slot name="title" class="${e.Z({"has-content":this.titleSlotted})}" part="title-slot" @slotchange="${this.handleTitleSlotChange}"></slot> <slot ${e.a4(this.menuItemsSlot)} @keydown="${this.menuController.handleKeydown}" @mousedown="${this.menuController.handleMousedown}" @slotchange="${this.menuController.handleMenuItemsSlotChange}" @rpl:menu-clicked-item="${this.handleClickedItem}" @rpl:menu-item-selected="${this.handleSelectedItem}" part="default-slot"></slot> </rpl-scrollbox> `}}l=e.ce,e._([e.h()],o.prototype,"titleSlotted",void 0),e._([e.n({type:Boolean,reflect:!0})],o.prototype,"wrap",void 0),e._([e.n({type:String,reflect:!0})],o.prototype,"label",void 0);var i=t.a`${e.a7}:host{display:flex;flex-direction:column;width:100%;padding:var(--rem8)}:host(:not([appearance=bottom-sheet])){max-width:320px;min-width:160px}[name=title]:not(.has-content){display:none}[name=title]{font:var(--font-headline);letter-spacing:var(--font-headline-kerning);display:block;padding:var(--rem8);user-select:none}::slotted(hr){margin:var(--rem6) var(--rem8)!important}`;let a=class extends o{};a.styles=i,a=e._([e.e("rpl-menu")],a)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./DTyYwWUJGO.js",import.meta.url,"DTyYwWUJGO");SML.di("./B9FNmoZbPR.js",import.meta.url,"B9FNmoZbPR");SML.di("./CpZ44pmnxI.js",import.meta.url,"CpZ44pmnxI");SML.di("./DfOK659qrU.js",import.meta.url,"DfOK659qrU");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B0p6XlbwHt.js",import.meta.url,"B0p6XlbwHt");SML.di("./BwcUp7XlaC.js",import.meta.url,"BwcUp7XlaC");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./DnNITwgp90.js",import.meta.url,"DnNITwgp90");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");SML.di("./Wt225_9ix9.js",import.meta.url,"Wt225_9ix9");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./CZLMnmUH44.js",import.meta.url,"CZLMnmUH44");SML.di("./DOqOHj9jA9.js",import.meta.url,"DOqOHj9jA9");SML.di("./BRjrtOukap.js",import.meta.url,"BRjrtOukap");
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("eY7T41bKac",["Dw4vb8Yfbm","5r73EsgItq"],(async(e,t)=>{const s=["input","a","faceplate-checkbox-input","faceplate-radio-input","faceplate-switch-input "],i=({collection:e,activeIndex:t})=>{let i=0;for(const o of e){o.tabIndex=i===t?0:-1;for(const e of Array.from(o.children)){const o=e.querySelector(s.join(","));o&&o instanceof HTMLElement&&(o.tabIndex=i===t?0:-1)}i++}};let o=class extends t.s{constructor(){super(...arguments),this.disableAutoFocus=!1,this.ariarole="menu",this.activeIndex=0,this.firstUpdated=()=>{this.prevFocusedElement=document.activeElement,this.hasAttribute("hidden")?this.toggleItemsTabbable(!1):this.openMenu()},this.toggleItemsTabbable=(e=!0,{overrideActiveIndex:t}={})=>{i({collection:this.getFocusableListItems(),activeIndex:t??(e?0:-1)})},this.openMenu=async()=>{const e=this.getFocusableListItems().findIndex((e=>"true"===e.getAttribute("aria-selected")));this.toggleItemsTabbable(!0,{overrideActiveIndex:-1===e?void 0:e}),this.disableAutoFocus||(e>=0&&e!==this.activeIndex&&(this.activeIndex=e),this.getFocusableListItems()[this.activeIndex]?.focus())},this.closeMenu=()=>{this.toggleItemsTabbable(!1)},this.setFocus=e=>{this.getFocusableListItems()[e]?.focus(),this.activeIndex=e},this.onFocusNext=()=>{const e=this.activeIndex===this.getFocusableListItems().length-1?0:this.activeIndex+1;i({collection:this.getFocusableListItems(),activeIndex:e}),this.setFocus(e)},this.onFocusPrev=()=>{const e=0===this.activeIndex?this.getFocusableListItems().length-1:this.activeIndex-1;i({collection:this.getFocusableListItems(),activeIndex:e}),this.setFocus(e)},this.onKeyDown=e=>{switch(e.key){case"Escape":this.prevFocusedElement.focus(),this.onclose&&this.onclose(e);break;case"ArrowDown":case"ArrowRight":this.onFocusNext(),e.preventDefault();break;case"ArrowUp":case"ArrowLeft":this.onFocusPrev(),e.preventDefault()}}}static get styles(){return t.a`:host{background-color:var(--color-neutral-background-strong)}ul{padding:var(--spacing-sm) 0;margin:0}`}getFocusableListItems(){const e="li:not([list-item-group]):not([list-item-header])",t=this.shadowRoot.querySelector("slot"),s=[];for(const i of t.assignedElements({flatten:!0}))i?.matches(e)&&s.push(i),s.push(...Array.from(i.querySelectorAll(e)));return s.map((e=>e.firstElementChild))}render(){return t.x` <ul role="${this.ariarole}" @keydown="${this.onKeyDown}"> <slot></slot> </ul> `}};e._([e.n({type:Boolean,attribute:"disable-auto-focus"})],o.prototype,"disableAutoFocus",void 0),e._([e.n({type:String})],o.prototype,"ariarole",void 0),e._([e.h()],o.prototype,"activeIndex",void 0),o=e._([e.e("faceplate-menu")],o);return{get F(){return o},S:class{constructor(e){this.previousChar="",this.focusedIndex=-1,this.cancelUpdate=!1,this.hasOptionVisualFocus=!1,this.hasSelection=!1,this.searchString="",this.searchTimeoutId=null,this.initializeSelections=()=>{this.options.forEach((e=>{this.makeSelection({selected:e.selected,option:e})}))},this.dispatchChangeEvent=()=>{this.hasSelection=!0,this.host.dispatchEvent(new CustomEvent(`${this.host.nodeName.toLowerCase()}:change`,{composed:!0,bubbles:!0,detail:{target:this.host}}))},this.onBlur=e=>{this.options.includes(e.relatedTarget)||(this.closeDropdownMenu(),this.host.blur())},this.onClick=()=>{(this.host.multiple&&!this.hasOptionVisualFocus||!this.host.multiple)&&this.host.dropdownMenu?.toggle()},this.shouldSelectFocusedOption=()=>{const e=this.host.hasAttribute("autocomplete"),t=!!this.host.readonly;return(e||t)&&!this.hasSelection&&this.hasOptionVisualFocus},this.onMenuClose=()=>{if(this.cancelUpdate||this.shouldSelectFocusedOption()&&this.selectFocusedOption(),this.selectedIndex>=0)this.focusedIndex=this.selectedIndex;else{if(this.host.readonly&&this.cancelUpdate)return;this.visibleOptions[this.focusedIndex]?.visualFocus(!1)}this.hasOptionVisualFocus=!1},this.onMenuOpen=()=>{this.focusedIndex=this.selectedIndex>=0?this.selectedIndex:-1,this.host.readonly&&this.focusedIndex<0&&(this.focusedIndex=0),this.focusedIndex>=0&&this.visuallyFocusOption(this.focusedIndex),this.hasSelection=!1,this.cancelUpdate=!1},this.onFaceplateOptionSelect=e=>{if(e.stopImmediatePropagation(),e.defaultPrevented)return;const t=e,{option:s,selected:i,allowSingleDeselection:o}=t?.detail||{};s&&this.makeSelection({option:s,selected:i,allowSingleDeselection:o})},this.makeSelection=async({selected:e,option:t,allowSingleDeselection:s})=>{this.host.multiple?(t?.dispatchEvent(this.createUpdateEvent(e)),await(t?.updateComplete)):(!s&&e||s)&&(e&&this.singleSelectionCache!==t&&this.singleSelectionCache?.dispatchEvent(this.createUpdateEvent(!1)),t?.selected!==e&&(t?.dispatchEvent(this.createUpdateEvent(e)),await(t?.updateComplete)),e&&(this.singleSelectionCache=t),setTimeout(this.closeDropdownMenu)),this.dispatchChangeEvent(),this.cancelUpdate=!1,this.host.requestUpdate()},this.visuallyFocusNextOption=()=>{this.focusedIndex===this.visibleOptions.length-1&&(this.focusedIndex=-1),this.visuallyFocusOption(++this.focusedIndex),this.hasOptionVisualFocus=!0},this.visuallyFocusPrevOption=()=>{this.focusedIndex<=0&&(this.focusedIndex=this.visibleOptions.length),this.visuallyFocusOption(--this.focusedIndex),this.hasOptionVisualFocus=!0},this.focusNextMatchedOption=e=>{if("number"==typeof this.searchTimeoutId&&window.clearTimeout(this.searchTimeoutId),this.searchTimeoutId=setTimeout((()=>{this.previousChar=this.searchString,this.searchString=""}),500),this.searchString+=e,this.searchString===this.previousChar){let e=this.focusedIndex+1;for(let t=0;t<this.visibleOptions.length;t++){if(e>this.visibleOptions.length-1&&(e=0),this.visibleOptions[e]?.displayText?.toLowerCase().startsWith(this.searchString)){this.visuallyFocusOption(e),this.focusedIndex=e;break}e++}}else{const e=this.visibleOptions.findIndex(((e,t)=>t!==this.focusedIndex&&e.displayText?.toLowerCase().startsWith(this.searchString)));-1!==e&&(this.focusedIndex=e,this.visuallyFocusOption(this.focusedIndex))}this.previousChar=this.searchString},this.selectFocusedOption=()=>{if(this.focusedIndex<0)return;const e=this.visibleOptions[this.focusedIndex];this.makeSelection({selected:!e.selected,option:e})},this.visuallyFocusOption=e=>{this.currentFocusedOption&&this.currentFocusedOption?.visualFocus(!1),this.currentFocusedOption=this.visibleOptions[e],this.currentFocusedOption?.visualFocus(!0),this.currentFocusedOption?.scrollIntoView()},this.openDropdownMenu=()=>{!this.host.disabled&&this.host.dropdownMenu?.hidden&&this.host.dropdownMenu?.show()},this.closeDropdownMenu=()=>{this.host.dropdownMenu?.hidden||this.host.dropdownMenu?.close()},this.handleKeyBindings=e=>{switch(e.key){case"ArrowDown":if(this.host.dropdownMenu?.hidden)return void this.openDropdownMenu();e.altKey||this.visuallyFocusNextOption();break;case"ArrowUp":this.openDropdownMenu(),this.visuallyFocusPrevOption();break;case"Escape":this.cancelUpdate=!0,this.closeDropdownMenu(),e.stopPropagation();break;case"Enter":case"Tab":this.host.dropdownMenu?.hidden||this.selectFocusedOption();break;default:e.key.match("^\\w$")&&(this.openDropdownMenu(),(this.host.multiple||this.host.readonly||this.host.referenceElement instanceof HTMLButtonElement)&&this.focusNextMatchedOption(e.key))}},(this.host=e).addController(this)}async hostConnected(){await this.host.updateComplete,this.resizeObserver=new ResizeObserver((()=>{this.host.style.setProperty("--select-width",`${this.host.getBoundingClientRect().width}px`)})),this.resizeObserver?.observe(this.host),this.host.addEventListener("faceplate-option:select",this.onFaceplateOptionSelect),this.host.addEventListener("keydown",this.handleKeyBindings),this.host.addEventListener("faceplate-dropdown-menu:open",this.onMenuOpen),this.host.addEventListener("faceplate-dropdown-menu:closed",this.onMenuClose),this.host.addEventListener("click",this.onClick),this.host.addEventListener("blur",this.onBlur),this.initializeSelections(),this.host.dropdownMenu&&(this.host.dropdownMenu.triggerEvent=void 0)}hostDisconnected(){this.resizeObserver?.disconnect(),this.host.removeEventListener("keydown",this.handleKeyBindings),this.host.removeEventListener("faceplate-option:select",this.onFaceplateOptionSelect),this.host.removeEventListener("faceplate-dropdown-menu:open",this.onMenuOpen),this.host.removeEventListener("faceplate-dropdown-menu:closed",this.onMenuClose),this.host.removeEventListener("click",this.onClick),this.host.removeEventListener("blur",this.onBlur)}get selectedOptions(){return this.options.filter((e=>e.selected))}get options(){return this.host.options??[]}get selectedIndex(){return this.options.findIndex((e=>e.selected))}get visibleOptions(){return(this.host.options??[]).filter((e=>!e.hasAttribute("hidden")))}get value(){return this.selectedOptions[0]?.value||""}set value(e){if(e===this.value)return;const t=this.options.findIndex((t=>t.value===e));if(-1===t)this.singleSelectionCache?.dispatchEvent(this.createUpdateEvent(!1)),this.singleSelectionCache=null;else{const e=this.options[t];this.makeSelection({selected:t>=0,option:e})}e||this.host.dispatchEvent(this.createClearEvent())}createUpdateEvent(e){return new CustomEvent("faceplate-option:update",{composed:!0,detail:{selected:e}})}createClearEvent(){return new CustomEvent("faceplate-option:clear",{composed:!0,bubbles:!0})}getSelectedOptionsAsStr(){return this.selectedOptions.map((e=>e.displayText)).join(", ").trim()}}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("g8Ezfsb_Vs",["Dw4vb8Yfbm"],(async a=>{const{svg:r}=a.a();return{a:a.m(r`<path d="M17.5 9.1H4.679l5.487-5.462a.898.898 0 00.003-1.272.898.898 0 00-1.272-.003l-7.032 7a.898.898 0 000 1.275l7.03 7a.896.896 0 001.273-.003.898.898 0 00-.002-1.272l-5.487-5.462h12.82a.9.9 0 000-1.8z"></path>`,"0 0 20 20","arrow-back",!0)}}));
SML.dm("gvWVn4JBWB",[],(async()=>{var t,a,n,i,o;return function(t){t.Control="control_1",t.Variant1="variant1",t.Variant2="variant2",t.Variant3="variant3",t.Variant4="variant4"}(t||(t={})),function(t){t.Control="control_1",t.Variant1="cbau_desktop_variant1",t.Variant2="cbau_desktop_variant2",t.Variant3="cbau_desktop_variant3",t.SlimVariant1="slim_cbau_desktop_variant1",t.SlimVariant2="slim_cbau_desktop_variant2",t.SlimVariant3="slim_cbau_desktop_variant3"}(a||(a={})),function(t){t.Full="full",t.Slim="slim"}(n||(n={})),function(t){t.Button="button",t.Scroll="scroll",t.Close="close"}(i||(i={})),function(t){t.Desktop="comment_block_auth_desktop",t.DesktopWithTimer="comment_block_auth_desktop_timer",t.Mobile="comment_block_auth_mobile"}(o||(o={})),{get C(){return i}}}));

SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("h4Pa0OJr_5",["Dw4vb8Yfbm"],(async a=>{const{svg:l}=a.a();return{v:a.m(l`<g clip-path="url(#a)"><path d="M19.63 11.863a.9.9 0 11-1.274 1.273l-1.863-1.863-1.863 1.863a.897.897 0 01-1.274 0 .9.9 0 010-1.273L15.22 10l-1.863-1.863a.9.9 0 111.273-1.273l1.863 1.863 1.863-1.863a.9.9 0 111.273 1.273L17.765 10l1.863 1.863h.002zM9.126 1.5c-.336 0-.68.098-.993.316L2.251 5.897c-2.865 1.988-2.865 6.219 0 8.207l5.881 4.081c.313.217.658.316.993.316.91 0 1.757-.721 1.757-1.752V3.252c0-1.031-.848-1.752-1.757-1.752h.001z"></path></g><defs><clipPath id="a"><path d="M0 0h20v20H0z"></path></clipPath></defs>`,"0 0 20 20","volume-off-fill")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("h4WFGocyAS",["Dw4vb8Yfbm","5r73EsgItq"],(async(t,e)=>{var a;let i=a=class extends e.s{constructor(){super(...arguments),this.activationIsEnabled=!1,this.onChatButtonClick=()=>{this.toggleUIState()},this.onChatButtonKeyDown=e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t.aA("web_chat_widget_auto_focus_from_header_ks")?this.toggleUIState():this.maximizeAndFocusChat())}}getChatClientHost(){return document.querySelector("reddit-chat-host")}async activateFeature(){try{await t.r({name:t.aB})}catch(e){if(!e.message?.endsWith(`${t.aB} not found`))throw e}}async setUIState(){if(a.hasInitialized)return;a.hasInitialized=!0;const t=this.initialView;if(!t)return;this.activationIsEnabled&&await this.activateFeature(),await window.customElements.whenDefined("reddit-chat-host");const e=this.getChatClientHost();e&&e.setUIState?.(t)}async toggleUIState(){await this.activateFeature();const t=this.getChatClientHost();t&&t.toggleUIState?.()}async maximizeAndFocusChat(){await this.activateFeature();const t=this.getChatClientHost();t&&(t.setUIState?.("maximized"),t.setFocusOnChatWidget())}connectedCallback(){super.connectedCallback(),this.addEventListener("click",this.onChatButtonClick),this.addEventListener("keydown",this.onChatButtonKeyDown),this.setUIState()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("click",this.onChatButtonClick),this.removeEventListener("keydown",this.onChatButtonKeyDown)}render(){return e.x`<slot></slot>`}};i.hasInitialized=!1,t._([t.n({type:Boolean,attribute:"activation-enabled"})],i.prototype,"activationIsEnabled",void 0),t._([t.n({type:String,attribute:"initial-view"})],i.prototype,"initialView",void 0),i=a=t._([t.e("reddit-chat-header-button")],i)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./Z0tk4vmzIQ.js",import.meta.url,"Z0tk4vmzIQ");SML.di("./B0pL5bhFHV.js",import.meta.url,"B0pL5bhFHV");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./C0cxgUZlQL.js",import.meta.url,"C0cxgUZlQL");SML.di("./Bypt3-pSP2.js",import.meta.url,"Bypt3-pSP2");
SML.dm("hd4nVjQBS-",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6","Z0tk4vmzIQ","B0pL5bhFHV","tO6bKRQro7","C0cxgUZlQL","Bypt3-pSP2"],(async(e,t,i,a)=>{var n,r;!function(e){e.Scheduled="scheduled",e.Live="live",e.Ended="ended",e.Unavailable="unavailable"}(n||(n={}));let s=r=class extends t.s{constructor(){super(...arguments),this.isReminderSet=!1,this.eventState=n.Scheduled,this.postId="",this.permalink="",this.pdpTarget="_self",this.isPdp=!1,this.isLoggedIn=!1,this.isDesktopViewport=!1,this.shouldFireEngagedClick=!1,this.enableUserActionTriggeredModal=!1,this.requestInProgress=!1,this.handleClickCancelReminder=()=>{this.dispatchEvent(new Event(a.b,{bubbles:!0})),this.cancelReminder()},this.cancelReminder=async()=>{this.isReminderSet=!1;if(await this.updatePostReminderState(e.ee.NoReminder)){const t=e.c("faceplate-alert",{level:e.a5.notice,message:"Reminder cancelled"});this.dispatchEvent(t),this.pubsub?.publish(e.T.AdReminderRsvpUnsubscribe,{postId:this.postId})}else{this.isReminderSet=!0;const e="Failed to cancel reminder";this.dispatchErrorAlert(e)}},this.handleClickSetReminder=async()=>{this.shouldFireEngagedClick&&this.dispatchEvent(e.c(e.ef)),this.isLoggedIn?(this.dispatchEvent(new Event(a.c,{bubbles:!0})),await this.setReminder()):this.dispatchEvent(e.c(e.dh.follow))},this.setReminder=async()=>{this.isReminderSet=!0;if(await this.updatePostReminderState(e.ee.Reminder)){const t=e.c("faceplate-alert",{level:e.a5.success,message:"Reminder set"});this.dispatchEvent(t),this.pubsub?.publish(e.T.AdReminderRsvpSubscribe,{postId:this.postId})}else{this.isReminderSet=!1;const e="Failed to set reminder";this.dispatchErrorAlert(e)}},this.showUserActionTriggeredModal=()=>{this.userActionTriggeredModal?.showModal(),this.userActionTriggeredBottomSheet?.showModal(),this.userActionTriggeredModal?.addEventListener("rpl-dialog:hide",this.handleModalClose),this.userActionTriggeredBottomSheet?.addEventListener("rpl-bottom-sheet:hide",this.handleBottomSheetClose)},this.closeUserActionTriggeredModal=()=>{this.userActionTriggeredModal?.hide(),this.userActionTriggeredBottomSheet?.hide(),r.triggeredPostIds.delete(this.postId),this.userActionTriggeredModal?.removeEventListener("rpl-dialog:hide",this.handleModalClose),this.userActionTriggeredBottomSheet?.removeEventListener("rpl-bottom-sheet:hide",this.handleBottomSheetClose)},this.handleModalClose=()=>{r.triggeredPostIds.delete(this.postId),this.userActionTriggeredModal?.removeEventListener("rpl-dialog:hide",this.handleModalClose)},this.handleBottomSheetClose=()=>{r.triggeredPostIds.delete(this.postId),this.userActionTriggeredBottomSheet?.removeEventListener("rpl-bottom-sheet:hide",this.handleBottomSheetClose)},this.handleTriggerModal=e=>{e.postId!==this.postId||r.triggeredPostIds.has(this.postId)||this.isReminderSet||this.eventState!==n.Scheduled||(r.triggeredPostIds.add(this.postId),this.showUserActionTriggeredModal())},this.closeUserActionTriggeredModalAndGetNotifications=async()=>{this.closeUserActionTriggeredModal(),await this.handleClickSetReminder()},this.updatePostReminderState=async t=>{this.requestInProgress=!0;const i=await e.Y({operation:e.O.UpdatePostReminderState,variables:{input:{postId:this.postId,reminderState:t}}});return this.requestInProgress=!1,!!i.data.updatePostReminderState?.ok}}connectedCallback(){super.connectedCallback(),this.pubsub=new e.u(this),this.pubsub.subscribe(e.T.AdReminderRsvpSubscribe,(e=>{e.postId===this.postId&&(this.isReminderSet=!0)})),this.pubsub.subscribe(e.T.AdReminderRsvpUnsubscribe,(e=>{e.postId===this.postId&&(this.isReminderSet=!1)})),this.enableUserActionTriggeredModal&&this.pubsub.subscribe(e.T.TriggerAdReminderModal,this.handleTriggerModal,!1)}disconnectedCallback(){super.disconnectedCallback(),this.pubsub=void 0}get shouldShowUserActionTriggeredModal(){const e=this.eventState===n.Live;return this.enableUserActionTriggeredModal&&this.isLoggedIn&&!e}dispatchErrorAlert(t){const i=e.c("faceplate-alert",{level:e.a5.error,cause:"uncategorized",message:t});this.dispatchEvent(i)}getButtonAttributes(){const e=this.eventState===n.Live;return e&&this.isPdp?null:e&&!this.isPdp?{text:"Join Now",appearance:"primary",href:this.permalink,target:this.pdpTarget}:this.isReminderSet&&!e?{action:this.handleClickCancelReminder,text:"Reminder set",appearance:i.ak()?"secondary":"bordered"}:this.isReminderSet||e?null:{action:this.handleClickSetReminder,text:"Remind me",appearance:i.ak()?"bordered":"secondary"};}get userActionTriggerModalHeaderString(){return "Get reminded when this event starts?";}get userActionTriggerModalContentString(){return "Get notified before it starts so you don't miss out.";}renderUserActionTriggeredBottomSheet(){const i=t.x` <div class="w-full box-border px-md"> <div class="flex justify-between items-center"> <div class="font-bold text-16">${this.userActionTriggerModalHeaderString}</div> ${e.o({appearance:"secondary",attributes:{onclick:this.closeUserActionTriggeredModal,"aria-label":"Close",className:"close-btn"},leadingIcon:e.al({size:t.I.Small}),size:e.q.Small})} </div> <div class="w-full box-border pt-md"> ${this.userActionTriggerModalContentString} <div> ${e.o({appearance:"secondary",size:e.q.Small,children:"No thanks",attributes:{className:"w-100 mt-sm",onclick:this.closeUserActionTriggeredModal}})} </div> <div> ${e.o({appearance:"primary",size:e.q.Small,children:"Yes, remind me",attributes:{onclick:this.closeUserActionTriggeredModalAndGetNotifications,className:"w-100 my-sm"}})} </div> </div> </div> `;return t.x`<rpl-bottom-sheet class="triggered-modal" .litTemplateChildren="${i}"></rpl-bottom-sheet>`}renderUserActionTriggeredModal(){const i=t.x` <rpl-modal-card class="w-[640px] max-w-[90%] m-auto"> <div slot="title">${this.userActionTriggerModalHeaderString}</div> <div slot="close-button"> ${e.o({appearance:"secondary",shape:"pill",leadingIcon:e.al({size:t.I.Small}),size:e.q.Small,attributes:{"aria-label":"Close",onclick:this.closeUserActionTriggeredModal}})} </div> <div class="pt-sm">${this.userActionTriggerModalContentString}</div> <div slot="secondary-button"> ${e.o({appearance:"secondary",size:e.q.Small,children:"No thanks",attributes:{className:"w-100 xs:w-auto",onclick:this.closeUserActionTriggeredModal}})} </div> <div slot="primary-button"> ${e.o({appearance:"primary",size:e.q.Small,children:"Yes, remind me",attributes:{onclick:this.closeUserActionTriggeredModalAndGetNotifications,className:"w-100 xs:w-auto"}})} </div> </rpl-modal-card> `;return t.x`<rpl-dialog class="triggered-modal" .litTemplateChildren="${i}"></rpl-dialog>`}render(){if(this.eventState===n.Ended)return t.x``;const i=this.getButtonAttributes();if(!i)return t.x``;const{appearance:a,action:r,text:s,href:o,target:l}=i,d=e.o({appearance:a,attributes:{className:"relative",onclick:r,id:"",href:o,target:l,disabled:this.requestInProgress},size:e.q.Small,children:s});return t.x`<div> ${d} ${this.shouldShowUserActionTriggeredModal?this.isDesktopViewport?this.renderUserActionTriggeredModal():this.renderUserActionTriggeredBottomSheet():""} </div>`}};s.styles=[e.t],s.triggeredPostIds=new Set,e._([e.n({type:Boolean,attribute:"is-reminder-set",reflect:!0})],s.prototype,"isReminderSet",void 0),e._([e.n({type:String,attribute:"event-state"})],s.prototype,"eventState",void 0),e._([e.n({type:String,attribute:"post-id"})],s.prototype,"postId",void 0),e._([e.n({type:String})],s.prototype,"permalink",void 0),e._([e.n({type:String,attribute:"pdp-target"})],s.prototype,"pdpTarget",void 0),e._([e.n({type:Boolean,attribute:"is-pdp"})],s.prototype,"isPdp",void 0),e._([e.n({type:Boolean,attribute:"is-logged-in"})],s.prototype,"isLoggedIn",void 0),e._([e.n({type:Boolean,attribute:"is-desktop-viewport"})],s.prototype,"isDesktopViewport",void 0),e._([e.n({type:Boolean,attribute:"should-fire-engaged-click"})],s.prototype,"shouldFireEngagedClick",void 0),e._([e.n({type:Boolean,attribute:"enable-user-action-triggered-modal"})],s.prototype,"enableUserActionTriggeredModal",void 0),e._([e.h()],s.prototype,"requestInProgress",void 0),e._([e.a2("rpl-dialog.triggered-modal")],s.prototype,"userActionTriggeredModal",void 0),e._([e.a2("rpl-bottom-sheet.triggered-modal")],s.prototype,"userActionTriggeredBottomSheet",void 0),s=r=e._([e.e("ad-reminder-button")],s);let o=class extends t.s{constructor(){super(...arguments),this.postId="",this.eventState=n.Scheduled,this.startsAt="",this.endsAt="",this.locale="en",this.isReminderSet=!1,this.isLoggedIn=!1,this.shouldFireEngagedClick=!1,this.requestInProgress=!1,this.handleClickCancelReminder=()=>{this.dispatchEvent(new Event(a.b,{bubbles:!0})),this.cancelReminder()},this.cancelReminder=async()=>{this.isReminderSet=!1;if(await this.updatePostReminderState(e.ee.NoReminder)){const t=e.c("faceplate-alert",{level:e.a5.notice,message:"Reminder cancelled"});this.dispatchEvent(t),this.pubsub?.publish(e.T.AdReminderRsvpUnsubscribe,{postId:this.postId})}else{this.isReminderSet=!0;const e="Failed to cancel reminder";this.dispatchErrorAlert(e)}},this.handleClickSetReminder=async()=>{this.shouldFireEngagedClick&&this.dispatchEvent(e.c(e.ef)),this.isLoggedIn?(this.dispatchEvent(new Event(a.c,{bubbles:!0})),await this.setReminder()):this.dispatchEvent(e.c(e.dh.follow))},this.setReminder=async()=>{this.isReminderSet=!0;if(await this.updatePostReminderState(e.ee.Reminder)){const t=e.c("faceplate-alert",{level:e.a5.success,message:"Reminder set"});this.dispatchEvent(t),this.pubsub?.publish(e.T.AdReminderRsvpSubscribe,{postId:this.postId})}else{this.isReminderSet=!1;const e="Failed to set reminder";this.dispatchErrorAlert(e)}},this.updatePostReminderState=async t=>{this.requestInProgress=!0;const i=await e.Y({operation:e.O.UpdatePostReminderState,variables:{input:{postId:this.postId,reminderState:t}}});return this.requestInProgress=!1,!!i.data.updatePostReminderState?.ok},this.handleStatusClick=()=>{this.eventState===n.Ended||this.requestInProgress||(this.isReminderSet?this.handleClickCancelReminder():this.handleClickSetReminder())}}connectedCallback(){super.connectedCallback(),this.pubsub=new e.u(this),this.pubsub.subscribe(e.T.AdReminderRsvpSubscribe,(e=>{e.postId===this.postId&&(this.isReminderSet=!0)})),this.pubsub.subscribe(e.T.AdReminderRsvpUnsubscribe,(e=>{e.postId===this.postId&&(this.isReminderSet=!1)}))}getStatusMessage(){let e,t="text-neutral-content-weak";return this.eventState===n.Scheduled?e="Coming Up":this.eventState===n.Live?(t="text-global-orangered",e="Live"):e="Just Finished",{message:e,color:t};}getRelativeTime(){const e=new Date(this.startsAt),t=new Date(this.endsAt),i=new Date(Date.now()-6e4);return this.eventState===n.Scheduled?e:this.eventState===n.Live?e<i?e:i:t<i?t:i}endedOver24HoursAgo(){if(this.eventState===n.Ended){return new Date(this.endsAt)<=new Date(Date.now()-864e5)}return!1}dispatchErrorAlert(t){const i=e.c("faceplate-alert",{level:e.a5.error,cause:"uncategorized",message:t});this.dispatchEvent(i)}render(){if(!this.startsAt||!this.endsAt||this.endedOver24HoursAgo())return t.x``;const{message:i,color:a}=this.getStatusMessage(),r=this.eventState===n.Scheduled,s=this.getRelativeTime().toISOString();return t.x`<div class="flex flex-row items-center text-12 h-xl ad-event-status cursor-pointer hover:opacity-80 transition-opacity" @click="${this.handleStatusClick}" role="button" tabindex="0" @keydown="${e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.handleStatusClick())}}"> <span class="${a} font-bold tracking-tight">${i}</span> <span class="me-2xs ms-2xs"></span> <span class="text-neutral-content-strong tracking-tight"> ${r?t.x`<faceplate-date locale="${e.ad(this.locale)}" ts="${s}" .formatOptions="${{dateStyle:"medium",timeStyle:"short"}}"></faceplate-date>`:t.x`<faceplate-timeago ts="${s}" format="short"></faceplate-timeago>`} </span> </div>`}};o.styles=[e.t],e._([e.n({type:String,attribute:"post-id"})],o.prototype,"postId",void 0),e._([e.n({type:String,attribute:"event-state"})],o.prototype,"eventState",void 0),e._([e.n({type:String,attribute:"starts-at"})],o.prototype,"startsAt",void 0),e._([e.n({type:String,attribute:"ends-at"})],o.prototype,"endsAt",void 0),e._([e.n({type:String})],o.prototype,"locale",void 0),e._([e.n({type:Boolean,attribute:"is-reminder-set",reflect:!0})],o.prototype,"isReminderSet",void 0),e._([e.n({type:Boolean,attribute:"is-logged-in"})],o.prototype,"isLoggedIn",void 0),e._([e.n({type:Boolean,attribute:"should-fire-engaged-click"})],o.prototype,"shouldFireEngagedClick",void 0),e._([e.h()],o.prototype,"requestInProgress",void 0),o=e._([e.e("ad-event-status")],o)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("iewwAXEto0",["Dw4vb8Yfbm"],(async a=>{const{svg:h}=a.a();return{l:a.m(h`<path d="M15.993 8.168h-.429V6.61a5.572 5.572 0 00-5.566-5.566A5.572 5.572 0 004.432 6.61v1.558h-.429a2.005 2.005 0 00-2.005 2.005v3.692a5.054 5.054 0 005.054 5.054h5.892a5.054 5.054 0 005.054-5.054v-3.692a2.005 2.005 0 00-2.005-2.005zM10.998 15h-2v-3h2v3zm2.767-6.832H6.232V6.61A3.771 3.771 0 0110 2.844a3.77 3.77 0 013.767 3.766l-.001 1.558z"></path>`,"0 0 20 20","lock-fill")}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("j0TSFgPKaL",["Dw4vb8Yfbm","5r73EsgItq"],(async(t,e)=>{let s=class extends e.s{constructor(){super(...arguments),this.open=!1,this._events=new t.E(this),this._firstUpdate=!0,this.updated=t=>{t.has("open")&&!this._firstUpdate&&(this.open?this._expand():this._collapse()),this._firstUpdate=!1},this._expand=()=>{this._content.style.display="block",this.offsetHeight!==this._content.offsetHeight&&(i(this,this._content.offsetHeight),this._content.style.opacity="1")},this._collapse=()=>{0!==this.offsetHeight&&(i(this,0),this._content.style.opacity="0")},this._onTransitionEnd=()=>{this.open?this.style.height="":(this.open=!1,this._content.style.display="none"),this.style.overflowY="visible"},this._handler=this._events.define("transitionend",this._onTransitionEnd)}connectedCallback(){super.connectedCallback(),this._content=this.querySelector("[faceplate-auto-height-animator-content]"),null!=this._content&&(this.style.transition="height 222ms ease",this._content.style.transition="opacity 222ms ease",this.open||(this.style.height="0px",this._content.style.display="none"),this.setAttribute("connected",""))}createRenderRoot(){return this}};function i(t,e){t.style.height=`${t.offsetHeight}px`,t.style.overflowY="hidden",window.requestAnimationFrame((()=>{t.style.height=`${e}px`}))}return t._([t.n({type:Boolean,reflect:!0})],s.prototype,"open",void 0),s=t._([t.e("faceplate-auto-height-animator")],s),{get FaceplateAutoHeightAnimator(){return s}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./BQbrDNllG4.js",import.meta.url,"BQbrDNllG4");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./DoSzdRrY_z.js",import.meta.url,"DoSzdRrY_z");
SML.dm("jFB0DOsi41",["Dw4vb8Yfbm","5r73EsgItq","B-zFJtiar6","BQbrDNllG4","BIzQFHISzm","DoSzdRrY_z"],(async(e,t,n,i,a,r)=>{const o={Click:"click",Keydown:"keydown"};class l extends e.R{constructor(){super(...arguments),this.slotController=new n.d(this),this.size="small",this.truncate="none"}renderSlot(n,i={}){return t.x`<slot class="${e.Z({[`${n}-slot`]:!0,"has-content":this.slotController.hasSlotContent(n),...i})}" name="${e.ad("default"===n?void 0:n)}" part="${"default"===n?"default-slot":n}" @slotchange="${this.slotController.handleSlotChange}"></slot>`}renderStart(){return[this.renderSlot("leading-icon"),this.renderSlot("leading-avatar")]}renderEnd(){return t.x` <div class="${e.Z({"end-container":!0,"has-content":this.slotController.hasSlotContent("trailing")||this.slotController.hasSlotContent("badge")})}" part="end-container"> ${[this.renderSlot("badge"),this.renderSlot("trailing-value"),this.renderSlot("trailing")]} </div>`}renderTextContainer(){const e=!!this.truncate&&["label","both"].includes(this.truncate),n=!!this.truncate&&["description","both"].includes(this.truncate);return t.x` <div class="text-container" part="text-container"> ${[this.renderSlot("default"),this.renderSlot("label",{truncate:e}),this.renderSlot("description",{truncate:n})]} </div> `}render(){return t.x` <slot class="background-slot" name="background" part="background"></slot> ${[this.renderStart(),this.renderTextContainer(),this.renderEnd()]}`}}e._([e.n({type:String,reflect:!0})],l.prototype,"size",void 0),e._([e.n({type:String,reflect:!0})],l.prototype,"truncate",void 0);var s=t.a`${e.a7}:host{display:flex;flex-direction:row;align-items:center;justify-content:flex-start;color:var(--color-secondary-plain);padding-inline:var(--rem8);border-radius:var(--rem8);background:0 0;box-sizing:border-box;overflow:hidden;position:relative}:host([size=small]){min-height:var(--rem40);--rpl-item-text-container-padding:var(--rem4) 0;--rpl-item-leading-icon-padding:0 var(--rem14) 0 var(--rem6);--rpl-item-leading-avatar-padding:var(--rem4) var(--rem8) var(--rem4) 0;--rpl-item-badge-padding:0 var(--rem8);--rpl-item-label-font:var(--font-body-2);--rpl-item-label-kerning:var(--font-body-2-kerning);--rpl-item-description-font:var(--font-caption-1);--rpl-item-description-kerning:var(--font-caption-1-kerning);--rpl-item-trailing-value-font:var(--font-body-2);--rpl-item-trailing-value-kerning:var(--font-body-2-kerning);--rpl-item-end-container-padding:0 0 0 var(--rem8);font:var(--rpl-item-label-font)}:host([size=medium]){min-height:var(--rem48);--rpl-item-text-container-padding:var(--rem4) 0;--rpl-item-leading-icon-padding:0 var(--rem14) 0 var(--rem6);--rpl-item-leading-avatar-padding:var(--rem4) var(--rem8) var(--rem4) 0;--rpl-item-badge-padding:0 var(--rem8);--rpl-item-label-font:var(--font-body-1);--rpl-item-label-kerning:var(--font-body-1-kerning);--rpl-item-description-font:var(--font-caption-1);--rpl-item-description-kerning:var(--font-caption-1-kerning);--rpl-item-trailing-value-font:var(--font-body-2);--rpl-item-trailing-value-kerning:var(--font-body-2-kerning);--rpl-item-badge-padding:0 var(--rem8);--rpl-item-end-container-padding:0 0 0 var(--rem8)}.badge-slot:not(.has-content),.default-slot:not(.has-content),.description-slot:not(.has-content),.end-container:not(.has-content),.label-slot:not(.has-content),.leading-avatar-slot:not(.has-content),.leading-icon-slot:not(.has-content),.trailing-slot:not(.has-content),.trailing-value:not(.has-content){display:none}.leading-icon-slot{display:flex;justify-content:center;align-items:center;color:var(--color-secondary-plain-hover);padding:var(--rpl-item-leading-icon-padding)}.leading-avatar-slot{display:flex;justify-content:center;align-items:center;padding:var(--rpl-item-leading-avatar-padding)}.text-container{flex:1;overflow:hidden;padding:var(--rpl-item-text-container-padding)}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.label-slot{display:block;font:var(--rpl-item-label-font);letter-spacing:var(--rpl-item-label-kerning);color:var(--color-secondary-plain)}.description-slot{display:block;font:var(--rpl-item-description-font);letter-spacing:var(--rpl-item-description-kerning);color:var(--color-secondary-plain-weak)}.end-container{display:flex;justify-content:center;align-items:center;gap:var(--rem8);padding:var(--rpl-item-end-container-padding)}.badge-slot{display:flex;justify-content:center;align-items:center}.trailing-slot{display:flex;justify-content:center;align-items:center;color:var(--color-secondary-plain-hover)}.trailing-value{display:flex;justify-content:center;align-items:center;color:var(--color-secondary-plain);font:var(--rpl-item-trailing-value-font);letter-spacing:var(--rpl-item-trailing-value-kerning)}.background-slot::slotted(*){inset:0;position:absolute;user-select:none;pointer-events:none}`;let d=class extends l{};var c;d.styles=s,d=e._([e.e("rpl-item")],d);const h="default",p="checkmark",u="checkbox",m="radio";class g extends e.R{constructor(){super(...arguments),this[c]=!0,this.selected=!1,this.size="medium",this.appearance=h,this.disabled=!1,this.checked=!1,this.value="",this.group="",this.type="menuitem",this.preventAutoClose=!1,this.target="",this.handleClick=t=>{if(this.disabled||t.defaultPrevented)return;"code"in t&&t.code===e.d7.Space&&t.preventDefault();if(!!this.dispatchEvent(n.aH(this.type,this))){if(this.href&&"code"in t&&n.aI(t.code)){const e=this.shadowRoot?.querySelector("a")??null;e instanceof HTMLAnchorElement&&e.click()}this.preventAutoClose||this.dispatchEvent(n.aJ({item:this,reason:t instanceof MouseEvent?{kind:o.Click}:{kind:o.Keydown,key:t.code}}))}},this.handleKeydown=t=>{if(n.aI(t.code))return this.handleClick(t);n.aK(t.code)&&!t.defaultPrevented&&(this.preventAutoClose&&t.code!==e.d8.Escape||n.aK(t.code)&&(t.preventDefault(),this.dispatchEvent(n.aJ({item:this,reason:{kind:o.Keydown,key:t.code}}))))},this.renderDefaultTrailingIcon=()=>{const e=v(this.type)?this.checked:this.selected;return{[u]:b(e),[p]:f(e),[m]:y(e),[h]:v(this.type)?{[n.ac.Radio]:y(e),[n.ac.Checkbox]:b(e)}[this.type]:t.A}[this.appearance]}}get textLabel(){const e=this.shadowRoot?.querySelector("rpl-item");return e?e.slotController.getSlotText("label")??"":""}willUpdate(e){this.href&&this.type!==n.ac.Link&&this.logDebugMessage(`rpl-menu-item has a \`href\` but is type ${this.type}. Please consider using \`RplMenuItemType.Link\`.`,this),e.has("checked")&&this.watchCheckedChanged(),e.has("disabled")&&this.watchDisabledChanged(),e.has("type")&&this.watchTypeChanged(),e.has("appearance")&&this.watchAppearanceChanged(),e.has("selected")&&this.selected&&(n.Z(this)||this.dispatchEvent(new CustomEvent("rpl:menu-item-selected",{detail:{item:this},bubbles:!0,cancelable:!0,composed:!0}))),super.willUpdate(e)}connectedCallback(){super.connectedCallback(),this.addEventListener("keydown",this.handleKeydown),this.addEventListener("click",this.handleClick)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("keydown",this.handleKeydown),this.removeEventListener("click",this.handleClick)}watchCheckedChanged(){const e=this.type===n.ac.Checkbox||this.type===n.ac.Radio;!this.checked||e?e?this.setAttribute("aria-checked",this.checked?"true":"false"):this.removeAttribute("aria-checked"):this.checked=!1}watchDisabledChanged(){this.setAttribute("aria-disabled",this.disabled?"true":"false")}async watchAppearanceChanged(){await this.updateComplete,this.shadowRoot?.querySelector('slot[name="trailing"]')?.dispatchEvent(new Event("slotchange",{bubbles:!0,cancelable:!0,composed:!0}))}watchTypeChanged(){const e={[n.ac.Button]:"menuitem",[n.ac.Link]:"link",[n.ac.MenuItem]:"menuitem",[n.ac.Checkbox]:"menuitemcheckbox",[n.ac.Radio]:"menuitemradio"}[this.type];this.setAttribute("role",e),this.type===n.ac.Checkbox||this.type===n.ac.Radio?this.setAttribute("aria-checked",this.checked?"true":"false"):this.removeAttribute("aria-checked")}renderContent(){return t.x` <rpl-item size="${this.size}" truncate="both" exportparts="
          label:item--label,
          description:item--description,
          leading-avatar:item--leading-avatar,
          leading-icon:item--leading-icon,
          trailing:item--trailing,
          text-container:item--text-container,
          end-container:item--end-container,
          background:item--background
        "> <div class="focus-ring" part="focus-ring" slot="background"></div> ${(this.selected||this.checked)&&n.o(this,"leading-icon-selected")?t.x`<slot slot="leading-icon" name="leading-icon-selected"></slot>`:t.x`<slot slot="leading-icon" name="leading-icon"></slot>`} <slot slot="label">Something</slot> <slot slot="description" name="description"></slot> <slot slot="trailing" name="trailing"> ${this.renderDefaultTrailingIcon()} </slot> <slot slot="leading-avatar" name="leading-avatar"></slot> </rpl-item> `}get elementType(){return this.href?"a":{[n.ac.Button]:"button",[n.ac.Link]:"a",[n.ac.MenuItem]:"div",[n.ac.Checkbox]:"div",[n.ac.Radio]:"div"}[this.type]}renderItem(n){const i=this.href,a=i&&this.target?this.target:t.A,r=this.elementType,o=e.Z({"menu-item":!0,disabled:this.disabled,selected:this.selected}),l=this.disabled&&!i?-1:0,s=this.href||t.A;return"a"===r?t.x` <a id="item" role="none" class="${o}" tabindex="${l}" href="${s}" target="${a}"> ${n} </a> `:"button"===r?t.x` <button id="item" role="none" class="${o}" tabindex="${l}" href="${s}" target="${a}"> ${n} </button> `:"div"===r?t.x` <div id="item" role="none" class="${o}" tabindex="${l}" href="${s}" target="${a}"> ${n} </div> `:t.A}render(){return this.renderItem(this.renderContent())}}c=n.aL,e._([e.n({type:Boolean,reflect:!0})],g.prototype,"selected",void 0),e._([e.n({type:String,reflect:!0})],g.prototype,"size",void 0),e._([e.n({type:String,reflect:!0,attribute:"appearance"})],g.prototype,"appearance",void 0),e._([e.n({type:Boolean,reflect:!0})],g.prototype,"disabled",void 0),e._([e.n({type:Boolean,reflect:!0})],g.prototype,"checked",void 0),e._([e.n({type:String})],g.prototype,"value",void 0),e._([e.n({type:String})],g.prototype,"group",void 0),e._([e.n({type:String})],g.prototype,"type",void 0),e._([e.n({type:Boolean,attribute:"prevent-auto-close",reflect:!0})],g.prototype,"preventAutoClose",void 0),e._([e.n({type:String})],g.prototype,"href",void 0),e._([e.n({type:String})],g.prototype,"target",void 0);const v=e=>[n.ac.Checkbox,n.ac.Radio].includes(e),b=e=>e?r.c({attributes:{className:"checked-icon"}}):r.a({attributes:{className:"unchecked-icon"}}),y=e=>e?i.r({attributes:{className:"radio-checked-icon"}}):i.a({attributes:{className:"radio-unchecked-icon"}}),f=e=>a.c({attributes:e?{}:{style:"color: transparent;"}});var k=t.a`${e.a7}:host{--rpl-menu-item-shape:var(--rem8);--rpl-menu-item-selected-bg:transparent;display:block;padding:0;background-color:transparent;border-radius:var(--rpl-menu-item-shape);overflow:hidden;flex:1 0 auto}#item:focus,#item:focus-within,:host(:focus),:host(:focus-within){outline:0}:host(:hover:not([disabled])){background-color:var(--color-neutral-background-hover)}:host([selected]){background-color:var(--color-neutral-background-selected)}:host([selected]:not([appearance=default]):not([type=menuitemcheckbox]):not([type=menuitemradio])){background-color:transparent}:host([disabled]){opacity:.5;cursor:not-allowed}[name=trailing]{color:var(--color-secondary-plain)}.menu-item{all:unset;display:block;width:100%;width:-webkit-fill-available;user-select:none}:host(:focus-visible) .focus-ring{border:2px solid var(--color-global-focus);border-radius:var(--rpl-menu-item-shape)}`;let x=class extends g{};return x.styles=k,x=e._([e.e("rpl-menu-item")],x),{R:o,get a(){return x}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./Z0tk4vmzIQ.js",import.meta.url,"Z0tk4vmzIQ");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");
SML.dm("jTFRatIQcd",["Dw4vb8Yfbm","Z0tk4vmzIQ","5r73EsgItq"],(async(t,e,s)=>{const{svg:i}=t.a(),a=t.m(i`<path d="M10.983 12.232a8.332 8.332 0 01-3.458-1.892c1.011-1.324 1.856-3.096 2.312-5.465h1.606a.9.9 0 000-1.8H7.204v-.762a.902.902 0 00-1.804 0v.762H1.16a.9.9 0 000 1.8h1.606c.456 2.368 1.301 4.141 2.312 5.465A8.357 8.357 0 01.97 12.382a.901.901 0 00.158 1.786.875.875 0 00.16-.015 10.234 10.234 0 005.013-2.474 10.207 10.207 0 004.682 2.405v-1.852zm-6.38-7.358h3.4c-.374 1.712-.979 3.046-1.7 4.073-.723-1.027-1.328-2.361-1.7-4.073zM18.016 10.8h-1.8c.428.429.877.879 1.073 1.07l.005.008a4.572 4.572 0 011.345 3.255A3.871 3.871 0 0114.773 19a.9.9 0 010-1.8c1.14 0 2.067-.927 2.067-2.067a2.75 2.75 0 00-.817-1.982l-.005-.007c-.212-.208-.69-.688-1.136-1.133v1.923a.9.9 0 01-1.8 0V9.899a.9.9 0 01.9-.9h4.034a.9.9 0 010 1.8l.001.001z"></path>`,"0 0 20 20","translate-off"),r="fetch-post-edit";var d=Object.freeze({__proto__:null,EditAmaController:class{get postId(){return this.args.getPostId()}get viewContext(){return this.args.getViewContext()}constructor(i,a){this.host=i,this.args=a,this._renderedPartial=!1,this.isEditing=!1,this.setEditing=t=>{t&&!this._renderedPartial?this.host.dispatchEvent(new CustomEvent(r)):this.host.requestUpdate(),this.isEditing=t},this.resetEditing=()=>{this.isEditing=!1,this._renderedPartial=!1},this.getAndRenderPostEditPartial=async()=>{t.p(t.T.PostUpdated,{postId:this.postId,action:e.a.updatePostAmaTimePending,value:!0});const s=`/svc/shreddit/edit-post-ama-time/${this.postId}`,i=await this._partialRequest.request(s),a=await(i?.text());if(a){const e=(new DOMParser).parseFromString(a,"text/html").querySelector('[slot="post-edit-ama-time"]');e?.innerHTML&&(t.aT(a,this.host,t.P.Append),this._renderedPartial=!0)}t.p(t.T.PostUpdated,{postId:this.postId,action:e.a.updatePostAmaTimePending,value:!1})},this.renderEditor=()=>s.x`<slot name="post-edit-ama-time"></slot>`,this._partialRequest=new t.aS(i),i.addController(this)}hostConnected(){this.host.addEventListener(r,this.getAndRenderPostEditPartial)}hostDisconnected(){this.host.removeEventListener(r,this.getAndRenderPostEditPartial)}},FetchPostEditAMATimeEvent:r});return{get e(){return d},t:a}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");
SML.dm("jWC3N3n7Al",["Dw4vb8Yfbm","5r73EsgItq","FQGvCwaizg"],(async(t,e,i)=>{class s{constructor(t,e,i,s,r,n,a,o,l,d){this.valueMissing=t,this.typeMismatch=e,this.patternMismatch=i,this.tooLong=s,this.tooShort=r,this.rangeUnderflow=n,this.rangeOverflow=a,this.stepMismatch=o,this.badInput=l,this.customError=d}}class r{constructor(t){this.submissionValue=null,this.constraintsSuffered={},this.customValidityMessage="",this.validityMessage="",this.validationAnchor=null,this.target=t,this.input=document.createElement("input"),this.input.className="faceplate-internal-input",this.input.tabIndex=-1,this.input.style.opacity="0",this.input.style.width="1px",this.input.style.height="100%",this.input.style.padding="0",this.input.style.border="0",this.input.style.pointerEvents="none",this.input.hidden=!0}_connect(t){t?(this._form=t,i.g.register(t,this.target)):this._form=void 0}_disconnect(){this._form&&(i.g.unregister(this._form,this.target),this._form=void 0)}getFormValue(){return this.submissionValue}setFormValue(t){this.submissionValue=t}get form(){return this._form}isSufferingFromItsConstraints(){for(const t in this.constraintsSuffered)if(this.constraintsSuffered[t])return!0;return!1}setValidity(t,e,i=null){if(t){const e=this.convertFlagsToValidityState(t);for(const i in t)this.constraintsSuffered[i]=e[i]}else this.constraintsSuffered={};const s=!!e&&this.isSufferingFromItsConstraints();if(t&&Object.prototype.hasOwnProperty.call(t,"customError")){const t=this.constraintsSuffered.customError&&e?e:"";this.customValidityMessage=t}else this.validationAnchor=i,this.validityMessage=s&&e?e:"";(this.validationAnchor||this.input).setCustomValidity(this.validationMessage),this.target.setAttribute("faceplate-validity",s?"invalid":"valid")}get willValidate(){return!(this.target.disabled||null===this.submissionValue)}convertFlagsToValidityState(t){return new s(!!t.valueMissing,!!t.typeMismatch,!!t.patternMismatch,!!t.tooLong,!!t.tooShort,!!t.rangeUnderflow,!!t.rangeOverflow,!!t.stepMismatch,!!t.badInput,!!t.customError)}get validity(){const t=this.constraintsSuffered;return this.convertFlagsToValidityState(t)}get validationMessage(){return this.customValidityMessage||this.validityMessage}dispatchInvalidEvent(){const t=new Event("invalid",{bubbles:!0,cancelable:!0});return this.target.dispatchEvent(t),t}checkValidity(){return!this.isSufferingFromItsConstraints()||(this.dispatchInvalidEvent(),!1)}reportValidity(){if(this.isSufferingFromItsConstraints()){if(!this.dispatchInvalidEvent().defaultPrevented){(this.validationAnchor||this.input).reportValidity()}return!1}return!0}}const n=t.h0(),a=new MutationObserver((t=>{for(const e of t){if("attributes"!==e.type||"disabled"!==e.attributeName||!(e.target instanceof HTMLFieldSetElement))continue;const t=n.getRegisteredElements(e.target);if(t)for(const i of t)i.formDisabledCallback&&i.formDisabledCallback(i.disabled||e.target.disabled)}}));function o(t){if(i.F in t)return t;class e extends t{constructor(){super(...arguments),this._internals=new r(this)}connectedCallback(){super.connectedCallback&&super.connectedCallback(),i.c(this).then((t=>{if(!t||!this.isConnected)return;this._internals._connect(t),this.formAssociatedCallback&&this.formAssociatedCallback(t);let e=this;for(;e.parentElement&&(e=e.parentElement,e!==t)&&!(e instanceof HTMLLegendElement);)if(e instanceof HTMLFieldSetElement){this._fieldSet=e;n.getRegisteredElements(e)||a.observe(e,{attributes:!0}),n.register(e,this);break}this.formDisabledCallback&&this.formDisabledCallback(this.disabled)}))}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback(),this._internals._disconnect(),this.formAssociatedCallback&&this.formAssociatedCallback(null),this._fieldSet&&(n.unregister(this._fieldSet,this),this._fieldSet=void 0)}get value(){return this._internals.getFormValue()}set value(t){this._internals.setFormValue(t),this.syncInputValidity(!1)}get form(){return this._internals.form}get name(){return this.getAttribute("name")||""}get disabled(){return this.hasAttribute("disabled")||!(!this._fieldSet||!this._fieldSet.disabled)}set disabled(t){t?this.setAttribute("disabled",""):this.removeAttribute("disabled"),this.formDisabledCallback&&this.formDisabledCallback(t||!(!this._fieldSet||!this._fieldSet.disabled))}get type(){return this.localName}get validity(){return this._internals.validity}get validationMessage(){return this._internals.validationMessage}get willValidate(){return this._internals.willValidate}checkValidity(){return this._internals.checkValidity()}reportValidity(){return this._internals.reportValidity()}setCustomValidity(t){this._internals.setValidity({customError:!!t},t)}syncInputValidity(t=!0){var e;const i=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("input:not(.faceplate-internal-input),textarea");if(!i)return;t&&this.setAttribute("faceplate-dirty","");let s={};if(this._internals.validity.customError){for(const t in i.validity)s[t]=i.validity[t];s.customError=!0}else s=i.validity;this._internals.setValidity(s,i.validationMessage||this._internals.validationMessage)}}return e[i.F]=!0,e}class l extends(o(e.s)){static get styles(){return e.a`:host{display:inline-block;position:relative}:host([aria-disabled=true]){cursor:not-allowed;opacity:.5}:host([faceplate-validity=invalid]){border-color:var(--color-danger-content)}.faceplate-internal-input{position:absolute;left:50%;bottom:0}`}get disabled(){return super.disabled}set disabled(t){super.disabled=t}constructor(){super(),this.ariaDisabled="false",this.addEventListener("focus",this.dispatchFocusin)}dispatchFocusin(){const t=new FocusEvent("focusin",{bubbles:!0});this.dispatchEvent(t)}render(){return e.x` ${this._internals.input} `}formDisabledCallback(t){this.ariaDisabled=t?"true":"false"}formResetCallback(){this.value=this.getAttribute("value"),this.removeAttribute("faceplate-dirty")}}t._([t.n({type:Boolean,reflect:!0})],l.prototype,"disabled",null),t._([t.n({type:String,attribute:"aria-disabled",reflect:!0})],l.prototype,"ariaDisabled",void 0);const d="siteRule.value",u="categoryOrRule.value";return{C:u,F:class extends l{async firstUpdated(){const t=await i.c(this);t&&this.isConnected&&t.register(this)}},I:l,M:999,R:class{constructor(t){this.bottomScrollIntoViewIfNeeded=t=>{const e=t?.parentElement;if(e&&t){e.clientHeight-(t.offsetTop+t.clientHeight)<0&&t.scrollIntoView()}},this.getHiddenInputValue=t=>this.reportFormEl.querySelector(`form input[type=hidden][name="${t}"]`)?.getAttribute("value")??"",this.setHiddenInputValue=(t,e)=>this.reportFormEl.querySelector(`form input[type=hidden][name="${t}"]`)?.setAttribute("value",e)??"",this.getAllHiddenInputValues=()=>Array.from(this.reportFormEl.querySelectorAll("form input[type=hidden]")).reduce(((t,e)=>{const i=e.getAttribute("name");return i?{...t,[i]:e.getAttribute("value")??""}:t}),{}),this.getComputedValueByRef=t=>{if(t===d){const e=this.getHiddenInputValue(u);return this.getHiddenInputValue(t).includes(e)?this.getHiddenInputValue(t):""}return this.getHiddenInputValue(t)},this.checkCondition=t=>{if("object"==typeof t){const{args:e,$type:i}=t;if("computed"===i&&Array.isArray(e)){const i=e.map((t=>"object"==typeof t&&"ref"===t.$type?this.getComputedValueByRef(t.ref):t));return"neq"===t.function?String(i[0])!==String(i[1]):String(i[0])===String(i[1])}if("ref"===i&&t.ref)return this.getHiddenInputValue(t.ref)}return!1},this.getComputedProp=t=>{if("computed"===t.$type&&"conditionalSelect"===t.function&&t.conditions&&t.values){const e=t.conditions;for(const[i,s]of e.entries())if(!0===s||"boolean"!=typeof s&&this.checkCondition(s))return t.values[i]}return t},this.getText=t=>{if(this.isString(t))return t;const e=this.getComputedProp(t);return this.isString(e)?e:""},this.getAction=t=>this.getComputedProp(t),this.getDisabledCondition=t=>!!this.checkCondition(this.getComputedProp(t)),this.getTextDataRef=t=>{const e=t.conditions?.[0];if(e&&"boolean"!=typeof e){const t=e.args;if(Array.isArray(t)&&!this.isString(t[0]))return t[0].ref}return""},this.getDisabledRef=t=>{const e=t.args;if(e&&Array.isArray(e)&&!this.isString(e[0]))return[e[0].ref];const i=t.values;return i?i.map((t=>t.args[0].ref)):void 0},this.isString=t=>"string"==typeof t,this.performAction=t=>{switch(t.actionType){case"formSubmit":return{formSubmit:!0,data:t.args};case"formClose":return{formClose:!0};case"flow":return"SELF_HARM"===this.getHiddenInputValue(t.args[0].ref)?{openCtlFlow:!0}:void 0;case"openTemplatedUrl":const e=t.args,{urlTemplate:i,placeholders:s}=e;if(e&&i&&s){let t="";return s.forEach((s=>{const r=e[s],n=this.getHiddenInputValue(r.ref);n&&(t=i.replaceAll(`%(${s})s`,n))})),{href:t,formClose:!0}}return{formClose:!0};default:const{value:r,key:n}=t.args;return"ref"===r.$type?(this.setHiddenInputValue(n,this.getHiddenInputValue(r.ref)),{key:n,value:this.getHiddenInputValue(r.ref)}):void 0}},this.reportFormEl=t}},S:d,T:function(){return l},W:o}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("kS-PCwPq_X",["Dw4vb8Yfbm"],(async l=>{const{svg:a}=l.a();return{v:l.m(a`<path d="M19.632 11.863a.9.9 0 11-1.274 1.273l-1.863-1.863-1.863 1.863a.897.897 0 01-1.274 0 .9.9 0 010-1.273L15.221 10l-1.863-1.863a.9.9 0 111.273-1.273l1.863 1.863 1.863-1.863a.9.9 0 111.273 1.273L17.767 10l1.863 1.863h.002zM9.084 3.348L3.281 7.374A3.156 3.156 0 001.906 10c0 1.062.501 2.02 1.375 2.626l5.802 4.026.001-13.304zM9.128 1.5c.91 0 1.757.721 1.757 1.752v13.496c0 1.031-.847 1.752-1.757 1.752-.336 0-.68-.098-.993-.316l-5.88-4.081c-2.866-1.988-2.866-6.219 0-8.207l5.88-4.08c.313-.217.658-.316.993-.316z"></path>`,"0 0 20 20","volume-off")}}));
SML.dm("lEw4CeTWZd",[],(async()=>{var e;!function(e){e[e.Pending=0]="Pending",e[e.Ready=1]="Ready"}(e||(e={}));return{N:{},R:{type:"REQUEST_FOCUS_COMMAND"},get a(){return e},b:"rte-ready-state-change",c:"rte-node-ready-state-change-event",d:"rte-node-error-event",e:"rte-node-error-resolve-event"}}));

SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./Q1IJQIXJf2.js",import.meta.url,"Q1IJQIXJf2");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("lxqt5OPiQh",["Dw4vb8Yfbm","Q1IJQIXJf2","5r73EsgItq","xrDbp1ee_h","B-zFJtiar6"],(async(e,t,s)=>{function i(e){return e?.split(",")}function n(e){const[t,s,i]=e.split("/");return{source:t,action:s,noun:i}}function l(t,s,i){return()=>s.forEach((s=>{const{source:l,action:h,noun:a}=n(s);l&&h&&a&&e.i(t,{source:l,action:h,noun:a,...i})}))}class h{constructor(e,t){this.host=e,this.onChange=t,this.host.addController(this)}hostConnected(){e.aF(this.onChange,{immediate:!0})}hostDisconnected(){e.aG(this.onChange)}}class a{constructor(e,t){this.host=e,this.onChange=t,this.host.addController(this)}hostConnected(){e.aE.subscribe(this.onChange)}hostDisconnected(){e.aE.unsubscribe(this.onChange)}}class o{constructor(t,s,i,n){this.lastVisibleTimestamp=0,this.dwellIndex=0,this.visible=!1,this.elapsedTime=0,this.handleEnter=()=>{this.visible||(this.visible=!0,this.lastVisibleTimestamp=Date.now(),this.scheduleNext())},this.handleLeave=()=>{this.pause(),this.visible=!1},this.handleVisibilityChange=()=>{document.hidden?this.pause():this.visible&&(this.lastVisibleTimestamp=Date.now(),this.scheduleNext())},this.checkAndFireDwell=()=>{if(this.visible){if(this.elapsedTime+=Date.now()-this.lastVisibleTimestamp,this.lastVisibleTimestamp=Date.now(),this.dwellIndex<this.dwellTimeMsStack.length&&this.elapsedTime>=this.dwellTimeMsStack[this.dwellIndex]){const e=this.onDwellStack[this.dwellIndex];e&&e(),this.dwellIndex++}this.dwellIndex<this.dwellTimeMsStack.length?this.scheduleNext():this.pause()}},this.host=t,this.target=s,this.dwellTimeMsStack=Array.isArray(i)?i:[i],this.onDwellStack=n,new e.ay(t,s,{threshold:[.5]}),this.host.addController(this)}hostConnected(){this.target.addEventListener("faceplate-enter",this.handleEnter),this.target.addEventListener("faceplate-leave",this.handleLeave),document.addEventListener("visibilitychange",this.handleVisibilityChange)}hostDisconnected(){this.pause(),this.target.removeEventListener("faceplate-enter",this.handleEnter),this.target.removeEventListener("faceplate-leave",this.handleLeave),document.removeEventListener("visibilitychange",this.handleVisibilityChange)}scheduleNext(){if(this.clearTimeout(),this.visible&&this.dwellIndex<this.dwellTimeMsStack.length){const e=this.dwellTimeMsStack[this.dwellIndex]-this.elapsedTime;this.timeoutId=window.setTimeout(this.checkAndFireDwell,Math.max(e,0))}}pause(){this.visible&&(this.elapsedTime+=Date.now()-this.lastVisibleTimestamp),this.clearTimeout()}clearTimeout(){void 0!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0)}}const r="search-telemetry-tracker";let c=class extends s.s{constructor(){super(...arguments),this.trackingContext={},this.clickEventSANs=[],this.viewEventSANs=[],this.leaveEventSANs=[],this.loadEventSANs=[],this.consumeEventSANs=[],this.dwellEventSANs=[],this.dwellTriggerTimers=[],this.disabled=!1,this.controllers=[]}setupClickEventTracking(){this.controllers.push(e.z(this,this,l(this,this.clickEventSANs,this.trackingContext)))}setupViewEventTracking(e){e.push(l(this,this.viewEventSANs,this.trackingContext))}setupLeaveEventTracking(e){e.push(l(this,this.leaveEventSANs,this.trackingContext))}setupConsumeEventTracking(e,s){const i=this.consumeEventSANs.map((e=>new t.C(this,n(e))));this.controllers.push(new h(this,(e=>i.forEach((t=>t.handleDocumentVisibilityChange(e)))))),this.controllers.push(new a(this,(()=>i.forEach((e=>e.onBeforeUnloadCallback()))))),e.push((()=>i.forEach((e=>e.handleIntersectionObserverEnter())))),s.push((()=>i.forEach((e=>e.handleIntersectionObserverLeave()))))}setupEnterLeaveTracking(){const t=[],s=[],i=[];this.viewEventSANs.length&&this.setupViewEventTracking(t),this.leaveEventSANs.length&&this.setupLeaveEventTracking(i),this.consumeEventSANs.length&&this.setupConsumeEventTracking(t,i),this.loadEventSANs.length&&this.setupLoadEventTracking(s);let n=!1;this.controllers.push(function({host:t,target:s,enterCallback:i,leaveCallback:n,options:l}){const h=new e.bf(t);new e.ay(h,s,l);const a=new e.E(h,(()=>s));return i&&a.define("faceplate-enter",(e=>i(e))),n&&a.define("faceplate-leave",(e=>n(e))),h}({host:this,target:this,enterCallback:t.length||s.length?()=>{t.forEach((e=>e())),n||(n=!0,s.forEach((e=>e())))}:void 0,leaveCallback:i.length?()=>i.forEach((e=>e())):void 0,options:{rootMargin:"0px"}}))}setupDwellEventTracking(){this.dwellEventSANs.length&&this.dwellTriggerTimers?.length&&this.dwellEventSANs.forEach(((e,t)=>{const s=this.dwellTriggerTimers[t].split("/").map(Number),i=s.map((t=>l(this,[e],{...this.trackingContext,timer:{millis:t,referrer:"search_results"}})));this.controllers.push(new o(this,this,s,i))}))}setupLoadEventTracking(e){e.push(l(this,this.loadEventSANs,this.trackingContext))}setupControllers(){this.clickEventSANs.length&&this.setupClickEventTracking(),this.dwellEventSANs.length&&this.setupDwellEventTracking(),!this.viewEventSANs.length&&this.leaveEventSANs.length&&this.consumeEventSANs.length||this.setupEnterLeaveTracking()}tearDownControllers(){for(const t of this.controllers)e.B(this,t);this.controllers=[]}connectedCallback(){super.connectedCallback(),this.disabled||this.setupControllers()}disconnectedCallback(){super.disconnectedCallback(),this.tearDownControllers()}updated(e){super.updated(e),e.has("disabled")&&void 0!==e.get("disabled")&&this[this.disabled?"tearDownControllers":"setupControllers"]()}createRenderRoot(){return this}};return e._([e.n({type:Object,attribute:"data-faceplate-tracking-context"})],c.prototype,"trackingContext",void 0),e._([e.n({attribute:"click-events",converter:i})],c.prototype,"clickEventSANs",void 0),e._([e.n({attribute:"view-events",converter:i})],c.prototype,"viewEventSANs",void 0),e._([e.n({attribute:"leave-events",converter:i})],c.prototype,"leaveEventSANs",void 0),e._([e.n({attribute:"load-events",converter:i})],c.prototype,"loadEventSANs",void 0),e._([e.n({attribute:"consume-events",converter:i})],c.prototype,"consumeEventSANs",void 0),e._([e.n({attribute:"dwell-events",converter:i})],c.prototype,"dwellEventSANs",void 0),e._([e.n({attribute:"dwell-trigger-timers",converter:i})],c.prototype,"dwellTriggerTimers",void 0),e._([e.n({type:Boolean})],c.prototype,"disabled",void 0),c=e._([e.e(r)],c),{S:r}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./DfOK659qrU.js",import.meta.url,"DfOK659qrU");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./BA2UEzZJB8.js",import.meta.url,"BA2UEzZJB8");SML.di("./DWhb02bbsY.js",import.meta.url,"DWhb02bbsY");SML.di("./DJSLRtH1XX.js",import.meta.url,"DJSLRtH1XX");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./B0p6XlbwHt.js",import.meta.url,"B0p6XlbwHt");SML.di("./CZLMnmUH44.js",import.meta.url,"CZLMnmUH44");SML.di("./FbqiA6OBP5.js",import.meta.url,"FbqiA6OBP5");SML.di("./Bk8sRXhdir.js",import.meta.url,"Bk8sRXhdir");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./eY7T41bKac.js",import.meta.url,"eY7T41bKac");SML.di("./D1DY-avSiT.js",import.meta.url,"D1DY-avSiT");SML.di("./BSYfFtBeKH.js",import.meta.url,"BSYfFtBeKH");SML.di("./DOqOHj9jA9.js",import.meta.url,"DOqOHj9jA9");SML.di("./jWC3N3n7Al.js",import.meta.url,"jWC3N3n7Al");SML.di("./FQGvCwaizg.js",import.meta.url,"FQGvCwaizg");SML.di("./BRjrtOukap.js",import.meta.url,"BRjrtOukap");SML.di("./BwcUp7XlaC.js",import.meta.url,"BwcUp7XlaC");SML.di("./BIzQFHISzm.js",import.meta.url,"BIzQFHISzm");SML.di("./BwcMg3lXAs.js",import.meta.url,"BwcMg3lXAs");SML.di("./DnNITwgp90.js",import.meta.url,"DnNITwgp90");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");
SML.dm("nIDA52pPJK",["Dw4vb8Yfbm","DfOK659qrU","5r73EsgItq","BA2UEzZJB8","DWhb02bbsY","DJSLRtH1XX","D_g7f2Ewyi","B0p6XlbwHt","CZLMnmUH44","FbqiA6OBP5","Bk8sRXhdir","BYzqEZ3uv3","eY7T41bKac","D1DY-avSiT","BSYfFtBeKH","DOqOHj9jA9","jWC3N3n7Al","FQGvCwaizg","BRjrtOukap","BwcUp7XlaC","BIzQFHISzm","BwcMg3lXAs","DnNITwgp90","xrDbp1ee_h","B-zFJtiar6","BtqmVQuPYp","Cv4mWnWE30","Bu440t6XLo","BeFppRYbzE"],(async(t,e,a,i,n,s,o,r,l,d)=>{var c;!function(t){t.GREAT="great",t.NOT_GREAT="not great"}(c||(c={}));let u=class extends a.s{constructor(){super(...arguments),this.otherReasonFormValue="",this.isOpen=!1,this.handleDismiss=()=>{t.i(this,l.n()),this.close()}}show(){t.i(this,l.m()),this.faceplateDialog?.showModal?.(),this.isOpen=!0}close(){this.faceplateDialog?.close?.(),this.isOpen=!1,this.selectedOption=void 0,this.otherReasonFormValue=""}showThankYouAlert(){this.dispatchEvent(t.c("faceplate-alert",{level:t.a5.success,message:"Thanks for rating"}))}handleUpvoteTranslation(){this.selectedOption=c.GREAT}handleDownvoteTranslation(){this.selectedOption=c.NOT_GREAT}handleSubmit(){this.selectedOption&&(t.i(this,l.o({reason:this.selectedOption,survey_text:this.otherReasonFormValue})),this.showThankYouAlert(),this.close())}render(){return a.x` <faceplate-dialog id="global-translation-feedback-faceplate-dialog" class="translation-feedback"> <div class="flex flex-col gap-lg"> <div class="flex justify-between"> <h3 class="font-bold text-24 text-neutral-content-strong m-0" data-testid="modal-title"> ${"Enjoying these translations?"} </h3> ${t.o({attributes:{onclick:this.handleDismiss},appearance:"secondary",leadingIcon:t.al({size:a.I.Medium}),size:t.q.Medium})} </div> <p class="m-0" data-testid="modal-subtitle"> ${"Tell us what you think about your translated Reddit experience."} </p> <div class="flex justify-center gap-md"> <button data-testid="upvote-translation" class="py-md px-lg cursor-pointer border-none rounded-md ${this.selectedOption===c.GREAT?"bg-neutral-background-selected":"bg-neutral-background-medium"}" @click="${this.handleUpvoteTranslation}" @keydown="${this.handleUpvoteTranslation}"> <img src="${CLIENT_CONFIG.STATIC_BASE_URL}assets/snoomojis/Snoo_Expression_Smile_EyesOpen.png" class="block m-auto pb-xs" width="56" height="56" alt=""> <p class="font-semibold text-14 text-center text-neutral-content-strong m-0"> ${"Great"} </p> </button> <button data-testid="downvote-translation" class="py-md px-lg cursor-pointer border-none rounded-md ${this.selectedOption===c.NOT_GREAT?"bg-neutral-background-selected":"bg-neutral-background-medium"}" @click="${this.handleDownvoteTranslation}" @keydown="${this.handleDownvoteTranslation}"> <img src="${CLIENT_CONFIG.STATIC_BASE_URL}assets/snoomojis/Snoo_Expression_Blanc.png" class="block m-auto pb-xs" width="56" height="56" alt=""> <p class="font-semibold text-14 text-center text-neutral-content-strong m-0"> ${"Not Great"} </p> </button> </div> ${this.selectedOption?a.x` <div class="flex w-full box-border"> <faceplate-textarea-input data-testid="other-reason-input" maxlength="500" appearance="${r.a.BORDERED}" size="${r.T.EXPANDED}" @keyup="${t=>{t.stopPropagation(),this.otherReasonFormValue=t.target.value}}" class="w-full" .value="${this.otherReasonFormValue}"> <span slot="label">${"Leave a comment (optional)"}</span> </faceplate-textarea-input> </div> `:a.x``} <div class="flex justify-end"> ${t.o({appearance:"primary",size:t.q.Large,shape:"pill",attributes:{onclick:this.handleSubmit,className:"flex box-border","data-testid":"submit-feedback-button",disabled:!this.selectedOption},children:a.x`<span class="font-semibold text-14">${"Give Feedback"}</span>`})} </div> </div> </faceplate-dialog> `;}};u.styles=[a.a`.translation-feedback{border-radius:16px;max-width:400px;padding:2rem 1.5rem 1.5rem 1.5rem;width:82%}`,t.t],t._([t.a2("#global-translation-feedback-faceplate-dialog")],u.prototype,"faceplateDialog",void 0),t._([t.h()],u.prototype,"selectedOption",void 0),t._([t.h()],u.prototype,"otherReasonFormValue",void 0),t._([t.h()],u.prototype,"isOpen",void 0),u=t._([t.e("global-translation-feedback-modal")],u);const m="data-protection-consent",h="faceplate-bottom-sheet#xpromo-bottom-sheet",p="faceplate-modal#blocking-modal",k=a.s;function T(t){return!!t?.open}let v=class extends k{constructor(){super(...arguments),this.activatableFeatures=[t.h_,t.h$,t.i0,t.i1],this.isDesktop=!1,this.withFeedback=!1,this.withActivatedFeatures=!1,this.translationContextValue=t.aQ,this.withCoachmark=!1,this.withTranslationSettings=!1,this.userLocale="",this.hasCoachmarkDisplayLimit=!1,this.translationActiveMsg="Translations enabled",this.handleTranslationActiveSwitch=()=>{const t=!this.translationContextValue.isTranslationActive;this.dispatchContextUpdateEvent({isTranslationActive:t})},this.closeTranslationCoachmark=()=>{this.translationCoachmark?.hide?.(),this.onCoachmarkClose()},this.openTranslationCoachmark=()=>{t.i(this,d.e(!!this.translationContextValue.isTranslationActive)),this.translationCoachmark?.show?.()},this.openTranslationMenu=()=>{t.i(this,d.f(!!this.translationContextValue.isTranslationActive)),this.isDesktop?this.translationDropdownMenu?.show?.():this.translationMenuBottomSheet?.showModal?.()},this.closeTranslationMenu=()=>{t.i(this,d.f(!!this.translationContextValue.isTranslationActive)),this.isDesktop?this.translationDropdownMenu?.close?.():this.translationMenuBottomSheet?.close?.()},this.openFeedbackModal=()=>{this.translationFeedbackModal?.show?.()},this.handleCoachmarkSettingsClick=()=>{this.closeTranslationCoachmark(),this.openTranslationMenu(),t.i(this,d.g(d.h.UpdateSettings))},this.handleTranslationActiveClick=e=>{e.stopPropagation(),t.i(this,l.q(!!this.translationContextValue.isTranslationActive,this.userLocale))},this.handleCoachmarkClick=t=>{t.stopPropagation()},this.handleCoachmarkCloseClick=()=>{this.closeTranslationCoachmark(),t.i(this,d.g(d.h.Dismiss))},this.handleNavMobileButtonClick=()=>{this.activateFeatures(),this.openTranslationMenu(),t.i(this,d.i(!!this.translationContextValue.isTranslationActive))},this.handleNavbarButtonClick=()=>{this.activateFeatures(),t.i(this,d.i(!!this.translationContextValue.isTranslationActive)),t.i(this,d.f(!!this.translationContextValue.isTranslationActive))},this.handleGiveFeedbackButtonClick=()=>{this.openFeedbackModal(),this.closeTranslationMenu()},this.onCoachmarkClose=()=>{setTimeout((()=>{this.dispatchContextUpdateEvent({shouldDisplayCoachmark:!1,shouldDisplayFeedbackCoachmark:!0})}),500)},this._activateFeature=t.r}connectedCallback(){super.connectedCallback();"mtseo-disabled"===t.a8.getItem(t.a9.I18nTranslationInterventionShown)&&(setTimeout((()=>{this.dispatchEvent(t.c("faceplate-alert",{level:t.a5.success,message:"Translations are disabled."}))}),1e3),t.a8.setItem(t.a9.I18nTranslationInterventionShown,"true"))}updated(t){this.withCoachmark&&!this.hasCoachmarkDisplayLimit&&t.has("translationContextValue")&&void 0!==this.translationContextValue.isTranslationActive&&this.displayCoachmark()}displayCoachmark(){const{coachmarkDisplayCount:t,shouldDisplayCoachmark:e}=this.translationContextValue;window.setTimeout((()=>{if(!e)return;if(this.hasCoachmarkObstacles())return;const a=t<1;this.dispatchContextUpdateEvent({coachmarkDisplayCount:t+1,shouldDisplayCoachmark:a,shouldDisplayFeedbackCoachmark:!a}),a&&this.openTranslationCoachmark(),this.hasCoachmarkDisplayLimit=!0}),1500)}hasCoachmarkObstacles(){const e=!!document.querySelector(m),a=function(e){const a=document.querySelector(e);return a?t.cQ(T,a):[]}(h),i=!!document.querySelector(p);return e||a?.length>0||i}dispatchContextUpdateEvent(t){const e={...this.translationContextValue,...t},a=new CustomEvent("update-translation-context",{bubbles:!0,composed:!0,detail:e});this.dispatchEvent(a)}featureShouldBeActivated(e){return!!document.querySelector(`faceplate-loader[name=${e}]`)&&!!document.querySelector(`faceplate-partial[name=${e}]`)&&!t.i2(e)}activateFeatures(){return this.withActivatedFeatures?Promise.all(this.activatableFeatures.filter(this.featureShouldBeActivated).map((t=>this._activateFeature({name:t})))):Promise.resolve()}renderCoachmark(){return this.translationContextValue.shouldDisplayCoachmark?a.x`<rpl-coachmark-card slot="content" appearance="inverted"> ${i.i({size:a.I.Small,attributes:{slot:"title-icon"}})} <span slot="title" class="whitespace-nowrap">${this.translationActiveMsg}</span> <p class="max-w-[10rem] xs:max-w-none"> ${this.translationContextValue.isTranslationActive?"Posts and comments are automatically translated":"Automatically translate posts and comments"} </p> ${t.o({attributes:{"aria-label":"Close",id:"coachmark-close-button",onclick:this.handleCoachmarkCloseClick,slot:"close-button"},appearance:"plainInverted",leadingIcon:t.al({size:a.I.Small}),size:t.q.Small})} ${t.o({attributes:{slot:"primary-button",id:"coachmark-settings-button",onclick:this.handleCoachmarkSettingsClick},children:"Settings",appearance:"plainInverted",size:t.q.Small})} </rpl-coachmark-card>`:a.x``;}renderDesktopMenu(){return a.x`<faceplate-dropdown-menu position="bottom-end" id="translation-desktop-menu"> ${t.o({size:t.q.Medium,appearance:"plain",shape:"pill",leadingIcon:n.t({size:a.I.Medium}),attributes:{id:"translation-menu-button","aria-label":this.translationActiveMsg,onclick:this.handleNavbarButtonClick}})} <faceplate-menu slot="menu" dropdown hidden> ${o.l({label:a.x` <faceplate-switch-input id="hui-translation-switch" appearance="${e.S.PRIMARY}" class="inline-flex flex-row-reverse gap-sm" ?checked="${this.translationContextValue.isTranslationActive}" @input="${this.handleTranslationActiveSwitch}" @click="${this.handleTranslationActiveClick}"> <span class="-ml-xs">${this.translationActiveMsg}</span> </faceplate-switch-input> `,size:o.L.Medium})} ${this.withTranslationSettings?o.l({label:a.x` <span class="flex flex-row items-center"> ${s.s({size:a.I.Medium})} <span class="ml-xs"> ${"Translation Settings"} </span> </span> `,attributes:{id:"translation-settings-list-item"},size:o.L.Medium,href:"/settings/preferences"}):a.A} ${this.withFeedback?o.l({label:"Give translation feedback",attributes:{"data-testid":"hui-translation-button-feedback-option"},size:o.L.Medium,onClick:this.handleGiveFeedbackButtonClick}):a.A} </faceplate-menu> </faceplate-dropdown-menu>`;}renderMobileMenu(){return a.x`<div> ${t.o({size:t.q.Medium,appearance:"plain",shape:"pill",leadingIcon:n.t({size:a.I.Medium}),attributes:{id:"translation-menu-button",onclick:this.handleNavMobileButtonClick,"aria-label":this.translationActiveMsg}})} <faceplate-bottom-sheet id="translation-mobile-menu"> <div class="p-md flex flex-col items-stretch w-full gap-md"> <faceplate-switch-input id="hui-translation-switch" appearance="${e.S.PRIMARY}" class="flex flex-row-reverse justify-between gap-sm px-xs" ?checked="${this.translationContextValue.isTranslationActive}" @input="${this.handleTranslationActiveSwitch}" @click="${this.handleTranslationActiveClick}"> <span class="inline-flex items-center gap-xs"> ${n.t({size:a.I.Medium})} <span> ${this.translationActiveMsg} </span> </span> </faceplate-switch-input> ${this.withFeedback?o.l({label:"Give translation feedback",attributes:{"data-testid":"hui-translation-button-feedback-option"},size:o.L.Medium,onClick:this.handleGiveFeedbackButtonClick}):a.A} </div> </faceplate-bottom-sheet> </div>`;}render(){return a.x` <rpl-coachmark placement="${this.isDesktop?"bottom-end":"bottom"}" appearance="inverted" id="translation-coachmark" @click="${this.handleCoachmarkClick}" @rpl-coachmark:after-hide="${this.onCoachmarkClose}" style="--max-width:fit-content"> <div>${this.isDesktop?this.renderDesktopMenu():this.renderMobileMenu()}</div> ${this.renderCoachmark()} </rpl-coachmark> ${this.withFeedback?a.x` <global-translation-feedback-modal id="hui-translation-button-feedback-modal"></global-translation-feedback-modal>`:a.A} `}};v.styles=[t.t],t._([t.n({type:Boolean,attribute:"is-desktop"})],v.prototype,"isDesktop",void 0),t._([t.n({type:Boolean,attribute:"with-feedback"})],v.prototype,"withFeedback",void 0),t._([t.n({type:Boolean,attribute:"with-activated-features"})],v.prototype,"withActivatedFeatures",void 0),t._([t.aP({context:t.aR,subscribe:!0}),t.h()],v.prototype,"translationContextValue",void 0),t._([t.n({type:Boolean,attribute:"with-coachmark"})],v.prototype,"withCoachmark",void 0),t._([t.n({type:Boolean,attribute:"with-translation-settings"})],v.prototype,"withTranslationSettings",void 0),t._([t.n({type:String,attribute:"user-locale"})],v.prototype,"userLocale",void 0),t._([t.h()],v.prototype,"hasCoachmarkDisplayLimit",void 0),t._([t.a2("#translation-coachmark")],v.prototype,"translationCoachmark",void 0),t._([t.a2("#translation-desktop-menu")],v.prototype,"translationDropdownMenu",void 0),t._([t.a2("#translation-mobile-menu")],v.prototype,"translationMenuBottomSheet",void 0),t._([t.a2("#hui-translation-button-feedback-modal")],v.prototype,"translationFeedbackModal",void 0),v=t._([t.e("hui-translation-button")],v);let b=class extends a.s{constructor(){super(...arguments),this.translationContextValue=t.aQ,this.isNewAccountAge=!1,this.isNewImmersiveVisit=!1,this.withBackendSetting=!1,this.defaultImmersiveOn=!1,this.requestClientGQL=t.Y}connectedCallback(){super.connectedCallback(),this.isSettingInitialized()?this.syncTranslationSettingsWithCookie():this.initializeTranslationSettings()}updated(t){if(!t.has("translationContextValue")||!this.withBackendSetting)return;const e=t.get("translationContextValue"),a=this.translationContextValue.isTranslationActive,i=e?.isTranslationActive;if(void 0===i)return;(!0!==i&&!0===a||!1!==i&&!1===a)&&this.saveTranslationSettingInAccount(a)}async initializeTranslationSettings(){const e=this.fetchTranslationSettingFromCookie(),a=await this.fetchTranslationSettingFromGQL();let i,n={...this.translationContextValue};if(e&&(n={...n,...e}),null!==a&&a!==e?.isTranslationActive&&(n={...n,isTranslationActive:a},i=l.T.BACKEND),null===e&&null===a){const[t,e]=this.getFallbackIsTranslationActive();i=e,n={...n,isTranslationActive:t}}this.dispatchContextUpdateEvent(n),null===a&&void 0!==n.isTranslationActive&&this.saveTranslationSettingInAccount(n.isTranslationActive),i&&(n.isTranslationActive?t.i(this,l.u(i)):t.i(this,l.v(i))),sessionStorage.setItem(t.a9.TranslationInitialized,Date.now().toString()),t.i(this,d.j(!!n.isTranslationActive))}getFallbackIsTranslationActive(){return this.defaultImmersiveOn?[!0,l.T.MULTILINGUAL_ON]:(this.isNewImmersiveVisit,this.isNewAccountAge?[!0,l.T.ACCOUNT_AGE]:[!1,l.T.DEFAULT_OFF])}syncTranslationSettingsWithCookie(){const e=this.fetchTranslationSettingFromCookie();let a={...this.translationContextValue};e&&e.isTranslationActive!==a.isTranslationActive&&(a={...a,...e},this.dispatchContextUpdateEvent(a)),t.i(this,d.j(!!a.isTranslationActive))}fetchTranslationSettingFromCookie(){const e=t.K.get(t.i3)??"";return t.i4(e)}async fetchTranslationSettingFromGQL(){if(!this.withBackendSetting)return null;try{const{data:e}=await this.requestClientGQL({operation:t.O.IdentityImmersiveTranslationSetting}),a=e.identity?.preferences?.isMachineTranslationImmersive;return null==a||a===t.i5.Unset?null:a===t.i5.Enabled}catch{}return null}async saveTranslationSettingInAccount(e){if(!this.withBackendSetting)return null;try{await this.requestClientGQL({operation:t.O.UpdateAccountPreferences,variables:{input:{isMachineTranslationImmersive:e?t.i5.Enabled:t.i5.Disabled}}})}catch{}return null}dispatchContextUpdateEvent(t){const e=new CustomEvent("update-translation-context",{bubbles:!0,composed:!0,detail:t});this.dispatchEvent(e)}isSettingInitialized(){const e=localStorage.getItem(t.a9.LoginTime);if(e&&this.withBackendSetting){const t=new Date(e);if(Date.now()-t.getTime()<2e4)return!1}const a=sessionStorage.getItem(t.a9.TranslationInitialized);return!!(a&&Date.now()-parseInt(a,10)<36e5)}render(){return a.x`<div> <slot></slot> </div>`}};t._([t.aP({context:t.aR,subscribe:!0}),t.h()],b.prototype,"translationContextValue",void 0),t._([t.n({type:Boolean,attribute:"is-new-account-age"})],b.prototype,"isNewAccountAge",void 0),t._([t.n({type:Boolean,attribute:"is-new-immersive-visit"})],b.prototype,"isNewImmersiveVisit",void 0),t._([t.n({type:Boolean,attribute:"with-backend-setting"})],b.prototype,"withBackendSetting",void 0),t._([t.n({type:Boolean,attribute:"default-immersive-on"})],b.prototype,"defaultImmersiveOn",void 0),b=t._([t.e("translation-settings-admin")],b)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("nn12FiJf-M",["Dw4vb8Yfbm"],(async c=>{const{svg:a}=c.a();return{b:c.m(a`<path d="M13 5.02H7v1.8h6v-1.8z"></path><path d="M15.1 1H6.3C4.48 1 3 2.48 3 4.3v11.6C3 17.61 4.39 19 6.1 19h10c.5 0 .9-.4.9-.9s-.4-.9-.9-.9a1.25 1.25 0 010-2.5c.5 0 .9-.4.9-.9V2.9A1.9 1.9 0 0015.1 1zm-1.78 16.2H6.1c-.72 0-1.3-.58-1.3-1.3 0-.66.54-1.2 1.2-1.2h7.33c-.17.38-.28.8-.28 1.25 0 .45.1.87.27 1.25zm1.88-4.3H6c-.43 0-.83.09-1.2.25V4.3c0-.83.67-1.5 1.5-1.5h8.8c.06 0 .1.04.1.1v10z"></path>`,"0 0 20 20","book",!0)}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("pA9dwrnd0r",["Dw4vb8Yfbm"],(async e=>{const{svg:t}=e.a();return{E:"scroll-to-comments-complete",a:e=>{let t=!1;const o=()=>{t||(t=!0,e(),window.removeEventListener("scroll",r),window.removeEventListener("scrollend",o),clearTimeout(s),clearTimeout(n))};let n;const r=()=>{clearTimeout(n),n=setTimeout(o,100)};"onscrollend"in window?window.addEventListener("scrollend",o,{once:!0}):window.addEventListener("scroll",r);const s=setTimeout(o,1e3)},e:e.m(t`<path d="M9.544 8.272L6.072 4.8h2.82a.9.9 0 000-1.8H3.9a.9.9 0 00-.9.9v4.992a.9.9 0 001.8 0v-2.82l3.472 3.472a.898.898 0 001.272 0 .898.898 0 000-1.272zm.912 3.456l3.472 3.472h-2.82a.9.9 0 000 1.8H16.1a.9.9 0 00.9-.9v-4.992a.9.9 0 00-1.8 0v2.82l-3.472-3.472a.898.898 0 00-1.272 0 .898.898 0 000 1.272z"></path>`,"0 0 20 20","expand-left"),s:async function(e){const t=document.querySelector("shreddit-comments-page-tools, comment-body-header"),o=document.querySelector("nav")?.offsetHeight??0,n=document.getElementById("pdp-seeker-mweb-return-to-results")?.offsetHeight??0,r=document.querySelector("shreddit-comment-tree");if(!t||!r)return;await r.updateComplete;const s=t.offsetTop;await requestAnimationFrame((()=>{window.scrollTo({top:s-(o+n),behavior:e})}))}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");
SML.dm("tO6bKRQro7",["Dw4vb8Yfbm","5r73EsgItq","Bu440t6XLo","B-zFJtiar6","BeFppRYbzE"],(async(o,r,t)=>{var a=r.a`${o.a7}:host{--max-width:20rem;--hide-delay:0ms;--show-delay:750ms;display:contents}:host,:host([appearance=neutral]){--rpl-tooltip-code-background-color:var(--color-neutral-background-hover);--rpl-tooltip-background-color:var(--color-neutral-background);--rpl-tooltip-color:var(--color-neutral-content-strong)}:host([appearance=inverted]){--rpl-tooltip-code-background-color:var(--color-inverted-neutral-background-hover);--rpl-tooltip-background-color:var(--color-inverted-neutral-background);--rpl-tooltip-color:var(--color-inverted-neutral-content-strong)}:host([appearance=primary]){--rpl-tooltip-background-color:var(--color-tooltip-bg-primary);--rpl-tooltip-color:var(--color-tooltip-text-primary)}.tooltip{--arrow-size:var(--rpl-tooltip-arrow-size, 4px);--arrow-color:var(--rpl-tooltip-background-color)}.tooltip[placement^=top]::part(arrow){box-shadow:1px 1px 2px rgba(0,0,0,.05)}.tooltip[placement^=bottom]::part(arrow){box-shadow:-1px -1px 2px rgba(0,0,0,.05)}.tooltip[placement^=left]::part(arrow){box-shadow:0 -2px 2px rgba(0,0,0,.05)}.tooltip[placement^=right]::part(arrow){box-shadow:-2px 0 2px rgba(0,0,0,.05)}.tooltip::part(popup){z-index:var(--rpl-z-index-tooltip,var(--faceplate-tooltip-z-index,1))}.tooltip[placement^=top]::part(popup){transform-origin:bottom}.tooltip[placement^=bottom]::part(popup){transform-origin:top}.tooltip[placement^=left]::part(popup){transform-origin:right}.tooltip[placement^=right]::part(popup){transform-origin:left}.tooltip-body{display:flex;justify-content:center;align-items:center;width:max-content;max-width:var(--max-width);border-radius:var(--rpl-tooltip-border-radius,.25rem);box-shadow:var(--rpl-tooltip-box-shadow,var(--boxshadow-tooltip));background-color:var(--rpl-tooltip-background-color);font:var(--rpl-tooltip-font,var(--font-label-2));color:var(--rpl-tooltip-color);padding:var(--rpl-tooltip-padding,.5rem);pointer-events:none;user-select:none;-webkit-user-select:none;gap:var(--rem4)}::slotted([slot=shortcut]),::slotted(code[slot=shortcut]){font:var(--rpl-tooltip-font,var(--font-label-2))!important;color:var(--rpl-tooltip-color)!important;background-color:var(--rpl-tooltip-code-background-color)!important;border:none!important;border-radius:calc(var(--rpl-tooltip-border-radius,.25rem) - var(--rem2))!important;padding:var(--rem4)!important}`;let p=class extends t.T{};return p.styles=a,p=o._([o.e("rpl-tooltip")],p),{get R(){return p}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");
SML.dm("tO6bKRQro7",["Dw4vb8Yfbm","5r73EsgItq","Bu440t6XLo","B-zFJtiar6","BeFppRYbzE"],(async(o,r,t)=>{var a=r.a`${o.a7}:host{--max-width:20rem;--hide-delay:0ms;--show-delay:750ms;display:contents}:host,:host([appearance=neutral]){--rpl-tooltip-code-background-color:var(--color-neutral-background-hover);--rpl-tooltip-background-color:var(--color-neutral-background);--rpl-tooltip-color:var(--color-neutral-content-strong)}:host([appearance=inverted]){--rpl-tooltip-code-background-color:var(--color-inverted-neutral-background-hover);--rpl-tooltip-background-color:var(--color-inverted-neutral-background);--rpl-tooltip-color:var(--color-inverted-neutral-content-strong)}:host([appearance=primary]){--rpl-tooltip-background-color:var(--color-tooltip-bg-primary);--rpl-tooltip-color:var(--color-tooltip-text-primary)}.tooltip{--arrow-size:var(--rpl-tooltip-arrow-size, 4px);--arrow-color:var(--rpl-tooltip-background-color)}.tooltip[placement^=top]::part(arrow){box-shadow:1px 1px 2px rgba(0,0,0,.05)}.tooltip[placement^=bottom]::part(arrow){box-shadow:-1px -1px 2px rgba(0,0,0,.05)}.tooltip[placement^=left]::part(arrow){box-shadow:0 -2px 2px rgba(0,0,0,.05)}.tooltip[placement^=right]::part(arrow){box-shadow:-2px 0 2px rgba(0,0,0,.05)}.tooltip::part(popup){z-index:var(--rpl-z-index-tooltip,var(--faceplate-tooltip-z-index,1))}.tooltip[placement^=top]::part(popup){transform-origin:bottom}.tooltip[placement^=bottom]::part(popup){transform-origin:top}.tooltip[placement^=left]::part(popup){transform-origin:right}.tooltip[placement^=right]::part(popup){transform-origin:left}.tooltip-body{display:flex;justify-content:center;align-items:center;width:max-content;max-width:var(--max-width);border-radius:var(--rpl-tooltip-border-radius,.25rem);box-shadow:var(--rpl-tooltip-box-shadow,var(--boxshadow-tooltip));background-color:var(--rpl-tooltip-background-color);font:var(--rpl-tooltip-font,var(--font-label-2));color:var(--rpl-tooltip-color);padding:var(--rpl-tooltip-padding,.5rem);pointer-events:none;user-select:none;-webkit-user-select:none;gap:var(--rem4)}::slotted([slot=shortcut]),::slotted(code[slot=shortcut]){font:var(--rpl-tooltip-font,var(--font-label-2))!important;color:var(--rpl-tooltip-color)!important;background-color:var(--rpl-tooltip-code-background-color)!important;border:none!important;border-radius:calc(var(--rpl-tooltip-border-radius,.25rem) - var(--rem2))!important;padding:var(--rem4)!important}`;let p=class extends t.T{};return p.styles=a,p=o._([o.e("rpl-tooltip")],p),{get R(){return p}}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./Bk8sRXhdir.js",import.meta.url,"Bk8sRXhdir");SML.di("./BWUv70NGv2.js",import.meta.url,"BWUv70NGv2");SML.di("./BaxkLfaoug.js",import.meta.url,"BaxkLfaoug");
SML.dm("uwcDasYs3h",["Dw4vb8Yfbm","5r73EsgItq","BWUv70NGv2","Bk8sRXhdir","BaxkLfaoug"],(async(t,e,s)=>{var i;!function(t){t.small="small",t.medium="medium"}(i||(i={}));let o=class extends e.s{constructor(){super(...arguments),this.size=i.medium}render(){return e.x` <button class="flex items-center justify-center p-0 m-0 border-none rounded-1 h-[var(--emote-btn-size)] w-[var(--emote-btn-size)] bg-transparent hover:bg-neutral-background-hover cursor-pointer"> <slot class="emote"></slot> </button> `}};function r({pageType:t,url:e}){return {page_type:t,...(e ? {pane_name:e} : {})};}function a({subredditId:t,subredditName:e}){return {id:t,...(e ? {name:e} : {})};}o.styles=[e.a`:host{--emote-btn-size:2.25rem;--emote-size:1.75rem;display:block}:host([size=small]){--emote-btn-size:1.25rem;--emote-size:1.25rem}.emote::slotted(img){width:var(--emote-size);height:var(--emote-size);object-fit:contain;margin:0!important;padding:0!important}`,t.t],t._([t.n({type:String,reflect:!0})],o.prototype,"size",void 0),o=t._([t.e("community-status")],o);const n=e=>t.b({source:s.S.COMMUNITY_STATUS,action:s.A.CLICK,noun:s.N.STATUS_LINK},{action_info:r(e),subreddit:a(e)}),l=e.s;let d=class extends l{constructor(){super(...arguments),this.subredditId="",this.subredditName="",this.open=()=>{this.bottomSheet?.showModal()},this.close=()=>{this.bottomSheet?.close()},this.handleKeyUp=t=>{"Enter"!==t.key&&"Space"!==t.key||this.close()},this.handleStatusClicks=e=>{const s=e.composedPath().find((t=>t instanceof HTMLAnchorElement));s&&t.i(this,n({subredditId:this.subredditId,subredditName:this.subredditName,pageType:this._getPageType(),url:s.href}))},this._getPageType=t.H}render(){return e.x` <button @click="${this.open}" class="m-0 p-0 border-none bg-transparent"> <slot name="trigger"></slot> </button> <faceplate-bottom-sheet id="bottom-sheet"> <div class="flex flex-col w-full box-border px-md py-xl"> <div class="flex justify-center align-center"> <slot name="emote"></slot> </div> <p class="text-center m-0 line-clamp-8 text-14 font-semibold"> ${""} <slot name="status" @click="${this.handleStatusClicks}"></slot> </p> <slot @click="${this.close}" @keyup="${this.handleKeyUp}" name="primary-btn"></slot> ${t.o({appearance:"secondary",attributes:{onclick:this.close,className:"mt-sm",id:"close-button"},children:"Close"})} </div> </faceplate-bottom-sheet> `;}};d.styles=[e.a`:host{display:inline-flex}slot[name=emote]::slotted(img){max-height:148px;margin-bottom:32px!important}slot[name=primary-btn]::slotted(*){margin-top:24px}`,t.t],t._([t.n({type:String,attribute:"subreddit-id"})],d.prototype,"subredditId",void 0),t._([t.n({type:String,attribute:"subreddit-name"})],d.prototype,"subredditName",void 0),t._([t.a2("#bottom-sheet")],d.prototype,"bottomSheet",void 0),d=t._([t.e("community-status-bottom-sheet")],d);const m=e.s;let c=class extends m{constructor(){super(...arguments),this.subredditId="",this.subredditName="",this.handleClick=()=>{this.hovercard?.close()},this.handleKeyUp=t=>{"Enter"===t.key&&this.handleClick()},this.handleStatusClicks=e=>{const s=e.composedPath().find((t=>t instanceof HTMLAnchorElement));s&&t.i(this,n({subredditId:this.subredditId,subredditName:this.subredditName,pageType:this._getPageType(),url:s.href}))},this._getPageType=t.H}render(){return e.x` <faceplate-hovercard position="bottom" appearance="inverted"> <span> <slot name="trigger"></slot> </span> <article slot="content" class="flex flex-col relative py-sm w-[184px]"> <div class="absolute right-2xs top-2xs"> <slot name="edit-btn" @click="${this.handleClick}" @keyup="${this.handleKeyUp}"></slot> </div> <div class="flex justify-center align-center"> <slot name="emote"></slot> </div> <p class="text-center m-0 mt-md line-clamp-12 text-12"> ${""} <slot name="status" @click="${this.handleStatusClicks}"></slot> </p> </article> </faceplate-hovercard> `}};c.styles=[e.a`slot[name=emote]::slotted(img){max-height:140px;max-width:148px!important;margin-bottom:0!important}faceplate-hovercard::part(content-container){background:var(--color-neutral-content-strong)}`,t.t],t._([t.n({type:String,attribute:"subreddit-id"})],c.prototype,"subredditId",void 0),t._([t.n({type:String,attribute:"subreddit-name"})],c.prototype,"subredditName",void 0),t._([t.a2("faceplate-hovercard")],c.prototype,"hovercard",void 0),c=t._([t.e("community-status-tooltip")],c)}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("w2XkRJ2mzc",["Dw4vb8Yfbm"],(async e=>{const{svg:a}=e.a();return{C:"product-carousel-item",E:"toggleable-video-player-element",G:"gallery-images-container",T:"thumbnail-video-toggle-container",V:"toggleable-video-player-close-btn",a:"thumbnail-image-video-toggle",b:"thumbnail-playback-action-circle",c:"hiddenClassnames",d:"visibleClassnames",r:e.m(a`<path d="M17.1 10.1a.9.9 0 00-.9.9c0 3.42-2.781 6.2-6.2 6.2A6.207 6.207 0 013.8 11c0-3.419 2.781-6.2 6.2-6.2h3.552l-1.517 1.264a.9.9 0 101.153 1.384l3.426-2.855a.9.9 0 000-1.382L13.188.354a.9.9 0 10-1.153 1.383l1.517 1.264H10c-4.411 0-8 3.588-8 8s3.589 8 8 8 8-3.589 8-8a.9.9 0 00-.9-.9z"></path>`,"0 0 20 20","refresh",!0)}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./7e6Mie450p.js",import.meta.url,"7e6Mie450p");SML.di("./h_DcZt4ZIT.js",import.meta.url,"h_DcZt4ZIT");SML.di("./B9BDZKZMGC.js",import.meta.url,"B9BDZKZMGC");SML.di("./CX9iBhlNyV.js",import.meta.url,"CX9iBhlNyV");SML.di("./B2YOiYwFck.js",import.meta.url,"B2YOiYwFck");SML.di("./DKX7f2eWrD.js",import.meta.url,"DKX7f2eWrD");SML.di("./Bypt3-pSP2.js",import.meta.url,"Bypt3-pSP2");SML.di("./Cpom3ssQxB.js",import.meta.url,"Cpom3ssQxB");SML.di("./CQLIbJ-5V6.js",import.meta.url,"CQLIbJ-5V6");SML.di("./5r73EsgItq.js",import.meta.url,"5r73EsgItq");SML.di("./gtZ2AI5tN1.js",import.meta.url,"gtZ2AI5tN1");SML.di("./C0cxgUZlQL.js",import.meta.url,"C0cxgUZlQL");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");SML.di("./DgW4ULLwQ1.js",import.meta.url,"DgW4ULLwQ1");SML.di("./BWv2j8jrjX.js",import.meta.url,"BWv2j8jrjX");SML.di("./tO6bKRQro7.js",import.meta.url,"tO6bKRQro7");SML.di("./Bu440t6XLo.js",import.meta.url,"Bu440t6XLo");SML.di("./BeFppRYbzE.js",import.meta.url,"BeFppRYbzE");SML.di("./D1DY-avSiT.js",import.meta.url,"D1DY-avSiT");SML.di("./BSYfFtBeKH.js",import.meta.url,"BSYfFtBeKH");SML.di("./2oAMtcRlsC.js",import.meta.url,"2oAMtcRlsC");SML.di("./DyRz1vAoTm.js",import.meta.url,"DyRz1vAoTm");SML.di("./E3QE3c4_Ye.js",import.meta.url,"E3QE3c4_Ye");SML.di("./DasPtA-dN5.js",import.meta.url,"DasPtA-dN5");SML.di("./Z0tk4vmzIQ.js",import.meta.url,"Z0tk4vmzIQ");SML.di("./C8QDHFSIkY.js",import.meta.url,"C8QDHFSIkY");SML.di("./Dc4r6aHTbv.js",import.meta.url,"Dc4r6aHTbv");SML.di("./D_g7f2Ewyi.js",import.meta.url,"D_g7f2Ewyi");SML.di("./CzwD205thW.js",import.meta.url,"CzwD205thW");SML.di("./D-ibjVaztZ.js",import.meta.url,"D-ibjVaztZ");SML.di("./B7VtDPc4tA.js",import.meta.url,"B7VtDPc4tA");SML.di("./Dm3xIDznQh.js",import.meta.url,"Dm3xIDznQh");SML.di("./5KlNO8qI18.js",import.meta.url,"5KlNO8qI18");SML.di("./Hw1PFKH8z9.js",import.meta.url,"Hw1PFKH8z9");SML.di("./BYzqEZ3uv3.js",import.meta.url,"BYzqEZ3uv3");SML.di("./Cv4mWnWE30.js",import.meta.url,"Cv4mWnWE30");SML.di("./CG8L8PJoXS.js",import.meta.url,"CG8L8PJoXS");SML.di("./YAFaZPh0hw.js",import.meta.url,"YAFaZPh0hw");SML.di("./KHcvarc_gp.js",import.meta.url,"KHcvarc_gp");SML.di("./CUIVPWsUpf.js",import.meta.url,"CUIVPWsUpf");SML.di("./CzmIuH4u_q.js",import.meta.url,"CzmIuH4u_q");SML.di("./D14t1nj-sI.js",import.meta.url,"D14t1nj-sI");SML.di("./DQQjPN-OEj.js",import.meta.url,"DQQjPN-OEj");SML.di("./Bv2UEnJP_M.js",import.meta.url,"Bv2UEnJP_M");SML.di("./Cn5JTNK6V3.js",import.meta.url,"Cn5JTNK6V3");SML.di("./CqGTWb5M_i.js",import.meta.url,"CqGTWb5M_i");SML.di("./CJv9OgeyPR.js",import.meta.url,"CJv9OgeyPR");SML.di("./CQrDBXK-hm.js",import.meta.url,"CQrDBXK-hm");SML.di("./Df8NHW2nh0.js",import.meta.url,"Df8NHW2nh0");SML.di("./CZLMnmUH44.js",import.meta.url,"CZLMnmUH44");SML.di("./D_6DXw1u0k.js",import.meta.url,"D_6DXw1u0k");SML.di("./Bk8sRXhdir.js",import.meta.url,"Bk8sRXhdir");SML.di("./BtqmVQuPYp.js",import.meta.url,"BtqmVQuPYp");SML.di("./xrDbp1ee_h.js",import.meta.url,"xrDbp1ee_h");SML.di("./BFJyoIhMKv.js",import.meta.url,"BFJyoIhMKv");SML.di("./C5bRok1J9n.js",import.meta.url,"C5bRok1J9n");SML.di("./BlPAB0-vrn.js",import.meta.url,"BlPAB0-vrn");SML.di("./Ctcf-FPPNG.js",import.meta.url,"Ctcf-FPPNG");SML.di("./BLrhRle6xP.js",import.meta.url,"BLrhRle6xP");SML.di("./CPSOeCrm6v.js",import.meta.url,"CPSOeCrm6v");SML.di("./C3-eAP6Oln.js",import.meta.url,"C3-eAP6Oln");SML.di("./DMGDObG7XA.js",import.meta.url,"DMGDObG7XA");SML.di("./pA9dwrnd0r.js",import.meta.url,"pA9dwrnd0r");SML.di("./KkXqW5RUm3.js",import.meta.url,"KkXqW5RUm3");SML.di("./C2hekzTn1k.js",import.meta.url,"C2hekzTn1k");SML.di("./DLXAqLxSut.js",import.meta.url,"DLXAqLxSut");SML.di("./CBbxnHsw2W.js",import.meta.url,"CBbxnHsw2W");SML.di("./RXNEUFNiHt.js",import.meta.url,"RXNEUFNiHt");SML.di("./B6sa1lzoK7.js",import.meta.url,"B6sa1lzoK7");SML.di("./g8Ezfsb_Vs.js",import.meta.url,"g8Ezfsb_Vs");SML.di("./DfmRUMqhhU.js",import.meta.url,"DfmRUMqhhU");SML.di("./BgnwQeogVz.js",import.meta.url,"BgnwQeogVz");SML.di("./BLIiwX-G4B.js",import.meta.url,"BLIiwX-G4B");SML.di("./BPE-aUEF5w.js",import.meta.url,"BPE-aUEF5w");SML.di("./iewwAXEto0.js",import.meta.url,"iewwAXEto0");SML.di("./BM4eKBOTt3.js",import.meta.url,"BM4eKBOTt3");SML.di("./DI4O_MlG8-.js",import.meta.url,"DI4O_MlG8-");SML.di("./CNVxoLjPZD.js",import.meta.url,"CNVxoLjPZD");SML.di("./jTFRatIQcd.js",import.meta.url,"jTFRatIQcd");SML.di("./DWhb02bbsY.js",import.meta.url,"DWhb02bbsY");SML.di("./uOlAvv4IVq.js",import.meta.url,"uOlAvv4IVq");
SML.dm("wVY1cS2tsR",["Dw4vb8Yfbm","7e6Mie450p","h_DcZt4ZIT","B9BDZKZMGC","CX9iBhlNyV","B2YOiYwFck","DKX7f2eWrD","Bypt3-pSP2","Cpom3ssQxB","CQLIbJ-5V6","5r73EsgItq","gtZ2AI5tN1","C0cxgUZlQL","B-zFJtiar6","DgW4ULLwQ1","BWv2j8jrjX","tO6bKRQro7","Bu440t6XLo","BeFppRYbzE","D1DY-avSiT","BSYfFtBeKH","2oAMtcRlsC","DyRz1vAoTm","E3QE3c4_Ye","DasPtA-dN5","Z0tk4vmzIQ","C8QDHFSIkY","Dc4r6aHTbv","D_g7f2Ewyi","CzwD205thW","D-ibjVaztZ","B7VtDPc4tA","Dm3xIDznQh","5KlNO8qI18","Hw1PFKH8z9","BYzqEZ3uv3","Cv4mWnWE30","CG8L8PJoXS","YAFaZPh0hw","KHcvarc_gp","CUIVPWsUpf","CzmIuH4u_q","D14t1nj-sI","DQQjPN-OEj","Bv2UEnJP_M","Cn5JTNK6V3","CqGTWb5M_i","CJv9OgeyPR","CQrDBXK-hm","Df8NHW2nh0","CZLMnmUH44","D_6DXw1u0k","Bk8sRXhdir","BtqmVQuPYp","xrDbp1ee_h","BFJyoIhMKv","C5bRok1J9n","BlPAB0-vrn","Ctcf-FPPNG","BLrhRle6xP","CPSOeCrm6v","C3-eAP6Oln","DMGDObG7XA","pA9dwrnd0r","KkXqW5RUm3","C2hekzTn1k","DLXAqLxSut","CBbxnHsw2W","RXNEUFNiHt","B6sa1lzoK7","g8Ezfsb_Vs","DfmRUMqhhU","BgnwQeogVz","BLIiwX-G4B","BPE-aUEF5w","iewwAXEto0","BM4eKBOTt3","DI4O_MlG8-","CNVxoLjPZD","jTFRatIQcd","DWhb02bbsY","uOlAvv4IVq"],(async E=>{E.g()&&SML.di("./3d7RfPsXwj.js",import.meta.url,"3d7RfPsXwj")}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");SML.di("./B-zFJtiar6.js",import.meta.url,"B-zFJtiar6");
SML.dm("xrDbp1ee_h",["Dw4vb8Yfbm","B-zFJtiar6"],(async(e,t)=>{var o,n;!function(e){e.SubredditFeed="SubredditFeed",e.CustomFeed="CustomFeed",e.AggregateFeed="AggregateFeed",e.BestOfRedditPage="BestOfRedditPage",e.CommentsPage="CommentsPage",e.Comment="Comment",e.DynamicFeed="DynamicFeed",e.ListingBelowSubredditPosts="ListingBelowSubredditPosts",e.ListingBelowLinkedPosts="ListingBelowLinkedPosts",e.PopularFeed="PopularFeed",e.PostStatsPage="PostStatsPage",e.ProfileFeed="ProfileFeed",e.ProfileFeed2="ProfileFeed2",e.ProfileTrendingConvos="ProfileTrendingConvos",e.BrandMentionFeed="BrandMentionFeed",e.BrandPostPerformanceFeed="BrandPostPerformanceFeed",e.ArticleFeed="ArticleFeed",e.SearchResultsPage="SearchResultsPage",e.RightRail="RightRail",e.ModChatChannels="ModChatChannels",e.ModQueue="ModQueue",e.ModQueueAll="ModQueueAll",e.ModNotesRail="ModNotesRail",e.ModLog="ModLog",e.ModTrainingQueue="ModTrainingQueue",e.UserManagement="UserManagement",e.ModRules="ModRules",e.ModRecruitment="ModRecruitment",e.ModWiki="ModWiki",e.ArticleDetails="ArticleDetails",e.RelatedPosts="RelatedPosts"}(o||(o={})),function(e){e.Scheduled="scheduled",e.Live="live",e.Ended="ended"}(n||(n={}));const a=e=>`${e}`.startsWith("t3_")?`${e}`:`t3_${e}`;function i(e){return e===o.ListingBelowLinkedPosts||e===o.ListingBelowSubredditPosts}const s=/^.*?\/(?:u|user|r)\/(?:[a-zA-Z0-9_-]+)\/comments\/(?<postId>[a-zA-Z0-9]+)(?:(?:\/|\?).*|$)/;const r=t=>c(t,e.eH)?t:void 0,c=(e,t)=>Object.values(t).includes(e),d=(e,t)=>void 0===e?void 0:t(e);function u(e){return e&&i(e)?"post_detail":"post"}function l(e){return u(e.viewContext??null)}const _=({archived:t,authorId:o,createdTimestamp:n,domain:a,id:i,feedIndex:s,nsfw:c,isStickied:u,isHighlighted:l,postTitle:_,postType:m,promoted:p,recommendationSource:b,recommendationSubredditId:f,recommendationSubredditName:g,score:w,spoiler:T,subredditId:k,subredditPrefixedName:h,viewType:v,commentCount:P,permalink:A,awardId:S,interactionFromHotkey:E,appSlug:M})=>{let I=d(m,r);null!=M&&(I=e.eH.CustomPost);const L=d(n,e.cN),R={name:h?.toLowerCase(),id:k},C=S?{id:S}:void 0,F=E?e.d3.HOTKEY:void 0;return{...C,post:{archived:t,author_id:o,created_timestamp:L,domain:a,id:i,nsfw:c,pinned:u,highlighted:l,promoted:p,score:w,spoiler:T,subreddit_id:k,subreddit_name:R.name,title:_,type:I,recommendation_source:b?.toLowerCase(),recommendation_source_subreddit_id:f,recommendation_source_subreddit_name:g,number_comments:P,url:A},screen:{view_type:e.f4(v)},subreddit:R,action_info:{position:s,trigger_type:F}}},m=t=>({..._(t),feed:e.f3()}),p=({fields:e,post:t,postIsTranslated:o,reason:n})=>{const{isMTSEOUserPage:a,postLanguage:i,translationLanguage:s}=t;return e={...e,post:{...e.post,language:i,translation_language:o?s:"original",translation_state:o,translation_reason:o?a?"mt_seo":"immersive_auto":"original",translatable_state:t.isTranslatable?"is_translatable":"is_not_translatable"},...n&&{action_info:{...e.action_info,reason:n}}}};function b(e,t){return e&&t?{ad_metadata:{impression_id:e,placement:t}}:void 0}function f(e){return{...p({fields:m(e),post:e,postIsTranslated:!!e.isPostTranslated,withTranslationMetrics:!0}),new_award:{id:e.awardId,is_content_eligible:Boolean(e.isAwardable)}}}const g=(t,o,n={})=>e.b({source:l(t),action:"click",noun:o},{...t.viewContext&&i(t.viewContext)?f(t):n,feed:e.f3()}),w=/^.*\/r\/.*\/comments\/(?<postId>[a-zA-Z0-9]+)\/.*\/?$/;const T=/\/r\/([^/]+)\/$/;return{$:t=>e.b({source:u(t),action:"click",noun:"hide"}),A:t=>{const o=f(t.post);return e.b({source:"translate_button",action:"click",noun:"post_banner"},{...o,action_info:{...o.action_info,reason:t?.isPostTranslated?e.bU.SEE_ORIGINAL:e.bU.SEE_TRANSLATION},is_mod:t.isMod})},B:"max-h-[253px] overflow-hidden s:max-h-[318px] m:max-h-[337px] l:max-h-[352px] xl:max-h-[452px]",C:"hidden",D:t=>e.b({source:"translate_button",action:"view",noun:"translation_settings"},f(t)),E:function(e){const t=(e?.getAttribute("href")||"").match(T);return t?t[1]:""},get F(){return n},G:t=>{const o=f(t);return e.b({source:"overflow_menu",action:"click",noun:"translate_post"},{...o,action_info:{...o.action_info,reason:t.isPostTranslated?e.bU.SEE_ORIGINAL:e.bU.SEE_TRANSLATION}})},H:(t,o)=>e.b({source:u(t),action:"click",noun:"report"},o),I:t=>e.b({source:"ad_overflow",action:"hide",noun:"ad"},t),J:(t,o)=>e.b({source:u(t),action:"click",noun:"overflow_show_less"},o),K:(t,o)=>e.b({source:u(t),action:"click",noun:o}),L:(t,o,n,a)=>e.b({source:u(t),action:"click",noun:o?"edit_post_flair":"add_post_flair"},{post:{id:n,author_id:a}}),M:"overflow-hidden h-[60px] embed-xs:h-[80px]",N:t=>e.b({source:u(t),action:"click",noun:"update_post_flair"}),O:t=>e.b({source:u(t),action:"click",noun:"save"}),get P(){return o},Q:t=>e.b({source:u(t),action:"click",noun:"overflow_rec_context"}),R:"read-more-click",S:(t,o)=>e.b({source:u(t),action:o?"undo":"click",noun:"follow"}),T:"h-[316px]",U:t=>e.b({source:u(t),action:"click",noun:"unpin"}),V:t=>e.b({source:u(t),action:"click",noun:"pin"}),W:t=>e.b({source:u(t),action:"click",noun:"delete"}),X:({markedAsSpoiler:t,viewContext:o})=>e.b({source:u(o),action:"click",noun:t?"mark_spoiler":"unmark_spoiler"}),Y:({markedAsNsfw:t,viewContext:o})=>e.b({source:u(o),action:"click",noun:t?"mark_nsfw":"unmark_nsfw"}),Z:({markedAsBrandAffiliate:t,viewContext:o})=>e.b({source:u(o),action:"click",noun:t?"mark_brand_affiliate":"unmark_brand_affiliate"}),_:({turnNotificationsOn:t,viewContext:o})=>e.b({source:u(o),action:"click",noun:t?"turn_notifications":"unsend_reply_notifications"}),a:e=>`${e}`.startsWith("t1_")?`${e}`:`t1_${e}`,a0:(t,o)=>e.b({source:"post"===o?"post":"post_detail",action:t,noun:"post"===o?"post":"comment"},{action_info:{trigger_type:e.d3.HOTKEY}}),a1:t=>e.b({source:"post",action:"leave",noun:"post",visibility:{on_screen_timestamp:t.becameVisibleOnScreenTimestamp,off_screen_timestamp:Date.now()}},m(t)),a2:t=>e.b({source:"post",action:"consume",noun:"post"},{...p({fields:m(t),post:t,postIsTranslated:!!t.isPostTranslated,withTranslationMetrics:!0}),new_award:{id:t.awardId,is_content_eligible:Boolean(t.isAwardable)}}),a3:t=>e.b({source:l(t),action:"click",noun:"read_more"},m(t)),a4:function(t){return t===e.au.Popular},a5:function(t){return t===e.au.Home},a6:i,a7:e=>g(e,"share",_(e)),a8:e=>g(e,"share_copy",_(e)),a9:(o,n)=>{switch(t.z(o,"postClickLocation")){case e.ck.SUBREDDIT_LINK:return(e=>g(e,"subreddit",_(e)))(n);case e.ck.JOIN:return(e=>g(e,"subscribe",_(e)))(n);case e.ck.OVERFLOW_BUTTON:case e.ck.COMMENTS_BUTTON:case e.ck.VOTE:case e.ck.SHARE:case e.ck.VIDEO_PLAYER:return null;case e.ck.TEXT_BODY:return(e=>g(e,"text",_(e)))(n);case e.ck.DEVVIT_SURFACE:return(e=>g(e,"custom_post",_(e)))(n);default:return(e=>g(e,"post",_(e)))(n)}},aa:t=>e.b({source:l(t),action:"click",noun:"vote_try"},_(t)),ab:t=>e.b({source:"subreddit_hovercard",action:"view",noun:"hover_subreddit_hovercard"},m(t)),ac:t=>e.b({source:"user_hovercard",action:"view",noun:"hover_user_hovercard"},m(t)),ad:function(e){const t=e.match(s),o=t?.groups?.postId;if(o)return a(o)},ae:(t,o)=>{const n=o?f(o):{};return e.b({source:"overflow_menu",action:"click",noun:"translate_comment"},{...n,comment:{...t,translation_language:t.translation_state?t.translation_language:"original"},action_info:{...n.action_info,reason:t.translation_state?e.bU.SEE_ORIGINAL:e.bU.SEE_TRANSLATION}})},b:2e3,c:function(e){switch(e){case o.AggregateFeed:case o.SubredditFeed:case o.CustomFeed:case o.ListingBelowLinkedPosts:case o.ListingBelowSubredditPosts:case o.PopularFeed:case o.ProfileFeed:case o.ProfileFeed2:case o.BrandMentionFeed:case o.BrandPostPerformanceFeed:case o.ArticleDetails:case o.ModQueue:case o.ModQueueAll:case o.ModLog:case o.ModNotesRail:return!0;case o.CommentsPage:default:return!1}},d:"partial-update",e:a,f:function(e){return`https://www.redditmedia.com/mediaembed/${e.replace("t3_","")}/`},g:_,h:e=>e.startsWith("t3_"),i:function(e){return e===o.CommentsPage},j:t=>{const o=f(t);return e.b({source:"translate_button",action:"view",noun:"post"},{...o,action_info:{...o.action_info,reason:t.isPostTranslated?e.bm:e.bn}})},k:p,l:m,m:"flex",n:t=>e.b({source:l(t),action:"view",noun:"post"},f(t)),o:t=>e.b({source:l(t),action:"click",noun:"clearvote"},m(t)),p:(t,o)=>e.b({source:"translate_button",action:"view",noun:"post"},p({fields:m(t),post:t,postIsTranslated:o,reason:o?"on":"off"})),q:t=>e.b({source:l(t),action:"click",noun:"downvote"},{...p({fields:m(t),post:t,postIsTranslated:!!t.isPostTranslated,withTranslationMetrics:!0})}),r:t=>e.b({source:u(t),action:"click",noun:"post_overflow_menu"}),s:t=>{const o=f(t);return e.b({source:"translate_button",action:"click",noun:"post_indicator"},{...o,action_info:{...o.action_info,reason:t.isPostTranslated?e.bU.SEE_ORIGINAL:e.bU.SEE_TRANSLATION}})},t:function(e){const t=(e?.getAttribute("href")||"").match(w),o=t?.groups?.postId;return o?a(o):""},u:t=>e.b({source:l(t),action:"click",noun:"upvote"},{...p({fields:m(t),post:t,postIsTranslated:!!t.isPostTranslated,withTranslationMetrics:!0})}),v:e=>g(e,"view_all_comments",_(e)),w:t=>e.b({source:"event_post",action:"click",noun:"rsvp"},{..._(t),...b(t.impressionId,t.placement)}),x:t=>e.b({source:"event_post",action:"click",noun:"un_rsvp"},{..._(t),...b(t.impressionId,t.placement)}),y:e=>g(e,"comments",_(e)),z:t=>e.b({source:"translate_button",action:"view",noun:"post_banner"},f(t.post))}}));
SML.di("./Dw4vb8Yfbm.js",import.meta.url,"Dw4vb8Yfbm");
SML.dm("ygbiiDqLof",["Dw4vb8Yfbm"],(async a=>{const{svg:t}=a.a();return{n:a.m(t`<path d="M18.175 14.217l-.924-1.93A2.573 2.573 0 0117 11.183V8c0-3.859-3.141-7-7-7-3.86 0-7 3.14-7 7v3.183c0 .38-.086.763-.25 1.105l-.925 1.929c-.165.345-.143.743.062 1.066a1.1 1.1 0 00.935.517h3.26a4.007 4.007 0 003.92 3.2 4.007 4.007 0 003.919-3.2h3.26a1.1 1.1 0 00.935-.516 1.1 1.1 0 00.062-1.067h-.003zM10 17.199A2.198 2.198 0 017.956 15.8h4.088A2.196 2.196 0 0110 17.199z"></path>`,"0 0 20 20","notifications-fill")}}));